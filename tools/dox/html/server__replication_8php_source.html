<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RFSCMSAPIDocumentation: server_replication.php Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">RFSCMSAPIDocumentation
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('server__replication_8php.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">server_replication.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="server__replication_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 <span class="comment">/* vim: set expandtab sw=4 ts=4 sts=4: */</span><span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">/**</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * @package PhpMyAdmin</span>
<a name="l00006"></a>00006 <span class="comment"> */</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">/**</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> */</span>
<a name="l00011"></a>00011 require_once <span class="stringliteral">&#39;./libraries/common.inc.php&#39;</span>;
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">/**</span>
<a name="l00014"></a>00014 <span class="comment"> * Does the common work</span>
<a name="l00015"></a>00015 <span class="comment"> */</span>
<a name="l00016"></a><a class="code" href="server__replication_8php.html#a9b835efbb97695b4ed9faf19a55b1080">00016</a> <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;js_include&#39;</span>][] = <span class="stringliteral">&#39;server_privileges.js&#39;</span>;
<a name="l00017"></a>00017 <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;js_include&#39;</span>][] = <span class="stringliteral">&#39;replication.js&#39;</span>;
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 require <span class="stringliteral">&#39;./libraries/server_common.inc.php&#39;</span>;
<a name="l00020"></a>00020 require <span class="stringliteral">&#39;./libraries/replication.inc.php&#39;</span>;
<a name="l00021"></a>00021 require <span class="stringliteral">&#39;./libraries/replication_gui.lib.php&#39;</span>;
<a name="l00022"></a>00022 require_once <span class="stringliteral">&#39;./libraries/server_synchronize.lib.php&#39;</span>;
<a name="l00023"></a>00023 <span class="comment"></span>
<a name="l00024"></a>00024 <span class="comment">/**</span>
<a name="l00025"></a>00025 <span class="comment"> * Checks if the user is allowed to do what he tries to...</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 <span class="keywordflow">if</span> (! <a class="code" href="db__links_8inc_8php.html#a951856c8e2beadb8a4914f1dd904b619" title="If coming from a Show MySQL link on the home page, put something in $sub_part.">$is_superuser</a>) {
<a name="l00028"></a>00028     include <span class="stringliteral">&#39;./libraries/server_links.inc.php&#39;</span>;
<a name="l00029"></a>00029     echo <span class="stringliteral">&#39;&lt;h2&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00030"></a>00030         . <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;s_replication.png&#39;</span>)
<a name="l00031"></a>00031         . __(<span class="stringliteral">&#39;Replication&#39;</span>) . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00032"></a>00032         . <span class="stringliteral">&#39;&lt;/h2&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00033"></a>00033     <a class="code" href="classPMA__Message.html#ac1eedc27bd176676149c300379b98661" title="get PMA_Message of type error">PMA_Message::error</a>(__(<span class="stringliteral">&#39;No Privileges&#39;</span>))-&gt;display();
<a name="l00034"></a>00034     include <span class="stringliteral">&#39;./libraries/footer.inc.php&#39;</span>;
<a name="l00035"></a>00035 }
<a name="l00036"></a>00036 <span class="comment"></span>
<a name="l00037"></a>00037 <span class="comment">/**</span>
<a name="l00038"></a>00038 <span class="comment"> * Handling control requests</span>
<a name="l00039"></a>00039 <span class="comment"> */</span>
<a name="l00040"></a><a class="code" href="server__replication_8php.html#aaade6762de2d937f7ad2cc6c820d766e">00040</a> <span class="keywordflow">if</span> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sr_take_action&#39;</span>])) {
<a name="l00041"></a>00041     $refresh = <span class="keyword">false</span>;
<a name="l00042"></a>00042     <span class="keywordflow">if</span> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;slave_changemaster&#39;</span>])) {
<a name="l00043"></a>00043         <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_username&#39;</span>] = $sr[<span class="stringliteral">&#39;username&#39;</span>] = <a class="code" href="common_8lib_8php.html#a799062f79f401d1f20735d292d008eaf" title="Add slashes before &quot;&#39;&quot; and &quot;\&quot; characters so a value containing them can be used in a sql comparison...">PMA_sqlAddSlashes</a>(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;username&#39;</span>]);
<a name="l00044"></a>00044         <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_password&#39;</span>] = $sr[<span class="stringliteral">&#39;pma_pw&#39;</span>]   = <a class="code" href="common_8lib_8php.html#a799062f79f401d1f20735d292d008eaf" title="Add slashes before &quot;&#39;&quot; and &quot;\&quot; characters so a value containing them can be used in a sql comparison...">PMA_sqlAddSlashes</a>(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;pma_pw&#39;</span>]);
<a name="l00045"></a>00045         <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_hostname&#39;</span>] = $sr[<span class="stringliteral">&#39;hostname&#39;</span>] = <a class="code" href="common_8lib_8php.html#a799062f79f401d1f20735d292d008eaf" title="Add slashes before &quot;&#39;&quot; and &quot;\&quot; characters so a value containing them can be used in a sql comparison...">PMA_sqlAddSlashes</a>(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;hostname&#39;</span>]);
<a name="l00046"></a>00046         <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_port&#39;</span>]     = $sr[<span class="stringliteral">&#39;port&#39;</span>]     = <a class="code" href="common_8lib_8php.html#a799062f79f401d1f20735d292d008eaf" title="Add slashes before &quot;&#39;&quot; and &quot;\&quot; characters so a value containing them can be used in a sql comparison...">PMA_sqlAddSlashes</a>(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;port&#39;</span>]);
<a name="l00047"></a>00047         <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_correct&#39;</span>]  = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00048"></a>00048         <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>] = <span class="stringliteral">&#39;error&#39;</span>;
<a name="l00049"></a>00049         <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_info&#39;</span>] = __(<span class="stringliteral">&#39;Unknown error&#39;</span>);
<a name="l00050"></a>00050 
<a name="l00051"></a>00051         <span class="comment">// Attempt to connect to the new master server</span>
<a name="l00052"></a>00052         $link_to_master = <a class="code" href="replication_8inc_8php.html#a8dab574ee7ad7aeab663e6abc8ab8f27" title="This function provides connection to remote mysql server.">PMA_replication_connect_to_master</a>($sr[<span class="stringliteral">&#39;username&#39;</span>], $sr[<span class="stringliteral">&#39;pma_pw&#39;</span>], $sr[<span class="stringliteral">&#39;hostname&#39;</span>], $sr[<span class="stringliteral">&#39;port&#39;</span>]);
<a name="l00053"></a>00053 
<a name="l00054"></a>00054         <span class="keywordflow">if</span> (! $link_to_master) {
<a name="l00055"></a>00055             <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>] = <span class="stringliteral">&#39;error&#39;</span>;
<a name="l00056"></a>00056             <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_info&#39;</span>] = sprintf(__(<span class="stringliteral">&#39;Unable to connect to master %s.&#39;</span>), htmlspecialchars($sr[<span class="stringliteral">&#39;hostname&#39;</span>]));
<a name="l00057"></a>00057         } <span class="keywordflow">else</span> {
<a name="l00058"></a>00058             <span class="comment">// Read the current master position</span>
<a name="l00059"></a>00059             $position = <a class="code" href="replication_8inc_8php.html#a796f0d92d256577572563a40baf65150">PMA_replication_slave_bin_log_master</a>($link_to_master);
<a name="l00060"></a>00060 
<a name="l00061"></a>00061             <span class="keywordflow">if</span> (empty($position)) {
<a name="l00062"></a>00062                 <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>] = <span class="stringliteral">&#39;error&#39;</span>;
<a name="l00063"></a>00063                 <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_info&#39;</span>] = __(<span class="stringliteral">&#39;Unable to read master log position. Possible privilege problem on master.&#39;</span>);
<a name="l00064"></a>00064             } <span class="keywordflow">else</span> {
<a name="l00065"></a>00065                 <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_correct&#39;</span>]  = <span class="keyword">true</span>;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067                 <span class="keywordflow">if</span> (! <a class="code" href="replication_8inc_8php.html#a0f303959e893d178b9ae46ebdeea765d">PMA_replication_slave_change_master</a>($sr[<span class="stringliteral">&#39;username&#39;</span>], $sr[<span class="stringliteral">&#39;pma_pw&#39;</span>], $sr[<span class="stringliteral">&#39;hostname&#39;</span>], $sr[<span class="stringliteral">&#39;port&#39;</span>], $position, <span class="keyword">true</span>, <span class="keyword">false</span>)) {
<a name="l00068"></a>00068                     <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>] = <span class="stringliteral">&#39;error&#39;</span>;
<a name="l00069"></a>00069                     <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_info&#39;</span>] = __(<span class="stringliteral">&#39;Unable to change master&#39;</span>);
<a name="l00070"></a>00070                 } <span class="keywordflow">else</span> {
<a name="l00071"></a>00071                     <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>] = <span class="stringliteral">&#39;success&#39;</span>;
<a name="l00072"></a>00072                     <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_info&#39;</span>] = sprintf(__(<span class="stringliteral">&#39;Master server changed successfully to %s&#39;</span>), htmlspecialchars($sr[<span class="stringliteral">&#39;hostname&#39;</span>]));
<a name="l00073"></a>00073                 }
<a name="l00074"></a>00074             }
<a name="l00075"></a>00075         }
<a name="l00076"></a>00076     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sr_slave_server_control&#39;</span>])) {
<a name="l00077"></a>00077         <span class="keywordflow">if</span> (<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sr_slave_action&#39;</span>] == <span class="stringliteral">&#39;reset&#39;</span>) {
<a name="l00078"></a>00078             <a class="code" href="replication_8inc_8php.html#ab6d6043762c06ebed4f8da8c94d86562">PMA_replication_slave_control</a>(<span class="stringliteral">&quot;STOP&quot;</span>);
<a name="l00079"></a>00079             <a class="code" href="database__interface_8lib_8php.html#af4f8622d2f5df7858e4e6ca425ac0274" title="runs a query and returns the result">PMA_DBI_try_query</a>(<span class="stringliteral">&quot;RESET SLAVE;&quot;</span>);
<a name="l00080"></a>00080             <a class="code" href="replication_8inc_8php.html#ab6d6043762c06ebed4f8da8c94d86562">PMA_replication_slave_control</a>(<span class="stringliteral">&quot;START&quot;</span>);
<a name="l00081"></a>00081         } <span class="keywordflow">else</span> {
<a name="l00082"></a>00082             <a class="code" href="replication_8inc_8php.html#ab6d6043762c06ebed4f8da8c94d86562">PMA_replication_slave_control</a>(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sr_slave_action&#39;</span>], <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sr_slave_control_parm&#39;</span>]);
<a name="l00083"></a>00083         }
<a name="l00084"></a>00084         $refresh = <span class="keyword">true</span>;
<a name="l00085"></a>00085 
<a name="l00086"></a>00086     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sr_slave_skip_error&#39;</span>])) {
<a name="l00087"></a>00087         <a class="code" href="db__datadict_8php.html#af789423037bbc89dc7c850e761177570">$count</a> = 1;
<a name="l00088"></a>00088         <span class="keywordflow">if</span> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sr_skip_errors_count&#39;</span>])) {
<a name="l00089"></a>00089             <a class="code" href="db__datadict_8php.html#af789423037bbc89dc7c850e761177570">$count</a> = <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sr_skip_errors_count&#39;</span>] * 1;
<a name="l00090"></a>00090         }
<a name="l00091"></a>00091         <a class="code" href="replication_8inc_8php.html#ab6d6043762c06ebed4f8da8c94d86562">PMA_replication_slave_control</a>(<span class="stringliteral">&quot;STOP&quot;</span>);
<a name="l00092"></a>00092         <a class="code" href="database__interface_8lib_8php.html#af4f8622d2f5df7858e4e6ca425ac0274" title="runs a query and returns the result">PMA_DBI_try_query</a>(<span class="stringliteral">&quot;SET GLOBAL SQL_SLAVE_SKIP_COUNTER = &quot;</span>.<a class="code" href="db__datadict_8php.html#af789423037bbc89dc7c850e761177570">$count</a>.<span class="stringliteral">&quot;;&quot;</span>);
<a name="l00093"></a>00093         <a class="code" href="replication_8inc_8php.html#ab6d6043762c06ebed4f8da8c94d86562">PMA_replication_slave_control</a>(<span class="stringliteral">&quot;START&quot;</span>);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sl_sync&#39;</span>])) {
<a name="l00096"></a>00096         <span class="comment">// TODO username, host and port could be read from &#39;show slave status&#39;,</span>
<a name="l00097"></a>00097         <span class="comment">// when asked for a password this might work in more situations then just after changing master (where the master password is stored in session)</span>
<a name="l00098"></a>00098         $src_link = <a class="code" href="replication_8inc_8php.html#a8dab574ee7ad7aeab663e6abc8ab8f27" title="This function provides connection to remote mysql server.">PMA_replication_connect_to_master</a>(<a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_username&#39;</span>], <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_password&#39;</span>], <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_hostname&#39;</span>], <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_port&#39;</span>]);
<a name="l00099"></a>00099         $trg_link = null; <span class="comment">// using null to indicate the current PMA server</span>
<a name="l00100"></a>00100 
<a name="l00101"></a>00101         <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = <a class="code" href="database__interface_8lib_8php.html#a761f919096699667412d2ffd391eaa5b" title="returns all rows in the resultset in one array">PMA_DBI_fetch_result</a>(<span class="stringliteral">&#39;SHOW MASTER STATUS&#39;</span>, null, null, $src_link); <span class="comment">// let&#39;s find out, which databases are replicated</span>
<a name="l00102"></a>00102 
<a name="l00103"></a>00103         $do_db     = array();
<a name="l00104"></a>00104         $ignore_db = array();
<a name="l00105"></a>00105         $dblist    = array();
<a name="l00106"></a>00106 
<a name="l00107"></a>00107         <span class="keywordflow">if</span> (! empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[0][<span class="stringliteral">&#39;Binlog_Do_DB&#39;</span>])) {
<a name="l00108"></a>00108             $do_db     = explode(<span class="charliteral">&#39;,&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[0][<span class="stringliteral">&#39;Binlog_Do_DB&#39;</span>]);
<a name="l00109"></a>00109         }
<a name="l00110"></a>00110         <span class="keywordflow">if</span> (! empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[0][<span class="stringliteral">&#39;Binlog_Ignore_DB&#39;</span>])) {
<a name="l00111"></a>00111             $ignore_db = explode(<span class="charliteral">&#39;,&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[0][<span class="stringliteral">&#39;Binlog_Ignore_DB&#39;</span>]);
<a name="l00112"></a>00112         }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         $tmp_alldbs = <a class="code" href="database__interface_8lib_8php.html#ab439cded0e18a60e731e76aa4567c089" title="runs a query">PMA_DBI_query</a>(<span class="stringliteral">&#39;SHOW DATABASES;&#39;</span>, $src_link);
<a name="l00115"></a>00115         <span class="keywordflow">while</span> ($tmp_row = <a class="code" href="drizzle_8dbi_8lib_8php.html#a76a677a68b562828af0dfe4467107d31" title="returns array of rows with numeric keys from $result">PMA_DBI_fetch_row</a>($tmp_alldbs)) {
<a name="l00116"></a>00116             <span class="keywordflow">if</span> (<a class="code" href="database__interface_8lib_8php.html#ab3a7f643170e9d96461975b2f2786555" title="Checks whether given schema is a system schema: information_schema (MySQL and Drizzle) or data_dictio...">PMA_is_system_schema</a>($tmp_row[0])) {
<a name="l00117"></a>00117                 <span class="keywordflow">continue</span>;
<a name="l00118"></a>00118             }
<a name="l00119"></a>00119             <span class="keywordflow">if</span> (count($do_db) == 0) {
<a name="l00120"></a>00120                 <span class="keywordflow">if</span> (array_search($tmp_row[0], $ignore_db) !== <span class="keyword">false</span>) {
<a name="l00121"></a>00121                     <span class="keywordflow">continue</span>;
<a name="l00122"></a>00122                 }
<a name="l00123"></a>00123                 $dblist[] = $tmp_row[0];
<a name="l00124"></a>00124 
<a name="l00125"></a>00125                 <a class="code" href="database__interface_8lib_8php.html#ab439cded0e18a60e731e76aa4567c089" title="runs a query">PMA_DBI_query</a>(<span class="stringliteral">&#39;CREATE DATABASE IF NOT EXISTS &#39;</span>.<a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($tmp_row[0]), $trg_link);
<a name="l00126"></a>00126             } <span class="keywordflow">else</span> {
<a name="l00127"></a>00127                 <span class="keywordflow">if</span> (array_search($tmp_row[0], $do_db) !== <span class="keyword">false</span>) {
<a name="l00128"></a>00128                     $dblist[] = $tmp_row[0];
<a name="l00129"></a>00129                     <a class="code" href="database__interface_8lib_8php.html#ab439cded0e18a60e731e76aa4567c089" title="runs a query">PMA_DBI_query</a>(<span class="stringliteral">&#39;CREATE DATABASE IF NOT EXISTS &#39;</span>.<a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($tmp_row[0]), $trg_link);
<a name="l00130"></a>00130                 }
<a name="l00131"></a>00131             }
<a name="l00132"></a>00132         } <span class="comment">// end while</span>
<a name="l00133"></a>00133 
<a name="l00134"></a>00134         unset($do_db, $ignore_db, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136         <span class="keywordflow">if</span> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;repl_data&#39;</span>])) {
<a name="l00137"></a>00137             $include_data = <span class="keyword">true</span>;
<a name="l00138"></a>00138         } <span class="keywordflow">else</span> {
<a name="l00139"></a>00139             $include_data = <span class="keyword">false</span>;
<a name="l00140"></a>00140         }
<a name="l00141"></a>00141         <span class="keywordflow">foreach</span> ($dblist as <a class="code" href="schema__export_8php.html#a907d78797a1b764e913b0c565a5097b0" title="get all the export options and verify call and include the appropriate Schema Class depending on $exp...">$db</a>) {
<a name="l00142"></a>00142             <a class="code" href="replication_8inc_8php.html#a9d196603d9e2d6d5738f7ec564225964" title="This function provides synchronization of structure and data between two mysql servers.">PMA_replication_synchronize_db</a>($db, $src_link, $trg_link, $include_data);
<a name="l00143"></a>00143         }
<a name="l00144"></a>00144         <span class="comment">// TODO some form of user feedback error/success would be nice</span>
<a name="l00145"></a>00145         <span class="comment">//  What happens if $dblist is empty?</span>
<a name="l00146"></a>00146         <span class="comment">//  or sync failed?</span>
<a name="l00147"></a>00147     }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <span class="keywordflow">if</span> ($refresh) {
<a name="l00150"></a>00150         Header(<span class="stringliteral">&quot;Location: &quot;</span>. <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;url_params&#39;</span>]));
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152     unset($refresh);
<a name="l00153"></a>00153 }<span class="comment"></span>
<a name="l00154"></a>00154 <span class="comment">/**</span>
<a name="l00155"></a>00155 <span class="comment"> * Displays the links</span>
<a name="l00156"></a>00156 <span class="comment"> */</span>
<a name="l00157"></a>00157 require <span class="stringliteral">&#39;./libraries/server_links.inc.php&#39;</span>;
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 echo <span class="stringliteral">&#39;&lt;div id=&quot;replication&quot;&gt;&#39;</span>;
<a name="l00160"></a>00160 echo <span class="stringliteral">&#39; &lt;h2&gt;&#39;</span>;
<a name="l00161"></a>00161 echo <span class="stringliteral">&#39;   &#39;</span> . <a class="code" href="common_8lib_8php.html#a54fdec9763bf305a5082d23a5d7d5957" title="Returns an HTML IMG tag for a particular image from a theme, which may be an actual file or an icon f...">PMA_getImage</a>(<span class="stringliteral">&#39;s_replication.png&#39;</span>);
<a name="l00162"></a>00162 echo     __(<span class="stringliteral">&#39;Replication&#39;</span>);
<a name="l00163"></a>00163 echo <span class="stringliteral">&#39; &lt;/h2&gt;&#39;</span>;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="comment">// Display error messages</span>
<a name="l00166"></a>00166 <span class="keywordflow">if</span> (isset(<a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>]) &amp;&amp; isset(<a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_info&#39;</span>])) {
<a name="l00167"></a>00167     <span class="keywordflow">if</span> (<a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>] == <span class="stringliteral">&#39;error&#39;</span>) {
<a name="l00168"></a>00168         <a class="code" href="classPMA__Message.html#ac1eedc27bd176676149c300379b98661" title="get PMA_Message of type error">PMA_Message::error</a>(<a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_info&#39;</span>])-&gt;display();
<a name="l00169"></a>00169         <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>] = <span class="stringliteral">&#39;unknown&#39;</span>;
<a name="l00170"></a>00170     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>] == <span class="stringliteral">&#39;success&#39;</span>) {
<a name="l00171"></a>00171         <a class="code" href="classPMA__Message.html#a18c1022045762ab6747a98cb4464819e" title="get PMA_Message of type success">PMA_Message::success</a>(<a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_info&#39;</span>])-&gt;display();
<a name="l00172"></a>00172         <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;sr_action_status&#39;</span>] = <span class="stringliteral">&#39;unknown&#39;</span>;
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174 }
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 <span class="keywordflow">if</span> ($server_master_status) {
<a name="l00177"></a>00177     <span class="keywordflow">if</span> (! isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;repl_clear_scr&#39;</span>])) {
<a name="l00178"></a>00178         echo <span class="stringliteral">&#39;&lt;fieldset&gt;&#39;</span>;
<a name="l00179"></a>00179         echo <span class="stringliteral">&#39;&lt;legend&gt;&#39;</span> . __(<span class="stringliteral">&#39;Master replication&#39;</span>) . <span class="stringliteral">&#39;&lt;/legend&gt;&#39;</span>;
<a name="l00180"></a>00180         echo __(<span class="stringliteral">&#39;This server is configured as master in a replication process.&#39;</span>);
<a name="l00181"></a>00181         echo <span class="stringliteral">&#39;&lt;ul&gt;&#39;</span>;
<a name="l00182"></a>00182         echo <span class="stringliteral">&#39;  &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;master_status_href&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Show master status&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00183"></a>00183         <a class="code" href="replication__gui_8lib_8php.html#adb80f6e44c4eed5e1bf606f1c5ca1090" title="This function prints out table with replication status.">PMA_replication_print_status_table</a>(<span class="stringliteral">&#39;master&#39;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);
<a name="l00184"></a>00184 
<a name="l00185"></a>00185         echo <span class="stringliteral">&#39;  &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;master_slaves_href&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Show connected slaves&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00186"></a>00186         <a class="code" href="replication__gui_8lib_8php.html#a05b34408e78de2bae2e56414488f9268" title="Prints table with slave users connected to this master.">PMA_replication_print_slaves_table</a>(<span class="keyword">true</span>);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;url_params&#39;</span>];
<a name="l00189"></a>00189         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;mr_adduser&#39;</span>] = <span class="keyword">true</span>;
<a name="l00190"></a>00190         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;repl_clear_scr&#39;</span>] = <span class="keyword">true</span>;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192         echo <span class="stringliteral">&#39;  &lt;li&gt;&lt;a href=&quot;&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>) . <span class="stringliteral">&#39;&quot; id=&quot;master_addslaveuser_href&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Add slave replication user&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00193"></a>00193     }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="comment">// Display &#39;Add replication slave user&#39; form</span>
<a name="l00196"></a>00196     <span class="keywordflow">if</span> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;mr_adduser&#39;</span>])) {
<a name="l00197"></a>00197         <a class="code" href="replication__gui_8lib_8php.html#ac4b2e448656815c2eaf6bcd2b3f5650e" title="Print code to add a replication slave user to the master.">PMA_replication_gui_master_addslaveuser</a>();
<a name="l00198"></a>00198     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (! isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;repl_clear_scr&#39;</span>])) {
<a name="l00199"></a>00199         echo <span class="stringliteral">&quot;&lt;/ul&gt;&quot;</span>;
<a name="l00200"></a>00200         echo <span class="stringliteral">&quot;&lt;/fieldset&gt;&quot;</span>;
<a name="l00201"></a>00201     }
<a name="l00202"></a>00202 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (! isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;mr_configure&#39;</span>]) &amp;&amp; ! isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;repl_clear_scr&#39;</span>])) {
<a name="l00203"></a>00203     <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;url_params&#39;</span>];
<a name="l00204"></a>00204     <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;mr_configure&#39;</span>] = <span class="keyword">true</span>;
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     echo <span class="stringliteral">&#39;&lt;fieldset&gt;&#39;</span>;
<a name="l00207"></a>00207     echo <span class="stringliteral">&#39;&lt;legend&gt;&#39;</span> . __(<span class="stringliteral">&#39;Master replication&#39;</span>) . <span class="stringliteral">&#39;&lt;/legend&gt;&#39;</span>;
<a name="l00208"></a>00208     echo sprintf(__(<span class="stringliteral">&#39;This server is not configured as master in a replication process. Would you like to &lt;a href=&quot;%s&quot;&gt;configure&lt;/a&gt; it?&#39;</span>), <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>));
<a name="l00209"></a>00209     echo <span class="stringliteral">&#39;&lt;/fieldset&gt;&#39;</span>;
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00212"></a><a class="code" href="server__replication_8php.html#a4495736f027f94dc794edac2a10c9212">00212</a> <span class="keywordflow">if</span> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;mr_configure&#39;</span>])) {
<a name="l00213"></a>00213     <span class="comment">// Render the &#39;Master configuration&#39; section</span>
<a name="l00214"></a>00214     echo <span class="stringliteral">&#39;&lt;fieldset&gt;&#39;</span>;
<a name="l00215"></a>00215     echo <span class="stringliteral">&#39;&lt;legend&gt;&#39;</span> . __(<span class="stringliteral">&#39;Master configuration&#39;</span>) . <span class="stringliteral">&#39;&lt;/legend&gt;&#39;</span>;
<a name="l00216"></a>00216     echo __(<span class="stringliteral">&#39;This server is not configured as master server in a replication process. You can choose from either replicating all databases and ignoring certain (useful if you want to replicate majority of databases) or you can choose to ignore all databases by default and allow only certain databases to be replicated. Please select the mode:&#39;</span>) . <span class="stringliteral">&#39;&lt;br /&gt;&lt;br /&gt;&#39;</span>;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     echo <span class="stringliteral">&#39;&lt;select name=&quot;db_type&quot; id=&quot;db_type&quot;&gt;&#39;</span>;
<a name="l00219"></a>00219     echo <span class="stringliteral">&#39;&lt;option value=&quot;all&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Replicate all databases; Ignore:&#39;</span>) . <span class="stringliteral">&#39;&lt;/option&gt;&#39;</span>;
<a name="l00220"></a>00220     echo <span class="stringliteral">&#39;&lt;option value=&quot;ign&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Ignore all databases; Replicate:&#39;</span>) . <span class="stringliteral">&#39;&lt;/option&gt;&#39;</span>;
<a name="l00221"></a>00221     echo <span class="stringliteral">&#39;&lt;/select&gt;&#39;</span>;
<a name="l00222"></a>00222     echo <span class="stringliteral">&#39;&lt;br /&gt;&lt;br /&gt;&#39;</span>;
<a name="l00223"></a>00223     echo __(<span class="stringliteral">&#39;Please select databases:&#39;</span>) . <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>;
<a name="l00224"></a>00224     echo <a class="code" href="replication__gui_8lib_8php.html#af39181a397b2573a064f17b342299314" title="returns code for selecting databases">PMA_replication_db_multibox</a>();
<a name="l00225"></a>00225     echo <span class="stringliteral">&#39;&lt;br /&gt;&lt;br /&gt;&#39;</span>;
<a name="l00226"></a>00226     echo __(<span class="stringliteral">&#39;Now, add the following lines at the end of [mysqld] section in your my.cnf and please restart the MySQL server afterwards.&#39;</span>) . <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>;
<a name="l00227"></a>00227     echo <span class="stringliteral">&#39;&lt;pre id=&quot;rep&quot;&gt;&lt;/pre&gt;&#39;</span>;
<a name="l00228"></a>00228     echo __(<span class="stringliteral">&#39;Once you restarted MySQL server, please click on Go button. Afterwards, you should see a message informing you, that this server &lt;b&gt;is&lt;/b&gt; configured as master&#39;</span>);
<a name="l00229"></a>00229     echo <span class="stringliteral">&#39;&lt;/fieldset&gt;&#39;</span>;
<a name="l00230"></a>00230     echo <span class="stringliteral">&#39;&lt;fieldset class=&quot;tblFooters&quot;&gt;&#39;</span>;
<a name="l00231"></a>00231     echo <span class="stringliteral">&#39; &lt;form method=&quot;post&quot; action=&quot;server_replication.php&quot; &gt;&#39;</span>;
<a name="l00232"></a>00232     echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>(<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l00233"></a>00233     echo <span class="stringliteral">&#39;  &lt;input type=&quot;submit&quot; value=&quot;&#39;</span> . __(<span class="stringliteral">&#39;Go&#39;</span>) . <span class="stringliteral">&#39;&quot; id=&quot;goButton&quot; /&gt;&#39;</span>;
<a name="l00234"></a>00234     echo <span class="stringliteral">&#39; &lt;/form&gt;&#39;</span>;
<a name="l00235"></a>00235     echo <span class="stringliteral">&#39;&lt;/fieldset&gt;&#39;</span>;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     include <span class="stringliteral">&#39;./libraries/footer.inc.php&#39;</span>;
<a name="l00238"></a>00238     <a class="code" href="footer_8inc_8php.html#a74ed6a30cde2182cef18dc4d7d998773" title="for PMA_setHistory()">exit</a>;
<a name="l00239"></a>00239 }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 echo <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 <span class="keywordflow">if</span> (! isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;repl_clear_scr&#39;</span>])) {
<a name="l00244"></a>00244     <span class="comment">// Render the &#39;Slave configuration&#39; section</span>
<a name="l00245"></a>00245     echo <span class="stringliteral">&#39;&lt;fieldset&gt;&#39;</span>;
<a name="l00246"></a>00246     echo <span class="stringliteral">&#39;&lt;legend&gt;&#39;</span> . __(<span class="stringliteral">&#39;Slave replication&#39;</span>) . <span class="stringliteral">&#39;&lt;/legend&gt;&#39;</span>;
<a name="l00247"></a>00247     <span class="keywordflow">if</span> ($server_slave_status) {
<a name="l00248"></a>00248         echo <span class="stringliteral">&#39;&lt;div id=&quot;slave_configuration_gui&quot;&gt;&#39;</span>;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;url_params&#39;</span>];
<a name="l00251"></a>00251         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_take_action&#39;</span>] = <span class="keyword">true</span>;
<a name="l00252"></a>00252         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_server_control&#39;</span>] = <span class="keyword">true</span>;
<a name="l00253"></a>00253 
<a name="l00254"></a>00254         <span class="keywordflow">if</span> (<a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_IO_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span>) {
<a name="l00255"></a>00255             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_action&#39;</span>] = <span class="stringliteral">&#39;start&#39;</span>;
<a name="l00256"></a>00256         } <span class="keywordflow">else</span> {
<a name="l00257"></a>00257             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_action&#39;</span>] = <span class="stringliteral">&#39;stop&#39;</span>;
<a name="l00258"></a>00258         }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_control_parm&#39;</span>] = <span class="stringliteral">&#39;IO_THREAD&#39;</span>;
<a name="l00261"></a>00261         $slave_control_io_link = <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l00262"></a>00262 
<a name="l00263"></a>00263         <span class="keywordflow">if</span> (<a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_SQL_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span>) {
<a name="l00264"></a>00264             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_action&#39;</span>] = <span class="stringliteral">&#39;start&#39;</span>;
<a name="l00265"></a>00265         } <span class="keywordflow">else</span> {
<a name="l00266"></a>00266             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_action&#39;</span>] = <span class="stringliteral">&#39;stop&#39;</span>;
<a name="l00267"></a>00267         }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_control_parm&#39;</span>] = <span class="stringliteral">&#39;SQL_THREAD&#39;</span>;
<a name="l00270"></a>00270         $slave_control_sql_link = <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272         <span class="keywordflow">if</span> (<a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_IO_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span>
<a name="l00273"></a>00273             || <a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_SQL_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span>
<a name="l00274"></a>00274         ) {
<a name="l00275"></a>00275             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_action&#39;</span>] = <span class="stringliteral">&#39;start&#39;</span>;
<a name="l00276"></a>00276         } <span class="keywordflow">else</span> {
<a name="l00277"></a>00277             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_action&#39;</span>] = <span class="stringliteral">&#39;stop&#39;</span>;
<a name="l00278"></a>00278         }
<a name="l00279"></a>00279 
<a name="l00280"></a>00280         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_control_parm&#39;</span>] = null;
<a name="l00281"></a>00281         $slave_control_full_link = <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l00282"></a>00282 
<a name="l00283"></a>00283         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_action&#39;</span>] = <span class="stringliteral">&#39;reset&#39;</span>;
<a name="l00284"></a>00284         $slave_control_reset_link = <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;url_params&#39;</span>];
<a name="l00287"></a>00287         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sr_slave_skip_error&#39;</span>] = <span class="keyword">true</span>;
<a name="l00288"></a>00288         $slave_skip_error_link = <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290         <span class="keywordflow">if</span> (<a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_SQL_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span>) {
<a name="l00291"></a>00291             <a class="code" href="classPMA__Message.html#ac1eedc27bd176676149c300379b98661" title="get PMA_Message of type error">PMA_Message::error</a>(__(<span class="stringliteral">&#39;Slave SQL Thread not running!&#39;</span>))-&gt;display();
<a name="l00292"></a>00292         }
<a name="l00293"></a>00293         <span class="keywordflow">if</span> (<a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_IO_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span>) {
<a name="l00294"></a>00294             <a class="code" href="classPMA__Message.html#ac1eedc27bd176676149c300379b98661" title="get PMA_Message of type error">PMA_Message::error</a>(__(<span class="stringliteral">&#39;Slave IO Thread not running!&#39;</span>))-&gt;display();
<a name="l00295"></a>00295         }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;url_params&#39;</span>];
<a name="l00298"></a>00298         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sl_configure&#39;</span>] = <span class="keyword">true</span>;
<a name="l00299"></a>00299         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;repl_clear_scr&#39;</span>] = <span class="keyword">true</span>;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301         $reconfiguremaster_link = <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l00302"></a>00302 
<a name="l00303"></a>00303         echo __(<span class="stringliteral">&#39;Server is configured as slave in a replication process. Would you like to:&#39;</span>);
<a name="l00304"></a>00304         echo <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>;
<a name="l00305"></a>00305         echo <span class="stringliteral">&#39;&lt;ul&gt;&#39;</span>;
<a name="l00306"></a>00306         echo <span class="stringliteral">&#39; &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;slave_status_href&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;See slave status table&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00307"></a>00307         echo <a class="code" href="replication__gui_8lib_8php.html#adb80f6e44c4eed5e1bf606f1c5ca1090" title="This function prints out table with replication status.">PMA_replication_print_status_table</a>(<span class="stringliteral">&#39;slave&#39;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);
<a name="l00308"></a>00308         <span class="keywordflow">if</span> (isset(<a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_correct&#39;</span>]) &amp;&amp; <a class="code" href="import_8php.html#a3469aa7fd930b721cec515c385833a65" title="Get the variables sent or posted to this script and a core script.">$_SESSION</a>[<span class="stringliteral">&#39;replication&#39;</span>][<span class="stringliteral">&#39;m_correct&#39;</span>] == <span class="keyword">true</span>) {
<a name="l00309"></a>00309             echo <span class="stringliteral">&#39; &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;slave_synchronization_href&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Synchronize databases with master&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00310"></a>00310             echo <span class="stringliteral">&#39; &lt;div id=&quot;slave_synchronization_gui&quot; style=&quot;display: none&quot;&gt;&#39;</span>;
<a name="l00311"></a>00311             echo <span class="stringliteral">&#39;  &lt;form method=&quot;post&quot; action=&quot;server_replication.php&quot;&gt;&#39;</span>;
<a name="l00312"></a>00312             echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>(<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l00313"></a>00313             echo <span class="stringliteral">&#39;   &lt;input type=&quot;checkbox&quot; name=&quot;repl_struc&quot; value=&quot;1&quot; checked=&quot;checked&quot; disabled=&quot;disabled&quot; /&gt; &#39;</span> . __(<span class="stringliteral">&#39;Structure&#39;</span>) . <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>; <span class="comment">// this is just for vizualization, it has no other purpose</span>
<a name="l00314"></a>00314             echo <span class="stringliteral">&#39;   &lt;input type=&quot;checkbox&quot; name=&quot;repl_data&quot;  value=&quot;1&quot; checked=&quot;checked&quot; /&gt; &#39;</span> . __(<span class="stringliteral">&#39;Data&#39;</span>) .<span class="stringliteral">&#39; &lt;br /&gt;&#39;</span>;
<a name="l00315"></a>00315             echo <span class="stringliteral">&#39;   &lt;input type=&quot;hidden&quot; name=&quot;sr_take_action&quot; value=&quot;1&quot; /&gt;&#39;</span>;
<a name="l00316"></a>00316             echo <span class="stringliteral">&#39;   &lt;input type=&quot;submit&quot; name=&quot;sl_sync&quot; value=&quot;&#39;</span> . __(<span class="stringliteral">&#39;Go&#39;</span>) . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l00317"></a>00317             echo <span class="stringliteral">&#39;  &lt;/form&gt;&#39;</span>;
<a name="l00318"></a>00318             echo <span class="stringliteral">&#39; &lt;/div&gt;&#39;</span>;
<a name="l00319"></a>00319         }
<a name="l00320"></a>00320         echo <span class="stringliteral">&#39; &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;slave_control_href&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Control slave:&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&#39;</span>;
<a name="l00321"></a>00321         echo <span class="stringliteral">&#39; &lt;div id=&quot;slave_control_gui&quot; style=&quot;display: none&quot;&gt;&#39;</span>;
<a name="l00322"></a>00322         echo <span class="stringliteral">&#39;  &lt;ul&gt;&#39;</span>;
<a name="l00323"></a>00323         echo <span class="stringliteral">&#39;   &lt;li&gt;&lt;a href=&quot;&#39;</span>. $slave_control_full_link . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . ((<a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_IO_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span> || <a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_SQL_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span>) ? __(<span class="stringliteral">&#39;Full start&#39;</span>) : __(<span class="stringliteral">&#39;Full stop&#39;</span>)) . <span class="stringliteral">&#39; &lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00324"></a>00324         echo <span class="stringliteral">&#39;   &lt;li&gt;&lt;a href=&quot;&#39;</span>. $slave_control_reset_link . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Reset slave&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00325"></a>00325         <span class="keywordflow">if</span> (<a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_SQL_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span>) {
<a name="l00326"></a>00326             echo <span class="stringliteral">&#39;   &lt;li&gt;&lt;a href=&quot;&#39;</span> . $slave_control_sql_link . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Start SQL Thread only&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00327"></a>00327         } <span class="keywordflow">else</span> {
<a name="l00328"></a>00328             echo <span class="stringliteral">&#39;   &lt;li&gt;&lt;a href=&quot;&#39;</span> . $slave_control_sql_link . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Stop SQL Thread only&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00329"></a>00329         }
<a name="l00330"></a>00330         <span class="keywordflow">if</span> (<a class="code" href="replication_8inc_8php.html#a89863582b7f5cac5adb6a7acfe2d454b" title="get slave replication from server">$server_slave_replication</a>[0][<span class="stringliteral">&#39;Slave_IO_Running&#39;</span>] == <span class="stringliteral">&#39;No&#39;</span>) {
<a name="l00331"></a>00331             echo <span class="stringliteral">&#39;   &lt;li&gt;&lt;a href=&quot;&#39;</span> . $slave_control_io_link . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Start IO Thread only&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00332"></a>00332         } <span class="keywordflow">else</span> {
<a name="l00333"></a>00333             echo <span class="stringliteral">&#39;   &lt;li&gt;&lt;a href=&quot;&#39;</span> . $slave_control_io_link . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Stop IO Thread only&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00334"></a>00334         }
<a name="l00335"></a>00335         echo <span class="stringliteral">&#39;  &lt;/ul&gt;&#39;</span>;
<a name="l00336"></a>00336         echo <span class="stringliteral">&#39; &lt;/div&gt;&#39;</span>;
<a name="l00337"></a>00337         echo <span class="stringliteral">&#39; &lt;/li&gt;&#39;</span>;
<a name="l00338"></a>00338         echo <span class="stringliteral">&#39; &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;slave_errormanagement_href&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Error management:&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&#39;</span>;
<a name="l00339"></a>00339         echo <span class="stringliteral">&#39; &lt;div id=&quot;slave_errormanagement_gui&quot; style=&quot;display: none&quot;&gt;&#39;</span>;
<a name="l00340"></a>00340         <a class="code" href="classPMA__Message.html#ac1eedc27bd176676149c300379b98661" title="get PMA_Message of type error">PMA_Message::error</a>(__(<span class="stringliteral">&#39;Skipping errors might lead into unsynchronized master and slave!&#39;</span>))-&gt;display();
<a name="l00341"></a>00341         echo <span class="stringliteral">&#39;  &lt;ul&gt;&#39;</span>;
<a name="l00342"></a>00342         echo <span class="stringliteral">&#39;   &lt;li&gt;&lt;a href=&quot;&#39;</span> . $slave_skip_error_link . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Skip current error&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00343"></a>00343         echo <span class="stringliteral">&#39;   &lt;li&gt;&#39;</span> . __(<span class="stringliteral">&#39;Skip next&#39;</span>);
<a name="l00344"></a>00344         echo <span class="stringliteral">&#39;    &lt;form method=&quot;post&quot; action=&quot;server_replication.php&quot;&gt;&#39;</span>;
<a name="l00345"></a>00345         echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>(<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l00346"></a>00346         echo <span class="stringliteral">&#39;      &lt;input type=&quot;text&quot; name=&quot;sr_skip_errors_count&quot; value=&quot;1&quot; style=&quot;width: 30px&quot; /&gt;&#39;</span> . __(<span class="stringliteral">&#39;errors.&#39;</span>);
<a name="l00347"></a>00347         echo <span class="stringliteral">&#39;              &lt;input type=&quot;submit&quot; name=&quot;sr_slave_skip_error&quot; value=&quot;&#39;</span> . __(<span class="stringliteral">&#39;Go&#39;</span>) . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l00348"></a>00348         echo <span class="stringliteral">&#39;      &lt;input type=&quot;hidden&quot; name=&quot;sr_take_action&quot; value=&quot;1&quot; /&gt;&#39;</span>;
<a name="l00349"></a>00349         echo <span class="stringliteral">&#39;    &lt;/form&gt;&lt;/li&gt;&#39;</span>;
<a name="l00350"></a>00350         echo <span class="stringliteral">&#39;  &lt;/ul&gt;&#39;</span>;
<a name="l00351"></a>00351         echo <span class="stringliteral">&#39; &lt;/div&gt;&#39;</span>;
<a name="l00352"></a>00352         echo <span class="stringliteral">&#39; &lt;/li&gt;&#39;</span>;
<a name="l00353"></a>00353         echo <span class="stringliteral">&#39; &lt;li&gt;&lt;a href=&quot;&#39;</span> . $reconfiguremaster_link . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . __(<span class="stringliteral">&#39;Change or reconfigure master server&#39;</span>) . <span class="stringliteral">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span>;
<a name="l00354"></a>00354         echo <span class="stringliteral">&#39;&lt;/ul&gt;&#39;</span>;
<a name="l00355"></a>00355 
<a name="l00356"></a>00356     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (! isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sl_configure&#39;</span>])) {
<a name="l00357"></a>00357         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = <a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;url_params&#39;</span>];
<a name="l00358"></a>00358         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sl_configure&#39;</span>] = <span class="keyword">true</span>;
<a name="l00359"></a>00359         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;repl_clear_scr&#39;</span>] = <span class="keyword">true</span>;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361         echo sprintf(__(<span class="stringliteral">&#39;This server is not configured as slave in a replication process. Would you like to &lt;a href=&quot;%s&quot;&gt;configure&lt;/a&gt; it?&#39;</span>), <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>));
<a name="l00362"></a>00362     }
<a name="l00363"></a>00363     echo <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;
<a name="l00364"></a>00364     echo <span class="stringliteral">&#39;&lt;/fieldset&gt;&#39;</span>;
<a name="l00365"></a>00365 }
<a name="l00366"></a><a class="code" href="server__replication_8php.html#a03dca0d93fdb841a76cc422de8fff66f">00366</a> <span class="keywordflow">if</span> (isset(<a class="code" href="oss__fr_8php.html#a6b9bfa59e3c28a706f7baf8c57e4f254">$GLOBALS</a>[<span class="stringliteral">&#39;sl_configure&#39;</span>])) {
<a name="l00367"></a>00367     <a class="code" href="replication__gui_8lib_8php.html#a2c12e8269b6265a05629cf21a086ef98" title="prints out code for changing master">PMA_replication_gui_changemaster</a>(<span class="stringliteral">&quot;slave_changemaster&quot;</span>);
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 require <span class="stringliteral">&#39;./libraries/footer.inc.php&#39;</span>;
<a name="l00370"></a>00370 ?&gt;
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="server__replication_8php.html">server_replication.php</a>      </li>

    <li class="footer">Generated on Sat Apr 27 2013 13:18:32 for RFSCMSAPIDocumentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
