<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RFSCMSAPIDocumentation: display_tbl.lib.php Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">RFSCMSAPIDocumentation
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('display__tbl_8lib_8php.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">display_tbl.lib.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="display__tbl_8lib_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 <span class="comment">/* vim: set expandtab sw=4 ts=4 sts=4: */</span><span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">/**</span>
<a name="l00004"></a>00004 <span class="comment"> * library for displaying table with results from all sort of select queries</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * @package PhpMyAdmin</span>
<a name="l00007"></a>00007 <span class="comment"> */</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">/**</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> */</span>
<a name="l00012"></a>00012 require_once <span class="stringliteral">&#39;./libraries/Index.class.php&#39;</span>;
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">/**</span>
<a name="l00015"></a>00015 <span class="comment"> * Defines the display mode to use for the results of a SQL query</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * It uses a synthetic string that contains all the required informations.</span>
<a name="l00018"></a>00018 <span class="comment"> * In this string:</span>
<a name="l00019"></a>00019 <span class="comment"> *   - the first two characters stand for the action to do while</span>
<a name="l00020"></a>00020 <span class="comment"> *     clicking on the &quot;edit&quot; link (e.g. &#39;ur&#39; for update a row, &#39;nn&#39; for no</span>
<a name="l00021"></a>00021 <span class="comment"> *     edit link...);</span>
<a name="l00022"></a>00022 <span class="comment"> *   - the next two characters stand for the action to do while</span>
<a name="l00023"></a>00023 <span class="comment"> *     clicking on the &quot;delete&quot; link (e.g. &#39;kp&#39; for kill a process, &#39;nn&#39; for</span>
<a name="l00024"></a>00024 <span class="comment"> *     no delete link...);</span>
<a name="l00025"></a>00025 <span class="comment"> *   - the next characters are boolean values (1/0) and respectively stand</span>
<a name="l00026"></a>00026 <span class="comment"> *     for sorting links, navigation bar, &quot;insert a new row&quot; link, the</span>
<a name="l00027"></a>00027 <span class="comment"> *     bookmark feature, the expand/collapse text/blob fields button and</span>
<a name="l00028"></a>00028 <span class="comment"> *     the &quot;display printable view&quot; option.</span>
<a name="l00029"></a>00029 <span class="comment"> *     Of course &#39;0&#39;/&#39;1&#39; means the feature won&#39;t/will be enabled.</span>
<a name="l00030"></a>00030 <span class="comment"> *</span>
<a name="l00031"></a>00031 <span class="comment"> * @param string  &amp;$the_disp_mode the synthetic value for display_mode (see a few</span>
<a name="l00032"></a>00032 <span class="comment"> *                                lines above for explanations)</span>
<a name="l00033"></a>00033 <span class="comment"> * @param integer &amp;$the_total     the total number of rows returned by the SQL query</span>
<a name="l00034"></a>00034 <span class="comment"> *                                without any programmatically appended &quot;LIMIT&quot; clause</span>
<a name="l00035"></a>00035 <span class="comment"> *                                (just a copy of $unlim_num_rows if it exists, else</span>
<a name="l00036"></a>00036 <span class="comment"> *                                computed inside this function)</span>
<a name="l00037"></a>00037 <span class="comment"> *</span>
<a name="l00038"></a>00038 <span class="comment"> * @return  array    an array with explicit indexes for all the display</span>
<a name="l00039"></a>00039 <span class="comment"> *                   elements</span>
<a name="l00040"></a>00040 <span class="comment"> *</span>
<a name="l00041"></a>00041 <span class="comment"> * @global  string   the database name</span>
<a name="l00042"></a>00042 <span class="comment"> * @global  string   the table name</span>
<a name="l00043"></a>00043 <span class="comment"> * @global  integer  the total number of rows returned by the SQL query</span>
<a name="l00044"></a>00044 <span class="comment"> *                   without any programmatically appended &quot;LIMIT&quot; clause</span>
<a name="l00045"></a>00045 <span class="comment"> * @global  array    the properties of the fields returned by the query</span>
<a name="l00046"></a>00046 <span class="comment"> * @global  string   the URL to return to in case of error in a SQL</span>
<a name="l00047"></a>00047 <span class="comment"> *                   statement</span>
<a name="l00048"></a>00048 <span class="comment"> *</span>
<a name="l00049"></a>00049 <span class="comment"> * @access  private</span>
<a name="l00050"></a>00050 <span class="comment"> *</span>
<a name="l00051"></a>00051 <span class="comment"> * @see     PMA_displayTable()</span>
<a name="l00052"></a>00052 <span class="comment"> */</span>
<a name="l00053"></a><a class="code" href="display__tbl_8lib_8php.html#a1d6c4bbc5354600cc41634d3dd8066b9">00053</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a1d6c4bbc5354600cc41634d3dd8066b9" title="Defines the display mode to use for the results of a SQL query.">PMA_setDisplayMode</a>(&amp;$the_disp_mode, &amp;$the_total)
<a name="l00054"></a>00054 {
<a name="l00055"></a>00055     global <a class="code" href="schema__export_8php.html#a907d78797a1b764e913b0c565a5097b0" title="get all the export options and verify call and include the appropriate Schema Class depending on $exp...">$db</a>, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>;
<a name="l00056"></a>00056     global $unlim_num_rows, $fields_meta;
<a name="l00057"></a>00057     global <a class="code" href="db__create_8php.html#a83e98b25d56666051a069a2d2b5d371b" title="Defines the url to return to in case of error in a sql statement.">$err_url</a>;
<a name="l00058"></a>00058 
<a name="l00059"></a>00059     <span class="comment">// 1. Initializes the $do_display array</span>
<a name="l00060"></a>00060     $do_display              = array();
<a name="l00061"></a>00061     $do_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>]  = $the_disp_mode[0] . $the_disp_mode[1];
<a name="l00062"></a>00062     $do_display[<span class="stringliteral">&#39;del_lnk&#39;</span>]   = $the_disp_mode[2] . $the_disp_mode[3];
<a name="l00063"></a>00063     $do_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>]  = (string) $the_disp_mode[4];
<a name="l00064"></a>00064     $do_display[<span class="stringliteral">&#39;nav_bar&#39;</span>]   = (string) $the_disp_mode[5];
<a name="l00065"></a>00065     $do_display[<span class="stringliteral">&#39;ins_row&#39;</span>]   = (string) $the_disp_mode[6];
<a name="l00066"></a>00066     $do_display[<span class="stringliteral">&#39;bkm_form&#39;</span>]  = (string) $the_disp_mode[7];
<a name="l00067"></a>00067     $do_display[<span class="stringliteral">&#39;text_btn&#39;</span>]  = (string) $the_disp_mode[8];
<a name="l00068"></a>00068     $do_display[<span class="stringliteral">&#39;pview_lnk&#39;</span>] = (string) $the_disp_mode[9];
<a name="l00069"></a>00069 
<a name="l00070"></a>00070     <span class="comment">// 2. Display mode is not &quot;false for all elements&quot; -&gt; updates the</span>
<a name="l00071"></a>00071     <span class="comment">// display mode</span>
<a name="l00072"></a>00072     <span class="keywordflow">if</span> ($the_disp_mode != <span class="stringliteral">&#39;nnnn000000&#39;</span>) {
<a name="l00073"></a>00073         <span class="keywordflow">if</span> (isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>]) &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l00074"></a>00074             <span class="comment">// 2.0 Print view -&gt; set all elements to false!</span>
<a name="l00075"></a>00075             $do_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>]  = <span class="stringliteral">&#39;nn&#39;</span>; <span class="comment">// no edit link</span>
<a name="l00076"></a>00076             $do_display[<span class="stringliteral">&#39;del_lnk&#39;</span>]   = <span class="stringliteral">&#39;nn&#39;</span>; <span class="comment">// no delete link</span>
<a name="l00077"></a>00077             $do_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>]  = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00078"></a>00078             $do_display[<span class="stringliteral">&#39;nav_bar&#39;</span>]   = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00079"></a>00079             $do_display[<span class="stringliteral">&#39;ins_row&#39;</span>]   = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00080"></a>00080             $do_display[<span class="stringliteral">&#39;bkm_form&#39;</span>]  = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00081"></a>00081             $do_display[<span class="stringliteral">&#39;text_btn&#39;</span>]  = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00082"></a>00082             $do_display[<span class="stringliteral">&#39;pview_lnk&#39;</span>] = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00083"></a>00083         } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;is_count&#39;</span>] || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;is_analyse&#39;</span>]
<a name="l00084"></a>00084             || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;is_maint&#39;</span>] || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;is_explain&#39;</span>]
<a name="l00085"></a>00085             ) {
<a name="l00086"></a>00086             <span class="comment">// 2.1 Statement is a &quot;SELECT COUNT&quot;, a</span>
<a name="l00087"></a>00087             <span class="comment">//     &quot;CHECK/ANALYZE/REPAIR/OPTIMIZE&quot;, an &quot;EXPLAIN&quot; one or</span>
<a name="l00088"></a>00088             <span class="comment">//     contains a &quot;PROC ANALYSE&quot; part</span>
<a name="l00089"></a>00089             $do_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>]  = <span class="stringliteral">&#39;nn&#39;</span>; <span class="comment">// no edit link</span>
<a name="l00090"></a>00090             $do_display[<span class="stringliteral">&#39;del_lnk&#39;</span>]   = <span class="stringliteral">&#39;nn&#39;</span>; <span class="comment">// no delete link</span>
<a name="l00091"></a>00091             $do_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>]  = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00092"></a>00092             $do_display[<span class="stringliteral">&#39;nav_bar&#39;</span>]   = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00093"></a>00093             $do_display[<span class="stringliteral">&#39;ins_row&#39;</span>]   = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00094"></a>00094             $do_display[<span class="stringliteral">&#39;bkm_form&#39;</span>]  = (string) <span class="charliteral">&#39;1&#39;</span>;
<a name="l00095"></a>00095             <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;is_maint&#39;</span>]) {
<a name="l00096"></a>00096                 $do_display[<span class="stringliteral">&#39;text_btn&#39;</span>]  = (string) <span class="charliteral">&#39;1&#39;</span>;
<a name="l00097"></a>00097             } <span class="keywordflow">else</span> {
<a name="l00098"></a>00098                 $do_display[<span class="stringliteral">&#39;text_btn&#39;</span>]  = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00099"></a>00099             }
<a name="l00100"></a>00100             $do_display[<span class="stringliteral">&#39;pview_lnk&#39;</span>] = (string) <span class="charliteral">&#39;1&#39;</span>;
<a name="l00101"></a>00101         } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;is_show&#39;</span>]) {
<a name="l00102"></a>00102             <span class="comment">// 2.2 Statement is a &quot;SHOW...&quot;</span><span class="comment"></span>
<a name="l00103"></a>00103 <span class="comment">            /**</span>
<a name="l00104"></a>00104 <span class="comment">             * 2.2.1</span>
<a name="l00105"></a>00105 <span class="comment">             * @todo defines edit/delete links depending on show statement</span>
<a name="l00106"></a>00106 <span class="comment">             */</span>
<a name="l00107"></a>00107             $tmp = preg_match(<span class="stringliteral">&#39;@^SHOW[[:space:]]+(VARIABLES|(FULL[[:space:]]+)?PROCESSLIST|STATUS|TABLE|GRANTS|CREATE|LOGS|DATABASES|FIELDS)@i&#39;</span>, <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;sql_query&#39;</span>], <a class="code" href="slogan_8php.html#ae68766bfcc2b1965650856cc97da0512">$which</a>);
<a name="l00108"></a>00108             <span class="keywordflow">if</span> (isset(<a class="code" href="slogan_8php.html#ae68766bfcc2b1965650856cc97da0512">$which</a>[1]) &amp;&amp; strpos(<span class="charliteral">&#39; &#39;</span> . strtoupper(<a class="code" href="slogan_8php.html#ae68766bfcc2b1965650856cc97da0512">$which</a>[1]), <span class="stringliteral">&#39;PROCESSLIST&#39;</span>) &gt; 0) {
<a name="l00109"></a>00109                 $do_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] = <span class="stringliteral">&#39;nn&#39;</span>; <span class="comment">// no edit link</span>
<a name="l00110"></a>00110                 $do_display[<span class="stringliteral">&#39;del_lnk&#39;</span>]  = <span class="stringliteral">&#39;kp&#39;</span>; <span class="comment">// &quot;kill process&quot; type edit link</span>
<a name="l00111"></a>00111             } <span class="keywordflow">else</span> {
<a name="l00112"></a>00112                 <span class="comment">// Default case -&gt; no links</span>
<a name="l00113"></a>00113                 $do_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] = <span class="stringliteral">&#39;nn&#39;</span>; <span class="comment">// no edit link</span>
<a name="l00114"></a>00114                 $do_display[<span class="stringliteral">&#39;del_lnk&#39;</span>]  = <span class="stringliteral">&#39;nn&#39;</span>; <span class="comment">// no delete link</span>
<a name="l00115"></a>00115             }
<a name="l00116"></a>00116             <span class="comment">// 2.2.2 Other settings</span>
<a name="l00117"></a>00117             $do_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>]  = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00118"></a>00118             $do_display[<span class="stringliteral">&#39;nav_bar&#39;</span>]   = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00119"></a>00119             $do_display[<span class="stringliteral">&#39;ins_row&#39;</span>]   = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00120"></a>00120             $do_display[<span class="stringliteral">&#39;bkm_form&#39;</span>]  = (string) <span class="charliteral">&#39;1&#39;</span>;
<a name="l00121"></a>00121             $do_display[<span class="stringliteral">&#39;text_btn&#39;</span>]  = (string) <span class="charliteral">&#39;1&#39;</span>;
<a name="l00122"></a>00122             $do_display[<span class="stringliteral">&#39;pview_lnk&#39;</span>] = (string) <span class="charliteral">&#39;1&#39;</span>;
<a name="l00123"></a>00123         } <span class="keywordflow">else</span> {
<a name="l00124"></a>00124             <span class="comment">// 2.3 Other statements (ie &quot;SELECT&quot; ones) -&gt; updates</span>
<a name="l00125"></a>00125             <span class="comment">//     $do_display[&#39;edit_lnk&#39;], $do_display[&#39;del_lnk&#39;] and</span>
<a name="l00126"></a>00126             <span class="comment">//     $do_display[&#39;text_btn&#39;] (keeps other default values)</span>
<a name="l00127"></a>00127             $prev_table = $fields_meta[0]-&gt;table;
<a name="l00128"></a>00128             $do_display[<span class="stringliteral">&#39;text_btn&#39;</span>]  = (string) <span class="charliteral">&#39;1&#39;</span>;
<a name="l00129"></a>00129             <span class="keywordflow">for</span> (<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> = 0; <a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> &lt; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;fields_cnt&#39;</span>]; <a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>++) {
<a name="l00130"></a>00130                 $is_link = ($do_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>
<a name="l00131"></a>00131                             || $do_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>
<a name="l00132"></a>00132                             || $do_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>] != <span class="charliteral">&#39;0&#39;</span>
<a name="l00133"></a>00133                             || $do_display[<span class="stringliteral">&#39;ins_row&#39;</span>] != <span class="charliteral">&#39;0&#39;</span>);
<a name="l00134"></a>00134                 <span class="comment">// 2.3.2 Displays edit/delete/sort/insert links?</span>
<a name="l00135"></a>00135                 <span class="keywordflow">if</span> ($is_link
<a name="l00136"></a>00136                     &amp;&amp; ($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;table == <span class="stringliteral">&#39;&#39;</span> || $fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;table != $prev_table)
<a name="l00137"></a>00137                 ) {
<a name="l00138"></a>00138                     $do_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] = <span class="stringliteral">&#39;nn&#39;</span>; <span class="comment">// don&#39;t display links</span>
<a name="l00139"></a>00139                     $do_display[<span class="stringliteral">&#39;del_lnk&#39;</span>]  = <span class="stringliteral">&#39;nn&#39;</span>;<span class="comment"></span>
<a name="l00140"></a>00140 <span class="comment">                    /**</span>
<a name="l00141"></a>00141 <span class="comment">                     * @todo May be problematic with same fields names in two joined table.</span>
<a name="l00142"></a>00142 <span class="comment">                     */</span>
<a name="l00143"></a>00143                     <span class="comment">// $do_display[&#39;sort_lnk&#39;] = (string) &#39;0&#39;;</span>
<a name="l00144"></a>00144                     $do_display[<span class="stringliteral">&#39;ins_row&#39;</span>]  = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00145"></a>00145                     <span class="keywordflow">if</span> ($do_display[<span class="stringliteral">&#39;text_btn&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l00146"></a>00146                         <span class="keywordflow">break</span>;
<a name="l00147"></a>00147                     }
<a name="l00148"></a>00148                 } <span class="comment">// end if (2.3.2)</span>
<a name="l00149"></a>00149                 <span class="comment">// 2.3.3 Always display print view link</span>
<a name="l00150"></a>00150                 $do_display[<span class="stringliteral">&#39;pview_lnk&#39;</span>]    = (string) <span class="charliteral">&#39;1&#39;</span>;
<a name="l00151"></a>00151                 $prev_table = $fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;table;
<a name="l00152"></a>00152             } <span class="comment">// end for</span>
<a name="l00153"></a>00153         } <span class="comment">// end if..elseif...else (2.1 -&gt; 2.3)</span>
<a name="l00154"></a>00154     } <span class="comment">// end if (2)</span>
<a name="l00155"></a>00155 
<a name="l00156"></a>00156     <span class="comment">// 3. Gets the total number of rows if it is unknown</span>
<a name="l00157"></a>00157     <span class="keywordflow">if</span> (isset($unlim_num_rows) &amp;&amp; $unlim_num_rows != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00158"></a>00158         $the_total = $unlim_num_rows;
<a name="l00159"></a>00159     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (($do_display[<span class="stringliteral">&#39;nav_bar&#39;</span>] == <span class="charliteral">&#39;1&#39;</span> || $do_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>)
<a name="l00160"></a>00160              &amp;&amp; (strlen($db) &amp;&amp; !empty($table))) {
<a name="l00161"></a>00161         $the_total   = <a class="code" href="classPMA__Table.html#af4c743afaabb1e05e2336e1307ec2df3" title="Counts and returns (or displays) the number of records in a table.">PMA_Table::countRecords</a>($db, $table);
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <span class="comment">// 4. If navigation bar or sorting fields names URLs should be</span>
<a name="l00165"></a>00165     <span class="comment">//    displayed but there is only one row, change these settings to</span>
<a name="l00166"></a>00166     <span class="comment">//    false</span>
<a name="l00167"></a>00167     <span class="keywordflow">if</span> ($do_display[<span class="stringliteral">&#39;nav_bar&#39;</span>] == <span class="charliteral">&#39;1&#39;</span> || $do_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l00168"></a>00168 
<a name="l00169"></a>00169         <span class="comment">// - Do not display sort links if less than 2 rows.</span>
<a name="l00170"></a>00170         <span class="comment">// - For a VIEW we (probably) did not count the number of rows</span>
<a name="l00171"></a>00171         <span class="comment">//   so don&#39;t test this number here, it would remove the possibility</span>
<a name="l00172"></a>00172         <span class="comment">//   of sorting VIEW results.</span>
<a name="l00173"></a>00173         <span class="keywordflow">if</span> (isset($unlim_num_rows) &amp;&amp; $unlim_num_rows &lt; 2 &amp;&amp; ! <a class="code" href="classPMA__Table.html#af9040740c71098b2c58b3234d7f0afaa" title="returns whether the table is actually a view">PMA_Table::isView</a>($db, $table)) {
<a name="l00174"></a>00174             <span class="comment">// force display of navbar for vertical/horizontal display-choice.</span>
<a name="l00175"></a>00175             <span class="comment">// $do_display[&#39;nav_bar&#39;]  = (string) &#39;0&#39;;</span>
<a name="l00176"></a>00176             $do_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>] = (string) <span class="charliteral">&#39;0&#39;</span>;
<a name="l00177"></a>00177         }
<a name="l00178"></a>00178     } <span class="comment">// end if (3)</span>
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <span class="comment">// 5. Updates the synthetic var</span>
<a name="l00181"></a>00181     $the_disp_mode = join(<span class="stringliteral">&#39;&#39;</span>, $do_display);
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     <span class="keywordflow">return</span> $do_display;
<a name="l00184"></a>00184 } <span class="comment">// end of the &#39;PMA_setDisplayMode()&#39; function</span>
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="comment"></span>
<a name="l00187"></a>00187 <span class="comment">/**</span>
<a name="l00188"></a>00188 <span class="comment"> * Return true if we are executing a query in the form of</span>
<a name="l00189"></a>00189 <span class="comment"> * &quot;SELECT * FROM &lt;a table&gt; ...&quot;</span>
<a name="l00190"></a>00190 <span class="comment"> *</span>
<a name="l00191"></a>00191 <span class="comment"> * @return boolean</span>
<a name="l00192"></a>00192 <span class="comment"> */</span>
<a name="l00193"></a><a class="code" href="display__tbl_8lib_8php.html#a6ebb093d6eba080e154ab70b63261772">00193</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a6ebb093d6eba080e154ab70b63261772" title="Return true if we are executing a query in the form of &quot;SELECT * FROM &lt;a table&gt; ...&quot;.">PMA_isSelect</a>()
<a name="l00194"></a>00194 {
<a name="l00195"></a>00195     <span class="comment">// global variables set from sql.php</span>
<a name="l00196"></a>00196     global $is_count, $is_export, $is_func, $is_analyse;
<a name="l00197"></a>00197     global <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <span class="keywordflow">return</span> ! ($is_count || $is_export || $is_func || $is_analyse)
<a name="l00200"></a>00200         &amp;&amp; count($analyzed_sql[0][<span class="stringliteral">&#39;select_expr&#39;</span>]) == 0
<a name="l00201"></a>00201         &amp;&amp; isset($analyzed_sql[0][<span class="stringliteral">&#39;queryflags&#39;</span>][<span class="stringliteral">&#39;select_from&#39;</span>])
<a name="l00202"></a>00202         &amp;&amp; count($analyzed_sql[0][<span class="stringliteral">&#39;table_ref&#39;</span>]) == 1;
<a name="l00203"></a>00203 }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 <span class="comment"></span>
<a name="l00206"></a>00206 <span class="comment">/**</span>
<a name="l00207"></a>00207 <span class="comment"> * Displays a navigation button</span>
<a name="l00208"></a>00208 <span class="comment"> *</span>
<a name="l00209"></a>00209 <span class="comment"> * @param string  $caption            iconic caption for button</span>
<a name="l00210"></a>00210 <span class="comment"> * @param string  $title              text for button</span>
<a name="l00211"></a>00211 <span class="comment"> * @param integer $pos                position for next query</span>
<a name="l00212"></a>00212 <span class="comment"> * @param string  $html_sql_query     query ready for display</span>
<a name="l00213"></a>00213 <span class="comment"> * @param string  $onsubmit           optional onsubmit clause</span>
<a name="l00214"></a>00214 <span class="comment"> * @param string  $input_for_real_end optional hidden field for special treatment</span>
<a name="l00215"></a>00215 <span class="comment"> * @param string  $onclick            optional onclick clause</span>
<a name="l00216"></a>00216 <span class="comment"> *</span>
<a name="l00217"></a>00217 <span class="comment"> * @return nothing</span>
<a name="l00218"></a>00218 <span class="comment"> *</span>
<a name="l00219"></a>00219 <span class="comment"> * @global string   $db             the database name</span>
<a name="l00220"></a>00220 <span class="comment"> * @global string   $table          the table name</span>
<a name="l00221"></a>00221 <span class="comment"> * @global string   $goto           the URL to go back in case of errors</span>
<a name="l00222"></a>00222 <span class="comment"> *</span>
<a name="l00223"></a>00223 <span class="comment"> * @access private</span>
<a name="l00224"></a>00224 <span class="comment"> *</span>
<a name="l00225"></a>00225 <span class="comment"> * @see     PMA_displayTableNavigation()</span>
<a name="l00226"></a>00226 <span class="comment"> */</span>
<a name="l00227"></a><a class="code" href="display__tbl_8lib_8php.html#ac523ba4ef5f059b9eac487db8f173a2d">00227</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#ac523ba4ef5f059b9eac487db8f173a2d" title="Displays a navigation button.">PMA_displayTableNavigationOneButton</a>($caption, <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a>, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>, $html_sql_query, $onsubmit = <span class="stringliteral">&#39;&#39;</span>, $input_for_real_end = <span class="stringliteral">&#39;&#39;</span>, $onclick = <span class="stringliteral">&#39;&#39;</span>)
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229 
<a name="l00230"></a>00230     global <a class="code" href="schema__export_8php.html#a907d78797a1b764e913b0c565a5097b0" title="get all the export options and verify call and include the appropriate Schema Class depending on $exp...">$db</a>, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>, <a class="code" href="db__sql_8php.html#a4037a8ff7343cce7ab4dadfd490ad3ee">$goto</a>;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     $caption_output = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00233"></a>00233     <span class="comment">// for true or &#39;both&#39;</span>
<a name="l00234"></a>00234     <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;NavigationBarIconic&#39;</span>]) {
<a name="l00235"></a>00235         $caption_output .= $caption;
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237     <span class="comment">// for false or &#39;both&#39;</span>
<a name="l00238"></a>00238     <span class="keywordflow">if</span> (<span class="keyword">false</span> === <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;NavigationBarIconic&#39;</span>] || <span class="stringliteral">&#39;both&#39;</span> === <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;NavigationBarIconic&#39;</span>]) {
<a name="l00239"></a>00239         $caption_output .= <span class="stringliteral">&#39;&amp;nbsp;&#39;</span> . <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a>;
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241     $title_output = <span class="stringliteral">&#39; title=&quot;&#39;</span> . <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a> . <span class="charliteral">&#39;&quot;&#39;</span>;
<a name="l00242"></a>00242         ?&gt;
<a name="l00243"></a>00243 &lt;<a class="code" href="original_2css_2theme__right_8css_8php.html#a2cb7bbff99e906a4fef499891dc9e6f5">td</a>&gt;
<a name="l00244"></a>00244     &lt;form action=<span class="stringliteral">&quot;sql.php&quot;</span> method=<span class="stringliteral">&quot;post&quot;</span> &lt;?php echo $onsubmit; ?&gt;&gt;
<a name="l00245"></a>00245         &lt;?php echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>($db, $table); ?&gt;
<a name="l00246"></a>00246         &lt;input <a class="code" href="original_2css_2theme__right_8css_8php.html#ae1d92a0cf6d4204d310bc3b8ef7ec56a">type</a>=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;sql_query&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo $html_sql_query; ?&gt;&quot;</span> /&gt;
<a name="l00247"></a>00247         &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;pos&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo $pos; ?&gt;&quot;</span> /&gt;
<a name="l00248"></a>00248         &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;goto&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo $goto; ?&gt;&quot;</span> /&gt;
<a name="l00249"></a>00249         &lt;?php echo $input_for_real_end; ?&gt;
<a name="l00250"></a>00250         &lt;input type=<span class="stringliteral">&quot;submit&quot;</span> name=<span class="stringliteral">&quot;navig&quot;</span> &lt;?php echo (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;AjaxEnable&#39;</span>] ? <span class="stringliteral">&#39; class=&quot;ajax&quot; &#39;</span> : <span class="stringliteral">&#39;&#39;</span> ); ?&gt; value=<span class="stringliteral">&quot;&lt;?php echo $caption_output; ?&gt;&quot;</span>&lt;?php echo $title_output . $onclick; ?&gt; /&gt;
<a name="l00251"></a>00251     &lt;/form&gt;
<a name="l00252"></a>00252 &lt;/<a class="code" href="original_2css_2theme__right_8css_8php.html#a2cb7bbff99e906a4fef499891dc9e6f5">td</a>&gt;
<a name="l00253"></a>00253 &lt;?php
<a name="l00254"></a>00254 } <span class="comment">// end function PMA_displayTableNavigationOneButton()</span>
<a name="l00255"></a>00255 <span class="comment"></span>
<a name="l00256"></a>00256 <span class="comment">/**</span>
<a name="l00257"></a>00257 <span class="comment"> * Displays a navigation bar to browse among the results of a SQL query</span>
<a name="l00258"></a>00258 <span class="comment"> *</span>
<a name="l00259"></a>00259 <span class="comment"> * @param integer $pos_next                  the offset for the &quot;next&quot; page</span>
<a name="l00260"></a>00260 <span class="comment"> * @param integer $pos_prev                  the offset for the &quot;previous&quot; page</span>
<a name="l00261"></a>00261 <span class="comment"> * @param string  $sql_query                 the URL-encoded query</span>
<a name="l00262"></a>00262 <span class="comment"> * @param string  $id_for_direction_dropdown the id for the direction dropdown</span>
<a name="l00263"></a>00263 <span class="comment"> *</span>
<a name="l00264"></a>00264 <span class="comment"> * @return nothing</span>
<a name="l00265"></a>00265 <span class="comment"> *</span>
<a name="l00266"></a>00266 <span class="comment"> * @global  string   $db             the database name</span>
<a name="l00267"></a>00267 <span class="comment"> * @global  string   $table          the table name</span>
<a name="l00268"></a>00268 <span class="comment"> * @global  string   $goto           the URL to go back in case of errors</span>
<a name="l00269"></a>00269 <span class="comment"> * @global  integer  $num_rows       the total number of rows returned by the</span>
<a name="l00270"></a>00270 <span class="comment"> *                                   SQL query</span>
<a name="l00271"></a>00271 <span class="comment"> * @global  integer  $unlim_num_rows the total number of rows returned by the</span>
<a name="l00272"></a>00272 <span class="comment"> *                                   SQL any programmatically appended &quot;LIMIT&quot; clause</span>
<a name="l00273"></a>00273 <span class="comment"> * @global  boolean  $is_innodb      whether its InnoDB or not</span>
<a name="l00274"></a>00274 <span class="comment"> * @global  array    $showtable      table definitions</span>
<a name="l00275"></a>00275 <span class="comment"> *</span>
<a name="l00276"></a>00276 <span class="comment"> * @access  private</span>
<a name="l00277"></a>00277 <span class="comment"> *</span>
<a name="l00278"></a>00278 <span class="comment"> * @see     PMA_displayTable()</span>
<a name="l00279"></a>00279 <span class="comment"> */</span>
<a name="l00280"></a><a class="code" href="display__tbl_8lib_8php.html#ad976ef528675a4d65fd57ea37fc51e25">00280</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#ad976ef528675a4d65fd57ea37fc51e25" title="Displays a navigation bar to browse among the results of a SQL query.">PMA_displayTableNavigation</a>($pos_next, $pos_prev, <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>, $id_for_direction_dropdown)
<a name="l00281"></a>00281 {
<a name="l00282"></a>00282     global <a class="code" href="schema__export_8php.html#a907d78797a1b764e913b0c565a5097b0" title="get all the export options and verify call and include the appropriate Schema Class depending on $exp...">$db</a>, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>, <a class="code" href="db__sql_8php.html#a4037a8ff7343cce7ab4dadfd490ad3ee">$goto</a>;
<a name="l00283"></a>00283     global $num_rows, $unlim_num_rows;
<a name="l00284"></a>00284     global $is_innodb;
<a name="l00285"></a>00285     global <a class="code" href="tbl__info_8inc_8php.html#a165ba5f9dd92fc76b48e4932fdddbf73" title="Defining global variables, in case this script is included by a function.">$showtable</a>;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     <span class="comment">// here, using htmlentities() would cause problems if the query</span>
<a name="l00288"></a>00288     <span class="comment">// contains accented characters</span>
<a name="l00289"></a>00289     $html_sql_query = htmlspecialchars(<a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>);
<a name="l00290"></a>00290 <span class="comment"></span>
<a name="l00291"></a>00291 <span class="comment">    /**</span>
<a name="l00292"></a>00292 <span class="comment">     * @todo move this to a central place</span>
<a name="l00293"></a>00293 <span class="comment">     * @todo for other future table types</span>
<a name="l00294"></a>00294 <span class="comment">     */</span>
<a name="l00295"></a>00295     $is_innodb = (isset($showtable[<span class="stringliteral">&#39;Type&#39;</span>]) &amp;&amp; $showtable[<span class="stringliteral">&#39;Type&#39;</span>] == <span class="stringliteral">&#39;InnoDB&#39;</span>);
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     ?&gt;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 &lt;!-- Navigation bar --&gt;
<a name="l00300"></a>00300 &lt;table border=<span class="stringliteral">&quot;0&quot;</span> cellpadding=<span class="stringliteral">&quot;0&quot;</span> cellspacing=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;navigation&quot;</span>&gt;
<a name="l00301"></a>00301 &lt;tr&gt;
<a name="l00302"></a>00302     &lt;<a class="code" href="original_2css_2theme__right_8css_8php.html#a2cb7bbff99e906a4fef499891dc9e6f5">td</a> <span class="keyword">class</span>=<span class="stringliteral">&quot;navigation_separator&quot;</span>&gt;&lt;/td&gt;
<a name="l00303"></a>00303     &lt;?php
<a name="l00304"></a>00304     <span class="comment">// Move to the beginning or to the previous page</span>
<a name="l00305"></a>00305     <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;pos&#39;</span>] &amp;&amp; <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>] != <span class="stringliteral">&#39;all&#39;</span>) {
<a name="l00306"></a>00306         <a class="code" href="display__tbl_8lib_8php.html#ac523ba4ef5f059b9eac487db8f173a2d" title="Displays a navigation button.">PMA_displayTableNavigationOneButton</a>(<span class="stringliteral">&#39;&amp;lt;&amp;lt;&#39;</span>, _pgettext(<span class="stringliteral">&#39;First page&#39;</span>, <span class="stringliteral">&#39;Begin&#39;</span>), 0, $html_sql_query);
<a name="l00307"></a>00307         <a class="code" href="display__tbl_8lib_8php.html#ac523ba4ef5f059b9eac487db8f173a2d" title="Displays a navigation button.">PMA_displayTableNavigationOneButton</a>(<span class="stringliteral">&#39;&amp;lt;&#39;</span>, _pgettext(<span class="stringliteral">&#39;Previous page&#39;</span>, <span class="stringliteral">&#39;Previous&#39;</span>), $pos_prev, $html_sql_query);
<a name="l00308"></a>00308 
<a name="l00309"></a>00309     } <span class="comment">// end move back</span>
<a name="l00310"></a>00310 
<a name="l00311"></a>00311     $nbTotalPage = 1;
<a name="l00312"></a>00312     <span class="comment">//page redirection</span>
<a name="l00313"></a>00313     <span class="comment">// (unless we are showing all records)</span>
<a name="l00314"></a>00314     <span class="keywordflow">if</span> (<span class="stringliteral">&#39;all&#39;</span> != <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>]) { <span class="comment">//if1</span>
<a name="l00315"></a>00315         $pageNow = @floor(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;pos&#39;</span>] / <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>]) + 1;
<a name="l00316"></a>00316         $nbTotalPage = @ceil($unlim_num_rows / <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>]);
<a name="l00317"></a>00317 
<a name="l00318"></a>00318         <span class="keywordflow">if</span> ($nbTotalPage &gt; 1) { <span class="comment">//if2</span>
<a name="l00319"></a>00319        ?&gt;
<a name="l00320"></a>00320    &lt;td&gt;
<a name="l00321"></a>00321         &lt;?php
<a name="l00322"></a>00322             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l00323"></a>00323                 <span class="stringliteral">&#39;db&#39;</span>        =&gt; $db,
<a name="l00324"></a>00324                 <span class="stringliteral">&#39;table&#39;</span>     =&gt; $table,
<a name="l00325"></a>00325                 <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>,
<a name="l00326"></a>00326                 <span class="stringliteral">&#39;goto&#39;</span>      =&gt; $goto,
<a name="l00327"></a>00327             );
<a name="l00328"></a>00328             <span class="comment">//&lt;form&gt; to keep the form alignment of button &lt; and &lt;&lt;</span>
<a name="l00329"></a>00329             <span class="comment">// and also to know what to execute when the selector changes</span>
<a name="l00330"></a>00330             echo <span class="stringliteral">&#39;&lt;form action=&quot;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>($_url_params). <span class="stringliteral">&#39;&quot; method=&quot;post&quot;&gt;&#39;</span>;
<a name="l00331"></a>00331             echo <a class="code" href="common_8lib_8php.html#a6219ffebb2ae0980a8db4c5fd72f12ce" title="Generate a pagination selector for browsing resultsets.">PMA_pageselector</a>(
<a name="l00332"></a>00332                 <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>],
<a name="l00333"></a>00333                 $pageNow,
<a name="l00334"></a>00334                 $nbTotalPage,
<a name="l00335"></a>00335                 200,
<a name="l00336"></a>00336                 5,
<a name="l00337"></a>00337                 5,
<a name="l00338"></a>00338                 20,
<a name="l00339"></a>00339                 10
<a name="l00340"></a>00340             );
<a name="l00341"></a>00341         ?&gt;
<a name="l00342"></a>00342         &lt;/form&gt;
<a name="l00343"></a>00343     &lt;/td&gt;
<a name="l00344"></a>00344         &lt;?php
<a name="l00345"></a>00345         } <span class="comment">//_if2</span>
<a name="l00346"></a>00346     } <span class="comment">//_if1</span>
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     <span class="comment">// Display the &quot;Show all&quot; button if allowed</span>
<a name="l00349"></a>00349     <span class="keywordflow">if</span> (($num_rows &lt; $unlim_num_rows) &amp;&amp; (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;ShowAll&#39;</span>] || (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;MaxRows&#39;</span>] * 5 &gt;= $unlim_num_rows))) {
<a name="l00350"></a>00350         echo <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00351"></a>00351         ?&gt;
<a name="l00352"></a>00352     &lt;td&gt;
<a name="l00353"></a>00353         &lt;form action=<span class="stringliteral">&quot;sql.php&quot;</span> method=<span class="stringliteral">&quot;post&quot;</span>&gt;
<a name="l00354"></a>00354             &lt;?php echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>($db, $table); ?&gt;
<a name="l00355"></a>00355             &lt;input <a class="code" href="original_2css_2theme__right_8css_8php.html#ae1d92a0cf6d4204d310bc3b8ef7ec56a">type</a>=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;sql_query&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo $html_sql_query; ?&gt;&quot;</span> /&gt;
<a name="l00356"></a>00356             &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;pos&quot;</span> value=<span class="stringliteral">&quot;0&quot;</span> /&gt;
<a name="l00357"></a>00357             &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;session_max_rows&quot;</span> value=<span class="stringliteral">&quot;all&quot;</span> /&gt;
<a name="l00358"></a>00358             &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;goto&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo $goto; ?&gt;&quot;</span> /&gt;
<a name="l00359"></a>00359             &lt;input type=<span class="stringliteral">&quot;submit&quot;</span> name=<span class="stringliteral">&quot;navig&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo __(&#39;Show all&#39;); ?&gt;&quot;</span> /&gt;
<a name="l00360"></a>00360         &lt;/form&gt;
<a name="l00361"></a>00361     &lt;/td&gt;
<a name="l00362"></a>00362         &lt;?php
<a name="l00363"></a>00363     } <span class="comment">// end show all</span>
<a name="l00364"></a>00364 
<a name="l00365"></a>00365     <span class="comment">// Move to the next page or to the last one</span>
<a name="l00366"></a>00366     <span class="keywordflow">if</span> ((<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;pos&#39;</span>] + <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>] &lt; $unlim_num_rows)
<a name="l00367"></a>00367         &amp;&amp; $num_rows &gt;= <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>]
<a name="l00368"></a>00368         &amp;&amp; <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>] != <span class="stringliteral">&#39;all&#39;</span>
<a name="l00369"></a>00369     ) {
<a name="l00370"></a>00370         <span class="comment">// display the Next button</span>
<a name="l00371"></a>00371         <a class="code" href="display__tbl_8lib_8php.html#ac523ba4ef5f059b9eac487db8f173a2d" title="Displays a navigation button.">PMA_displayTableNavigationOneButton</a>(
<a name="l00372"></a>00372             <span class="stringliteral">&#39;&amp;gt;&#39;</span>,
<a name="l00373"></a>00373             _pgettext(<span class="stringliteral">&#39;Next page&#39;</span>, <span class="stringliteral">&#39;Next&#39;</span>),
<a name="l00374"></a>00374             $pos_next,
<a name="l00375"></a>00375             $html_sql_query
<a name="l00376"></a>00376         );
<a name="l00377"></a>00377 
<a name="l00378"></a>00378         <span class="comment">// prepare some options for the End button</span>
<a name="l00379"></a>00379         <span class="keywordflow">if</span> ($is_innodb &amp;&amp; $unlim_num_rows &gt; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;MaxExactCount&#39;</span>]) {
<a name="l00380"></a>00380             $input_for_real_end = <span class="stringliteral">&#39;&lt;input id=&quot;real_end_input&quot; type=&quot;hidden&quot; name=&quot;find_real_end&quot; value=&quot;1&quot; /&gt;&#39;</span>;
<a name="l00381"></a>00381             <span class="comment">// no backquote around this message</span>
<a name="l00382"></a>00382             $onclick = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00383"></a>00383         } <span class="keywordflow">else</span> {
<a name="l00384"></a>00384             $input_for_real_end = $onclick = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00385"></a>00385         }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387         <span class="comment">// display the End button</span>
<a name="l00388"></a>00388         <a class="code" href="display__tbl_8lib_8php.html#ac523ba4ef5f059b9eac487db8f173a2d" title="Displays a navigation button.">PMA_displayTableNavigationOneButton</a>(
<a name="l00389"></a>00389             <span class="stringliteral">&#39;&amp;gt;&amp;gt;&#39;</span>,
<a name="l00390"></a>00390             _pgettext(<span class="stringliteral">&#39;Last page&#39;</span>, <span class="stringliteral">&#39;End&#39;</span>),
<a name="l00391"></a>00391             @((ceil($unlim_num_rows / <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>])- 1) * <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>]),
<a name="l00392"></a>00392             $html_sql_query,
<a name="l00393"></a>00393             <span class="stringliteral">&#39;onsubmit=&quot;return &#39;</span> . ((<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;pos&#39;</span>] + <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>] &lt; $unlim_num_rows &amp;&amp; $num_rows &gt;= <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>]) ? <span class="stringliteral">&#39;true&#39;</span> : <span class="stringliteral">&#39;false&#39;</span>) . <span class="charliteral">&#39;&quot;&#39;</span>,
<a name="l00394"></a>00394             $input_for_real_end,
<a name="l00395"></a>00395             $onclick
<a name="l00396"></a>00396         );
<a name="l00397"></a>00397     } <span class="comment">// end move toward</span>
<a name="l00398"></a>00398 
<a name="l00399"></a>00399     <span class="comment">// show separator if pagination happen</span>
<a name="l00400"></a>00400     <span class="keywordflow">if</span> ($nbTotalPage &gt; 1) {
<a name="l00401"></a>00401         echo <span class="stringliteral">&#39;&lt;td&gt;&lt;div class=&quot;navigation_separator&quot;&gt;|&lt;/div&gt;&lt;/td&gt;&#39;</span>;
<a name="l00402"></a>00402     }
<a name="l00403"></a>00403     ?&gt;
<a name="l00404"></a>00404     &lt;td&gt;
<a name="l00405"></a>00405         &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;save_edited hide&quot;</span>&gt;
<a name="l00406"></a>00406             &lt;input <a class="code" href="original_2css_2theme__right_8css_8php.html#ae1d92a0cf6d4204d310bc3b8ef7ec56a">type</a>=<span class="stringliteral">&quot;submit&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo __(&#39;Save edited data&#39;); ?&gt;&quot;</span> /&gt;
<a name="l00407"></a>00407             &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;navigation_separator&quot;</span>&gt;|&lt;/div&gt;
<a name="l00408"></a>00408         &lt;/div&gt;
<a name="l00409"></a>00409     &lt;/td&gt;
<a name="l00410"></a>00410     &lt;td&gt;
<a name="l00411"></a>00411         &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;restore_column hide&quot;</span>&gt;
<a name="l00412"></a>00412             &lt;input type=<span class="stringliteral">&quot;submit&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo __(&#39;Restore column order&#39;); ?&gt;&quot;</span> /&gt;
<a name="l00413"></a>00413             &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;navigation_separator&quot;</span>&gt;|&lt;/div&gt;
<a name="l00414"></a>00414         &lt;/div&gt;
<a name="l00415"></a>00415     &lt;/td&gt;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 &lt;?php <span class="comment">// if displaying a VIEW, $unlim_num_rows could be zero because</span>
<a name="l00418"></a>00418       <span class="comment">// of $cfg[&#39;MaxExactCountViews&#39;]; in this case, avoid passing</span>
<a name="l00419"></a>00419       <span class="comment">// the 5th parameter to checkFormElementInRange()</span>
<a name="l00420"></a>00420       <span class="comment">// (this means we can&#39;t validate the upper limit ?&gt;</span>
<a name="l00421"></a>00421     &lt;td <span class="keyword">class</span>=<span class="stringliteral">&quot;navigation_goto&quot;</span>&gt;
<a name="l00422"></a>00422         &lt;form action=<span class="stringliteral">&quot;sql.php&quot;</span> method=<span class="stringliteral">&quot;post&quot;</span>
<a name="l00423"></a>00423     onsubmit=<span class="stringliteral">&quot;return (checkFormElementInRange(this, &#39;session_max_rows&#39;, &#39;&lt;?php echo str_replace(&#39;\&#39;&#39;, &#39;\\\&#39;&#39;, __(&#39;%d is not valid row number.&#39;)); ?&gt;&#39;, 1) &amp;amp;&amp;amp; checkFormElementInRange(this, &#39;pos&#39;, &#39;&lt;?php echo str_replace(&#39;\&#39;&#39;, &#39;\\\&#39;&#39;, __(&#39;%d is not valid row number.&#39;)); ?&gt;&#39;, 0&lt;?php echo $unlim_num_rows &gt; 0 ? &#39;,&#39; . $unlim_num_rows - 1 : &#39;&#39;; ?&gt;))&quot;</span>&gt;
<a name="l00424"></a>00424             &lt;?php echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>($db, $table); ?&gt;
<a name="l00425"></a>00425             &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;sql_query&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo $html_sql_query; ?&gt;&quot;</span> /&gt;
<a name="l00426"></a>00426             &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;goto&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo $goto; ?&gt;&quot;</span> /&gt;
<a name="l00427"></a>00427             &lt;input type=<span class="stringliteral">&quot;submit&quot;</span> name=<span class="stringliteral">&quot;navig&quot;</span> &lt;?php echo (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;AjaxEnable&#39;</span>] ? <span class="stringliteral">&#39; class=&quot;ajax&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>); ?&gt; value=<span class="stringliteral">&quot;&lt;?php echo __(&#39;Show&#39;); ?&gt; :&quot;</span> /&gt;
<a name="l00428"></a>00428             &lt;?php echo __(<span class="stringliteral">&#39;Start row&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>; ?&gt;
<a name="l00429"></a>00429             &lt;input type=<span class="stringliteral">&quot;text&quot;</span> name=<span class="stringliteral">&quot;pos&quot;</span> <a class="code" href="pmahomme_2css_2theme__right_8css_8php.html#ae20d3ca2acbfbfe24798ca800435f9f1">size</a>=<span class="stringliteral">&quot;3&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo (($pos_next &gt;= $unlim_num_rows) ? 0 : $pos_next); ?&gt;&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;textfield&quot;</span> onfocus=<span class="stringliteral">&quot;this.select()&quot;</span> /&gt;
<a name="l00430"></a>00430             &lt;?php echo __(<span class="stringliteral">&#39;Number of rows&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>; ?&gt;
<a name="l00431"></a>00431             &lt;input type=<span class="stringliteral">&quot;text&quot;</span> name=<span class="stringliteral">&quot;session_max_rows&quot;</span> <a class="code" href="pmahomme_2css_2theme__right_8css_8php.html#ae20d3ca2acbfbfe24798ca800435f9f1">size</a>=<span class="stringliteral">&quot;3&quot;</span> value=<span class="stringliteral">&quot;&lt;?php echo (($_SESSION[&#39;tmp_user_values&#39;][&#39;max_rows&#39;] != &#39;all&#39;) ? $_SESSION[&#39;tmp_user_values&#39;][&#39;max_rows&#39;] : $GLOBALS[&#39;cfg&#39;][&#39;MaxRows&#39;]); ?&gt;&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;textfield&quot;</span> onfocus=<span class="stringliteral">&quot;this.select()&quot;</span> /&gt;
<a name="l00432"></a>00432         &lt;?php
<a name="l00433"></a>00433         <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;ShowDisplayDirection&#39;</span>]) {
<a name="l00434"></a>00434             <span class="comment">// Display mode (horizontal/vertical and repeat headers)</span>
<a name="l00435"></a>00435             echo __(<span class="stringliteral">&#39;Mode&#39;</span>) . <span class="stringliteral">&#39;: &#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00436"></a>00436             <a class="code" href="db__search_8php.html#a1b069ebd22dac57f666b8b8df443d572" title="1.">$choices</a> = array(
<a name="l00437"></a>00437                 <span class="stringliteral">&#39;horizontal&#39;</span>        =&gt; __(<span class="stringliteral">&#39;horizontal&#39;</span>),
<a name="l00438"></a>00438                 <span class="stringliteral">&#39;horizontalflipped&#39;</span> =&gt; __(<span class="stringliteral">&#39;horizontal (rotated headers)&#39;</span>),
<a name="l00439"></a>00439                 <span class="stringliteral">&#39;vertical&#39;</span>          =&gt; __(<span class="stringliteral">&#39;vertical&#39;</span>));
<a name="l00440"></a>00440             echo <a class="code" href="common_8lib_8php.html#a5a6eb75fc4c08030f517d1f405268d81" title="Generates and returns an HTML dropdown.">PMA_generate_html_dropdown</a>(<span class="stringliteral">&#39;disp_direction&#39;</span>, <a class="code" href="db__search_8php.html#a1b069ebd22dac57f666b8b8df443d572" title="1.">$choices</a>, <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>], $id_for_direction_dropdown);
<a name="l00441"></a>00441             unset(<a class="code" href="db__search_8php.html#a1b069ebd22dac57f666b8b8df443d572" title="1.">$choices</a>);
<a name="l00442"></a>00442         }
<a name="l00443"></a>00443 
<a name="l00444"></a>00444         printf(
<a name="l00445"></a>00445             __(<span class="stringliteral">&#39;Headers every %s rows&#39;</span>),
<a name="l00446"></a>00446             <span class="stringliteral">&#39;&lt;input type=&quot;text&quot; size=&quot;3&quot; name=&quot;repeat_cells&quot; value=&quot;&#39;</span> . <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>] . <span class="stringliteral">&#39;&quot; class=&quot;textfield&quot; /&gt;&#39;</span>
<a name="l00447"></a>00447         );
<a name="l00448"></a>00448         echo <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00449"></a>00449         ?&gt;
<a name="l00450"></a>00450         &lt;/form&gt;
<a name="l00451"></a>00451     &lt;/td&gt;
<a name="l00452"></a>00452     &lt;td <span class="keyword">class</span>=<span class="stringliteral">&quot;navigation_separator&quot;</span>&gt;&lt;/td&gt;
<a name="l00453"></a>00453 &lt;/tr&gt;
<a name="l00454"></a>00454 &lt;/table&gt;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     &lt;?php
<a name="l00457"></a>00457 } <span class="comment">// end of the &#39;PMA_displayTableNavigation()&#39; function</span>
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 <span class="comment"></span>
<a name="l00460"></a>00460 <span class="comment">/**</span>
<a name="l00461"></a>00461 <span class="comment"> * Displays the headers of the results table</span>
<a name="l00462"></a>00462 <span class="comment"> *</span>
<a name="l00463"></a>00463 <span class="comment"> * @param array   &amp;$is_display                 which elements to display</span>
<a name="l00464"></a>00464 <span class="comment"> * @param array   &amp;$fields_meta                the list of fields properties</span>
<a name="l00465"></a>00465 <span class="comment"> * @param integer $fields_cnt                  the total number of fields returned by the SQL query</span>
<a name="l00466"></a>00466 <span class="comment"> * @param array   $analyzed_sql                the analyzed query</span>
<a name="l00467"></a>00467 <span class="comment"> * @param string  $sort_expression             sort expression</span>
<a name="l00468"></a>00468 <span class="comment"> * @param string  $sort_expression_nodirection sort expression without direction</span>
<a name="l00469"></a>00469 <span class="comment"> * @param string  $sort_direction              sort direction</span>
<a name="l00470"></a>00470 <span class="comment"> *</span>
<a name="l00471"></a>00471 <span class="comment"> * @return  boolean  $clause_is_unique</span>
<a name="l00472"></a>00472 <span class="comment"> *</span>
<a name="l00473"></a>00473 <span class="comment"> * @global  string   $db               the database name</span>
<a name="l00474"></a>00474 <span class="comment"> * @global  string   $table            the table name</span>
<a name="l00475"></a>00475 <span class="comment"> * @global  string   $goto             the URL to go back in case of errors</span>
<a name="l00476"></a>00476 <span class="comment"> * @global  string   $sql_query        the SQL query</span>
<a name="l00477"></a>00477 <span class="comment"> * @global  integer  $num_rows         the total number of rows returned by the</span>
<a name="l00478"></a>00478 <span class="comment"> *                                     SQL query</span>
<a name="l00479"></a>00479 <span class="comment"> * @global  array    $vertical_display informations used with vertical display</span>
<a name="l00480"></a>00480 <span class="comment"> *                                     mode</span>
<a name="l00481"></a>00481 <span class="comment"> *</span>
<a name="l00482"></a>00482 <span class="comment"> * @access  private</span>
<a name="l00483"></a>00483 <span class="comment"> *</span>
<a name="l00484"></a>00484 <span class="comment"> * @see     PMA_displayTable()</span>
<a name="l00485"></a>00485 <span class="comment"> */</span>
<a name="l00486"></a><a class="code" href="display__tbl_8lib_8php.html#aae4044b44dccb4059685ea603dc52e9e">00486</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#aae4044b44dccb4059685ea603dc52e9e" title="Displays the headers of the results table.">PMA_displayTableHeaders</a>(&amp;$is_display, &amp;$fields_meta, <a class="code" href="tbl__change_8php.html#a580526107852923681984db1a74a921c">$fields_cnt</a> = 0, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a> = <span class="stringliteral">&#39;&#39;</span>, $sort_expression, $sort_expression_nodirection, $sort_direction)
<a name="l00487"></a>00487 {
<a name="l00488"></a>00488     global <a class="code" href="schema__export_8php.html#a907d78797a1b764e913b0c565a5097b0" title="get all the export options and verify call and include the appropriate Schema Class depending on $exp...">$db</a>, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>, <a class="code" href="db__sql_8php.html#a4037a8ff7343cce7ab4dadfd490ad3ee">$goto</a>;
<a name="l00489"></a>00489     global <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>, $num_rows;
<a name="l00490"></a>00490     global $vertical_display, $highlight_columns;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492     <span class="comment">// required to generate sort links that will remember whether the</span>
<a name="l00493"></a>00493     <span class="comment">// &quot;Show all&quot; button has been clicked</span>
<a name="l00494"></a>00494     $sql_md5 = md5(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;sql_query&#39;</span>]);
<a name="l00495"></a>00495     $session_max_rows = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;max_rows&#39;</span>];
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     <span class="keywordflow">if</span> (<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a> == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l00498"></a>00498         <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a> = array();
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501     <span class="comment">// can the result be sorted?</span>
<a name="l00502"></a>00502     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l00503"></a>00503 
<a name="l00504"></a>00504         <span class="comment">// Just as fallback</span>
<a name="l00505"></a>00505         $unsorted_sql_query     = <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>;
<a name="l00506"></a>00506         <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;unsorted_query&#39;</span>])) {
<a name="l00507"></a>00507             $unsorted_sql_query = <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;unsorted_query&#39;</span>];
<a name="l00508"></a>00508         }
<a name="l00509"></a>00509         <span class="comment">// Handles the case of multiple clicks on a column&#39;s header</span>
<a name="l00510"></a>00510         <span class="comment">// which would add many spaces before &quot;ORDER BY&quot; in the</span>
<a name="l00511"></a>00511         <span class="comment">// generated query.</span>
<a name="l00512"></a>00512         $unsorted_sql_query = trim($unsorted_sql_query);
<a name="l00513"></a>00513 
<a name="l00514"></a>00514         <span class="comment">// sorting by indexes, only if it makes sense (only one table ref)</span>
<a name="l00515"></a>00515         <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>)
<a name="l00516"></a>00516             &amp;&amp; isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0])
<a name="l00517"></a>00517             &amp;&amp; isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;querytype&#39;</span>])
<a name="l00518"></a>00518             &amp;&amp; <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;querytype&#39;</span>] == <span class="stringliteral">&#39;SELECT&#39;</span>
<a name="l00519"></a>00519             &amp;&amp; isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>])
<a name="l00520"></a>00520             &amp;&amp; count(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>]) == 1
<a name="l00521"></a>00521         ) {
<a name="l00522"></a>00522 
<a name="l00523"></a>00523             <span class="comment">// grab indexes data:</span>
<a name="l00524"></a>00524             $indexes = <a class="code" href="classPMA__Index.html#ad8b7ce6fee21c5ac8e915642e6ee466b" title="returns an array with all indexes from the given table">PMA_Index::getFromTable</a>($table, $db);
<a name="l00525"></a>00525 
<a name="l00526"></a>00526             <span class="comment">// do we have any index?</span>
<a name="l00527"></a>00527             <span class="keywordflow">if</span> ($indexes) {
<a name="l00528"></a>00528 
<a name="l00529"></a>00529                 <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l00530"></a>00530                     || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l00531"></a>00531                 ) {
<a name="l00532"></a>00532                     $span = <a class="code" href="tbl__change_8php.html#a580526107852923681984db1a74a921c">$fields_cnt</a>;
<a name="l00533"></a>00533                     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) {
<a name="l00534"></a>00534                         $span++;
<a name="l00535"></a>00535                     }
<a name="l00536"></a>00536                     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) {
<a name="l00537"></a>00537                         $span++;
<a name="l00538"></a>00538                     }
<a name="l00539"></a>00539                     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;kp&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) {
<a name="l00540"></a>00540                         $span++;
<a name="l00541"></a>00541                     }
<a name="l00542"></a>00542                 } <span class="keywordflow">else</span> {
<a name="l00543"></a>00543                     $span = $num_rows + floor($num_rows/<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>]) + 1;
<a name="l00544"></a>00544                 }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546                 echo <span class="stringliteral">&#39;&lt;form action=&quot;sql.php&quot; method=&quot;post&quot;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00547"></a>00547                 echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>($db, $table);
<a name="l00548"></a>00548                 echo __(<span class="stringliteral">&#39;Sort by key&#39;</span>) . <span class="stringliteral">&#39;: &lt;select name=&quot;sql_query&quot; class=&quot;autosubmit&quot;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00549"></a>00549                 $used_index = <span class="keyword">false</span>;
<a name="l00550"></a>00550                 $local_order = (isset($sort_expression) ? $sort_expression : <span class="stringliteral">&#39;&#39;</span>);
<a name="l00551"></a>00551                 <span class="keywordflow">foreach</span> ($indexes as $index) {
<a name="l00552"></a>00552                     $asc_sort = <span class="charliteral">&#39;`&#39;</span> . implode(<span class="stringliteral">&#39;` ASC, `&#39;</span>, array_keys($index-&gt;getColumns())) . <span class="stringliteral">&#39;` ASC&#39;</span>;
<a name="l00553"></a>00553                     $desc_sort = <span class="charliteral">&#39;`&#39;</span> . implode(<span class="stringliteral">&#39;` DESC, `&#39;</span>, array_keys($index-&gt;getColumns())) . <span class="stringliteral">&#39;` DESC&#39;</span>;
<a name="l00554"></a>00554                     $used_index = $used_index || $local_order == $asc_sort || $local_order == $desc_sort;
<a name="l00555"></a>00555                     <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;@(.*)([[:space:]](LIMIT (.*)|PROCEDURE (.*)|FOR UPDATE|LOCK IN SHARE MODE))@is&#39;</span>, $unsorted_sql_query, $my_reg)) {
<a name="l00556"></a>00556                         $unsorted_sql_query_first_part = $my_reg[1];
<a name="l00557"></a>00557                         $unsorted_sql_query_second_part = $my_reg[2];
<a name="l00558"></a>00558                     } <span class="keywordflow">else</span> {
<a name="l00559"></a>00559                         $unsorted_sql_query_first_part = $unsorted_sql_query;
<a name="l00560"></a>00560                         $unsorted_sql_query_second_part = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00561"></a>00561                     }
<a name="l00562"></a>00562                     echo <span class="stringliteral">&#39;&lt;option value=&quot;&#39;</span>
<a name="l00563"></a>00563                         . htmlspecialchars($unsorted_sql_query_first_part  . <span class="stringliteral">&quot;\n&quot;</span> . <span class="stringliteral">&#39; ORDER BY &#39;</span> . $asc_sort . $unsorted_sql_query_second_part)
<a name="l00564"></a>00564                         . <span class="charliteral">&#39;&quot;&#39;</span> . ($local_order == $asc_sort ? <span class="stringliteral">&#39; selected=&quot;selected&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>)
<a name="l00565"></a>00565                         . <span class="charliteral">&#39;&gt;&#39;</span> . htmlspecialchars($index-&gt;getName()) . <span class="stringliteral">&#39; (&#39;</span>
<a name="l00566"></a>00566                         . __(<span class="stringliteral">&#39;Ascending&#39;</span>) . <span class="stringliteral">&#39;)&lt;/option&gt;&#39;</span>;
<a name="l00567"></a>00567                     echo <span class="stringliteral">&#39;&lt;option value=&quot;&#39;</span>
<a name="l00568"></a>00568                         . htmlspecialchars($unsorted_sql_query_first_part . <span class="stringliteral">&quot;\n&quot;</span> . <span class="stringliteral">&#39; ORDER BY &#39;</span> . $desc_sort . $unsorted_sql_query_second_part)
<a name="l00569"></a>00569                         . <span class="charliteral">&#39;&quot;&#39;</span> . ($local_order == $desc_sort ? <span class="stringliteral">&#39; selected=&quot;selected&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>)
<a name="l00570"></a>00570                         . <span class="charliteral">&#39;&gt;&#39;</span> . htmlspecialchars($index-&gt;getName()) . <span class="stringliteral">&#39; (&#39;</span>
<a name="l00571"></a>00571                         . __(<span class="stringliteral">&#39;Descending&#39;</span>) . <span class="stringliteral">&#39;)&lt;/option&gt;&#39;</span>;
<a name="l00572"></a>00572                 }
<a name="l00573"></a>00573                 echo <span class="stringliteral">&#39;&lt;option value=&quot;&#39;</span> . htmlspecialchars($unsorted_sql_query) . <span class="charliteral">&#39;&quot;&#39;</span> . ($used_index ? <span class="stringliteral">&#39;&#39;</span> : <span class="stringliteral">&#39; selected=&quot;selected&quot;&#39;</span>) . <span class="charliteral">&#39;&gt;&#39;</span> . __(<span class="stringliteral">&#39;None&#39;</span>) . <span class="stringliteral">&#39;&lt;/option&gt;&#39;</span>;
<a name="l00574"></a>00574                 echo <span class="stringliteral">&#39;&lt;/select&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00575"></a>00575                 echo <span class="stringliteral">&#39;&lt;noscript&gt;&lt;input type=&quot;submit&quot; value=&quot;&#39;</span> . __(<span class="stringliteral">&#39;Go&#39;</span>) . <span class="stringliteral">&#39;&quot; /&gt;&lt;/noscript&gt;&#39;</span>;
<a name="l00576"></a>00576                 echo <span class="stringliteral">&#39;&lt;/form&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00577"></a>00577             }
<a name="l00578"></a>00578         }
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580 
<a name="l00581"></a>00581 
<a name="l00582"></a>00582     <span class="comment">// Output data needed for grid editing</span>
<a name="l00583"></a>00583     echo <span class="stringliteral">&#39;&lt;input id=&quot;save_cells_at_once&quot; type=&quot;hidden&quot; value=&quot;&#39;</span> . <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;SaveCellsAtOnce&#39;</span>] . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l00584"></a>00584     echo <span class="stringliteral">&#39;&lt;div class=&quot;common_hidden_inputs&quot;&gt;&#39;</span>;
<a name="l00585"></a>00585     echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>($db, $table);
<a name="l00586"></a>00586     echo <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;
<a name="l00587"></a>00587     <span class="comment">// Output data needed for column reordering and show/hide column</span>
<a name="l00588"></a>00588     <span class="keywordflow">if</span> (<a class="code" href="display__tbl_8lib_8php.html#a6ebb093d6eba080e154ab70b63261772" title="Return true if we are executing a query in the form of &quot;SELECT * FROM &lt;a table&gt; ...&quot;.">PMA_isSelect</a>()) {
<a name="l00589"></a>00589         <span class="comment">// generate the column order, if it is set</span>
<a name="l00590"></a>00590         $pmatable = <span class="keyword">new</span> <a class="code" href="classPMA__Table.html">PMA_Table</a>(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;table&#39;</span>], <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;db&#39;</span>]);
<a name="l00591"></a>00591         $col_order = $pmatable-&gt;getUiProp(<a class="code" href="classPMA__Table.html#a86b9ea13c062cd4eff72f5f3b723d310">PMA_Table::PROP_COLUMN_ORDER</a>);
<a name="l00592"></a>00592         <span class="keywordflow">if</span> ($col_order) {
<a name="l00593"></a>00593             echo <span class="stringliteral">&#39;&lt;input id=&quot;col_order&quot; type=&quot;hidden&quot; value=&quot;&#39;</span> . implode(<span class="charliteral">&#39;,&#39;</span>, $col_order) . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l00594"></a>00594         }
<a name="l00595"></a>00595         $col_visib = $pmatable-&gt;getUiProp(<a class="code" href="classPMA__Table.html#ae74bd68753eeb8be8cf2cfe0272c8d1f">PMA_Table::PROP_COLUMN_VISIB</a>);
<a name="l00596"></a>00596         <span class="keywordflow">if</span> ($col_visib) {
<a name="l00597"></a>00597             echo <span class="stringliteral">&#39;&lt;input id=&quot;col_visib&quot; type=&quot;hidden&quot; value=&quot;&#39;</span> . implode(<span class="charliteral">&#39;,&#39;</span>, $col_visib) . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l00598"></a>00598         }
<a name="l00599"></a>00599         <span class="comment">// generate table create time</span>
<a name="l00600"></a>00600         <span class="keywordflow">if</span> (! <a class="code" href="classPMA__Table.html#af9040740c71098b2c58b3234d7f0afaa" title="returns whether the table is actually a view">PMA_Table::isView</a>(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;table&#39;</span>], <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;db&#39;</span>])) {
<a name="l00601"></a>00601             echo <span class="stringliteral">&#39;&lt;input id=&quot;table_create_time&quot; type=&quot;hidden&quot; value=&quot;&#39;</span> .
<a name="l00602"></a>00602                 <a class="code" href="classPMA__Table.html#a5bcf320752029cac160933f74afc8742" title="Returns full table status info, or specific if $info provided this info is collected from information...">PMA_Table::sGetStatusInfo</a>(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;db&#39;</span>], <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;table&#39;</span>], <span class="stringliteral">&#39;Create_time&#39;</span>) . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l00603"></a>00603         }
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 
<a name="l00607"></a>00607     $vertical_display[<span class="stringliteral">&#39;emptypre&#39;</span>]   = 0;
<a name="l00608"></a>00608     $vertical_display[<span class="stringliteral">&#39;emptyafter&#39;</span>] = 0;
<a name="l00609"></a>00609     $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>]    = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00610"></a>00610 
<a name="l00611"></a>00611     <span class="comment">// Display options (if we are not in print view)</span>
<a name="l00612"></a>00612     <span class="keywordflow">if</span> (! (isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>]) &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>)) {
<a name="l00613"></a>00613         echo <span class="stringliteral">&#39;&lt;form method=&quot;post&quot; action=&quot;sql.php&quot; name=&quot;displayOptionsForm&quot; id=&quot;displayOptionsForm&quot;&#39;</span>;
<a name="l00614"></a>00614         <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;AjaxEnable&#39;</span>]) {
<a name="l00615"></a>00615             echo <span class="stringliteral">&#39; class=&quot;ajax&quot; &#39;</span>;
<a name="l00616"></a>00616         }
<a name="l00617"></a>00617         echo <span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l00618"></a>00618         <a class="code" href="db__qbe_8php.html#a5bc4c60a2c2f6347a2f8c4e5847ebbfe">$url_params</a> = array(
<a name="l00619"></a>00619             <span class="stringliteral">&#39;db&#39;</span> =&gt; $db,
<a name="l00620"></a>00620             <span class="stringliteral">&#39;table&#39;</span> =&gt; $table,
<a name="l00621"></a>00621             <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; $sql_query,
<a name="l00622"></a>00622             <span class="stringliteral">&#39;goto&#39;</span> =&gt; $goto,
<a name="l00623"></a>00623             <span class="stringliteral">&#39;display_options_form&#39;</span> =&gt; 1
<a name="l00624"></a>00624         );
<a name="l00625"></a>00625         echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>(<a class="code" href="db__qbe_8php.html#a5bc4c60a2c2f6347a2f8c4e5847ebbfe">$url_params</a>);
<a name="l00626"></a>00626         echo <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>;
<a name="l00627"></a>00627         <a class="code" href="common_8lib_8php.html#aedbdeb311dc6b447c4cfb2a8051354e4" title="Generates a slider effect (jQjuery) Takes care of generating the initial  and the link controlling th...">PMA_generate_slider_effect</a>(<span class="stringliteral">&#39;displayoptions&#39;</span>, __(<span class="stringliteral">&#39;Options&#39;</span>));
<a name="l00628"></a>00628         echo <span class="stringliteral">&#39;&lt;fieldset&gt;&#39;</span>;
<a name="l00629"></a>00629 
<a name="l00630"></a>00630         echo <span class="stringliteral">&#39;&lt;div class=&quot;formelement&quot;&gt;&#39;</span>;
<a name="l00631"></a>00631         <a class="code" href="db__search_8php.html#a1b069ebd22dac57f666b8b8df443d572" title="1.">$choices</a> = array(
<a name="l00632"></a>00632             <span class="charliteral">&#39;P&#39;</span>   =&gt; __(<span class="stringliteral">&#39;Partial texts&#39;</span>),
<a name="l00633"></a>00633             <span class="charliteral">&#39;F&#39;</span>   =&gt; __(<span class="stringliteral">&#39;Full texts&#39;</span>)
<a name="l00634"></a>00634         );
<a name="l00635"></a>00635         <a class="code" href="common_8lib_8php.html#ab16665fa725ad85d72311fd34bb26526" title="Generates and echoes a set of radio HTML fields.">PMA_display_html_radio</a>(<span class="stringliteral">&#39;display_text&#39;</span>, <a class="code" href="db__search_8php.html#a1b069ebd22dac57f666b8b8df443d572" title="1.">$choices</a>, <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_text&#39;</span>]);
<a name="l00636"></a>00636         echo <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;
<a name="l00637"></a>00637 
<a name="l00638"></a>00638         <span class="comment">// prepare full/partial text button or link</span>
<a name="l00639"></a>00639         $url_params_full_text = array(
<a name="l00640"></a>00640             <span class="stringliteral">&#39;db&#39;</span> =&gt; $db,
<a name="l00641"></a>00641             <span class="stringliteral">&#39;table&#39;</span> =&gt; $table,
<a name="l00642"></a>00642             <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; $sql_query,
<a name="l00643"></a>00643             <span class="stringliteral">&#39;goto&#39;</span> =&gt; $goto,
<a name="l00644"></a>00644             <span class="stringliteral">&#39;full_text_button&#39;</span> =&gt; 1
<a name="l00645"></a>00645         );
<a name="l00646"></a>00646 
<a name="l00647"></a>00647         <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_text&#39;</span>]==<span class="charliteral">&#39;F&#39;</span>) {
<a name="l00648"></a>00648             <span class="comment">// currently in fulltext mode so show the opposite link</span>
<a name="l00649"></a>00649             $tmp_image_file = <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;pmaThemeImage&#39;</span>] . <span class="stringliteral">&#39;s_partialtext.png&#39;</span>;
<a name="l00650"></a>00650             $tmp_txt = __(<span class="stringliteral">&#39;Partial texts&#39;</span>);
<a name="l00651"></a>00651             $url_params_full_text[<span class="stringliteral">&#39;display_text&#39;</span>] = <span class="charliteral">&#39;P&#39;</span>;
<a name="l00652"></a>00652         } <span class="keywordflow">else</span> {
<a name="l00653"></a>00653             $tmp_image_file = <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;pmaThemeImage&#39;</span>] . <span class="stringliteral">&#39;s_fulltext.png&#39;</span>;
<a name="l00654"></a>00654             $tmp_txt = __(<span class="stringliteral">&#39;Full texts&#39;</span>);
<a name="l00655"></a>00655             $url_params_full_text[<span class="stringliteral">&#39;display_text&#39;</span>] = <span class="charliteral">&#39;F&#39;</span>;
<a name="l00656"></a>00656         }
<a name="l00657"></a>00657 
<a name="l00658"></a>00658         $tmp_image = <span class="stringliteral">&#39;&lt;img class=&quot;fulltext&quot; src=&quot;&#39;</span> . $tmp_image_file . <span class="stringliteral">&#39;&quot; alt=&quot;&#39;</span> . $tmp_txt . <span class="stringliteral">&#39;&quot; title=&quot;&#39;</span> . $tmp_txt . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l00659"></a>00659         $tmp_url = <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>($url_params_full_text);
<a name="l00660"></a>00660         $full_or_partial_text_link = <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>($tmp_url, $tmp_image, array(), <span class="keyword">false</span>);
<a name="l00661"></a>00661         unset($tmp_image_file, $tmp_txt, $tmp_url, $tmp_image);
<a name="l00662"></a>00662 
<a name="l00663"></a>00663 
<a name="l00664"></a>00664         <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfgRelation&#39;</span>][<span class="stringliteral">&#39;relwork&#39;</span>] &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfgRelation&#39;</span>][<span class="stringliteral">&#39;displaywork&#39;</span>]) {
<a name="l00665"></a>00665             echo <span class="stringliteral">&#39;&lt;div class=&quot;formelement&quot;&gt;&#39;</span>;
<a name="l00666"></a>00666             <a class="code" href="db__search_8php.html#a1b069ebd22dac57f666b8b8df443d572" title="1.">$choices</a> = array(
<a name="l00667"></a>00667                 <span class="charliteral">&#39;K&#39;</span>   =&gt; __(<span class="stringliteral">&#39;Relational key&#39;</span>),
<a name="l00668"></a>00668                 <span class="charliteral">&#39;D&#39;</span>   =&gt; __(<span class="stringliteral">&#39;Relational display column&#39;</span>)
<a name="l00669"></a>00669             );
<a name="l00670"></a>00670             <a class="code" href="common_8lib_8php.html#ab16665fa725ad85d72311fd34bb26526" title="Generates and echoes a set of radio HTML fields.">PMA_display_html_radio</a>(<span class="stringliteral">&#39;relational_display&#39;</span>, <a class="code" href="db__search_8php.html#a1b069ebd22dac57f666b8b8df443d572" title="1.">$choices</a>, <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;relational_display&#39;</span>]);
<a name="l00671"></a>00671             echo <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;
<a name="l00672"></a>00672         }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674         echo <span class="stringliteral">&#39;&lt;div class=&quot;formelement&quot;&gt;&#39;</span>;
<a name="l00675"></a>00675         <a class="code" href="common_8lib_8php.html#a2137e190cf868c51c839dd0f2ecb4665" title="Generates and echoes an HTML checkbox.">PMA_display_html_checkbox</a>(<span class="stringliteral">&#39;display_binary&#39;</span>, __(<span class="stringliteral">&#39;Show binary contents&#39;</span>), ! empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_binary&#39;</span>]), <span class="keyword">false</span>);
<a name="l00676"></a>00676         echo <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>;
<a name="l00677"></a>00677         <a class="code" href="common_8lib_8php.html#a2137e190cf868c51c839dd0f2ecb4665" title="Generates and echoes an HTML checkbox.">PMA_display_html_checkbox</a>(<span class="stringliteral">&#39;display_blob&#39;</span>, __(<span class="stringliteral">&#39;Show BLOB contents&#39;</span>), ! empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_blob&#39;</span>]), <span class="keyword">false</span>);
<a name="l00678"></a>00678         echo <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>;
<a name="l00679"></a>00679         <a class="code" href="common_8lib_8php.html#a2137e190cf868c51c839dd0f2ecb4665" title="Generates and echoes an HTML checkbox.">PMA_display_html_checkbox</a>(<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>, __(<span class="stringliteral">&#39;Show binary contents as HEX&#39;</span>), ! empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>]), <span class="keyword">false</span>);
<a name="l00680"></a>00680         echo <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682         <span class="comment">// I would have preferred to name this &quot;display_transformation&quot;.</span>
<a name="l00683"></a>00683         <span class="comment">// This is the only way I found to be able to keep this setting sticky</span>
<a name="l00684"></a>00684         <span class="comment">// per SQL query, and at the same time have a default that displays</span>
<a name="l00685"></a>00685         <span class="comment">// the transformations.</span>
<a name="l00686"></a>00686         echo <span class="stringliteral">&#39;&lt;div class=&quot;formelement&quot;&gt;&#39;</span>;
<a name="l00687"></a>00687         <a class="code" href="common_8lib_8php.html#a2137e190cf868c51c839dd0f2ecb4665" title="Generates and echoes an HTML checkbox.">PMA_display_html_checkbox</a>(<span class="stringliteral">&#39;hide_transformation&#39;</span>, __(<span class="stringliteral">&#39;Hide browser transformation&#39;</span>), ! empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;hide_transformation&#39;</span>]), <span class="keyword">false</span>);
<a name="l00688"></a>00688         echo <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;
<a name="l00689"></a>00689 
<a name="l00690"></a>00690         <span class="keywordflow">if</span> (! PMA_DRIZZLE) {
<a name="l00691"></a>00691             echo <span class="stringliteral">&#39;&lt;div class=&quot;formelement&quot;&gt;&#39;</span>;
<a name="l00692"></a>00692             <a class="code" href="db__search_8php.html#a1b069ebd22dac57f666b8b8df443d572" title="1.">$choices</a> = array(
<a name="l00693"></a>00693                 <span class="stringliteral">&#39;GEOM&#39;</span>  =&gt; __(<span class="stringliteral">&#39;Geometry&#39;</span>),
<a name="l00694"></a>00694                 <span class="stringliteral">&#39;WKT&#39;</span>   =&gt; __(<span class="stringliteral">&#39;Well Known Text&#39;</span>),
<a name="l00695"></a>00695                 <span class="stringliteral">&#39;WKB&#39;</span>   =&gt; __(<span class="stringliteral">&#39;Well Known Binary&#39;</span>)
<a name="l00696"></a>00696             );
<a name="l00697"></a>00697             <a class="code" href="common_8lib_8php.html#ab16665fa725ad85d72311fd34bb26526" title="Generates and echoes a set of radio HTML fields.">PMA_display_html_radio</a>(<span class="stringliteral">&#39;geometry_display&#39;</span>, <a class="code" href="db__search_8php.html#a1b069ebd22dac57f666b8b8df443d572" title="1.">$choices</a>, <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;geometry_display&#39;</span>]);
<a name="l00698"></a>00698             echo <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;
<a name="l00699"></a>00699         }
<a name="l00700"></a>00700 
<a name="l00701"></a>00701         echo <span class="stringliteral">&#39;&lt;div class=&quot;clearfloat&quot;&gt;&lt;/div&gt;&#39;</span>;
<a name="l00702"></a>00702         echo <span class="stringliteral">&#39;&lt;/fieldset&gt;&#39;</span>;
<a name="l00703"></a>00703 
<a name="l00704"></a>00704         echo <span class="stringliteral">&#39;&lt;fieldset class=&quot;tblFooters&quot;&gt;&#39;</span>;
<a name="l00705"></a>00705         echo <span class="stringliteral">&#39;&lt;input type=&quot;submit&quot; value=&quot;&#39;</span> . __(<span class="stringliteral">&#39;Go&#39;</span>) . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l00706"></a>00706         echo <span class="stringliteral">&#39;&lt;/fieldset&gt;&#39;</span>;
<a name="l00707"></a>00707         echo <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;
<a name="l00708"></a>00708         echo <span class="stringliteral">&#39;&lt;/form&gt;&#39;</span>;
<a name="l00709"></a>00709     }
<a name="l00710"></a>00710 
<a name="l00711"></a>00711     <span class="comment">// Start of form for multi-rows edit/delete/export</span>
<a name="l00712"></a>00712 
<a name="l00713"></a>00713     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] == <span class="stringliteral">&#39;dr&#39;</span> || $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] == <span class="stringliteral">&#39;kp&#39;</span>) {
<a name="l00714"></a>00714         echo <span class="stringliteral">&#39;&lt;form method=&quot;post&quot; action=&quot;tbl_row_action.php&quot; name=&quot;resultsForm&quot; id=&quot;resultsForm&quot;&#39;</span>;
<a name="l00715"></a>00715         <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;AjaxEnable&#39;</span>]) {
<a name="l00716"></a>00716             echo <span class="stringliteral">&#39; class=&quot;ajax&quot; &#39;</span>;
<a name="l00717"></a>00717         }
<a name="l00718"></a>00718         echo <span class="charliteral">&#39;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00719"></a>00719         echo <a class="code" href="url__generating_8lib_8php.html#ad7326a27700edd06dee0217de194756b" title="Generates text with hidden inputs.">PMA_generate_common_hidden_inputs</a>($db, $table, 1);
<a name="l00720"></a>00720         echo <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;goto&quot;             value=&quot;sql.php&quot; /&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00721"></a>00721     }
<a name="l00722"></a>00722 
<a name="l00723"></a>00723     echo <span class="stringliteral">&#39;&lt;table id=&quot;table_results&quot; class=&quot;data&#39;</span>;
<a name="l00724"></a>00724     <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;AjaxEnable&#39;</span>]) {
<a name="l00725"></a>00725         echo <span class="stringliteral">&#39; ajax&#39;</span>;
<a name="l00726"></a>00726     }
<a name="l00727"></a>00727     echo <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00728"></a>00728     <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l00729"></a>00729         || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l00730"></a>00730     ) {
<a name="l00731"></a>00731         echo <span class="stringliteral">&#39;&lt;thead&gt;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00732"></a>00732     }
<a name="l00733"></a>00733 
<a name="l00734"></a>00734     <span class="comment">// 1. Displays the full/partial text button (part 1)...</span>
<a name="l00735"></a>00735     <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l00736"></a>00736         || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l00737"></a>00737     ) {
<a name="l00738"></a>00738         $colspan  = ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>)
<a name="l00739"></a>00739                   ? <span class="stringliteral">&#39; colspan=&quot;4&quot;&#39;</span>
<a name="l00740"></a>00740                   : <span class="stringliteral">&#39;&#39;</span>;
<a name="l00741"></a>00741     } <span class="keywordflow">else</span> {
<a name="l00742"></a>00742         $rowspan  = ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>)
<a name="l00743"></a>00743                   ? <span class="stringliteral">&#39; rowspan=&quot;4&quot;&#39;</span>
<a name="l00744"></a>00744                   : <span class="stringliteral">&#39;&#39;</span>;
<a name="l00745"></a>00745     }
<a name="l00746"></a>00746 
<a name="l00747"></a>00747     <span class="comment">//     ... before the result table</span>
<a name="l00748"></a>00748     <span class="keywordflow">if</span> (($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] == <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] == <span class="stringliteral">&#39;nn&#39;</span>)
<a name="l00749"></a>00749         &amp;&amp; $is_display[<span class="stringliteral">&#39;text_btn&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>
<a name="l00750"></a>00750     ) {
<a name="l00751"></a>00751         $vertical_display[<span class="stringliteral">&#39;emptypre&#39;</span>] = ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) ? 4 : 0;
<a name="l00752"></a>00752         <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l00753"></a>00753             || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l00754"></a>00754         ) {
<a name="l00755"></a>00755             ?&gt;
<a name="l00756"></a>00756     &lt;th colspan=<span class="stringliteral">&quot;&lt;?php echo $fields_cnt; ?&gt;&quot;</span>&gt;&lt;/th&gt;
<a name="l00757"></a>00757 &lt;/tr&gt;
<a name="l00758"></a>00758 &lt;tr&gt;
<a name="l00759"></a>00759             &lt;?php
<a name="l00760"></a>00760             <span class="comment">// end horizontal/horizontalflipped mode</span>
<a name="l00761"></a>00761         } <span class="keywordflow">else</span> {
<a name="l00762"></a>00762             ?&gt;
<a name="l00763"></a>00763 &lt;tr&gt;
<a name="l00764"></a>00764     &lt;th colspan=<span class="stringliteral">&quot;&lt;?php echo $num_rows + floor($num_rows/$_SESSION[&#39;tmp_user_values&#39;][&#39;repeat_cells&#39;]) + 1; ?&gt;&quot;</span>&gt;&lt;/th&gt;
<a name="l00765"></a>00765 &lt;/tr&gt;
<a name="l00766"></a>00766             &lt;?php
<a name="l00767"></a>00767         } <span class="comment">// end vertical mode</span>
<a name="l00768"></a>00768     }
<a name="l00769"></a>00769 
<a name="l00770"></a>00770     <span class="comment">//     ... at the left column of the result table header if possible</span>
<a name="l00771"></a>00771     <span class="comment">//     and required</span>
<a name="l00772"></a>00772     <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l00773"></a>00773         &amp;&amp; $is_display[<span class="stringliteral">&#39;text_btn&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>
<a name="l00774"></a>00774     ) {
<a name="l00775"></a>00775         $vertical_display[<span class="stringliteral">&#39;emptypre&#39;</span>] = ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) ? 4 : 0;
<a name="l00776"></a>00776         <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l00777"></a>00777             || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l00778"></a>00778         ) {
<a name="l00779"></a>00779             ?&gt;
<a name="l00780"></a>00780                 &lt;th &lt;?php echo $colspan; ?&gt;&gt;&lt;?php echo $full_or_partial_text_link;?&gt;&lt;/th&gt;
<a name="l00781"></a>00781             &lt;?php
<a name="l00782"></a>00782             <span class="comment">// end horizontal/horizontalflipped mode</span>
<a name="l00783"></a>00783         } <span class="keywordflow">else</span> {
<a name="l00784"></a>00784             $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>] = <span class="stringliteral">&#39;    &lt;th &#39;</span> . $rowspan . <span class="stringliteral">&#39; valign=&quot;middle&quot;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00785"></a>00785                                          . <span class="stringliteral">&#39;        &#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00786"></a>00786                                          . <span class="stringliteral">&#39;    &lt;/th&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00787"></a>00787         } <span class="comment">// end vertical mode</span>
<a name="l00788"></a>00788     }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790     <span class="comment">//     ... elseif no button, displays empty(ies) col(s) if required</span>
<a name="l00791"></a>00791     <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l00792"></a>00792              &amp;&amp; ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> || $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>)) {
<a name="l00793"></a>00793         $vertical_display[<span class="stringliteral">&#39;emptypre&#39;</span>] = ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) ? 4 : 0;
<a name="l00794"></a>00794         <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l00795"></a>00795             || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l00796"></a>00796         ) {
<a name="l00797"></a>00797             ?&gt;
<a name="l00798"></a>00798     &lt;td&lt;?php echo $colspan; ?&gt;&gt;&lt;/<a class="code" href="original_2css_2theme__right_8css_8php.html#a2cb7bbff99e906a4fef499891dc9e6f5">td</a>&gt;
<a name="l00799"></a>00799             &lt;?php
<a name="l00800"></a>00800             <span class="comment">// end horizontal/horizontalfipped mode</span>
<a name="l00801"></a>00801         } <span class="keywordflow">else</span> {
<a name="l00802"></a>00802             $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>] = <span class="stringliteral">&#39;    &lt;td&#39;</span> . $rowspan . <span class="stringliteral">&#39;&gt;&lt;/td&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00803"></a>00803         } <span class="comment">// end vertical mode</span>
<a name="l00804"></a>00804     }
<a name="l00805"></a>00805 
<a name="l00806"></a>00806     <span class="comment">//     ... elseif display an empty column if the actions links are disabled to match the rest of the table</span>
<a name="l00807"></a>00807     <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;none&#39;</span>
<a name="l00808"></a>00808         &amp;&amp; (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span> || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>)
<a name="l00809"></a>00809     ) {
<a name="l00810"></a>00810         echo <span class="stringliteral">&#39;&lt;th&gt;&lt;/th&gt;&#39;</span>;
<a name="l00811"></a>00811     }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813     <span class="comment">// 2. Displays the fields&#39; name</span>
<a name="l00814"></a>00814     <span class="comment">// 2.0 If sorting links should be used, checks if the query is a &quot;JOIN&quot;</span>
<a name="l00815"></a>00815     <span class="comment">//     statement (see 2.1.3)</span>
<a name="l00816"></a>00816 
<a name="l00817"></a>00817     <span class="comment">// 2.0.1 Prepare Display column comments if enabled ($GLOBALS[&#39;cfg&#39;][&#39;ShowBrowseComments&#39;]).</span>
<a name="l00818"></a>00818     <span class="comment">//       Do not show comments, if using horizontalflipped mode, because of space usage</span>
<a name="l00819"></a>00819     <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;ShowBrowseComments&#39;</span>]
<a name="l00820"></a>00820         &amp;&amp; <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] != <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l00821"></a>00821     ) {
<a name="l00822"></a>00822         <a class="code" href="tbl__properties_8inc_8php.html#a979b71d6e639bb764757094f33e230b5">$comments_map</a> = array();
<a name="l00823"></a>00823         <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0]) &amp;&amp; is_array(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0])) {
<a name="l00824"></a>00824             <span class="keywordflow">foreach</span> (<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>] as $tbl) {
<a name="l00825"></a>00825                 $tb = $tbl[<span class="stringliteral">&#39;table_true_name&#39;</span>];
<a name="l00826"></a>00826                 <a class="code" href="tbl__properties_8inc_8php.html#a979b71d6e639bb764757094f33e230b5">$comments_map</a>[$tb] = <a class="code" href="relation_8lib_8php.html#ab340fcbdb6d862236eb7f4d362f73dc6" title="Gets the comments for all rows of a table or the db itself.">PMA_getComments</a>($db, $tb);
<a name="l00827"></a>00827                 unset($tb);
<a name="l00828"></a>00828             }
<a name="l00829"></a>00829         }
<a name="l00830"></a>00830     }
<a name="l00831"></a>00831 
<a name="l00832"></a>00832     <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfgRelation&#39;</span>][<span class="stringliteral">&#39;commwork&#39;</span>] &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfgRelation&#39;</span>][<span class="stringliteral">&#39;mimework&#39;</span>] &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;BrowseMIME&#39;</span>] &amp;&amp; ! <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;hide_transformation&#39;</span>]) {
<a name="l00833"></a>00833         include_once <span class="stringliteral">&#39;./libraries/transformations.lib.php&#39;</span>;
<a name="l00834"></a>00834         <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;mime_map&#39;</span>] = <a class="code" href="transformations_8lib_8php.html#aa7e70121361d6936caaba715c7dc39ee" title="Gets the mimetypes for all columns of a table.">PMA_getMIME</a>($db, $table);
<a name="l00835"></a>00835     }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837     <span class="comment">// See if we have to highlight any header fields of a WHERE query.</span>
<a name="l00838"></a>00838     <span class="comment">// Uses SQL-Parser results.</span>
<a name="l00839"></a>00839     $highlight_columns = array();
<a name="l00840"></a>00840     <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>) &amp;&amp; isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0])
<a name="l00841"></a>00841         &amp;&amp; isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;where_clause_identifiers&#39;</span>])
<a name="l00842"></a>00842     ) {
<a name="l00843"></a>00843 
<a name="l00844"></a>00844         $wi = 0;
<a name="l00845"></a>00845         <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;where_clause_identifiers&#39;</span>]) &amp;&amp; is_array(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;where_clause_identifiers&#39;</span>])) {
<a name="l00846"></a>00846             <span class="keywordflow">foreach</span> (<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;where_clause_identifiers&#39;</span>] AS $wci_nr =&gt; $wci) {
<a name="l00847"></a>00847                 $highlight_columns[$wci] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l00848"></a>00848             }
<a name="l00849"></a>00849         }
<a name="l00850"></a>00850     }
<a name="l00851"></a>00851 
<a name="l00852"></a>00852     <span class="keywordflow">if</span> (<a class="code" href="display__tbl_8lib_8php.html#a6ebb093d6eba080e154ab70b63261772" title="Return true if we are executing a query in the form of &quot;SELECT * FROM &lt;a table&gt; ...&quot;.">PMA_isSelect</a>()) {
<a name="l00853"></a>00853         <span class="comment">// prepare to get the column order, if available</span>
<a name="l00854"></a>00854         $pmatable = <span class="keyword">new</span> <a class="code" href="classPMA__Table.html">PMA_Table</a>(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;table&#39;</span>], <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;db&#39;</span>]);
<a name="l00855"></a>00855         $col_order = $pmatable-&gt;getUiProp(<a class="code" href="classPMA__Table.html#a86b9ea13c062cd4eff72f5f3b723d310">PMA_Table::PROP_COLUMN_ORDER</a>);
<a name="l00856"></a>00856         $col_visib = $pmatable-&gt;getUiProp(<a class="code" href="classPMA__Table.html#ae74bd68753eeb8be8cf2cfe0272c8d1f">PMA_Table::PROP_COLUMN_VISIB</a>);
<a name="l00857"></a>00857     } <span class="keywordflow">else</span> {
<a name="l00858"></a>00858         $col_order = <span class="keyword">false</span>;
<a name="l00859"></a>00859         $col_visib = <span class="keyword">false</span>;
<a name="l00860"></a>00860     }
<a name="l00861"></a>00861 
<a name="l00862"></a>00862     <span class="keywordflow">for</span> ($j = 0; $j &lt; <a class="code" href="tbl__change_8php.html#a580526107852923681984db1a74a921c">$fields_cnt</a>; $j++) {
<a name="l00863"></a>00863         <span class="comment">// assign $i with appropriate column order</span>
<a name="l00864"></a>00864         <a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> = $col_order ? $col_order[$j] : $j;
<a name="l00865"></a>00865         <span class="comment">//  See if this column should get highlight because it&#39;s used in the</span>
<a name="l00866"></a>00866         <span class="comment">//  where-query.</span>
<a name="l00867"></a>00867         <span class="keywordflow">if</span> (isset($highlight_columns[$fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name]) || isset($highlight_columns[<a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name)])) {
<a name="l00868"></a>00868             $condition_field = <span class="keyword">true</span>;
<a name="l00869"></a>00869         } <span class="keywordflow">else</span> {
<a name="l00870"></a>00870             $condition_field = <span class="keyword">false</span>;
<a name="l00871"></a>00871         }
<a name="l00872"></a>00872 
<a name="l00873"></a>00873         <span class="comment">// 2.0 Prepare comment-HTML-wrappers for each row, if defined/enabled.</span>
<a name="l00874"></a>00874         <span class="keywordflow">if</span> (isset(<a class="code" href="tbl__properties_8inc_8php.html#a979b71d6e639bb764757094f33e230b5">$comments_map</a>)
<a name="l00875"></a>00875             &amp;&amp; isset(<a class="code" href="tbl__properties_8inc_8php.html#a979b71d6e639bb764757094f33e230b5">$comments_map</a>[$fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;table])
<a name="l00876"></a>00876             &amp;&amp; isset(<a class="code" href="tbl__properties_8inc_8php.html#a979b71d6e639bb764757094f33e230b5">$comments_map</a>[$fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;table][$fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name])
<a name="l00877"></a>00877         ) {
<a name="l00878"></a>00878             $comments = <span class="stringliteral">&#39;&lt;span class=&quot;tblcomment&quot;&gt;&#39;</span> . htmlspecialchars(<a class="code" href="tbl__properties_8inc_8php.html#a979b71d6e639bb764757094f33e230b5">$comments_map</a>[$fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;table][$fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name]) . <span class="stringliteral">&#39;&lt;/span&gt;&#39;</span>;
<a name="l00879"></a>00879         } <span class="keywordflow">else</span> {
<a name="l00880"></a>00880             $comments = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00881"></a>00881         }
<a name="l00882"></a>00882 
<a name="l00883"></a>00883         <span class="comment">// 2.1 Results can be sorted</span>
<a name="l00884"></a>00884         <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;sort_lnk&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l00885"></a>00885 
<a name="l00886"></a>00886             <span class="comment">// 2.1.1 Checks if the table name is required; it&#39;s the case</span>
<a name="l00887"></a>00887             <span class="comment">//       for a query with a &quot;JOIN&quot; statement and if the column</span>
<a name="l00888"></a>00888             <span class="comment">//       isn&#39;t aliased, or in queries like</span>
<a name="l00889"></a>00889             <span class="comment">//       SELECT `1`.`master_field` , `2`.`master_field`</span>
<a name="l00890"></a>00890             <span class="comment">//       FROM `PMA_relation` AS `1` , `PMA_relation` AS `2`</span>
<a name="l00891"></a>00891 
<a name="l00892"></a>00892             <span class="keywordflow">if</span> (isset($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;table) &amp;&amp; strlen($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;table)) {
<a name="l00893"></a>00893                 $sort_tbl = <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;table) . <span class="charliteral">&#39;.&#39;</span>;
<a name="l00894"></a>00894             } <span class="keywordflow">else</span> {
<a name="l00895"></a>00895                 $sort_tbl = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00896"></a>00896             }
<a name="l00897"></a>00897 
<a name="l00898"></a>00898             <span class="comment">// 2.1.2 Checks if the current column is used to sort the</span>
<a name="l00899"></a>00899             <span class="comment">//       results</span>
<a name="l00900"></a>00900             <span class="comment">// the orgname member does not exist for all MySQL versions</span>
<a name="l00901"></a>00901             <span class="comment">// but if found, it&#39;s the one on which to sort</span>
<a name="l00902"></a>00902             $name_to_use_in_sort = $fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name;
<a name="l00903"></a>00903             $is_orgname = <span class="keyword">false</span>;
<a name="l00904"></a>00904             <span class="keywordflow">if</span> (isset($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;orgname) &amp;&amp; strlen($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;orgname)) {
<a name="l00905"></a>00905                 $name_to_use_in_sort = $fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;orgname;
<a name="l00906"></a>00906                 $is_orgname = <span class="keyword">true</span>;
<a name="l00907"></a>00907             }
<a name="l00908"></a>00908             <span class="comment">// $name_to_use_in_sort might contain a space due to</span>
<a name="l00909"></a>00909             <span class="comment">// formatting of function expressions like &quot;COUNT(name )&quot;</span>
<a name="l00910"></a>00910             <span class="comment">// so we remove the space in this situation</span>
<a name="l00911"></a>00911             $name_to_use_in_sort = str_replace(<span class="stringliteral">&#39; )&#39;</span>, <span class="charliteral">&#39;)&#39;</span>, $name_to_use_in_sort);
<a name="l00912"></a>00912 
<a name="l00913"></a>00913             <span class="keywordflow">if</span> (empty($sort_expression)) {
<a name="l00914"></a>00914                 $is_in_sort = <span class="keyword">false</span>;
<a name="l00915"></a>00915             } <span class="keywordflow">else</span> {
<a name="l00916"></a>00916                 <span class="comment">// Field name may be preceded by a space, or any number</span>
<a name="l00917"></a>00917                 <span class="comment">// of characters followed by a dot (tablename.fieldname)</span>
<a name="l00918"></a>00918                 <span class="comment">// so do a direct comparison for the sort expression;</span>
<a name="l00919"></a>00919                 <span class="comment">// this avoids problems with queries like</span>
<a name="l00920"></a>00920                 <span class="comment">// &quot;SELECT id, count(id)...&quot; and clicking to sort</span>
<a name="l00921"></a>00921                 <span class="comment">// on id or on count(id).</span>
<a name="l00922"></a>00922                 <span class="comment">// Another query to test this:</span>
<a name="l00923"></a>00923                 <span class="comment">// SELECT p.*, FROM_UNIXTIME(p.temps) FROM mytable AS p</span>
<a name="l00924"></a>00924                 <span class="comment">// (and try clicking on each column&#39;s header twice)</span>
<a name="l00925"></a>00925                 <span class="keywordflow">if</span> (! empty($sort_tbl)
<a name="l00926"></a>00926                     &amp;&amp; strpos($sort_expression_nodirection, $sort_tbl) === <span class="keyword">false</span>
<a name="l00927"></a>00927                     &amp;&amp; strpos($sort_expression_nodirection, <span class="charliteral">&#39;(&#39;</span>) === <span class="keyword">false</span>
<a name="l00928"></a>00928                 ) {
<a name="l00929"></a>00929                     $sort_expression_nodirection = $sort_tbl . $sort_expression_nodirection;
<a name="l00930"></a>00930                 }
<a name="l00931"></a>00931                 $is_in_sort = (str_replace(<span class="charliteral">&#39;`&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $sort_tbl) . $name_to_use_in_sort == str_replace(<span class="charliteral">&#39;`&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $sort_expression_nodirection) ? <span class="keyword">true</span> : <span class="keyword">false</span>);
<a name="l00932"></a>00932             }
<a name="l00933"></a>00933             <span class="comment">// 2.1.3 Check the field name for a bracket.</span>
<a name="l00934"></a>00934             <span class="comment">//       If it contains one, it&#39;s probably a function column</span>
<a name="l00935"></a>00935             <span class="comment">//       like &#39;COUNT(`field`)&#39;</span>
<a name="l00936"></a>00936             <span class="comment">//       It still might be a column name of a view. See bug #3383711</span>
<a name="l00937"></a>00937             <span class="comment">//       Check is_orgname.</span>
<a name="l00938"></a>00938             <span class="keywordflow">if</span> (strpos($name_to_use_in_sort, <span class="charliteral">&#39;(&#39;</span>) !== <span class="keyword">false</span> &amp;&amp; ! $is_orgname) {
<a name="l00939"></a>00939                 $sort_order = <span class="stringliteral">&quot;\n&quot;</span> . <span class="stringliteral">&#39;ORDER BY &#39;</span> . $name_to_use_in_sort . <span class="charliteral">&#39; &#39;</span>;
<a name="l00940"></a>00940             } <span class="keywordflow">else</span> {
<a name="l00941"></a>00941                 $sort_order = <span class="stringliteral">&quot;\n&quot;</span> . <span class="stringliteral">&#39;ORDER BY &#39;</span> . $sort_tbl . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($name_to_use_in_sort) . <span class="charliteral">&#39; &#39;</span>;
<a name="l00942"></a>00942             }
<a name="l00943"></a>00943             unset($name_to_use_in_sort);
<a name="l00944"></a>00944             unset($is_orgname);
<a name="l00945"></a>00945 
<a name="l00946"></a>00946             <span class="comment">// 2.1.4 Do define the sorting URL</span>
<a name="l00947"></a>00947             <span class="keywordflow">if</span> (! $is_in_sort) {
<a name="l00948"></a>00948                 <span class="comment">// patch #455484 (&quot;Smart&quot; order)</span>
<a name="l00949"></a>00949                 <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;Order&#39;</span>] = strtoupper(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;Order&#39;</span>]);
<a name="l00950"></a>00950                 <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;Order&#39;</span>] === <span class="stringliteral">&#39;SMART&#39;</span>) {
<a name="l00951"></a>00951                     $sort_order .= (preg_match(<span class="stringliteral">&#39;@time|date@i&#39;</span>, $fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;<a class="code" href="original_2css_2theme__right_8css_8php.html#ae1d92a0cf6d4204d310bc3b8ef7ec56a">type</a>)) ? <span class="stringliteral">&#39;DESC&#39;</span> : <span class="stringliteral">&#39;ASC&#39;</span>;
<a name="l00952"></a>00952                 } <span class="keywordflow">else</span> {
<a name="l00953"></a>00953                     $sort_order .= <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;Order&#39;</span>];
<a name="l00954"></a>00954                 }
<a name="l00955"></a>00955                 $order_img   = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00956"></a>00956             } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (<span class="stringliteral">&#39;DESC&#39;</span> == $sort_direction) {
<a name="l00957"></a>00957                 $sort_order .= <span class="stringliteral">&#39; ASC&#39;</span>;
<a name="l00958"></a>00958                 $order_img   = <span class="charliteral">&#39; &#39;</span> . <a class="code" href="common_8lib_8php.html#a54fdec9763bf305a5082d23a5d7d5957" title="Returns an HTML IMG tag for a particular image from a theme, which may be an actual file or an icon f...">PMA_getImage</a>(<span class="stringliteral">&#39;s_desc.png&#39;</span>, __(<span class="stringliteral">&#39;Descending&#39;</span>), array(<span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&quot;soimg$i&quot;</span>, <span class="stringliteral">&#39;title&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>));
<a name="l00959"></a>00959                 $order_img  .= <span class="charliteral">&#39; &#39;</span> . <a class="code" href="common_8lib_8php.html#a54fdec9763bf305a5082d23a5d7d5957" title="Returns an HTML IMG tag for a particular image from a theme, which may be an actual file or an icon f...">PMA_getImage</a>(<span class="stringliteral">&#39;s_asc.png&#39;</span>, __(<span class="stringliteral">&#39;Ascending&#39;</span>), array(<span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&quot;soimg$i hide&quot;</span>, <span class="stringliteral">&#39;title&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>));
<a name="l00960"></a>00960             } <span class="keywordflow">else</span> {
<a name="l00961"></a>00961                 $sort_order .= <span class="stringliteral">&#39; DESC&#39;</span>;
<a name="l00962"></a>00962                 $order_img   = <span class="charliteral">&#39; &#39;</span> . <a class="code" href="common_8lib_8php.html#a54fdec9763bf305a5082d23a5d7d5957" title="Returns an HTML IMG tag for a particular image from a theme, which may be an actual file or an icon f...">PMA_getImage</a>(<span class="stringliteral">&#39;s_asc.png&#39;</span>, __(<span class="stringliteral">&#39;Ascending&#39;</span>), array(<span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&quot;soimg$i&quot;</span>, <span class="stringliteral">&#39;title&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>));
<a name="l00963"></a>00963                 $order_img  .= <span class="charliteral">&#39; &#39;</span> . <a class="code" href="common_8lib_8php.html#a54fdec9763bf305a5082d23a5d7d5957" title="Returns an HTML IMG tag for a particular image from a theme, which may be an actual file or an icon f...">PMA_getImage</a>(<span class="stringliteral">&#39;s_desc.png&#39;</span>, __(<span class="stringliteral">&#39;Descending&#39;</span>), array(<span class="stringliteral">&#39;class&#39;</span> =&gt; <span class="stringliteral">&quot;soimg$i hide&quot;</span>, <span class="stringliteral">&#39;title&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>));
<a name="l00964"></a>00964             }
<a name="l00965"></a>00965 
<a name="l00966"></a>00966             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;@(.*)([[:space:]](LIMIT (.*)|PROCEDURE (.*)|FOR UPDATE|LOCK IN SHARE MODE))@is&#39;</span>, $unsorted_sql_query, $regs3)) {
<a name="l00967"></a>00967                 $sorted_sql_query = $regs3[1] . $sort_order . $regs3[2];
<a name="l00968"></a>00968             } <span class="keywordflow">else</span> {
<a name="l00969"></a>00969                 $sorted_sql_query = $unsorted_sql_query . $sort_order;
<a name="l00970"></a>00970             }
<a name="l00971"></a>00971             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l00972"></a>00972                 <span class="stringliteral">&#39;db&#39;</span>                =&gt; $db,
<a name="l00973"></a>00973                 <span class="stringliteral">&#39;table&#39;</span>             =&gt; $table,
<a name="l00974"></a>00974                 <span class="stringliteral">&#39;sql_query&#39;</span>         =&gt; $sorted_sql_query,
<a name="l00975"></a>00975                 <span class="stringliteral">&#39;session_max_rows&#39;</span>  =&gt; $session_max_rows
<a name="l00976"></a>00976             );
<a name="l00977"></a>00977             $order_url  = <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l00978"></a>00978 
<a name="l00979"></a>00979             <span class="comment">// 2.1.5 Displays the sorting URL</span>
<a name="l00980"></a>00980             <span class="comment">// enable sort order swapping for image</span>
<a name="l00981"></a>00981             $order_link_params = array();
<a name="l00982"></a>00982             <span class="keywordflow">if</span> (isset($order_img) &amp;&amp; $order_img!=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l00983"></a>00983                 <span class="keywordflow">if</span> (strstr($order_img, <span class="stringliteral">&#39;asc&#39;</span>)) {
<a name="l00984"></a>00984                     $order_link_params[<span class="stringliteral">&#39;onmouseover&#39;</span>] = <span class="stringliteral">&quot;$(&#39;.soimg$i&#39;).toggle()&quot;</span>;
<a name="l00985"></a>00985                     $order_link_params[<span class="stringliteral">&#39;onmouseout&#39;</span>]  = <span class="stringliteral">&quot;$(&#39;.soimg$i&#39;).toggle()&quot;</span>;
<a name="l00986"></a>00986                 } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (strstr($order_img, <span class="stringliteral">&#39;desc&#39;</span>)) {
<a name="l00987"></a>00987                     $order_link_params[<span class="stringliteral">&#39;onmouseover&#39;</span>] = <span class="stringliteral">&quot;$(&#39;.soimg$i&#39;).toggle()&quot;</span>;
<a name="l00988"></a>00988                     $order_link_params[<span class="stringliteral">&#39;onmouseout&#39;</span>]  = <span class="stringliteral">&quot;$(&#39;.soimg$i&#39;).toggle()&quot;</span>;
<a name="l00989"></a>00989                 }
<a name="l00990"></a>00990             }
<a name="l00991"></a>00991             <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;HeaderFlipType&#39;</span>] == <span class="stringliteral">&#39;auto&#39;</span>) {
<a name="l00992"></a>00992                 <span class="keywordflow">if</span> (PMA_USR_BROWSER_AGENT == <span class="stringliteral">&#39;IE&#39;</span>) {
<a name="l00993"></a>00993                     <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;HeaderFlipType&#39;</span>] = <span class="stringliteral">&#39;css&#39;</span>;
<a name="l00994"></a>00994                 } <span class="keywordflow">else</span> {
<a name="l00995"></a>00995                     <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;HeaderFlipType&#39;</span>] = <span class="stringliteral">&#39;fake&#39;</span>;
<a name="l00996"></a>00996                 }
<a name="l00997"></a>00997             }
<a name="l00998"></a>00998             <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l00999"></a>00999                 &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;HeaderFlipType&#39;</span>] == <span class="stringliteral">&#39;css&#39;</span>
<a name="l01000"></a>01000             ) {
<a name="l01001"></a>01001                 $order_link_params[<span class="stringliteral">&#39;style&#39;</span>] = <span class="stringliteral">&#39;direction: ltr; writing-mode: tb-rl;&#39;</span>;
<a name="l01002"></a>01002             }
<a name="l01003"></a>01003             $order_link_params[<span class="stringliteral">&#39;title&#39;</span>] = __(<span class="stringliteral">&#39;Sort&#39;</span>);
<a name="l01004"></a>01004             $order_link_content = (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span> &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;HeaderFlipType&#39;</span>] == <span class="stringliteral">&#39;fake&#39;</span> ? <a class="code" href="common_8lib_8php.html#ac8192d573b73ab9677d973c6a70ac1fb" title="Takes a string and outputs each character on a line for itself.">PMA_flipstring</a>(htmlspecialchars($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name), <span class="stringliteral">&quot;&lt;br /&gt;\n&quot;</span>) : htmlspecialchars($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name));
<a name="l01005"></a>01005             $order_link = <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>($order_url, $order_link_content . $order_img, $order_link_params, <span class="keyword">false</span>, <span class="keyword">true</span>);
<a name="l01006"></a>01006 
<a name="l01007"></a>01007             <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01008"></a>01008                 || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01009"></a>01009             ) {
<a name="l01010"></a>01010                 echo <span class="stringliteral">&#39;&lt;th&#39;</span>;
<a name="l01011"></a>01011                 $th_class = array();
<a name="l01012"></a>01012                 $th_class[] = <span class="stringliteral">&#39;draggable&#39;</span>;
<a name="l01013"></a>01013                 <span class="keywordflow">if</span> ($col_visib &amp;&amp; !$col_visib[$j]) {
<a name="l01014"></a>01014                     $th_class[] = <span class="stringliteral">&#39;hide&#39;</span>;
<a name="l01015"></a>01015                 }
<a name="l01016"></a>01016                 <span class="keywordflow">if</span> ($condition_field) {
<a name="l01017"></a>01017                     $th_class[] = <span class="stringliteral">&#39;condition&#39;</span>;
<a name="l01018"></a>01018                 }
<a name="l01019"></a>01019                 $th_class[] = <span class="stringliteral">&#39;column_heading&#39;</span>;
<a name="l01020"></a>01020                 <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;BrowsePointerEnable&#39;</span>] == <span class="keyword">true</span>) {
<a name="l01021"></a>01021                     $th_class[] = <span class="stringliteral">&#39;pointer&#39;</span>;
<a name="l01022"></a>01022                 }
<a name="l01023"></a>01023                 <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;BrowseMarkerEnable&#39;</span>] == <span class="keyword">true</span>) {
<a name="l01024"></a>01024                     $th_class[] = <span class="stringliteral">&#39;marker&#39;</span>;
<a name="l01025"></a>01025                 }
<a name="l01026"></a>01026                 echo <span class="stringliteral">&#39; class=&quot;&#39;</span> . implode(<span class="charliteral">&#39; &#39;</span>, $th_class) . <span class="charliteral">&#39;&quot;&#39;</span>;
<a name="l01027"></a>01027 
<a name="l01028"></a>01028                 <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>) {
<a name="l01029"></a>01029                     echo <span class="stringliteral">&#39; valign=&quot;bottom&quot;&#39;</span>;
<a name="l01030"></a>01030                 }
<a name="l01031"></a>01031                 echo <span class="charliteral">&#39;&gt;&#39;</span> . $order_link . $comments . <span class="stringliteral">&#39;&lt;/th&gt;&#39;</span>;
<a name="l01032"></a>01032             }
<a name="l01033"></a>01033             $vertical_display[<span class="stringliteral">&#39;desc&#39;</span>][] = <span class="stringliteral">&#39;    &lt;th &#39;</span>
<a name="l01034"></a>01034                 . <span class="stringliteral">&#39;class=&quot;draggable&#39;</span>
<a name="l01035"></a>01035                 . ($condition_field ? <span class="stringliteral">&#39; condition&#39;</span> : <span class="stringliteral">&#39;&#39;</span>)
<a name="l01036"></a>01036                 . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01037"></a>01037                 . $order_link . $comments . <span class="stringliteral">&#39;    &lt;/th&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01038"></a>01038         } <span class="comment">// end if (2.1)</span>
<a name="l01039"></a>01039 
<a name="l01040"></a>01040         <span class="comment">// 2.2 Results can&#39;t be sorted</span>
<a name="l01041"></a>01041         <span class="keywordflow">else</span> {
<a name="l01042"></a>01042             <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01043"></a>01043                 || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01044"></a>01044             ) {
<a name="l01045"></a>01045                 echo <span class="stringliteral">&#39;&lt;th&#39;</span>;
<a name="l01046"></a>01046                 $th_class = array();
<a name="l01047"></a>01047                 $th_class[] = <span class="stringliteral">&#39;draggable&#39;</span>;
<a name="l01048"></a>01048                 <span class="keywordflow">if</span> ($col_visib &amp;&amp; !$col_visib[$j]) {
<a name="l01049"></a>01049                     $th_class[] = <span class="stringliteral">&#39;hide&#39;</span>;
<a name="l01050"></a>01050                 }
<a name="l01051"></a>01051                 <span class="keywordflow">if</span> ($condition_field) {
<a name="l01052"></a>01052                     $th_class[] = <span class="stringliteral">&#39;condition&#39;</span>;
<a name="l01053"></a>01053                 }
<a name="l01054"></a>01054                 echo <span class="stringliteral">&#39; class=&quot;&#39;</span> . implode(<span class="charliteral">&#39; &#39;</span>, $th_class) . <span class="charliteral">&#39;&quot;&#39;</span>;
<a name="l01055"></a>01055                 <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>) {
<a name="l01056"></a>01056                     echo <span class="stringliteral">&#39; valign=&quot;bottom&quot;&#39;</span>;
<a name="l01057"></a>01057                 }
<a name="l01058"></a>01058                 <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01059"></a>01059                     &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;HeaderFlipType&#39;</span>] == <span class="stringliteral">&#39;css&#39;</span>
<a name="l01060"></a>01060                 ) {
<a name="l01061"></a>01061                     echo <span class="stringliteral">&#39; style=&quot;direction: ltr; writing-mode: tb-rl;&quot;&#39;</span>;
<a name="l01062"></a>01062                 }
<a name="l01063"></a>01063                 echo <span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l01064"></a>01064                 <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01065"></a>01065                     &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;HeaderFlipType&#39;</span>] == <span class="stringliteral">&#39;fake&#39;</span>
<a name="l01066"></a>01066                 ) {
<a name="l01067"></a>01067                     echo <a class="code" href="common_8lib_8php.html#ac8192d573b73ab9677d973c6a70ac1fb" title="Takes a string and outputs each character on a line for itself.">PMA_flipstring</a>(htmlspecialchars($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name), <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>);
<a name="l01068"></a>01068                 } <span class="keywordflow">else</span> {
<a name="l01069"></a>01069                     echo htmlspecialchars($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name);
<a name="l01070"></a>01070                 }
<a name="l01071"></a>01071                 echo <span class="stringliteral">&quot;\n&quot;</span> . $comments . <span class="stringliteral">&#39;&lt;/th&gt;&#39;</span>;
<a name="l01072"></a>01072             }
<a name="l01073"></a>01073             $vertical_display[<span class="stringliteral">&#39;desc&#39;</span>][] = <span class="stringliteral">&#39;    &lt;th &#39;</span>
<a name="l01074"></a>01074                 . <span class="stringliteral">&#39;class=&quot;draggable&#39;</span>
<a name="l01075"></a>01075                 . ($condition_field ? <span class="stringliteral">&#39; condition&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>)
<a name="l01076"></a>01076                 . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01077"></a>01077                 . <span class="stringliteral">&#39;        &#39;</span> . htmlspecialchars($fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]-&gt;name) . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01078"></a>01078                 . $comments . <span class="stringliteral">&#39;    &lt;/th&gt;&#39;</span>;
<a name="l01079"></a>01079         } <span class="comment">// end else (2.2)</span>
<a name="l01080"></a>01080     } <span class="comment">// end for</span>
<a name="l01081"></a>01081 
<a name="l01082"></a>01082     <span class="comment">// 3. Displays the needed checkboxes at the right</span>
<a name="l01083"></a>01083     <span class="comment">//    column of the result table header if possible and required...</span>
<a name="l01084"></a>01084     <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01085"></a>01085         &amp;&amp; ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> || $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>)
<a name="l01086"></a>01086         &amp;&amp; $is_display[<span class="stringliteral">&#39;text_btn&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>
<a name="l01087"></a>01087     ) {
<a name="l01088"></a>01088         $vertical_display[<span class="stringliteral">&#39;emptyafter&#39;</span>] = ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) ? 4 : 1;
<a name="l01089"></a>01089         <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01090"></a>01090             || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01091"></a>01091         ) {
<a name="l01092"></a>01092             echo <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01093"></a>01093             ?&gt;
<a name="l01094"></a>01094         &lt;th &lt;?php echo $colspan; ?&gt;&gt;&lt;?php echo $full_or_partial_text_link;?&gt;
<a name="l01095"></a>01095 &lt;/th&gt;
<a name="l01096"></a>01096             &lt;?php
<a name="l01097"></a>01097             <span class="comment">// end horizontal/horizontalflipped mode</span>
<a name="l01098"></a>01098         } <span class="keywordflow">else</span> {
<a name="l01099"></a>01099             $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>] = <span class="stringliteral">&#39;    &lt;th &#39;</span> . $rowspan . <span class="stringliteral">&#39; valign=&quot;middle&quot;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01100"></a>01100                                          . <span class="stringliteral">&#39;        &#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01101"></a>01101                                          . <span class="stringliteral">&#39;    &lt;/th&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01102"></a>01102         } <span class="comment">// end vertical mode</span>
<a name="l01103"></a>01103     }
<a name="l01104"></a>01104 
<a name="l01105"></a>01105     <span class="comment">//     ... elseif no button, displays empty columns if required</span>
<a name="l01106"></a>01106     <span class="comment">// (unless coming from Browse mode print view)</span>
<a name="l01107"></a>01107     <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01108"></a>01108         &amp;&amp; ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] == <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] == <span class="stringliteral">&#39;nn&#39;</span>)
<a name="l01109"></a>01109         &amp;&amp; (! <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;is_header_sent&#39;</span>])
<a name="l01110"></a>01110     ) {
<a name="l01111"></a>01111         $vertical_display[<span class="stringliteral">&#39;emptyafter&#39;</span>] = ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) ? 4 : 1;
<a name="l01112"></a>01112         <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01113"></a>01113             || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01114"></a>01114         ) {
<a name="l01115"></a>01115             echo <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01116"></a>01116             ?&gt;
<a name="l01117"></a>01117 &lt;td&lt;?php echo $colspan; ?&gt;&gt;&lt;/<a class="code" href="original_2css_2theme__right_8css_8php.html#a2cb7bbff99e906a4fef499891dc9e6f5">td</a>&gt;
<a name="l01118"></a>01118             &lt;?php
<a name="l01119"></a>01119             <span class="comment">// end horizontal/horizontalflipped mode</span>
<a name="l01120"></a>01120         } <span class="keywordflow">else</span> {
<a name="l01121"></a>01121             $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>] = <span class="stringliteral">&#39;    &lt;td&#39;</span> . $rowspan . <span class="stringliteral">&#39;&gt;&lt;/td&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01122"></a>01122         } <span class="comment">// end vertical mode</span>
<a name="l01123"></a>01123     }
<a name="l01124"></a>01124 
<a name="l01125"></a>01125     <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01126"></a>01126         || <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01127"></a>01127     ) {
<a name="l01128"></a>01128         ?&gt;
<a name="l01129"></a>01129 &lt;/tr&gt;
<a name="l01130"></a>01130 &lt;/thead&gt;
<a name="l01131"></a>01131         &lt;?php
<a name="l01132"></a>01132     }
<a name="l01133"></a>01133 
<a name="l01134"></a>01134     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01135"></a>01135 } <span class="comment">// end of the &#39;PMA_displayTableHeaders()&#39; function</span>
<a name="l01136"></a>01136 
<a name="l01137"></a>01137 <span class="comment"></span>
<a name="l01138"></a>01138 <span class="comment">/**</span>
<a name="l01139"></a>01139 <span class="comment"> * Prepares the display for a value</span>
<a name="l01140"></a>01140 <span class="comment"> *</span>
<a name="l01141"></a>01141 <span class="comment"> * @param string $class           class of table cell</span>
<a name="l01142"></a>01142 <span class="comment"> * @param bool   $condition_field whether to add CSS class condition</span>
<a name="l01143"></a>01143 <span class="comment"> * @param string $value           value to display</span>
<a name="l01144"></a>01144 <span class="comment"> *</span>
<a name="l01145"></a>01145 <span class="comment"> * @return  string  the td</span>
<a name="l01146"></a>01146 <span class="comment"> */</span>
<a name="l01147"></a><a class="code" href="display__tbl_8lib_8php.html#a16bfe926b3c308980b78111fe42b488a">01147</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a16bfe926b3c308980b78111fe42b488a" title="Prepares the display for a value.">PMA_buildValueDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, $value)
<a name="l01148"></a>01148 {
<a name="l01149"></a>01149     <span class="keywordflow">return</span> <span class="stringliteral">&#39;&lt;td align=&quot;left&quot;&#39;</span> . <span class="stringliteral">&#39; class=&quot;&#39;</span> . <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> . ($condition_field ? <span class="stringliteral">&#39; condition&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . $value . <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;
<a name="l01150"></a>01150 }
<a name="l01151"></a>01151 <span class="comment"></span>
<a name="l01152"></a>01152 <span class="comment">/**</span>
<a name="l01153"></a>01153 <span class="comment"> * Prepares the display for a null value</span>
<a name="l01154"></a>01154 <span class="comment"> *</span>
<a name="l01155"></a>01155 <span class="comment"> * @param string $class           class of table cell</span>
<a name="l01156"></a>01156 <span class="comment"> * @param bool   $condition_field whether to add CSS class condition</span>
<a name="l01157"></a>01157 <span class="comment"> * @param object $meta            the meta-information about this field</span>
<a name="l01158"></a>01158 <span class="comment"> * @param string $align           cell allignment</span>
<a name="l01159"></a>01159 <span class="comment"> *</span>
<a name="l01160"></a>01160 <span class="comment"> * @return  string  the td</span>
<a name="l01161"></a>01161 <span class="comment"> */</span>
<a name="l01162"></a><a class="code" href="display__tbl_8lib_8php.html#a2c7c156612516853ee09e323a5642c0e">01162</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a2c7c156612516853ee09e323a5642c0e" title="Prepares the display for a null value.">PMA_buildNullDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $align = <span class="stringliteral">&#39;&#39;</span>)
<a name="l01163"></a>01163 {
<a name="l01164"></a>01164     <span class="comment">// the null class is needed for grid editing</span>
<a name="l01165"></a>01165     <span class="keywordflow">return</span> <span class="stringliteral">&#39;&lt;td &#39;</span> . $align . <span class="stringliteral">&#39; class=&quot;&#39;</span> . <a class="code" href="display__tbl_8lib_8php.html#aa0260dfab206a823cd024ac7074044cd" title="Adds the relavant classes.">PMA_addClass</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, <span class="stringliteral">&#39;&#39;</span>) . <span class="stringliteral">&#39; null&quot;&gt;&lt;i&gt;NULL&lt;/i&gt;&lt;/td&gt;&#39;</span>;
<a name="l01166"></a>01166 }
<a name="l01167"></a>01167 <span class="comment"></span>
<a name="l01168"></a>01168 <span class="comment">/**</span>
<a name="l01169"></a>01169 <span class="comment"> * Prepares the display for an empty value</span>
<a name="l01170"></a>01170 <span class="comment"> *</span>
<a name="l01171"></a>01171 <span class="comment"> * @param string $class           class of table cell</span>
<a name="l01172"></a>01172 <span class="comment"> * @param bool   $condition_field whether to add CSS class condition</span>
<a name="l01173"></a>01173 <span class="comment"> * @param object $meta            the meta-information about this field</span>
<a name="l01174"></a>01174 <span class="comment"> * @param string $align           cell allignment</span>
<a name="l01175"></a>01175 <span class="comment"> *</span>
<a name="l01176"></a>01176 <span class="comment"> * @return  string  the td</span>
<a name="l01177"></a>01177 <span class="comment"> */</span>
<a name="l01178"></a><a class="code" href="display__tbl_8lib_8php.html#a30685d4fa17670dc2fd8cc11b12cac81">01178</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a30685d4fa17670dc2fd8cc11b12cac81" title="Prepares the display for an empty value.">PMA_buildEmptyDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $align = <span class="stringliteral">&#39;&#39;</span>)
<a name="l01179"></a>01179 {
<a name="l01180"></a>01180     $nowrap = <span class="stringliteral">&#39; nowrap&#39;</span>;
<a name="l01181"></a>01181     <span class="keywordflow">return</span> <span class="stringliteral">&#39;&lt;td &#39;</span> . $align . <span class="stringliteral">&#39; class=&quot;&#39;</span> . <a class="code" href="display__tbl_8lib_8php.html#aa0260dfab206a823cd024ac7074044cd" title="Adds the relavant classes.">PMA_addClass</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $nowrap)  . <span class="stringliteral">&#39;&quot;&gt;&lt;/td&gt;&#39;</span>;
<a name="l01182"></a>01182 }
<a name="l01183"></a>01183 <span class="comment"></span>
<a name="l01184"></a>01184 <span class="comment">/**</span>
<a name="l01185"></a>01185 <span class="comment"> * Adds the relavant classes.</span>
<a name="l01186"></a>01186 <span class="comment"> *</span>
<a name="l01187"></a>01187 <span class="comment"> * @param string $class              class of table cell</span>
<a name="l01188"></a>01188 <span class="comment"> * @param bool   $condition_field    whether to add CSS class condition</span>
<a name="l01189"></a>01189 <span class="comment"> * @param object $meta               the meta-information about this field</span>
<a name="l01190"></a>01190 <span class="comment"> * @param string $nowrap             avoid wrapping</span>
<a name="l01191"></a>01191 <span class="comment"> * @param bool   $is_field_truncated is field truncated (display ...)</span>
<a name="l01192"></a>01192 <span class="comment"> * @param string $transform_function transformation function</span>
<a name="l01193"></a>01193 <span class="comment"> * @param string $default_function   default transformation function</span>
<a name="l01194"></a>01194 <span class="comment"> *</span>
<a name="l01195"></a>01195 <span class="comment"> * @return string the list of classes</span>
<a name="l01196"></a>01196 <span class="comment"> */</span>
<a name="l01197"></a><a class="code" href="display__tbl_8lib_8php.html#aa0260dfab206a823cd024ac7074044cd">01197</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#aa0260dfab206a823cd024ac7074044cd" title="Adds the relavant classes.">PMA_addClass</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $nowrap, $is_field_truncated = <span class="keyword">false</span>, $transform_function = <span class="stringliteral">&#39;&#39;</span>, $default_function = <span class="stringliteral">&#39;&#39;</span>)
<a name="l01198"></a>01198 {
<a name="l01199"></a>01199     <span class="comment">// Define classes to be added to this data field based on the type of data</span>
<a name="l01200"></a>01200     $enum_class = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01201"></a>01201     <span class="keywordflow">if</span> (strpos(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;flags, <span class="stringliteral">&#39;enum&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01202"></a>01202         $enum_class = <span class="stringliteral">&#39; enum&#39;</span>;
<a name="l01203"></a>01203     }
<a name="l01204"></a>01204 
<a name="l01205"></a>01205     $set_class = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01206"></a>01206     <span class="keywordflow">if</span> (strpos(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;flags, <span class="stringliteral">&#39;set&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01207"></a>01207         $set_class = <span class="stringliteral">&#39; set&#39;</span>;
<a name="l01208"></a>01208     }
<a name="l01209"></a>01209 
<a name="l01210"></a>01210     $bit_class = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01211"></a>01211     <span class="keywordflow">if</span> (strpos(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type, <span class="stringliteral">&#39;bit&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l01212"></a>01212         $bit_class = <span class="stringliteral">&#39; bit&#39;</span>;
<a name="l01213"></a>01213     }
<a name="l01214"></a>01214 
<a name="l01215"></a>01215     $mime_type_class = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01216"></a>01216     <span class="keywordflow">if</span> (isset(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;mimetype)) {
<a name="l01217"></a>01217         $mime_type_class = <span class="charliteral">&#39; &#39;</span> . preg_replace(<span class="stringliteral">&#39;/\//&#39;</span>, <span class="charliteral">&#39;_&#39;</span>, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;mimetype);
<a name="l01218"></a>01218     }
<a name="l01219"></a>01219 
<a name="l01220"></a>01220     <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> . ($condition_field ? <span class="stringliteral">&#39; condition&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . $nowrap
<a name="l01221"></a>01221     . <span class="charliteral">&#39; &#39;</span> . ($is_field_truncated ? <span class="stringliteral">&#39; truncated&#39;</span> : <span class="stringliteral">&#39;&#39;</span>)
<a name="l01222"></a>01222     . ($transform_function != $default_function ? <span class="stringliteral">&#39; transformed&#39;</span> : <span class="stringliteral">&#39;&#39;</span>)
<a name="l01223"></a>01223     . $enum_class . $set_class . $bit_class . $mime_type_class;
<a name="l01224"></a>01224 
<a name="l01225"></a>01225     <span class="keywordflow">return</span> <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>;
<a name="l01226"></a>01226 }<span class="comment"></span>
<a name="l01227"></a>01227 <span class="comment">/**</span>
<a name="l01228"></a>01228 <span class="comment"> * Displays the body of the results table</span>
<a name="l01229"></a>01229 <span class="comment"> *</span>
<a name="l01230"></a>01230 <span class="comment"> * @param integer &amp;$dt_result   the link id associated to the query which results have</span>
<a name="l01231"></a>01231 <span class="comment"> *                              to be displayed</span>
<a name="l01232"></a>01232 <span class="comment"> * @param array   &amp;$is_display  which elements to display</span>
<a name="l01233"></a>01233 <span class="comment"> * @param array   $map          the list of relations</span>
<a name="l01234"></a>01234 <span class="comment"> * @param array   $analyzed_sql the analyzed query</span>
<a name="l01235"></a>01235 <span class="comment"> *</span>
<a name="l01236"></a>01236 <span class="comment"> * @return  boolean  always true</span>
<a name="l01237"></a>01237 <span class="comment"> *</span>
<a name="l01238"></a>01238 <span class="comment"> * @global string   $db                the database name</span>
<a name="l01239"></a>01239 <span class="comment"> * @global string   $table             the table name</span>
<a name="l01240"></a>01240 <span class="comment"> * @global string   $goto              the URL to go back in case of errors</span>
<a name="l01241"></a>01241 <span class="comment"> * @global string   $sql_query         the SQL query</span>
<a name="l01242"></a>01242 <span class="comment"> * @global array    $fields_meta       the list of fields properties</span>
<a name="l01243"></a>01243 <span class="comment"> * @global integer  $fields_cnt        the total number of fields returned by</span>
<a name="l01244"></a>01244 <span class="comment"> *                                      the SQL query</span>
<a name="l01245"></a>01245 <span class="comment"> * @global array    $vertical_display  informations used with vertical display</span>
<a name="l01246"></a>01246 <span class="comment"> *                                      mode</span>
<a name="l01247"></a>01247 <span class="comment"> * @global array    $highlight_columns column names to highlight</span>
<a name="l01248"></a>01248 <span class="comment"> * @global array    $row               current row data</span>
<a name="l01249"></a>01249 <span class="comment"> *</span>
<a name="l01250"></a>01250 <span class="comment"> * @access private</span>
<a name="l01251"></a>01251 <span class="comment"> *</span>
<a name="l01252"></a>01252 <span class="comment"> * @see     PMA_displayTable()</span>
<a name="l01253"></a>01253 <span class="comment"> */</span>
<a name="l01254"></a><a class="code" href="display__tbl_8lib_8php.html#a584c8e9b54e86afef57d654e60a836ed">01254</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a584c8e9b54e86afef57d654e60a836ed" title="Displays the body of the results table.">PMA_displayTableBody</a>(&amp;$dt_result, &amp;$is_display, $map, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>)
<a name="l01255"></a>01255 {
<a name="l01256"></a>01256     global <a class="code" href="schema__export_8php.html#a907d78797a1b764e913b0c565a5097b0" title="get all the export options and verify call and include the appropriate Schema Class depending on $exp...">$db</a>, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>, <a class="code" href="db__sql_8php.html#a4037a8ff7343cce7ab4dadfd490ad3ee">$goto</a>;
<a name="l01257"></a>01257     global <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>, $fields_meta, <a class="code" href="tbl__change_8php.html#a580526107852923681984db1a74a921c">$fields_cnt</a>;
<a name="l01258"></a>01258     global $vertical_display, $highlight_columns;
<a name="l01259"></a>01259     global <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>; <span class="comment">// mostly because of browser transformations, to make the row-data accessible in a plugin</span>
<a name="l01260"></a>01260 
<a name="l01261"></a>01261     $url_sql_query          = <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>;
<a name="l01262"></a>01262 
<a name="l01263"></a>01263     <span class="comment">// query without conditions to shorten URLs when needed, 200 is just</span>
<a name="l01264"></a>01264     <span class="comment">// guess, it should depend on remaining URL length</span>
<a name="l01265"></a>01265 
<a name="l01266"></a>01266     <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>)
<a name="l01267"></a>01267         &amp;&amp; isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0])
<a name="l01268"></a>01268         &amp;&amp; isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;querytype&#39;</span>])
<a name="l01269"></a>01269         &amp;&amp; <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;querytype&#39;</span>] == <span class="stringliteral">&#39;SELECT&#39;</span>
<a name="l01270"></a>01270         &amp;&amp; strlen($sql_query) &gt; 200
<a name="l01271"></a>01271     ) {
<a name="l01272"></a>01272 
<a name="l01273"></a>01273         $url_sql_query = <span class="stringliteral">&#39;SELECT &#39;</span>;
<a name="l01274"></a>01274         <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;queryflags&#39;</span>][<span class="stringliteral">&#39;distinct&#39;</span>])) {
<a name="l01275"></a>01275             $url_sql_query .= <span class="stringliteral">&#39; DISTINCT &#39;</span>;
<a name="l01276"></a>01276         }
<a name="l01277"></a>01277         $url_sql_query .= <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;select_expr_clause&#39;</span>];
<a name="l01278"></a>01278         <span class="keywordflow">if</span> (!empty(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;from_clause&#39;</span>])) {
<a name="l01279"></a>01279             $url_sql_query .= <span class="stringliteral">&#39; FROM &#39;</span> . <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;from_clause&#39;</span>];
<a name="l01280"></a>01280         }
<a name="l01281"></a>01281     }
<a name="l01282"></a>01282 
<a name="l01283"></a>01283     <span class="keywordflow">if</span> (! is_array($map)) {
<a name="l01284"></a>01284         $map = array();
<a name="l01285"></a>01285     }
<a name="l01286"></a>01286     $row_no                         = 0;
<a name="l01287"></a>01287     $vertical_display[<span class="stringliteral">&#39;edit&#39;</span>]       = array();
<a name="l01288"></a>01288     $vertical_display[<span class="stringliteral">&#39;copy&#39;</span>]       = array();
<a name="l01289"></a>01289     $vertical_display[<span class="stringliteral">&#39;delete&#39;</span>]     = array();
<a name="l01290"></a>01290     $vertical_display[<span class="stringliteral">&#39;data&#39;</span>]       = array();
<a name="l01291"></a>01291     $vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>] = array();
<a name="l01292"></a>01292     <span class="comment">// name of the class added to all grid editable elements</span>
<a name="l01293"></a>01293     $grid_edit_class = <span class="stringliteral">&#39;grid_edit&#39;</span>;
<a name="l01294"></a>01294 
<a name="l01295"></a>01295     <span class="comment">// prepare to get the column order, if available</span>
<a name="l01296"></a>01296     <span class="keywordflow">if</span> (<a class="code" href="display__tbl_8lib_8php.html#a6ebb093d6eba080e154ab70b63261772" title="Return true if we are executing a query in the form of &quot;SELECT * FROM &lt;a table&gt; ...&quot;.">PMA_isSelect</a>()) {
<a name="l01297"></a>01297         $pmatable = <span class="keyword">new</span> <a class="code" href="classPMA__Table.html">PMA_Table</a>(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;table&#39;</span>], <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;db&#39;</span>]);
<a name="l01298"></a>01298         $col_order = $pmatable-&gt;getUiProp(<a class="code" href="classPMA__Table.html#a86b9ea13c062cd4eff72f5f3b723d310">PMA_Table::PROP_COLUMN_ORDER</a>);
<a name="l01299"></a>01299         $col_visib = $pmatable-&gt;getUiProp(<a class="code" href="classPMA__Table.html#ae74bd68753eeb8be8cf2cfe0272c8d1f">PMA_Table::PROP_COLUMN_VISIB</a>);
<a name="l01300"></a>01300     } <span class="keywordflow">else</span> {
<a name="l01301"></a>01301         $col_order = <span class="keyword">false</span>;
<a name="l01302"></a>01302         $col_visib = <span class="keyword">false</span>;
<a name="l01303"></a>01303     }
<a name="l01304"></a>01304 
<a name="l01305"></a>01305     <span class="comment">// Correction University of Virginia 19991216 in the while below</span>
<a name="l01306"></a>01306     <span class="comment">// Previous code assumed that all tables have keys, specifically that</span>
<a name="l01307"></a>01307     <span class="comment">// the phpMyAdmin GUI should support row delete/edit only for such</span>
<a name="l01308"></a>01308     <span class="comment">// tables.</span>
<a name="l01309"></a>01309     <span class="comment">// Although always using keys is arguably the prescribed way of</span>
<a name="l01310"></a>01310     <span class="comment">// defining a relational table, it is not required. This will in</span>
<a name="l01311"></a>01311     <span class="comment">// particular be violated by the novice.</span>
<a name="l01312"></a>01312     <span class="comment">// We want to encourage phpMyAdmin usage by such novices. So the code</span>
<a name="l01313"></a>01313     <span class="comment">// below has been changed to conditionally work as before when the</span>
<a name="l01314"></a>01314     <span class="comment">// table being displayed has one or more keys; but to display</span>
<a name="l01315"></a>01315     <span class="comment">// delete/edit options correctly for tables without keys.</span>
<a name="l01316"></a>01316 
<a name="l01317"></a>01317     <a class="code" href="db__qbe_8php.html#aa97fee01a612c36c64d62b32a99d5b5d">$odd_row</a> = <span class="keyword">true</span>;
<a name="l01318"></a>01318     <span class="keywordflow">while</span> ($row = <a class="code" href="drizzle_8dbi_8lib_8php.html#a76a677a68b562828af0dfe4467107d31" title="returns array of rows with numeric keys from $result">PMA_DBI_fetch_row</a>($dt_result)) {
<a name="l01319"></a>01319         <span class="comment">// &quot;vertical display&quot; mode stuff</span>
<a name="l01320"></a>01320         <span class="keywordflow">if</span> ($row_no != 0 &amp;&amp; <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>] != 0
<a name="l01321"></a>01321             &amp;&amp; !($row_no % <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>])
<a name="l01322"></a>01322             &amp;&amp; ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01323"></a>01323             || $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>)
<a name="l01324"></a>01324         ) {
<a name="l01325"></a>01325             echo <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01326"></a>01326             <span class="keywordflow">if</span> ($vertical_display[<span class="stringliteral">&#39;emptypre&#39;</span>] &gt; 0) {
<a name="l01327"></a>01327                 echo <span class="stringliteral">&#39;    &lt;th colspan=&quot;&#39;</span> . $vertical_display[<span class="stringliteral">&#39;emptypre&#39;</span>] . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01328"></a>01328                     .<span class="stringliteral">&#39;        &amp;nbsp;&lt;/th&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01329"></a>01329             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;none&#39;</span>) {
<a name="l01330"></a>01330                 echo <span class="stringliteral">&#39;    &lt;th&gt;&lt;/th&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01331"></a>01331             }
<a name="l01332"></a>01332 
<a name="l01333"></a>01333             <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;desc&#39;</span>] as $val) {
<a name="l01334"></a>01334                 echo $val;
<a name="l01335"></a>01335             }
<a name="l01336"></a>01336 
<a name="l01337"></a>01337             <span class="keywordflow">if</span> ($vertical_display[<span class="stringliteral">&#39;emptyafter&#39;</span>] &gt; 0) {
<a name="l01338"></a>01338                 echo <span class="stringliteral">&#39;    &lt;th colspan=&quot;&#39;</span> . $vertical_display[<span class="stringliteral">&#39;emptyafter&#39;</span>] . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01339"></a>01339                     .<span class="stringliteral">&#39;        &amp;nbsp;&lt;/th&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01340"></a>01340             }
<a name="l01341"></a>01341             echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01342"></a>01342         } <span class="comment">// end if</span>
<a name="l01343"></a>01343 
<a name="l01344"></a>01344         $alternating_color_class = (<a class="code" href="db__qbe_8php.html#aa97fee01a612c36c64d62b32a99d5b5d">$odd_row</a> ? <span class="stringliteral">&#39;odd&#39;</span> : <span class="stringliteral">&#39;even&#39;</span>);
<a name="l01345"></a>01345         <a class="code" href="db__qbe_8php.html#aa97fee01a612c36c64d62b32a99d5b5d">$odd_row</a> = ! <a class="code" href="db__qbe_8php.html#aa97fee01a612c36c64d62b32a99d5b5d">$odd_row</a>;
<a name="l01346"></a>01346 
<a name="l01347"></a>01347         <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01348"></a>01348             || $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01349"></a>01349         ) {
<a name="l01350"></a>01350             <span class="comment">// pointer code part</span>
<a name="l01351"></a>01351             echo <span class="stringliteral">&#39;&lt;tr class=&quot;&#39;</span> . $alternating_color_class . <span class="stringliteral">&#39;&quot;&gt;&#39;</span>;
<a name="l01352"></a>01352         }
<a name="l01353"></a>01353 
<a name="l01354"></a>01354 
<a name="l01355"></a>01355         <span class="comment">// 1. Prepares the row</span>
<a name="l01356"></a>01356         <span class="comment">// 1.1 Results from a &quot;SELECT&quot; statement -&gt; builds the</span>
<a name="l01357"></a>01357         <span class="comment">//     WHERE clause to use in links (a unique key if possible)</span><span class="comment"></span>
<a name="l01358"></a>01358 <span class="comment">        /**</span>
<a name="l01359"></a>01359 <span class="comment">         * @todo $where_clause could be empty, for example a table</span>
<a name="l01360"></a>01360 <span class="comment">         *       with only one field and it&#39;s a BLOB; in this case,</span>
<a name="l01361"></a>01361 <span class="comment">         *       avoid to display the delete and edit links</span>
<a name="l01362"></a>01362 <span class="comment">         */</span>
<a name="l01363"></a>01363         list($where_clause, $clause_is_unique, $condition_array) = <a class="code" href="common_8lib_8php.html#a8ee43ac6fdd31f561ca640b2c20d05a1" title="Function to generate unique condition for specified row.">PMA_getUniqueCondition</a>($dt_result, $fields_cnt, $fields_meta, $row);
<a name="l01364"></a>01364         $where_clause_html = urlencode($where_clause);
<a name="l01365"></a>01365 
<a name="l01366"></a>01366         <span class="comment">// 1.2 Defines the URLs for the modify/delete link(s)</span>
<a name="l01367"></a>01367 
<a name="l01368"></a>01368         <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> || $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) {
<a name="l01369"></a>01369             <span class="comment">// We need to copy the value or else the == &#39;both&#39; check will always return true</span>
<a name="l01370"></a>01370 
<a name="l01371"></a>01371             <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;PropertiesIconic&#39;</span>] === <span class="stringliteral">&#39;both&#39;</span>) {
<a name="l01372"></a>01372                 $iconic_spacer = <span class="stringliteral">&#39;&lt;div class=&quot;nowrap&quot;&gt;&#39;</span>;
<a name="l01373"></a>01373             } <span class="keywordflow">else</span> {
<a name="l01374"></a>01374                 $iconic_spacer = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01375"></a>01375             }
<a name="l01376"></a>01376 
<a name="l01377"></a>01377             <span class="comment">// 1.2.1 Modify link(s)</span>
<a name="l01378"></a>01378             <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] == <span class="stringliteral">&#39;ur&#39;</span>) { <span class="comment">// update row case</span>
<a name="l01379"></a>01379                 <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l01380"></a>01380                     <span class="stringliteral">&#39;db&#39;</span>               =&gt; $db,
<a name="l01381"></a>01381                     <span class="stringliteral">&#39;table&#39;</span>            =&gt; $table,
<a name="l01382"></a>01382                     <span class="stringliteral">&#39;where_clause&#39;</span>     =&gt; $where_clause,
<a name="l01383"></a>01383                     <span class="stringliteral">&#39;clause_is_unique&#39;</span> =&gt; $clause_is_unique,
<a name="l01384"></a>01384                     <span class="stringliteral">&#39;sql_query&#39;</span>        =&gt; $url_sql_query,
<a name="l01385"></a>01385                     <span class="stringliteral">&#39;goto&#39;</span>             =&gt; <span class="stringliteral">&#39;sql.php&#39;</span>,
<a name="l01386"></a>01386                 );
<a name="l01387"></a>01387                 $edit_url = <span class="stringliteral">&#39;tbl_change.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> + array(<span class="stringliteral">&#39;default_action&#39;</span> =&gt; <span class="stringliteral">&#39;update&#39;</span>));
<a name="l01388"></a>01388                 $copy_url = <span class="stringliteral">&#39;tbl_change.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> + array(<span class="stringliteral">&#39;default_action&#39;</span> =&gt; <span class="stringliteral">&#39;insert&#39;</span>));
<a name="l01389"></a>01389 
<a name="l01390"></a>01390                 $edit_str = <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_edit.png&#39;</span>, __(<span class="stringliteral">&#39;Edit&#39;</span>));
<a name="l01391"></a>01391                 $copy_str = <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_insrow.png&#39;</span>, __(<span class="stringliteral">&#39;Copy&#39;</span>));
<a name="l01392"></a>01392 
<a name="l01393"></a>01393                 <span class="comment">// Class definitions required for grid editing jQuery scripts</span>
<a name="l01394"></a>01394                 $edit_anchor_class = <span class="stringliteral">&quot;edit_row_anchor&quot;</span>;
<a name="l01395"></a>01395                 <span class="keywordflow">if</span> ( $clause_is_unique == 0) {
<a name="l01396"></a>01396                     $edit_anchor_class .= <span class="stringliteral">&#39; nonunique&#39;</span>;
<a name="l01397"></a>01397                 }
<a name="l01398"></a>01398             } <span class="comment">// end if (1.2.1)</span>
<a name="l01399"></a>01399 
<a name="l01400"></a>01400             <span class="comment">// 1.2.2 Delete/Kill link(s)</span>
<a name="l01401"></a>01401             <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] == <span class="stringliteral">&#39;dr&#39;</span>) { <span class="comment">// delete row case</span>
<a name="l01402"></a>01402                 <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l01403"></a>01403                     <span class="stringliteral">&#39;db&#39;</span>        =&gt; $db,
<a name="l01404"></a>01404                     <span class="stringliteral">&#39;table&#39;</span>     =&gt; $table,
<a name="l01405"></a>01405                     <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; $url_sql_query,
<a name="l01406"></a>01406                     <span class="stringliteral">&#39;message_to_show&#39;</span> =&gt; __(<span class="stringliteral">&#39;The row has been deleted&#39;</span>),
<a name="l01407"></a>01407                     <span class="stringliteral">&#39;goto&#39;</span>      =&gt; (empty($goto) ? <span class="stringliteral">&#39;tbl_sql.php&#39;</span> : $goto),
<a name="l01408"></a>01408                 );
<a name="l01409"></a>01409                 $lnk_goto = <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>, <span class="stringliteral">&#39;text&#39;</span>);
<a name="l01410"></a>01410 
<a name="l01411"></a>01411                 $del_query = <span class="stringliteral">&#39;DELETE FROM &#39;</span> . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($db) . <span class="charliteral">&#39;.&#39;</span> . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($table)
<a name="l01412"></a>01412                     . <span class="stringliteral">&#39; WHERE &#39;</span> . $where_clause . ($clause_is_unique ? <span class="stringliteral">&#39;&#39;</span> : <span class="stringliteral">&#39; LIMIT 1&#39;</span>);
<a name="l01413"></a>01413 
<a name="l01414"></a>01414                 <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l01415"></a>01415                     <span class="stringliteral">&#39;db&#39;</span>        =&gt; $db,
<a name="l01416"></a>01416                     <span class="stringliteral">&#39;table&#39;</span>     =&gt; $table,
<a name="l01417"></a>01417                     <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; $del_query,
<a name="l01418"></a>01418                     <span class="stringliteral">&#39;message_to_show&#39;</span> =&gt; __(<span class="stringliteral">&#39;The row has been deleted&#39;</span>),
<a name="l01419"></a>01419                     <span class="stringliteral">&#39;goto&#39;</span>      =&gt; $lnk_goto,
<a name="l01420"></a>01420                 );
<a name="l01421"></a>01421                 $del_url  = <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l01422"></a>01422 
<a name="l01423"></a>01423                 $js_conf  = <span class="stringliteral">&#39;DELETE FROM &#39;</span> . <a class="code" href="js__escape_8lib_8php.html#adefa5e0c287e2534fb2d5a518cebc968" title="Format a string so it can be a string inside JavaScript code inside an eventhandler (onclick...">PMA_jsFormat</a>($db) . <span class="charliteral">&#39;.&#39;</span> . <a class="code" href="js__escape_8lib_8php.html#adefa5e0c287e2534fb2d5a518cebc968" title="Format a string so it can be a string inside JavaScript code inside an eventhandler (onclick...">PMA_jsFormat</a>($table)
<a name="l01424"></a>01424                           . <span class="stringliteral">&#39; WHERE &#39;</span> . <a class="code" href="js__escape_8lib_8php.html#adefa5e0c287e2534fb2d5a518cebc968" title="Format a string so it can be a string inside JavaScript code inside an eventhandler (onclick...">PMA_jsFormat</a>($where_clause, <span class="keyword">false</span>)
<a name="l01425"></a>01425                           . ($clause_is_unique ? <span class="stringliteral">&#39;&#39;</span> : <span class="stringliteral">&#39; LIMIT 1&#39;</span>);
<a name="l01426"></a>01426                 $del_str = <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_drop.png&#39;</span>, __(<span class="stringliteral">&#39;Delete&#39;</span>));
<a name="l01427"></a>01427             } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ($is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] == <span class="stringliteral">&#39;kp&#39;</span>) { <span class="comment">// kill process case</span>
<a name="l01428"></a>01428 
<a name="l01429"></a>01429                 <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l01430"></a>01430                     <span class="stringliteral">&#39;db&#39;</span>        =&gt; $db,
<a name="l01431"></a>01431                     <span class="stringliteral">&#39;table&#39;</span>     =&gt; $table,
<a name="l01432"></a>01432                     <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; $url_sql_query,
<a name="l01433"></a>01433                     <span class="stringliteral">&#39;goto&#39;</span>      =&gt; <span class="stringliteral">&#39;main.php&#39;</span>,
<a name="l01434"></a>01434                 );
<a name="l01435"></a>01435                 $lnk_goto = <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>, <span class="stringliteral">&#39;text&#39;</span>);
<a name="l01436"></a>01436 
<a name="l01437"></a>01437                 <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l01438"></a>01438                     <span class="stringliteral">&#39;db&#39;</span>        =&gt; <span class="stringliteral">&#39;mysql&#39;</span>,
<a name="l01439"></a>01439                     <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; <span class="stringliteral">&#39;KILL &#39;</span> . $row[0],
<a name="l01440"></a>01440                     <span class="stringliteral">&#39;goto&#39;</span>      =&gt; $lnk_goto,
<a name="l01441"></a>01441                 );
<a name="l01442"></a>01442                 $del_url  = <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l01443"></a>01443                 $del_query = <span class="stringliteral">&#39;KILL &#39;</span> . $row[0];
<a name="l01444"></a>01444                 $js_conf  = <span class="stringliteral">&#39;KILL &#39;</span> . $row[0];
<a name="l01445"></a>01445                 $del_str = <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_drop.png&#39;</span>, __(<span class="stringliteral">&#39;Kill&#39;</span>));
<a name="l01446"></a>01446             } <span class="comment">// end if (1.2.2)</span>
<a name="l01447"></a>01447 
<a name="l01448"></a>01448             <span class="comment">// 1.3 Displays the links at left if required</span>
<a name="l01449"></a>01449             <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01450"></a>01450                 &amp;&amp; ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01451"></a>01451                 || $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>)
<a name="l01452"></a>01452             ) {
<a name="l01453"></a>01453                 <span class="keywordflow">if</span> (! isset($js_conf)) {
<a name="l01454"></a>01454                     $js_conf = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01455"></a>01455                 }
<a name="l01456"></a>01456                 echo <a class="code" href="display__tbl_8lib_8php.html#aa2941a0e12aa16299a69a68c06c1ef12" title="Generates checkbox and links at some position (left or right) (only called for horizontal mode)...">PMA_generateCheckboxAndLinks</a>(<span class="stringliteral">&#39;left&#39;</span>, $del_url, $is_display, $row_no, $where_clause, $where_clause_html, $condition_array, $del_query, <span class="charliteral">&#39;l&#39;</span>, $edit_url, $copy_url, $edit_anchor_class, $edit_str, $copy_str, $del_str, $js_conf);
<a name="l01457"></a>01457             } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;none&#39;</span>)
<a name="l01458"></a>01458                 &amp;&amp; ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01459"></a>01459                 || $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>)
<a name="l01460"></a>01460             ) {
<a name="l01461"></a>01461                 <span class="keywordflow">if</span> (! isset($js_conf)) {
<a name="l01462"></a>01462                     $js_conf = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01463"></a>01463                 }
<a name="l01464"></a>01464                 echo <a class="code" href="display__tbl_8lib_8php.html#aa2941a0e12aa16299a69a68c06c1ef12" title="Generates checkbox and links at some position (left or right) (only called for horizontal mode)...">PMA_generateCheckboxAndLinks</a>(<span class="stringliteral">&#39;none&#39;</span>, $del_url, $is_display, $row_no, $where_clause, $where_clause_html, $condition_array, $del_query, <span class="charliteral">&#39;l&#39;</span>, $edit_url, $copy_url, $edit_anchor_class, $edit_str, $copy_str, $del_str, $js_conf);
<a name="l01465"></a>01465             } <span class="comment">// end if (1.3)</span>
<a name="l01466"></a>01466         } <span class="comment">// end if (1)</span>
<a name="l01467"></a>01467 
<a name="l01468"></a>01468         <span class="comment">// 2. Displays the rows&#39; values</span>
<a name="l01469"></a>01469 
<a name="l01470"></a>01470         <span class="keywordflow">for</span> ($j = 0; $j &lt; <a class="code" href="tbl__change_8php.html#a580526107852923681984db1a74a921c">$fields_cnt</a>; ++$j) {
<a name="l01471"></a>01471             <span class="comment">// assign $i with appropriate column order</span>
<a name="l01472"></a>01472             <a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> = $col_order ? $col_order[$j] : $j;
<a name="l01473"></a>01473 
<a name="l01474"></a>01474             <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>    = $fields_meta[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>];
<a name="l01475"></a>01475             $not_null_class = <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;not_null ? <span class="stringliteral">&#39;not_null&#39;</span> : <span class="stringliteral">&#39;&#39;</span>;
<a name="l01476"></a>01476             $relation_class = isset($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name]) ? <span class="stringliteral">&#39;relation&#39;</span> : <span class="stringliteral">&#39;&#39;</span>;
<a name="l01477"></a>01477             $hide_class = ($col_visib &amp;&amp; !$col_visib[$j] &amp;&amp;
<a name="l01478"></a>01478                            <span class="comment">// hide per &lt;td&gt; only if the display direction is not vertical</span>
<a name="l01479"></a>01479                            $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] != <span class="stringliteral">&#39;vertical&#39;</span>) ? <span class="stringliteral">&#39;hide&#39;</span> : <span class="stringliteral">&#39;&#39;</span>;
<a name="l01480"></a>01480             <span class="comment">// handle datetime-related class, for grid editing</span>
<a name="l01481"></a>01481             <span class="keywordflow">if</span> (substr(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type, 0, 9) == <span class="stringliteral">&#39;timestamp&#39;</span> || <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type == <span class="stringliteral">&#39;datetime&#39;</span>) {
<a name="l01482"></a>01482                 $field_type_class = <span class="stringliteral">&#39;datetimefield&#39;</span>;
<a name="l01483"></a>01483             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type == <span class="stringliteral">&#39;date&#39;</span>) {
<a name="l01484"></a>01484                 $field_type_class = <span class="stringliteral">&#39;datefield&#39;</span>;
<a name="l01485"></a>01485             } <span class="keywordflow">else</span> {
<a name="l01486"></a>01486                 $field_type_class = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01487"></a>01487             }
<a name="l01488"></a>01488             $pointer = <a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>;
<a name="l01489"></a>01489             $is_field_truncated = <span class="keyword">false</span>;
<a name="l01490"></a>01490             <span class="comment">//If the previous column had blob data, we need to reset the class</span>
<a name="l01491"></a>01491             <span class="comment">// to $inline_edit_class</span>
<a name="l01492"></a>01492             <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> = <span class="stringliteral">&#39;data &#39;</span> . $grid_edit_class . <span class="charliteral">&#39; &#39;</span> . $not_null_class . <span class="charliteral">&#39; &#39;</span> . $relation_class . <span class="charliteral">&#39; &#39;</span> . $hide_class . <span class="charliteral">&#39; &#39;</span> . $field_type_class; <span class="comment">//&#39; &#39; . $alternating_color_class .</span>
<a name="l01493"></a>01493 
<a name="l01494"></a>01494             <span class="comment">//  See if this column should get highlight because it&#39;s used in the</span>
<a name="l01495"></a>01495             <span class="comment">//  where-query.</span>
<a name="l01496"></a>01496             <span class="keywordflow">if</span> (isset($highlight_columns) &amp;&amp; (isset($highlight_columns[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name]) || isset($highlight_columns[<a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name)]))) {
<a name="l01497"></a>01497                 $condition_field = <span class="keyword">true</span>;
<a name="l01498"></a>01498             } <span class="keywordflow">else</span> {
<a name="l01499"></a>01499                 $condition_field = <span class="keyword">false</span>;
<a name="l01500"></a>01500             }
<a name="l01501"></a>01501 
<a name="l01502"></a>01502             <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;vertical&#39;</span> &amp;&amp; (! isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>]) || (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>] != <span class="charliteral">&#39;1&#39;</span>))) {
<a name="l01503"></a>01503                 <span class="comment">// the row number corresponds to a data row, not HTML table row</span>
<a name="l01504"></a>01504                 <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> .= <span class="stringliteral">&#39; row_&#39;</span> . $row_no;
<a name="l01505"></a>01505                 <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;BrowsePointerEnable&#39;</span>] == <span class="keyword">true</span>) {
<a name="l01506"></a>01506                     <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> .= <span class="stringliteral">&#39; vpointer&#39;</span>;
<a name="l01507"></a>01507                 }
<a name="l01508"></a>01508                 <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;BrowseMarkerEnable&#39;</span>] == <span class="keyword">true</span>) {
<a name="l01509"></a>01509                     <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> .= <span class="stringliteral">&#39; vmarker&#39;</span>;
<a name="l01510"></a>01510                 }
<a name="l01511"></a>01511             }<span class="comment">// end if</span>
<a name="l01512"></a>01512 
<a name="l01513"></a>01513             <span class="comment">// Wrap MIME-transformations. [MIME]</span>
<a name="l01514"></a>01514             $default_function = <span class="stringliteral">&#39;default_function&#39;</span>; <span class="comment">// default_function</span>
<a name="l01515"></a>01515             $transform_function = $default_function;
<a name="l01516"></a>01516             $transform_options = array();
<a name="l01517"></a>01517 
<a name="l01518"></a>01518             <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfgRelation&#39;</span>][<span class="stringliteral">&#39;mimework&#39;</span>] &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;BrowseMIME&#39;</span>]) {
<a name="l01519"></a>01519 
<a name="l01520"></a>01520                 <span class="keywordflow">if</span> (isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;mime_map&#39;</span>][<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][<span class="stringliteral">&#39;mimetype&#39;</span>]) &amp;&amp; isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;mime_map&#39;</span>][<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][<span class="stringliteral">&#39;transformation&#39;</span>]) &amp;&amp; !empty(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;mime_map&#39;</span>][<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][<span class="stringliteral">&#39;transformation&#39;</span>])) {
<a name="l01521"></a>01521                     $include_file = <a class="code" href="core_8lib_8php.html#aca40f985a4bb31c341e876417106c644" title="Removes insecure parts in a path; used before include() or require() when a part of the path comes fr...">PMA_securePath</a>(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;mime_map&#39;</span>][<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][<span class="stringliteral">&#39;transformation&#39;</span>]);
<a name="l01522"></a>01522 
<a name="l01523"></a>01523                     <span class="keywordflow">if</span> (file_exists(<span class="stringliteral">&#39;./libraries/transformations/&#39;</span> . $include_file)) {
<a name="l01524"></a>01524                         $transformfunction_name = str_replace(<span class="stringliteral">&#39;.inc.php&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;mime_map&#39;</span>][<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][<span class="stringliteral">&#39;transformation&#39;</span>]);
<a name="l01525"></a>01525 
<a name="l01526"></a>01526                         include_once <span class="stringliteral">&#39;./libraries/transformations/&#39;</span> . $include_file;
<a name="l01527"></a>01527 
<a name="l01528"></a>01528                         <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;PMA_transformation_&#39;</span> . $transformfunction_name)) {
<a name="l01529"></a>01529                             $transform_function = <span class="stringliteral">&#39;PMA_transformation_&#39;</span> . $transformfunction_name;
<a name="l01530"></a>01530                             $transform_options  = <a class="code" href="transformations_8lib_8php.html#aa92960242784e530244b332a8a0f6480" title="returns array of options from string with options separated by comma, removes quotes">PMA_transformation_getOptions</a>((isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;mime_map&#39;</span>][<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][<span class="stringliteral">&#39;transformation_options&#39;</span>]) ? <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;mime_map&#39;</span>][<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][<span class="stringliteral">&#39;transformation_options&#39;</span>] : <span class="stringliteral">&#39;&#39;</span>));
<a name="l01531"></a>01531                             <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;mimetype     = str_replace(<span class="charliteral">&#39;_&#39;</span>, <span class="charliteral">&#39;/&#39;</span>, $GLOBALS[<span class="stringliteral">&#39;mime_map&#39;</span>][<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][<span class="stringliteral">&#39;mimetype&#39;</span>]);
<a name="l01532"></a>01532                         }
<a name="l01533"></a>01533                     } <span class="comment">// end if file_exists</span>
<a name="l01534"></a>01534                 } <span class="comment">// end if transformation is set</span>
<a name="l01535"></a>01535             } <span class="comment">// end if mime/transformation works.</span>
<a name="l01536"></a>01536 
<a name="l01537"></a>01537             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l01538"></a>01538                 <span class="stringliteral">&#39;db&#39;</span>            =&gt; $db,
<a name="l01539"></a>01539                 <span class="stringliteral">&#39;table&#39;</span>         =&gt; $table,
<a name="l01540"></a>01540                 <span class="stringliteral">&#39;where_clause&#39;</span>  =&gt; $where_clause,
<a name="l01541"></a>01541                 <span class="stringliteral">&#39;transform_key&#39;</span> =&gt; <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name,
<a name="l01542"></a>01542             );
<a name="l01543"></a>01543 
<a name="l01544"></a>01544             <span class="keywordflow">if</span> (! empty($sql_query)) {
<a name="l01545"></a>01545                 <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;sql_query&#39;</span>] = $url_sql_query;
<a name="l01546"></a>01546             }
<a name="l01547"></a>01547 
<a name="l01548"></a>01548             $transform_options[<span class="stringliteral">&#39;wrapper_link&#39;</span>] = <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l01549"></a>01549 
<a name="l01550"></a>01550             <span class="comment">// n u m e r i c</span>
<a name="l01551"></a>01551             <span class="keywordflow">if</span> (<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;numeric == 1) {
<a name="l01552"></a>01552 
<a name="l01553"></a>01553                 <span class="comment">// if two fields have the same name (this is possible</span>
<a name="l01554"></a>01554                 <span class="comment">//       with self-join queries, for example), using $meta-&gt;name</span>
<a name="l01555"></a>01555                 <span class="comment">//       will show both fields NULL even if only one is NULL,</span>
<a name="l01556"></a>01556                 <span class="comment">//       so use the $pointer</span>
<a name="l01557"></a>01557 
<a name="l01558"></a>01558                 <span class="keywordflow">if</span> (! isset($row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]) || is_null($row[$i])) {
<a name="l01559"></a>01559                     $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     =  <a class="code" href="display__tbl_8lib_8php.html#a2c7c156612516853ee09e323a5642c0e" title="Prepares the display for a null value.">PMA_buildNullDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, <span class="stringliteral">&#39;align=&quot;right&quot;&#39;</span>);
<a name="l01560"></a>01560                 } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ($row[$i] != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l01561"></a>01561 
<a name="l01562"></a>01562                     $nowrap = <span class="stringliteral">&#39; nowrap&#39;</span>;
<a name="l01563"></a>01563                     $where_comparison = <span class="stringliteral">&#39; = &#39;</span> . $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>];
<a name="l01564"></a>01564 
<a name="l01565"></a>01565                     $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     = <span class="stringliteral">&#39;&lt;td align=&quot;right&quot;&#39;</span> . <a class="code" href="display__tbl_8lib_8php.html#a6ed2d818c168866b38b4b2486ddf66fd" title="Prepares the displayable content of a data cell in Browse mode, taking into account foreign key descr...">PMA_prepare_row_data</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $map, $row[$i], $transform_function, $default_function, $nowrap, $where_comparison, $transform_options, $is_field_truncated);
<a name="l01566"></a>01566                 } <span class="keywordflow">else</span> {
<a name="l01567"></a>01567                     $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     = <a class="code" href="display__tbl_8lib_8php.html#a30685d4fa17670dc2fd8cc11b12cac81" title="Prepares the display for an empty value.">PMA_buildEmptyDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, <span class="stringliteral">&#39;align=&quot;right&quot;&#39;</span>);
<a name="l01568"></a>01568                 }
<a name="l01569"></a>01569 
<a name="l01570"></a>01570             <span class="comment">//  b l o b</span>
<a name="l01571"></a>01571 
<a name="l01572"></a>01572             } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (stristr(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type, <span class="stringliteral">&#39;BLOB&#39;</span>)) {
<a name="l01573"></a>01573                 <span class="comment">// PMA_mysql_fetch_fields returns BLOB in place of</span>
<a name="l01574"></a>01574                 <span class="comment">// TEXT fields type so we have to ensure it&#39;s really a BLOB</span>
<a name="l01575"></a>01575                 $field_flags = <a class="code" href="drizzle_8dbi_8lib_8php.html#a182b2c5eafadd7a9aa5649b680251e8b" title="returns concatenated string of human readable field flags">PMA_DBI_field_flags</a>($dt_result, <a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>);
<a name="l01576"></a>01576 
<a name="l01577"></a>01577                 <span class="keywordflow">if</span> (stristr($field_flags, <span class="stringliteral">&#39;BINARY&#39;</span>)) {
<a name="l01578"></a>01578                     <span class="comment">// remove &#39;grid_edit&#39; from $class as we can&#39;t edit binary data.</span>
<a name="l01579"></a>01579                     <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> = str_replace(<span class="stringliteral">&#39;grid_edit&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>);
<a name="l01580"></a>01580 
<a name="l01581"></a>01581                     <span class="keywordflow">if</span> (! isset($row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]) || is_null($row[$i])) {
<a name="l01582"></a>01582                         $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     =  <a class="code" href="display__tbl_8lib_8php.html#a2c7c156612516853ee09e323a5642c0e" title="Prepares the display for a null value.">PMA_buildNullDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l01583"></a>01583                     } <span class="keywordflow">else</span> {
<a name="l01584"></a>01584                         <span class="comment">// for blobstreaming</span>
<a name="l01585"></a>01585                         <span class="comment">// if valid BS reference exists</span>
<a name="l01586"></a>01586                         <span class="keywordflow">if</span> (<a class="code" href="blobstreaming_8lib_8php.html#a273956962a60db84a31283ba7991c044" title="Checks whether the BLOB reference looks valid.">PMA_BS_IsPBMSReference</a>($row[$i], $db)) {
<a name="l01587"></a>01587                             $blobtext = <a class="code" href="blobstreaming_8lib_8php.html#a87b824dda195c745386060c163ee0bd7">PMA_BS_CreateReferenceLink</a>($row[$i], $db);
<a name="l01588"></a>01588                         } <span class="keywordflow">else</span> {
<a name="l01589"></a>01589                             $blobtext = <a class="code" href="display__tbl_8lib_8php.html#adc2b985ffe56063359ca5c9b996518f9" title="Verifies what to do with non-printable contents (binary or BLOB) in Browse mode.">PMA_handle_non_printable_contents</a>(<span class="stringliteral">&#39;BLOB&#39;</span>, (isset($row[$i]) ? $row[$i] : <span class="stringliteral">&#39;&#39;</span>), $transform_function, $transform_options, $default_function, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l01590"></a>01590                         }
<a name="l01591"></a>01591 
<a name="l01592"></a>01592                         $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     =  <a class="code" href="display__tbl_8lib_8php.html#a16bfe926b3c308980b78111fe42b488a" title="Prepares the display for a value.">PMA_buildValueDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, $blobtext);
<a name="l01593"></a>01593                         unset($blobtext);
<a name="l01594"></a>01594                     }
<a name="l01595"></a>01595                 <span class="comment">// not binary:</span>
<a name="l01596"></a>01596                 } <span class="keywordflow">else</span> {
<a name="l01597"></a>01597                     <span class="keywordflow">if</span> (! isset($row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]) || is_null($row[$i])) {
<a name="l01598"></a>01598                         $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     =  <a class="code" href="display__tbl_8lib_8php.html#a2c7c156612516853ee09e323a5642c0e" title="Prepares the display for a null value.">PMA_buildNullDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l01599"></a>01599                     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ($row[$i] != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l01600"></a>01600                         <span class="comment">// if a transform function for blob is set, none of these replacements will be made</span>
<a name="l01601"></a>01601                         <span class="keywordflow">if</span> (<a class="code" href="string__mb_8lib_8php.html#a7d2b5c0ddb1f11882d037a29bf551ec0" title="Returns length of string depending on current charset.">PMA_strlen</a>($row[$i]) &gt; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>] &amp;&amp; $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_text&#39;</span>] == <span class="charliteral">&#39;P&#39;</span>) {
<a name="l01602"></a>01602                             $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = <a class="code" href="string__mb_8lib_8php.html#ac742da44a91af2e36669e907b59225d9" title="Returns substring from string, works depending on current charset.">PMA_substr</a>($row[$i], 0, <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>]) . <span class="stringliteral">&#39;...&#39;</span>;
<a name="l01603"></a>01603                             $is_field_truncated = <span class="keyword">true</span>;
<a name="l01604"></a>01604                         }
<a name="l01605"></a>01605                         <span class="comment">// displays all space characters, 4 space</span>
<a name="l01606"></a>01606                         <span class="comment">// characters for tabulations and &lt;cr&gt;/&lt;lf&gt;</span>
<a name="l01607"></a>01607                         $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     = ($default_function != $transform_function ? $transform_function($row[$i], $transform_options, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>) : $default_function($row[$i], array(), <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>));
<a name="l01608"></a>01608 
<a name="l01609"></a>01609                         <span class="keywordflow">if</span> ($is_field_truncated) {
<a name="l01610"></a>01610                             <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> .= <span class="stringliteral">&#39; truncated&#39;</span>;
<a name="l01611"></a>01611                         }
<a name="l01612"></a>01612 
<a name="l01613"></a>01613                         $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     = <a class="code" href="display__tbl_8lib_8php.html#a16bfe926b3c308980b78111fe42b488a" title="Prepares the display for a value.">PMA_buildValueDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, $row[$i]);
<a name="l01614"></a>01614                     } <span class="keywordflow">else</span> {
<a name="l01615"></a>01615                         $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     = <a class="code" href="display__tbl_8lib_8php.html#a30685d4fa17670dc2fd8cc11b12cac81" title="Prepares the display for an empty value.">PMA_buildEmptyDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l01616"></a>01616                     }
<a name="l01617"></a>01617                 }
<a name="l01618"></a>01618             <span class="comment">// g e o m e t r y</span>
<a name="l01619"></a>01619             } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type == <span class="stringliteral">&#39;geometry&#39;</span>) {
<a name="l01620"></a>01620 
<a name="l01621"></a>01621                 <span class="comment">// Remove &#39;grid_edit&#39; from $class as we do not allow to inline-edit geometry data.</span>
<a name="l01622"></a>01622                 <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> = str_replace(<span class="stringliteral">&#39;grid_edit&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>);
<a name="l01623"></a>01623 
<a name="l01624"></a>01624                 <span class="keywordflow">if</span> (! isset($row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]) || is_null($row[$i])) {
<a name="l01625"></a>01625                     $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = <a class="code" href="display__tbl_8lib_8php.html#a2c7c156612516853ee09e323a5642c0e" title="Prepares the display for a null value.">PMA_buildNullDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l01626"></a>01626                 } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ($row[$i] != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l01627"></a>01627                     <span class="comment">// Display as [GEOMETRY - (size)]</span>
<a name="l01628"></a>01628                     <span class="keywordflow">if</span> (<span class="stringliteral">&#39;GEOM&#39;</span> == $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;geometry_display&#39;</span>]) {
<a name="l01629"></a>01629                         $geometry_text = <a class="code" href="display__tbl_8lib_8php.html#adc2b985ffe56063359ca5c9b996518f9" title="Verifies what to do with non-printable contents (binary or BLOB) in Browse mode.">PMA_handle_non_printable_contents</a>(
<a name="l01630"></a>01630                             <span class="stringliteral">&#39;GEOMETRY&#39;</span>, (isset($row[$i]) ? $row[$i] : <span class="stringliteral">&#39;&#39;</span>), $transform_function,
<a name="l01631"></a>01631                             $transform_options, $default_function, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>
<a name="l01632"></a>01632                         );
<a name="l01633"></a>01633                         $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = <a class="code" href="display__tbl_8lib_8php.html#a16bfe926b3c308980b78111fe42b488a" title="Prepares the display for a value.">PMA_buildValueDisplay</a>(
<a name="l01634"></a>01634                             <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, $geometry_text
<a name="l01635"></a>01635                         );
<a name="l01636"></a>01636 
<a name="l01637"></a>01637                     <span class="comment">// Display in Well Known Text(WKT) format.</span>
<a name="l01638"></a>01638                     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (<span class="stringliteral">&#39;WKT&#39;</span> == $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;geometry_display&#39;</span>]) {
<a name="l01639"></a>01639                         $where_comparison = <span class="stringliteral">&#39; = &#39;</span> . $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>];
<a name="l01640"></a>01640 
<a name="l01641"></a>01641                         <span class="comment">// Convert to WKT format</span>
<a name="l01642"></a>01642                         $wktval = <a class="code" href="common_8lib_8php.html#ac9e0806378a58d34ec2a748202ca910e" title="Converts GIS data to Well Known Text format.">PMA_asWKT</a>($row[$i]);
<a name="l01643"></a>01643 
<a name="l01644"></a>01644                         <span class="keywordflow">if</span> (<a class="code" href="string__mb_8lib_8php.html#a7d2b5c0ddb1f11882d037a29bf551ec0" title="Returns length of string depending on current charset.">PMA_strlen</a>($wktval) &gt; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>]
<a name="l01645"></a>01645                             &amp;&amp; $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_text&#39;</span>] == <span class="charliteral">&#39;P&#39;</span>
<a name="l01646"></a>01646                         ) {
<a name="l01647"></a>01647                             $wktval = <a class="code" href="string__mb_8lib_8php.html#ac742da44a91af2e36669e907b59225d9" title="Returns substring from string, works depending on current charset.">PMA_substr</a>($wktval, 0, <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>]) . <span class="stringliteral">&#39;...&#39;</span>;
<a name="l01648"></a>01648                             $is_field_truncated = <span class="keyword">true</span>;
<a name="l01649"></a>01649                         }
<a name="l01650"></a>01650 
<a name="l01651"></a>01651                         $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = <span class="stringliteral">&#39;&lt;td &#39;</span> . <a class="code" href="display__tbl_8lib_8php.html#a6ed2d818c168866b38b4b2486ddf66fd" title="Prepares the displayable content of a data cell in Browse mode, taking into account foreign key descr...">PMA_prepare_row_data</a>(
<a name="l01652"></a>01652                             <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $map, $wktval, $transform_function,
<a name="l01653"></a>01653                             $default_function, <span class="stringliteral">&#39;&#39;</span>, $where_comparison, $transform_options, $is_field_truncated
<a name="l01654"></a>01654                         );
<a name="l01655"></a>01655 
<a name="l01656"></a>01656                     <span class="comment">// Display in  Well Known Binary(WKB) format.</span>
<a name="l01657"></a>01657                     } <span class="keywordflow">else</span> {
<a name="l01658"></a>01658                         <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_binary&#39;</span>]) {
<a name="l01659"></a>01659                             $where_comparison = <span class="stringliteral">&#39; = &#39;</span> . $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>];
<a name="l01660"></a>01660 
<a name="l01661"></a>01661                             <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>]
<a name="l01662"></a>01662                                 &amp;&amp; <a class="code" href="common_8lib_8php.html#aa4a2b500f55803947416966fb8bd65c1" title="Verifies whether the value contains a non-printable character.">PMA_contains_nonprintable_ascii</a>($row[$i])
<a name="l01663"></a>01663                             ) {
<a name="l01664"></a>01664                                 $wkbval = <a class="code" href="string__mb_8lib_8php.html#ac742da44a91af2e36669e907b59225d9" title="Returns substring from string, works depending on current charset.">PMA_substr</a>(bin2hex($row[$i]), 8);
<a name="l01665"></a>01665                             } <span class="keywordflow">else</span> {
<a name="l01666"></a>01666                                 $wkbval = htmlspecialchars(<a class="code" href="common_8lib_8php.html#ab1f3cd4bfc6d70701658e5e08bb89281" title="Replaces some characters by a displayable equivalent.">PMA_replace_binary_contents</a>($row[$i]));
<a name="l01667"></a>01667                             }
<a name="l01668"></a>01668 
<a name="l01669"></a>01669                             <span class="keywordflow">if</span> (<a class="code" href="string__mb_8lib_8php.html#a7d2b5c0ddb1f11882d037a29bf551ec0" title="Returns length of string depending on current charset.">PMA_strlen</a>($wkbval) &gt; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>]
<a name="l01670"></a>01670                                 &amp;&amp; $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_text&#39;</span>] == <span class="charliteral">&#39;P&#39;</span>
<a name="l01671"></a>01671                             ) {
<a name="l01672"></a>01672                                 $wkbval = <a class="code" href="string__mb_8lib_8php.html#ac742da44a91af2e36669e907b59225d9" title="Returns substring from string, works depending on current charset.">PMA_substr</a>($wkbval, 0, <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>]) . <span class="stringliteral">&#39;...&#39;</span>;
<a name="l01673"></a>01673                                 $is_field_truncated = <span class="keyword">true</span>;
<a name="l01674"></a>01674                             }
<a name="l01675"></a>01675 
<a name="l01676"></a>01676                             $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = <span class="stringliteral">&#39;&lt;td &#39;</span> . <a class="code" href="display__tbl_8lib_8php.html#a6ed2d818c168866b38b4b2486ddf66fd" title="Prepares the displayable content of a data cell in Browse mode, taking into account foreign key descr...">PMA_prepare_row_data</a>(
<a name="l01677"></a>01677                                 <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $map, $wkbval, $transform_function,
<a name="l01678"></a>01678                                 $default_function, <span class="stringliteral">&#39;&#39;</span>, $where_comparison, $transform_options, $is_field_truncated
<a name="l01679"></a>01679                             );
<a name="l01680"></a>01680                         } <span class="keywordflow">else</span> {
<a name="l01681"></a>01681                             $wkbval = <a class="code" href="display__tbl_8lib_8php.html#adc2b985ffe56063359ca5c9b996518f9" title="Verifies what to do with non-printable contents (binary or BLOB) in Browse mode.">PMA_handle_non_printable_contents</a>(
<a name="l01682"></a>01682                                 <span class="stringliteral">&#39;BINARY&#39;</span>, $row[$i], $transform_function, $transform_options, $default_function, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>
<a name="l01683"></a>01683                             );
<a name="l01684"></a>01684                             $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = <a class="code" href="display__tbl_8lib_8php.html#a16bfe926b3c308980b78111fe42b488a" title="Prepares the display for a value.">PMA_buildValueDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, $wkbval);
<a name="l01685"></a>01685                         }
<a name="l01686"></a>01686                     }
<a name="l01687"></a>01687                 } <span class="keywordflow">else</span> {
<a name="l01688"></a>01688                     $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = <a class="code" href="display__tbl_8lib_8php.html#a30685d4fa17670dc2fd8cc11b12cac81" title="Prepares the display for an empty value.">PMA_buildEmptyDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l01689"></a>01689                 }
<a name="l01690"></a>01690 
<a name="l01691"></a>01691             <span class="comment">// n o t   n u m e r i c   a n d   n o t   B L O B</span>
<a name="l01692"></a>01692             } <span class="keywordflow">else</span> {
<a name="l01693"></a>01693                 <span class="keywordflow">if</span> (! isset($row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]) || is_null($row[$i])) {
<a name="l01694"></a>01694                     $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     =  <a class="code" href="display__tbl_8lib_8php.html#a2c7c156612516853ee09e323a5642c0e" title="Prepares the display for a null value.">PMA_buildNullDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l01695"></a>01695                 } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ($row[$i] != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l01696"></a>01696                     <span class="comment">// support blanks in the key</span>
<a name="l01697"></a>01697                     $relation_id = $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>];
<a name="l01698"></a>01698 
<a name="l01699"></a>01699                     <span class="comment">// Cut all fields to $GLOBALS[&#39;cfg&#39;][&#39;LimitChars&#39;]</span>
<a name="l01700"></a>01700                     <span class="comment">// (unless it&#39;s a link-type transformation)</span>
<a name="l01701"></a>01701                     <span class="keywordflow">if</span> (<a class="code" href="string__mb_8lib_8php.html#a7d2b5c0ddb1f11882d037a29bf551ec0" title="Returns length of string depending on current charset.">PMA_strlen</a>($row[$i]) &gt; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>] &amp;&amp; $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_text&#39;</span>] == <span class="charliteral">&#39;P&#39;</span> &amp;&amp; !strpos($transform_function, <span class="stringliteral">&#39;link&#39;</span>) === <span class="keyword">true</span>) {
<a name="l01702"></a>01702                         $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = <a class="code" href="string__mb_8lib_8php.html#ac742da44a91af2e36669e907b59225d9" title="Returns substring from string, works depending on current charset.">PMA_substr</a>($row[$i], 0, <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>]) . <span class="stringliteral">&#39;...&#39;</span>;
<a name="l01703"></a>01703                         $is_field_truncated = <span class="keyword">true</span>;
<a name="l01704"></a>01704                     }
<a name="l01705"></a>01705 
<a name="l01706"></a>01706                     <span class="comment">// displays special characters from binaries</span>
<a name="l01707"></a>01707                     $field_flags = <a class="code" href="drizzle_8dbi_8lib_8php.html#a182b2c5eafadd7a9aa5649b680251e8b" title="returns concatenated string of human readable field flags">PMA_DBI_field_flags</a>($dt_result, $i);
<a name="l01708"></a>01708                     $formatted = <span class="keyword">false</span>;
<a name="l01709"></a>01709                     <span class="keywordflow">if</span> (isset(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;_type) &amp;&amp; <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;_type === MYSQLI_TYPE_BIT) {
<a name="l01710"></a>01710                         $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     = <a class="code" href="common_8lib_8php.html#ab8e797ab037f8c1d0eaa87c885bff719" title="Converts a bit value to printable format; in MySQL a BIT field can be from 1 to 64 bits so we need th...">PMA_printable_bit_value</a>($row[$i], <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;length);
<a name="l01711"></a>01711                         <span class="comment">// some results of PROCEDURE ANALYSE() are reported as</span>
<a name="l01712"></a>01712                         <span class="comment">// being BINARY but they are quite readable,</span>
<a name="l01713"></a>01713                         <span class="comment">// so don&#39;t treat them as BINARY</span>
<a name="l01714"></a>01714                     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (stristr($field_flags, <span class="stringliteral">&#39;BINARY&#39;</span>) &amp;&amp; <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type == <span class="stringliteral">&#39;string&#39;</span> &amp;&amp; !(isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;is_analyse&#39;</span>]) &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;is_analyse&#39;</span>])) {
<a name="l01715"></a>01715                         <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_binary&#39;</span>]) {
<a name="l01716"></a>01716                             <span class="comment">// user asked to see the real contents of BINARY</span>
<a name="l01717"></a>01717                             <span class="comment">// fields</span>
<a name="l01718"></a>01718                             <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>] &amp;&amp; <a class="code" href="common_8lib_8php.html#aa4a2b500f55803947416966fb8bd65c1" title="Verifies whether the value contains a non-printable character.">PMA_contains_nonprintable_ascii</a>($row[$i])) {
<a name="l01719"></a>01719                                 $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = bin2hex($row[$i]);
<a name="l01720"></a>01720                             } <span class="keywordflow">else</span> {
<a name="l01721"></a>01721                                 $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = htmlspecialchars(<a class="code" href="common_8lib_8php.html#ab1f3cd4bfc6d70701658e5e08bb89281" title="Replaces some characters by a displayable equivalent.">PMA_replace_binary_contents</a>($row[$i]));
<a name="l01722"></a>01722                             }
<a name="l01723"></a>01723                         } <span class="keywordflow">else</span> {
<a name="l01724"></a>01724                             <span class="comment">// we show the BINARY message and field&#39;s size</span>
<a name="l01725"></a>01725                             <span class="comment">// (or maybe use a transformation)</span>
<a name="l01726"></a>01726                             $row[<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>] = <a class="code" href="display__tbl_8lib_8php.html#adc2b985ffe56063359ca5c9b996518f9" title="Verifies what to do with non-printable contents (binary or BLOB) in Browse mode.">PMA_handle_non_printable_contents</a>(<span class="stringliteral">&#39;BINARY&#39;</span>, $row[$i], $transform_function, $transform_options, $default_function, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l01727"></a>01727                             $formatted = <span class="keyword">true</span>;
<a name="l01728"></a>01728                         }
<a name="l01729"></a>01729                     }
<a name="l01730"></a>01730 
<a name="l01731"></a>01731                     <span class="keywordflow">if</span> ($formatted) {
<a name="l01732"></a>01732                         $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     = <a class="code" href="display__tbl_8lib_8php.html#a16bfe926b3c308980b78111fe42b488a" title="Prepares the display for a value.">PMA_buildValueDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, $row[$i]);
<a name="l01733"></a>01733                     } <span class="keywordflow">else</span> {
<a name="l01734"></a>01734                         <span class="comment">// transform functions may enable no-wrapping:</span>
<a name="l01735"></a>01735                         $function_nowrap = $transform_function . <span class="stringliteral">&#39;_nowrap&#39;</span>;
<a name="l01736"></a>01736                         $bool_nowrap = (($default_function != $transform_function &amp;&amp; function_exists($function_nowrap)) ? $function_nowrap($transform_options) : <span class="keyword">false</span>);
<a name="l01737"></a>01737 
<a name="l01738"></a>01738                         <span class="comment">// do not wrap if date field type</span>
<a name="l01739"></a>01739                         $nowrap = ((preg_match(<span class="stringliteral">&#39;@DATE|TIME@i&#39;</span>, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type) || $bool_nowrap) ? <span class="stringliteral">&#39; nowrap&#39;</span> : <span class="stringliteral">&#39;&#39;</span>);
<a name="l01740"></a>01740                         $where_comparison = <span class="stringliteral">&#39; = \&#39;&#39;</span> . <a class="code" href="common_8lib_8php.html#a799062f79f401d1f20735d292d008eaf" title="Add slashes before &quot;&#39;&quot; and &quot;\&quot; characters so a value containing them can be used in a sql comparison...">PMA_sqlAddSlashes</a>($row[$i]) . <span class="charliteral">&#39;\&#39;&#39;</span>;
<a name="l01741"></a>01741                         $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     = <span class="stringliteral">&#39;&lt;td &#39;</span> . <a class="code" href="display__tbl_8lib_8php.html#a6ed2d818c168866b38b4b2486ddf66fd" title="Prepares the displayable content of a data cell in Browse mode, taking into account foreign key descr...">PMA_prepare_row_data</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $map, $row[$i], $transform_function, $default_function, $nowrap, $where_comparison, $transform_options, $is_field_truncated);
<a name="l01742"></a>01742                     }
<a name="l01743"></a>01743                 } <span class="keywordflow">else</span> {
<a name="l01744"></a>01744                     $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>]     = <a class="code" href="display__tbl_8lib_8php.html#a30685d4fa17670dc2fd8cc11b12cac81" title="Prepares the display for an empty value.">PMA_buildEmptyDisplay</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l01745"></a>01745                 }
<a name="l01746"></a>01746             }
<a name="l01747"></a>01747 
<a name="l01748"></a>01748             <span class="comment">// output stored cell</span>
<a name="l01749"></a>01749             <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01750"></a>01750                 || $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01751"></a>01751             ) {
<a name="l01752"></a>01752                 echo $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>];
<a name="l01753"></a>01753             }
<a name="l01754"></a>01754 
<a name="l01755"></a>01755             <span class="keywordflow">if</span> (isset($vertical_display[<span class="stringliteral">&#39;rowdata&#39;</span>][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>][$row_no])) {
<a name="l01756"></a>01756                 $vertical_display[<span class="stringliteral">&#39;rowdata&#39;</span>][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>][$row_no] .= $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>];
<a name="l01757"></a>01757             } <span class="keywordflow">else</span> {
<a name="l01758"></a>01758                 $vertical_display[<span class="stringliteral">&#39;rowdata&#39;</span>][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>][$row_no] = $vertical_display[<span class="stringliteral">&#39;data&#39;</span>][$row_no][<a class="code" href="config_8sample_8inc_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>];
<a name="l01759"></a>01759             }
<a name="l01760"></a>01760         } <span class="comment">// end for (2)</span>
<a name="l01761"></a>01761 
<a name="l01762"></a>01762         <span class="comment">// 3. Displays the modify/delete links on the right if required</span>
<a name="l01763"></a>01763         <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01764"></a>01764             &amp;&amp; ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01765"></a>01765             || $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>)
<a name="l01766"></a>01766         ) {
<a name="l01767"></a>01767             <span class="keywordflow">if</span> (! isset($js_conf)) {
<a name="l01768"></a>01768                 $js_conf = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01769"></a>01769             }
<a name="l01770"></a>01770             echo <a class="code" href="display__tbl_8lib_8php.html#aa2941a0e12aa16299a69a68c06c1ef12" title="Generates checkbox and links at some position (left or right) (only called for horizontal mode)...">PMA_generateCheckboxAndLinks</a>(<span class="stringliteral">&#39;right&#39;</span>, $del_url, $is_display, $row_no, $where_clause, $where_clause_html, $condition_array, $del_query, <span class="charliteral">&#39;r&#39;</span>, $edit_url, $copy_url, $edit_anchor_class, $edit_str, $copy_str, $del_str, $js_conf);
<a name="l01771"></a>01771         } <span class="comment">// end if (3)</span>
<a name="l01772"></a>01772 
<a name="l01773"></a>01773         <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span>
<a name="l01774"></a>01774             || $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>
<a name="l01775"></a>01775         ) {
<a name="l01776"></a>01776             ?&gt;
<a name="l01777"></a>01777 &lt;/tr&gt;
<a name="l01778"></a>01778             &lt;?php
<a name="l01779"></a>01779         } <span class="comment">// end if</span>
<a name="l01780"></a>01780 
<a name="l01781"></a>01781         <span class="comment">// 4. Gather links of del_urls and edit_urls in an array for later</span>
<a name="l01782"></a>01782         <span class="comment">//    output</span>
<a name="l01783"></a>01783         <span class="keywordflow">if</span> (! isset($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>][$row_no])) {
<a name="l01784"></a>01784             $vertical_display[<span class="stringliteral">&#39;edit&#39;</span>][$row_no]       = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01785"></a>01785             $vertical_display[<span class="stringliteral">&#39;copy&#39;</span>][$row_no]       = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01786"></a>01786             $vertical_display[<span class="stringliteral">&#39;delete&#39;</span>][$row_no]     = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01787"></a>01787             $vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>][$row_no] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01788"></a>01788         }
<a name="l01789"></a>01789         $vertical_class = <span class="stringliteral">&#39; row_&#39;</span> . $row_no;
<a name="l01790"></a>01790         <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;BrowsePointerEnable&#39;</span>] == <span class="keyword">true</span>) {
<a name="l01791"></a>01791             $vertical_class .= <span class="stringliteral">&#39; vpointer&#39;</span>;
<a name="l01792"></a>01792         }
<a name="l01793"></a>01793         <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;BrowseMarkerEnable&#39;</span>] == <span class="keyword">true</span>) {
<a name="l01794"></a>01794             $vertical_class .= <span class="stringliteral">&#39; vmarker&#39;</span>;
<a name="l01795"></a>01795         }
<a name="l01796"></a>01796 
<a name="l01797"></a>01797         <span class="keywordflow">if</span> (!empty($del_url) &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;kp&#39;</span>) {
<a name="l01798"></a>01798             $vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>][$row_no] .= <a class="code" href="display__tbl_8lib_8php.html#adbb911bbbf6db3506a49ad5989ee758e" title="Generates a checkbox for multi-row submits.">PMA_generateCheckboxForMulti</a>($del_url, $is_display, $row_no, $where_clause_html, $condition_array, $del_query, <span class="stringliteral">&#39;[%_PMA_CHECKBOX_DIR_%]&#39;</span>, $alternating_color_class . $vertical_class);
<a name="l01799"></a>01799         } <span class="keywordflow">else</span> {
<a name="l01800"></a>01800             unset($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>][$row_no]);
<a name="l01801"></a>01801         }
<a name="l01802"></a>01802 
<a name="l01803"></a>01803         <span class="keywordflow">if</span> (isset($edit_url)) {
<a name="l01804"></a>01804             $vertical_display[<span class="stringliteral">&#39;edit&#39;</span>][$row_no]   .= <a class="code" href="display__tbl_8lib_8php.html#a190ba11500e9a695a3ca69237db6bfd5" title="Generates an Edit link.">PMA_generateEditLink</a>($edit_url, $alternating_color_class . <span class="charliteral">&#39; &#39;</span> . $edit_anchor_class . $vertical_class, $edit_str, $where_clause, $where_clause_html);
<a name="l01805"></a>01805         } <span class="keywordflow">else</span> {
<a name="l01806"></a>01806             unset($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>][$row_no]);
<a name="l01807"></a>01807         }
<a name="l01808"></a>01808 
<a name="l01809"></a>01809         <span class="keywordflow">if</span> (isset($copy_url)) {
<a name="l01810"></a>01810             $vertical_display[<span class="stringliteral">&#39;copy&#39;</span>][$row_no]   .= <a class="code" href="display__tbl_8lib_8php.html#adc1b5b053b31424721b0fd20834628dd" title="Generates an Copy link.">PMA_generateCopyLink</a>($copy_url, $copy_str, $where_clause, $where_clause_html, $alternating_color_class . $vertical_class);
<a name="l01811"></a>01811         } <span class="keywordflow">else</span> {
<a name="l01812"></a>01812             unset($vertical_display[<span class="stringliteral">&#39;copy&#39;</span>][$row_no]);
<a name="l01813"></a>01813         }
<a name="l01814"></a>01814 
<a name="l01815"></a>01815         <span class="keywordflow">if</span> (isset($del_url)) {
<a name="l01816"></a>01816             <span class="keywordflow">if</span> (! isset($js_conf)) {
<a name="l01817"></a>01817                 $js_conf = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01818"></a>01818             }
<a name="l01819"></a>01819             $vertical_display[<span class="stringliteral">&#39;delete&#39;</span>][$row_no] .= <a class="code" href="display__tbl_8lib_8php.html#af7694e01ef98776d596b3a5a86b4f028" title="Generates a Delete link.">PMA_generateDeleteLink</a>($del_url, $del_str, $js_conf, $alternating_color_class . $vertical_class);
<a name="l01820"></a>01820         } <span class="keywordflow">else</span> {
<a name="l01821"></a>01821             unset($vertical_display[<span class="stringliteral">&#39;delete&#39;</span>][$row_no]);
<a name="l01822"></a>01822         }
<a name="l01823"></a>01823 
<a name="l01824"></a>01824         echo (($_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontal&#39;</span> || $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;horizontalflipped&#39;</span>) ? <span class="stringliteral">&quot;\n&quot;</span> : <span class="stringliteral">&#39;&#39;</span>);
<a name="l01825"></a>01825         $row_no++;
<a name="l01826"></a>01826     } <span class="comment">// end while</span>
<a name="l01827"></a>01827 
<a name="l01828"></a>01828     <span class="comment">// this is needed by PMA_displayTable() to generate the proper param</span>
<a name="l01829"></a>01829     <span class="comment">// in the multi-edit and multi-delete form</span>
<a name="l01830"></a>01830     <span class="keywordflow">return</span> $clause_is_unique;
<a name="l01831"></a>01831 } <span class="comment">// end of the &#39;PMA_displayTableBody()&#39; function</span>
<a name="l01832"></a>01832 
<a name="l01833"></a>01833 <span class="comment"></span>
<a name="l01834"></a>01834 <span class="comment">/**</span>
<a name="l01835"></a>01835 <span class="comment"> * Do display the result table with the vertical direction mode.</span>
<a name="l01836"></a>01836 <span class="comment"> *</span>
<a name="l01837"></a>01837 <span class="comment"> * @return  boolean  always true</span>
<a name="l01838"></a>01838 <span class="comment"> *</span>
<a name="l01839"></a>01839 <span class="comment"> * @global  array    $vertical_display the information to display</span>
<a name="l01840"></a>01840 <span class="comment"> *</span>
<a name="l01841"></a>01841 <span class="comment"> * @access  private</span>
<a name="l01842"></a>01842 <span class="comment"> *</span>
<a name="l01843"></a>01843 <span class="comment"> * @see     PMA_displayTable()</span>
<a name="l01844"></a>01844 <span class="comment"> */</span>
<a name="l01845"></a><a class="code" href="display__tbl_8lib_8php.html#a7c50ce25e0eca03e1d4320f56e55c15d">01845</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a7c50ce25e0eca03e1d4320f56e55c15d" title="Do display the result table with the vertical direction mode.">PMA_displayVerticalTable</a>()
<a name="l01846"></a>01846 {
<a name="l01847"></a>01847     global $vertical_display;
<a name="l01848"></a>01848 
<a name="l01849"></a>01849     <span class="comment">// Displays &quot;multi row delete&quot; link at top if required</span>
<a name="l01850"></a>01850     <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] != <span class="stringliteral">&#39;right&#39;</span>
<a name="l01851"></a>01851         &amp;&amp; is_array($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>])
<a name="l01852"></a>01852         &amp;&amp; (count($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>]) &gt; 0 || !empty($vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>]))
<a name="l01853"></a>01853     ) {
<a name="l01854"></a>01854         echo <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01855"></a>01855         <span class="keywordflow">if</span> (<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;none&#39;</span>) {
<a name="l01856"></a>01856             <span class="comment">// if we are not showing the RowActionLinks, then we need to show the Multi-Row-Action checkboxes</span>
<a name="l01857"></a>01857             echo <span class="stringliteral">&#39;&lt;th&gt;&lt;/th&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01858"></a>01858         }
<a name="l01859"></a>01859         echo $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>];
<a name="l01860"></a>01860         $cell_displayed = 0;
<a name="l01861"></a>01861         <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>] as $val) {
<a name="l01862"></a>01862             <span class="keywordflow">if</span> (($cell_displayed != 0) &amp;&amp; (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>] != 0) &amp;&amp; !($cell_displayed % <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>])) {
<a name="l01863"></a>01863                 echo <span class="stringliteral">&#39;&lt;th&#39;</span> .
<a name="l01864"></a>01864                      (($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) ? <span class="stringliteral">&#39; rowspan=&quot;4&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) .
<a name="l01865"></a>01865                      <span class="stringliteral">&#39;&gt;&lt;/th&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01866"></a>01866             }
<a name="l01867"></a>01867             echo str_replace(<span class="stringliteral">&#39;[%_PMA_CHECKBOX_DIR_%]&#39;</span>, <span class="stringliteral">&#39;_left&#39;</span>, $val);
<a name="l01868"></a>01868             $cell_displayed++;
<a name="l01869"></a>01869         } <span class="comment">// end while</span>
<a name="l01870"></a>01870         echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01871"></a>01871     } <span class="comment">// end if</span>
<a name="l01872"></a>01872 
<a name="l01873"></a>01873     <span class="comment">// Displays &quot;edit&quot; link at top if required</span>
<a name="l01874"></a>01874     <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01875"></a>01875         &amp;&amp; is_array($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>])
<a name="l01876"></a>01876         &amp;&amp; (count($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>]) &gt; 0 || !empty($vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>]))
<a name="l01877"></a>01877     ) {
<a name="l01878"></a>01878         echo <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01879"></a>01879         <span class="keywordflow">if</span> (! is_array($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>])) {
<a name="l01880"></a>01880             echo $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>];
<a name="l01881"></a>01881         }
<a name="l01882"></a>01882         <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>] as $val) {
<a name="l01883"></a>01883             echo $val;
<a name="l01884"></a>01884         } <span class="comment">// end while</span>
<a name="l01885"></a>01885         echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01886"></a>01886     } <span class="comment">// end if</span>
<a name="l01887"></a>01887 
<a name="l01888"></a>01888     <span class="comment">// Displays &quot;copy&quot; link at top if required</span>
<a name="l01889"></a>01889     <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01890"></a>01890         &amp;&amp; is_array($vertical_display[<span class="stringliteral">&#39;copy&#39;</span>])
<a name="l01891"></a>01891         &amp;&amp; (count($vertical_display[<span class="stringliteral">&#39;copy&#39;</span>]) &gt; 0 || !empty($vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>]))
<a name="l01892"></a>01892     ) {
<a name="l01893"></a>01893         echo <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01894"></a>01894         <span class="keywordflow">if</span> (! is_array($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>])) {
<a name="l01895"></a>01895             echo $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>];
<a name="l01896"></a>01896         }
<a name="l01897"></a>01897         <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;copy&#39;</span>] as $val) {
<a name="l01898"></a>01898             echo $val;
<a name="l01899"></a>01899         } <span class="comment">// end while</span>
<a name="l01900"></a>01900         echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01901"></a>01901     } <span class="comment">// end if</span>
<a name="l01902"></a>01902 
<a name="l01903"></a>01903     <span class="comment">// Displays &quot;delete&quot; link at top if required</span>
<a name="l01904"></a>01904     <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01905"></a>01905         &amp;&amp; is_array($vertical_display[<span class="stringliteral">&#39;delete&#39;</span>])
<a name="l01906"></a>01906         &amp;&amp; (count($vertical_display[<span class="stringliteral">&#39;delete&#39;</span>]) &gt; 0 || !empty($vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>]))
<a name="l01907"></a>01907     ) {
<a name="l01908"></a>01908         echo <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01909"></a>01909         <span class="keywordflow">if</span> (! is_array($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>]) &amp;&amp; ! is_array($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>])) {
<a name="l01910"></a>01910             echo $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>];
<a name="l01911"></a>01911         }
<a name="l01912"></a>01912         <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;delete&#39;</span>] as $val) {
<a name="l01913"></a>01913             echo $val;
<a name="l01914"></a>01914         } <span class="comment">// end while</span>
<a name="l01915"></a>01915         echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01916"></a>01916     } <span class="comment">// end if</span>
<a name="l01917"></a>01917 
<a name="l01918"></a>01918     <span class="keywordflow">if</span> (<a class="code" href="display__tbl_8lib_8php.html#a6ebb093d6eba080e154ab70b63261772" title="Return true if we are executing a query in the form of &quot;SELECT * FROM &lt;a table&gt; ...&quot;.">PMA_isSelect</a>()) {
<a name="l01919"></a>01919         <span class="comment">// prepare to get the column order, if available</span>
<a name="l01920"></a>01920         $pmatable = <span class="keyword">new</span> <a class="code" href="classPMA__Table.html">PMA_Table</a>(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;table&#39;</span>], <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;db&#39;</span>]);
<a name="l01921"></a>01921         $col_order = $pmatable-&gt;getUiProp(<a class="code" href="classPMA__Table.html#a86b9ea13c062cd4eff72f5f3b723d310">PMA_Table::PROP_COLUMN_ORDER</a>);
<a name="l01922"></a>01922         $col_visib = $pmatable-&gt;getUiProp(<a class="code" href="classPMA__Table.html#ae74bd68753eeb8be8cf2cfe0272c8d1f">PMA_Table::PROP_COLUMN_VISIB</a>);
<a name="l01923"></a>01923     } <span class="keywordflow">else</span> {
<a name="l01924"></a>01924         $col_order = <span class="keyword">false</span>;
<a name="l01925"></a>01925         $col_visib = <span class="keyword">false</span>;
<a name="l01926"></a>01926     }
<a name="l01927"></a>01927 
<a name="l01928"></a>01928     <span class="comment">// Displays data</span>
<a name="l01929"></a>01929     <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;desc&#39;</span>] AS $j =&gt; $val) {
<a name="l01930"></a>01930         <span class="comment">// assign appropriate key with current column order</span>
<a name="l01931"></a>01931         $key = $col_order ? $col_order[$j] : $j;
<a name="l01932"></a>01932 
<a name="l01933"></a>01933         echo <span class="stringliteral">&#39;&lt;tr&#39;</span> . (($col_visib &amp;&amp; !$col_visib[$j]) ? <span class="stringliteral">&#39; class=&quot;hide&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . <span class="charliteral">&#39;&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01934"></a>01934         echo $val;
<a name="l01935"></a>01935 
<a name="l01936"></a>01936         $cell_displayed = 0;
<a name="l01937"></a>01937         <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;rowdata&#39;</span>][$key] as $subval) {
<a name="l01938"></a>01938             <span class="keywordflow">if</span> (($cell_displayed != 0) &amp;&amp; (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>] != 0) and !($cell_displayed % <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>])) {
<a name="l01939"></a>01939                 echo $val;
<a name="l01940"></a>01940             }
<a name="l01941"></a>01941 
<a name="l01942"></a>01942             echo $subval;
<a name="l01943"></a>01943             $cell_displayed++;
<a name="l01944"></a>01944         } <span class="comment">// end while</span>
<a name="l01945"></a>01945 
<a name="l01946"></a>01946         echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01947"></a>01947     } <span class="comment">// end while</span>
<a name="l01948"></a>01948 
<a name="l01949"></a>01949     <span class="comment">// Displays &quot;multi row delete&quot; link at bottom if required</span>
<a name="l01950"></a>01950     <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01951"></a>01951         &amp;&amp; is_array($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>])
<a name="l01952"></a>01952         &amp;&amp; (count($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>]) &gt; 0 || !empty($vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>]))
<a name="l01953"></a>01953     ) {
<a name="l01954"></a>01954         echo <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01955"></a>01955         echo $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>];
<a name="l01956"></a>01956         $cell_displayed = 0;
<a name="l01957"></a>01957         <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>] as $val) {
<a name="l01958"></a>01958             <span class="keywordflow">if</span> (($cell_displayed != 0) &amp;&amp; (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>] != 0) &amp;&amp; !($cell_displayed % <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>])) {
<a name="l01959"></a>01959                 echo <span class="stringliteral">&#39;&lt;th&#39;</span> .
<a name="l01960"></a>01960                      (($is_display[<span class="stringliteral">&#39;edit_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;nn&#39;</span>) ? <span class="stringliteral">&#39; rowspan=&quot;4&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) .
<a name="l01961"></a>01961                      <span class="stringliteral">&#39;&gt;&lt;/th&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01962"></a>01962             }
<a name="l01963"></a>01963 
<a name="l01964"></a>01964             echo str_replace(<span class="stringliteral">&#39;[%_PMA_CHECKBOX_DIR_%]&#39;</span>, <span class="stringliteral">&#39;_right&#39;</span>, $val);
<a name="l01965"></a>01965             $cell_displayed++;
<a name="l01966"></a>01966         } <span class="comment">// end while</span>
<a name="l01967"></a>01967         echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01968"></a>01968     } <span class="comment">// end if</span>
<a name="l01969"></a>01969 
<a name="l01970"></a>01970     <span class="comment">// Displays &quot;edit&quot; link at bottom if required</span>
<a name="l01971"></a>01971     <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01972"></a>01972         &amp;&amp; is_array($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>])
<a name="l01973"></a>01973         &amp;&amp; (count($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>]) &gt; 0 || !empty($vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>]))
<a name="l01974"></a>01974     ) {
<a name="l01975"></a>01975         echo <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01976"></a>01976         <span class="keywordflow">if</span> (! is_array($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>])) {
<a name="l01977"></a>01977             echo $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>];
<a name="l01978"></a>01978         }
<a name="l01979"></a>01979         <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>] as $val) {
<a name="l01980"></a>01980             echo $val;
<a name="l01981"></a>01981         } <span class="comment">// end while</span>
<a name="l01982"></a>01982         echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01983"></a>01983     } <span class="comment">// end if</span>
<a name="l01984"></a>01984 
<a name="l01985"></a>01985     <span class="comment">// Displays &quot;copy&quot; link at bottom if required</span>
<a name="l01986"></a>01986     <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l01987"></a>01987         &amp;&amp; is_array($vertical_display[<span class="stringliteral">&#39;copy&#39;</span>])
<a name="l01988"></a>01988         &amp;&amp; (count($vertical_display[<span class="stringliteral">&#39;copy&#39;</span>]) &gt; 0 || !empty($vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>]))
<a name="l01989"></a>01989     ) {
<a name="l01990"></a>01990         echo <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01991"></a>01991         <span class="keywordflow">if</span> (! is_array($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>])) {
<a name="l01992"></a>01992             echo $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>];
<a name="l01993"></a>01993         }
<a name="l01994"></a>01994         <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;copy&#39;</span>] as $val) {
<a name="l01995"></a>01995             echo $val;
<a name="l01996"></a>01996         } <span class="comment">// end while</span>
<a name="l01997"></a>01997         echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l01998"></a>01998     } <span class="comment">// end if</span>
<a name="l01999"></a>01999 
<a name="l02000"></a>02000     <span class="comment">// Displays &quot;delete&quot; link at bottom if required</span>
<a name="l02001"></a>02001     <span class="keywordflow">if</span> ((<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span> || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RowActionLinks&#39;</span>] == <span class="stringliteral">&#39;both&#39;</span>)
<a name="l02002"></a>02002         &amp;&amp; is_array($vertical_display[<span class="stringliteral">&#39;delete&#39;</span>])
<a name="l02003"></a>02003         &amp;&amp; (count($vertical_display[<span class="stringliteral">&#39;delete&#39;</span>]) &gt; 0 || !empty($vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>]))
<a name="l02004"></a>02004     ) {
<a name="l02005"></a>02005         echo <span class="stringliteral">&#39;&lt;tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02006"></a>02006         <span class="keywordflow">if</span> (! is_array($vertical_display[<span class="stringliteral">&#39;edit&#39;</span>]) &amp;&amp; ! is_array($vertical_display[<span class="stringliteral">&#39;row_delete&#39;</span>])) {
<a name="l02007"></a>02007             echo $vertical_display[<span class="stringliteral">&#39;textbtn&#39;</span>];
<a name="l02008"></a>02008         }
<a name="l02009"></a>02009         <span class="keywordflow">foreach</span> ($vertical_display[<span class="stringliteral">&#39;delete&#39;</span>] as $val) {
<a name="l02010"></a>02010             echo $val;
<a name="l02011"></a>02011         } <span class="comment">// end while</span>
<a name="l02012"></a>02012         echo <span class="stringliteral">&#39;&lt;/tr&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02013"></a>02013     }
<a name="l02014"></a>02014 
<a name="l02015"></a>02015     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02016"></a>02016 } <span class="comment">// end of the &#39;PMA_displayVerticalTable&#39; function</span>
<a name="l02017"></a>02017 <span class="comment"></span>
<a name="l02018"></a>02018 <span class="comment">/**</span>
<a name="l02019"></a>02019 <span class="comment"> * Checks the posted options for viewing query resutls</span>
<a name="l02020"></a>02020 <span class="comment"> * and sets appropriate values in the session.</span>
<a name="l02021"></a>02021 <span class="comment"> *</span>
<a name="l02022"></a>02022 <span class="comment"> * @todo    make maximum remembered queries configurable</span>
<a name="l02023"></a>02023 <span class="comment"> * @todo    move/split into SQL class!?</span>
<a name="l02024"></a>02024 <span class="comment"> * @todo    currently this is called twice unnecessary</span>
<a name="l02025"></a>02025 <span class="comment"> * @todo    ignore LIMIT and ORDER in query!?</span>
<a name="l02026"></a>02026 <span class="comment"> *</span>
<a name="l02027"></a>02027 <span class="comment"> * @return nothing</span>
<a name="l02028"></a>02028 <span class="comment"> */</span>
<a name="l02029"></a><a class="code" href="display__tbl_8lib_8php.html#a7b865266d030433cd3f2729dbd3d61ba">02029</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a7b865266d030433cd3f2729dbd3d61ba" title="Checks the posted options for viewing query resutls and sets appropriate values in the session...">PMA_displayTable_checkConfigParams</a>()
<a name="l02030"></a>02030 {
<a name="l02031"></a>02031     $sql_md5 = md5(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;sql_query&#39;</span>]);
<a name="l02032"></a>02032 
<a name="l02033"></a>02033     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;sql&#39;</span>] = <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;sql_query&#39;</span>];
<a name="l02034"></a>02034 
<a name="l02035"></a>02035     <span class="keywordflow">if</span> (<a class="code" href="core_8lib_8php.html#a1b8fd01cdfbdfaac35e692fcdaaad700" title="checks given $var against $type or $compare">PMA_isValid</a>(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;disp_direction&#39;</span>], array(<span class="stringliteral">&#39;horizontal&#39;</span>, <span class="stringliteral">&#39;vertical&#39;</span>, <span class="stringliteral">&#39;horizontalflipped&#39;</span>))) {
<a name="l02036"></a>02036         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;disp_direction&#39;</span>] = <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;disp_direction&#39;</span>];
<a name="l02037"></a>02037         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;disp_direction&#39;</span>]);
<a name="l02038"></a>02038     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;disp_direction&#39;</span>])) {
<a name="l02039"></a>02039         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;disp_direction&#39;</span>] = <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;DefaultDisplay&#39;</span>];
<a name="l02040"></a>02040     }
<a name="l02041"></a>02041 
<a name="l02042"></a>02042     <span class="keywordflow">if</span> (<a class="code" href="core_8lib_8php.html#a1b8fd01cdfbdfaac35e692fcdaaad700" title="checks given $var against $type or $compare">PMA_isValid</a>(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;repeat_cells&#39;</span>], <span class="stringliteral">&#39;numeric&#39;</span>)) {
<a name="l02043"></a>02043         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;repeat_cells&#39;</span>] = <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;repeat_cells&#39;</span>];
<a name="l02044"></a>02044         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;repeat_cells&#39;</span>]);
<a name="l02045"></a>02045     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;repeat_cells&#39;</span>])) {
<a name="l02046"></a>02046         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;repeat_cells&#39;</span>] = <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;RepeatCells&#39;</span>];
<a name="l02047"></a>02047     }
<a name="l02048"></a>02048 
<a name="l02049"></a>02049     <span class="comment">// as this is a form value, the type is always string so we cannot</span>
<a name="l02050"></a>02050     <span class="comment">// use PMA_isValid($_REQUEST[&#39;session_max_rows&#39;], &#39;integer&#39;)</span>
<a name="l02051"></a>02051     <span class="keywordflow">if</span> ((<a class="code" href="core_8lib_8php.html#a1b8fd01cdfbdfaac35e692fcdaaad700" title="checks given $var against $type or $compare">PMA_isValid</a>(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;session_max_rows&#39;</span>], <span class="stringliteral">&#39;numeric&#39;</span>)
<a name="l02052"></a>02052         &amp;&amp; (<span class="keywordtype">int</span>) <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;session_max_rows&#39;</span>] == <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;session_max_rows&#39;</span>])
<a name="l02053"></a>02053         || <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;session_max_rows&#39;</span>] == <span class="stringliteral">&#39;all&#39;</span>
<a name="l02054"></a>02054     ) {
<a name="l02055"></a>02055         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;max_rows&#39;</span>] = <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;session_max_rows&#39;</span>];
<a name="l02056"></a>02056         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;session_max_rows&#39;</span>]);
<a name="l02057"></a>02057     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;max_rows&#39;</span>])) {
<a name="l02058"></a>02058         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;max_rows&#39;</span>] = <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;MaxRows&#39;</span>];
<a name="l02059"></a>02059     }
<a name="l02060"></a>02060 
<a name="l02061"></a>02061     <span class="keywordflow">if</span> (<a class="code" href="core_8lib_8php.html#a1b8fd01cdfbdfaac35e692fcdaaad700" title="checks given $var against $type or $compare">PMA_isValid</a>(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;pos&#39;</span>], <span class="stringliteral">&#39;numeric&#39;</span>)) {
<a name="l02062"></a>02062         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;pos&#39;</span>] = <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;pos&#39;</span>];
<a name="l02063"></a>02063         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;pos&#39;</span>]);
<a name="l02064"></a>02064     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;pos&#39;</span>])) {
<a name="l02065"></a>02065         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;pos&#39;</span>] = 0;
<a name="l02066"></a>02066     }
<a name="l02067"></a>02067 
<a name="l02068"></a>02068     <span class="keywordflow">if</span> (<a class="code" href="core_8lib_8php.html#a1b8fd01cdfbdfaac35e692fcdaaad700" title="checks given $var against $type or $compare">PMA_isValid</a>(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_text&#39;</span>], array(<span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;F&#39;</span>))) {
<a name="l02069"></a>02069         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_text&#39;</span>] = <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_text&#39;</span>];
<a name="l02070"></a>02070         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_text&#39;</span>]);
<a name="l02071"></a>02071     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_text&#39;</span>])) {
<a name="l02072"></a>02072         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_text&#39;</span>] = <span class="charliteral">&#39;P&#39;</span>;
<a name="l02073"></a>02073     }
<a name="l02074"></a>02074 
<a name="l02075"></a>02075     <span class="keywordflow">if</span> (<a class="code" href="core_8lib_8php.html#a1b8fd01cdfbdfaac35e692fcdaaad700" title="checks given $var against $type or $compare">PMA_isValid</a>(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;relational_display&#39;</span>], array(<span class="charliteral">&#39;K&#39;</span>, <span class="charliteral">&#39;D&#39;</span>))) {
<a name="l02076"></a>02076         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;relational_display&#39;</span>] = <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;relational_display&#39;</span>];
<a name="l02077"></a>02077         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;relational_display&#39;</span>]);
<a name="l02078"></a>02078     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;relational_display&#39;</span>])) {
<a name="l02079"></a>02079         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;relational_display&#39;</span>] = <span class="charliteral">&#39;K&#39;</span>;
<a name="l02080"></a>02080     }
<a name="l02081"></a>02081 
<a name="l02082"></a>02082     <span class="keywordflow">if</span> (<a class="code" href="core_8lib_8php.html#a1b8fd01cdfbdfaac35e692fcdaaad700" title="checks given $var against $type or $compare">PMA_isValid</a>(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;geometry_display&#39;</span>], array(<span class="stringliteral">&#39;WKT&#39;</span>, <span class="stringliteral">&#39;WKB&#39;</span>, <span class="stringliteral">&#39;GEOM&#39;</span>))) {
<a name="l02083"></a>02083         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;geometry_display&#39;</span>] = <a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;geometry_display&#39;</span>];
<a name="l02084"></a>02084         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;geometry_display&#39;</span>]);
<a name="l02085"></a>02085     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (empty(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;geometry_display&#39;</span>])) {
<a name="l02086"></a>02086         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;geometry_display&#39;</span>] = <span class="stringliteral">&#39;GEOM&#39;</span>;
<a name="l02087"></a>02087     }
<a name="l02088"></a>02088 
<a name="l02089"></a>02089     <span class="keywordflow">if</span> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_binary&#39;</span>])) {
<a name="l02090"></a>02090         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_binary&#39;</span>] = <span class="keyword">true</span>;
<a name="l02091"></a>02091         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_binary&#39;</span>]);
<a name="l02092"></a>02092     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_options_form&#39;</span>])) {
<a name="l02093"></a>02093         <span class="comment">// we know that the checkbox was unchecked</span>
<a name="l02094"></a>02094         unset(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_binary&#39;</span>]);
<a name="l02095"></a>02095     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;full_text_button&#39;</span>])) {
<a name="l02096"></a>02096         <span class="comment">// do nothing to keep the value that is there in the session</span>
<a name="l02097"></a>02097     } <span class="keywordflow">else</span> {
<a name="l02098"></a>02098         <span class="comment">// selected by default because some operations like OPTIMIZE TABLE</span>
<a name="l02099"></a>02099         <span class="comment">// and all queries involving functions return &quot;binary&quot; contents,</span>
<a name="l02100"></a>02100         <span class="comment">// according to low-level field flags</span>
<a name="l02101"></a>02101         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_binary&#39;</span>] = <span class="keyword">true</span>;
<a name="l02102"></a>02102     }
<a name="l02103"></a>02103 
<a name="l02104"></a>02104     <span class="keywordflow">if</span> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>])) {
<a name="l02105"></a>02105         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>] = <span class="keyword">true</span>;
<a name="l02106"></a>02106         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>]);
<a name="l02107"></a>02107     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_options_form&#39;</span>])) {
<a name="l02108"></a>02108         <span class="comment">// we know that the checkbox was unchecked</span>
<a name="l02109"></a>02109         unset(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>]);
<a name="l02110"></a>02110     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;full_text_button&#39;</span>])) {
<a name="l02111"></a>02111         <span class="comment">// do nothing to keep the value that is there in the session</span>
<a name="l02112"></a>02112     } <span class="keywordflow">else</span> {
<a name="l02113"></a>02113         <span class="comment">// display_binary_as_hex config option</span>
<a name="l02114"></a>02114         <span class="keywordflow">if</span> (isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;DisplayBinaryAsHex&#39;</span>]) &amp;&amp; <span class="keyword">true</span> === <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;DisplayBinaryAsHex&#39;</span>]) {
<a name="l02115"></a>02115             <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>] = <span class="keyword">true</span>;
<a name="l02116"></a>02116         }
<a name="l02117"></a>02117     }
<a name="l02118"></a>02118 
<a name="l02119"></a>02119     <span class="keywordflow">if</span> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_blob&#39;</span>])) {
<a name="l02120"></a>02120         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_blob&#39;</span>] = <span class="keyword">true</span>;
<a name="l02121"></a>02121         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_blob&#39;</span>]);
<a name="l02122"></a>02122     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_options_form&#39;</span>])) {
<a name="l02123"></a>02123         <span class="comment">// we know that the checkbox was unchecked</span>
<a name="l02124"></a>02124         unset(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_blob&#39;</span>]);
<a name="l02125"></a>02125     }
<a name="l02126"></a>02126 
<a name="l02127"></a>02127     <span class="keywordflow">if</span> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;hide_transformation&#39;</span>])) {
<a name="l02128"></a>02128         <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;hide_transformation&#39;</span>] = <span class="keyword">true</span>;
<a name="l02129"></a>02129         unset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;hide_transformation&#39;</span>]);
<a name="l02130"></a>02130     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (isset(<a class="code" href="libraries_2common_8inc_8php.html#a1697cbb709132a827a24cf16714b73ab" title="avoid problems in phpmyadmin.css.php in some cases  string $js_frame">$_REQUEST</a>[<span class="stringliteral">&#39;display_options_form&#39;</span>])) {
<a name="l02131"></a>02131         <span class="comment">// we know that the checkbox was unchecked</span>
<a name="l02132"></a>02132         unset(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;hide_transformation&#39;</span>]);
<a name="l02133"></a>02133     }
<a name="l02134"></a>02134 
<a name="l02135"></a>02135     <span class="comment">// move current query to the last position, to be removed last</span>
<a name="l02136"></a>02136     <span class="comment">// so only least executed query will be removed if maximum remembered queries</span>
<a name="l02137"></a>02137     <span class="comment">// limit is reached</span>
<a name="l02138"></a>02138     $tmp = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5];
<a name="l02139"></a>02139     unset(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5]);
<a name="l02140"></a>02140     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5] = $tmp;
<a name="l02141"></a>02141 
<a name="l02142"></a>02142     <span class="comment">// do not exceed a maximum number of queries to remember</span>
<a name="l02143"></a>02143     <span class="keywordflow">if</span> (count(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>]) &gt; 10) {
<a name="l02144"></a>02144         array_shift(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>]);
<a name="l02145"></a>02145         <span class="comment">//echo &#39;deleting one element ...&#39;;</span>
<a name="l02146"></a>02146     }
<a name="l02147"></a>02147 
<a name="l02148"></a>02148     <span class="comment">// populate query configuration</span>
<a name="l02149"></a>02149     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_text&#39;</span>] = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_text&#39;</span>];
<a name="l02150"></a>02150     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;relational_display&#39;</span>] = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;relational_display&#39;</span>];
<a name="l02151"></a>02151     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;geometry_display&#39;</span>] = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;geometry_display&#39;</span>];
<a name="l02152"></a>02152     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_binary&#39;</span>] = isset(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_binary&#39;</span>]) ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l02153"></a>02153     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>] = isset(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_binary_as_hex&#39;</span>]) ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l02154"></a>02154     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_blob&#39;</span>] = isset(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;display_blob&#39;</span>]) ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l02155"></a>02155     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;hide_transformation&#39;</span>] = isset(<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;hide_transformation&#39;</span>]) ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l02156"></a>02156     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;pos&#39;</span>] = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;pos&#39;</span>];
<a name="l02157"></a>02157     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>] = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;max_rows&#39;</span>];
<a name="l02158"></a>02158     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;repeat_cells&#39;</span>] = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;repeat_cells&#39;</span>];
<a name="l02159"></a>02159     <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;query&#39;</span>][$sql_md5][<span class="stringliteral">&#39;disp_direction&#39;</span>];
<a name="l02160"></a>02160 
<a name="l02161"></a>02161     <span class="comment">/*</span>
<a name="l02162"></a>02162 <span class="comment">     * debugging</span>
<a name="l02163"></a>02163 <span class="comment">    echo &#39;&lt;pre&gt;&#39;;</span>
<a name="l02164"></a>02164 <span class="comment">    var_dump($_SESSION[&#39;tmp_user_values&#39;]);</span>
<a name="l02165"></a>02165 <span class="comment">    echo &#39;&lt;/pre&gt;&#39;;</span>
<a name="l02166"></a>02166 <span class="comment">     */</span>
<a name="l02167"></a>02167 }
<a name="l02168"></a>02168 <span class="comment"></span>
<a name="l02169"></a>02169 <span class="comment">/**</span>
<a name="l02170"></a>02170 <span class="comment"> * Displays a table of results returned by a SQL query.</span>
<a name="l02171"></a>02171 <span class="comment"> * This function is called by the &quot;sql.php&quot; script.</span>
<a name="l02172"></a>02172 <span class="comment"> *</span>
<a name="l02173"></a>02173 <span class="comment"> * @param integer &amp;$dt_result     the link id associated to the query which results have</span>
<a name="l02174"></a>02174 <span class="comment"> *                                to be displayed</span>
<a name="l02175"></a>02175 <span class="comment"> * @param array   &amp;$the_disp_mode the display mode</span>
<a name="l02176"></a>02176 <span class="comment"> * @param array   $analyzed_sql   the analyzed query</span>
<a name="l02177"></a>02177 <span class="comment"> *</span>
<a name="l02178"></a>02178 <span class="comment"> * @global  string   $db                the database name</span>
<a name="l02179"></a>02179 <span class="comment"> * @global  string   $table             the table name</span>
<a name="l02180"></a>02180 <span class="comment"> * @global  string   $goto              the URL to go back in case of errors</span>
<a name="l02181"></a>02181 <span class="comment"> * @global  string   $sql_query         the current SQL query</span>
<a name="l02182"></a>02182 <span class="comment"> * @global  integer  $num_rows          the total number of rows returned by the</span>
<a name="l02183"></a>02183 <span class="comment"> *                                      SQL query</span>
<a name="l02184"></a>02184 <span class="comment"> * @global  integer  $unlim_num_rows    the total number of rows returned by the</span>
<a name="l02185"></a>02185 <span class="comment"> *                                      SQL query without any programmatically</span>
<a name="l02186"></a>02186 <span class="comment"> *                                      appended &quot;LIMIT&quot; clause</span>
<a name="l02187"></a>02187 <span class="comment"> * @global  array    $fields_meta       the list of fields properties</span>
<a name="l02188"></a>02188 <span class="comment"> * @global  integer  $fields_cnt        the total number of fields returned by</span>
<a name="l02189"></a>02189 <span class="comment"> *                                      the SQL query</span>
<a name="l02190"></a>02190 <span class="comment"> * @global  array    $vertical_display  informations used with vertical display</span>
<a name="l02191"></a>02191 <span class="comment"> *                                      mode</span>
<a name="l02192"></a>02192 <span class="comment"> * @global  array    $highlight_columns column names to highlight</span>
<a name="l02193"></a>02193 <span class="comment"> * @global  array    $cfgRelation       the relation settings</span>
<a name="l02194"></a>02194 <span class="comment"> * @global  array    $showtable         table definitions</span>
<a name="l02195"></a>02195 <span class="comment"> *</span>
<a name="l02196"></a>02196 <span class="comment"> * @access  private</span>
<a name="l02197"></a>02197 <span class="comment"> *</span>
<a name="l02198"></a>02198 <span class="comment"> * @see     PMA_showMessage(), PMA_setDisplayMode(),</span>
<a name="l02199"></a>02199 <span class="comment"> *          PMA_displayTableNavigation(), PMA_displayTableHeaders(),</span>
<a name="l02200"></a>02200 <span class="comment"> *          PMA_displayTableBody(), PMA_displayResultsOperations()</span>
<a name="l02201"></a>02201 <span class="comment"> *</span>
<a name="l02202"></a>02202 <span class="comment"> * @return nothing</span>
<a name="l02203"></a>02203 <span class="comment"> */</span>
<a name="l02204"></a><a class="code" href="display__tbl_8lib_8php.html#ab64d4328beb5bc6b0a62abfa39fb447a">02204</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#ab64d4328beb5bc6b0a62abfa39fb447a" title="Displays a table of results returned by a SQL query.">PMA_displayTable</a>(&amp;$dt_result, &amp;$the_disp_mode, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>)
<a name="l02205"></a>02205 {
<a name="l02206"></a>02206     global <a class="code" href="schema__export_8php.html#a907d78797a1b764e913b0c565a5097b0" title="get all the export options and verify call and include the appropriate Schema Class depending on $exp...">$db</a>, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>, <a class="code" href="db__sql_8php.html#a4037a8ff7343cce7ab4dadfd490ad3ee">$goto</a>;
<a name="l02207"></a>02207     global <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>, $num_rows, $unlim_num_rows, $fields_meta, <a class="code" href="tbl__change_8php.html#a580526107852923681984db1a74a921c">$fields_cnt</a>;
<a name="l02208"></a>02208     global $vertical_display, $highlight_columns;
<a name="l02209"></a>02209     global <a class="code" href="browse__foreigners_8php.html#ac752ebe2d31fa88bf538e8753b64bdfb" title="Displays the frame.">$cfgRelation</a>;
<a name="l02210"></a>02210     global <a class="code" href="tbl__info_8inc_8php.html#a165ba5f9dd92fc76b48e4932fdddbf73" title="Defining global variables, in case this script is included by a function.">$showtable</a>;
<a name="l02211"></a>02211 
<a name="l02212"></a>02212     <span class="comment">// why was this called here? (already called from sql.php)</span>
<a name="l02213"></a>02213     <span class="comment">//PMA_displayTable_checkConfigParams();</span>
<a name="l02214"></a>02214 <span class="comment"></span>
<a name="l02215"></a>02215 <span class="comment">    /**</span>
<a name="l02216"></a>02216 <span class="comment">     * @todo move this to a central place</span>
<a name="l02217"></a>02217 <span class="comment">     * @todo for other future table types</span>
<a name="l02218"></a>02218 <span class="comment">     */</span>
<a name="l02219"></a>02219     $is_innodb = (isset($showtable[<span class="stringliteral">&#39;Type&#39;</span>]) &amp;&amp; $showtable[<span class="stringliteral">&#39;Type&#39;</span>] == <span class="stringliteral">&#39;InnoDB&#39;</span>);
<a name="l02220"></a>02220 
<a name="l02221"></a>02221     <span class="keywordflow">if</span> ($is_innodb
<a name="l02222"></a>02222         &amp;&amp; ! isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;queryflags&#39;</span>][<span class="stringliteral">&#39;union&#39;</span>])
<a name="l02223"></a>02223         &amp;&amp; ! isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>][1][<span class="stringliteral">&#39;table_name&#39;</span>])
<a name="l02224"></a>02224         &amp;&amp; (empty(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;where_clause&#39;</span>]) || <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;where_clause&#39;</span>] == <span class="stringliteral">&#39;1 &#39;</span>)
<a name="l02225"></a>02225     ) {
<a name="l02226"></a>02226         <span class="comment">// &quot;j u s t   b r o w s i n g&quot;</span>
<a name="l02227"></a>02227         $pre_count = <span class="charliteral">&#39;~&#39;</span>;
<a name="l02228"></a>02228         $after_count = <a class="code" href="common_8lib_8php.html#a081817420a85500983dfb5e02110d9f9" title="returns HTML for a footnote marker and add the messsage to the footnotes">PMA_showHint</a>(<a class="code" href="sanitizing_8lib_8php.html#ac0444f97c4d50f0e109dc0ec5d86b665" title="Sanitizes $message, taking into account our special codes for formatting.">PMA_sanitize</a>(__(<span class="stringliteral">&#39;May be approximate. See [a@./Documentation.html#faq3_11@Documentation]FAQ 3.11[/a]&#39;</span>)));
<a name="l02229"></a>02229     } <span class="keywordflow">else</span> {
<a name="l02230"></a>02230         $pre_count = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02231"></a>02231         $after_count = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02232"></a>02232     }
<a name="l02233"></a>02233 
<a name="l02234"></a>02234     <span class="comment">// 1. ----- Prepares the work -----</span>
<a name="l02235"></a>02235 
<a name="l02236"></a>02236     <span class="comment">// 1.1 Gets the informations about which functionalities should be</span>
<a name="l02237"></a>02237     <span class="comment">//     displayed</span>
<a name="l02238"></a>02238     $total      = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02239"></a>02239     $is_display = <a class="code" href="display__tbl_8lib_8php.html#a1d6c4bbc5354600cc41634d3dd8066b9" title="Defines the display mode to use for the results of a SQL query.">PMA_setDisplayMode</a>($the_disp_mode, $total);
<a name="l02240"></a>02240 
<a name="l02241"></a>02241     <span class="comment">// 1.2 Defines offsets for the next and previous pages</span>
<a name="l02242"></a>02242     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;nav_bar&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l02243"></a>02243         <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>] == <span class="stringliteral">&#39;all&#39;</span>) {
<a name="l02244"></a>02244             $pos_next     = 0;
<a name="l02245"></a>02245             $pos_prev     = 0;
<a name="l02246"></a>02246         } <span class="keywordflow">else</span> {
<a name="l02247"></a>02247             $pos_next     = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;pos&#39;</span>] + <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>];
<a name="l02248"></a>02248             $pos_prev     = $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;pos&#39;</span>] - $_SESSION[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>];
<a name="l02249"></a>02249             <span class="keywordflow">if</span> ($pos_prev &lt; 0) {
<a name="l02250"></a>02250                 $pos_prev = 0;
<a name="l02251"></a>02251             }
<a name="l02252"></a>02252         }
<a name="l02253"></a>02253     } <span class="comment">// end if</span>
<a name="l02254"></a>02254 
<a name="l02255"></a>02255     <span class="comment">// 1.3 Find the sort expression</span>
<a name="l02256"></a>02256 
<a name="l02257"></a>02257     <span class="comment">// we need $sort_expression and $sort_expression_nodirection</span>
<a name="l02258"></a>02258     <span class="comment">// even if there are many table references</span>
<a name="l02259"></a>02259     <span class="keywordflow">if</span> (! empty(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;order_by_clause&#39;</span>])) {
<a name="l02260"></a>02260         $sort_expression = trim(str_replace(<span class="stringliteral">&#39;  &#39;</span>, <span class="charliteral">&#39; &#39;</span>, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;order_by_clause&#39;</span>]));<span class="comment"></span>
<a name="l02261"></a>02261 <span class="comment">        /**</span>
<a name="l02262"></a>02262 <span class="comment">         * Get rid of ASC|DESC</span>
<a name="l02263"></a>02263 <span class="comment">         */</span>
<a name="l02264"></a>02264         preg_match(<span class="stringliteral">&#39;@(.*)([[:space:]]*(ASC|DESC))@si&#39;</span>, $sort_expression, $matches);
<a name="l02265"></a>02265         $sort_expression_nodirection = isset($matches[1]) ? trim($matches[1]) : $sort_expression;
<a name="l02266"></a>02266         $sort_direction = isset($matches[2]) ? trim($matches[2]) : <span class="stringliteral">&#39;&#39;</span>;
<a name="l02267"></a>02267         unset($matches);
<a name="l02268"></a>02268     } <span class="keywordflow">else</span> {
<a name="l02269"></a>02269         $sort_expression = $sort_expression_nodirection = $sort_direction = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02270"></a>02270     }
<a name="l02271"></a>02271 
<a name="l02272"></a>02272     <span class="comment">// 1.4 Prepares display of first and last value of the sorted column</span>
<a name="l02273"></a>02273 
<a name="l02274"></a>02274     <span class="keywordflow">if</span> (! empty($sort_expression_nodirection)) {
<a name="l02275"></a>02275         <span class="keywordflow">if</span> (strpos($sort_expression_nodirection, <span class="charliteral">&#39;.&#39;</span>) === <span class="keyword">false</span>) {
<a name="l02276"></a>02276             $sort_table = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>;
<a name="l02277"></a>02277             $sort_column = $sort_expression_nodirection;
<a name="l02278"></a>02278         } <span class="keywordflow">else</span> {
<a name="l02279"></a>02279             list($sort_table, $sort_column) = explode(<span class="charliteral">&#39;.&#39;</span>, $sort_expression_nodirection);
<a name="l02280"></a>02280         }
<a name="l02281"></a>02281         $sort_table = <a class="code" href="common_8lib_8php.html#aa3c7e6be52567014a075e7fdb18ff2c6" title="removes quotes (&#39;,",`) from a quoted string">PMA_unQuote</a>($sort_table);
<a name="l02282"></a>02282         $sort_column = <a class="code" href="common_8lib_8php.html#aa3c7e6be52567014a075e7fdb18ff2c6" title="removes quotes (&#39;,",`) from a quoted string">PMA_unQuote</a>($sort_column);
<a name="l02283"></a>02283         <span class="comment">// find the sorted column index in row result</span>
<a name="l02284"></a>02284         <span class="comment">// (this might be a multi-table query)</span>
<a name="l02285"></a>02285         $sorted_column_index = <span class="keyword">false</span>;
<a name="l02286"></a>02286         <span class="keywordflow">foreach</span> ($fields_meta as $key =&gt; <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>) {
<a name="l02287"></a>02287             <span class="keywordflow">if</span> (<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;table == $sort_table &amp;&amp; <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name == $sort_column) {
<a name="l02288"></a>02288                 $sorted_column_index = $key;
<a name="l02289"></a>02289                 <span class="keywordflow">break</span>;
<a name="l02290"></a>02290             }
<a name="l02291"></a>02291         }
<a name="l02292"></a>02292         <span class="keywordflow">if</span> ($sorted_column_index !== <span class="keyword">false</span>) {
<a name="l02293"></a>02293             <span class="comment">// fetch first row of the result set</span>
<a name="l02294"></a>02294             <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a> = <a class="code" href="drizzle_8dbi_8lib_8php.html#a76a677a68b562828af0dfe4467107d31" title="returns array of rows with numeric keys from $result">PMA_DBI_fetch_row</a>($dt_result);
<a name="l02295"></a>02295             <span class="comment">// initializing default arguments</span>
<a name="l02296"></a>02296             $default_function = <span class="stringliteral">&#39;default_function&#39;</span>;
<a name="l02297"></a>02297             $transform_function = $default_function;
<a name="l02298"></a>02298             $transform_options = array();
<a name="l02299"></a>02299             <span class="comment">// check for non printable sorted row data</span>
<a name="l02300"></a>02300             <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a> = $fields_meta[$sorted_column_index];
<a name="l02301"></a>02301             <span class="keywordflow">if</span> (stristr(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type, <span class="stringliteral">&#39;BLOB&#39;</span>) || <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type == <span class="stringliteral">&#39;geometry&#39;</span>) {
<a name="l02302"></a>02302                 $column_for_first_row = <a class="code" href="display__tbl_8lib_8php.html#adc2b985ffe56063359ca5c9b996518f9" title="Verifies what to do with non-printable contents (binary or BLOB) in Browse mode.">PMA_handle_non_printable_contents</a>(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type, <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>[$sorted_column_index], $transform_function, $transform_options, $default_function, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, null);
<a name="l02303"></a>02303             } <span class="keywordflow">else</span> {
<a name="l02304"></a>02304                 $column_for_first_row = <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>[$sorted_column_index];
<a name="l02305"></a>02305             }
<a name="l02306"></a>02306             $column_for_first_row = strtoupper(substr($column_for_first_row, 0, <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>]));
<a name="l02307"></a>02307             <span class="comment">// fetch last row of the result set</span>
<a name="l02308"></a>02308             <a class="code" href="drizzle_8dbi_8lib_8php.html#aac7efdc35cbbd9715c3f43784a8a0c97" title="Adjusts the result pointer to an arbitrary row in the result.">PMA_DBI_data_seek</a>($dt_result, $num_rows - 1);
<a name="l02309"></a>02309             <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a> = <a class="code" href="drizzle_8dbi_8lib_8php.html#a76a677a68b562828af0dfe4467107d31" title="returns array of rows with numeric keys from $result">PMA_DBI_fetch_row</a>($dt_result);
<a name="l02310"></a>02310             <span class="comment">// check for non printable sorted row data</span>
<a name="l02311"></a>02311             <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a> = $fields_meta[$sorted_column_index];
<a name="l02312"></a>02312             <span class="keywordflow">if</span> (stristr(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type, <span class="stringliteral">&#39;BLOB&#39;</span>) || <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type == <span class="stringliteral">&#39;geometry&#39;</span>) {
<a name="l02313"></a>02313                 $column_for_last_row = <a class="code" href="display__tbl_8lib_8php.html#adc2b985ffe56063359ca5c9b996518f9" title="Verifies what to do with non-printable contents (binary or BLOB) in Browse mode.">PMA_handle_non_printable_contents</a>(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type, <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>[$sorted_column_index], $transform_function, $transform_options, $default_function, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, null);
<a name="l02314"></a>02314             } <span class="keywordflow">else</span> {
<a name="l02315"></a>02315                 $column_for_last_row = <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>[$sorted_column_index];
<a name="l02316"></a>02316             }
<a name="l02317"></a>02317             $column_for_last_row = strtoupper(substr($column_for_last_row, 0, <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;LimitChars&#39;</span>]));
<a name="l02318"></a>02318             <span class="comment">// reset to first row for the loop in PMA_displayTableBody()</span>
<a name="l02319"></a>02319             <a class="code" href="drizzle_8dbi_8lib_8php.html#aac7efdc35cbbd9715c3f43784a8a0c97" title="Adjusts the result pointer to an arbitrary row in the result.">PMA_DBI_data_seek</a>($dt_result, 0);
<a name="l02320"></a>02320             <span class="comment">// we could also use here $sort_expression_nodirection</span>
<a name="l02321"></a>02321             $sorted_column_message = <span class="stringliteral">&#39; [&#39;</span> . htmlspecialchars($sort_column) . <span class="stringliteral">&#39;: &lt;strong&gt;&#39;</span> . htmlspecialchars($column_for_first_row) . <span class="stringliteral">&#39; - &#39;</span> . htmlspecialchars($column_for_last_row) . <span class="stringliteral">&#39;&lt;/strong&gt;]&#39;</span>;
<a name="l02322"></a>02322             unset(<a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>, $column_for_first_row, $column_for_last_row, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $default_function, $transform_function, $transform_options);
<a name="l02323"></a>02323         }
<a name="l02324"></a>02324         unset($sorted_column_index, $sort_table, $sort_column);
<a name="l02325"></a>02325     }
<a name="l02326"></a>02326 
<a name="l02327"></a>02327     <span class="comment">// 2. ----- Displays the top of the page -----</span>
<a name="l02328"></a>02328 
<a name="l02329"></a>02329     <span class="comment">// 2.1 Displays a messages with position informations</span>
<a name="l02330"></a>02330     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;nav_bar&#39;</span>] == <span class="charliteral">&#39;1&#39;</span> &amp;&amp; isset($pos_next)) {
<a name="l02331"></a>02331         <span class="keywordflow">if</span> (isset($unlim_num_rows) &amp;&amp; $unlim_num_rows != $total) {
<a name="l02332"></a>02332             $selectstring = <span class="stringliteral">&#39;, &#39;</span> . $unlim_num_rows . <span class="charliteral">&#39; &#39;</span> . __(<span class="stringliteral">&#39;in query&#39;</span>);
<a name="l02333"></a>02333         } <span class="keywordflow">else</span> {
<a name="l02334"></a>02334             $selectstring = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02335"></a>02335         }
<a name="l02336"></a>02336 
<a name="l02337"></a>02337         <span class="keywordflow">if</span> (! empty(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;limit_clause&#39;</span>])) {
<a name="l02338"></a>02338             $limit_data = <a class="code" href="common_8lib_8php.html#a4faf03cde6f5a6f5f5d4fa0816cad2aa" title="Analyzes the limit clause and return the start and length attributes of it.">PMA_analyzeLimitClause</a>(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;limit_clause&#39;</span>]);
<a name="l02339"></a>02339             $first_shown_rec = $limit_data[<span class="stringliteral">&#39;start&#39;</span>];
<a name="l02340"></a>02340             <span class="keywordflow">if</span> ($limit_data[<span class="stringliteral">&#39;length&#39;</span>] &lt; $total) {
<a name="l02341"></a>02341                 $last_shown_rec = $limit_data[<span class="stringliteral">&#39;start&#39;</span>] + $limit_data[<span class="stringliteral">&#39;length&#39;</span>] - 1;
<a name="l02342"></a>02342             } <span class="keywordflow">else</span> {
<a name="l02343"></a>02343                 $last_shown_rec = $limit_data[<span class="stringliteral">&#39;start&#39;</span>] + $total - 1;
<a name="l02344"></a>02344             }
<a name="l02345"></a>02345         } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;max_rows&#39;</span>] == <span class="stringliteral">&#39;all&#39;</span> || $pos_next &gt; $total) {
<a name="l02346"></a>02346             $first_shown_rec = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;pos&#39;</span>];
<a name="l02347"></a>02347             $last_shown_rec  = $total - 1;
<a name="l02348"></a>02348         } <span class="keywordflow">else</span> {
<a name="l02349"></a>02349             $first_shown_rec = <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;pos&#39;</span>];
<a name="l02350"></a>02350             $last_shown_rec  = $pos_next - 1;
<a name="l02351"></a>02351         }
<a name="l02352"></a>02352 
<a name="l02353"></a>02353         <span class="keywordflow">if</span> (<a class="code" href="classPMA__Table.html#af9040740c71098b2c58b3234d7f0afaa" title="returns whether the table is actually a view">PMA_Table::isView</a>($db, $table)
<a name="l02354"></a>02354             &amp;&amp; $total == <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;cfg&#39;</span>][<span class="stringliteral">&#39;MaxExactCountViews&#39;</span>]
<a name="l02355"></a>02355         ) {
<a name="l02356"></a>02356             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a> = <a class="code" href="classPMA__Message.html#ae349e34602657ee46e56d435e93fa2db" title="get PMA_Message of type notice">PMA_Message::notice</a>(__(<span class="stringliteral">&#39;This view has at least this number of rows. Please refer to %sdocumentation%s.&#39;</span>));
<a name="l02357"></a>02357             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addParam(<span class="stringliteral">&#39;[a@./Documentation.html#cfg_MaxExactCount@_blank]&#39;</span>);
<a name="l02358"></a>02358             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addParam(<span class="stringliteral">&#39;[/a]&#39;</span>);
<a name="l02359"></a>02359             $message_view_warning = <a class="code" href="common_8lib_8php.html#a081817420a85500983dfb5e02110d9f9" title="returns HTML for a footnote marker and add the messsage to the footnotes">PMA_showHint</a>(<a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>);
<a name="l02360"></a>02360         } <span class="keywordflow">else</span> {
<a name="l02361"></a>02361             $message_view_warning = <span class="keyword">false</span>;
<a name="l02362"></a>02362         }
<a name="l02363"></a>02363 
<a name="l02364"></a>02364         <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a> = <a class="code" href="classPMA__Message.html#a18c1022045762ab6747a98cb4464819e" title="get PMA_Message of type success">PMA_Message::success</a>(__(<span class="stringliteral">&#39;Showing rows&#39;</span>));
<a name="l02365"></a>02365         <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage($first_shown_rec);
<a name="l02366"></a>02366         <span class="keywordflow">if</span> ($message_view_warning) {
<a name="l02367"></a>02367             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage(<span class="stringliteral">&#39;...&#39;</span>, <span class="stringliteral">&#39; - &#39;</span>);
<a name="l02368"></a>02368             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage($message_view_warning);
<a name="l02369"></a>02369             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage(<span class="charliteral">&#39;(&#39;</span>);
<a name="l02370"></a>02370         } <span class="keywordflow">else</span> {
<a name="l02371"></a>02371             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage($last_shown_rec, <span class="stringliteral">&#39; - &#39;</span>);
<a name="l02372"></a>02372             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage(<span class="stringliteral">&#39; (&#39;</span>);
<a name="l02373"></a>02373             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage($pre_count  . <a class="code" href="common_8lib_8php.html#abeaeabaf95ad63e5163642ff03ec6879" title="Formats $value to the given length and appends SI prefixes with a $length of 0 no truncation occurs...">PMA_formatNumber</a>($total, 0));
<a name="l02374"></a>02374             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addString(__(<span class="stringliteral">&#39;total&#39;</span>));
<a name="l02375"></a>02375             <span class="keywordflow">if</span> (!empty($after_count)) {
<a name="l02376"></a>02376                 <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage($after_count);
<a name="l02377"></a>02377             }
<a name="l02378"></a>02378             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage($selectstring, <span class="stringliteral">&#39;&#39;</span>);
<a name="l02379"></a>02379             <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage(<span class="stringliteral">&#39;, &#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l02380"></a>02380         }
<a name="l02381"></a>02381 
<a name="l02382"></a>02382         $messagge_qt = <a class="code" href="classPMA__Message.html#ae349e34602657ee46e56d435e93fa2db" title="get PMA_Message of type notice">PMA_Message::notice</a>(__(<span class="stringliteral">&#39;Query took %01.4f sec&#39;</span>));
<a name="l02383"></a>02383         $messagge_qt-&gt;addParam(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;querytime&#39;</span>]);
<a name="l02384"></a>02384 
<a name="l02385"></a>02385         <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage($messagge_qt, <span class="stringliteral">&#39;&#39;</span>);
<a name="l02386"></a>02386         <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage(<span class="charliteral">&#39;)&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l02387"></a>02387 
<a name="l02388"></a>02388         <a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>-&gt;addMessage(isset($sorted_column_message) ? $sorted_column_message : <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l02389"></a>02389 
<a name="l02390"></a>02390         <a class="code" href="common_8lib_8php.html#ac856542e67ea0192bc0fc7fd1fb21d09" title="displays the message and the query usually the message is the result of the query executed...">PMA_showMessage</a>(<a class="code" href="forums_8php.html#abf17cb2dba2ed17cb28aa5f37deb5293">$message</a>, $sql_query, <span class="stringliteral">&#39;success&#39;</span>);
<a name="l02391"></a>02391 
<a name="l02392"></a>02392     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (! isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>]) || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>] != <span class="charliteral">&#39;1&#39;</span>) {
<a name="l02393"></a>02393         <a class="code" href="common_8lib_8php.html#ac856542e67ea0192bc0fc7fd1fb21d09" title="displays the message and the query usually the message is the result of the query executed...">PMA_showMessage</a>(__(<span class="stringliteral">&#39;Your SQL query has been executed successfully&#39;</span>), $sql_query, <span class="stringliteral">&#39;success&#39;</span>);
<a name="l02394"></a>02394     }
<a name="l02395"></a>02395 
<a name="l02396"></a>02396     <span class="comment">// 2.3 Displays the navigation bars</span>
<a name="l02397"></a>02397     <span class="keywordflow">if</span> (! strlen($table)) {
<a name="l02398"></a>02398         <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;query_type&#39;</span>])
<a name="l02399"></a>02399             &amp;&amp; <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;query_type&#39;</span>] == <span class="stringliteral">&#39;SELECT&#39;</span>
<a name="l02400"></a>02400         ) {
<a name="l02401"></a>02401             <span class="comment">// table does not always contain a real table name,</span>
<a name="l02402"></a>02402             <span class="comment">// for example in MySQL 5.0.x, the query SHOW STATUS</span>
<a name="l02403"></a>02403             <span class="comment">// returns STATUS as a table name</span>
<a name="l02404"></a>02404             $table = $fields_meta[0]-&gt;table;
<a name="l02405"></a>02405         } <span class="keywordflow">else</span> {
<a name="l02406"></a>02406             $table = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02407"></a>02407         }
<a name="l02408"></a>02408     }
<a name="l02409"></a>02409 
<a name="l02410"></a>02410     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;nav_bar&#39;</span>] == <span class="charliteral">&#39;1&#39;</span> &amp;&amp; empty(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;limit_clause&#39;</span>])) {
<a name="l02411"></a>02411         <a class="code" href="display__tbl_8lib_8php.html#ad976ef528675a4d65fd57ea37fc51e25" title="Displays a navigation bar to browse among the results of a SQL query.">PMA_displayTableNavigation</a>($pos_next, $pos_prev, $sql_query, <span class="stringliteral">&#39;top_direction_dropdown&#39;</span>);
<a name="l02412"></a>02412         echo <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02413"></a>02413     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (! isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>]) || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>] != <span class="charliteral">&#39;1&#39;</span>) {
<a name="l02414"></a>02414         echo <span class="stringliteral">&quot;\n&quot;</span> . <span class="stringliteral">&#39;&lt;br /&gt;&lt;br /&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02415"></a>02415     }
<a name="l02416"></a>02416 
<a name="l02417"></a>02417     <span class="comment">// 2b ----- Get field references from Database -----</span>
<a name="l02418"></a>02418     <span class="comment">// (see the &#39;relation&#39; configuration variable)</span>
<a name="l02419"></a>02419 
<a name="l02420"></a>02420     <span class="comment">// initialize map</span>
<a name="l02421"></a>02421     $map = array();
<a name="l02422"></a>02422 
<a name="l02423"></a>02423     <span class="comment">// find tables</span>
<a name="l02424"></a>02424     $target=array();
<a name="l02425"></a>02425     <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>]) &amp;&amp; is_array(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>])) {
<a name="l02426"></a>02426         <span class="keywordflow">foreach</span> (<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>] AS $table_ref_position =&gt; $table_ref) {
<a name="l02427"></a>02427             $target[] = <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>][$table_ref_position][<span class="stringliteral">&#39;table_true_name&#39;</span>];
<a name="l02428"></a>02428         }
<a name="l02429"></a>02429     }
<a name="l02430"></a>02430     <a class="code" href="db__links_8inc_8php.html#a9650ef898243b078767d3918486c61d4" title="Displays tab links.">$tabs</a>    = <span class="stringliteral">&#39;(\&#39;&#39;</span> . join(<span class="charliteral">&#39;\&#39;</span>,\<span class="stringliteral">&#39;&#39;</span>, $target) . <span class="charliteral">&#39;\&#39;</span>)<span class="stringliteral">&#39;;</span>
<a name="l02431"></a>02431 <span class="stringliteral"></span>
<a name="l02432"></a>02432 <span class="stringliteral">    if (! strlen($table)) {</span>
<a name="l02433"></a>02433 <span class="stringliteral">        $exist_rel = false;</span>
<a name="l02434"></a>02434 <span class="stringliteral">    } else {</span>
<a name="l02435"></a>02435 <span class="stringliteral">        // To be able to later display a link to the related table,</span>
<a name="l02436"></a>02436 <span class="stringliteral">        // we verify both types of relations: either those that are</span>
<a name="l02437"></a>02437 <span class="stringliteral">        // native foreign keys or those defined in the phpMyAdmin</span>
<a name="l02438"></a>02438 <span class="stringliteral">        // configuration storage. If no PMA storage, we won&#39;</span>t be able
<a name="l02439"></a>02439         <span class="comment">// to use the &quot;column to display&quot; notion (for example show</span>
<a name="l02440"></a>02440         <span class="comment">// the name related to a numeric id).</span>
<a name="l02441"></a>02441         $exist_rel = <a class="code" href="relation_8lib_8php.html#a06f317c03581ae429698a20c7aa155df" title="Gets all Relations to foreign tables for a given table or optionally a given column in a table...">PMA_getForeigners</a>($db, $table, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;both&#39;</span>);
<a name="l02442"></a>02442         <span class="keywordflow">if</span> ($exist_rel) {
<a name="l02443"></a>02443             <span class="keywordflow">foreach</span> ($exist_rel AS $master_field =&gt; $rel) {
<a name="l02444"></a>02444                 <a class="code" href="pmd__display__field_8php.html#a8e215827a08ec2788a833ec2bef4a62a">$display_field</a> = <a class="code" href="relation_8lib_8php.html#ac4b9248f6ad1179a0f86d70f2ad99362" title="Gets the display field of a table.">PMA_getDisplayField</a>($rel[<span class="stringliteral">&#39;foreign_db&#39;</span>], $rel[<span class="stringliteral">&#39;foreign_table&#39;</span>]);
<a name="l02445"></a>02445                 $map[$master_field] = array($rel[<span class="stringliteral">&#39;foreign_table&#39;</span>],
<a name="l02446"></a>02446                                       $rel[<span class="stringliteral">&#39;foreign_field&#39;</span>],
<a name="l02447"></a>02447                                       <a class="code" href="pmd__display__field_8php.html#a8e215827a08ec2788a833ec2bef4a62a">$display_field</a>,
<a name="l02448"></a>02448                                       $rel[<span class="stringliteral">&#39;foreign_db&#39;</span>]);
<a name="l02449"></a>02449             } <span class="comment">// end while</span>
<a name="l02450"></a>02450         } <span class="comment">// end if</span>
<a name="l02451"></a>02451     } <span class="comment">// end if</span>
<a name="l02452"></a>02452     <span class="comment">// end 2b</span>
<a name="l02453"></a>02453 
<a name="l02454"></a>02454     <span class="comment">// 3. ----- Displays the results table -----</span>
<a name="l02455"></a>02455     <a class="code" href="display__tbl_8lib_8php.html#aae4044b44dccb4059685ea603dc52e9e" title="Displays the headers of the results table.">PMA_displayTableHeaders</a>($is_display, $fields_meta, <a class="code" href="tbl__change_8php.html#a580526107852923681984db1a74a921c">$fields_cnt</a>, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>, $sort_expression, $sort_expression_nodirection, $sort_direction);
<a name="l02456"></a>02456     <a class="code" href="db__export_8php.html#a9f97d7db14905bd6ce32b003b416769c">$url_query</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02457"></a>02457     echo <span class="stringliteral">&#39;&lt;tbody&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02458"></a>02458     $clause_is_unique = <a class="code" href="display__tbl_8lib_8php.html#a584c8e9b54e86afef57d654e60a836ed" title="Displays the body of the results table.">PMA_displayTableBody</a>($dt_result, $is_display, $map, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>);
<a name="l02459"></a>02459     <span class="comment">// vertical output case</span>
<a name="l02460"></a>02460     <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;vertical&#39;</span>) {
<a name="l02461"></a>02461         <a class="code" href="display__tbl_8lib_8php.html#a7c50ce25e0eca03e1d4320f56e55c15d" title="Do display the result table with the vertical direction mode.">PMA_displayVerticalTable</a>();
<a name="l02462"></a>02462     } <span class="comment">// end if</span>
<a name="l02463"></a>02463     unset($vertical_display);
<a name="l02464"></a>02464     echo <span class="stringliteral">&#39;&lt;/tbody&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02465"></a>02465     ?&gt;
<a name="l02466"></a>02466 &lt;/table&gt;
<a name="l02467"></a>02467 
<a name="l02468"></a>02468     &lt;?php
<a name="l02469"></a>02469     <span class="comment">// 4. ----- Displays the link for multi-fields edit and delete</span>
<a name="l02470"></a>02470 
<a name="l02471"></a>02471     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] == <span class="stringliteral">&#39;dr&#39;</span> &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;kp&#39;</span>) {
<a name="l02472"></a>02472 
<a name="l02473"></a>02473         $delete_text = $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] == <span class="stringliteral">&#39;dr&#39;</span> ? __(<span class="stringliteral">&#39;Delete&#39;</span>) : __(<span class="stringliteral">&#39;Kill&#39;</span>);
<a name="l02474"></a>02474 
<a name="l02475"></a>02475         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l02476"></a>02476             <span class="stringliteral">&#39;db&#39;</span>        =&gt; <a class="code" href="schema__export_8php.html#a907d78797a1b764e913b0c565a5097b0" title="get all the export options and verify call and include the appropriate Schema Class depending on $exp...">$db</a>,
<a name="l02477"></a>02477             <span class="stringliteral">&#39;table&#39;</span>     =&gt; <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>,
<a name="l02478"></a>02478             <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>,
<a name="l02479"></a>02479             <span class="stringliteral">&#39;goto&#39;</span>      =&gt; <a class="code" href="db__sql_8php.html#a4037a8ff7343cce7ab4dadfd490ad3ee">$goto</a>,
<a name="l02480"></a>02480         );
<a name="l02481"></a>02481         $uncheckall_url = <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l02482"></a>02482 
<a name="l02483"></a>02483         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;checkall&#39;</span>] = <span class="charliteral">&#39;1&#39;</span>;
<a name="l02484"></a>02484         <a class="code" href="db__export_8php.html#aa1799b22aec0684d9bc18f47cd89b0f2">$checkall_url</a> = <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l02485"></a>02485 
<a name="l02486"></a>02486         <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] == <span class="stringliteral">&#39;vertical&#39;</span>) {
<a name="l02487"></a>02487             $checkall_params[<span class="stringliteral">&#39;onclick&#39;</span>] = <span class="stringliteral">&#39;if (setCheckboxes(\&#39;resultsForm\&#39;, true)) return false;&#39;</span>;
<a name="l02488"></a>02488             $uncheckall_params[<span class="stringliteral">&#39;onclick&#39;</span>] = <span class="stringliteral">&#39;if (setCheckboxes(\&#39;resultsForm\&#39;, false)) return false;&#39;</span>;
<a name="l02489"></a>02489         } <span class="keywordflow">else</span> {
<a name="l02490"></a>02490             $checkall_params[<span class="stringliteral">&#39;onclick&#39;</span>] = <span class="stringliteral">&#39;if (markAllRows(\&#39;resultsForm\&#39;)) return false;&#39;</span>;
<a name="l02491"></a>02491             $uncheckall_params[<span class="stringliteral">&#39;onclick&#39;</span>] = <span class="stringliteral">&#39;if (unMarkAllRows(\&#39;resultsForm\&#39;)) return false;&#39;</span>;
<a name="l02492"></a>02492         }
<a name="l02493"></a>02493         $checkall_link = <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>(<a class="code" href="db__export_8php.html#aa1799b22aec0684d9bc18f47cd89b0f2">$checkall_url</a>, __(<span class="stringliteral">&#39;Check All&#39;</span>), $checkall_params, <span class="keyword">false</span>);
<a name="l02494"></a>02494         $uncheckall_link = <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>($uncheckall_url, __(<span class="stringliteral">&#39;Uncheck All&#39;</span>), $uncheckall_params, <span class="keyword">false</span>);
<a name="l02495"></a>02495         <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;disp_direction&#39;</span>] != <span class="stringliteral">&#39;vertical&#39;</span>) {
<a name="l02496"></a>02496             echo <span class="stringliteral">&#39;&lt;img class=&quot;selectallarrow&quot; width=&quot;38&quot; height=&quot;22&quot;&#39;</span>
<a name="l02497"></a>02497                 .<span class="stringliteral">&#39; src=&quot;&#39;</span> . <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;pmaThemeImage&#39;</span>] . <span class="stringliteral">&#39;arrow_&#39;</span> . <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;text_dir&#39;</span>] . <span class="stringliteral">&#39;.png&#39;</span> . <span class="charliteral">&#39;&quot;&#39;</span>
<a name="l02498"></a>02498                 .<span class="stringliteral">&#39; alt=&quot;&#39;</span> . __(<span class="stringliteral">&#39;With selected:&#39;</span>) . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l02499"></a>02499         }
<a name="l02500"></a>02500         echo $checkall_link . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l02501"></a>02501             .<span class="stringliteral">&#39; / &#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l02502"></a>02502             .$uncheckall_link . <span class="stringliteral">&quot;\n&quot;</span>
<a name="l02503"></a>02503             .<span class="stringliteral">&#39;&lt;i&gt;&#39;</span> . __(<span class="stringliteral">&#39;With selected:&#39;</span>) . <span class="stringliteral">&#39;&lt;/i&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02504"></a>02504 
<a name="l02505"></a>02505         <a class="code" href="common_8lib_8php.html#aaf5f833bb07151a034cab4dbabda9072" title="Generate a button or image tag.">PMA_buttonOrImage</a>(
<a name="l02506"></a>02506             <span class="stringliteral">&#39;submit_mult&#39;</span>, <span class="stringliteral">&#39;mult_submit&#39;</span>, <span class="stringliteral">&#39;submit_mult_change&#39;</span>,
<a name="l02507"></a>02507             __(<span class="stringliteral">&#39;Change&#39;</span>), <span class="stringliteral">&#39;b_edit.png&#39;</span>, <span class="stringliteral">&#39;edit&#39;</span>
<a name="l02508"></a>02508         );
<a name="l02509"></a>02509         <a class="code" href="common_8lib_8php.html#aaf5f833bb07151a034cab4dbabda9072" title="Generate a button or image tag.">PMA_buttonOrImage</a>(
<a name="l02510"></a>02510             <span class="stringliteral">&#39;submit_mult&#39;</span>, <span class="stringliteral">&#39;mult_submit&#39;</span>, <span class="stringliteral">&#39;submit_mult_delete&#39;</span>,
<a name="l02511"></a>02511             $delete_text, <span class="stringliteral">&#39;b_drop.png&#39;</span>, <span class="stringliteral">&#39;delete&#39;</span>
<a name="l02512"></a>02512         );
<a name="l02513"></a>02513         <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0]) &amp;&amp; <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;querytype&#39;</span>] == <span class="stringliteral">&#39;SELECT&#39;</span>) {
<a name="l02514"></a>02514             <a class="code" href="common_8lib_8php.html#aaf5f833bb07151a034cab4dbabda9072" title="Generate a button or image tag.">PMA_buttonOrImage</a>(
<a name="l02515"></a>02515                 <span class="stringliteral">&#39;submit_mult&#39;</span>, <span class="stringliteral">&#39;mult_submit&#39;</span>, <span class="stringliteral">&#39;submit_mult_export&#39;</span>,
<a name="l02516"></a>02516                 __(<span class="stringliteral">&#39;Export&#39;</span>), <span class="stringliteral">&#39;b_tblexport.png&#39;</span>, <span class="stringliteral">&#39;export&#39;</span>
<a name="l02517"></a>02517             );
<a name="l02518"></a>02518         }
<a name="l02519"></a>02519         echo <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02520"></a>02520 
<a name="l02521"></a>02521         echo <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;sql_query&quot;&#39;</span>
<a name="l02522"></a>02522             .<span class="stringliteral">&#39; value=&quot;&#39;</span> . htmlspecialchars(<a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>) . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02523"></a>02523 
<a name="l02524"></a>02524         <span class="keywordflow">if</span> (! empty(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;url_query&#39;</span>])) {
<a name="l02525"></a>02525             echo <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;url_query&quot;&#39;</span>
<a name="l02526"></a>02526                 .<span class="stringliteral">&#39; value=&quot;&#39;</span> . <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;url_query&#39;</span>] . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02527"></a>02527         }
<a name="l02528"></a>02528 
<a name="l02529"></a>02529         echo <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; name=&quot;clause_is_unique&quot;&#39;</span>
<a name="l02530"></a>02530             .<span class="stringliteral">&#39; value=&quot;&#39;</span> . $clause_is_unique . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02531"></a>02531 
<a name="l02532"></a>02532         echo <span class="stringliteral">&#39;&lt;/form&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02533"></a>02533     }
<a name="l02534"></a>02534 
<a name="l02535"></a>02535     <span class="comment">// 5. ----- Displays the navigation bar at the bottom if required -----</span>
<a name="l02536"></a>02536 
<a name="l02537"></a>02537     <span class="keywordflow">if</span> ($is_display[<span class="stringliteral">&#39;nav_bar&#39;</span>] == <span class="charliteral">&#39;1&#39;</span> &amp;&amp; empty(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;limit_clause&#39;</span>])) {
<a name="l02538"></a>02538         echo <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02539"></a>02539         <a class="code" href="display__tbl_8lib_8php.html#ad976ef528675a4d65fd57ea37fc51e25" title="Displays a navigation bar to browse among the results of a SQL query.">PMA_displayTableNavigation</a>($pos_next, $pos_prev, <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>, <span class="stringliteral">&#39;bottom_direction_dropdown&#39;</span>);
<a name="l02540"></a>02540     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (! isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>]) || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>] != <span class="charliteral">&#39;1&#39;</span>) {
<a name="l02541"></a>02541         echo <span class="stringliteral">&quot;\n&quot;</span> . <span class="stringliteral">&#39;&lt;br /&gt;&lt;br /&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02542"></a>02542     }
<a name="l02543"></a>02543 
<a name="l02544"></a>02544     <span class="comment">// 6. ----- Displays &quot;Query results operations&quot;</span>
<a name="l02545"></a>02545     <span class="keywordflow">if</span> (! isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>]) || <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>] != <span class="charliteral">&#39;1&#39;</span>) {
<a name="l02546"></a>02546         <a class="code" href="display__tbl_8lib_8php.html#ae2492e765f90454848fba297d5c447b5" title="Displays operations that are available on results.">PMA_displayResultsOperations</a>($the_disp_mode, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>);
<a name="l02547"></a>02547     }
<a name="l02548"></a>02548 } <span class="comment">// end of the &#39;PMA_displayTable()&#39; function</span>
<a name="l02549"></a>02549 
<a name="l02550"></a><a class="code" href="display__tbl_8lib_8php.html#a36c2b5f8d9733764d9720f7998e1a17b">02550</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a36c2b5f8d9733764d9720f7998e1a17b">default_function</a>(<a class="code" href="import_2csv_8php.html#aeb1bb175dd27fe3c0ca3761206965deb">$buffer</a>)
<a name="l02551"></a>02551 {
<a name="l02552"></a>02552     <a class="code" href="import_2csv_8php.html#aeb1bb175dd27fe3c0ca3761206965deb">$buffer</a> = htmlspecialchars(<a class="code" href="import_2csv_8php.html#aeb1bb175dd27fe3c0ca3761206965deb">$buffer</a>);
<a name="l02553"></a>02553     <a class="code" href="import_2csv_8php.html#aeb1bb175dd27fe3c0ca3761206965deb">$buffer</a> = str_replace(<span class="stringliteral">&quot;\011&quot;</span>, <span class="stringliteral">&#39; &amp;nbsp;&amp;nbsp;&amp;nbsp;&#39;</span>, str_replace(<span class="stringliteral">&#39;  &#39;</span>, <span class="stringliteral">&#39; &amp;nbsp;&#39;</span>, <a class="code" href="import_2csv_8php.html#aeb1bb175dd27fe3c0ca3761206965deb">$buffer</a>));
<a name="l02554"></a>02554     <a class="code" href="import_2csv_8php.html#aeb1bb175dd27fe3c0ca3761206965deb">$buffer</a> = preg_replace(<span class="stringliteral">&quot;@((\015\012)|(\015)|(\012))@&quot;</span>, <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>, <a class="code" href="import_2csv_8php.html#aeb1bb175dd27fe3c0ca3761206965deb">$buffer</a>);
<a name="l02555"></a>02555 
<a name="l02556"></a>02556     <span class="keywordflow">return</span> <a class="code" href="import_2csv_8php.html#aeb1bb175dd27fe3c0ca3761206965deb">$buffer</a>;
<a name="l02557"></a>02557 }
<a name="l02558"></a>02558 <span class="comment"></span>
<a name="l02559"></a>02559 <span class="comment">/**</span>
<a name="l02560"></a>02560 <span class="comment"> * Displays operations that are available on results.</span>
<a name="l02561"></a>02561 <span class="comment"> *</span>
<a name="l02562"></a>02562 <span class="comment"> * @param array $the_disp_mode the display mode</span>
<a name="l02563"></a>02563 <span class="comment"> * @param array $analyzed_sql  the analyzed query</span>
<a name="l02564"></a>02564 <span class="comment"> *</span>
<a name="l02565"></a>02565 <span class="comment"> * @global  string   $db                the database name</span>
<a name="l02566"></a>02566 <span class="comment"> * @global  string   $table             the table name</span>
<a name="l02567"></a>02567 <span class="comment"> * @global  string   $sql_query         the current SQL query</span>
<a name="l02568"></a>02568 <span class="comment"> * @global  integer  $unlim_num_rows    the total number of rows returned by the</span>
<a name="l02569"></a>02569 <span class="comment"> *                                      SQL query without any programmatically</span>
<a name="l02570"></a>02570 <span class="comment"> *                                      appended &quot;LIMIT&quot; clause</span>
<a name="l02571"></a>02571 <span class="comment"> *</span>
<a name="l02572"></a>02572 <span class="comment"> * @access  private</span>
<a name="l02573"></a>02573 <span class="comment"> *</span>
<a name="l02574"></a>02574 <span class="comment"> * @see     PMA_showMessage(), PMA_setDisplayMode(),</span>
<a name="l02575"></a>02575 <span class="comment"> *          PMA_displayTableNavigation(), PMA_displayTableHeaders(),</span>
<a name="l02576"></a>02576 <span class="comment"> *          PMA_displayTableBody(), PMA_displayResultsOperations()</span>
<a name="l02577"></a>02577 <span class="comment"> *</span>
<a name="l02578"></a>02578 <span class="comment"> * @return nothing</span>
<a name="l02579"></a>02579 <span class="comment"> */</span>
<a name="l02580"></a><a class="code" href="display__tbl_8lib_8php.html#ae2492e765f90454848fba297d5c447b5">02580</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#ae2492e765f90454848fba297d5c447b5" title="Displays operations that are available on results.">PMA_displayResultsOperations</a>($the_disp_mode, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>)
<a name="l02581"></a>02581 {
<a name="l02582"></a>02582     global <a class="code" href="schema__export_8php.html#a907d78797a1b764e913b0c565a5097b0" title="get all the export options and verify call and include the appropriate Schema Class depending on $exp...">$db</a>, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>, <a class="code" href="db__create_8php.html#a6ca9ccb878a51d945e0c234b5291329c" title="Builds and executes the db creation sql query.">$sql_query</a>, $unlim_num_rows, $fields_meta;
<a name="l02583"></a>02583 
<a name="l02584"></a>02584     $header_shown = <span class="keyword">false</span>;
<a name="l02585"></a>02585     $header = <span class="stringliteral">&#39;&lt;fieldset&gt;&lt;legend&gt;&#39;</span> . __(<span class="stringliteral">&#39;Query results operations&#39;</span>) . <span class="stringliteral">&#39;&lt;/legend&gt;&#39;</span>;
<a name="l02586"></a>02586 
<a name="l02587"></a>02587     <span class="keywordflow">if</span> ($the_disp_mode[6] == <span class="charliteral">&#39;1&#39;</span> || $the_disp_mode[9] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l02588"></a>02588         <span class="comment">// Displays &quot;printable view&quot; link if required</span>
<a name="l02589"></a>02589         <span class="keywordflow">if</span> ($the_disp_mode[9] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l02590"></a>02590 
<a name="l02591"></a>02591             <span class="keywordflow">if</span> (!$header_shown) {
<a name="l02592"></a>02592                 echo $header;
<a name="l02593"></a>02593                 $header_shown = <span class="keyword">true</span>;
<a name="l02594"></a>02594             }
<a name="l02595"></a>02595 
<a name="l02596"></a>02596             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l02597"></a>02597                 <span class="stringliteral">&#39;db&#39;</span>        =&gt; $db,
<a name="l02598"></a>02598                 <span class="stringliteral">&#39;table&#39;</span>     =&gt; $table,
<a name="l02599"></a>02599                 <span class="stringliteral">&#39;printview&#39;</span> =&gt; <span class="charliteral">&#39;1&#39;</span>,
<a name="l02600"></a>02600                 <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; $sql_query,
<a name="l02601"></a>02601             );
<a name="l02602"></a>02602             <a class="code" href="db__export_8php.html#a9f97d7db14905bd6ce32b003b416769c">$url_query</a> = <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>);
<a name="l02603"></a>02603 
<a name="l02604"></a>02604             echo <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>(
<a name="l02605"></a>02605                 <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="db__export_8php.html#a9f97d7db14905bd6ce32b003b416769c">$url_query</a>,
<a name="l02606"></a>02606                 <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_print.png&#39;</span>, __(<span class="stringliteral">&#39;Print view&#39;</span>), <span class="keyword">true</span>),
<a name="l02607"></a>02607                 <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="stringliteral">&#39;print_view&#39;</span>
<a name="l02608"></a>02608             ) . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02609"></a>02609 
<a name="l02610"></a>02610             <span class="keywordflow">if</span> (<a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_text&#39;</span>]) {
<a name="l02611"></a>02611                 <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;display_text&#39;</span>] = <span class="charliteral">&#39;F&#39;</span>;
<a name="l02612"></a>02612                 echo <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>(
<a name="l02613"></a>02613                     <span class="stringliteral">&#39;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>),
<a name="l02614"></a>02614                     <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_print.png&#39;</span>, __(<span class="stringliteral">&#39;Print view (with full texts)&#39;</span>), <span class="keyword">true</span>),
<a name="l02615"></a>02615                     <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="stringliteral">&#39;print_view&#39;</span>
<a name="l02616"></a>02616                 ) . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02617"></a>02617                 unset(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;display_text&#39;</span>]);
<a name="l02618"></a>02618             }
<a name="l02619"></a>02619         } <span class="comment">// end displays &quot;printable view&quot;</span>
<a name="l02620"></a>02620     }
<a name="l02621"></a>02621 
<a name="l02622"></a>02622     <span class="comment">// Export link</span>
<a name="l02623"></a>02623     <span class="comment">// (the url_query has extra parameters that won&#39;t be used to export)</span>
<a name="l02624"></a>02624     <span class="comment">// (the single_table parameter is used in display_export.lib.php</span>
<a name="l02625"></a>02625     <span class="comment">//  to hide the SQL and the structure export dialogs)</span>
<a name="l02626"></a>02626     <span class="comment">// If the parser found a PROCEDURE clause</span>
<a name="l02627"></a>02627     <span class="comment">// (most probably PROCEDURE ANALYSE()) it makes no sense to</span>
<a name="l02628"></a>02628     <span class="comment">// display the Export link).</span>
<a name="l02629"></a>02629     <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0]) &amp;&amp; <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;querytype&#39;</span>] == <span class="stringliteral">&#39;SELECT&#39;</span> &amp;&amp; ! isset($printview) &amp;&amp; ! isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;queryflags&#39;</span>][<span class="stringliteral">&#39;procedure&#39;</span>])) {
<a name="l02630"></a>02630         <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>][0][<span class="stringliteral">&#39;table_true_name&#39;</span>]) &amp;&amp; ! isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;table_ref&#39;</span>][1][<span class="stringliteral">&#39;table_true_name&#39;</span>])) {
<a name="l02631"></a>02631             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;single_table&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l02632"></a>02632         }
<a name="l02633"></a>02633         <span class="keywordflow">if</span> (!$header_shown) {
<a name="l02634"></a>02634             echo $header;
<a name="l02635"></a>02635             $header_shown = <span class="keyword">true</span>;
<a name="l02636"></a>02636         }
<a name="l02637"></a>02637         <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;unlim_num_rows&#39;</span>] = $unlim_num_rows;
<a name="l02638"></a>02638 <span class="comment"></span>
<a name="l02639"></a>02639 <span class="comment">        /**</span>
<a name="l02640"></a>02640 <span class="comment">         * At this point we don&#39;t know the table name; this can happen</span>
<a name="l02641"></a>02641 <span class="comment">         * for example with a query like</span>
<a name="l02642"></a>02642 <span class="comment">         * SELECT bike_code FROM (SELECT bike_code FROM bikes) tmp</span>
<a name="l02643"></a>02643 <span class="comment">         * As a workaround we set in the table parameter the name of the</span>
<a name="l02644"></a>02644 <span class="comment">         * first table of this database, so that tbl_export.php and</span>
<a name="l02645"></a>02645 <span class="comment">         * the script it calls do not fail</span>
<a name="l02646"></a>02646 <span class="comment">         */</span>
<a name="l02647"></a>02647         <span class="keywordflow">if</span> (empty(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;table&#39;</span>]) &amp;&amp; !empty(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;db&#39;</span>])) {
<a name="l02648"></a>02648             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;table&#39;</span>] = <a class="code" href="database__interface_8lib_8php.html#a772f12a953dd2908745bb16a8fa7b63a" title="returns a single value from the given result or query, if the query or the result has more than one r...">PMA_DBI_fetch_value</a>(<span class="stringliteral">&quot;SHOW TABLES&quot;</span>);
<a name="l02649"></a>02649             <span class="comment">/* No result (probably no database selected) */</span>
<a name="l02650"></a>02650             <span class="keywordflow">if</span> (<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;table&#39;</span>] === <span class="keyword">false</span>) {
<a name="l02651"></a>02651                 unset(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>[<span class="stringliteral">&#39;table&#39;</span>]);
<a name="l02652"></a>02652             }
<a name="l02653"></a>02653         }
<a name="l02654"></a>02654 
<a name="l02655"></a>02655         echo <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>(
<a name="l02656"></a>02656             <span class="stringliteral">&#39;tbl_export.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>),
<a name="l02657"></a>02657             <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_tblexport.png&#39;</span>, __(<span class="stringliteral">&#39;Export&#39;</span>), <span class="keyword">true</span>),
<a name="l02658"></a>02658             <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="stringliteral">&#39;&#39;</span>
<a name="l02659"></a>02659         ) . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02660"></a>02660 
<a name="l02661"></a>02661         <span class="comment">// show chart</span>
<a name="l02662"></a>02662         echo <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>(
<a name="l02663"></a>02663             <span class="stringliteral">&#39;tbl_chart.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>),
<a name="l02664"></a>02664             <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_chart.png&#39;</span>, __(<span class="stringliteral">&#39;Display chart&#39;</span>), <span class="keyword">true</span>),
<a name="l02665"></a>02665             <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="stringliteral">&#39;&#39;</span>
<a name="l02666"></a>02666         ) . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02667"></a>02667 
<a name="l02668"></a>02668         <span class="comment">// show GIS chart</span>
<a name="l02669"></a>02669         $geometry_found = <span class="keyword">false</span>;
<a name="l02670"></a>02670         <span class="comment">// If atleast one geometry field is found</span>
<a name="l02671"></a>02671         <span class="keywordflow">foreach</span> ($fields_meta as <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>) {
<a name="l02672"></a>02672             <span class="keywordflow">if</span> ($meta-&gt;type == <span class="stringliteral">&#39;geometry&#39;</span>) {
<a name="l02673"></a>02673                 $geometry_found = <span class="keyword">true</span>;
<a name="l02674"></a>02674                 <span class="keywordflow">break</span>;
<a name="l02675"></a>02675             }
<a name="l02676"></a>02676         }
<a name="l02677"></a>02677         <span class="keywordflow">if</span> ($geometry_found) {
<a name="l02678"></a>02678             echo <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>(
<a name="l02679"></a>02679                 <span class="stringliteral">&#39;tbl_gis_visualization.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>),
<a name="l02680"></a>02680                 <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_globe.gif&#39;</span>, __(<span class="stringliteral">&#39;Visualize GIS data&#39;</span>), <span class="keyword">true</span>),
<a name="l02681"></a>02681                 <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="stringliteral">&#39;&#39;</span>
<a name="l02682"></a>02682             ) . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02683"></a>02683         }
<a name="l02684"></a>02684     }
<a name="l02685"></a>02685 
<a name="l02686"></a>02686     <span class="comment">// CREATE VIEW</span><span class="comment"></span>
<a name="l02687"></a>02687 <span class="comment">    /**</span>
<a name="l02688"></a>02688 <span class="comment">     *</span>
<a name="l02689"></a>02689 <span class="comment">     * @todo detect privileges to create a view</span>
<a name="l02690"></a>02690 <span class="comment">     *       (but see 2006-01-19 note in display_create_table.lib.php,</span>
<a name="l02691"></a>02691 <span class="comment">     *        I think we cannot detect db-specific privileges reliably)</span>
<a name="l02692"></a>02692 <span class="comment">     * Note: we don&#39;t display a Create view link if we found a PROCEDURE clause</span>
<a name="l02693"></a>02693 <span class="comment">     */</span>
<a name="l02694"></a>02694     <span class="keywordflow">if</span> (!$header_shown) {
<a name="l02695"></a>02695         echo $header;
<a name="l02696"></a>02696         $header_shown = <span class="keyword">true</span>;
<a name="l02697"></a>02697     }
<a name="l02698"></a>02698     <span class="keywordflow">if</span> (!PMA_DRIZZLE &amp;&amp; !isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;queryflags&#39;</span>][<span class="stringliteral">&#39;procedure&#39;</span>])) {
<a name="l02699"></a>02699         echo <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>(
<a name="l02700"></a>02700             <span class="stringliteral">&#39;view_create.php&#39;</span> . <a class="code" href="db__export_8php.html#a9f97d7db14905bd6ce32b003b416769c">$url_query</a>,
<a name="l02701"></a>02701             <a class="code" href="common_8lib_8php.html#a73905c5a8a80014a8d299d0c74176316" title="Returns an HTML IMG tag for a particular icon from a theme, which may be an actual file or an icon fr...">PMA_getIcon</a>(<span class="stringliteral">&#39;b_views.png&#39;</span>, __(<span class="stringliteral">&#39;Create view&#39;</span>), <span class="keyword">true</span>),
<a name="l02702"></a>02702             <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="stringliteral">&#39;&#39;</span>
<a name="l02703"></a>02703         ) . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02704"></a>02704     }
<a name="l02705"></a>02705     <span class="keywordflow">if</span> ($header_shown) {
<a name="l02706"></a>02706         echo <span class="stringliteral">&#39;&lt;/fieldset&gt;&lt;br /&gt;&#39;</span>;
<a name="l02707"></a>02707     }
<a name="l02708"></a>02708 }
<a name="l02709"></a>02709 <span class="comment"></span>
<a name="l02710"></a>02710 <span class="comment">/**</span>
<a name="l02711"></a>02711 <span class="comment"> * Verifies what to do with non-printable contents (binary or BLOB)</span>
<a name="l02712"></a>02712 <span class="comment"> * in Browse mode.</span>
<a name="l02713"></a>02713 <span class="comment"> *</span>
<a name="l02714"></a>02714 <span class="comment"> * @param string $category           BLOB|BINARY|GEOMETRY</span>
<a name="l02715"></a>02715 <span class="comment"> * @param string $content            the binary content</span>
<a name="l02716"></a>02716 <span class="comment"> * @param string $transform_function transformation function</span>
<a name="l02717"></a>02717 <span class="comment"> * @param string $transform_options  transformation parameters</span>
<a name="l02718"></a>02718 <span class="comment"> * @param string $default_function   default transformation function</span>
<a name="l02719"></a>02719 <span class="comment"> * @param object $meta               the meta-information about this field</span>
<a name="l02720"></a>02720 <span class="comment"> * @param array  $url_params         parameters that should go to the download link</span>
<a name="l02721"></a>02721 <span class="comment"> *</span>
<a name="l02722"></a>02722 <span class="comment"> * @return  mixed  string or float</span>
<a name="l02723"></a>02723 <span class="comment"> */</span>
<a name="l02724"></a><a class="code" href="display__tbl_8lib_8php.html#adc2b985ffe56063359ca5c9b996518f9">02724</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#adc2b985ffe56063359ca5c9b996518f9" title="Verifies what to do with non-printable contents (binary or BLOB) in Browse mode.">PMA_handle_non_printable_contents</a>($category, <a class="code" href="bs__disp__as__mime__type_8php.html#a57b284fe00866494b33afa80ba729bed">$content</a>, $transform_function, $transform_options, $default_function, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, <a class="code" href="db__qbe_8php.html#a5bc4c60a2c2f6347a2f8c4e5847ebbfe">$url_params</a> = array())
<a name="l02725"></a>02725 {
<a name="l02726"></a>02726     <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <span class="charliteral">&#39;[&#39;</span> . $category;
<a name="l02727"></a>02727     <span class="keywordflow">if</span> (is_null(<a class="code" href="bs__disp__as__mime__type_8php.html#a57b284fe00866494b33afa80ba729bed">$content</a>)) {
<a name="l02728"></a>02728         <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= <span class="stringliteral">&#39; - NULL&#39;</span>;
<a name="l02729"></a>02729         $size = 0;
<a name="l02730"></a>02730     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> (isset(<a class="code" href="bs__disp__as__mime__type_8php.html#a57b284fe00866494b33afa80ba729bed">$content</a>)) {
<a name="l02731"></a>02731         $size = strlen(<a class="code" href="bs__disp__as__mime__type_8php.html#a57b284fe00866494b33afa80ba729bed">$content</a>);
<a name="l02732"></a>02732         $display_size = <a class="code" href="common_8lib_8php.html#a90de48fb0bb54fca6db6a407aa2ab8cf" title="Formats $value to byte view.">PMA_formatByteDown</a>($size, 3, 1);
<a name="l02733"></a>02733         <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= <span class="stringliteral">&#39; - &#39;</span>. $display_size[0] . <span class="charliteral">&#39; &#39;</span> . $display_size[1];
<a name="l02734"></a>02734     }
<a name="l02735"></a>02735     <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= <span class="charliteral">&#39;]&#39;</span>;
<a name="l02736"></a>02736 
<a name="l02737"></a>02737     <span class="keywordflow">if</span> (strpos($transform_function, <span class="stringliteral">&#39;octetstream&#39;</span>)) {
<a name="l02738"></a>02738         <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code" href="bs__disp__as__mime__type_8php.html#a57b284fe00866494b33afa80ba729bed">$content</a>;
<a name="l02739"></a>02739     }
<a name="l02740"></a>02740     <span class="keywordflow">if</span> ($size &gt; 0) {
<a name="l02741"></a>02741         <span class="keywordflow">if</span> ($default_function != $transform_function) {
<a name="l02742"></a>02742             <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = $transform_function(<a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>, $transform_options, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l02743"></a>02743         } <span class="keywordflow">else</span> {
<a name="l02744"></a>02744             <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = $default_function(<a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>, array(), <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l02745"></a>02745             <span class="keywordflow">if</span> (stristr(<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;type, <span class="stringliteral">&#39;BLOB&#39;</span>) &amp;&amp; <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;display_blob&#39;</span>]) {
<a name="l02746"></a>02746                 <span class="comment">// in this case, restart from the original $content</span>
<a name="l02747"></a>02747                 <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = htmlspecialchars(<a class="code" href="common_8lib_8php.html#ab1f3cd4bfc6d70701658e5e08bb89281" title="Replaces some characters by a displayable equivalent.">PMA_replace_binary_contents</a>(<a class="code" href="bs__disp__as__mime__type_8php.html#a57b284fe00866494b33afa80ba729bed">$content</a>));
<a name="l02748"></a>02748             }
<a name="l02749"></a>02749             <span class="comment">/* Create link to download */</span>
<a name="l02750"></a>02750             <span class="keywordflow">if</span> (count(<a class="code" href="db__qbe_8php.html#a5bc4c60a2c2f6347a2f8c4e5847ebbfe">$url_params</a>) &gt; 0) {
<a name="l02751"></a>02751                 <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <span class="stringliteral">&#39;&lt;a href=&quot;tbl_get_field.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__qbe_8php.html#a5bc4c60a2c2f6347a2f8c4e5847ebbfe">$url_params</a>) . <span class="stringliteral">&#39;&quot;&gt;&#39;</span> . <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> . <span class="stringliteral">&#39;&lt;/a&gt;&#39;</span>;
<a name="l02752"></a>02752             }
<a name="l02753"></a>02753         }
<a name="l02754"></a>02754     }
<a name="l02755"></a>02755     <span class="keywordflow">return</span>(<a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>);
<a name="l02756"></a>02756 }
<a name="l02757"></a>02757 <span class="comment"></span>
<a name="l02758"></a>02758 <span class="comment">/**</span>
<a name="l02759"></a>02759 <span class="comment"> * Prepares the displayable content of a data cell in Browse mode,</span>
<a name="l02760"></a>02760 <span class="comment"> * taking into account foreign key description field and transformations</span>
<a name="l02761"></a>02761 <span class="comment"> *</span>
<a name="l02762"></a>02762 <span class="comment"> * @param string $class              css classes for the td element</span>
<a name="l02763"></a>02763 <span class="comment"> * @param bool   $condition_field    whether the column is a part of the where clause</span>
<a name="l02764"></a>02764 <span class="comment"> * @param string $analyzed_sql       the analyzed query</span>
<a name="l02765"></a>02765 <span class="comment"> * @param object $meta               the meta-information about this field</span>
<a name="l02766"></a>02766 <span class="comment"> * @param array  $map                the list of relations</span>
<a name="l02767"></a>02767 <span class="comment"> * @param string $data               data</span>
<a name="l02768"></a>02768 <span class="comment"> * @param string $transform_function transformation function</span>
<a name="l02769"></a>02769 <span class="comment"> * @param string $default_function   default function</span>
<a name="l02770"></a>02770 <span class="comment"> * @param string $nowrap             &#39;nowrap&#39; if the content should not be wrapped</span>
<a name="l02771"></a>02771 <span class="comment"> * @param string $where_comparison   data for the where cluase</span>
<a name="l02772"></a>02772 <span class="comment"> * @param array  $transform_options  array of options for transformation</span>
<a name="l02773"></a>02773 <span class="comment"> * @param bool   $is_field_truncated whether the field is truncated</span>
<a name="l02774"></a>02774 <span class="comment"> *</span>
<a name="l02775"></a>02775 <span class="comment"> * @return  string  formatted data</span>
<a name="l02776"></a>02776 <span class="comment"> */</span>
<a name="l02777"></a><a class="code" href="display__tbl_8lib_8php.html#a6ed2d818c168866b38b4b2486ddf66fd">02777</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a6ed2d818c168866b38b4b2486ddf66fd" title="Prepares the displayable content of a data cell in Browse mode, taking into account foreign key descr...">PMA_prepare_row_data</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $map, <a class="code" href="video__wall_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>, $transform_function, $default_function, $nowrap, $where_comparison, $transform_options, $is_field_truncated )
<a name="l02778"></a>02778 {
<a name="l02779"></a>02779 
<a name="l02780"></a>02780     <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <span class="stringliteral">&#39; class=&quot;&#39;</span> . <a class="code" href="display__tbl_8lib_8php.html#aa0260dfab206a823cd024ac7074044cd" title="Adds the relavant classes.">PMA_addClass</a>(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $condition_field, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>, $nowrap, $is_field_truncated, $transform_function, $default_function) . <span class="stringliteral">&#39;&quot;&gt;&#39;</span>;
<a name="l02781"></a>02781 
<a name="l02782"></a>02782     <span class="keywordflow">if</span> (isset(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;select_expr&#39;</span>]) &amp;&amp; is_array(<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;select_expr&#39;</span>])) {
<a name="l02783"></a>02783         <span class="keywordflow">foreach</span> (<a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;select_expr&#39;</span>] AS $select_expr_position =&gt; $select_expr) {
<a name="l02784"></a>02784             $alias = <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;select_expr&#39;</span>][$select_expr_position][<span class="stringliteral">&#39;alias&#39;</span>];
<a name="l02785"></a>02785             <span class="keywordflow">if</span> (isset($alias) &amp;&amp; strlen($alias)) {
<a name="l02786"></a>02786                 $true_column = <a class="code" href="parse__analyze_8lib_8php.html#a824c9acbe2515006ceb0ebd880983104">$analyzed_sql</a>[0][<span class="stringliteral">&#39;select_expr&#39;</span>][$select_expr_position][<span class="stringliteral">&#39;column&#39;</span>];
<a name="l02787"></a>02787                 <span class="keywordflow">if</span> ($alias == <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name) {
<a name="l02788"></a>02788                     <span class="comment">// this change in the parameter does not matter</span>
<a name="l02789"></a>02789                     <span class="comment">// outside of the function</span>
<a name="l02790"></a>02790                     <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name = $true_column;
<a name="l02791"></a>02791                 } <span class="comment">// end if</span>
<a name="l02792"></a>02792             } <span class="comment">// end if</span>
<a name="l02793"></a>02793         } <span class="comment">// end foreach</span>
<a name="l02794"></a>02794     } <span class="comment">// end if</span>
<a name="l02795"></a>02795 
<a name="l02796"></a>02796     <span class="keywordflow">if</span> (isset($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name])) {
<a name="l02797"></a>02797         <span class="comment">// Field to display from the foreign table?</span>
<a name="l02798"></a>02798         <span class="keywordflow">if</span> (isset($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][2]) &amp;&amp; strlen($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][2])) {
<a name="l02799"></a>02799             $dispsql     = <span class="stringliteral">&#39;SELECT &#39;</span> . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][2])
<a name="l02800"></a>02800                 . <span class="stringliteral">&#39; FROM &#39;</span> . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][3])
<a name="l02801"></a>02801                 . <span class="charliteral">&#39;.&#39;</span> . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][0])
<a name="l02802"></a>02802                 . <span class="stringliteral">&#39; WHERE &#39;</span> . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][1])
<a name="l02803"></a>02803                 . $where_comparison;
<a name="l02804"></a>02804             $dispresult  = <a class="code" href="database__interface_8lib_8php.html#af4f8622d2f5df7858e4e6ca425ac0274" title="runs a query and returns the result">PMA_DBI_try_query</a>($dispsql, null, <a class="code" href="database__interface_8lib_8php.html#a77bfb86197a8bde52b8e52b2dff26993" title="Force STORE_RESULT method, ignored by classic MySQL.">PMA_DBI_QUERY_STORE</a>);
<a name="l02805"></a>02805             <span class="keywordflow">if</span> ($dispresult &amp;&amp; <a class="code" href="drizzle_8dbi_8lib_8php.html#ad3805f1da9fe87cc10e96acf0710d803" title="returns the number of rows returned by last query">PMA_DBI_num_rows</a>($dispresult) &gt; 0) {
<a name="l02806"></a>02806                 list($dispval) = <a class="code" href="drizzle_8dbi_8lib_8php.html#a76a677a68b562828af0dfe4467107d31" title="returns array of rows with numeric keys from $result">PMA_DBI_fetch_row</a>($dispresult, 0);
<a name="l02807"></a>02807             } <span class="keywordflow">else</span> {
<a name="l02808"></a>02808                 $dispval = __(<span class="stringliteral">&#39;Link not found&#39;</span>);
<a name="l02809"></a>02809             }
<a name="l02810"></a>02810             @<a class="code" href="drizzle_8dbi_8lib_8php.html#a69ffa6649f3460798f5d0db03f1e2a5a" title="Frees memory associated with the result.">PMA_DBI_free_result</a>($dispresult);
<a name="l02811"></a>02811         } <span class="keywordflow">else</span> {
<a name="l02812"></a>02812             $dispval     = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02813"></a>02813         } <span class="comment">// end if... else...</span>
<a name="l02814"></a>02814 
<a name="l02815"></a>02815         <span class="keywordflow">if</span> (isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>]) &amp;&amp; <a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;printview&#39;</span>] == <span class="charliteral">&#39;1&#39;</span>) {
<a name="l02816"></a>02816             <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= ($transform_function != $default_function ? $transform_function(<a class="code" href="video__wall_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>, $transform_options, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>) : $transform_function(<a class="code" href="video__wall_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>, array(), <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>)) . <span class="stringliteral">&#39; &lt;code&gt;[-&amp;gt;&#39;</span> . $dispval . <span class="stringliteral">&#39;]&lt;/code&gt;&#39;</span>;
<a name="l02817"></a>02817         } <span class="keywordflow">else</span> {
<a name="l02818"></a>02818 
<a name="l02819"></a>02819             <span class="keywordflow">if</span> (<span class="charliteral">&#39;K&#39;</span> == <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;relational_display&#39;</span>]) {
<a name="l02820"></a>02820                 <span class="comment">// user chose &quot;relational key&quot; in the display options, so</span>
<a name="l02821"></a>02821                 <span class="comment">// the title contains the display field</span>
<a name="l02822"></a>02822                 <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a> = (! empty($dispval))? <span class="stringliteral">&#39; title=&quot;&#39;</span> . htmlspecialchars($dispval) . <span class="charliteral">&#39;&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>;
<a name="l02823"></a>02823             } <span class="keywordflow">else</span> {
<a name="l02824"></a>02824                 <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a> = <span class="stringliteral">&#39; title=&quot;&#39;</span> . htmlspecialchars(<a class="code" href="video__wall_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>) . <span class="charliteral">&#39;&quot;&#39;</span>;
<a name="l02825"></a>02825             }
<a name="l02826"></a>02826 
<a name="l02827"></a>02827             <a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a> = array(
<a name="l02828"></a>02828                 <span class="stringliteral">&#39;db&#39;</span>    =&gt; $map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][3],
<a name="l02829"></a>02829                 <span class="stringliteral">&#39;table&#39;</span> =&gt; $map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][0],
<a name="l02830"></a>02830                 <span class="stringliteral">&#39;pos&#39;</span>   =&gt; <span class="charliteral">&#39;0&#39;</span>,
<a name="l02831"></a>02831                 <span class="stringliteral">&#39;sql_query&#39;</span> =&gt; <span class="stringliteral">&#39;SELECT * FROM &#39;</span>
<a name="l02832"></a>02832                                     . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][3]) . <span class="charliteral">&#39;.&#39;</span> . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][0])
<a name="l02833"></a>02833                                     . <span class="stringliteral">&#39; WHERE &#39;</span> . <a class="code" href="common_8lib_8php.html#a81c4628f679a153bb4475c5ee2ae49ec" title="Adds backquotes on both sides of a database, table or field name.">PMA_backquote</a>($map[<a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>-&gt;name][1])
<a name="l02834"></a>02834                                     . $where_comparison,
<a name="l02835"></a>02835             );
<a name="l02836"></a>02836             <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= <span class="stringliteral">&#39;&lt;a href=&quot;sql.php&#39;</span> . <a class="code" href="url__generating_8lib_8php.html#ad5c0cfef7cb600a158a1ef5fa321a094" title="Generates text with URL parameters.">PMA_generate_common_url</a>(<a class="code" href="db__structure_8php.html#a7456a2a86083cf908c8a435b70417f35">$_url_params</a>)
<a name="l02837"></a>02837                  . <span class="charliteral">&#39;&quot;&#39;</span> . <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a> . <span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l02838"></a>02838 
<a name="l02839"></a>02839             <span class="keywordflow">if</span> ($transform_function != $default_function) {
<a name="l02840"></a>02840                 <span class="comment">// always apply a transformation on the real data,</span>
<a name="l02841"></a>02841                 <span class="comment">// not on the display field</span>
<a name="l02842"></a>02842                 <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= $transform_function(<a class="code" href="video__wall_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>, $transform_options, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l02843"></a>02843             } <span class="keywordflow">else</span> {
<a name="l02844"></a>02844                 <span class="keywordflow">if</span> (<span class="charliteral">&#39;D&#39;</span> == <a class="code" href="wab_8php.html#a7e78406241b519489b23a8c902b4a8de">$_SESSION</a>[<span class="stringliteral">&#39;tmp_user_values&#39;</span>][<span class="stringliteral">&#39;relational_display&#39;</span>]) {
<a name="l02845"></a>02845                     <span class="comment">// user chose &quot;relational display field&quot; in the</span>
<a name="l02846"></a>02846                     <span class="comment">// display options, so show display field in the cell</span>
<a name="l02847"></a>02847                     <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= $transform_function($dispval, array(), <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l02848"></a>02848                 } <span class="keywordflow">else</span> {
<a name="l02849"></a>02849                     <span class="comment">// otherwise display data in the cell</span>
<a name="l02850"></a>02850                     <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= $transform_function(<a class="code" href="video__wall_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>, array(), <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>);
<a name="l02851"></a>02851                 }
<a name="l02852"></a>02852             }
<a name="l02853"></a>02853             <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= <span class="stringliteral">&#39;&lt;/a&gt;&#39;</span>;
<a name="l02854"></a>02854         }
<a name="l02855"></a>02855     } <span class="keywordflow">else</span> {
<a name="l02856"></a>02856         <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= ($transform_function != $default_function ? $transform_function(<a class="code" href="video__wall_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>, $transform_options, <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>) : $transform_function(<a class="code" href="video__wall_8php.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>, array(), <a class="code" href="tbl__gis__visualization_8php.html#a9e6fc1ae0498be7d1e682f8bcc9299df">$meta</a>));
<a name="l02857"></a>02857     }
<a name="l02858"></a>02858     <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a> .= <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span> . <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02859"></a>02859 
<a name="l02860"></a>02860     <span class="keywordflow">return</span> <a class="code" href="link__out_8php.html#a112ef069ddc0454086e3d1e6d8d55d07">$result</a>;
<a name="l02861"></a>02861 }
<a name="l02862"></a>02862 <span class="comment"></span>
<a name="l02863"></a>02863 <span class="comment">/**</span>
<a name="l02864"></a>02864 <span class="comment"> * Generates a checkbox for multi-row submits</span>
<a name="l02865"></a>02865 <span class="comment"> *</span>
<a name="l02866"></a>02866 <span class="comment"> * @param string $del_url           delete url</span>
<a name="l02867"></a>02867 <span class="comment"> * @param array  $is_display        array with explicit indexes for all the display elements</span>
<a name="l02868"></a>02868 <span class="comment"> * @param string $row_no            the row number</span>
<a name="l02869"></a>02869 <span class="comment"> * @param string $where_clause_html url encoded where cluase</span>
<a name="l02870"></a>02870 <span class="comment"> * @param array  $condition_array   array of conditions in the where cluase</span>
<a name="l02871"></a>02871 <span class="comment"> * @param string $del_query         delete query</span>
<a name="l02872"></a>02872 <span class="comment"> * @param string $id_suffix         suffix for the id</span>
<a name="l02873"></a>02873 <span class="comment"> * @param string $class             css classes for the td element</span>
<a name="l02874"></a>02874 <span class="comment"> *</span>
<a name="l02875"></a>02875 <span class="comment"> * @return  string  the generated HTML</span>
<a name="l02876"></a>02876 <span class="comment"> */</span>
<a name="l02877"></a>02877 
<a name="l02878"></a><a class="code" href="display__tbl_8lib_8php.html#adbb911bbbf6db3506a49ad5989ee758e">02878</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#adbb911bbbf6db3506a49ad5989ee758e" title="Generates a checkbox for multi-row submits.">PMA_generateCheckboxForMulti</a>($del_url, $is_display, $row_no, $where_clause_html, $condition_array, $del_query, $id_suffix, <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>)
<a name="l02879"></a>02879 {
<a name="l02880"></a>02880     $ret = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02881"></a>02881     <span class="keywordflow">if</span> (! empty($del_url) &amp;&amp; $is_display[<span class="stringliteral">&#39;del_lnk&#39;</span>] != <span class="stringliteral">&#39;kp&#39;</span>) {
<a name="l02882"></a>02882         $ret .= <span class="stringliteral">&#39;&lt;td &#39;</span>;
<a name="l02883"></a>02883         <span class="keywordflow">if</span> (! empty(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>)) {
<a name="l02884"></a>02884             $ret .= <span class="stringliteral">&#39;class=&quot;&#39;</span> . <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> . <span class="charliteral">&#39;&quot;&#39;</span>;
<a name="l02885"></a>02885         }
<a name="l02886"></a>02886         $ret .= <span class="stringliteral">&#39; align=&quot;center&quot;&gt;&#39;</span>
<a name="l02887"></a>02887            . <span class="stringliteral">&#39;&lt;input type=&quot;checkbox&quot; id=&quot;id_rows_to_delete&#39;</span> . $row_no . $id_suffix . <span class="stringliteral">&#39;&quot; name=&quot;rows_to_delete[&#39;</span> . $where_clause_html . <span class="stringliteral">&#39;]&quot;&#39;</span>
<a name="l02888"></a>02888            . <span class="stringliteral">&#39; class=&quot;multi_checkbox&quot;&#39;</span>
<a name="l02889"></a>02889            . <span class="stringliteral">&#39; value=&quot;&#39;</span> . htmlspecialchars($del_query) . <span class="stringliteral">&#39;&quot; &#39;</span> . (isset(<a class="code" href="config_2config_8php.html#aad108a6abffdea835bc6cc2f3244751e">$GLOBALS</a>[<span class="stringliteral">&#39;checkall&#39;</span>]) ? <span class="stringliteral">&#39;checked=&quot;checked&quot;&#39;</span> : <span class="stringliteral">&#39;&#39;</span>) . <span class="stringliteral">&#39; /&gt;&#39;</span>
<a name="l02890"></a>02890            . <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; class=&quot;condition_array&quot; value=&quot;&#39;</span> . htmlspecialchars(json_encode($condition_array)) . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>
<a name="l02891"></a>02891            . <span class="stringliteral">&#39;    &lt;/td&gt;&#39;</span>;
<a name="l02892"></a>02892     }
<a name="l02893"></a>02893     <span class="keywordflow">return</span> $ret;
<a name="l02894"></a>02894 }
<a name="l02895"></a>02895 <span class="comment"></span>
<a name="l02896"></a>02896 <span class="comment">/**</span>
<a name="l02897"></a>02897 <span class="comment"> * Generates an Edit link</span>
<a name="l02898"></a>02898 <span class="comment"> *</span>
<a name="l02899"></a>02899 <span class="comment"> * @param string $edit_url          edit url</span>
<a name="l02900"></a>02900 <span class="comment"> * @param string $class             css classes for td element</span>
<a name="l02901"></a>02901 <span class="comment"> * @param string $edit_str          text for the edit link</span>
<a name="l02902"></a>02902 <span class="comment"> * @param string $where_clause      where cluase</span>
<a name="l02903"></a>02903 <span class="comment"> * @param string $where_clause_html url encoded where cluase</span>
<a name="l02904"></a>02904 <span class="comment"> *</span>
<a name="l02905"></a>02905 <span class="comment"> * @return  string  the generated HTML</span>
<a name="l02906"></a>02906 <span class="comment"> */</span>
<a name="l02907"></a><a class="code" href="display__tbl_8lib_8php.html#a190ba11500e9a695a3ca69237db6bfd5">02907</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#a190ba11500e9a695a3ca69237db6bfd5" title="Generates an Edit link.">PMA_generateEditLink</a>($edit_url, <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $edit_str, $where_clause, $where_clause_html)
<a name="l02908"></a>02908 {
<a name="l02909"></a>02909     $ret = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02910"></a>02910     <span class="keywordflow">if</span> (! empty($edit_url)) {
<a name="l02911"></a>02911         $ret .= <span class="stringliteral">&#39;&lt;td class=&quot;&#39;</span> . <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> . <span class="stringliteral">&#39;&quot; align=&quot;center&quot; &#39;</span> . <span class="stringliteral">&#39; &gt;&lt;span class=&quot;nowrap&quot;&gt;&#39;</span>
<a name="l02912"></a>02912            . <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>($edit_url, $edit_str, array(), <span class="keyword">false</span>);
<a name="l02913"></a>02913         <span class="comment">/*</span>
<a name="l02914"></a>02914 <span class="comment">         * Where clause for selecting this row uniquely is provided as</span>
<a name="l02915"></a>02915 <span class="comment">         * a hidden input. Used by jQuery scripts for handling grid editing</span>
<a name="l02916"></a>02916 <span class="comment">         */</span>
<a name="l02917"></a>02917         <span class="keywordflow">if</span> (! empty($where_clause)) {
<a name="l02918"></a>02918             $ret .= <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; class=&quot;where_clause&quot; value =&quot;&#39;</span> . $where_clause_html . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l02919"></a>02919         }
<a name="l02920"></a>02920         $ret .= <span class="stringliteral">&#39;&lt;/span&gt;&lt;/td&gt;&#39;</span>;
<a name="l02921"></a>02921     }
<a name="l02922"></a>02922     <span class="keywordflow">return</span> $ret;
<a name="l02923"></a>02923 }
<a name="l02924"></a>02924 <span class="comment"></span>
<a name="l02925"></a>02925 <span class="comment">/**</span>
<a name="l02926"></a>02926 <span class="comment"> * Generates an Copy link</span>
<a name="l02927"></a>02927 <span class="comment"> *</span>
<a name="l02928"></a>02928 <span class="comment"> * @param string $copy_url          copy url</span>
<a name="l02929"></a>02929 <span class="comment"> * @param string $copy_str          text for the copy link</span>
<a name="l02930"></a>02930 <span class="comment"> * @param string $where_clause      where clause</span>
<a name="l02931"></a>02931 <span class="comment"> * @param string $where_clause_html url encoded where cluase</span>
<a name="l02932"></a>02932 <span class="comment"> * @param string $class             css classes for the td element</span>
<a name="l02933"></a>02933 <span class="comment"> *</span>
<a name="l02934"></a>02934 <span class="comment"> * @return  string  the generated HTML</span>
<a name="l02935"></a>02935 <span class="comment"> */</span>
<a name="l02936"></a><a class="code" href="display__tbl_8lib_8php.html#adc1b5b053b31424721b0fd20834628dd">02936</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#adc1b5b053b31424721b0fd20834628dd" title="Generates an Copy link.">PMA_generateCopyLink</a>($copy_url, $copy_str, $where_clause, $where_clause_html, <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>)
<a name="l02937"></a>02937 {
<a name="l02938"></a>02938     $ret = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02939"></a>02939     <span class="keywordflow">if</span> (! empty($copy_url)) {
<a name="l02940"></a>02940         $ret .= <span class="stringliteral">&#39;&lt;td &#39;</span>;
<a name="l02941"></a>02941         <span class="keywordflow">if</span> (! empty(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>)) {
<a name="l02942"></a>02942             $ret .= <span class="stringliteral">&#39;class=&quot;&#39;</span> . <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> . <span class="stringliteral">&#39;&quot; &#39;</span>;
<a name="l02943"></a>02943         }
<a name="l02944"></a>02944         $ret .= <span class="stringliteral">&#39;align=&quot;center&quot; &#39;</span> . <span class="stringliteral">&#39; &gt;&lt;span class=&quot;nowrap&quot;&gt;&#39;</span>
<a name="l02945"></a>02945            . <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>($copy_url, $copy_str, array(), <span class="keyword">false</span>);
<a name="l02946"></a>02946         <span class="comment">/*</span>
<a name="l02947"></a>02947 <span class="comment">         * Where clause for selecting this row uniquely is provided as</span>
<a name="l02948"></a>02948 <span class="comment">         * a hidden input. Used by jQuery scripts for handling grid editing</span>
<a name="l02949"></a>02949 <span class="comment">         */</span>
<a name="l02950"></a>02950         <span class="keywordflow">if</span> (! empty($where_clause)) {
<a name="l02951"></a>02951             $ret .= <span class="stringliteral">&#39;&lt;input type=&quot;hidden&quot; class=&quot;where_clause&quot; value =&quot;&#39;</span> . $where_clause_html . <span class="stringliteral">&#39;&quot; /&gt;&#39;</span>;
<a name="l02952"></a>02952         }
<a name="l02953"></a>02953         $ret .= <span class="stringliteral">&#39;&lt;/span&gt;&lt;/td&gt;&#39;</span>;
<a name="l02954"></a>02954     }
<a name="l02955"></a>02955     <span class="keywordflow">return</span> $ret;
<a name="l02956"></a>02956 }
<a name="l02957"></a>02957 <span class="comment"></span>
<a name="l02958"></a>02958 <span class="comment">/**</span>
<a name="l02959"></a>02959 <span class="comment"> * Generates a Delete link</span>
<a name="l02960"></a>02960 <span class="comment"> *</span>
<a name="l02961"></a>02961 <span class="comment"> * @param string $del_url delete url</span>
<a name="l02962"></a>02962 <span class="comment"> * @param string $del_str text for the delete link</span>
<a name="l02963"></a>02963 <span class="comment"> * @param string $js_conf text for the JS confirmation</span>
<a name="l02964"></a>02964 <span class="comment"> * @param string $class   css classes for the td element</span>
<a name="l02965"></a>02965 <span class="comment"> *</span>
<a name="l02966"></a>02966 <span class="comment"> * @return  string  the generated HTML</span>
<a name="l02967"></a>02967 <span class="comment"> */</span>
<a name="l02968"></a><a class="code" href="display__tbl_8lib_8php.html#af7694e01ef98776d596b3a5a86b4f028">02968</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#af7694e01ef98776d596b3a5a86b4f028" title="Generates a Delete link.">PMA_generateDeleteLink</a>($del_url, $del_str, $js_conf, <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>)
<a name="l02969"></a>02969 {
<a name="l02970"></a>02970     $ret = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02971"></a>02971     <span class="keywordflow">if</span> (! empty($del_url)) {
<a name="l02972"></a>02972         $ret .= <span class="stringliteral">&#39;&lt;td &#39;</span>;
<a name="l02973"></a>02973         <span class="keywordflow">if</span> (! empty(<a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>)) {
<a name="l02974"></a>02974             $ret .= <span class="stringliteral">&#39;class=&quot;&#39;</span> . <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> . <span class="stringliteral">&#39;&quot; &#39;</span>;
<a name="l02975"></a>02975         }
<a name="l02976"></a>02976         $ret .= <span class="stringliteral">&#39;align=&quot;center&quot; &#39;</span> . <span class="stringliteral">&#39; &gt;&#39;</span>
<a name="l02977"></a>02977            . <a class="code" href="common_8lib_8php.html#a59beb470df32fdd938f89fab0f1dc7a8" title="Displays a link, or a button if the link&#39;s URL is too large, to accommodate some browsers&#39; limitation...">PMA_linkOrButton</a>($del_url, $del_str, $js_conf, <span class="keyword">false</span>)
<a name="l02978"></a>02978            . <span class="stringliteral">&#39;&lt;/td&gt;&#39;</span>;
<a name="l02979"></a>02979     }
<a name="l02980"></a>02980     <span class="keywordflow">return</span> $ret;
<a name="l02981"></a>02981 }
<a name="l02982"></a>02982 <span class="comment"></span>
<a name="l02983"></a>02983 <span class="comment">/**</span>
<a name="l02984"></a>02984 <span class="comment"> * Generates checkbox and links at some position (left or right)</span>
<a name="l02985"></a>02985 <span class="comment"> * (only called for horizontal mode)</span>
<a name="l02986"></a>02986 <span class="comment"> *</span>
<a name="l02987"></a>02987 <span class="comment"> * @param string $position          the position of the checkbox and links</span>
<a name="l02988"></a>02988 <span class="comment"> * @param string $del_url           delete url</span>
<a name="l02989"></a>02989 <span class="comment"> * @param array  $is_display        array with explicit indexes for all the display elements</span>
<a name="l02990"></a>02990 <span class="comment"> * @param string $row_no            row number</span>
<a name="l02991"></a>02991 <span class="comment"> * @param string $where_clause      where clause</span>
<a name="l02992"></a>02992 <span class="comment"> * @param string $where_clause_html url encoded where cluase</span>
<a name="l02993"></a>02993 <span class="comment"> * @param array  $condition_array   array of conditions in the where cluase</span>
<a name="l02994"></a>02994 <span class="comment"> * @param string $del_query         delete query</span>
<a name="l02995"></a>02995 <span class="comment"> * @param string $id_suffix         suffix for the id</span>
<a name="l02996"></a>02996 <span class="comment"> * @param string $edit_url          edit url</span>
<a name="l02997"></a>02997 <span class="comment"> * @param string $copy_url          copy url</span>
<a name="l02998"></a>02998 <span class="comment"> * @param string $class             css classes for the td elements</span>
<a name="l02999"></a>02999 <span class="comment"> * @param string $edit_str          text for the edit link</span>
<a name="l03000"></a>03000 <span class="comment"> * @param string $copy_str          text for the copy link</span>
<a name="l03001"></a>03001 <span class="comment"> * @param string $del_str           text for the delete link</span>
<a name="l03002"></a>03002 <span class="comment"> * @param string $js_conf           text for the JS confirmation</span>
<a name="l03003"></a>03003 <span class="comment"> *</span>
<a name="l03004"></a>03004 <span class="comment"> * @return  string  the generated HTML</span>
<a name="l03005"></a>03005 <span class="comment"> */</span>
<a name="l03006"></a><a class="code" href="display__tbl_8lib_8php.html#aa2941a0e12aa16299a69a68c06c1ef12">03006</a> <span class="keyword">function</span> <a class="code" href="display__tbl_8lib_8php.html#aa2941a0e12aa16299a69a68c06c1ef12" title="Generates checkbox and links at some position (left or right) (only called for horizontal mode)...">PMA_generateCheckboxAndLinks</a>($position, $del_url, $is_display, $row_no, $where_clause, $where_clause_html, $condition_array, $del_query, $id_suffix, $edit_url, $copy_url, <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $edit_str, $copy_str, $del_str, $js_conf)
<a name="l03007"></a>03007 {
<a name="l03008"></a>03008     $ret = <span class="stringliteral">&#39;&#39;</span>;
<a name="l03009"></a>03009 
<a name="l03010"></a>03010     <span class="keywordflow">if</span> ($position == <span class="stringliteral">&#39;left&#39;</span>) {
<a name="l03011"></a>03011         $ret .= <a class="code" href="display__tbl_8lib_8php.html#adbb911bbbf6db3506a49ad5989ee758e" title="Generates a checkbox for multi-row submits.">PMA_generateCheckboxForMulti</a>($del_url, $is_display, $row_no, $where_clause_html, $condition_array, $del_query, $id_suffix = <span class="stringliteral">&#39;_left&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l03012"></a>03012 
<a name="l03013"></a>03013         $ret .= <a class="code" href="display__tbl_8lib_8php.html#a190ba11500e9a695a3ca69237db6bfd5" title="Generates an Edit link.">PMA_generateEditLink</a>($edit_url, <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $edit_str, $where_clause, $where_clause_html, <span class="stringliteral">&#39;&#39;</span>);
<a name="l03014"></a>03014 
<a name="l03015"></a>03015         $ret .= <a class="code" href="display__tbl_8lib_8php.html#adc1b5b053b31424721b0fd20834628dd" title="Generates an Copy link.">PMA_generateCopyLink</a>($copy_url, $copy_str, $where_clause, $where_clause_html, <span class="stringliteral">&#39;&#39;</span>);
<a name="l03016"></a>03016 
<a name="l03017"></a>03017         $ret .= <a class="code" href="display__tbl_8lib_8php.html#af7694e01ef98776d596b3a5a86b4f028" title="Generates a Delete link.">PMA_generateDeleteLink</a>($del_url, $del_str, $js_conf, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l03018"></a>03018 
<a name="l03019"></a>03019     } <a class="code" href="import_8php.html#a7cbb4f0532e284397800df76c439983e">elseif</a> ($position == <span class="stringliteral">&#39;right&#39;</span>) {
<a name="l03020"></a>03020         $ret .= <a class="code" href="display__tbl_8lib_8php.html#af7694e01ef98776d596b3a5a86b4f028" title="Generates a Delete link.">PMA_generateDeleteLink</a>($del_url, $del_str, $js_conf, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l03021"></a>03021 
<a name="l03022"></a>03022         $ret .= <a class="code" href="display__tbl_8lib_8php.html#adc1b5b053b31424721b0fd20834628dd" title="Generates an Copy link.">PMA_generateCopyLink</a>($copy_url, $copy_str, $where_clause, $where_clause_html, <span class="stringliteral">&#39;&#39;</span>);
<a name="l03023"></a>03023 
<a name="l03024"></a>03024         $ret .= <a class="code" href="display__tbl_8lib_8php.html#a190ba11500e9a695a3ca69237db6bfd5" title="Generates an Edit link.">PMA_generateEditLink</a>($edit_url, <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>, $edit_str, $where_clause, $where_clause_html, <span class="stringliteral">&#39;&#39;</span>);
<a name="l03025"></a>03025 
<a name="l03026"></a>03026         $ret .= <a class="code" href="display__tbl_8lib_8php.html#adbb911bbbf6db3506a49ad5989ee758e" title="Generates a checkbox for multi-row submits.">PMA_generateCheckboxForMulti</a>($del_url, $is_display, $row_no, $where_clause_html, $condition_array, $del_query, $id_suffix = <span class="stringliteral">&#39;_right&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l03027"></a>03027     } <span class="keywordflow">else</span> { <span class="comment">// $position == &#39;none&#39;</span>
<a name="l03028"></a>03028         $ret .= <a class="code" href="display__tbl_8lib_8php.html#adbb911bbbf6db3506a49ad5989ee758e" title="Generates a checkbox for multi-row submits.">PMA_generateCheckboxForMulti</a>($del_url, $is_display, $row_no, $where_clause_html, $condition_array, $del_query, $id_suffix = <span class="stringliteral">&#39;_left&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l03029"></a>03029     }
<a name="l03030"></a>03030     <span class="keywordflow">return</span> $ret;
<a name="l03031"></a>03031 }
<a name="l03032"></a>03032 ?&gt;
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="display__tbl_8lib_8php.html">display_tbl.lib.php</a>      </li>

    <li class="footer">Generated on Fri Mar 14 2014 04:14:49 for RFSCMSAPIDocumentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
