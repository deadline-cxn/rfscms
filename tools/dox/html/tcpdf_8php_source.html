<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>RFSCMSAPIDocumentation: tcpdf.php Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">RFSCMSAPIDocumentation
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('tcpdf_8php.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">tcpdf.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="tcpdf_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 <span class="comment">//============================================================+</span>
<a name="l00003"></a>00003 <span class="comment">// File name   : tcpdf.php</span>
<a name="l00004"></a>00004 <span class="comment">// Version     : 5.9.145</span>
<a name="l00005"></a>00005 <span class="comment">// Begin       : 2002-08-03</span>
<a name="l00006"></a>00006 <span class="comment">// Last Update : 2012-01-28</span>
<a name="l00007"></a>00007 <span class="comment">// Author      : Nicola Asuni - Tecnick.com LTD - Manor Coach House, Church Hill, Aldershot, Hants, GU12 4RQ, UK - www.tecnick.com - info@tecnick.com</span>
<a name="l00008"></a>00008 <span class="comment">// License     : http://www.tecnick.com/pagefiles/tcpdf/LICENSE.TXT GNU-LGPLv3</span>
<a name="l00009"></a>00009 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00010"></a>00010 <span class="comment">// Copyright (C) 2002-2012 Nicola Asuni - Tecnick.com LTD</span>
<a name="l00011"></a>00011 <span class="comment">//</span>
<a name="l00012"></a>00012 <span class="comment">// This file is part of TCPDF software library.</span>
<a name="l00013"></a>00013 <span class="comment">//</span>
<a name="l00014"></a>00014 <span class="comment">// TCPDF is free software: you can redistribute it and/or modify it</span>
<a name="l00015"></a>00015 <span class="comment">// under the terms of the GNU Lesser General Public License as</span>
<a name="l00016"></a>00016 <span class="comment">// published by the Free Software Foundation, either version 3 of the</span>
<a name="l00017"></a>00017 <span class="comment">// License, or (at your option) any later version.</span>
<a name="l00018"></a>00018 <span class="comment">//</span>
<a name="l00019"></a>00019 <span class="comment">// TCPDF is distributed in the hope that it will be useful, but</span>
<a name="l00020"></a>00020 <span class="comment">// WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00021"></a>00021 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<a name="l00022"></a>00022 <span class="comment">// See the GNU Lesser General Public License for more details.</span>
<a name="l00023"></a>00023 <span class="comment">//</span>
<a name="l00024"></a>00024 <span class="comment">// You should have received a copy of the License</span>
<a name="l00025"></a>00025 <span class="comment">// along with TCPDF. If not, see</span>
<a name="l00026"></a>00026 <span class="comment">// &lt;http://www.tecnick.com/pagefiles/tcpdf/LICENSE.TXT&gt;.</span>
<a name="l00027"></a>00027 <span class="comment">//</span>
<a name="l00028"></a>00028 <span class="comment">// See LICENSE.TXT file for more information.</span>
<a name="l00029"></a>00029 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00030"></a>00030 <span class="comment">//</span>
<a name="l00031"></a>00031 <span class="comment">// Description :</span>
<a name="l00032"></a>00032 <span class="comment">//   This is a PHP class for generating PDF documents without requiring external extensions.</span>
<a name="l00033"></a>00033 <span class="comment">//</span>
<a name="l00034"></a>00034 <span class="comment">// NOTE:</span>
<a name="l00035"></a>00035 <span class="comment">//   This class was originally derived in 2002 from the Public</span>
<a name="l00036"></a>00036 <span class="comment">//   Domain FPDF class by Olivier Plathey (http://www.fpdf.org),</span>
<a name="l00037"></a>00037 <span class="comment">//   but now is almost entirely rewritten and contains thousands of</span>
<a name="l00038"></a>00038 <span class="comment">//   new lines of code and hundreds new features.</span>
<a name="l00039"></a>00039 <span class="comment">//</span>
<a name="l00040"></a>00040 <span class="comment">// Main features:</span>
<a name="l00041"></a>00041 <span class="comment">//  * no external libraries are required for the basic functions;</span>
<a name="l00042"></a>00042 <span class="comment">//  * all standard page formats, custom page formats, custom margins and units of measure;</span>
<a name="l00043"></a>00043 <span class="comment">//  * UTF-8 Unicode and Right-To-Left languages;</span>
<a name="l00044"></a>00044 <span class="comment">//  * TrueTypeUnicode, TrueType, Type1 and CID-0 fonts;</span>
<a name="l00045"></a>00045 <span class="comment">//  * font subsetting;</span>
<a name="l00046"></a>00046 <span class="comment">//  * methods to publish some XHTML + CSS code, Javascript and Forms;</span>
<a name="l00047"></a>00047 <span class="comment">//  * images, graphic (geometric figures) and transformation methods;</span>
<a name="l00048"></a>00048 <span class="comment">//  * supports JPEG, PNG and SVG images natively, all images supported by GD (GD, GD2, GD2PART, GIF, JPEG, PNG, BMP, XBM, XPM) and all images supported via ImagMagick (http://www.imagemagick.org/www/formats.html)</span>
<a name="l00049"></a>00049 <span class="comment">//  * 1D and 2D barcodes: CODE 39, ANSI MH10.8M-1983, USD-3, 3 of 9, CODE 93, USS-93, Standard 2 of 5, Interleaved 2 of 5, CODE 128 A/B/C, 2 and 5 Digits UPC-Based Extention, EAN 8, EAN 13, UPC-A, UPC-E, MSI, POSTNET, PLANET, RMS4CC (Royal Mail 4-state Customer Code), CBC (Customer Bar Code), KIX (Klant index - Customer index), Intelligent Mail Barcode, Onecode, USPS-B-3200, CODABAR, CODE 11, PHARMACODE, PHARMACODE TWO-TRACKS, Datamatrix, QR-Code, PDF417;</span>
<a name="l00050"></a>00050 <span class="comment">//  * JPEG and PNG ICC profiles, Grayscale, RGB, CMYK, Spot Colors and Transparencies;</span>
<a name="l00051"></a>00051 <span class="comment">//  * automatic page header and footer management;</span>
<a name="l00052"></a>00052 <span class="comment">//  * document encryption up to 256 bit and digital signature certifications;</span>
<a name="l00053"></a>00053 <span class="comment">//  * transactions to UNDO commands;</span>
<a name="l00054"></a>00054 <span class="comment">//  * PDF annotations, including links, text and file attachments;</span>
<a name="l00055"></a>00055 <span class="comment">//  * text rendering modes (fill, stroke and clipping);</span>
<a name="l00056"></a>00056 <span class="comment">//  * multiple columns mode;</span>
<a name="l00057"></a>00057 <span class="comment">//  * no-write page regions;</span>
<a name="l00058"></a>00058 <span class="comment">//  * bookmarks, named destinations and table of content;</span>
<a name="l00059"></a>00059 <span class="comment">//  * text hyphenation;</span>
<a name="l00060"></a>00060 <span class="comment">//  * text stretching and spacing (tracking/kerning);</span>
<a name="l00061"></a>00061 <span class="comment">//  * automatic page break, line break and text alignments including justification;</span>
<a name="l00062"></a>00062 <span class="comment">//  * automatic page numbering and page groups;</span>
<a name="l00063"></a>00063 <span class="comment">//  * move and delete pages;</span>
<a name="l00064"></a>00064 <span class="comment">//  * page compression (requires php-zlib extension);</span>
<a name="l00065"></a>00065 <span class="comment">//  * XOBject Templates;</span>
<a name="l00066"></a>00066 <span class="comment">//  * Layers and object visibility.</span>
<a name="l00067"></a>00067 <span class="comment">//  * PDF/A-1b support.</span>
<a name="l00068"></a>00068 <span class="comment">//</span>
<a name="l00069"></a>00069 <span class="comment">// -----------------------------------------------------------</span>
<a name="l00070"></a>00070 <span class="comment">// THANKS TO:</span>
<a name="l00071"></a>00071 <span class="comment">//</span>
<a name="l00072"></a>00072 <span class="comment">// Olivier Plathey (http://www.fpdf.org) for original FPDF.</span>
<a name="l00073"></a>00073 <span class="comment">// Efthimios Mavrogeorgiadis (emavro@yahoo.com) for suggestions on RTL language support.</span>
<a name="l00074"></a>00074 <span class="comment">// Klemen Vodopivec (http://www.fpdf.de/downloads/addons/37/) for Encryption algorithm.</span>
<a name="l00075"></a>00075 <span class="comment">// Warren Sherliker (wsherliker@gmail.com) for better image handling.</span>
<a name="l00076"></a>00076 <span class="comment">// dullus for text Justification.</span>
<a name="l00077"></a>00077 <span class="comment">// Bob Vincent (pillarsdotnet@users.sourceforge.net) for &lt;li&gt; value attribute.</span>
<a name="l00078"></a>00078 <span class="comment">// Patrick Benny for text stretch suggestion on Cell().</span>
<a name="l00079"></a>00079 <span class="comment">// Johannes Güntert for JavaScript support.</span>
<a name="l00080"></a>00080 <span class="comment">// Denis Van Nuffelen for Dynamic Form.</span>
<a name="l00081"></a>00081 <span class="comment">// Jacek Czekaj for multibyte justification</span>
<a name="l00082"></a>00082 <span class="comment">// Anthony Ferrara for the reintroduction of legacy image methods.</span>
<a name="l00083"></a>00083 <span class="comment">// Sourceforge user 1707880 (hucste) for line-trough mode.</span>
<a name="l00084"></a>00084 <span class="comment">// Larry Stanbery for page groups.</span>
<a name="l00085"></a>00085 <span class="comment">// Martin Hall-May for transparency.</span>
<a name="l00086"></a>00086 <span class="comment">// Aaron C. Spike for Polycurve method.</span>
<a name="l00087"></a>00087 <span class="comment">// Mohamad Ali Golkar, Saleh AlMatrafe, Charles Abbott for Arabic and Persian support.</span>
<a name="l00088"></a>00088 <span class="comment">// Moritz Wagner and Andreas Wurmser for graphic functions.</span>
<a name="l00089"></a>00089 <span class="comment">// Andrew Whitehead for core fonts support.</span>
<a name="l00090"></a>00090 <span class="comment">// Esteban Joël Marín for OpenType font conversion.</span>
<a name="l00091"></a>00091 <span class="comment">// Teus Hagen for several suggestions and fixes.</span>
<a name="l00092"></a>00092 <span class="comment">// Yukihiro Nakadaira for CID-0 CJK fonts fixes.</span>
<a name="l00093"></a>00093 <span class="comment">// Kosmas Papachristos for some CSS improvements.</span>
<a name="l00094"></a>00094 <span class="comment">// Marcel Partap for some fixes.</span>
<a name="l00095"></a>00095 <span class="comment">// Won Kyu Park for several suggestions, fixes and patches.</span>
<a name="l00096"></a>00096 <span class="comment">// Dominik Dzienia for QR-code support.</span>
<a name="l00097"></a>00097 <span class="comment">// Laurent Minguet for some suggestions.</span>
<a name="l00098"></a>00098 <span class="comment">// Christian Deligant for some suggestions and fixes.</span>
<a name="l00099"></a>00099 <span class="comment">// Travis Harris for crop mark suggestion.</span>
<a name="l00100"></a>00100 <span class="comment">// Anyone that has reported a bug or sent a suggestion.</span>
<a name="l00101"></a>00101 <span class="comment">//============================================================+</span>
<a name="l00102"></a>00102 <span class="comment"></span>
<a name="l00103"></a>00103 <span class="comment">/**</span>
<a name="l00104"></a>00104 <span class="comment"> * @file</span>
<a name="l00105"></a>00105 <span class="comment"> * This is a PHP class for generating PDF documents without requiring external extensions.&lt;br&gt;</span>
<a name="l00106"></a>00106 <span class="comment"> * TCPDF project (http://www.tcpdf.org) was originally derived in 2002 from the Public Domain FPDF class by Olivier Plathey (http://www.fpdf.org), but now is almost entirely rewritten.&lt;br&gt;</span>
<a name="l00107"></a>00107 <span class="comment"> * &lt;h3&gt;TCPDF main features are:&lt;/h3&gt;</span>
<a name="l00108"></a>00108 <span class="comment"> * &lt;ul&gt;</span>
<a name="l00109"></a>00109 <span class="comment"> * &lt;li&gt;no external libraries are required for the basic functions;&lt;/li&gt;</span>
<a name="l00110"></a>00110 <span class="comment"> * &lt;li&gt;all standard page formats, custom page formats, custom margins and units of measure;&lt;/li&gt;</span>
<a name="l00111"></a>00111 <span class="comment"> * &lt;li&gt;UTF-8 Unicode and Right-To-Left languages;&lt;/li&gt;</span>
<a name="l00112"></a>00112 <span class="comment"> * &lt;li&gt;TrueTypeUnicode, TrueType, Type1 and CID-0 fonts;&lt;/li&gt;</span>
<a name="l00113"></a>00113 <span class="comment"> * &lt;li&gt;font subsetting;&lt;/li&gt;</span>
<a name="l00114"></a>00114 <span class="comment"> * &lt;li&gt;methods to publish some XHTML + CSS code, Javascript and Forms;&lt;/li&gt;</span>
<a name="l00115"></a>00115 <span class="comment"> * &lt;li&gt;images, graphic (geometric figures) and transformation methods;</span>
<a name="l00116"></a>00116 <span class="comment"> * &lt;li&gt;supports JPEG, PNG and SVG images natively, all images supported by GD (GD, GD2, GD2PART, GIF, JPEG, PNG, BMP, XBM, XPM) and all images supported via ImagMagick (http://www.imagemagick.org/www/formats.html)&lt;/li&gt;</span>
<a name="l00117"></a>00117 <span class="comment"> * &lt;li&gt;1D and 2D barcodes: CODE 39, ANSI MH10.8M-1983, USD-3, 3 of 9, CODE 93, USS-93, Standard 2 of 5, Interleaved 2 of 5, CODE 128 A/B/C, 2 and 5 Digits UPC-Based Extention, EAN 8, EAN 13, UPC-A, UPC-E, MSI, POSTNET, PLANET, RMS4CC (Royal Mail 4-state Customer Code), CBC (Customer Bar Code), KIX (Klant index - Customer index), Intelligent Mail Barcode, Onecode, USPS-B-3200, CODABAR, CODE 11, PHARMACODE, PHARMACODE TWO-TRACKS, Datamatrix, QR-Code, PDF417;&lt;/li&gt;</span>
<a name="l00118"></a>00118 <span class="comment"> * &lt;li&gt;JPEG and PNG ICC profiles, Grayscale, RGB, CMYK, Spot Colors and Transparencies;&lt;/li&gt;</span>
<a name="l00119"></a>00119 <span class="comment"> * &lt;li&gt;automatic page header and footer management;&lt;/li&gt;</span>
<a name="l00120"></a>00120 <span class="comment"> * &lt;li&gt;document encryption up to 256 bit and digital signature certifications;&lt;/li&gt;</span>
<a name="l00121"></a>00121 <span class="comment"> * &lt;li&gt;transactions to UNDO commands;&lt;/li&gt;</span>
<a name="l00122"></a>00122 <span class="comment"> * &lt;li&gt;PDF annotations, including links, text and file attachments;&lt;/li&gt;</span>
<a name="l00123"></a>00123 <span class="comment"> * &lt;li&gt;text rendering modes (fill, stroke and clipping);&lt;/li&gt;</span>
<a name="l00124"></a>00124 <span class="comment"> * &lt;li&gt;multiple columns mode;&lt;/li&gt;</span>
<a name="l00125"></a>00125 <span class="comment"> * &lt;li&gt;no-write page regions;&lt;/li&gt;</span>
<a name="l00126"></a>00126 <span class="comment"> * &lt;li&gt;bookmarks, named destinations and table of content;&lt;/li&gt;</span>
<a name="l00127"></a>00127 <span class="comment"> * &lt;li&gt;text hyphenation;&lt;/li&gt;</span>
<a name="l00128"></a>00128 <span class="comment"> * &lt;li&gt;text stretching and spacing (tracking/kerning);&lt;/li&gt;</span>
<a name="l00129"></a>00129 <span class="comment"> * &lt;li&gt;automatic page break, line break and text alignments including justification;&lt;/li&gt;</span>
<a name="l00130"></a>00130 <span class="comment"> * &lt;li&gt;automatic page numbering and page groups;&lt;/li&gt;</span>
<a name="l00131"></a>00131 <span class="comment"> * &lt;li&gt;move and delete pages;&lt;/li&gt;</span>
<a name="l00132"></a>00132 <span class="comment"> * &lt;li&gt;page compression (requires php-zlib extension);&lt;/li&gt;</span>
<a name="l00133"></a>00133 <span class="comment"> * &lt;li&gt;XOBject Templates;&lt;/li&gt;</span>
<a name="l00134"></a>00134 <span class="comment"> * &lt;li&gt;Layers and object visibility;&lt;/li&gt;</span>
<a name="l00135"></a>00135 <span class="comment"> * &lt;li&gt;PDF/A-1b support.&lt;/li&gt;</span>
<a name="l00136"></a>00136 <span class="comment"> * &lt;/ul&gt;</span>
<a name="l00137"></a>00137 <span class="comment"> * Tools to encode your unicode fonts are on fonts/utils directory.&lt;/p&gt;</span>
<a name="l00138"></a>00138 <span class="comment"> * @package com.tecnick.tcpdf</span>
<a name="l00139"></a>00139 <span class="comment"> * @author Nicola Asuni</span>
<a name="l00140"></a>00140 <span class="comment"> * @version 5.9.145</span>
<a name="l00141"></a>00141 <span class="comment"> */</span>
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 <span class="comment">// Main configuration file. Define the K_TCPDF_EXTERNAL_CONFIG constant to skip this file.</span>
<a name="l00144"></a>00144 require_once(dirname(__FILE__).<span class="stringliteral">&#39;/config/tcpdf_config.php&#39;</span>);
<a name="l00145"></a>00145 <span class="comment"></span>
<a name="l00146"></a>00146 <span class="comment">/**</span>
<a name="l00147"></a>00147 <span class="comment"> * @class TCPDF</span>
<a name="l00148"></a>00148 <span class="comment"> * PHP class for generating PDF documents without requiring external extensions.</span>
<a name="l00149"></a>00149 <span class="comment"> * TCPDF project (http://www.tcpdf.org) has been originally derived in 2002 from the Public Domain FPDF class by Olivier Plathey (http://www.fpdf.org), but now is almost entirely rewritten.&lt;br&gt;</span>
<a name="l00150"></a>00150 <span class="comment"> * @package com.tecnick.tcpdf</span>
<a name="l00151"></a>00151 <span class="comment"> * @brief PHP class for generating PDF documents without requiring external extensions.</span>
<a name="l00152"></a>00152 <span class="comment"> * @version 5.9.145</span>
<a name="l00153"></a>00153 <span class="comment"> * @author Nicola Asuni - info@tecnick.com</span>
<a name="l00154"></a>00154 <span class="comment"> */</span>
<a name="l00155"></a><a class="code" href="classTCPDF.html">00155</a> <span class="keyword">class </span><a class="code" href="classTCPDF.html" title="PHP class for generating PDF documents without requiring external extensions.">TCPDF</a> {
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <span class="comment">// private properties</span>
<a name="l00158"></a>00158 <span class="comment"></span>
<a name="l00159"></a>00159 <span class="comment">    /**</span>
<a name="l00160"></a>00160 <span class="comment">     * Current TCPDF version.</span>
<a name="l00161"></a>00161 <span class="comment">     * @private</span>
<a name="l00162"></a>00162 <span class="comment">     */</span>
<a name="l00163"></a><a class="code" href="classTCPDF.html#a77febbc49ecb2b4b008ed929e1c38a9f">00163</a>     <span class="keyword">private</span> <a class="code" href="classTCPDF.html#a77febbc49ecb2b4b008ed929e1c38a9f" title="Current TCPDF version.">$tcpdf_version</a> = <span class="stringliteral">&#39;5.9.145&#39;</span>;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165     <span class="comment">// Protected properties</span>
<a name="l00166"></a>00166 <span class="comment"></span>
<a name="l00167"></a>00167 <span class="comment">    /**</span>
<a name="l00168"></a>00168 <span class="comment">     * Current page number.</span>
<a name="l00169"></a>00169 <span class="comment">     * @protected</span>
<a name="l00170"></a>00170 <span class="comment">     */</span>
<a name="l00171"></a><a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">00171</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>;
<a name="l00172"></a>00172 <span class="comment"></span>
<a name="l00173"></a>00173 <span class="comment">    /**</span>
<a name="l00174"></a>00174 <span class="comment">     * Current object number.</span>
<a name="l00175"></a>00175 <span class="comment">     * @protected</span>
<a name="l00176"></a>00176 <span class="comment">     */</span>
<a name="l00177"></a><a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">00177</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>;
<a name="l00178"></a>00178 <span class="comment"></span>
<a name="l00179"></a>00179 <span class="comment">    /**</span>
<a name="l00180"></a>00180 <span class="comment">     * Array of object offsets.</span>
<a name="l00181"></a>00181 <span class="comment">     * @protected</span>
<a name="l00182"></a>00182 <span class="comment">     */</span>
<a name="l00183"></a><a class="code" href="classTCPDF.html#af34383b2ad0cda65b8327d62065afdbc">00183</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#af34383b2ad0cda65b8327d62065afdbc" title="Array of object offsets.">$offsets</a>;
<a name="l00184"></a>00184 <span class="comment"></span>
<a name="l00185"></a>00185 <span class="comment">    /**</span>
<a name="l00186"></a>00186 <span class="comment">     * Buffer holding in-memory PDF.</span>
<a name="l00187"></a>00187 <span class="comment">     * @protected</span>
<a name="l00188"></a>00188 <span class="comment">     */</span>
<a name="l00189"></a><a class="code" href="classTCPDF.html#a61840390b5ae16c58b1b6bd6b060af46">00189</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a61840390b5ae16c58b1b6bd6b060af46" title="Buffer holding in-memory PDF.">$buffer</a>;
<a name="l00190"></a>00190 <span class="comment"></span>
<a name="l00191"></a>00191 <span class="comment">    /**</span>
<a name="l00192"></a>00192 <span class="comment">     * Array containing pages.</span>
<a name="l00193"></a>00193 <span class="comment">     * @protected</span>
<a name="l00194"></a>00194 <span class="comment">     */</span>
<a name="l00195"></a><a class="code" href="classTCPDF.html#abb8b93313ba45826395085b42bffdab8">00195</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abb8b93313ba45826395085b42bffdab8" title="Array containing pages.">$pages</a> = array();
<a name="l00196"></a>00196 <span class="comment"></span>
<a name="l00197"></a>00197 <span class="comment">    /**</span>
<a name="l00198"></a>00198 <span class="comment">     * Current document state.</span>
<a name="l00199"></a>00199 <span class="comment">     * @protected</span>
<a name="l00200"></a>00200 <span class="comment">     */</span>
<a name="l00201"></a><a class="code" href="classTCPDF.html#ae950ca495f922385c27c6ded218c3cfa">00201</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae950ca495f922385c27c6ded218c3cfa" title="Current document state.">$state</a>;
<a name="l00202"></a>00202 <span class="comment"></span>
<a name="l00203"></a>00203 <span class="comment">    /**</span>
<a name="l00204"></a>00204 <span class="comment">     * Compression flag.</span>
<a name="l00205"></a>00205 <span class="comment">     * @protected</span>
<a name="l00206"></a>00206 <span class="comment">     */</span>
<a name="l00207"></a><a class="code" href="classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">00207</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0" title="Compression flag.">$compress</a>;
<a name="l00208"></a>00208 <span class="comment"></span>
<a name="l00209"></a>00209 <span class="comment">    /**</span>
<a name="l00210"></a>00210 <span class="comment">     * Current page orientation (P = Portrait, L = Landscape).</span>
<a name="l00211"></a>00211 <span class="comment">     * @protected</span>
<a name="l00212"></a>00212 <span class="comment">     */</span>
<a name="l00213"></a><a class="code" href="classTCPDF.html#abdf07c1c5b4fb70b3ed325031d187257">00213</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abdf07c1c5b4fb70b3ed325031d187257" title="Current page orientation (P = Portrait, L = Landscape).">$CurOrientation</a>;
<a name="l00214"></a>00214 <span class="comment"></span>
<a name="l00215"></a>00215 <span class="comment">    /**</span>
<a name="l00216"></a>00216 <span class="comment">     * Page dimensions.</span>
<a name="l00217"></a>00217 <span class="comment">     * @protected</span>
<a name="l00218"></a>00218 <span class="comment">     */</span>
<a name="l00219"></a><a class="code" href="classTCPDF.html#a50525de041ad2206e3a360bc99dabd19">00219</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a50525de041ad2206e3a360bc99dabd19" title="Page dimensions.">$pagedim</a> = array();
<a name="l00220"></a>00220 <span class="comment"></span>
<a name="l00221"></a>00221 <span class="comment">    /**</span>
<a name="l00222"></a>00222 <span class="comment">     * Scale factor (number of points in user unit).</span>
<a name="l00223"></a>00223 <span class="comment">     * @protected</span>
<a name="l00224"></a>00224 <span class="comment">     */</span>
<a name="l00225"></a><a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">00225</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>;
<a name="l00226"></a>00226 <span class="comment"></span>
<a name="l00227"></a>00227 <span class="comment">    /**</span>
<a name="l00228"></a>00228 <span class="comment">     * Width of page format in points.</span>
<a name="l00229"></a>00229 <span class="comment">     * @protected</span>
<a name="l00230"></a>00230 <span class="comment">     */</span>
<a name="l00231"></a><a class="code" href="classTCPDF.html#a2b9dd5ea5f109626189153dadd12f680">00231</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a2b9dd5ea5f109626189153dadd12f680" title="Width of page format in points.">$fwPt</a>;
<a name="l00232"></a>00232 <span class="comment"></span>
<a name="l00233"></a>00233 <span class="comment">    /**</span>
<a name="l00234"></a>00234 <span class="comment">     * Height of page format in points.</span>
<a name="l00235"></a>00235 <span class="comment">     * @protected</span>
<a name="l00236"></a>00236 <span class="comment">     */</span>
<a name="l00237"></a><a class="code" href="classTCPDF.html#a48d90dc02b21b040d95122abf89a2b18">00237</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a48d90dc02b21b040d95122abf89a2b18" title="Height of page format in points.">$fhPt</a>;
<a name="l00238"></a>00238 <span class="comment"></span>
<a name="l00239"></a>00239 <span class="comment">    /**</span>
<a name="l00240"></a>00240 <span class="comment">     * Current width of page in points.</span>
<a name="l00241"></a>00241 <span class="comment">     * @protected</span>
<a name="l00242"></a>00242 <span class="comment">     */</span>
<a name="l00243"></a><a class="code" href="classTCPDF.html#ab5675888a7271f898545886b4c3277c3">00243</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab5675888a7271f898545886b4c3277c3" title="Current width of page in points.">$wPt</a>;
<a name="l00244"></a>00244 <span class="comment"></span>
<a name="l00245"></a>00245 <span class="comment">    /**</span>
<a name="l00246"></a>00246 <span class="comment">     * Current height of page in points.</span>
<a name="l00247"></a>00247 <span class="comment">     * @protected</span>
<a name="l00248"></a>00248 <span class="comment">     */</span>
<a name="l00249"></a><a class="code" href="classTCPDF.html#a7965ee64ad21a3c638933ae96cb23f94">00249</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7965ee64ad21a3c638933ae96cb23f94" title="Current height of page in points.">$hPt</a>;
<a name="l00250"></a>00250 <span class="comment"></span>
<a name="l00251"></a>00251 <span class="comment">    /**</span>
<a name="l00252"></a>00252 <span class="comment">     * Current width of page in user unit.</span>
<a name="l00253"></a>00253 <span class="comment">     * @protected</span>
<a name="l00254"></a>00254 <span class="comment">     */</span>
<a name="l00255"></a><a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514">00255</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l00256"></a>00256 <span class="comment"></span>
<a name="l00257"></a>00257 <span class="comment">    /**</span>
<a name="l00258"></a>00258 <span class="comment">     * Current height of page in user unit.</span>
<a name="l00259"></a>00259 <span class="comment">     * @protected</span>
<a name="l00260"></a>00260 <span class="comment">     */</span>
<a name="l00261"></a><a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">00261</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l00262"></a>00262 <span class="comment"></span>
<a name="l00263"></a>00263 <span class="comment">    /**</span>
<a name="l00264"></a>00264 <span class="comment">     * Left margin.</span>
<a name="l00265"></a>00265 <span class="comment">     * @protected</span>
<a name="l00266"></a>00266 <span class="comment">     */</span>
<a name="l00267"></a><a class="code" href="classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">00267</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da" title="Left margin.">$lMargin</a>;
<a name="l00268"></a>00268 <span class="comment"></span>
<a name="l00269"></a>00269 <span class="comment">    /**</span>
<a name="l00270"></a>00270 <span class="comment">     * Top margin.</span>
<a name="l00271"></a>00271 <span class="comment">     * @protected</span>
<a name="l00272"></a>00272 <span class="comment">     */</span>
<a name="l00273"></a><a class="code" href="classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">00273</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7" title="Top margin.">$tMargin</a>;
<a name="l00274"></a>00274 <span class="comment"></span>
<a name="l00275"></a>00275 <span class="comment">    /**</span>
<a name="l00276"></a>00276 <span class="comment">     * Right margin.</span>
<a name="l00277"></a>00277 <span class="comment">     * @protected</span>
<a name="l00278"></a>00278 <span class="comment">     */</span>
<a name="l00279"></a><a class="code" href="classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">00279</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9" title="Right margin.">$rMargin</a>;
<a name="l00280"></a>00280 <span class="comment"></span>
<a name="l00281"></a>00281 <span class="comment">    /**</span>
<a name="l00282"></a>00282 <span class="comment">     * Page break margin.</span>
<a name="l00283"></a>00283 <span class="comment">     * @protected</span>
<a name="l00284"></a>00284 <span class="comment">     */</span>
<a name="l00285"></a><a class="code" href="classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">00285</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b" title="Page break margin.">$bMargin</a>;
<a name="l00286"></a>00286 <span class="comment"></span>
<a name="l00287"></a>00287 <span class="comment">    /**</span>
<a name="l00288"></a>00288 <span class="comment">     * Array of cell internal paddings (&#39;T&#39; =&gt; top, &#39;R&#39; =&gt; right, &#39;B&#39; =&gt; bottom, &#39;L&#39; =&gt; left).</span>
<a name="l00289"></a>00289 <span class="comment">     * @since 5.9.000 (2010-10-03)</span>
<a name="l00290"></a>00290 <span class="comment">     * @protected</span>
<a name="l00291"></a>00291 <span class="comment">     */</span>
<a name="l00292"></a><a class="code" href="classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">00292</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59" title="Array of cell internal paddings (&#39;T&#39; =&gt; top, &#39;R&#39; =&gt; right, &#39;B&#39; =&gt; bottom, &#39;L&#39; =&gt; left).">$cell_padding</a> = array(<span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0, <span class="charliteral">&#39;L&#39;</span> =&gt; 0);
<a name="l00293"></a>00293 <span class="comment"></span>
<a name="l00294"></a>00294 <span class="comment">    /**</span>
<a name="l00295"></a>00295 <span class="comment">     * Array of cell margins (&#39;T&#39; =&gt; top, &#39;R&#39; =&gt; right, &#39;B&#39; =&gt; bottom, &#39;L&#39; =&gt; left).</span>
<a name="l00296"></a>00296 <span class="comment">     * @since 5.9.000 (2010-10-04)</span>
<a name="l00297"></a>00297 <span class="comment">     * @protected</span>
<a name="l00298"></a>00298 <span class="comment">     */</span>
<a name="l00299"></a><a class="code" href="classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">00299</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77" title="Array of cell margins (&#39;T&#39; =&gt; top, &#39;R&#39; =&gt; right, &#39;B&#39; =&gt; bottom, &#39;L&#39; =&gt; left).">$cell_margin</a> = array(<span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0, <span class="charliteral">&#39;L&#39;</span> =&gt; 0);
<a name="l00300"></a>00300 <span class="comment"></span>
<a name="l00301"></a>00301 <span class="comment">    /**</span>
<a name="l00302"></a>00302 <span class="comment">     * Current horizontal position in user unit for cell positioning.</span>
<a name="l00303"></a>00303 <span class="comment">     * @protected</span>
<a name="l00304"></a>00304 <span class="comment">     */</span>
<a name="l00305"></a><a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734">00305</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l00306"></a>00306 <span class="comment"></span>
<a name="l00307"></a>00307 <span class="comment">    /**</span>
<a name="l00308"></a>00308 <span class="comment">     * Current vertical position in user unit for cell positioning.</span>
<a name="l00309"></a>00309 <span class="comment">     * @protected</span>
<a name="l00310"></a>00310 <span class="comment">     */</span>
<a name="l00311"></a><a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">00311</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>;
<a name="l00312"></a>00312 <span class="comment"></span>
<a name="l00313"></a>00313 <span class="comment">    /**</span>
<a name="l00314"></a>00314 <span class="comment">     * Height of last cell printed.</span>
<a name="l00315"></a>00315 <span class="comment">     * @protected</span>
<a name="l00316"></a>00316 <span class="comment">     */</span>
<a name="l00317"></a><a class="code" href="classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">00317</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a41e87b05a84dd56c2c824af49470e295" title="Height of last cell printed.">$lasth</a>;
<a name="l00318"></a>00318 <span class="comment"></span>
<a name="l00319"></a>00319 <span class="comment">    /**</span>
<a name="l00320"></a>00320 <span class="comment">     * Line width in user unit.</span>
<a name="l00321"></a>00321 <span class="comment">     * @protected</span>
<a name="l00322"></a>00322 <span class="comment">     */</span>
<a name="l00323"></a><a class="code" href="classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">00323</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5971d565157974939d3edf96baeb0eeb" title="Line width in user unit.">$LineWidth</a>;
<a name="l00324"></a>00324 <span class="comment"></span>
<a name="l00325"></a>00325 <span class="comment">    /**</span>
<a name="l00326"></a>00326 <span class="comment">     * Array of standard font names.</span>
<a name="l00327"></a>00327 <span class="comment">     * @protected</span>
<a name="l00328"></a>00328 <span class="comment">     */</span>
<a name="l00329"></a><a class="code" href="classTCPDF.html#a0ba200eb136effe5ff79cafed3f0fd92">00329</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a0ba200eb136effe5ff79cafed3f0fd92" title="Array of standard font names.">$CoreFonts</a>;
<a name="l00330"></a>00330 <span class="comment"></span>
<a name="l00331"></a>00331 <span class="comment">    /**</span>
<a name="l00332"></a>00332 <span class="comment">     * Array of used fonts.</span>
<a name="l00333"></a>00333 <span class="comment">     * @protected</span>
<a name="l00334"></a>00334 <span class="comment">     */</span>
<a name="l00335"></a><a class="code" href="classTCPDF.html#acbeb582e8fb3a6771c5d7c1279966ddb">00335</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#acbeb582e8fb3a6771c5d7c1279966ddb" title="Array of used fonts.">$fonts</a> = array();
<a name="l00336"></a>00336 <span class="comment"></span>
<a name="l00337"></a>00337 <span class="comment">    /**</span>
<a name="l00338"></a>00338 <span class="comment">     * Array of font files.</span>
<a name="l00339"></a>00339 <span class="comment">     * @protected</span>
<a name="l00340"></a>00340 <span class="comment">     */</span>
<a name="l00341"></a><a class="code" href="classTCPDF.html#a514d8fa634d23eac396e0b4471acccba">00341</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a514d8fa634d23eac396e0b4471acccba" title="Array of font files.">$FontFiles</a> = array();
<a name="l00342"></a>00342 <span class="comment"></span>
<a name="l00343"></a>00343 <span class="comment">    /**</span>
<a name="l00344"></a>00344 <span class="comment">     * Array of encoding differences.</span>
<a name="l00345"></a>00345 <span class="comment">     * @protected</span>
<a name="l00346"></a>00346 <span class="comment">     */</span>
<a name="l00347"></a><a class="code" href="classTCPDF.html#a73e52ac5a6301ce1ea8a6b1a9fc45e71">00347</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a73e52ac5a6301ce1ea8a6b1a9fc45e71" title="Array of encoding differences.">$diffs</a> = array();
<a name="l00348"></a>00348 <span class="comment"></span>
<a name="l00349"></a>00349 <span class="comment">    /**</span>
<a name="l00350"></a>00350 <span class="comment">     * Array of used images.</span>
<a name="l00351"></a>00351 <span class="comment">     * @protected</span>
<a name="l00352"></a>00352 <span class="comment">     */</span>
<a name="l00353"></a><a class="code" href="classTCPDF.html#a2a3a0126924898c8bbf889ecd5f8b5b5">00353</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a2a3a0126924898c8bbf889ecd5f8b5b5" title="Array of used images.">$images</a> = array();
<a name="l00354"></a>00354 <span class="comment"></span>
<a name="l00355"></a>00355 <span class="comment">    /**</span>
<a name="l00356"></a>00356 <span class="comment">     * Array of Annotations in pages.</span>
<a name="l00357"></a>00357 <span class="comment">     * @protected</span>
<a name="l00358"></a>00358 <span class="comment">     */</span>
<a name="l00359"></a><a class="code" href="classTCPDF.html#a9ce01e710ad7b958dbb41269770461f5">00359</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a9ce01e710ad7b958dbb41269770461f5" title="Array of Annotations in pages.">$PageAnnots</a> = array();
<a name="l00360"></a>00360 <span class="comment"></span>
<a name="l00361"></a>00361 <span class="comment">    /**</span>
<a name="l00362"></a>00362 <span class="comment">     * Array of internal links.</span>
<a name="l00363"></a>00363 <span class="comment">     * @protected</span>
<a name="l00364"></a>00364 <span class="comment">     */</span>
<a name="l00365"></a><a class="code" href="classTCPDF.html#ab050e61a9d3a6d628990a26c9032ec0e">00365</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab050e61a9d3a6d628990a26c9032ec0e" title="Array of internal links.">$links</a> = array();
<a name="l00366"></a>00366 <span class="comment"></span>
<a name="l00367"></a>00367 <span class="comment">    /**</span>
<a name="l00368"></a>00368 <span class="comment">     * Current font family.</span>
<a name="l00369"></a>00369 <span class="comment">     * @protected</span>
<a name="l00370"></a>00370 <span class="comment">     */</span>
<a name="l00371"></a><a class="code" href="classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">00371</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba" title="Current font family.">$FontFamily</a>;
<a name="l00372"></a>00372 <span class="comment"></span>
<a name="l00373"></a>00373 <span class="comment">    /**</span>
<a name="l00374"></a>00374 <span class="comment">     * Current font style.</span>
<a name="l00375"></a>00375 <span class="comment">     * @protected</span>
<a name="l00376"></a>00376 <span class="comment">     */</span>
<a name="l00377"></a><a class="code" href="classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">00377</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6fce74bcde6c138d286dce274950dff7" title="Current font style.">$FontStyle</a>;
<a name="l00378"></a>00378 <span class="comment"></span>
<a name="l00379"></a>00379 <span class="comment">    /**</span>
<a name="l00380"></a>00380 <span class="comment">     * Current font ascent (distance between font top and baseline).</span>
<a name="l00381"></a>00381 <span class="comment">     * @protected</span>
<a name="l00382"></a>00382 <span class="comment">     * @since 2.8.000 (2007-03-29)</span>
<a name="l00383"></a>00383 <span class="comment">     */</span>
<a name="l00384"></a><a class="code" href="classTCPDF.html#a628e3e22a136173a0bac253ce9842c56">00384</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a628e3e22a136173a0bac253ce9842c56" title="Current font ascent (distance between font top and baseline).">$FontAscent</a>;
<a name="l00385"></a>00385 <span class="comment"></span>
<a name="l00386"></a>00386 <span class="comment">    /**</span>
<a name="l00387"></a>00387 <span class="comment">     * Current font descent (distance between font bottom and baseline).</span>
<a name="l00388"></a>00388 <span class="comment">     * @protected</span>
<a name="l00389"></a>00389 <span class="comment">     * @since 2.8.000 (2007-03-29)</span>
<a name="l00390"></a>00390 <span class="comment">     */</span>
<a name="l00391"></a><a class="code" href="classTCPDF.html#a7f6ac3771776732243563ec438ab055f">00391</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7f6ac3771776732243563ec438ab055f" title="Current font descent (distance between font bottom and baseline).">$FontDescent</a>;
<a name="l00392"></a>00392 <span class="comment"></span>
<a name="l00393"></a>00393 <span class="comment">    /**</span>
<a name="l00394"></a>00394 <span class="comment">     * Underlining flag.</span>
<a name="l00395"></a>00395 <span class="comment">     * @protected</span>
<a name="l00396"></a>00396 <span class="comment">     */</span>
<a name="l00397"></a><a class="code" href="classTCPDF.html#a55b5b6cb30c082e93dfdcddb1d7fb41b">00397</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a55b5b6cb30c082e93dfdcddb1d7fb41b" title="Underlining flag.">$underline</a>;
<a name="l00398"></a>00398 <span class="comment"></span>
<a name="l00399"></a>00399 <span class="comment">    /**</span>
<a name="l00400"></a>00400 <span class="comment">     * Overlining flag.</span>
<a name="l00401"></a>00401 <span class="comment">     * @protected</span>
<a name="l00402"></a>00402 <span class="comment">     */</span>
<a name="l00403"></a><a class="code" href="classTCPDF.html#ae47afd58a8f71596ad26a55444208b55">00403</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae47afd58a8f71596ad26a55444208b55" title="Overlining flag.">$overline</a>;
<a name="l00404"></a>00404 <span class="comment"></span>
<a name="l00405"></a>00405 <span class="comment">    /**</span>
<a name="l00406"></a>00406 <span class="comment">     * Current font info.</span>
<a name="l00407"></a>00407 <span class="comment">     * @protected</span>
<a name="l00408"></a>00408 <span class="comment">     */</span>
<a name="l00409"></a><a class="code" href="classTCPDF.html#a6053be73563ad95518920ecdc8cae6fb">00409</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6053be73563ad95518920ecdc8cae6fb" title="Current font info.">$CurrentFont</a>;
<a name="l00410"></a>00410 <span class="comment"></span>
<a name="l00411"></a>00411 <span class="comment">    /**</span>
<a name="l00412"></a>00412 <span class="comment">     * Current font size in points.</span>
<a name="l00413"></a>00413 <span class="comment">     * @protected</span>
<a name="l00414"></a>00414 <span class="comment">     */</span>
<a name="l00415"></a><a class="code" href="classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">00415</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d" title="Current font size in points.">$FontSizePt</a>;
<a name="l00416"></a>00416 <span class="comment"></span>
<a name="l00417"></a>00417 <span class="comment">    /**</span>
<a name="l00418"></a>00418 <span class="comment">     * Current font size in user unit.</span>
<a name="l00419"></a>00419 <span class="comment">     * @protected</span>
<a name="l00420"></a>00420 <span class="comment">     */</span>
<a name="l00421"></a><a class="code" href="classTCPDF.html#aa4460c72a6e45784dff4dad7708c372c">00421</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aa4460c72a6e45784dff4dad7708c372c" title="Current font size in user unit.">$FontSize</a>;
<a name="l00422"></a>00422 <span class="comment"></span>
<a name="l00423"></a>00423 <span class="comment">    /**</span>
<a name="l00424"></a>00424 <span class="comment">     * Commands for drawing color.</span>
<a name="l00425"></a>00425 <span class="comment">     * @protected</span>
<a name="l00426"></a>00426 <span class="comment">     */</span>
<a name="l00427"></a><a class="code" href="classTCPDF.html#a0315276a2fb102cd8ef24a440741b3d4">00427</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a0315276a2fb102cd8ef24a440741b3d4" title="Commands for drawing color.">$DrawColor</a>;
<a name="l00428"></a>00428 <span class="comment"></span>
<a name="l00429"></a>00429 <span class="comment">    /**</span>
<a name="l00430"></a>00430 <span class="comment">     * Commands for filling color.</span>
<a name="l00431"></a>00431 <span class="comment">     * @protected</span>
<a name="l00432"></a>00432 <span class="comment">     */</span>
<a name="l00433"></a><a class="code" href="classTCPDF.html#a6917075860ef7a8d300698ff6f678a04">00433</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6917075860ef7a8d300698ff6f678a04" title="Commands for filling color.">$FillColor</a>;
<a name="l00434"></a>00434 <span class="comment"></span>
<a name="l00435"></a>00435 <span class="comment">    /**</span>
<a name="l00436"></a>00436 <span class="comment">     * Commands for text color.</span>
<a name="l00437"></a>00437 <span class="comment">     * @protected</span>
<a name="l00438"></a>00438 <span class="comment">     */</span>
<a name="l00439"></a><a class="code" href="classTCPDF.html#ade7bced891aaa3b0a5ce236eb7a5c8ba">00439</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ade7bced891aaa3b0a5ce236eb7a5c8ba" title="Commands for text color.">$TextColor</a>;
<a name="l00440"></a>00440 <span class="comment"></span>
<a name="l00441"></a>00441 <span class="comment">    /**</span>
<a name="l00442"></a>00442 <span class="comment">     * Indicates whether fill and text colors are different.</span>
<a name="l00443"></a>00443 <span class="comment">     * @protected</span>
<a name="l00444"></a>00444 <span class="comment">     */</span>
<a name="l00445"></a><a class="code" href="classTCPDF.html#a27c982afeec6a29678a0b16ae0b4e755">00445</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a27c982afeec6a29678a0b16ae0b4e755" title="Indicates whether fill and text colors are different.">$ColorFlag</a>;
<a name="l00446"></a>00446 <span class="comment"></span>
<a name="l00447"></a>00447 <span class="comment">    /**</span>
<a name="l00448"></a>00448 <span class="comment">     * Automatic page breaking.</span>
<a name="l00449"></a>00449 <span class="comment">     * @protected</span>
<a name="l00450"></a>00450 <span class="comment">     */</span>
<a name="l00451"></a><a class="code" href="classTCPDF.html#ad252eae91d3151b11d1dd15aebe9a4a4">00451</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ad252eae91d3151b11d1dd15aebe9a4a4" title="Automatic page breaking.">$AutoPageBreak</a>;
<a name="l00452"></a>00452 <span class="comment"></span>
<a name="l00453"></a>00453 <span class="comment">    /**</span>
<a name="l00454"></a>00454 <span class="comment">     * Threshold used to trigger page breaks.</span>
<a name="l00455"></a>00455 <span class="comment">     * @protected</span>
<a name="l00456"></a>00456 <span class="comment">     */</span>
<a name="l00457"></a><a class="code" href="classTCPDF.html#ae8f57f5a0dc2a796269772b2cd490c5e">00457</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae8f57f5a0dc2a796269772b2cd490c5e" title="Threshold used to trigger page breaks.">$PageBreakTrigger</a>;
<a name="l00458"></a>00458 <span class="comment"></span>
<a name="l00459"></a>00459 <span class="comment">    /**</span>
<a name="l00460"></a>00460 <span class="comment">     * Flag set when processing page header.</span>
<a name="l00461"></a>00461 <span class="comment">     * @protected</span>
<a name="l00462"></a>00462 <span class="comment">     */</span>
<a name="l00463"></a><a class="code" href="classTCPDF.html#ab991dc3ec6359223a68f1177746d61f3">00463</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab991dc3ec6359223a68f1177746d61f3" title="Flag set when processing page header.">$InHeader</a> = <span class="keyword">false</span>;
<a name="l00464"></a>00464 <span class="comment"></span>
<a name="l00465"></a>00465 <span class="comment">    /**</span>
<a name="l00466"></a>00466 <span class="comment">     * Flag set when processing page footer.</span>
<a name="l00467"></a>00467 <span class="comment">     * @protected</span>
<a name="l00468"></a>00468 <span class="comment">     */</span>
<a name="l00469"></a><a class="code" href="classTCPDF.html#a0f0bc306116b145ea0efbc1c709a23b6">00469</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a0f0bc306116b145ea0efbc1c709a23b6" title="Flag set when processing page footer.">$InFooter</a> = <span class="keyword">false</span>;
<a name="l00470"></a>00470 <span class="comment"></span>
<a name="l00471"></a>00471 <span class="comment">    /**</span>
<a name="l00472"></a>00472 <span class="comment">     * Zoom display mode.</span>
<a name="l00473"></a>00473 <span class="comment">     * @protected</span>
<a name="l00474"></a>00474 <span class="comment">     */</span>
<a name="l00475"></a><a class="code" href="classTCPDF.html#a228f3f0796f010e77806ee1af35adcfe">00475</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a228f3f0796f010e77806ee1af35adcfe" title="Zoom display mode.">$ZoomMode</a>;
<a name="l00476"></a>00476 <span class="comment"></span>
<a name="l00477"></a>00477 <span class="comment">    /**</span>
<a name="l00478"></a>00478 <span class="comment">     * Layout display mode.</span>
<a name="l00479"></a>00479 <span class="comment">     * @protected</span>
<a name="l00480"></a>00480 <span class="comment">     */</span>
<a name="l00481"></a><a class="code" href="classTCPDF.html#afc93b05f36dcad498c71cdfe214716ef">00481</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#afc93b05f36dcad498c71cdfe214716ef" title="Layout display mode.">$LayoutMode</a>;
<a name="l00482"></a>00482 <span class="comment"></span>
<a name="l00483"></a>00483 <span class="comment">    /**</span>
<a name="l00484"></a>00484 <span class="comment">     * If true set the document information dictionary in Unicode.</span>
<a name="l00485"></a>00485 <span class="comment">     * @protected</span>
<a name="l00486"></a>00486 <span class="comment">     */</span>
<a name="l00487"></a><a class="code" href="classTCPDF.html#ab5d6a8d1d360e0845909cd24f4637266">00487</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab5d6a8d1d360e0845909cd24f4637266" title="If true set the document information dictionary in Unicode.">$docinfounicode</a> = <span class="keyword">true</span>;
<a name="l00488"></a>00488 <span class="comment"></span>
<a name="l00489"></a>00489 <span class="comment">    /**</span>
<a name="l00490"></a>00490 <span class="comment">     * Document title.</span>
<a name="l00491"></a>00491 <span class="comment">     * @protected</span>
<a name="l00492"></a>00492 <span class="comment">     */</span>
<a name="l00493"></a><a class="code" href="classTCPDF.html#a63acf0babc0299784cbb54354329a734">00493</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a63acf0babc0299784cbb54354329a734" title="Document title.">$title</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00494"></a>00494 <span class="comment"></span>
<a name="l00495"></a>00495 <span class="comment">    /**</span>
<a name="l00496"></a>00496 <span class="comment">     * Document subject.</span>
<a name="l00497"></a>00497 <span class="comment">     * @protected</span>
<a name="l00498"></a>00498 <span class="comment">     */</span>
<a name="l00499"></a><a class="code" href="classTCPDF.html#abb4e21366924e76df3400312434d95e1">00499</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abb4e21366924e76df3400312434d95e1" title="Document subject.">$subject</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00500"></a>00500 <span class="comment"></span>
<a name="l00501"></a>00501 <span class="comment">    /**</span>
<a name="l00502"></a>00502 <span class="comment">     * Document author.</span>
<a name="l00503"></a>00503 <span class="comment">     * @protected</span>
<a name="l00504"></a>00504 <span class="comment">     */</span>
<a name="l00505"></a><a class="code" href="classTCPDF.html#a25c26ce9fab4b1d38773ab3629d985aa">00505</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a25c26ce9fab4b1d38773ab3629d985aa" title="Document author.">$author</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00506"></a>00506 <span class="comment"></span>
<a name="l00507"></a>00507 <span class="comment">    /**</span>
<a name="l00508"></a>00508 <span class="comment">     * Document keywords.</span>
<a name="l00509"></a>00509 <span class="comment">     * @protected</span>
<a name="l00510"></a>00510 <span class="comment">     */</span>
<a name="l00511"></a><a class="code" href="classTCPDF.html#a752bede1485e51bff5ad315ca83c804d">00511</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a752bede1485e51bff5ad315ca83c804d" title="Document keywords.">$keywords</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00512"></a>00512 <span class="comment"></span>
<a name="l00513"></a>00513 <span class="comment">    /**</span>
<a name="l00514"></a>00514 <span class="comment">     * Document creator.</span>
<a name="l00515"></a>00515 <span class="comment">     * @protected</span>
<a name="l00516"></a>00516 <span class="comment">     */</span>
<a name="l00517"></a><a class="code" href="classTCPDF.html#a79a8b6ca37c76f3d5ebfb26be77613db">00517</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a79a8b6ca37c76f3d5ebfb26be77613db" title="Document creator.">$creator</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00518"></a>00518 <span class="comment"></span>
<a name="l00519"></a>00519 <span class="comment">    /**</span>
<a name="l00520"></a>00520 <span class="comment">     * Starting page number.</span>
<a name="l00521"></a>00521 <span class="comment">     * @protected</span>
<a name="l00522"></a>00522 <span class="comment">     */</span>
<a name="l00523"></a><a class="code" href="classTCPDF.html#aa763f850e5163efe95d15785b174de71">00523</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aa763f850e5163efe95d15785b174de71" title="Starting page number.">$starting_page_number</a> = 1;
<a name="l00524"></a>00524 <span class="comment"></span>
<a name="l00525"></a>00525 <span class="comment">    /**</span>
<a name="l00526"></a>00526 <span class="comment">     * String alias for total number of pages.</span>
<a name="l00527"></a>00527 <span class="comment">     * @protected</span>
<a name="l00528"></a>00528 <span class="comment">     */</span>
<a name="l00529"></a><a class="code" href="classTCPDF.html#abf8b846558ee3b9b3a6e716993aca5ab">00529</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abf8b846558ee3b9b3a6e716993aca5ab" title="String alias for total number of pages.">$alias_tot_pages</a> = <span class="stringliteral">&#39;{:ptp:}&#39;</span>;
<a name="l00530"></a>00530 <span class="comment"></span>
<a name="l00531"></a>00531 <span class="comment">    /**</span>
<a name="l00532"></a>00532 <span class="comment">     * String alias for page number.</span>
<a name="l00533"></a>00533 <span class="comment">     * @protected</span>
<a name="l00534"></a>00534 <span class="comment">     */</span>
<a name="l00535"></a><a class="code" href="classTCPDF.html#a6f67154d681077d845568cd49a5761f4">00535</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6f67154d681077d845568cd49a5761f4" title="String alias for page number.">$alias_num_page</a> = <span class="stringliteral">&#39;{:pnp:}&#39;</span>;
<a name="l00536"></a>00536 <span class="comment"></span>
<a name="l00537"></a>00537 <span class="comment">    /**</span>
<a name="l00538"></a>00538 <span class="comment">     * String alias for total number of pages in a single group.</span>
<a name="l00539"></a>00539 <span class="comment">     * @protected</span>
<a name="l00540"></a>00540 <span class="comment">     */</span>
<a name="l00541"></a><a class="code" href="classTCPDF.html#af849a5642d4aaf6513fb88c33f851bfd">00541</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#af849a5642d4aaf6513fb88c33f851bfd" title="String alias for total number of pages in a single group.">$alias_group_tot_pages</a> = <span class="stringliteral">&#39;{:ptg:}&#39;</span>;
<a name="l00542"></a>00542 <span class="comment"></span>
<a name="l00543"></a>00543 <span class="comment">    /**</span>
<a name="l00544"></a>00544 <span class="comment">     * String alias for group page number.</span>
<a name="l00545"></a>00545 <span class="comment">     * @protected</span>
<a name="l00546"></a>00546 <span class="comment">     */</span>
<a name="l00547"></a><a class="code" href="classTCPDF.html#abfbc7b4ba36001c44bf3308de3761a08">00547</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abfbc7b4ba36001c44bf3308de3761a08" title="String alias for group page number.">$alias_group_num_page</a> = <span class="stringliteral">&#39;{:png:}&#39;</span>;
<a name="l00548"></a>00548 <span class="comment"></span>
<a name="l00549"></a>00549 <span class="comment">    /**</span>
<a name="l00550"></a>00550 <span class="comment">     * String alias for right shift compensation used to correctly align page numbers on the right.</span>
<a name="l00551"></a>00551 <span class="comment">     * @protected</span>
<a name="l00552"></a>00552 <span class="comment">     */</span>
<a name="l00553"></a><a class="code" href="classTCPDF.html#aa97dbeeca5f7f2d9a577cd4dd043516f">00553</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aa97dbeeca5f7f2d9a577cd4dd043516f" title="String alias for right shift compensation used to correctly align page numbers on the right...">$alias_right_shift</a> = <span class="stringliteral">&#39;{rsc:&#39;</span>;
<a name="l00554"></a>00554 <span class="comment"></span>
<a name="l00555"></a>00555 <span class="comment">    /**</span>
<a name="l00556"></a>00556 <span class="comment">     * The right-bottom (or left-bottom for RTL) corner X coordinate of last inserted image.</span>
<a name="l00557"></a>00557 <span class="comment">     * @since 2002-07-31</span>
<a name="l00558"></a>00558 <span class="comment">     * @author Nicola Asuni</span>
<a name="l00559"></a>00559 <span class="comment">     * @protected</span>
<a name="l00560"></a>00560 <span class="comment">     */</span>
<a name="l00561"></a><a class="code" href="classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">00561</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ace8e68000d6185a28a180bbe4531b428" title="The right-bottom (or left-bottom for RTL) corner X coordinate of last inserted image.">$img_rb_x</a>;
<a name="l00562"></a>00562 <span class="comment"></span>
<a name="l00563"></a>00563 <span class="comment">    /**</span>
<a name="l00564"></a>00564 <span class="comment">     * The right-bottom corner Y coordinate of last inserted image.</span>
<a name="l00565"></a>00565 <span class="comment">     * @since 2002-07-31</span>
<a name="l00566"></a>00566 <span class="comment">     * @author Nicola Asuni</span>
<a name="l00567"></a>00567 <span class="comment">     * @protected</span>
<a name="l00568"></a>00568 <span class="comment">     */</span>
<a name="l00569"></a><a class="code" href="classTCPDF.html#abc05496cf88772b492f67e87c53121d0">00569</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abc05496cf88772b492f67e87c53121d0" title="The right-bottom corner Y coordinate of last inserted image.">$img_rb_y</a>;
<a name="l00570"></a>00570 <span class="comment"></span>
<a name="l00571"></a>00571 <span class="comment">    /**</span>
<a name="l00572"></a>00572 <span class="comment">     * Adjusting factor to convert pixels to user units.</span>
<a name="l00573"></a>00573 <span class="comment">     * @since 2004-06-14</span>
<a name="l00574"></a>00574 <span class="comment">     * @author Nicola Asuni</span>
<a name="l00575"></a>00575 <span class="comment">     * @protected</span>
<a name="l00576"></a>00576 <span class="comment">     */</span>
<a name="l00577"></a><a class="code" href="classTCPDF.html#ae476d39b2a2721941c0c3044a922b633">00577</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae476d39b2a2721941c0c3044a922b633" title="Adjusting factor to convert pixels to user units.">$imgscale</a> = 1;
<a name="l00578"></a>00578 <span class="comment"></span>
<a name="l00579"></a>00579 <span class="comment">    /**</span>
<a name="l00580"></a>00580 <span class="comment">     * Boolean flag set to true when the input text is unicode (require unicode fonts).</span>
<a name="l00581"></a>00581 <span class="comment">     * @since 2005-01-02</span>
<a name="l00582"></a>00582 <span class="comment">     * @author Nicola Asuni</span>
<a name="l00583"></a>00583 <span class="comment">     * @protected</span>
<a name="l00584"></a>00584 <span class="comment">     */</span>
<a name="l00585"></a><a class="code" href="classTCPDF.html#a148f0ae58c3b0f5644f8ab158b17c2ed">00585</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a148f0ae58c3b0f5644f8ab158b17c2ed" title="Boolean flag set to true when the input text is unicode (require unicode fonts).">$isunicode</a> = <span class="keyword">false</span>;
<a name="l00586"></a>00586 <span class="comment"></span>
<a name="l00587"></a>00587 <span class="comment">    /**</span>
<a name="l00588"></a>00588 <span class="comment">     * Object containing unicode data.</span>
<a name="l00589"></a>00589 <span class="comment">     * @since 5.9.004 (2010-10-18)</span>
<a name="l00590"></a>00590 <span class="comment">     * @author Nicola Asuni</span>
<a name="l00591"></a>00591 <span class="comment">     * @protected</span>
<a name="l00592"></a>00592 <span class="comment">     */</span>
<a name="l00593"></a><a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587">00593</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>;
<a name="l00594"></a>00594 <span class="comment"></span>
<a name="l00595"></a>00595 <span class="comment">    /**</span>
<a name="l00596"></a>00596 <span class="comment">     * Object containing font encoding maps.</span>
<a name="l00597"></a>00597 <span class="comment">     * @since 5.9.123 (2011-10-01)</span>
<a name="l00598"></a>00598 <span class="comment">     * @author Nicola Asuni</span>
<a name="l00599"></a>00599 <span class="comment">     * @protected</span>
<a name="l00600"></a>00600 <span class="comment">     */</span>
<a name="l00601"></a><a class="code" href="classTCPDF.html#abad893fb8309e9c0c50aa275bcbe3d75">00601</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abad893fb8309e9c0c50aa275bcbe3d75" title="Object containing font encoding maps.">$encmaps</a>;
<a name="l00602"></a>00602 <span class="comment"></span>
<a name="l00603"></a>00603 <span class="comment">    /**</span>
<a name="l00604"></a>00604 <span class="comment">     * PDF version.</span>
<a name="l00605"></a>00605 <span class="comment">     * @since 1.5.3</span>
<a name="l00606"></a>00606 <span class="comment">     * @protected</span>
<a name="l00607"></a>00607 <span class="comment">     */</span>
<a name="l00608"></a><a class="code" href="classTCPDF.html#a40cc24bda71b85b4013d070896cd97de">00608</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a40cc24bda71b85b4013d070896cd97de" title="PDF version.">$PDFVersion</a> = <span class="stringliteral">&#39;1.7&#39;</span>;
<a name="l00609"></a>00609 <span class="comment"></span>
<a name="l00610"></a>00610 <span class="comment">    /**</span>
<a name="l00611"></a>00611 <span class="comment">     * ID of the stored default header template (-1 = not set).</span>
<a name="l00612"></a>00612 <span class="comment">     * @protected</span>
<a name="l00613"></a>00613 <span class="comment">     */</span>
<a name="l00614"></a><a class="code" href="classTCPDF.html#a9a8cd7928fa36f7a9679a00d908d1427">00614</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a9a8cd7928fa36f7a9679a00d908d1427" title="ID of the stored default header template (-1 = not set).">$header_xobjid</a> = -1;
<a name="l00615"></a>00615 <span class="comment"></span>
<a name="l00616"></a>00616 <span class="comment">    /**</span>
<a name="l00617"></a>00617 <span class="comment">     * If true reset the Header Xobject template at each page</span>
<a name="l00618"></a>00618 <span class="comment">     * @protected</span>
<a name="l00619"></a>00619 <span class="comment">     */</span>
<a name="l00620"></a><a class="code" href="classTCPDF.html#ab79dc8e8a21ee6aa54d648f2afb1c49f">00620</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab79dc8e8a21ee6aa54d648f2afb1c49f" title="If true reset the Header Xobject template at each page.">$header_xobj_autoreset</a> = <span class="keyword">false</span>;
<a name="l00621"></a>00621 <span class="comment"></span>
<a name="l00622"></a>00622 <span class="comment">    /**</span>
<a name="l00623"></a>00623 <span class="comment">     * Minimum distance between header and top page margin.</span>
<a name="l00624"></a>00624 <span class="comment">     * @protected</span>
<a name="l00625"></a>00625 <span class="comment">     */</span>
<a name="l00626"></a><a class="code" href="classTCPDF.html#afdcd761ffeab6ede2a7ed79cb2b5d33d">00626</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#afdcd761ffeab6ede2a7ed79cb2b5d33d" title="Minimum distance between header and top page margin.">$header_margin</a>;
<a name="l00627"></a>00627 <span class="comment"></span>
<a name="l00628"></a>00628 <span class="comment">    /**</span>
<a name="l00629"></a>00629 <span class="comment">     * Minimum distance between footer and bottom page margin.</span>
<a name="l00630"></a>00630 <span class="comment">     * @protected</span>
<a name="l00631"></a>00631 <span class="comment">     */</span>
<a name="l00632"></a><a class="code" href="classTCPDF.html#ad5cecadb5d4b25324516668aaf23c3ca">00632</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ad5cecadb5d4b25324516668aaf23c3ca" title="Minimum distance between footer and bottom page margin.">$footer_margin</a>;
<a name="l00633"></a>00633 <span class="comment"></span>
<a name="l00634"></a>00634 <span class="comment">    /**</span>
<a name="l00635"></a>00635 <span class="comment">     * Original left margin value.</span>
<a name="l00636"></a>00636 <span class="comment">     * @protected</span>
<a name="l00637"></a>00637 <span class="comment">     * @since 1.53.0.TC013</span>
<a name="l00638"></a>00638 <span class="comment">     */</span>
<a name="l00639"></a><a class="code" href="classTCPDF.html#a90bee4debe4218064059014965f8d52a">00639</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a90bee4debe4218064059014965f8d52a" title="Original left margin value.">$original_lMargin</a>;
<a name="l00640"></a>00640 <span class="comment"></span>
<a name="l00641"></a>00641 <span class="comment">    /**</span>
<a name="l00642"></a>00642 <span class="comment">     * Original right margin value.</span>
<a name="l00643"></a>00643 <span class="comment">     * @protected</span>
<a name="l00644"></a>00644 <span class="comment">     * @since 1.53.0.TC013</span>
<a name="l00645"></a>00645 <span class="comment">     */</span>
<a name="l00646"></a><a class="code" href="classTCPDF.html#a76d33e30b8292c2483e80bc98566483f">00646</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a76d33e30b8292c2483e80bc98566483f" title="Original right margin value.">$original_rMargin</a>;
<a name="l00647"></a>00647 <span class="comment"></span>
<a name="l00648"></a>00648 <span class="comment">    /**</span>
<a name="l00649"></a>00649 <span class="comment">     * Default font used on page header.</span>
<a name="l00650"></a>00650 <span class="comment">     * @protected</span>
<a name="l00651"></a>00651 <span class="comment">     */</span>
<a name="l00652"></a><a class="code" href="classTCPDF.html#aa29f2cb5b3679f1c6658e2a1e775bcb3">00652</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aa29f2cb5b3679f1c6658e2a1e775bcb3" title="Default font used on page header.">$header_font</a>;
<a name="l00653"></a>00653 <span class="comment"></span>
<a name="l00654"></a>00654 <span class="comment">    /**</span>
<a name="l00655"></a>00655 <span class="comment">     * Default font used on page footer.</span>
<a name="l00656"></a>00656 <span class="comment">     * @protected</span>
<a name="l00657"></a>00657 <span class="comment">     */</span>
<a name="l00658"></a><a class="code" href="classTCPDF.html#a63fc9b0fba1a33cc5d27588f3e512df8">00658</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a63fc9b0fba1a33cc5d27588f3e512df8" title="Default font used on page footer.">$footer_font</a>;
<a name="l00659"></a>00659 <span class="comment"></span>
<a name="l00660"></a>00660 <span class="comment">    /**</span>
<a name="l00661"></a>00661 <span class="comment">     * Language templates.</span>
<a name="l00662"></a>00662 <span class="comment">     * @protected</span>
<a name="l00663"></a>00663 <span class="comment">     */</span>
<a name="l00664"></a><a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">00664</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a>;
<a name="l00665"></a>00665 <span class="comment"></span>
<a name="l00666"></a>00666 <span class="comment">    /**</span>
<a name="l00667"></a>00667 <span class="comment">     * Barcode to print on page footer (only if set).</span>
<a name="l00668"></a>00668 <span class="comment">     * @protected</span>
<a name="l00669"></a>00669 <span class="comment">     */</span>
<a name="l00670"></a><a class="code" href="classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8">00670</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8" title="Barcode to print on page footer (only if set).">$barcode</a> = <span class="keyword">false</span>;
<a name="l00671"></a>00671 <span class="comment"></span>
<a name="l00672"></a>00672 <span class="comment">    /**</span>
<a name="l00673"></a>00673 <span class="comment">     * Boolean flag to print/hide page header.</span>
<a name="l00674"></a>00674 <span class="comment">     * @protected</span>
<a name="l00675"></a>00675 <span class="comment">     */</span>
<a name="l00676"></a><a class="code" href="classTCPDF.html#a945deedf891e7d49d60b3fe2a7cbbf95">00676</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a945deedf891e7d49d60b3fe2a7cbbf95" title="Boolean flag to print/hide page header.">$print_header</a> = <span class="keyword">true</span>;
<a name="l00677"></a>00677 <span class="comment"></span>
<a name="l00678"></a>00678 <span class="comment">    /**</span>
<a name="l00679"></a>00679 <span class="comment">     * Boolean flag to print/hide page footer.</span>
<a name="l00680"></a>00680 <span class="comment">     * @protected</span>
<a name="l00681"></a>00681 <span class="comment">     */</span>
<a name="l00682"></a><a class="code" href="classTCPDF.html#a185c0c5c32718d210add5f1be3b2b14e">00682</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a185c0c5c32718d210add5f1be3b2b14e" title="Boolean flag to print/hide page footer.">$print_footer</a> = <span class="keyword">true</span>;
<a name="l00683"></a>00683 <span class="comment"></span>
<a name="l00684"></a>00684 <span class="comment">    /**</span>
<a name="l00685"></a>00685 <span class="comment">     * Header image logo.</span>
<a name="l00686"></a>00686 <span class="comment">     * @protected</span>
<a name="l00687"></a>00687 <span class="comment">     */</span>
<a name="l00688"></a><a class="code" href="classTCPDF.html#abde8cefba6202d748b708b515bfce9ce">00688</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abde8cefba6202d748b708b515bfce9ce" title="Header image logo.">$header_logo</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00689"></a>00689 <span class="comment"></span>
<a name="l00690"></a>00690 <span class="comment">    /**</span>
<a name="l00691"></a>00691 <span class="comment">     * Width of header image logo in user units.</span>
<a name="l00692"></a>00692 <span class="comment">     * @protected</span>
<a name="l00693"></a>00693 <span class="comment">     */</span>
<a name="l00694"></a><a class="code" href="classTCPDF.html#a5c3ee3344be02f70dcd5b3db312b28f0">00694</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5c3ee3344be02f70dcd5b3db312b28f0" title="Width of header image logo in user units.">$header_logo_width</a> = 30;
<a name="l00695"></a>00695 <span class="comment"></span>
<a name="l00696"></a>00696 <span class="comment">    /**</span>
<a name="l00697"></a>00697 <span class="comment">     * Title to be printed on default page header.</span>
<a name="l00698"></a>00698 <span class="comment">     * @protected</span>
<a name="l00699"></a>00699 <span class="comment">     */</span>
<a name="l00700"></a><a class="code" href="classTCPDF.html#a7a9badafb7fca4cb3d6fe7c5e771d79e">00700</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7a9badafb7fca4cb3d6fe7c5e771d79e" title="Title to be printed on default page header.">$header_title</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00701"></a>00701 <span class="comment"></span>
<a name="l00702"></a>00702 <span class="comment">    /**</span>
<a name="l00703"></a>00703 <span class="comment">     * String to pring on page header after title.</span>
<a name="l00704"></a>00704 <span class="comment">     * @protected</span>
<a name="l00705"></a>00705 <span class="comment">     */</span>
<a name="l00706"></a><a class="code" href="classTCPDF.html#a47928b951e68ff27c1b4f39523aaeef7">00706</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a47928b951e68ff27c1b4f39523aaeef7" title="String to pring on page header after title.">$header_string</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00707"></a>00707 <span class="comment"></span>
<a name="l00708"></a>00708 <span class="comment">    /**</span>
<a name="l00709"></a>00709 <span class="comment">     * Default number of columns for html table.</span>
<a name="l00710"></a>00710 <span class="comment">     * @protected</span>
<a name="l00711"></a>00711 <span class="comment">     */</span>
<a name="l00712"></a><a class="code" href="classTCPDF.html#a58f2abc77f4289613100fcf64c52f0ae">00712</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a58f2abc77f4289613100fcf64c52f0ae" title="Default number of columns for html table.">$default_table_columns</a> = 4;
<a name="l00713"></a>00713 
<a name="l00714"></a>00714     <span class="comment">// variables for html parser</span>
<a name="l00715"></a>00715 <span class="comment"></span>
<a name="l00716"></a>00716 <span class="comment">    /**</span>
<a name="l00717"></a>00717 <span class="comment">     * HTML PARSER: array to store current link and rendering styles.</span>
<a name="l00718"></a>00718 <span class="comment">     * @protected</span>
<a name="l00719"></a>00719 <span class="comment">     */</span>
<a name="l00720"></a><a class="code" href="classTCPDF.html#ab3c410ce9315c42d12408f9982f626bc">00720</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab3c410ce9315c42d12408f9982f626bc" title="HTML PARSER: array to store current link and rendering styles.">$HREF</a> = array();
<a name="l00721"></a>00721 <span class="comment"></span>
<a name="l00722"></a>00722 <span class="comment">    /**</span>
<a name="l00723"></a>00723 <span class="comment">     * List of available fonts on filesystem.</span>
<a name="l00724"></a>00724 <span class="comment">     * @protected</span>
<a name="l00725"></a>00725 <span class="comment">     */</span>
<a name="l00726"></a><a class="code" href="classTCPDF.html#af75b91429604ea426b2aa255bbff089f">00726</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#af75b91429604ea426b2aa255bbff089f" title="List of available fonts on filesystem.">$fontlist</a> = array();
<a name="l00727"></a>00727 <span class="comment"></span>
<a name="l00728"></a>00728 <span class="comment">    /**</span>
<a name="l00729"></a>00729 <span class="comment">     * Current foreground color.</span>
<a name="l00730"></a>00730 <span class="comment">     * @protected</span>
<a name="l00731"></a>00731 <span class="comment">     */</span>
<a name="l00732"></a><a class="code" href="classTCPDF.html#a98585a6dd732caf2ba4c0ae2d9aa9841">00732</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a98585a6dd732caf2ba4c0ae2d9aa9841" title="Current foreground color.">$fgcolor</a>;
<a name="l00733"></a>00733 <span class="comment"></span>
<a name="l00734"></a>00734 <span class="comment">    /**</span>
<a name="l00735"></a>00735 <span class="comment">     * HTML PARSER: array of boolean values, true in case of ordered list (OL), false otherwise.</span>
<a name="l00736"></a>00736 <span class="comment">     * @protected</span>
<a name="l00737"></a>00737 <span class="comment">     */</span>
<a name="l00738"></a><a class="code" href="classTCPDF.html#add40afd65a8b5349248c69d057cb462d">00738</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#add40afd65a8b5349248c69d057cb462d" title="HTML PARSER: array of boolean values, true in case of ordered list (OL), false otherwise.">$listordered</a> = array();
<a name="l00739"></a>00739 <span class="comment"></span>
<a name="l00740"></a>00740 <span class="comment">    /**</span>
<a name="l00741"></a>00741 <span class="comment">     * HTML PARSER: array count list items on nested lists.</span>
<a name="l00742"></a>00742 <span class="comment">     * @protected</span>
<a name="l00743"></a>00743 <span class="comment">     */</span>
<a name="l00744"></a><a class="code" href="classTCPDF.html#a0e0245500627af0752a6954ec348fa92">00744</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a0e0245500627af0752a6954ec348fa92" title="HTML PARSER: array count list items on nested lists.">$listcount</a> = array();
<a name="l00745"></a>00745 <span class="comment"></span>
<a name="l00746"></a>00746 <span class="comment">    /**</span>
<a name="l00747"></a>00747 <span class="comment">     * HTML PARSER: current list nesting level.</span>
<a name="l00748"></a>00748 <span class="comment">     * @protected</span>
<a name="l00749"></a>00749 <span class="comment">     */</span>
<a name="l00750"></a><a class="code" href="classTCPDF.html#a92b743d472f53d5260274c7915829ff7">00750</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a92b743d472f53d5260274c7915829ff7" title="HTML PARSER: current list nesting level.">$listnum</a> = 0;
<a name="l00751"></a>00751 <span class="comment"></span>
<a name="l00752"></a>00752 <span class="comment">    /**</span>
<a name="l00753"></a>00753 <span class="comment">     * HTML PARSER: indent amount for lists.</span>
<a name="l00754"></a>00754 <span class="comment">     * @protected</span>
<a name="l00755"></a>00755 <span class="comment">     */</span>
<a name="l00756"></a><a class="code" href="classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">00756</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767" title="HTML PARSER: indent amount for lists.">$listindent</a> = 0;
<a name="l00757"></a>00757 <span class="comment"></span>
<a name="l00758"></a>00758 <span class="comment">    /**</span>
<a name="l00759"></a>00759 <span class="comment">     * HTML PARSER: current list indententation level.</span>
<a name="l00760"></a>00760 <span class="comment">     * @protected</span>
<a name="l00761"></a>00761 <span class="comment">     */</span>
<a name="l00762"></a><a class="code" href="classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">00762</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28" title="HTML PARSER: current list indententation level.">$listindentlevel</a> = 0;
<a name="l00763"></a>00763 <span class="comment"></span>
<a name="l00764"></a>00764 <span class="comment">    /**</span>
<a name="l00765"></a>00765 <span class="comment">     * Current background color.</span>
<a name="l00766"></a>00766 <span class="comment">     * @protected</span>
<a name="l00767"></a>00767 <span class="comment">     */</span>
<a name="l00768"></a><a class="code" href="classTCPDF.html#ae46a35098766581d1ad9ba173b17da5f">00768</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae46a35098766581d1ad9ba173b17da5f" title="Current background color.">$bgcolor</a>;
<a name="l00769"></a>00769 <span class="comment"></span>
<a name="l00770"></a>00770 <span class="comment">    /**</span>
<a name="l00771"></a>00771 <span class="comment">     * Temporary font size in points.</span>
<a name="l00772"></a>00772 <span class="comment">     * @protected</span>
<a name="l00773"></a>00773 <span class="comment">     */</span>
<a name="l00774"></a><a class="code" href="classTCPDF.html#a5d5b8dbfad7917b489603b4bc69dd9b8">00774</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5d5b8dbfad7917b489603b4bc69dd9b8" title="Temporary font size in points.">$tempfontsize</a> = 10;
<a name="l00775"></a>00775 <span class="comment"></span>
<a name="l00776"></a>00776 <span class="comment">    /**</span>
<a name="l00777"></a>00777 <span class="comment">     * Spacer string for LI tags.</span>
<a name="l00778"></a>00778 <span class="comment">     * @protected</span>
<a name="l00779"></a>00779 <span class="comment">     */</span>
<a name="l00780"></a><a class="code" href="classTCPDF.html#a91c1d0b385b593f4834a1fd3f9c4ab65">00780</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a91c1d0b385b593f4834a1fd3f9c4ab65" title="Spacer string for LI tags.">$lispacer</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00781"></a>00781 <span class="comment"></span>
<a name="l00782"></a>00782 <span class="comment">    /**</span>
<a name="l00783"></a>00783 <span class="comment">     * Default encoding.</span>
<a name="l00784"></a>00784 <span class="comment">     * @protected</span>
<a name="l00785"></a>00785 <span class="comment">     * @since 1.53.0.TC010</span>
<a name="l00786"></a>00786 <span class="comment">     */</span>
<a name="l00787"></a><a class="code" href="classTCPDF.html#a274314ff17c5df9ae105f9c91893a4a7">00787</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a274314ff17c5df9ae105f9c91893a4a7" title="Default encoding.">$encoding</a> = <span class="stringliteral">&#39;UTF-8&#39;</span>;
<a name="l00788"></a>00788 <span class="comment"></span>
<a name="l00789"></a>00789 <span class="comment">    /**</span>
<a name="l00790"></a>00790 <span class="comment">     * PHP internal encoding.</span>
<a name="l00791"></a>00791 <span class="comment">     * @protected</span>
<a name="l00792"></a>00792 <span class="comment">     * @since 1.53.0.TC016</span>
<a name="l00793"></a>00793 <span class="comment">     */</span>
<a name="l00794"></a><a class="code" href="classTCPDF.html#a22858ae709885860e1f6c5db6f754218">00794</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a22858ae709885860e1f6c5db6f754218" title="PHP internal encoding.">$internal_encoding</a>;
<a name="l00795"></a>00795 <span class="comment"></span>
<a name="l00796"></a>00796 <span class="comment">    /**</span>
<a name="l00797"></a>00797 <span class="comment">     * Boolean flag to indicate if the document language is Right-To-Left.</span>
<a name="l00798"></a>00798 <span class="comment">     * @protected</span>
<a name="l00799"></a>00799 <span class="comment">     * @since 2.0.000</span>
<a name="l00800"></a>00800 <span class="comment">     */</span>
<a name="l00801"></a><a class="code" href="classTCPDF.html#a4ccd9d69e0839838b105328953794a40">00801</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a4ccd9d69e0839838b105328953794a40" title="Boolean flag to indicate if the document language is Right-To-Left.">$rtl</a> = <span class="keyword">false</span>;
<a name="l00802"></a>00802 <span class="comment"></span>
<a name="l00803"></a>00803 <span class="comment">    /**</span>
<a name="l00804"></a>00804 <span class="comment">     * Boolean flag used to force RTL or LTR string direction.</span>
<a name="l00805"></a>00805 <span class="comment">     * @protected</span>
<a name="l00806"></a>00806 <span class="comment">     * @since 2.0.000</span>
<a name="l00807"></a>00807 <span class="comment">     */</span>
<a name="l00808"></a><a class="code" href="classTCPDF.html#a81fcfeb26eaac6977cb9ade5a0944154">00808</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a81fcfeb26eaac6977cb9ade5a0944154" title="Boolean flag used to force RTL or LTR string direction.">$tmprtl</a> = <span class="keyword">false</span>;
<a name="l00809"></a>00809 
<a name="l00810"></a>00810     <span class="comment">// --- Variables used for document encryption:</span>
<a name="l00811"></a>00811 <span class="comment"></span>
<a name="l00812"></a>00812 <span class="comment">    /**</span>
<a name="l00813"></a>00813 <span class="comment">     * IBoolean flag indicating whether document is protected.</span>
<a name="l00814"></a>00814 <span class="comment">     * @protected</span>
<a name="l00815"></a>00815 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l00816"></a>00816 <span class="comment">     */</span>
<a name="l00817"></a><a class="code" href="classTCPDF.html#affd380e0adfc726dbc519860de0b175c">00817</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#affd380e0adfc726dbc519860de0b175c" title="IBoolean flag indicating whether document is protected.">$encrypted</a>;
<a name="l00818"></a>00818 <span class="comment"></span>
<a name="l00819"></a>00819 <span class="comment">    /**</span>
<a name="l00820"></a>00820 <span class="comment">     * Array containing encryption settings.</span>
<a name="l00821"></a>00821 <span class="comment">     * @protected</span>
<a name="l00822"></a>00822 <span class="comment">     * @since 5.0.005 (2010-05-11)</span>
<a name="l00823"></a>00823 <span class="comment">     */</span>
<a name="l00824"></a><a class="code" href="classTCPDF.html#a06db7c5a86921654c8361f0e924d48b8">00824</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a06db7c5a86921654c8361f0e924d48b8" title="Array containing encryption settings.">$encryptdata</a> = array();
<a name="l00825"></a>00825 <span class="comment"></span>
<a name="l00826"></a>00826 <span class="comment">    /**</span>
<a name="l00827"></a>00827 <span class="comment">     * Last RC4 key encrypted (cached for optimisation).</span>
<a name="l00828"></a>00828 <span class="comment">     * @protected</span>
<a name="l00829"></a>00829 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l00830"></a>00830 <span class="comment">     */</span>
<a name="l00831"></a><a class="code" href="classTCPDF.html#a8d4bf72b31a199786829e4bee4bae6f5">00831</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a8d4bf72b31a199786829e4bee4bae6f5" title="Last RC4 key encrypted (cached for optimisation).">$last_enc_key</a>;
<a name="l00832"></a>00832 <span class="comment"></span>
<a name="l00833"></a>00833 <span class="comment">    /**</span>
<a name="l00834"></a>00834 <span class="comment">     * Last RC4 computed key.</span>
<a name="l00835"></a>00835 <span class="comment">     * @protected</span>
<a name="l00836"></a>00836 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l00837"></a>00837 <span class="comment">     */</span>
<a name="l00838"></a><a class="code" href="classTCPDF.html#aa9eef41ab9ce56515dea68e21509eda6">00838</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aa9eef41ab9ce56515dea68e21509eda6" title="Last RC4 computed key.">$last_enc_key_c</a>;
<a name="l00839"></a>00839 <span class="comment"></span>
<a name="l00840"></a>00840 <span class="comment">    /**</span>
<a name="l00841"></a>00841 <span class="comment">     * Encryption padding string.</span>
<a name="l00842"></a>00842 <span class="comment">     * @protected</span>
<a name="l00843"></a>00843 <span class="comment">     */</span>
<a name="l00844"></a><a class="code" href="classTCPDF.html#af161c4eafe4cee2543d1d51cb1d0d5a3">00844</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#af161c4eafe4cee2543d1d51cb1d0d5a3" title="Encryption padding string.">$enc_padding</a> = <span class="stringliteral">&quot;\x28\xBF\x4E\x5E\x4E\x75\x8A\x41\x64\x00\x4E\x56\xFF\xFA\x01\x08\x2E\x2E\x00\xB6\xD0\x68\x3E\x80\x2F\x0C\xA9\xFE\x64\x53\x69\x7A&quot;</span>;
<a name="l00845"></a>00845 <span class="comment"></span>
<a name="l00846"></a>00846 <span class="comment">    /**</span>
<a name="l00847"></a>00847 <span class="comment">     * File ID (used on document trailer).</span>
<a name="l00848"></a>00848 <span class="comment">     * @protected</span>
<a name="l00849"></a>00849 <span class="comment">     * @since 5.0.005 (2010-05-12)</span>
<a name="l00850"></a>00850 <span class="comment">     */</span>
<a name="l00851"></a><a class="code" href="classTCPDF.html#a12227210f010059895875006d839f318">00851</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a12227210f010059895875006d839f318" title="File ID (used on document trailer).">$file_id</a>;
<a name="l00852"></a>00852 
<a name="l00853"></a>00853     <span class="comment">// --- bookmark ---</span>
<a name="l00854"></a>00854 <span class="comment"></span>
<a name="l00855"></a>00855 <span class="comment">    /**</span>
<a name="l00856"></a>00856 <span class="comment">     * Outlines for bookmark.</span>
<a name="l00857"></a>00857 <span class="comment">     * @protected</span>
<a name="l00858"></a>00858 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l00859"></a>00859 <span class="comment">     */</span>
<a name="l00860"></a><a class="code" href="classTCPDF.html#afde44c5da51ba62be8c27491975c528f">00860</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#afde44c5da51ba62be8c27491975c528f" title="Outlines for bookmark.">$outlines</a> = array();
<a name="l00861"></a>00861 <span class="comment"></span>
<a name="l00862"></a>00862 <span class="comment">    /**</span>
<a name="l00863"></a>00863 <span class="comment">     * Outline root for bookmark.</span>
<a name="l00864"></a>00864 <span class="comment">     * @protected</span>
<a name="l00865"></a>00865 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l00866"></a>00866 <span class="comment">     */</span>
<a name="l00867"></a><a class="code" href="classTCPDF.html#a106771c9857d515f45619020ec2bf5c6">00867</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a106771c9857d515f45619020ec2bf5c6" title="Outline root for bookmark.">$OutlineRoot</a>;
<a name="l00868"></a>00868 
<a name="l00869"></a>00869     <span class="comment">// --- javascript and form ---</span>
<a name="l00870"></a>00870 <span class="comment"></span>
<a name="l00871"></a>00871 <span class="comment">    /**</span>
<a name="l00872"></a>00872 <span class="comment">     * Javascript code.</span>
<a name="l00873"></a>00873 <span class="comment">     * @protected</span>
<a name="l00874"></a>00874 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l00875"></a>00875 <span class="comment">     */</span>
<a name="l00876"></a><a class="code" href="classTCPDF.html#a6b1f180bd6e591a9c20f8621e08125e5">00876</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6b1f180bd6e591a9c20f8621e08125e5" title="Javascript code.">$javascript</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00877"></a>00877 <span class="comment"></span>
<a name="l00878"></a>00878 <span class="comment">    /**</span>
<a name="l00879"></a>00879 <span class="comment">     * Javascript counter.</span>
<a name="l00880"></a>00880 <span class="comment">     * @protected</span>
<a name="l00881"></a>00881 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l00882"></a>00882 <span class="comment">     */</span>
<a name="l00883"></a><a class="code" href="classTCPDF.html#a67d3ebe4959018ae32058d9962d76c1c">00883</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a67d3ebe4959018ae32058d9962d76c1c" title="Javascript counter.">$n_js</a>;
<a name="l00884"></a>00884 <span class="comment"></span>
<a name="l00885"></a>00885 <span class="comment">    /**</span>
<a name="l00886"></a>00886 <span class="comment">     * line trough state</span>
<a name="l00887"></a>00887 <span class="comment">     * @protected</span>
<a name="l00888"></a>00888 <span class="comment">     * @since 2.8.000 (2008-03-19)</span>
<a name="l00889"></a>00889 <span class="comment">     */</span>
<a name="l00890"></a><a class="code" href="classTCPDF.html#a5436c5f4de6f6506231423ca3c4e9a6a">00890</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5436c5f4de6f6506231423ca3c4e9a6a" title="line trough state">$linethrough</a>;
<a name="l00891"></a>00891 <span class="comment"></span>
<a name="l00892"></a>00892 <span class="comment">    /**</span>
<a name="l00893"></a>00893 <span class="comment">     * Array with additional document-wide usage rights for the document.</span>
<a name="l00894"></a>00894 <span class="comment">     * @protected</span>
<a name="l00895"></a>00895 <span class="comment">     * @since 5.8.014 (2010-08-23)</span>
<a name="l00896"></a>00896 <span class="comment">     */</span>
<a name="l00897"></a><a class="code" href="classTCPDF.html#a8a5cfe86f13b8b547ed17e97fa350a80">00897</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a8a5cfe86f13b8b547ed17e97fa350a80" title="Array with additional document-wide usage rights for the document.">$ur</a> = array();
<a name="l00898"></a>00898 <span class="comment"></span>
<a name="l00899"></a>00899 <span class="comment">    /**</span>
<a name="l00900"></a>00900 <span class="comment">     * DPI (Dot Per Inch) Document Resolution (do not change).</span>
<a name="l00901"></a>00901 <span class="comment">     * @protected</span>
<a name="l00902"></a>00902 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l00903"></a>00903 <span class="comment">     */</span>
<a name="l00904"></a><a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">00904</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a> = 72;
<a name="l00905"></a>00905 <span class="comment"></span>
<a name="l00906"></a>00906 <span class="comment">    /**</span>
<a name="l00907"></a>00907 <span class="comment">     * Array of page numbers were a new page group was started (the page numbers are the keys of the array).</span>
<a name="l00908"></a>00908 <span class="comment">     * @protected</span>
<a name="l00909"></a>00909 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l00910"></a>00910 <span class="comment">     */</span>
<a name="l00911"></a><a class="code" href="classTCPDF.html#afb73712e74059488feca5f8b850ff6a4">00911</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#afb73712e74059488feca5f8b850ff6a4" title="Array of page numbers were a new page group was started (the page numbers are the keys of the array)...">$newpagegroup</a> = array();
<a name="l00912"></a>00912 <span class="comment"></span>
<a name="l00913"></a>00913 <span class="comment">    /**</span>
<a name="l00914"></a>00914 <span class="comment">     * Array that contains the number of pages in each page group.</span>
<a name="l00915"></a>00915 <span class="comment">     * @protected</span>
<a name="l00916"></a>00916 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l00917"></a>00917 <span class="comment">     */</span>
<a name="l00918"></a><a class="code" href="classTCPDF.html#a3d3b6c9de1643d382406ebfecdbe415b">00918</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a3d3b6c9de1643d382406ebfecdbe415b" title="Array that contains the number of pages in each page group.">$pagegroups</a> = array();
<a name="l00919"></a>00919 <span class="comment"></span>
<a name="l00920"></a>00920 <span class="comment">    /**</span>
<a name="l00921"></a>00921 <span class="comment">     * Current page group number.</span>
<a name="l00922"></a>00922 <span class="comment">     * @protected</span>
<a name="l00923"></a>00923 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l00924"></a>00924 <span class="comment">     */</span>
<a name="l00925"></a><a class="code" href="classTCPDF.html#ac78410b152f371b7239405ba246cee92">00925</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ac78410b152f371b7239405ba246cee92" title="Current page group number.">$currpagegroup</a> = 0;
<a name="l00926"></a>00926 <span class="comment"></span>
<a name="l00927"></a>00927 <span class="comment">    /**</span>
<a name="l00928"></a>00928 <span class="comment">     * Array of transparency objects and parameters.</span>
<a name="l00929"></a>00929 <span class="comment">     * @protected</span>
<a name="l00930"></a>00930 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l00931"></a>00931 <span class="comment">     */</span>
<a name="l00932"></a><a class="code" href="classTCPDF.html#a75a59cadddf08174c12801049c23b862">00932</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a75a59cadddf08174c12801049c23b862" title="Array of transparency objects and parameters.">$extgstates</a>;
<a name="l00933"></a>00933 <span class="comment"></span>
<a name="l00934"></a>00934 <span class="comment">    /**</span>
<a name="l00935"></a>00935 <span class="comment">     * Set the default JPEG compression quality (1-100).</span>
<a name="l00936"></a>00936 <span class="comment">     * @protected</span>
<a name="l00937"></a>00937 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l00938"></a>00938 <span class="comment">     */</span>
<a name="l00939"></a><a class="code" href="classTCPDF.html#a5d889cef79795c6d0e8c175fc820f87d">00939</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5d889cef79795c6d0e8c175fc820f87d" title="Set the default JPEG compression quality (1-100).">$jpeg_quality</a>;
<a name="l00940"></a>00940 <span class="comment"></span>
<a name="l00941"></a>00941 <span class="comment">    /**</span>
<a name="l00942"></a>00942 <span class="comment">     * Default cell height ratio.</span>
<a name="l00943"></a>00943 <span class="comment">     * @protected</span>
<a name="l00944"></a>00944 <span class="comment">     * @since 3.0.014 (2008-05-23)</span>
<a name="l00945"></a>00945 <span class="comment">     */</span>
<a name="l00946"></a><a class="code" href="classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">00946</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce" title="Default cell height ratio.">$cell_height_ratio</a> = K_CELL_HEIGHT_RATIO;
<a name="l00947"></a>00947 <span class="comment"></span>
<a name="l00948"></a>00948 <span class="comment">    /**</span>
<a name="l00949"></a>00949 <span class="comment">     * PDF viewer preferences.</span>
<a name="l00950"></a>00950 <span class="comment">     * @protected</span>
<a name="l00951"></a>00951 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l00952"></a>00952 <span class="comment">     */</span>
<a name="l00953"></a><a class="code" href="classTCPDF.html#acb8e8249a228d343d4c5254f8cd6c75a">00953</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#acb8e8249a228d343d4c5254f8cd6c75a" title="PDF viewer preferences.">$viewer_preferences</a>;
<a name="l00954"></a>00954 <span class="comment"></span>
<a name="l00955"></a>00955 <span class="comment">    /**</span>
<a name="l00956"></a>00956 <span class="comment">     * A name object specifying how the document should be displayed when opened.</span>
<a name="l00957"></a>00957 <span class="comment">     * @protected</span>
<a name="l00958"></a>00958 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l00959"></a>00959 <span class="comment">     */</span>
<a name="l00960"></a><a class="code" href="classTCPDF.html#a69d53096e1daf8973011f291c78e4139">00960</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a69d53096e1daf8973011f291c78e4139" title="A name object specifying how the document should be displayed when opened.">$PageMode</a>;
<a name="l00961"></a>00961 <span class="comment"></span>
<a name="l00962"></a>00962 <span class="comment">    /**</span>
<a name="l00963"></a>00963 <span class="comment">     * Array for storing gradient information.</span>
<a name="l00964"></a>00964 <span class="comment">     * @protected</span>
<a name="l00965"></a>00965 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l00966"></a>00966 <span class="comment">     */</span>
<a name="l00967"></a><a class="code" href="classTCPDF.html#ab52fb17ae0baa062810c29dbcbba8179">00967</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab52fb17ae0baa062810c29dbcbba8179" title="Array for storing gradient information.">$gradients</a> = array();
<a name="l00968"></a>00968 <span class="comment"></span>
<a name="l00969"></a>00969 <span class="comment">    /**</span>
<a name="l00970"></a>00970 <span class="comment">     * Array used to store positions inside the pages buffer (keys are the page numbers).</span>
<a name="l00971"></a>00971 <span class="comment">     * @protected</span>
<a name="l00972"></a>00972 <span class="comment">     * @since 3.2.000 (2008-06-26)</span>
<a name="l00973"></a>00973 <span class="comment">     */</span>
<a name="l00974"></a><a class="code" href="classTCPDF.html#a7cef73bdad50b34e32accaeb6292095d">00974</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7cef73bdad50b34e32accaeb6292095d" title="Array used to store positions inside the pages buffer (keys are the page numbers).">$intmrk</a> = array();
<a name="l00975"></a>00975 <span class="comment"></span>
<a name="l00976"></a>00976 <span class="comment">    /**</span>
<a name="l00977"></a>00977 <span class="comment">     * Array used to store positions inside the pages buffer (keys are the page numbers).</span>
<a name="l00978"></a>00978 <span class="comment">     * @protected</span>
<a name="l00979"></a>00979 <span class="comment">     * @since 5.7.000 (2010-08-03)</span>
<a name="l00980"></a>00980 <span class="comment">     */</span>
<a name="l00981"></a><a class="code" href="classTCPDF.html#ae4db27f9e17c4a6f48117669fa94a1bb">00981</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae4db27f9e17c4a6f48117669fa94a1bb" title="Array used to store positions inside the pages buffer (keys are the page numbers).">$bordermrk</a> = array();
<a name="l00982"></a>00982 <span class="comment"></span>
<a name="l00983"></a>00983 <span class="comment">    /**</span>
<a name="l00984"></a>00984 <span class="comment">     * Array used to store page positions to track empty pages (keys are the page numbers).</span>
<a name="l00985"></a>00985 <span class="comment">     * @protected</span>
<a name="l00986"></a>00986 <span class="comment">     * @since 5.8.007 (2010-08-18)</span>
<a name="l00987"></a>00987 <span class="comment">     */</span>
<a name="l00988"></a><a class="code" href="classTCPDF.html#a9ffebab4b2d31f52b7afae1061b4fc4d">00988</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a9ffebab4b2d31f52b7afae1061b4fc4d" title="Array used to store page positions to track empty pages (keys are the page numbers).">$emptypagemrk</a> = array();
<a name="l00989"></a>00989 <span class="comment"></span>
<a name="l00990"></a>00990 <span class="comment">    /**</span>
<a name="l00991"></a>00991 <span class="comment">     * Array used to store content positions inside the pages buffer (keys are the page numbers).</span>
<a name="l00992"></a>00992 <span class="comment">     * @protected</span>
<a name="l00993"></a>00993 <span class="comment">     * @since 4.6.021 (2009-07-20)</span>
<a name="l00994"></a>00994 <span class="comment">     */</span>
<a name="l00995"></a><a class="code" href="classTCPDF.html#ad0bbadba37c598911425309c4f88d08e">00995</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ad0bbadba37c598911425309c4f88d08e" title="Array used to store content positions inside the pages buffer (keys are the page numbers).">$cntmrk</a> = array();
<a name="l00996"></a>00996 <span class="comment"></span>
<a name="l00997"></a>00997 <span class="comment">    /**</span>
<a name="l00998"></a>00998 <span class="comment">     * Array used to store footer positions of each page.</span>
<a name="l00999"></a>00999 <span class="comment">     * @protected</span>
<a name="l01000"></a>01000 <span class="comment">     * @since 3.2.000 (2008-07-01)</span>
<a name="l01001"></a>01001 <span class="comment">     */</span>
<a name="l01002"></a><a class="code" href="classTCPDF.html#a9eeb118916ac86a5441ca15a24a243f2">01002</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a9eeb118916ac86a5441ca15a24a243f2" title="Array used to store footer positions of each page.">$footerpos</a> = array();
<a name="l01003"></a>01003 <span class="comment"></span>
<a name="l01004"></a>01004 <span class="comment">    /**</span>
<a name="l01005"></a>01005 <span class="comment">     * Array used to store footer length of each page.</span>
<a name="l01006"></a>01006 <span class="comment">     * @protected</span>
<a name="l01007"></a>01007 <span class="comment">     * @since 4.0.014 (2008-07-29)</span>
<a name="l01008"></a>01008 <span class="comment">     */</span>
<a name="l01009"></a><a class="code" href="classTCPDF.html#a465409fb33aa269efd0fc709e1eaef58">01009</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a465409fb33aa269efd0fc709e1eaef58" title="Array used to store footer length of each page.">$footerlen</a> = array();
<a name="l01010"></a>01010 <span class="comment"></span>
<a name="l01011"></a>01011 <span class="comment">    /**</span>
<a name="l01012"></a>01012 <span class="comment">     * Boolean flag to indicate if a new line is created.</span>
<a name="l01013"></a>01013 <span class="comment">     * @protected</span>
<a name="l01014"></a>01014 <span class="comment">     * @since 3.2.000 (2008-07-01)</span>
<a name="l01015"></a>01015 <span class="comment">     */</span>
<a name="l01016"></a><a class="code" href="classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">01016</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a505b4eabece70b8679ebdeb86964b798" title="Boolean flag to indicate if a new line is created.">$newline</a> = <span class="keyword">true</span>;
<a name="l01017"></a>01017 <span class="comment"></span>
<a name="l01018"></a>01018 <span class="comment">    /**</span>
<a name="l01019"></a>01019 <span class="comment">     * End position of the latest inserted line.</span>
<a name="l01020"></a>01020 <span class="comment">     * @protected</span>
<a name="l01021"></a>01021 <span class="comment">     * @since 3.2.000 (2008-07-01)</span>
<a name="l01022"></a>01022 <span class="comment">     */</span>
<a name="l01023"></a><a class="code" href="classTCPDF.html#a6478721dced8d81bbed6aed8dbe5a4d1">01023</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6478721dced8d81bbed6aed8dbe5a4d1" title="End position of the latest inserted line.">$endlinex</a> = 0;
<a name="l01024"></a>01024 <span class="comment"></span>
<a name="l01025"></a>01025 <span class="comment">    /**</span>
<a name="l01026"></a>01026 <span class="comment">     * PDF string for width value of the last line.</span>
<a name="l01027"></a>01027 <span class="comment">     * @protected</span>
<a name="l01028"></a>01028 <span class="comment">     * @since 4.0.006 (2008-07-16)</span>
<a name="l01029"></a>01029 <span class="comment">     */</span>
<a name="l01030"></a><a class="code" href="classTCPDF.html#a71e0449a3a1c35c8e5009450834787e7">01030</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a71e0449a3a1c35c8e5009450834787e7" title="PDF string for width value of the last line.">$linestyleWidth</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01031"></a>01031 <span class="comment"></span>
<a name="l01032"></a>01032 <span class="comment">    /**</span>
<a name="l01033"></a>01033 <span class="comment">     * PDF string for CAP value of the last line.</span>
<a name="l01034"></a>01034 <span class="comment">     * @protected</span>
<a name="l01035"></a>01035 <span class="comment">     * @since 4.0.006 (2008-07-16)</span>
<a name="l01036"></a>01036 <span class="comment">     */</span>
<a name="l01037"></a><a class="code" href="classTCPDF.html#ad558e09c5de15501f3f845cd9f478a94">01037</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ad558e09c5de15501f3f845cd9f478a94" title="PDF string for CAP value of the last line.">$linestyleCap</a> = <span class="stringliteral">&#39;0 J&#39;</span>;
<a name="l01038"></a>01038 <span class="comment"></span>
<a name="l01039"></a>01039 <span class="comment">    /**</span>
<a name="l01040"></a>01040 <span class="comment">     * PDF string for join value of the last line.</span>
<a name="l01041"></a>01041 <span class="comment">     * @protected</span>
<a name="l01042"></a>01042 <span class="comment">     * @since 4.0.006 (2008-07-16)</span>
<a name="l01043"></a>01043 <span class="comment">     */</span>
<a name="l01044"></a><a class="code" href="classTCPDF.html#a321e26613df419d2d216805fa7405d68">01044</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a321e26613df419d2d216805fa7405d68" title="PDF string for join value of the last line.">$linestyleJoin</a> = <span class="stringliteral">&#39;0 j&#39;</span>;
<a name="l01045"></a>01045 <span class="comment"></span>
<a name="l01046"></a>01046 <span class="comment">    /**</span>
<a name="l01047"></a>01047 <span class="comment">     * PDF string for dash value of the last line.</span>
<a name="l01048"></a>01048 <span class="comment">     * @protected</span>
<a name="l01049"></a>01049 <span class="comment">     * @since 4.0.006 (2008-07-16)</span>
<a name="l01050"></a>01050 <span class="comment">     */</span>
<a name="l01051"></a><a class="code" href="classTCPDF.html#a7310f6d7bd966343955e3133756df710">01051</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7310f6d7bd966343955e3133756df710" title="PDF string for dash value of the last line.">$linestyleDash</a> = <span class="stringliteral">&#39;[] 0 d&#39;</span>;
<a name="l01052"></a>01052 <span class="comment"></span>
<a name="l01053"></a>01053 <span class="comment">    /**</span>
<a name="l01054"></a>01054 <span class="comment">     * Boolean flag to indicate if marked-content sequence is open.</span>
<a name="l01055"></a>01055 <span class="comment">     * @protected</span>
<a name="l01056"></a>01056 <span class="comment">     * @since 4.0.013 (2008-07-28)</span>
<a name="l01057"></a>01057 <span class="comment">     */</span>
<a name="l01058"></a><a class="code" href="classTCPDF.html#a7a2fb19f3fcf13ef670ba8cdf3b4c5a4">01058</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7a2fb19f3fcf13ef670ba8cdf3b4c5a4" title="Boolean flag to indicate if marked-content sequence is open.">$openMarkedContent</a> = <span class="keyword">false</span>;
<a name="l01059"></a>01059 <span class="comment"></span>
<a name="l01060"></a>01060 <span class="comment">    /**</span>
<a name="l01061"></a>01061 <span class="comment">     * Count the latest inserted vertical spaces on HTML.</span>
<a name="l01062"></a>01062 <span class="comment">     * @protected</span>
<a name="l01063"></a>01063 <span class="comment">     * @since 4.0.021 (2008-08-24)</span>
<a name="l01064"></a>01064 <span class="comment">     */</span>
<a name="l01065"></a><a class="code" href="classTCPDF.html#a96869f3f3defc5d706c09dbd987c2752">01065</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a96869f3f3defc5d706c09dbd987c2752" title="Count the latest inserted vertical spaces on HTML.">$htmlvspace</a> = 0;
<a name="l01066"></a>01066 <span class="comment"></span>
<a name="l01067"></a>01067 <span class="comment">    /**</span>
<a name="l01068"></a>01068 <span class="comment">     * Array of Spot colors.</span>
<a name="l01069"></a>01069 <span class="comment">     * @protected</span>
<a name="l01070"></a>01070 <span class="comment">     * @since 4.0.024 (2008-09-12)</span>
<a name="l01071"></a>01071 <span class="comment">     */</span>
<a name="l01072"></a><a class="code" href="classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">01072</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d" title="Array of Spot colors.">$spot_colors</a> = array();
<a name="l01073"></a>01073 <span class="comment"></span>
<a name="l01074"></a>01074 <span class="comment">    /**</span>
<a name="l01075"></a>01075 <span class="comment">     * Symbol used for HTML unordered list items.</span>
<a name="l01076"></a>01076 <span class="comment">     * @protected</span>
<a name="l01077"></a>01077 <span class="comment">     * @since 4.0.028 (2008-09-26)</span>
<a name="l01078"></a>01078 <span class="comment">     */</span>
<a name="l01079"></a><a class="code" href="classTCPDF.html#a0e77f99c65a62b6af3d07419e4750bc5">01079</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a0e77f99c65a62b6af3d07419e4750bc5" title="Symbol used for HTML unordered list items.">$lisymbol</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01080"></a>01080 <span class="comment"></span>
<a name="l01081"></a>01081 <span class="comment">    /**</span>
<a name="l01082"></a>01082 <span class="comment">     * String used to mark the beginning and end of EPS image blocks.</span>
<a name="l01083"></a>01083 <span class="comment">     * @protected</span>
<a name="l01084"></a>01084 <span class="comment">     * @since 4.1.000 (2008-10-18)</span>
<a name="l01085"></a>01085 <span class="comment">     */</span>
<a name="l01086"></a><a class="code" href="classTCPDF.html#afa577c56100df8d110993150ae9e05dd">01086</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#afa577c56100df8d110993150ae9e05dd" title="String used to mark the beginning and end of EPS image blocks.">$epsmarker</a> = <span class="stringliteral">&#39;x#!#EPS#!#x&#39;</span>;
<a name="l01087"></a>01087 <span class="comment"></span>
<a name="l01088"></a>01088 <span class="comment">    /**</span>
<a name="l01089"></a>01089 <span class="comment">     * Array of transformation matrix.</span>
<a name="l01090"></a>01090 <span class="comment">     * @protected</span>
<a name="l01091"></a>01091 <span class="comment">     * @since 4.2.000 (2008-10-29)</span>
<a name="l01092"></a>01092 <span class="comment">     */</span>
<a name="l01093"></a><a class="code" href="classTCPDF.html#ab9eb18c6a757b07560c111ffb1533049">01093</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab9eb18c6a757b07560c111ffb1533049" title="Array of transformation matrix.">$transfmatrix</a> = array();
<a name="l01094"></a>01094 <span class="comment"></span>
<a name="l01095"></a>01095 <span class="comment">    /**</span>
<a name="l01096"></a>01096 <span class="comment">     * Current key for transformation matrix.</span>
<a name="l01097"></a>01097 <span class="comment">     * @protected</span>
<a name="l01098"></a>01098 <span class="comment">     * @since 4.8.005 (2009-09-17)</span>
<a name="l01099"></a>01099 <span class="comment">     */</span>
<a name="l01100"></a><a class="code" href="classTCPDF.html#af166f060da54f13a6d9871160284cc30">01100</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#af166f060da54f13a6d9871160284cc30" title="Current key for transformation matrix.">$transfmatrix_key</a> = 0;
<a name="l01101"></a>01101 <span class="comment"></span>
<a name="l01102"></a>01102 <span class="comment">    /**</span>
<a name="l01103"></a>01103 <span class="comment">     * Booklet mode for double-sided pages.</span>
<a name="l01104"></a>01104 <span class="comment">     * @protected</span>
<a name="l01105"></a>01105 <span class="comment">     * @since 4.2.000 (2008-10-29)</span>
<a name="l01106"></a>01106 <span class="comment">     */</span>
<a name="l01107"></a><a class="code" href="classTCPDF.html#ac17fad9cbf5ec25f76e79adb61aa3f10">01107</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ac17fad9cbf5ec25f76e79adb61aa3f10" title="Booklet mode for double-sided pages.">$booklet</a> = <span class="keyword">false</span>;
<a name="l01108"></a>01108 <span class="comment"></span>
<a name="l01109"></a>01109 <span class="comment">    /**</span>
<a name="l01110"></a>01110 <span class="comment">     * Epsilon value used for float calculations.</span>
<a name="l01111"></a>01111 <span class="comment">     * @protected</span>
<a name="l01112"></a>01112 <span class="comment">     * @since 4.2.000 (2008-10-29)</span>
<a name="l01113"></a>01113 <span class="comment">     */</span>
<a name="l01114"></a><a class="code" href="classTCPDF.html#a0757c5909a61c91c055d5867c57e0d3e">01114</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a0757c5909a61c91c055d5867c57e0d3e" title="Epsilon value used for float calculations.">$feps</a> = 0.005;
<a name="l01115"></a>01115 <span class="comment"></span>
<a name="l01116"></a>01116 <span class="comment">    /**</span>
<a name="l01117"></a>01117 <span class="comment">     * Array used for custom vertical spaces for HTML tags.</span>
<a name="l01118"></a>01118 <span class="comment">     * @protected</span>
<a name="l01119"></a>01119 <span class="comment">     * @since 4.2.001 (2008-10-30)</span>
<a name="l01120"></a>01120 <span class="comment">     */</span>
<a name="l01121"></a><a class="code" href="classTCPDF.html#a17c2f9d587880ac42a8bb8638bd05811">01121</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a17c2f9d587880ac42a8bb8638bd05811" title="Array used for custom vertical spaces for HTML tags.">$tagvspaces</a> = array();
<a name="l01122"></a>01122 <span class="comment"></span>
<a name="l01123"></a>01123 <span class="comment">    /**</span>
<a name="l01124"></a>01124 <span class="comment">     * HTML PARSER: custom indent amount for lists. Negative value means disabled.</span>
<a name="l01125"></a>01125 <span class="comment">     * @protected</span>
<a name="l01126"></a>01126 <span class="comment">     * @since 4.2.007 (2008-11-12)</span>
<a name="l01127"></a>01127 <span class="comment">     */</span>
<a name="l01128"></a><a class="code" href="classTCPDF.html#a9d5b2e618c656365a57eeacc66940311">01128</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a9d5b2e618c656365a57eeacc66940311" title="HTML PARSER: custom indent amount for lists.">$customlistindent</a> = -1;
<a name="l01129"></a>01129 <span class="comment"></span>
<a name="l01130"></a>01130 <span class="comment">    /**</span>
<a name="l01131"></a>01131 <span class="comment">     * Boolean flag to indicate if the border of the cell sides that cross the page should be removed.</span>
<a name="l01132"></a>01132 <span class="comment">     * @protected</span>
<a name="l01133"></a>01133 <span class="comment">     * @since 4.2.010 (2008-11-14)</span>
<a name="l01134"></a>01134 <span class="comment">     */</span>
<a name="l01135"></a><a class="code" href="classTCPDF.html#a8e4cdd8552955c46ab2d35bb0cbfa277">01135</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a8e4cdd8552955c46ab2d35bb0cbfa277" title="Boolean flag to indicate if the border of the cell sides that cross the page should be removed...">$opencell</a> = <span class="keyword">true</span>;
<a name="l01136"></a>01136 <span class="comment"></span>
<a name="l01137"></a>01137 <span class="comment">    /**</span>
<a name="l01138"></a>01138 <span class="comment">     * Array of files to embedd.</span>
<a name="l01139"></a>01139 <span class="comment">     * @protected</span>
<a name="l01140"></a>01140 <span class="comment">     * @since 4.4.000 (2008-12-07)</span>
<a name="l01141"></a>01141 <span class="comment">     */</span>
<a name="l01142"></a><a class="code" href="classTCPDF.html#a906d52a85a3f7efd4949f6c05132e1a9">01142</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a906d52a85a3f7efd4949f6c05132e1a9" title="Array of files to embedd.">$embeddedfiles</a> = array();
<a name="l01143"></a>01143 <span class="comment"></span>
<a name="l01144"></a>01144 <span class="comment">    /**</span>
<a name="l01145"></a>01145 <span class="comment">     * Boolean flag to indicate if we are inside a PRE tag.</span>
<a name="l01146"></a>01146 <span class="comment">     * @protected</span>
<a name="l01147"></a>01147 <span class="comment">     * @since 4.4.001 (2008-12-08)</span>
<a name="l01148"></a>01148 <span class="comment">     */</span>
<a name="l01149"></a><a class="code" href="classTCPDF.html#a7e72e7d134966fec42290897902c7aac">01149</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a7e72e7d134966fec42290897902c7aac" title="Boolean flag to indicate if we are inside a PRE tag.">$premode</a> = <span class="keyword">false</span>;
<a name="l01150"></a>01150 <span class="comment"></span>
<a name="l01151"></a>01151 <span class="comment">    /**</span>
<a name="l01152"></a>01152 <span class="comment">     * Array used to store positions of graphics transformation blocks inside the page buffer.</span>
<a name="l01153"></a>01153 <span class="comment">     * keys are the page numbers</span>
<a name="l01154"></a>01154 <span class="comment">     * @protected</span>
<a name="l01155"></a>01155 <span class="comment">     * @since 4.4.002 (2008-12-09)</span>
<a name="l01156"></a>01156 <span class="comment">     */</span>
<a name="l01157"></a><a class="code" href="classTCPDF.html#a12cedc58d49cf0473c2d3d459f042cbc">01157</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a12cedc58d49cf0473c2d3d459f042cbc" title="Array used to store positions of graphics transformation blocks inside the page buffer.">$transfmrk</a> = array();
<a name="l01158"></a>01158 <span class="comment"></span>
<a name="l01159"></a>01159 <span class="comment">    /**</span>
<a name="l01160"></a>01160 <span class="comment">     * Default color for html links.</span>
<a name="l01161"></a>01161 <span class="comment">     * @protected</span>
<a name="l01162"></a>01162 <span class="comment">     * @since 4.4.003 (2008-12-09)</span>
<a name="l01163"></a>01163 <span class="comment">     */</span>
<a name="l01164"></a><a class="code" href="classTCPDF.html#ad314dda630c9467efd594d46d24abcd5">01164</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ad314dda630c9467efd594d46d24abcd5" title="Default color for html links.">$htmlLinkColorArray</a> = array(0, 0, 255);
<a name="l01165"></a>01165 <span class="comment"></span>
<a name="l01166"></a>01166 <span class="comment">    /**</span>
<a name="l01167"></a>01167 <span class="comment">     * Default font style to add to html links.</span>
<a name="l01168"></a>01168 <span class="comment">     * @protected</span>
<a name="l01169"></a>01169 <span class="comment">     * @since 4.4.003 (2008-12-09)</span>
<a name="l01170"></a>01170 <span class="comment">     */</span>
<a name="l01171"></a><a class="code" href="classTCPDF.html#a5dedfd8b2f29748200d45a186182c86c">01171</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5dedfd8b2f29748200d45a186182c86c" title="Default font style to add to html links.">$htmlLinkFontStyle</a> = <span class="charliteral">&#39;U&#39;</span>;
<a name="l01172"></a>01172 <span class="comment"></span>
<a name="l01173"></a>01173 <span class="comment">    /**</span>
<a name="l01174"></a>01174 <span class="comment">     * Counts the number of pages.</span>
<a name="l01175"></a>01175 <span class="comment">     * @protected</span>
<a name="l01176"></a>01176 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l01177"></a>01177 <span class="comment">     */</span>
<a name="l01178"></a><a class="code" href="classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">01178</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42" title="Counts the number of pages.">$numpages</a> = 0;
<a name="l01179"></a>01179 <span class="comment"></span>
<a name="l01180"></a>01180 <span class="comment">    /**</span>
<a name="l01181"></a>01181 <span class="comment">     * Array containing page lengths in bytes.</span>
<a name="l01182"></a>01182 <span class="comment">     * @protected</span>
<a name="l01183"></a>01183 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l01184"></a>01184 <span class="comment">     */</span>
<a name="l01185"></a><a class="code" href="classTCPDF.html#a2111c4472eae611423616d58c1e85430">01185</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a2111c4472eae611423616d58c1e85430" title="Array containing page lengths in bytes.">$pagelen</a> = array();
<a name="l01186"></a>01186 <span class="comment"></span>
<a name="l01187"></a>01187 <span class="comment">    /**</span>
<a name="l01188"></a>01188 <span class="comment">     * Counts the number of pages.</span>
<a name="l01189"></a>01189 <span class="comment">     * @protected</span>
<a name="l01190"></a>01190 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l01191"></a>01191 <span class="comment">     */</span>
<a name="l01192"></a><a class="code" href="classTCPDF.html#afa3c48bada4819f910fb2d6a1ffc2c14">01192</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#afa3c48bada4819f910fb2d6a1ffc2c14" title="Counts the number of pages.">$numimages</a> = 0;
<a name="l01193"></a>01193 <span class="comment"></span>
<a name="l01194"></a>01194 <span class="comment">    /**</span>
<a name="l01195"></a>01195 <span class="comment">     * Store the image keys.</span>
<a name="l01196"></a>01196 <span class="comment">     * @protected</span>
<a name="l01197"></a>01197 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l01198"></a>01198 <span class="comment">     */</span>
<a name="l01199"></a><a class="code" href="classTCPDF.html#a3a38b9e6a4264d6e2c7dd6e0c7a88905">01199</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a3a38b9e6a4264d6e2c7dd6e0c7a88905" title="Store the image keys.">$imagekeys</a> = array();
<a name="l01200"></a>01200 <span class="comment"></span>
<a name="l01201"></a>01201 <span class="comment">    /**</span>
<a name="l01202"></a>01202 <span class="comment">     * Length of the buffer in bytes.</span>
<a name="l01203"></a>01203 <span class="comment">     * @protected</span>
<a name="l01204"></a>01204 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l01205"></a>01205 <span class="comment">     */</span>
<a name="l01206"></a><a class="code" href="classTCPDF.html#ab2369921b0e2075fb797dc03f701f205">01206</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab2369921b0e2075fb797dc03f701f205" title="Length of the buffer in bytes.">$bufferlen</a> = 0;
<a name="l01207"></a>01207 <span class="comment"></span>
<a name="l01208"></a>01208 <span class="comment">    /**</span>
<a name="l01209"></a>01209 <span class="comment">     * If true enables disk caching.</span>
<a name="l01210"></a>01210 <span class="comment">     * @protected</span>
<a name="l01211"></a>01211 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l01212"></a>01212 <span class="comment">     */</span>
<a name="l01213"></a><a class="code" href="classTCPDF.html#ae36b54ab4599f14fc4116bb77ffbcc6b">01213</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae36b54ab4599f14fc4116bb77ffbcc6b" title="If true enables disk caching.">$diskcache</a> = <span class="keyword">false</span>;
<a name="l01214"></a>01214 <span class="comment"></span>
<a name="l01215"></a>01215 <span class="comment">    /**</span>
<a name="l01216"></a>01216 <span class="comment">     * Counts the number of fonts.</span>
<a name="l01217"></a>01217 <span class="comment">     * @protected</span>
<a name="l01218"></a>01218 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l01219"></a>01219 <span class="comment">     */</span>
<a name="l01220"></a><a class="code" href="classTCPDF.html#abe8ea9785cede5c50969a8c2a37aae84">01220</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abe8ea9785cede5c50969a8c2a37aae84" title="Counts the number of fonts.">$numfonts</a> = 0;
<a name="l01221"></a>01221 <span class="comment"></span>
<a name="l01222"></a>01222 <span class="comment">    /**</span>
<a name="l01223"></a>01223 <span class="comment">     * Store the font keys.</span>
<a name="l01224"></a>01224 <span class="comment">     * @protected</span>
<a name="l01225"></a>01225 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l01226"></a>01226 <span class="comment">     */</span>
<a name="l01227"></a><a class="code" href="classTCPDF.html#a6286b84256565aa46926b83494525bd3">01227</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6286b84256565aa46926b83494525bd3" title="Store the font keys.">$fontkeys</a> = array();
<a name="l01228"></a>01228 <span class="comment"></span>
<a name="l01229"></a>01229 <span class="comment">    /**</span>
<a name="l01230"></a>01230 <span class="comment">     * Store the font object IDs.</span>
<a name="l01231"></a>01231 <span class="comment">     * @protected</span>
<a name="l01232"></a>01232 <span class="comment">     * @since 4.8.001 (2009-09-09)</span>
<a name="l01233"></a>01233 <span class="comment">     */</span>
<a name="l01234"></a><a class="code" href="classTCPDF.html#a62801a15bfbe77fba2203df026b0d716">01234</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a62801a15bfbe77fba2203df026b0d716" title="Store the font object IDs.">$font_obj_ids</a> = array();
<a name="l01235"></a>01235 <span class="comment"></span>
<a name="l01236"></a>01236 <span class="comment">    /**</span>
<a name="l01237"></a>01237 <span class="comment">     * Store the fage status (true when opened, false when closed).</span>
<a name="l01238"></a>01238 <span class="comment">     * @protected</span>
<a name="l01239"></a>01239 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l01240"></a>01240 <span class="comment">     */</span>
<a name="l01241"></a><a class="code" href="classTCPDF.html#a28c086439c0e458e09a76d0964518a6c">01241</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a28c086439c0e458e09a76d0964518a6c" title="Store the fage status (true when opened, false when closed).">$pageopen</a> = array();
<a name="l01242"></a>01242 <span class="comment"></span>
<a name="l01243"></a>01243 <span class="comment">    /**</span>
<a name="l01244"></a>01244 <span class="comment">     * Default monospace font.</span>
<a name="l01245"></a>01245 <span class="comment">     * @protected</span>
<a name="l01246"></a>01246 <span class="comment">     * @since 4.5.025 (2009-03-10)</span>
<a name="l01247"></a>01247 <span class="comment">     */</span>
<a name="l01248"></a><a class="code" href="classTCPDF.html#a25b565e4885c362df7211dd7f3b9c4fa">01248</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a25b565e4885c362df7211dd7f3b9c4fa" title="Default monospace font.">$default_monospaced_font</a> = <span class="stringliteral">&#39;courier&#39;</span>;
<a name="l01249"></a>01249 <span class="comment"></span>
<a name="l01250"></a>01250 <span class="comment">    /**</span>
<a name="l01251"></a>01251 <span class="comment">     * Cloned copy of the current class object.</span>
<a name="l01252"></a>01252 <span class="comment">     * @protected</span>
<a name="l01253"></a>01253 <span class="comment">     * @since 4.5.029 (2009-03-19)</span>
<a name="l01254"></a>01254 <span class="comment">     */</span>
<a name="l01255"></a><a class="code" href="classTCPDF.html#a36337c6c1101f048451ef83c054e011b">01255</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a36337c6c1101f048451ef83c054e011b" title="Cloned copy of the current class object.">$objcopy</a>;
<a name="l01256"></a>01256 <span class="comment"></span>
<a name="l01257"></a>01257 <span class="comment">    /**</span>
<a name="l01258"></a>01258 <span class="comment">     * Array used to store the lengths of cache files.</span>
<a name="l01259"></a>01259 <span class="comment">     * @protected</span>
<a name="l01260"></a>01260 <span class="comment">     * @since 4.5.029 (2009-03-19)</span>
<a name="l01261"></a>01261 <span class="comment">     */</span>
<a name="l01262"></a><a class="code" href="classTCPDF.html#a6e8de9cf793935f3c61d1bf2c4e160ac">01262</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6e8de9cf793935f3c61d1bf2c4e160ac" title="Array used to store the lengths of cache files.">$cache_file_length</a> = array();
<a name="l01263"></a>01263 <span class="comment"></span>
<a name="l01264"></a>01264 <span class="comment">    /**</span>
<a name="l01265"></a>01265 <span class="comment">     * Table header content to be repeated on each new page.</span>
<a name="l01266"></a>01266 <span class="comment">     * @protected</span>
<a name="l01267"></a>01267 <span class="comment">     * @since 4.5.030 (2009-03-20)</span>
<a name="l01268"></a>01268 <span class="comment">     */</span>
<a name="l01269"></a><a class="code" href="classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">01269</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d" title="Table header content to be repeated on each new page.">$thead</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01270"></a>01270 <span class="comment"></span>
<a name="l01271"></a>01271 <span class="comment">    /**</span>
<a name="l01272"></a>01272 <span class="comment">     * Margins used for table header.</span>
<a name="l01273"></a>01273 <span class="comment">     * @protected</span>
<a name="l01274"></a>01274 <span class="comment">     * @since 4.5.030 (2009-03-20)</span>
<a name="l01275"></a>01275 <span class="comment">     */</span>
<a name="l01276"></a><a class="code" href="classTCPDF.html#a1545ffbbb4d3e78ac3bf8413300016eb">01276</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a1545ffbbb4d3e78ac3bf8413300016eb" title="Margins used for table header.">$theadMargins</a> = array();
<a name="l01277"></a>01277 <span class="comment"></span>
<a name="l01278"></a>01278 <span class="comment">    /**</span>
<a name="l01279"></a>01279 <span class="comment">     * Cache array for UTF8StringToArray() method.</span>
<a name="l01280"></a>01280 <span class="comment">     * @protected</span>
<a name="l01281"></a>01281 <span class="comment">     * @since 4.5.037 (2009-04-07)</span>
<a name="l01282"></a>01282 <span class="comment">     */</span>
<a name="l01283"></a><a class="code" href="classTCPDF.html#a621522ddc63c0005fb6060dba390d92c">01283</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a621522ddc63c0005fb6060dba390d92c" title="Cache array for UTF8StringToArray() method.">$cache_UTF8StringToArray</a> = array();
<a name="l01284"></a>01284 <span class="comment"></span>
<a name="l01285"></a>01285 <span class="comment">    /**</span>
<a name="l01286"></a>01286 <span class="comment">     * Maximum size of cache array used for UTF8StringToArray() method.</span>
<a name="l01287"></a>01287 <span class="comment">     * @protected</span>
<a name="l01288"></a>01288 <span class="comment">     * @since 4.5.037 (2009-04-07)</span>
<a name="l01289"></a>01289 <span class="comment">     */</span>
<a name="l01290"></a><a class="code" href="classTCPDF.html#a5bf01d0a79d195973c5f160a6258bbaa">01290</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5bf01d0a79d195973c5f160a6258bbaa" title="Maximum size of cache array used for UTF8StringToArray() method.">$cache_maxsize_UTF8StringToArray</a> = 8;
<a name="l01291"></a>01291 <span class="comment"></span>
<a name="l01292"></a>01292 <span class="comment">    /**</span>
<a name="l01293"></a>01293 <span class="comment">     * Current size of cache array used for UTF8StringToArray() method.</span>
<a name="l01294"></a>01294 <span class="comment">     * @protected</span>
<a name="l01295"></a>01295 <span class="comment">     * @since 4.5.037 (2009-04-07)</span>
<a name="l01296"></a>01296 <span class="comment">     */</span>
<a name="l01297"></a><a class="code" href="classTCPDF.html#a6b46332c8faede15f5d76d8bd032a2e2">01297</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6b46332c8faede15f5d76d8bd032a2e2" title="Current size of cache array used for UTF8StringToArray() method.">$cache_size_UTF8StringToArray</a> = 0;
<a name="l01298"></a>01298 <span class="comment"></span>
<a name="l01299"></a>01299 <span class="comment">    /**</span>
<a name="l01300"></a>01300 <span class="comment">     * Boolean flag to enable document digital signature.</span>
<a name="l01301"></a>01301 <span class="comment">     * @protected</span>
<a name="l01302"></a>01302 <span class="comment">     * @since 4.6.005 (2009-04-24)</span>
<a name="l01303"></a>01303 <span class="comment">     */</span>
<a name="l01304"></a><a class="code" href="classTCPDF.html#a10e1f5a4bd93b5f2a81cc20509e2093d">01304</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a10e1f5a4bd93b5f2a81cc20509e2093d" title="Boolean flag to enable document digital signature.">$sign</a> = <span class="keyword">false</span>;
<a name="l01305"></a>01305 <span class="comment"></span>
<a name="l01306"></a>01306 <span class="comment">    /**</span>
<a name="l01307"></a>01307 <span class="comment">     * Digital signature data.</span>
<a name="l01308"></a>01308 <span class="comment">     * @protected</span>
<a name="l01309"></a>01309 <span class="comment">     * @since 4.6.005 (2009-04-24)</span>
<a name="l01310"></a>01310 <span class="comment">     */</span>
<a name="l01311"></a><a class="code" href="classTCPDF.html#afb1dec1e7e779c6bf5869c3ab7a295ed">01311</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#afb1dec1e7e779c6bf5869c3ab7a295ed" title="Digital signature data.">$signature_data</a> = array();
<a name="l01312"></a>01312 <span class="comment"></span>
<a name="l01313"></a>01313 <span class="comment">    /**</span>
<a name="l01314"></a>01314 <span class="comment">     * Digital signature max length.</span>
<a name="l01315"></a>01315 <span class="comment">     * @protected</span>
<a name="l01316"></a>01316 <span class="comment">     * @since 4.6.005 (2009-04-24)</span>
<a name="l01317"></a>01317 <span class="comment">     */</span>
<a name="l01318"></a><a class="code" href="classTCPDF.html#ac8927d78b3aafff19cb3188f6879117b">01318</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ac8927d78b3aafff19cb3188f6879117b" title="Digital signature max length.">$signature_max_length</a> = 11742;
<a name="l01319"></a>01319 <span class="comment"></span>
<a name="l01320"></a>01320 <span class="comment">    /**</span>
<a name="l01321"></a>01321 <span class="comment">     * Data for digital signature appearance.</span>
<a name="l01322"></a>01322 <span class="comment">     * @protected</span>
<a name="l01323"></a>01323 <span class="comment">     * @since 5.3.011 (2010-06-16)</span>
<a name="l01324"></a>01324 <span class="comment">     */</span>
<a name="l01325"></a><a class="code" href="classTCPDF.html#a462e1c7c06da31458cdb0d95acb086a8">01325</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a462e1c7c06da31458cdb0d95acb086a8" title="Data for digital signature appearance.">$signature_appearance</a> = array(<span class="stringliteral">&#39;page&#39;</span> =&gt; 1, <span class="stringliteral">&#39;rect&#39;</span> =&gt; <span class="stringliteral">&#39;0 0 0 0&#39;</span>);
<a name="l01326"></a>01326 <span class="comment"></span>
<a name="l01327"></a>01327 <span class="comment">    /**</span>
<a name="l01328"></a>01328 <span class="comment">     * Array of empty digital signature appearances.</span>
<a name="l01329"></a>01329 <span class="comment">     * @protected</span>
<a name="l01330"></a>01330 <span class="comment">     * @since 5.9.101 (2011-07-06)</span>
<a name="l01331"></a>01331 <span class="comment">     */</span>
<a name="l01332"></a><a class="code" href="classTCPDF.html#a708b96db375900604367c3fe1e0df118">01332</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a708b96db375900604367c3fe1e0df118" title="Array of empty digital signature appearances.">$empty_signature_appearance</a> = array();
<a name="l01333"></a>01333 <span class="comment"></span>
<a name="l01334"></a>01334 <span class="comment">    /**</span>
<a name="l01335"></a>01335 <span class="comment">     * Regular expression used to find blank characters (required for word-wrapping).</span>
<a name="l01336"></a>01336 <span class="comment">     * @protected</span>
<a name="l01337"></a>01337 <span class="comment">     * @since 4.6.006 (2009-04-28)</span>
<a name="l01338"></a>01338 <span class="comment">     */</span>
<a name="l01339"></a><a class="code" href="classTCPDF.html#a141a622244b576f4eb239b93c8826b32">01339</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a141a622244b576f4eb239b93c8826b32" title="Regular expression used to find blank characters (required for word-wrapping).">$re_spaces</a> = <span class="stringliteral">&#39;/[^\S\xa0]/&#39;</span>;
<a name="l01340"></a>01340 <span class="comment"></span>
<a name="l01341"></a>01341 <span class="comment">    /**</span>
<a name="l01342"></a>01342 <span class="comment">     * Array of $re_spaces parts.</span>
<a name="l01343"></a>01343 <span class="comment">     * @protected</span>
<a name="l01344"></a>01344 <span class="comment">     * @since 5.5.011 (2010-07-09)</span>
<a name="l01345"></a>01345 <span class="comment">     */</span>
<a name="l01346"></a><a class="code" href="classTCPDF.html#aef325c0f70f72018cd52744380c56d47">01346</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aef325c0f70f72018cd52744380c56d47" title="Array of $re_spaces parts.">$re_space</a> = array(<span class="charliteral">&#39;p&#39;</span> =&gt; <span class="stringliteral">&#39;[^\S\xa0]&#39;</span>, <span class="charliteral">&#39;m&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>);
<a name="l01347"></a>01347 <span class="comment"></span>
<a name="l01348"></a>01348 <span class="comment">    /**</span>
<a name="l01349"></a>01349 <span class="comment">     * Digital signature object ID.</span>
<a name="l01350"></a>01350 <span class="comment">     * @protected</span>
<a name="l01351"></a>01351 <span class="comment">     * @since 4.6.022 (2009-06-23)</span>
<a name="l01352"></a>01352 <span class="comment">     */</span>
<a name="l01353"></a><a class="code" href="classTCPDF.html#a127e3d16c986f858bfbe189c535c6ada">01353</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a127e3d16c986f858bfbe189c535c6ada" title="Digital signature object ID.">$sig_obj_id</a> = 0;
<a name="l01354"></a>01354 <span class="comment"></span>
<a name="l01355"></a>01355 <span class="comment">    /**</span>
<a name="l01356"></a>01356 <span class="comment">     * ByteRange placemark used during digital signature process.</span>
<a name="l01357"></a>01357 <span class="comment">     * @protected</span>
<a name="l01358"></a>01358 <span class="comment">     * @since 4.6.028 (2009-08-25)</span>
<a name="l01359"></a>01359 <span class="comment">     */</span>
<a name="l01360"></a><a class="code" href="classTCPDF.html#a5bf0155b70df30cd26c6d550356e8a4d">01360</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5bf0155b70df30cd26c6d550356e8a4d" title="ByteRange placemark used during digital signature process.">$byterange_string</a> = <span class="stringliteral">&#39;/ByteRange[0 ********** ********** **********]&#39;</span>;
<a name="l01361"></a>01361 <span class="comment"></span>
<a name="l01362"></a>01362 <span class="comment">    /**</span>
<a name="l01363"></a>01363 <span class="comment">     * Placemark used during digital signature process.</span>
<a name="l01364"></a>01364 <span class="comment">     * @protected</span>
<a name="l01365"></a>01365 <span class="comment">     * @since 4.6.028 (2009-08-25)</span>
<a name="l01366"></a>01366 <span class="comment">     */</span>
<a name="l01367"></a><a class="code" href="classTCPDF.html#ac311299f9bfae2b38d8f7904267f939b">01367</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ac311299f9bfae2b38d8f7904267f939b" title="Placemark used during digital signature process.">$sig_annot_ref</a> = <span class="stringliteral">&#39;***SIGANNREF*** 0 R&#39;</span>;
<a name="l01368"></a>01368 <span class="comment"></span>
<a name="l01369"></a>01369 <span class="comment">    /**</span>
<a name="l01370"></a>01370 <span class="comment">     * ID of page objects.</span>
<a name="l01371"></a>01371 <span class="comment">     * @protected</span>
<a name="l01372"></a>01372 <span class="comment">     * @since 4.7.000 (2009-08-29)</span>
<a name="l01373"></a>01373 <span class="comment">     */</span>
<a name="l01374"></a><a class="code" href="classTCPDF.html#a104cb1d0c57aea34a2a29edcb85fd772">01374</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a104cb1d0c57aea34a2a29edcb85fd772" title="ID of page objects.">$page_obj_id</a> = array();
<a name="l01375"></a>01375 <span class="comment"></span>
<a name="l01376"></a>01376 <span class="comment">    /**</span>
<a name="l01377"></a>01377 <span class="comment">     * List of form annotations IDs.</span>
<a name="l01378"></a>01378 <span class="comment">     * @protected</span>
<a name="l01379"></a>01379 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l01380"></a>01380 <span class="comment">     */</span>
<a name="l01381"></a><a class="code" href="classTCPDF.html#ab2887c4ed584490249c4964a4ec0e2fc">01381</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab2887c4ed584490249c4964a4ec0e2fc" title="List of form annotations IDs.">$form_obj_id</a> = array();
<a name="l01382"></a>01382 <span class="comment"></span>
<a name="l01383"></a>01383 <span class="comment">    /**</span>
<a name="l01384"></a>01384 <span class="comment">     * Deafult Javascript field properties. Possible values are described on official Javascript for Acrobat API reference. Annotation options can be directly specified using the &#39;aopt&#39; entry.</span>
<a name="l01385"></a>01385 <span class="comment">     * @protected</span>
<a name="l01386"></a>01386 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l01387"></a>01387 <span class="comment">     */</span>
<a name="l01388"></a><a class="code" href="classTCPDF.html#aac92d698d00f2c049c2941a6faa8253b">01388</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aac92d698d00f2c049c2941a6faa8253b" title="Deafult Javascript field properties.">$default_form_prop</a> = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;solid&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(255, 255, 255), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(128, 128, 128));
<a name="l01389"></a>01389 <span class="comment"></span>
<a name="l01390"></a>01390 <span class="comment">    /**</span>
<a name="l01391"></a>01391 <span class="comment">     * Javascript objects array.</span>
<a name="l01392"></a>01392 <span class="comment">     * @protected</span>
<a name="l01393"></a>01393 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l01394"></a>01394 <span class="comment">     */</span>
<a name="l01395"></a><a class="code" href="classTCPDF.html#a5eeae8e0584a2f04846aea057780fd39">01395</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5eeae8e0584a2f04846aea057780fd39" title="Javascript objects array.">$js_objects</a> = array();
<a name="l01396"></a>01396 <span class="comment"></span>
<a name="l01397"></a>01397 <span class="comment">    /**</span>
<a name="l01398"></a>01398 <span class="comment">     * Current form action (used during XHTML rendering).</span>
<a name="l01399"></a>01399 <span class="comment">     * @protected</span>
<a name="l01400"></a>01400 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l01401"></a>01401 <span class="comment">     */</span>
<a name="l01402"></a><a class="code" href="classTCPDF.html#a1302a2cfd195515184e2baab0ab20c7e">01402</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a1302a2cfd195515184e2baab0ab20c7e" title="Current form action (used during XHTML rendering).">$form_action</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01403"></a>01403 <span class="comment"></span>
<a name="l01404"></a>01404 <span class="comment">    /**</span>
<a name="l01405"></a>01405 <span class="comment">     * Current form encryption type (used during XHTML rendering).</span>
<a name="l01406"></a>01406 <span class="comment">     * @protected</span>
<a name="l01407"></a>01407 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l01408"></a>01408 <span class="comment">     */</span>
<a name="l01409"></a><a class="code" href="classTCPDF.html#a792338a2edffd53283684c4b355611c7">01409</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a792338a2edffd53283684c4b355611c7" title="Current form encryption type (used during XHTML rendering).">$form_enctype</a> = <span class="stringliteral">&#39;application/x-www-form-urlencoded&#39;</span>;
<a name="l01410"></a>01410 <span class="comment"></span>
<a name="l01411"></a>01411 <span class="comment">    /**</span>
<a name="l01412"></a>01412 <span class="comment">     * Current method to submit forms.</span>
<a name="l01413"></a>01413 <span class="comment">     * @protected</span>
<a name="l01414"></a>01414 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l01415"></a>01415 <span class="comment">     */</span>
<a name="l01416"></a><a class="code" href="classTCPDF.html#a1fb5403b2b6997d476dc797787065bf4">01416</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a1fb5403b2b6997d476dc797787065bf4" title="Current method to submit forms.">$form_mode</a> = <span class="stringliteral">&#39;post&#39;</span>;
<a name="l01417"></a>01417 <span class="comment"></span>
<a name="l01418"></a>01418 <span class="comment">    /**</span>
<a name="l01419"></a>01419 <span class="comment">     * List of fonts used on form fields (fontname =&gt; fontkey).</span>
<a name="l01420"></a>01420 <span class="comment">     * @protected</span>
<a name="l01421"></a>01421 <span class="comment">     * @since 4.8.001 (2009-09-09)</span>
<a name="l01422"></a>01422 <span class="comment">     */</span>
<a name="l01423"></a><a class="code" href="classTCPDF.html#a30c63dd9a18c06de743d3d6423e15a0d">01423</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a30c63dd9a18c06de743d3d6423e15a0d" title="List of fonts used on form fields (fontname =&gt; fontkey).">$annotation_fonts</a> = array();
<a name="l01424"></a>01424 <span class="comment"></span>
<a name="l01425"></a>01425 <span class="comment">    /**</span>
<a name="l01426"></a>01426 <span class="comment">     * List of radio buttons parent objects.</span>
<a name="l01427"></a>01427 <span class="comment">     * @protected</span>
<a name="l01428"></a>01428 <span class="comment">     * @since 4.8.001 (2009-09-09)</span>
<a name="l01429"></a>01429 <span class="comment">     */</span>
<a name="l01430"></a><a class="code" href="classTCPDF.html#ac1fbdc28360fd6efe6539755b08b321e">01430</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ac1fbdc28360fd6efe6539755b08b321e" title="List of radio buttons parent objects.">$radiobutton_groups</a> = array();
<a name="l01431"></a>01431 <span class="comment"></span>
<a name="l01432"></a>01432 <span class="comment">    /**</span>
<a name="l01433"></a>01433 <span class="comment">     * List of radio group objects IDs.</span>
<a name="l01434"></a>01434 <span class="comment">     * @protected</span>
<a name="l01435"></a>01435 <span class="comment">     * @since 4.8.001 (2009-09-09)</span>
<a name="l01436"></a>01436 <span class="comment">     */</span>
<a name="l01437"></a><a class="code" href="classTCPDF.html#aa6f690ff30d06f1a76086ea16b24f3dd">01437</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aa6f690ff30d06f1a76086ea16b24f3dd" title="List of radio group objects IDs.">$radio_groups</a> = array();
<a name="l01438"></a>01438 <span class="comment"></span>
<a name="l01439"></a>01439 <span class="comment">    /**</span>
<a name="l01440"></a>01440 <span class="comment">     * Text indentation value (used for text-indent CSS attribute).</span>
<a name="l01441"></a>01441 <span class="comment">     * @protected</span>
<a name="l01442"></a>01442 <span class="comment">     * @since 4.8.006 (2009-09-23)</span>
<a name="l01443"></a>01443 <span class="comment">     */</span>
<a name="l01444"></a><a class="code" href="classTCPDF.html#ade9ed50def3b504470fe4f157092e7e2">01444</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ade9ed50def3b504470fe4f157092e7e2" title="Text indentation value (used for text-indent CSS attribute).">$textindent</a> = 0;
<a name="l01445"></a>01445 <span class="comment"></span>
<a name="l01446"></a>01446 <span class="comment">    /**</span>
<a name="l01447"></a>01447 <span class="comment">     * Store page number when startTransaction() is called.</span>
<a name="l01448"></a>01448 <span class="comment">     * @protected</span>
<a name="l01449"></a>01449 <span class="comment">     * @since 4.8.006 (2009-09-23)</span>
<a name="l01450"></a>01450 <span class="comment">     */</span>
<a name="l01451"></a><a class="code" href="classTCPDF.html#a9c8927b37b10208b3793fc9e05e14ab4">01451</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a9c8927b37b10208b3793fc9e05e14ab4" title="Store page number when startTransaction() is called.">$start_transaction_page</a> = 0;
<a name="l01452"></a>01452 <span class="comment"></span>
<a name="l01453"></a>01453 <span class="comment">    /**</span>
<a name="l01454"></a>01454 <span class="comment">     * Store Y position when startTransaction() is called.</span>
<a name="l01455"></a>01455 <span class="comment">     * @protected</span>
<a name="l01456"></a>01456 <span class="comment">     * @since 4.9.001 (2010-03-28)</span>
<a name="l01457"></a>01457 <span class="comment">     */</span>
<a name="l01458"></a><a class="code" href="classTCPDF.html#ac168053a0ff19f84a7da3d525fa9b9a2">01458</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ac168053a0ff19f84a7da3d525fa9b9a2" title="Store Y position when startTransaction() is called.">$start_transaction_y</a> = 0;
<a name="l01459"></a>01459 <span class="comment"></span>
<a name="l01460"></a>01460 <span class="comment">    /**</span>
<a name="l01461"></a>01461 <span class="comment">     * True when we are printing the thead section on a new page.</span>
<a name="l01462"></a>01462 <span class="comment">     * @protected</span>
<a name="l01463"></a>01463 <span class="comment">     * @since 4.8.027 (2010-01-25)</span>
<a name="l01464"></a>01464 <span class="comment">     */</span>
<a name="l01465"></a><a class="code" href="classTCPDF.html#a12c5aa5d0e1d13569bdb1ca8e6442884">01465</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a12c5aa5d0e1d13569bdb1ca8e6442884" title="True when we are printing the thead section on a new page.">$inthead</a> = <span class="keyword">false</span>;
<a name="l01466"></a>01466 <span class="comment"></span>
<a name="l01467"></a>01467 <span class="comment">    /**</span>
<a name="l01468"></a>01468 <span class="comment">     * Array of column measures (width, space, starting Y position).</span>
<a name="l01469"></a>01469 <span class="comment">     * @protected</span>
<a name="l01470"></a>01470 <span class="comment">     * @since 4.9.001 (2010-03-28)</span>
<a name="l01471"></a>01471 <span class="comment">     */</span>
<a name="l01472"></a><a class="code" href="classTCPDF.html#a860b030382957cd7a0835bb67d6e792c">01472</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a860b030382957cd7a0835bb67d6e792c" title="Array of column measures (width, space, starting Y position).">$columns</a> = array();
<a name="l01473"></a>01473 <span class="comment"></span>
<a name="l01474"></a>01474 <span class="comment">    /**</span>
<a name="l01475"></a>01475 <span class="comment">     * Number of colums.</span>
<a name="l01476"></a>01476 <span class="comment">     * @protected</span>
<a name="l01477"></a>01477 <span class="comment">     * @since 4.9.001 (2010-03-28)</span>
<a name="l01478"></a>01478 <span class="comment">     */</span>
<a name="l01479"></a><a class="code" href="classTCPDF.html#aea769a906ed606706e862bd7576e9a34">01479</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aea769a906ed606706e862bd7576e9a34" title="Number of colums.">$num_columns</a> = 1;
<a name="l01480"></a>01480 <span class="comment"></span>
<a name="l01481"></a>01481 <span class="comment">    /**</span>
<a name="l01482"></a>01482 <span class="comment">     * Current column number.</span>
<a name="l01483"></a>01483 <span class="comment">     * @protected</span>
<a name="l01484"></a>01484 <span class="comment">     * @since 4.9.001 (2010-03-28)</span>
<a name="l01485"></a>01485 <span class="comment">     */</span>
<a name="l01486"></a><a class="code" href="classTCPDF.html#aab81c25eefaf486adf004eb20bc22881">01486</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aab81c25eefaf486adf004eb20bc22881" title="Current column number.">$current_column</a> = 0;
<a name="l01487"></a>01487 <span class="comment"></span>
<a name="l01488"></a>01488 <span class="comment">    /**</span>
<a name="l01489"></a>01489 <span class="comment">     * Starting page for columns.</span>
<a name="l01490"></a>01490 <span class="comment">     * @protected</span>
<a name="l01491"></a>01491 <span class="comment">     * @since 4.9.001 (2010-03-28)</span>
<a name="l01492"></a>01492 <span class="comment">     */</span>
<a name="l01493"></a><a class="code" href="classTCPDF.html#af7f6494da3088dec66ca1172c546c9e2">01493</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#af7f6494da3088dec66ca1172c546c9e2" title="Starting page for columns.">$column_start_page</a> = 0;
<a name="l01494"></a>01494 <span class="comment"></span>
<a name="l01495"></a>01495 <span class="comment">    /**</span>
<a name="l01496"></a>01496 <span class="comment">     * Maximum page and column selected.</span>
<a name="l01497"></a>01497 <span class="comment">     * @protected</span>
<a name="l01498"></a>01498 <span class="comment">     * @since 5.8.000 (2010-08-11)</span>
<a name="l01499"></a>01499 <span class="comment">     */</span>
<a name="l01500"></a><a class="code" href="classTCPDF.html#ae738323ab05788503f5d9772a397c8d0">01500</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ae738323ab05788503f5d9772a397c8d0" title="Maximum page and column selected.">$maxselcol</a> = array(<span class="stringliteral">&#39;page&#39;</span> =&gt; 0, <span class="stringliteral">&#39;column&#39;</span> =&gt; 0);
<a name="l01501"></a>01501 <span class="comment"></span>
<a name="l01502"></a>01502 <span class="comment">    /**</span>
<a name="l01503"></a>01503 <span class="comment">     * Array of: X difference between table cell x start and starting page margin, cellspacing, cellpadding.</span>
<a name="l01504"></a>01504 <span class="comment">     * @protected</span>
<a name="l01505"></a>01505 <span class="comment">     * @since 5.8.000 (2010-08-11)</span>
<a name="l01506"></a>01506 <span class="comment">     */</span>
<a name="l01507"></a><a class="code" href="classTCPDF.html#a0199618a45cf13b30bf23d044e4c8103">01507</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a0199618a45cf13b30bf23d044e4c8103" title="Array of: X difference between table cell x start and starting page margin, cellspacing, cellpadding.">$colxshift</a> = array(<span class="charliteral">&#39;x&#39;</span> =&gt; 0, <span class="charliteral">&#39;s&#39;</span> =&gt; array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0), <span class="charliteral">&#39;p&#39;</span> =&gt; array(<span class="charliteral">&#39;L&#39;</span> =&gt; 0, <span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0));
<a name="l01508"></a>01508 <span class="comment"></span>
<a name="l01509"></a>01509 <span class="comment">    /**</span>
<a name="l01510"></a>01510 <span class="comment">     * Text rendering mode: 0 = Fill text; 1 = Stroke text; 2 = Fill, then stroke text; 3 = Neither fill nor stroke text (invisible); 4 = Fill text and add to path for clipping; 5 = Stroke text and add to path for clipping; 6 = Fill, then stroke text and add to path for clipping; 7 = Add text to path for clipping.</span>
<a name="l01511"></a>01511 <span class="comment">     * @protected</span>
<a name="l01512"></a>01512 <span class="comment">     * @since 4.9.008 (2010-04-03)</span>
<a name="l01513"></a>01513 <span class="comment">     */</span>
<a name="l01514"></a><a class="code" href="classTCPDF.html#a45310f49168f541285b71f190645ff45">01514</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a45310f49168f541285b71f190645ff45" title="Text rendering mode: 0 = Fill text; 1 = Stroke text; 2 = Fill, then stroke text; 3 = Neither fill nor...">$textrendermode</a> = 0;
<a name="l01515"></a>01515 <span class="comment"></span>
<a name="l01516"></a>01516 <span class="comment">    /**</span>
<a name="l01517"></a>01517 <span class="comment">     * Text stroke width in doc units.</span>
<a name="l01518"></a>01518 <span class="comment">     * @protected</span>
<a name="l01519"></a>01519 <span class="comment">     * @since 4.9.008 (2010-04-03)</span>
<a name="l01520"></a>01520 <span class="comment">     */</span>
<a name="l01521"></a><a class="code" href="classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922">01521</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922" title="Text stroke width in doc units.">$textstrokewidth</a> = 0;
<a name="l01522"></a>01522 <span class="comment"></span>
<a name="l01523"></a>01523 <span class="comment">    /**</span>
<a name="l01524"></a>01524 <span class="comment">     * Current stroke color.</span>
<a name="l01525"></a>01525 <span class="comment">     * @protected</span>
<a name="l01526"></a>01526 <span class="comment">     * @since 4.9.008 (2010-04-03)</span>
<a name="l01527"></a>01527 <span class="comment">     */</span>
<a name="l01528"></a><a class="code" href="classTCPDF.html#aa24f8123d1e2d35446002d13a9715850">01528</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aa24f8123d1e2d35446002d13a9715850" title="Current stroke color.">$strokecolor</a>;
<a name="l01529"></a>01529 <span class="comment"></span>
<a name="l01530"></a>01530 <span class="comment">    /**</span>
<a name="l01531"></a>01531 <span class="comment">     * Default unit of measure for document.</span>
<a name="l01532"></a>01532 <span class="comment">     * @protected</span>
<a name="l01533"></a>01533 <span class="comment">     * @since 5.0.000 (2010-04-22)</span>
<a name="l01534"></a>01534 <span class="comment">     */</span>
<a name="l01535"></a><a class="code" href="classTCPDF.html#a06741a9ee7ad2babd6c212d50701dca8">01535</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a06741a9ee7ad2babd6c212d50701dca8" title="Default unit of measure for document.">$pdfunit</a> = <span class="stringliteral">&#39;mm&#39;</span>;
<a name="l01536"></a>01536 <span class="comment"></span>
<a name="l01537"></a>01537 <span class="comment">    /**</span>
<a name="l01538"></a>01538 <span class="comment">     * Boolean flag true when we are on TOC (Table Of Content) page.</span>
<a name="l01539"></a>01539 <span class="comment">     * @protected</span>
<a name="l01540"></a>01540 <span class="comment">     */</span>
<a name="l01541"></a><a class="code" href="classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f">01541</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f" title="Boolean flag true when we are on TOC (Table Of Content) page.">$tocpage</a> = <span class="keyword">false</span>;
<a name="l01542"></a>01542 <span class="comment"></span>
<a name="l01543"></a>01543 <span class="comment">    /**</span>
<a name="l01544"></a>01544 <span class="comment">     * Boolean flag: if true convert vector images (SVG, EPS) to raster image using GD or ImageMagick library.</span>
<a name="l01545"></a>01545 <span class="comment">     * @protected</span>
<a name="l01546"></a>01546 <span class="comment">     * @since 5.0.000 (2010-04-26)</span>
<a name="l01547"></a>01547 <span class="comment">     */</span>
<a name="l01548"></a><a class="code" href="classTCPDF.html#adaa629208532173a3e3bc604f32c07d8">01548</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#adaa629208532173a3e3bc604f32c07d8" title="Boolean flag: if true convert vector images (SVG, EPS) to raster image using GD or ImageMagick librar...">$rasterize_vector_images</a> = <span class="keyword">false</span>;
<a name="l01549"></a>01549 <span class="comment"></span>
<a name="l01550"></a>01550 <span class="comment">    /**</span>
<a name="l01551"></a>01551 <span class="comment">     * Boolean flag: if true enables font subsetting by default.</span>
<a name="l01552"></a>01552 <span class="comment">     * @protected</span>
<a name="l01553"></a>01553 <span class="comment">     * @since 5.3.002 (2010-06-07)</span>
<a name="l01554"></a>01554 <span class="comment">     */</span>
<a name="l01555"></a><a class="code" href="classTCPDF.html#ad12417c3708effd84de35320ac10077a">01555</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ad12417c3708effd84de35320ac10077a" title="Boolean flag: if true enables font subsetting by default.">$font_subsetting</a> = <span class="keyword">true</span>;
<a name="l01556"></a>01556 <span class="comment"></span>
<a name="l01557"></a>01557 <span class="comment">    /**</span>
<a name="l01558"></a>01558 <span class="comment">     * Array of default graphic settings.</span>
<a name="l01559"></a>01559 <span class="comment">     * @protected</span>
<a name="l01560"></a>01560 <span class="comment">     * @since 5.5.008 (2010-07-02)</span>
<a name="l01561"></a>01561 <span class="comment">     */</span>
<a name="l01562"></a><a class="code" href="classTCPDF.html#a642af8de9018d16a0b916dd0d3f20ea8">01562</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a642af8de9018d16a0b916dd0d3f20ea8" title="Array of default graphic settings.">$default_graphic_vars</a> = array();
<a name="l01563"></a>01563 <span class="comment"></span>
<a name="l01564"></a>01564 <span class="comment">    /**</span>
<a name="l01565"></a>01565 <span class="comment">     * Array of XObjects.</span>
<a name="l01566"></a>01566 <span class="comment">     * @protected</span>
<a name="l01567"></a>01567 <span class="comment">     * @since 5.8.014 (2010-08-23)</span>
<a name="l01568"></a>01568 <span class="comment">     */</span>
<a name="l01569"></a><a class="code" href="classTCPDF.html#ab3fe86d6cc29768a5f1559585015e711">01569</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ab3fe86d6cc29768a5f1559585015e711" title="Array of XObjects.">$xobjects</a> = array();
<a name="l01570"></a>01570 <span class="comment"></span>
<a name="l01571"></a>01571 <span class="comment">    /**</span>
<a name="l01572"></a>01572 <span class="comment">     * Boolean value true when we are inside an XObject.</span>
<a name="l01573"></a>01573 <span class="comment">     * @protected</span>
<a name="l01574"></a>01574 <span class="comment">     * @since 5.8.017 (2010-08-24)</span>
<a name="l01575"></a>01575 <span class="comment">     */</span>
<a name="l01576"></a><a class="code" href="classTCPDF.html#aec5762185293ba0a36782ceeaba19a94">01576</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aec5762185293ba0a36782ceeaba19a94" title="Boolean value true when we are inside an XObject.">$inxobj</a> = <span class="keyword">false</span>;
<a name="l01577"></a>01577 <span class="comment"></span>
<a name="l01578"></a>01578 <span class="comment">    /**</span>
<a name="l01579"></a>01579 <span class="comment">     * Current XObject ID.</span>
<a name="l01580"></a>01580 <span class="comment">     * @protected</span>
<a name="l01581"></a>01581 <span class="comment">     * @since 5.8.017 (2010-08-24)</span>
<a name="l01582"></a>01582 <span class="comment">     */</span>
<a name="l01583"></a><a class="code" href="classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">01583</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117" title="Current XObject ID.">$xobjid</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01584"></a>01584 <span class="comment"></span>
<a name="l01585"></a>01585 <span class="comment">    /**</span>
<a name="l01586"></a>01586 <span class="comment">     * Percentage of character stretching.</span>
<a name="l01587"></a>01587 <span class="comment">     * @protected</span>
<a name="l01588"></a>01588 <span class="comment">     * @since 5.9.000 (2010-09-29)</span>
<a name="l01589"></a>01589 <span class="comment">     */</span>
<a name="l01590"></a><a class="code" href="classTCPDF.html#a420a1fac2969936a7d57f4cb9c99849b">01590</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a420a1fac2969936a7d57f4cb9c99849b" title="Percentage of character stretching.">$font_stretching</a> = 100;
<a name="l01591"></a>01591 <span class="comment"></span>
<a name="l01592"></a>01592 <span class="comment">    /**</span>
<a name="l01593"></a>01593 <span class="comment">     * Increases or decreases the space between characters in a text by the specified amount (tracking/kerning).</span>
<a name="l01594"></a>01594 <span class="comment">     * @protected</span>
<a name="l01595"></a>01595 <span class="comment">     * @since 5.9.000 (2010-09-29)</span>
<a name="l01596"></a>01596 <span class="comment">     */</span>
<a name="l01597"></a><a class="code" href="classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf">01597</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf" title="Increases or decreases the space between characters in a text by the specified amount (tracking/kerni...">$font_spacing</a> = 0;
<a name="l01598"></a>01598 <span class="comment"></span>
<a name="l01599"></a>01599 <span class="comment">    /**</span>
<a name="l01600"></a>01600 <span class="comment">     * Array of no-write regions.</span>
<a name="l01601"></a>01601 <span class="comment">     * (&#39;page&#39; =&gt; page number or empy for current page, &#39;xt&#39; =&gt; X top, &#39;yt&#39; =&gt; Y top, &#39;xb&#39; =&gt; X bottom, &#39;yb&#39; =&gt; Y bottom, &#39;side&#39; =&gt; page side &#39;L&#39; = left or &#39;R&#39; = right)</span>
<a name="l01602"></a>01602 <span class="comment">     * @protected</span>
<a name="l01603"></a>01603 <span class="comment">     * @since 5.9.003 (2010-10-14)</span>
<a name="l01604"></a>01604 <span class="comment">     */</span>
<a name="l01605"></a><a class="code" href="classTCPDF.html#a26a8652b0892c721a2904e0b3676682e">01605</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a26a8652b0892c721a2904e0b3676682e" title="Array of no-write regions.">$page_regions</a> = array();
<a name="l01606"></a>01606 <span class="comment"></span>
<a name="l01607"></a>01607 <span class="comment">    /**</span>
<a name="l01608"></a>01608 <span class="comment">     * Array containing HTML color names and values.</span>
<a name="l01609"></a>01609 <span class="comment">     * @protected</span>
<a name="l01610"></a>01610 <span class="comment">     * @since 5.9.004 (2010-10-18)</span>
<a name="l01611"></a>01611 <span class="comment">     */</span>
<a name="l01612"></a><a class="code" href="classTCPDF.html#a8f85ae8269e0546b1c283c49e5cc0f29">01612</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a8f85ae8269e0546b1c283c49e5cc0f29" title="Array containing HTML color names and values.">$webcolor</a> = array();
<a name="l01613"></a>01613 <span class="comment"></span>
<a name="l01614"></a>01614 <span class="comment">    /**</span>
<a name="l01615"></a>01615 <span class="comment">     * Array containing spot color names and values.</span>
<a name="l01616"></a>01616 <span class="comment">     * @protected</span>
<a name="l01617"></a>01617 <span class="comment">     * @since 5.9.012 (2010-11-11)</span>
<a name="l01618"></a>01618 <span class="comment">     */</span>
<a name="l01619"></a><a class="code" href="classTCPDF.html#a5d5366fdb9fc2ad74898e5fc149e801c">01619</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a5d5366fdb9fc2ad74898e5fc149e801c" title="Array containing spot color names and values.">$spotcolor</a> = array();
<a name="l01620"></a>01620 <span class="comment"></span>
<a name="l01621"></a>01621 <span class="comment">    /**</span>
<a name="l01622"></a>01622 <span class="comment">     * Array of PDF layers data.</span>
<a name="l01623"></a>01623 <span class="comment">     * @protected</span>
<a name="l01624"></a>01624 <span class="comment">     * @since 5.9.102 (2011-07-13)</span>
<a name="l01625"></a>01625 <span class="comment">     */</span>
<a name="l01626"></a><a class="code" href="classTCPDF.html#aaf231db32674770a4a2f254f22f5f826">01626</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aaf231db32674770a4a2f254f22f5f826" title="Array of PDF layers data.">$pdflayers</a> = array();
<a name="l01627"></a>01627 <span class="comment"></span>
<a name="l01628"></a>01628 <span class="comment">    /**</span>
<a name="l01629"></a>01629 <span class="comment">     * A dictionary of names and corresponding destinations (Dests key on document Catalog).</span>
<a name="l01630"></a>01630 <span class="comment">     * @protected</span>
<a name="l01631"></a>01631 <span class="comment">     * @since 5.9.097 (2011-06-23)</span>
<a name="l01632"></a>01632 <span class="comment">     */</span>
<a name="l01633"></a><a class="code" href="classTCPDF.html#a75ae8e6fcf6f618c962e18dc11987753">01633</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a75ae8e6fcf6f618c962e18dc11987753" title="A dictionary of names and corresponding destinations (Dests key on document Catalog).">$dests</a> = array();
<a name="l01634"></a>01634 <span class="comment"></span>
<a name="l01635"></a>01635 <span class="comment">    /**</span>
<a name="l01636"></a>01636 <span class="comment">     * Object ID for Named Destinations</span>
<a name="l01637"></a>01637 <span class="comment">     * @protected</span>
<a name="l01638"></a>01638 <span class="comment">     * @since 5.9.097 (2011-06-23)</span>
<a name="l01639"></a>01639 <span class="comment">     */</span>
<a name="l01640"></a><a class="code" href="classTCPDF.html#ac3f2312e2cdab48afc7999ee05ae71cb">01640</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ac3f2312e2cdab48afc7999ee05ae71cb" title="Object ID for Named Destinations.">$n_dests</a>;
<a name="l01641"></a>01641 <span class="comment"></span>
<a name="l01642"></a>01642 <span class="comment">    /**</span>
<a name="l01643"></a>01643 <span class="comment">     * Directory used for the last SVG image.</span>
<a name="l01644"></a>01644 <span class="comment">     * @protected</span>
<a name="l01645"></a>01645 <span class="comment">     * @since 5.0.000 (2010-05-05)</span>
<a name="l01646"></a>01646 <span class="comment">     */</span>
<a name="l01647"></a><a class="code" href="classTCPDF.html#a94d0edc7f6a71717a136e8408372cc22">01647</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a94d0edc7f6a71717a136e8408372cc22" title="Directory used for the last SVG image.">$svgdir</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01648"></a>01648 <span class="comment"></span>
<a name="l01649"></a>01649 <span class="comment">    /**</span>
<a name="l01650"></a>01650 <span class="comment">     *  Deafult unit of measure for SVG.</span>
<a name="l01651"></a>01651 <span class="comment">     * @protected</span>
<a name="l01652"></a>01652 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01653"></a>01653 <span class="comment">     */</span>
<a name="l01654"></a><a class="code" href="classTCPDF.html#a54142bcb00841f1e2be988fe37ad8dde">01654</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a54142bcb00841f1e2be988fe37ad8dde" title="Deafult unit of measure for SVG.">$svgunit</a> = <span class="stringliteral">&#39;px&#39;</span>;
<a name="l01655"></a>01655 <span class="comment"></span>
<a name="l01656"></a>01656 <span class="comment">    /**</span>
<a name="l01657"></a>01657 <span class="comment">     * Array of SVG gradients.</span>
<a name="l01658"></a>01658 <span class="comment">     * @protected</span>
<a name="l01659"></a>01659 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01660"></a>01660 <span class="comment">     */</span>
<a name="l01661"></a><a class="code" href="classTCPDF.html#af4d75f0ad6d41ae94761b18f520eaaa8">01661</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#af4d75f0ad6d41ae94761b18f520eaaa8" title="Array of SVG gradients.">$svggradients</a> = array();
<a name="l01662"></a>01662 <span class="comment"></span>
<a name="l01663"></a>01663 <span class="comment">    /**</span>
<a name="l01664"></a>01664 <span class="comment">     * ID of last SVG gradient.</span>
<a name="l01665"></a>01665 <span class="comment">     * @protected</span>
<a name="l01666"></a>01666 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01667"></a>01667 <span class="comment">     */</span>
<a name="l01668"></a><a class="code" href="classTCPDF.html#a295aec7c13f7d3c3a5e3b17a8d833cb2">01668</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a295aec7c13f7d3c3a5e3b17a8d833cb2" title="ID of last SVG gradient.">$svggradientid</a> = 0;
<a name="l01669"></a>01669 <span class="comment"></span>
<a name="l01670"></a>01670 <span class="comment">    /**</span>
<a name="l01671"></a>01671 <span class="comment">     * Boolean value true when in SVG defs group.</span>
<a name="l01672"></a>01672 <span class="comment">     * @protected</span>
<a name="l01673"></a>01673 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01674"></a>01674 <span class="comment">     */</span>
<a name="l01675"></a><a class="code" href="classTCPDF.html#a62459f3a2f6d85c0deb15f1f0ad30d0b">01675</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a62459f3a2f6d85c0deb15f1f0ad30d0b" title="Boolean value true when in SVG defs group.">$svgdefsmode</a> = <span class="keyword">false</span>;
<a name="l01676"></a>01676 <span class="comment"></span>
<a name="l01677"></a>01677 <span class="comment">    /**</span>
<a name="l01678"></a>01678 <span class="comment">     * Array of SVG defs.</span>
<a name="l01679"></a>01679 <span class="comment">     * @protected</span>
<a name="l01680"></a>01680 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01681"></a>01681 <span class="comment">     */</span>
<a name="l01682"></a><a class="code" href="classTCPDF.html#a3f214500dcd7555dd9e7cfc2a0130086">01682</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a3f214500dcd7555dd9e7cfc2a0130086" title="Array of SVG defs.">$svgdefs</a> = array();
<a name="l01683"></a>01683 <span class="comment"></span>
<a name="l01684"></a>01684 <span class="comment">    /**</span>
<a name="l01685"></a>01685 <span class="comment">     * Boolean value true when in SVG clipPath tag.</span>
<a name="l01686"></a>01686 <span class="comment">     * @protected</span>
<a name="l01687"></a>01687 <span class="comment">     * @since 5.0.000 (2010-04-26)</span>
<a name="l01688"></a>01688 <span class="comment">     */</span>
<a name="l01689"></a><a class="code" href="classTCPDF.html#a569179128414ccd12d17e0c7cbbd121f">01689</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a569179128414ccd12d17e0c7cbbd121f" title="Boolean value true when in SVG clipPath tag.">$svgclipmode</a> = <span class="keyword">false</span>;
<a name="l01690"></a>01690 <span class="comment"></span>
<a name="l01691"></a>01691 <span class="comment">    /**</span>
<a name="l01692"></a>01692 <span class="comment">     * Array of SVG clipPath commands.</span>
<a name="l01693"></a>01693 <span class="comment">     * @protected</span>
<a name="l01694"></a>01694 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01695"></a>01695 <span class="comment">     */</span>
<a name="l01696"></a><a class="code" href="classTCPDF.html#a11ee884b1e2c9ef718bf9744ce942940">01696</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a11ee884b1e2c9ef718bf9744ce942940" title="Array of SVG clipPath commands.">$svgclippaths</a> = array();
<a name="l01697"></a>01697 <span class="comment"></span>
<a name="l01698"></a>01698 <span class="comment">    /**</span>
<a name="l01699"></a>01699 <span class="comment">     * Array of SVG clipPath tranformation matrix.</span>
<a name="l01700"></a>01700 <span class="comment">     * @protected</span>
<a name="l01701"></a>01701 <span class="comment">     * @since 5.8.022 (2010-08-31)</span>
<a name="l01702"></a>01702 <span class="comment">     */</span>
<a name="l01703"></a><a class="code" href="classTCPDF.html#a2748e6f033deb7641e4050e0370f1839">01703</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a2748e6f033deb7641e4050e0370f1839" title="Array of SVG clipPath tranformation matrix.">$svgcliptm</a> = array();
<a name="l01704"></a>01704 <span class="comment"></span>
<a name="l01705"></a>01705 <span class="comment">    /**</span>
<a name="l01706"></a>01706 <span class="comment">     * ID of last SVG clipPath.</span>
<a name="l01707"></a>01707 <span class="comment">     * @protected</span>
<a name="l01708"></a>01708 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01709"></a>01709 <span class="comment">     */</span>
<a name="l01710"></a><a class="code" href="classTCPDF.html#a6aa9631fbfb07623604d43d59cffeb5b">01710</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a6aa9631fbfb07623604d43d59cffeb5b" title="ID of last SVG clipPath.">$svgclipid</a> = 0;
<a name="l01711"></a>01711 <span class="comment"></span>
<a name="l01712"></a>01712 <span class="comment">    /**</span>
<a name="l01713"></a>01713 <span class="comment">     * SVG text.</span>
<a name="l01714"></a>01714 <span class="comment">     * @protected</span>
<a name="l01715"></a>01715 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01716"></a>01716 <span class="comment">     */</span>
<a name="l01717"></a><a class="code" href="classTCPDF.html#aed7678d695337818bfcc454197f8674c">01717</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aed7678d695337818bfcc454197f8674c" title="SVG text.">$svgtext</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01718"></a>01718 <span class="comment"></span>
<a name="l01719"></a>01719 <span class="comment">    /**</span>
<a name="l01720"></a>01720 <span class="comment">     * SVG text properties.</span>
<a name="l01721"></a>01721 <span class="comment">     * @protected</span>
<a name="l01722"></a>01722 <span class="comment">     * @since 5.8.013 (2010-08-23)</span>
<a name="l01723"></a>01723 <span class="comment">     */</span>
<a name="l01724"></a><a class="code" href="classTCPDF.html#ad38280c03ec462b14d73b5c042ae7a76">01724</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ad38280c03ec462b14d73b5c042ae7a76" title="SVG text properties.">$svgtextmode</a> = array();
<a name="l01725"></a>01725 <span class="comment"></span>
<a name="l01726"></a>01726 <span class="comment">    /**</span>
<a name="l01727"></a>01727 <span class="comment">     * Array of hinheritable SVG properties.</span>
<a name="l01728"></a>01728 <span class="comment">     * @protected</span>
<a name="l01729"></a>01729 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01730"></a>01730 <span class="comment">     */</span>
<a name="l01731"></a><a class="code" href="classTCPDF.html#a0b2b13129d0dace8270e15e0f572a331">01731</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a0b2b13129d0dace8270e15e0f572a331" title="Array of hinheritable SVG properties.">$svginheritprop</a> = array(<span class="stringliteral">&#39;clip-rule&#39;</span>, <span class="stringliteral">&#39;color&#39;</span>, <span class="stringliteral">&#39;color-interpolation&#39;</span>, <span class="stringliteral">&#39;color-interpolation-filters&#39;</span>, <span class="stringliteral">&#39;color-profile&#39;</span>, <span class="stringliteral">&#39;color-rendering&#39;</span>, <span class="stringliteral">&#39;cursor&#39;</span>, <span class="stringliteral">&#39;direction&#39;</span>, <span class="stringliteral">&#39;fill&#39;</span>, <span class="stringliteral">&#39;fill-opacity&#39;</span>, <span class="stringliteral">&#39;fill-rule&#39;</span>, <span class="stringliteral">&#39;font&#39;</span>, <span class="stringliteral">&#39;font-family&#39;</span>, <span class="stringliteral">&#39;font-size&#39;</span>, <span class="stringliteral">&#39;font-size-adjust&#39;</span>, <span class="stringliteral">&#39;font-stretch&#39;</span>, <span class="stringliteral">&#39;font-style&#39;</span>, <span class="stringliteral">&#39;font-variant&#39;</span>, <span class="stringliteral">&#39;font-weight&#39;</span>, <span class="stringliteral">&#39;glyph-orientation-horizontal&#39;</span>, <span class="stringliteral">&#39;glyph-orientation-vertical&#39;</span>, <span class="stringliteral">&#39;image-rendering&#39;</span>, <span class="stringliteral">&#39;kerning&#39;</span>, <span class="stringliteral">&#39;letter-spacing&#39;</span>, <span class="stringliteral">&#39;marker&#39;</span>, <span class="stringliteral">&#39;marker-end&#39;</span>, <span class="stringliteral">&#39;marker-mid&#39;</span>, <span class="stringliteral">&#39;marker-start&#39;</span>, <span class="stringliteral">&#39;pointer-events&#39;</span>, <span class="stringliteral">&#39;shape-rendering&#39;</span>, <span class="stringliteral">&#39;stroke&#39;</span>, <span class="stringliteral">&#39;stroke-dasharray&#39;</span>, <span class="stringliteral">&#39;stroke-dashoffset&#39;</span>, <span class="stringliteral">&#39;stroke-linecap&#39;</span>, <span class="stringliteral">&#39;stroke-linejoin&#39;</span>, <span class="stringliteral">&#39;stroke-miterlimit&#39;</span>, <span class="stringliteral">&#39;stroke-opacity&#39;</span>, <span class="stringliteral">&#39;stroke-width&#39;</span>, <span class="stringliteral">&#39;text-anchor&#39;</span>, <span class="stringliteral">&#39;text-rendering&#39;</span>, <span class="stringliteral">&#39;visibility&#39;</span>, <span class="stringliteral">&#39;word-spacing&#39;</span>, <span class="stringliteral">&#39;writing-mode&#39;</span>);
<a name="l01732"></a>01732 <span class="comment"></span>
<a name="l01733"></a>01733 <span class="comment">    /**</span>
<a name="l01734"></a>01734 <span class="comment">     * Array of SVG properties.</span>
<a name="l01735"></a>01735 <span class="comment">     * @protected</span>
<a name="l01736"></a>01736 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l01737"></a>01737 <span class="comment">     */</span>
<a name="l01738"></a><a class="code" href="classTCPDF.html#ad1fedbeb11482327ed38385f0d21d349">01738</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ad1fedbeb11482327ed38385f0d21d349" title="Array of SVG properties.">$svgstyles</a> = array(array(
<a name="l01739"></a>01739         <span class="stringliteral">&#39;alignment-baseline&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01740"></a>01740         <span class="stringliteral">&#39;baseline-shift&#39;</span> =&gt; <span class="stringliteral">&#39;baseline&#39;</span>,
<a name="l01741"></a>01741         <span class="stringliteral">&#39;clip&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01742"></a>01742         <span class="stringliteral">&#39;clip-path&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01743"></a>01743         <span class="stringliteral">&#39;clip-rule&#39;</span> =&gt; <span class="stringliteral">&#39;nonzero&#39;</span>,
<a name="l01744"></a>01744         <span class="stringliteral">&#39;color&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,
<a name="l01745"></a>01745         <span class="stringliteral">&#39;color-interpolation&#39;</span> =&gt; <span class="stringliteral">&#39;sRGB&#39;</span>,
<a name="l01746"></a>01746         <span class="stringliteral">&#39;color-interpolation-filters&#39;</span> =&gt; <span class="stringliteral">&#39;linearRGB&#39;</span>,
<a name="l01747"></a>01747         <span class="stringliteral">&#39;color-profile&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01748"></a>01748         <span class="stringliteral">&#39;color-rendering&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01749"></a>01749         <span class="stringliteral">&#39;cursor&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01750"></a>01750         <span class="stringliteral">&#39;direction&#39;</span> =&gt; <span class="stringliteral">&#39;ltr&#39;</span>,
<a name="l01751"></a>01751         <span class="stringliteral">&#39;display&#39;</span> =&gt; <span class="stringliteral">&#39;inline&#39;</span>,
<a name="l01752"></a>01752         <span class="stringliteral">&#39;dominant-baseline&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01753"></a>01753         <span class="stringliteral">&#39;enable-background&#39;</span> =&gt; <span class="stringliteral">&#39;accumulate&#39;</span>,
<a name="l01754"></a>01754         <span class="stringliteral">&#39;fill&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,
<a name="l01755"></a>01755         <span class="stringliteral">&#39;fill-opacity&#39;</span> =&gt; 1,
<a name="l01756"></a>01756         <span class="stringliteral">&#39;fill-rule&#39;</span> =&gt; <span class="stringliteral">&#39;nonzero&#39;</span>,
<a name="l01757"></a>01757         <span class="stringliteral">&#39;filter&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01758"></a>01758         <span class="stringliteral">&#39;flood-color&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,
<a name="l01759"></a>01759         <span class="stringliteral">&#39;flood-opacity&#39;</span> =&gt; 1,
<a name="l01760"></a>01760         <span class="stringliteral">&#39;font&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,
<a name="l01761"></a>01761         <span class="stringliteral">&#39;font-family&#39;</span> =&gt; <span class="stringliteral">&#39;helvetica&#39;</span>,
<a name="l01762"></a>01762         <span class="stringliteral">&#39;font-size&#39;</span> =&gt; <span class="stringliteral">&#39;medium&#39;</span>,
<a name="l01763"></a>01763         <span class="stringliteral">&#39;font-size-adjust&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01764"></a>01764         <span class="stringliteral">&#39;font-stretch&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,
<a name="l01765"></a>01765         <span class="stringliteral">&#39;font-style&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,
<a name="l01766"></a>01766         <span class="stringliteral">&#39;font-variant&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,
<a name="l01767"></a>01767         <span class="stringliteral">&#39;font-weight&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,
<a name="l01768"></a>01768         <span class="stringliteral">&#39;glyph-orientation-horizontal&#39;</span> =&gt; <span class="stringliteral">&#39;0deg&#39;</span>,
<a name="l01769"></a>01769         <span class="stringliteral">&#39;glyph-orientation-vertical&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01770"></a>01770         <span class="stringliteral">&#39;image-rendering&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01771"></a>01771         <span class="stringliteral">&#39;kerning&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01772"></a>01772         <span class="stringliteral">&#39;letter-spacing&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,
<a name="l01773"></a>01773         <span class="stringliteral">&#39;lighting-color&#39;</span> =&gt; <span class="stringliteral">&#39;white&#39;</span>,
<a name="l01774"></a>01774         <span class="stringliteral">&#39;marker&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,
<a name="l01775"></a>01775         <span class="stringliteral">&#39;marker-end&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01776"></a>01776         <span class="stringliteral">&#39;marker-mid&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01777"></a>01777         <span class="stringliteral">&#39;marker-start&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01778"></a>01778         <span class="stringliteral">&#39;mask&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01779"></a>01779         <span class="stringliteral">&#39;opacity&#39;</span> =&gt; 1,
<a name="l01780"></a>01780         <span class="stringliteral">&#39;overflow&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01781"></a>01781         <span class="stringliteral">&#39;pointer-events&#39;</span> =&gt; <span class="stringliteral">&#39;visiblePainted&#39;</span>,
<a name="l01782"></a>01782         <span class="stringliteral">&#39;shape-rendering&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01783"></a>01783         <span class="stringliteral">&#39;stop-color&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,
<a name="l01784"></a>01784         <span class="stringliteral">&#39;stop-opacity&#39;</span> =&gt; 1,
<a name="l01785"></a>01785         <span class="stringliteral">&#39;stroke&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01786"></a>01786         <span class="stringliteral">&#39;stroke-dasharray&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01787"></a>01787         <span class="stringliteral">&#39;stroke-dashoffset&#39;</span> =&gt; 0,
<a name="l01788"></a>01788         <span class="stringliteral">&#39;stroke-linecap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>,
<a name="l01789"></a>01789         <span class="stringliteral">&#39;stroke-linejoin&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>,
<a name="l01790"></a>01790         <span class="stringliteral">&#39;stroke-miterlimit&#39;</span> =&gt; 4,
<a name="l01791"></a>01791         <span class="stringliteral">&#39;stroke-opacity&#39;</span> =&gt; 1,
<a name="l01792"></a>01792         <span class="stringliteral">&#39;stroke-width&#39;</span> =&gt; 1,
<a name="l01793"></a>01793         <span class="stringliteral">&#39;text-anchor&#39;</span> =&gt; <span class="stringliteral">&#39;start&#39;</span>,
<a name="l01794"></a>01794         <span class="stringliteral">&#39;text-decoration&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,
<a name="l01795"></a>01795         <span class="stringliteral">&#39;text-rendering&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,
<a name="l01796"></a>01796         <span class="stringliteral">&#39;unicode-bidi&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,
<a name="l01797"></a>01797         <span class="stringliteral">&#39;visibility&#39;</span> =&gt; <span class="stringliteral">&#39;visible&#39;</span>,
<a name="l01798"></a>01798         <span class="stringliteral">&#39;word-spacing&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,
<a name="l01799"></a>01799         <span class="stringliteral">&#39;writing-mode&#39;</span> =&gt; <span class="stringliteral">&#39;lr-tb&#39;</span>,
<a name="l01800"></a>01800         <span class="stringliteral">&#39;text-color&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,
<a name="l01801"></a>01801         <span class="stringliteral">&#39;transfmatrix&#39;</span> =&gt; array(1, 0, 0, 1, 0, 0)
<a name="l01802"></a>01802         ));
<a name="l01803"></a>01803 <span class="comment"></span>
<a name="l01804"></a>01804 <span class="comment">    /**</span>
<a name="l01805"></a>01805 <span class="comment">     * If true force sRGB color profile for all document.</span>
<a name="l01806"></a>01806 <span class="comment">     * @protected</span>
<a name="l01807"></a>01807 <span class="comment">     * @since 5.9.121 (2011-09-28)</span>
<a name="l01808"></a>01808 <span class="comment">     */</span>
<a name="l01809"></a><a class="code" href="classTCPDF.html#a4702bedfb7ce4c5260c12d3637419c7a">01809</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a4702bedfb7ce4c5260c12d3637419c7a" title="If true force sRGB color profile for all document.">$force_srgb</a> = <span class="keyword">false</span>;
<a name="l01810"></a>01810 <span class="comment"></span>
<a name="l01811"></a>01811 <span class="comment">    /**</span>
<a name="l01812"></a>01812 <span class="comment">     * If true set the document to PDF/A mode.</span>
<a name="l01813"></a>01813 <span class="comment">     * @protected</span>
<a name="l01814"></a>01814 <span class="comment">     * @since 5.9.121 (2011-09-27)</span>
<a name="l01815"></a>01815 <span class="comment">     */</span>
<a name="l01816"></a><a class="code" href="classTCPDF.html#aac34b7d5674382a748a05db919fbe759">01816</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#aac34b7d5674382a748a05db919fbe759" title="If true set the document to PDF/A mode.">$pdfa_mode</a> = <span class="keyword">false</span>;
<a name="l01817"></a>01817 <span class="comment"></span>
<a name="l01818"></a>01818 <span class="comment">    /**</span>
<a name="l01819"></a>01819 <span class="comment">     * Document creation date</span>
<a name="l01820"></a>01820 <span class="comment">     * @protected</span>
<a name="l01821"></a>01821 <span class="comment">     * @since 5.9.121 (2011-09-28)</span>
<a name="l01822"></a>01822 <span class="comment">     */</span>
<a name="l01823"></a><a class="code" href="classTCPDF.html#ac939132b648610a80d1ce7df6ba2650c">01823</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#ac939132b648610a80d1ce7df6ba2650c" title="Document creation date.">$doc_date</a>;
<a name="l01824"></a>01824 <span class="comment"></span>
<a name="l01825"></a>01825 <span class="comment">    /**</span>
<a name="l01826"></a>01826 <span class="comment">     * Custom XMP data.</span>
<a name="l01827"></a>01827 <span class="comment">     * @protected</span>
<a name="l01828"></a>01828 <span class="comment">     * @since 5.9.128 (2011-10-06)</span>
<a name="l01829"></a>01829 <span class="comment">     */</span>
<a name="l01830"></a><a class="code" href="classTCPDF.html#a08e9cd78d75c94166e9e4f629b4daa8c">01830</a>     <span class="keyword">protected</span> <a class="code" href="classTCPDF.html#a08e9cd78d75c94166e9e4f629b4daa8c" title="Custom XMP data.">$custom_xmp</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01831"></a>01831 
<a name="l01832"></a>01832     <span class="comment">//------------------------------------------------------------</span>
<a name="l01833"></a>01833     <span class="comment">// METHODS</span>
<a name="l01834"></a>01834     <span class="comment">//------------------------------------------------------------</span>
<a name="l01835"></a>01835 <span class="comment"></span>
<a name="l01836"></a>01836 <span class="comment">    /**</span>
<a name="l01837"></a>01837 <span class="comment">     * This is the class constructor.</span>
<a name="l01838"></a>01838 <span class="comment">     * It allows to set up the page format, the orientation and the measure unit used in all the methods (except for the font sizes).</span>
<a name="l01839"></a>01839 <span class="comment">     * @param $orientation (string) page orientation. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;P or Portrait (default)&lt;/li&gt;&lt;li&gt;L or Landscape&lt;/li&gt;&lt;li&gt;&#39;&#39; (empty string) for automatic orientation&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l01840"></a>01840 <span class="comment">     * @param $unit (string) User measure unit. Possible values are:&lt;ul&gt;&lt;li&gt;pt: point&lt;/li&gt;&lt;li&gt;mm: millimeter (default)&lt;/li&gt;&lt;li&gt;cm: centimeter&lt;/li&gt;&lt;li&gt;in: inch&lt;/li&gt;&lt;/ul&gt;&lt;br /&gt;A point equals 1/72 of inch, that is to say about 0.35 mm (an inch being 2.54 cm). This is a very common unit in typography; font sizes are expressed in that unit.</span>
<a name="l01841"></a>01841 <span class="comment">     * @param $format (mixed) The format used for pages. It can be either: one of the string values specified at getPageSizeFromFormat() or an array of parameters specified at setPageFormat().</span>
<a name="l01842"></a>01842 <span class="comment">     * @param $unicode (boolean) TRUE means that the input text is unicode (default = true)</span>
<a name="l01843"></a>01843 <span class="comment">     * @param $encoding (string) Charset encoding; default is UTF-8.</span>
<a name="l01844"></a>01844 <span class="comment">     * @param $diskcache (boolean) If TRUE reduce the RAM memory usage by caching temporary data on filesystem (slower).</span>
<a name="l01845"></a>01845 <span class="comment">     * @param $pdfa (boolean) If TRUE set the document to PDF/A mode.</span>
<a name="l01846"></a>01846 <span class="comment">     * @public</span>
<a name="l01847"></a>01847 <span class="comment">     * @see getPageSizeFromFormat(), setPageFormat()</span>
<a name="l01848"></a>01848 <span class="comment">     */</span>
<a name="l01849"></a><a class="code" href="classTCPDF.html#a134232ae3ad1ec186ed45046f94b7755">01849</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a134232ae3ad1ec186ed45046f94b7755" title="This is the class constructor.">__construct</a>($orientation=<span class="charliteral">&#39;P&#39;</span>, $unit=<span class="stringliteral">&#39;mm&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>=<span class="stringliteral">&#39;A4&#39;</span>, <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>=<span class="keyword">true</span>, <a class="code" href="classTCPDF.html#a274314ff17c5df9ae105f9c91893a4a7" title="Default encoding.">$encoding</a>=<span class="stringliteral">&#39;UTF-8&#39;</span>, <a class="code" href="classTCPDF.html#ae36b54ab4599f14fc4116bb77ffbcc6b" title="If true enables disk caching.">$diskcache</a>=<span class="keyword">false</span>, $pdfa=<span class="keyword">false</span>) {
<a name="l01850"></a>01850         <span class="comment">/* Set internal character encoding to ASCII */</span>
<a name="l01851"></a>01851         <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;mb_internal_encoding&#39;</span>) AND mb_internal_encoding()) {
<a name="l01852"></a>01852             $this-&gt;internal_encoding = mb_internal_encoding();
<a name="l01853"></a>01853             mb_internal_encoding(<span class="stringliteral">&#39;ASCII&#39;</span>);
<a name="l01854"></a>01854         }
<a name="l01855"></a>01855         <span class="comment">// get array of HTML colors</span>
<a name="l01856"></a>01856         require(dirname(__FILE__).<span class="stringliteral">&#39;/htmlcolors.php&#39;</span>);
<a name="l01857"></a>01857         $this-&gt;webcolor = <a class="code" href="classTCPDF.html#a8f85ae8269e0546b1c283c49e5cc0f29" title="Array containing HTML color names and values.">$webcolor</a>;
<a name="l01858"></a>01858         <span class="comment">// get array of custom spot colors</span>
<a name="l01859"></a>01859         <span class="keywordflow">if</span> (file_exists(dirname(__FILE__).<span class="stringliteral">&#39;/spotcolors.php&#39;</span>)) {
<a name="l01860"></a>01860             require(dirname(__FILE__).<span class="stringliteral">&#39;/spotcolors.php&#39;</span>);
<a name="l01861"></a>01861             $this-&gt;spotcolor = <a class="code" href="classTCPDF.html#a5d5366fdb9fc2ad74898e5fc149e801c" title="Array containing spot color names and values.">$spotcolor</a>;
<a name="l01862"></a>01862         } <span class="keywordflow">else</span> {
<a name="l01863"></a>01863             $this-&gt;spotcolor = array();
<a name="l01864"></a>01864         }
<a name="l01865"></a>01865         require_once(dirname(__FILE__).<span class="stringliteral">&#39;/unicode_data.php&#39;</span>);
<a name="l01866"></a>01866         $this-&gt;unicode = <span class="keyword">new</span> <a class="code" href="classTCPDF__UNICODE__DATA.html" title="This is a PHP class containing UnicOde data for TCPDF library.">TCPDF_UNICODE_DATA</a>();
<a name="l01867"></a>01867         require_once(dirname(__FILE__).<span class="stringliteral">&#39;/encodings_maps.php&#39;</span>);
<a name="l01868"></a>01868         $this-&gt;encmaps = <span class="keyword">new</span> <a class="code" href="classTCPDF__ENCODING__MAPS.html" title="This is a PHP class containing Font encodings maps class for TCPDF library.">TCPDF_ENCODING_MAPS</a>();
<a name="l01869"></a>01869         $this-&gt;font_obj_ids = array();
<a name="l01870"></a>01870         $this-&gt;page_obj_id = array();
<a name="l01871"></a>01871         $this-&gt;form_obj_id = array();
<a name="l01872"></a>01872         <span class="comment">// set pdf/a mode</span>
<a name="l01873"></a>01873         $this-&gt;pdfa_mode = $pdfa;
<a name="l01874"></a>01874         $this-&gt;force_srgb = <span class="keyword">false</span>;
<a name="l01875"></a>01875         <span class="comment">// set disk caching</span>
<a name="l01876"></a>01876         $this-&gt;diskcache = <a class="code" href="classTCPDF.html#ae36b54ab4599f14fc4116bb77ffbcc6b" title="If true enables disk caching.">$diskcache</a> ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l01877"></a>01877         <span class="comment">// set language direction</span>
<a name="l01878"></a>01878         $this-&gt;rtl = <span class="keyword">false</span>;
<a name="l01879"></a>01879         $this-&gt;tmprtl = <span class="keyword">false</span>;
<a name="l01880"></a>01880         <span class="comment">// some checks</span>
<a name="l01881"></a>01881         $this-&gt;<a class="code" href="classTCPDF.html#a17346daa2c4848e475ad4f408376e2c2" title="Check for locale-related bug.">_dochecks</a>();
<a name="l01882"></a>01882         <span class="comment">// initialization of properties</span>
<a name="l01883"></a>01883         $this-&gt;isunicode = <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>;
<a name="l01884"></a>01884         $this-&gt;page = 0;
<a name="l01885"></a>01885         $this-&gt;transfmrk[0] = array();
<a name="l01886"></a>01886         $this-&gt;pagedim = array();
<a name="l01887"></a>01887         $this-&gt;n = 2;
<a name="l01888"></a>01888         $this-&gt;buffer = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01889"></a>01889         $this-&gt;pages = array();
<a name="l01890"></a>01890         $this-&gt;state = 0;
<a name="l01891"></a>01891         $this-&gt;fonts = array();
<a name="l01892"></a>01892         $this-&gt;FontFiles = array();
<a name="l01893"></a>01893         $this-&gt;diffs = array();
<a name="l01894"></a>01894         $this-&gt;images = array();
<a name="l01895"></a>01895         $this-&gt;links = array();
<a name="l01896"></a>01896         $this-&gt;gradients = array();
<a name="l01897"></a>01897         $this-&gt;InFooter = <span class="keyword">false</span>;
<a name="l01898"></a>01898         $this-&gt;lasth = 0;
<a name="l01899"></a>01899         $this-&gt;FontFamily = <span class="stringliteral">&#39;helvetica&#39;</span>;
<a name="l01900"></a>01900         $this-&gt;FontStyle = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01901"></a>01901         $this-&gt;FontSizePt = 12;
<a name="l01902"></a>01902         $this-&gt;underline = <span class="keyword">false</span>;
<a name="l01903"></a>01903         $this-&gt;overline = <span class="keyword">false</span>;
<a name="l01904"></a>01904         $this-&gt;linethrough = <span class="keyword">false</span>;
<a name="l01905"></a>01905         $this-&gt;DrawColor = <span class="stringliteral">&#39;0 G&#39;</span>;
<a name="l01906"></a>01906         $this-&gt;FillColor = <span class="stringliteral">&#39;0 g&#39;</span>;
<a name="l01907"></a>01907         $this-&gt;TextColor = <span class="stringliteral">&#39;0 g&#39;</span>;
<a name="l01908"></a>01908         $this-&gt;ColorFlag = <span class="keyword">false</span>;
<a name="l01909"></a>01909         $this-&gt;pdflayers = array();
<a name="l01910"></a>01910         <span class="comment">// encryption values</span>
<a name="l01911"></a>01911         $this-&gt;encrypted = <span class="keyword">false</span>;
<a name="l01912"></a>01912         $this-&gt;last_enc_key = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01913"></a>01913         <span class="comment">// standard Unicode fonts</span>
<a name="l01914"></a>01914         $this-&gt;CoreFonts = array(
<a name="l01915"></a>01915             <span class="stringliteral">&#39;courier&#39;</span>=&gt;<span class="stringliteral">&#39;Courier&#39;</span>,
<a name="l01916"></a>01916             <span class="stringliteral">&#39;courierB&#39;</span>=&gt;<span class="stringliteral">&#39;Courier-Bold&#39;</span>,
<a name="l01917"></a>01917             <span class="stringliteral">&#39;courierI&#39;</span>=&gt;<span class="stringliteral">&#39;Courier-Oblique&#39;</span>,
<a name="l01918"></a>01918             <span class="stringliteral">&#39;courierBI&#39;</span>=&gt;<span class="stringliteral">&#39;Courier-BoldOblique&#39;</span>,
<a name="l01919"></a>01919             <span class="stringliteral">&#39;helvetica&#39;</span>=&gt;<span class="stringliteral">&#39;Helvetica&#39;</span>,
<a name="l01920"></a>01920             <span class="stringliteral">&#39;helveticaB&#39;</span>=&gt;<span class="stringliteral">&#39;Helvetica-Bold&#39;</span>,
<a name="l01921"></a>01921             <span class="stringliteral">&#39;helveticaI&#39;</span>=&gt;<span class="stringliteral">&#39;Helvetica-Oblique&#39;</span>,
<a name="l01922"></a>01922             <span class="stringliteral">&#39;helveticaBI&#39;</span>=&gt;<span class="stringliteral">&#39;Helvetica-BoldOblique&#39;</span>,
<a name="l01923"></a>01923             <span class="stringliteral">&#39;times&#39;</span>=&gt;<span class="stringliteral">&#39;Times-Roman&#39;</span>,
<a name="l01924"></a>01924             <span class="stringliteral">&#39;timesB&#39;</span>=&gt;<span class="stringliteral">&#39;Times-Bold&#39;</span>,
<a name="l01925"></a>01925             <span class="stringliteral">&#39;timesI&#39;</span>=&gt;<span class="stringliteral">&#39;Times-Italic&#39;</span>,
<a name="l01926"></a>01926             <span class="stringliteral">&#39;timesBI&#39;</span>=&gt;<span class="stringliteral">&#39;Times-BoldItalic&#39;</span>,
<a name="l01927"></a>01927             <span class="stringliteral">&#39;symbol&#39;</span>=&gt;<span class="stringliteral">&#39;Symbol&#39;</span>,
<a name="l01928"></a>01928             <span class="stringliteral">&#39;zapfdingbats&#39;</span>=&gt;<span class="stringliteral">&#39;ZapfDingbats&#39;</span>
<a name="l01929"></a>01929         );
<a name="l01930"></a>01930         <span class="comment">// set scale factor</span>
<a name="l01931"></a>01931         $this-&gt;<a class="code" href="classTCPDF.html#aad2c0cbfe5b6330eed5850f87c2a32d9" title="Set the units of measure for the document.">setPageUnit</a>($unit);
<a name="l01932"></a>01932         <span class="comment">// set page format and orientation</span>
<a name="l01933"></a>01933         $this-&gt;<a class="code" href="classTCPDF.html#aa389d4419c77510dc3998f0af78d8a00" title="Change the format of the current page.">setPageFormat</a>(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>, $orientation);
<a name="l01934"></a>01934         <span class="comment">// page margins (1 cm)</span>
<a name="l01935"></a>01935         $margin = 28.35 / $this-&gt;k;
<a name="l01936"></a>01936         $this-&gt;<a class="code" href="classTCPDF.html#ab3bbdb7c85ea08d175fd559be6132ba0" title="Defines the left, top and right margins.">SetMargins</a>($margin, $margin);
<a name="l01937"></a>01937         <span class="comment">// internal cell padding</span>
<a name="l01938"></a>01938         $cpadding = $margin / 10;
<a name="l01939"></a>01939         $this-&gt;<a class="code" href="classTCPDF.html#aba22c5159414bb96cadfa66efd89bc7c" title="Set the internal Cell paddings.">setCellPaddings</a>($cpadding, 0, $cpadding, 0);
<a name="l01940"></a>01940         <span class="comment">// cell margins</span>
<a name="l01941"></a>01941         $this-&gt;<a class="code" href="classTCPDF.html#a80e96cb97ad08e7feb952d2e5e8dc36d" title="Set the internal Cell margins.">setCellMargins</a>(0, 0, 0, 0);
<a name="l01942"></a>01942         <span class="comment">// line width (0.2 mm)</span>
<a name="l01943"></a>01943         $this-&gt;LineWidth = 0.57 / $this-&gt;k;
<a name="l01944"></a>01944         $this-&gt;linestyleWidth = sprintf(<span class="stringliteral">&#39;%.2F w&#39;</span>, ($this-&gt;LineWidth * $this-&gt;k));
<a name="l01945"></a>01945         $this-&gt;linestyleCap = <span class="stringliteral">&#39;0 J&#39;</span>;
<a name="l01946"></a>01946         $this-&gt;linestyleJoin = <span class="stringliteral">&#39;0 j&#39;</span>;
<a name="l01947"></a>01947         $this-&gt;linestyleDash = <span class="stringliteral">&#39;[] 0 d&#39;</span>;
<a name="l01948"></a>01948         <span class="comment">// automatic page break</span>
<a name="l01949"></a>01949         $this-&gt;<a class="code" href="classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9" title="Enables or disables the automatic page breaking mode.">SetAutoPageBreak</a>(<span class="keyword">true</span>, (2 * $margin));
<a name="l01950"></a>01950         <span class="comment">// full width display mode</span>
<a name="l01951"></a>01951         $this-&gt;<a class="code" href="classTCPDF.html#ad99d9dea88f659fedf9fe11f30586a99" title="Defines the way the document is to be displayed by the viewer.">SetDisplayMode</a>(<span class="stringliteral">&#39;fullwidth&#39;</span>);
<a name="l01952"></a>01952         <span class="comment">// compression</span>
<a name="l01953"></a>01953         $this-&gt;<a class="code" href="classTCPDF.html#a6140a1ff2c5ed3f490592b6917f5adf3" title="Activates or deactivates page compression.">SetCompression</a>();
<a name="l01954"></a>01954         <span class="comment">// set default PDF version number</span>
<a name="l01955"></a>01955         $this-&gt;<a class="code" href="classTCPDF.html#a2803ddf7b83704355bcf1225f06cfcbb" title="Set the PDF version (check PDF reference for valid values).">setPDFVersion</a>();
<a name="l01956"></a>01956         $this-&gt;encoding = <a class="code" href="classTCPDF.html#a274314ff17c5df9ae105f9c91893a4a7" title="Default encoding.">$encoding</a>;
<a name="l01957"></a>01957         $this-&gt;HREF = array();
<a name="l01958"></a>01958         $this-&gt;<a class="code" href="classTCPDF.html#ae87d16aa348205f2a1654cc2ac42367c" title="Fill the list of available fonts ($this-&gt;fontlist).">getFontsList</a>();
<a name="l01959"></a>01959         $this-&gt;fgcolor = array(<span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;G&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0);
<a name="l01960"></a>01960         $this-&gt;strokecolor = array(<span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;G&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0);
<a name="l01961"></a>01961         $this-&gt;bgcolor = array(<span class="charliteral">&#39;R&#39;</span> =&gt; 255, <span class="charliteral">&#39;G&#39;</span> =&gt; 255, <span class="charliteral">&#39;B&#39;</span> =&gt; 255);
<a name="l01962"></a>01962         $this-&gt;extgstates = array();
<a name="l01963"></a>01963         <span class="comment">// user&#39;s rights</span>
<a name="l01964"></a>01964         $this-&gt;sign = <span class="keyword">false</span>;
<a name="l01965"></a>01965         $this-&gt;ur[<span class="stringliteral">&#39;enabled&#39;</span>] = <span class="keyword">false</span>;
<a name="l01966"></a>01966         $this-&gt;ur[<span class="stringliteral">&#39;document&#39;</span>] = <span class="stringliteral">&#39;/FullSave&#39;</span>;
<a name="l01967"></a>01967         $this-&gt;ur[<span class="stringliteral">&#39;annots&#39;</span>] = <span class="stringliteral">&#39;/Create/Delete/Modify/Copy/Import/Export&#39;</span>;
<a name="l01968"></a>01968         $this-&gt;ur[<span class="stringliteral">&#39;form&#39;</span>] = <span class="stringliteral">&#39;/Add/Delete/FillIn/Import/Export/SubmitStandalone/SpawnTemplate&#39;</span>;
<a name="l01969"></a>01969         $this-&gt;ur[<span class="stringliteral">&#39;signature&#39;</span>] = <span class="stringliteral">&#39;/Modify&#39;</span>;
<a name="l01970"></a>01970         $this-&gt;ur[<span class="stringliteral">&#39;ef&#39;</span>] = <span class="stringliteral">&#39;/Create/Delete/Modify/Import&#39;</span>;
<a name="l01971"></a>01971         $this-&gt;ur[<span class="stringliteral">&#39;formex&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l01972"></a>01972         $this-&gt;signature_appearance = array(<span class="stringliteral">&#39;page&#39;</span> =&gt; 1, <span class="stringliteral">&#39;rect&#39;</span> =&gt; <span class="stringliteral">&#39;0 0 0 0&#39;</span>);
<a name="l01973"></a>01973         $this-&gt;empty_signature_appearance = array();
<a name="l01974"></a>01974         <span class="comment">// set default JPEG quality</span>
<a name="l01975"></a>01975         $this-&gt;jpeg_quality = 75;
<a name="l01976"></a>01976         <span class="comment">// initialize some settings</span>
<a name="l01977"></a>01977         $this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>(array(<span class="stringliteral">&#39;&#39;</span>), <span class="stringliteral">&#39;&#39;</span>);
<a name="l01978"></a>01978         <span class="comment">// set default font</span>
<a name="l01979"></a>01979         $this-&gt;<a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e" title="Sets the font used to print character strings.">SetFont</a>($this-&gt;FontFamily, $this-&gt;FontStyle, $this-&gt;FontSizePt);
<a name="l01980"></a>01980         <span class="comment">// check if PCRE Unicode support is enabled</span>
<a name="l01981"></a>01981         <span class="keywordflow">if</span> ($this-&gt;isunicode AND (@preg_match(<span class="stringliteral">&#39;/\pL/u&#39;</span>, <span class="charliteral">&#39;a&#39;</span>) == 1)) {
<a name="l01982"></a>01982             <span class="comment">// PCRE unicode support is turned ON</span>
<a name="l01983"></a>01983             <span class="comment">// \p{Z} or \p{Separator}: any kind of Unicode whitespace or invisible separator.</span>
<a name="l01984"></a>01984             <span class="comment">// \p{Lo} or \p{Other_Letter}: a Unicode letter or ideograph that does not have lowercase and uppercase variants.</span>
<a name="l01985"></a>01985             <span class="comment">// \p{Lo} is needed because Chinese characters are packed next to each other without spaces in between.</span>
<a name="l01986"></a>01986             <span class="comment">//$this-&gt;setSpacesRE(&#39;/[^\S\P{Z}\P{Lo}\xa0]/u&#39;);</span>
<a name="l01987"></a>01987             $this-&gt;<a class="code" href="classTCPDF.html#a937dcd07bad79ae3900236f87b29194b" title="Set regular expression to detect withespaces or word separators.">setSpacesRE</a>(<span class="stringliteral">&#39;/[^\S\P{Z}\xa0]/u&#39;</span>);
<a name="l01988"></a>01988         } <span class="keywordflow">else</span> {
<a name="l01989"></a>01989             <span class="comment">// PCRE unicode support is turned OFF</span>
<a name="l01990"></a>01990             $this-&gt;<a class="code" href="classTCPDF.html#a937dcd07bad79ae3900236f87b29194b" title="Set regular expression to detect withespaces or word separators.">setSpacesRE</a>(<span class="stringliteral">&#39;/[^\S\xa0]/&#39;</span>);
<a name="l01991"></a>01991         }
<a name="l01992"></a>01992         $this-&gt;default_form_prop = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;solid&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(255, 255, 255), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(128, 128, 128));
<a name="l01993"></a>01993         <span class="comment">// set file ID for trailer</span>
<a name="l01994"></a>01994         $this-&gt;file_id = md5($this-&gt;<a class="code" href="classTCPDF.html#a398d3a1334b3e91e65f6464f4de91a64" title="Returns a string containing random data to be used as a seed for encryption methods.">getRandomSeed</a>(<span class="stringliteral">&#39;TCPDF&#39;</span>.$orientation.$unit.$format.$encoding));
<a name="l01995"></a>01995         <span class="comment">// set document date</span>
<a name="l01996"></a>01996         $this-&gt;doc_date = substr_replace(date(<span class="stringliteral">&#39;YmdHisO&#39;</span>), <span class="charliteral">&#39;\&#39;&#39;</span>, (0 - 2), 0).<span class="charliteral">&#39;\&#39;&#39;</span>;
<a name="l01997"></a>01997         <span class="comment">// get default graphic vars</span>
<a name="l01998"></a>01998         $this-&gt;default_graphic_vars = $this-&gt;<a class="code" href="classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a" title="Returns current graphic variables as array.">getGraphicVars</a>();
<a name="l01999"></a>01999         $this-&gt;header_xobj_autoreset = <span class="keyword">false</span>;
<a name="l02000"></a>02000         $this-&gt;custom_xmp = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02001"></a>02001     }
<a name="l02002"></a>02002 <span class="comment"></span>
<a name="l02003"></a>02003 <span class="comment">    /**</span>
<a name="l02004"></a>02004 <span class="comment">     * Default destructor.</span>
<a name="l02005"></a>02005 <span class="comment">     * @public</span>
<a name="l02006"></a>02006 <span class="comment">     * @since 1.53.0.TC016</span>
<a name="l02007"></a>02007 <span class="comment">     */</span>
<a name="l02008"></a><a class="code" href="classTCPDF.html#a5addd56687b7a3d97f6abac7c7cdb253">02008</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5addd56687b7a3d97f6abac7c7cdb253" title="Default destructor.">__destruct</a>() {
<a name="l02009"></a>02009         <span class="comment">// restore internal encoding</span>
<a name="l02010"></a>02010         <span class="keywordflow">if</span> (isset($this-&gt;internal_encoding) AND !empty($this-&gt;internal_encoding)) {
<a name="l02011"></a>02011             mb_internal_encoding($this-&gt;internal_encoding);
<a name="l02012"></a>02012         }
<a name="l02013"></a>02013         <span class="comment">// unset all class variables</span>
<a name="l02014"></a>02014         $this-&gt;<a class="code" href="classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa" title="Unset all class variables except the following critical variables: internal_encoding, state, bufferlen, buffer and diskcache.">_destroy</a>(<span class="keyword">true</span>);
<a name="l02015"></a>02015     }
<a name="l02016"></a>02016 <span class="comment"></span>
<a name="l02017"></a>02017 <span class="comment">    /**</span>
<a name="l02018"></a>02018 <span class="comment">     * Return the current TCPDF version.</span>
<a name="l02019"></a>02019 <span class="comment">     * @return TCPDF version string</span>
<a name="l02020"></a>02020 <span class="comment">     * @public</span>
<a name="l02021"></a>02021 <span class="comment">     * @since 5.9.012 (2010-11-10)</span>
<a name="l02022"></a>02022 <span class="comment">     */</span>
<a name="l02023"></a><a class="code" href="classTCPDF.html#af4b946b3a962b50fe8898025228446c8">02023</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af4b946b3a962b50fe8898025228446c8" title="Return the current TCPDF version.">getTCPDFVersion</a>() {
<a name="l02024"></a>02024         <span class="keywordflow">return</span> $this-&gt;tcpdf_version;
<a name="l02025"></a>02025     }
<a name="l02026"></a>02026 <span class="comment"></span>
<a name="l02027"></a>02027 <span class="comment">    /**</span>
<a name="l02028"></a>02028 <span class="comment">     * Set the units of measure for the document.</span>
<a name="l02029"></a>02029 <span class="comment">     * @param $unit (string) User measure unit. Possible values are:&lt;ul&gt;&lt;li&gt;pt: point&lt;/li&gt;&lt;li&gt;mm: millimeter (default)&lt;/li&gt;&lt;li&gt;cm: centimeter&lt;/li&gt;&lt;li&gt;in: inch&lt;/li&gt;&lt;/ul&gt;&lt;br /&gt;A point equals 1/72 of inch, that is to say about 0.35 mm (an inch being 2.54 cm). This is a very common unit in typography; font sizes are expressed in that unit.</span>
<a name="l02030"></a>02030 <span class="comment">     * @public</span>
<a name="l02031"></a>02031 <span class="comment">     * @since 3.0.015 (2008-06-06)</span>
<a name="l02032"></a>02032 <span class="comment">     */</span>
<a name="l02033"></a><a class="code" href="classTCPDF.html#aad2c0cbfe5b6330eed5850f87c2a32d9">02033</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aad2c0cbfe5b6330eed5850f87c2a32d9" title="Set the units of measure for the document.">setPageUnit</a>($unit) {
<a name="l02034"></a>02034         $unit = strtolower($unit);
<a name="l02035"></a>02035         <span class="comment">//Set scale factor</span>
<a name="l02036"></a>02036         <span class="keywordflow">switch</span> ($unit) {
<a name="l02037"></a>02037             <span class="comment">// points</span>
<a name="l02038"></a>02038             <span class="keywordflow">case</span> <span class="stringliteral">&#39;px&#39;</span>:
<a name="l02039"></a>02039             <span class="keywordflow">case</span> <span class="stringliteral">&#39;pt&#39;</span>: {
<a name="l02040"></a>02040                 $this-&gt;k = 1;
<a name="l02041"></a>02041                 <span class="keywordflow">break</span>;
<a name="l02042"></a>02042             }
<a name="l02043"></a>02043             <span class="comment">// millimeters</span>
<a name="l02044"></a>02044             <span class="keywordflow">case</span> <span class="stringliteral">&#39;mm&#39;</span>: {
<a name="l02045"></a>02045                 $this-&gt;k = $this-&gt;dpi / 25.4;
<a name="l02046"></a>02046                 <span class="keywordflow">break</span>;
<a name="l02047"></a>02047             }
<a name="l02048"></a>02048             <span class="comment">// centimeters</span>
<a name="l02049"></a>02049             <span class="keywordflow">case</span> <span class="stringliteral">&#39;cm&#39;</span>: {
<a name="l02050"></a>02050                 $this-&gt;k = $this-&gt;dpi / 2.54;
<a name="l02051"></a>02051                 <span class="keywordflow">break</span>;
<a name="l02052"></a>02052             }
<a name="l02053"></a>02053             <span class="comment">// inches</span>
<a name="l02054"></a>02054             <span class="keywordflow">case</span> <span class="stringliteral">&#39;in&#39;</span>: {
<a name="l02055"></a>02055                 $this-&gt;k = $this-&gt;dpi;
<a name="l02056"></a>02056                 <span class="keywordflow">break</span>;
<a name="l02057"></a>02057             }
<a name="l02058"></a>02058             <span class="comment">// unsupported unit</span>
<a name="l02059"></a>02059             <span class="keywordflow">default</span> : {
<a name="l02060"></a>02060                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Incorrect unit: &#39;</span>.$unit);
<a name="l02061"></a>02061                 <span class="keywordflow">break</span>;
<a name="l02062"></a>02062             }
<a name="l02063"></a>02063         }
<a name="l02064"></a>02064         $this-&gt;pdfunit = $unit;
<a name="l02065"></a>02065         <span class="keywordflow">if</span> (isset($this-&gt;CurOrientation)) {
<a name="l02066"></a>02066             $this-&gt;<a class="code" href="classTCPDF.html#ad6a3575405b61049ff85ce019df5451d" title="Set page orientation.">setPageOrientation</a>($this-&gt;CurOrientation);
<a name="l02067"></a>02067         }
<a name="l02068"></a>02068     }
<a name="l02069"></a>02069 <span class="comment"></span>
<a name="l02070"></a>02070 <span class="comment">    /**</span>
<a name="l02071"></a>02071 <span class="comment">     * Get page dimensions from format name.</span>
<a name="l02072"></a>02072 <span class="comment">     * @param $format (mixed) The format name. It can be: &lt;ul&gt;</span>
<a name="l02073"></a>02073 <span class="comment">     * &lt;li&gt;&lt;b&gt;ISO 216 A Series + 2 SIS 014711 extensions&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02074"></a>02074 <span class="comment">     * &lt;li&gt;A0 (841x1189 mm ; 33.11x46.81 in)&lt;/li&gt;</span>
<a name="l02075"></a>02075 <span class="comment">     * &lt;li&gt;A1 (594x841 mm ; 23.39x33.11 in)&lt;/li&gt;</span>
<a name="l02076"></a>02076 <span class="comment">     * &lt;li&gt;A2 (420x594 mm ; 16.54x23.39 in)&lt;/li&gt;</span>
<a name="l02077"></a>02077 <span class="comment">     * &lt;li&gt;A3 (297x420 mm ; 11.69x16.54 in)&lt;/li&gt;</span>
<a name="l02078"></a>02078 <span class="comment">     * &lt;li&gt;A4 (210x297 mm ; 8.27x11.69 in)&lt;/li&gt;</span>
<a name="l02079"></a>02079 <span class="comment">     * &lt;li&gt;A5 (148x210 mm ; 5.83x8.27 in)&lt;/li&gt;</span>
<a name="l02080"></a>02080 <span class="comment">     * &lt;li&gt;A6 (105x148 mm ; 4.13x5.83 in)&lt;/li&gt;</span>
<a name="l02081"></a>02081 <span class="comment">     * &lt;li&gt;A7 (74x105 mm ; 2.91x4.13 in)&lt;/li&gt;</span>
<a name="l02082"></a>02082 <span class="comment">     * &lt;li&gt;A8 (52x74 mm ; 2.05x2.91 in)&lt;/li&gt;</span>
<a name="l02083"></a>02083 <span class="comment">     * &lt;li&gt;A9 (37x52 mm ; 1.46x2.05 in)&lt;/li&gt;</span>
<a name="l02084"></a>02084 <span class="comment">     * &lt;li&gt;A10 (26x37 mm ; 1.02x1.46 in)&lt;/li&gt;</span>
<a name="l02085"></a>02085 <span class="comment">     * &lt;li&gt;A11 (18x26 mm ; 0.71x1.02 in)&lt;/li&gt;</span>
<a name="l02086"></a>02086 <span class="comment">     * &lt;li&gt;A12 (13x18 mm ; 0.51x0.71 in)&lt;/li&gt;</span>
<a name="l02087"></a>02087 <span class="comment">     * &lt;li&gt;&lt;b&gt;ISO 216 B Series + 2 SIS 014711 extensions&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02088"></a>02088 <span class="comment">     * &lt;li&gt;B0 (1000x1414 mm ; 39.37x55.67 in)&lt;/li&gt;</span>
<a name="l02089"></a>02089 <span class="comment">     * &lt;li&gt;B1 (707x1000 mm ; 27.83x39.37 in)&lt;/li&gt;</span>
<a name="l02090"></a>02090 <span class="comment">     * &lt;li&gt;B2 (500x707 mm ; 19.69x27.83 in)&lt;/li&gt;</span>
<a name="l02091"></a>02091 <span class="comment">     * &lt;li&gt;B3 (353x500 mm ; 13.90x19.69 in)&lt;/li&gt;</span>
<a name="l02092"></a>02092 <span class="comment">     * &lt;li&gt;B4 (250x353 mm ; 9.84x13.90 in)&lt;/li&gt;</span>
<a name="l02093"></a>02093 <span class="comment">     * &lt;li&gt;B5 (176x250 mm ; 6.93x9.84 in)&lt;/li&gt;</span>
<a name="l02094"></a>02094 <span class="comment">     * &lt;li&gt;B6 (125x176 mm ; 4.92x6.93 in)&lt;/li&gt;</span>
<a name="l02095"></a>02095 <span class="comment">     * &lt;li&gt;B7 (88x125 mm ; 3.46x4.92 in)&lt;/li&gt;</span>
<a name="l02096"></a>02096 <span class="comment">     * &lt;li&gt;B8 (62x88 mm ; 2.44x3.46 in)&lt;/li&gt;</span>
<a name="l02097"></a>02097 <span class="comment">     * &lt;li&gt;B9 (44x62 mm ; 1.73x2.44 in)&lt;/li&gt;</span>
<a name="l02098"></a>02098 <span class="comment">     * &lt;li&gt;B10 (31x44 mm ; 1.22x1.73 in)&lt;/li&gt;</span>
<a name="l02099"></a>02099 <span class="comment">     * &lt;li&gt;B11 (22x31 mm ; 0.87x1.22 in)&lt;/li&gt;</span>
<a name="l02100"></a>02100 <span class="comment">     * &lt;li&gt;B12 (15x22 mm ; 0.59x0.87 in)&lt;/li&gt;</span>
<a name="l02101"></a>02101 <span class="comment">     * &lt;li&gt;&lt;b&gt;ISO 216 C Series + 2 SIS 014711 extensions + 2 EXTENSION&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02102"></a>02102 <span class="comment">     * &lt;li&gt;C0 (917x1297 mm ; 36.10x51.06 in)&lt;/li&gt;</span>
<a name="l02103"></a>02103 <span class="comment">     * &lt;li&gt;C1 (648x917 mm ; 25.51x36.10 in)&lt;/li&gt;</span>
<a name="l02104"></a>02104 <span class="comment">     * &lt;li&gt;C2 (458x648 mm ; 18.03x25.51 in)&lt;/li&gt;</span>
<a name="l02105"></a>02105 <span class="comment">     * &lt;li&gt;C3 (324x458 mm ; 12.76x18.03 in)&lt;/li&gt;</span>
<a name="l02106"></a>02106 <span class="comment">     * &lt;li&gt;C4 (229x324 mm ; 9.02x12.76 in)&lt;/li&gt;</span>
<a name="l02107"></a>02107 <span class="comment">     * &lt;li&gt;C5 (162x229 mm ; 6.38x9.02 in)&lt;/li&gt;</span>
<a name="l02108"></a>02108 <span class="comment">     * &lt;li&gt;C6 (114x162 mm ; 4.49x6.38 in)&lt;/li&gt;</span>
<a name="l02109"></a>02109 <span class="comment">     * &lt;li&gt;C7 (81x114 mm ; 3.19x4.49 in)&lt;/li&gt;</span>
<a name="l02110"></a>02110 <span class="comment">     * &lt;li&gt;C8 (57x81 mm ; 2.24x3.19 in)&lt;/li&gt;</span>
<a name="l02111"></a>02111 <span class="comment">     * &lt;li&gt;C9 (40x57 mm ; 1.57x2.24 in)&lt;/li&gt;</span>
<a name="l02112"></a>02112 <span class="comment">     * &lt;li&gt;C10 (28x40 mm ; 1.10x1.57 in)&lt;/li&gt;</span>
<a name="l02113"></a>02113 <span class="comment">     * &lt;li&gt;C11 (20x28 mm ; 0.79x1.10 in)&lt;/li&gt;</span>
<a name="l02114"></a>02114 <span class="comment">     * &lt;li&gt;C12 (14x20 mm ; 0.55x0.79 in)&lt;/li&gt;</span>
<a name="l02115"></a>02115 <span class="comment">     * &lt;li&gt;C76 (81x162 mm ; 3.19x6.38 in)&lt;/li&gt;</span>
<a name="l02116"></a>02116 <span class="comment">     * &lt;li&gt;DL (110x220 mm ; 4.33x8.66 in)&lt;/li&gt;</span>
<a name="l02117"></a>02117 <span class="comment">     * &lt;li&gt;&lt;b&gt;SIS 014711 E Series&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02118"></a>02118 <span class="comment">     * &lt;li&gt;E0 (879x1241 mm ; 34.61x48.86 in)&lt;/li&gt;</span>
<a name="l02119"></a>02119 <span class="comment">     * &lt;li&gt;E1 (620x879 mm ; 24.41x34.61 in)&lt;/li&gt;</span>
<a name="l02120"></a>02120 <span class="comment">     * &lt;li&gt;E2 (440x620 mm ; 17.32x24.41 in)&lt;/li&gt;</span>
<a name="l02121"></a>02121 <span class="comment">     * &lt;li&gt;E3 (310x440 mm ; 12.20x17.32 in)&lt;/li&gt;</span>
<a name="l02122"></a>02122 <span class="comment">     * &lt;li&gt;E4 (220x310 mm ; 8.66x12.20 in)&lt;/li&gt;</span>
<a name="l02123"></a>02123 <span class="comment">     * &lt;li&gt;E5 (155x220 mm ; 6.10x8.66 in)&lt;/li&gt;</span>
<a name="l02124"></a>02124 <span class="comment">     * &lt;li&gt;E6 (110x155 mm ; 4.33x6.10 in)&lt;/li&gt;</span>
<a name="l02125"></a>02125 <span class="comment">     * &lt;li&gt;E7 (78x110 mm ; 3.07x4.33 in)&lt;/li&gt;</span>
<a name="l02126"></a>02126 <span class="comment">     * &lt;li&gt;E8 (55x78 mm ; 2.17x3.07 in)&lt;/li&gt;</span>
<a name="l02127"></a>02127 <span class="comment">     * &lt;li&gt;E9 (39x55 mm ; 1.54x2.17 in)&lt;/li&gt;</span>
<a name="l02128"></a>02128 <span class="comment">     * &lt;li&gt;E10 (27x39 mm ; 1.06x1.54 in)&lt;/li&gt;</span>
<a name="l02129"></a>02129 <span class="comment">     * &lt;li&gt;E11 (19x27 mm ; 0.75x1.06 in)&lt;/li&gt;</span>
<a name="l02130"></a>02130 <span class="comment">     * &lt;li&gt;E12 (13x19 mm ; 0.51x0.75 in)&lt;/li&gt;</span>
<a name="l02131"></a>02131 <span class="comment">     * &lt;li&gt;&lt;b&gt;SIS 014711 G Series&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02132"></a>02132 <span class="comment">     * &lt;li&gt;G0 (958x1354 mm ; 37.72x53.31 in)&lt;/li&gt;</span>
<a name="l02133"></a>02133 <span class="comment">     * &lt;li&gt;G1 (677x958 mm ; 26.65x37.72 in)&lt;/li&gt;</span>
<a name="l02134"></a>02134 <span class="comment">     * &lt;li&gt;G2 (479x677 mm ; 18.86x26.65 in)&lt;/li&gt;</span>
<a name="l02135"></a>02135 <span class="comment">     * &lt;li&gt;G3 (338x479 mm ; 13.31x18.86 in)&lt;/li&gt;</span>
<a name="l02136"></a>02136 <span class="comment">     * &lt;li&gt;G4 (239x338 mm ; 9.41x13.31 in)&lt;/li&gt;</span>
<a name="l02137"></a>02137 <span class="comment">     * &lt;li&gt;G5 (169x239 mm ; 6.65x9.41 in)&lt;/li&gt;</span>
<a name="l02138"></a>02138 <span class="comment">     * &lt;li&gt;G6 (119x169 mm ; 4.69x6.65 in)&lt;/li&gt;</span>
<a name="l02139"></a>02139 <span class="comment">     * &lt;li&gt;G7 (84x119 mm ; 3.31x4.69 in)&lt;/li&gt;</span>
<a name="l02140"></a>02140 <span class="comment">     * &lt;li&gt;G8 (59x84 mm ; 2.32x3.31 in)&lt;/li&gt;</span>
<a name="l02141"></a>02141 <span class="comment">     * &lt;li&gt;G9 (42x59 mm ; 1.65x2.32 in)&lt;/li&gt;</span>
<a name="l02142"></a>02142 <span class="comment">     * &lt;li&gt;G10 (29x42 mm ; 1.14x1.65 in)&lt;/li&gt;</span>
<a name="l02143"></a>02143 <span class="comment">     * &lt;li&gt;G11 (21x29 mm ; 0.83x1.14 in)&lt;/li&gt;</span>
<a name="l02144"></a>02144 <span class="comment">     * &lt;li&gt;G12 (14x21 mm ; 0.55x0.83 in)&lt;/li&gt;</span>
<a name="l02145"></a>02145 <span class="comment">     * &lt;li&gt;&lt;b&gt;ISO Press&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02146"></a>02146 <span class="comment">     * &lt;li&gt;RA0 (860x1220 mm ; 33.86x48.03 in)&lt;/li&gt;</span>
<a name="l02147"></a>02147 <span class="comment">     * &lt;li&gt;RA1 (610x860 mm ; 24.02x33.86 in)&lt;/li&gt;</span>
<a name="l02148"></a>02148 <span class="comment">     * &lt;li&gt;RA2 (430x610 mm ; 16.93x24.02 in)&lt;/li&gt;</span>
<a name="l02149"></a>02149 <span class="comment">     * &lt;li&gt;RA3 (305x430 mm ; 12.01x16.93 in)&lt;/li&gt;</span>
<a name="l02150"></a>02150 <span class="comment">     * &lt;li&gt;RA4 (215x305 mm ; 8.46x12.01 in)&lt;/li&gt;</span>
<a name="l02151"></a>02151 <span class="comment">     * &lt;li&gt;SRA0 (900x1280 mm ; 35.43x50.39 in)&lt;/li&gt;</span>
<a name="l02152"></a>02152 <span class="comment">     * &lt;li&gt;SRA1 (640x900 mm ; 25.20x35.43 in)&lt;/li&gt;</span>
<a name="l02153"></a>02153 <span class="comment">     * &lt;li&gt;SRA2 (450x640 mm ; 17.72x25.20 in)&lt;/li&gt;</span>
<a name="l02154"></a>02154 <span class="comment">     * &lt;li&gt;SRA3 (320x450 mm ; 12.60x17.72 in)&lt;/li&gt;</span>
<a name="l02155"></a>02155 <span class="comment">     * &lt;li&gt;SRA4 (225x320 mm ; 8.86x12.60 in)&lt;/li&gt;</span>
<a name="l02156"></a>02156 <span class="comment">     * &lt;li&gt;&lt;b&gt;German DIN 476&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02157"></a>02157 <span class="comment">     * &lt;li&gt;4A0 (1682x2378 mm ; 66.22x93.62 in)&lt;/li&gt;</span>
<a name="l02158"></a>02158 <span class="comment">     * &lt;li&gt;2A0 (1189x1682 mm ; 46.81x66.22 in)&lt;/li&gt;</span>
<a name="l02159"></a>02159 <span class="comment">     * &lt;li&gt;&lt;b&gt;Variations on the ISO Standard&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02160"></a>02160 <span class="comment">     * &lt;li&gt;A2_EXTRA (445x619 mm ; 17.52x24.37 in)&lt;/li&gt;</span>
<a name="l02161"></a>02161 <span class="comment">     * &lt;li&gt;A3+ (329x483 mm ; 12.95x19.02 in)&lt;/li&gt;</span>
<a name="l02162"></a>02162 <span class="comment">     * &lt;li&gt;A3_EXTRA (322x445 mm ; 12.68x17.52 in)&lt;/li&gt;</span>
<a name="l02163"></a>02163 <span class="comment">     * &lt;li&gt;A3_SUPER (305x508 mm ; 12.01x20.00 in)&lt;/li&gt;</span>
<a name="l02164"></a>02164 <span class="comment">     * &lt;li&gt;SUPER_A3 (305x487 mm ; 12.01x19.17 in)&lt;/li&gt;</span>
<a name="l02165"></a>02165 <span class="comment">     * &lt;li&gt;A4_EXTRA (235x322 mm ; 9.25x12.68 in)&lt;/li&gt;</span>
<a name="l02166"></a>02166 <span class="comment">     * &lt;li&gt;A4_SUPER (229x322 mm ; 9.02x12.68 in)&lt;/li&gt;</span>
<a name="l02167"></a>02167 <span class="comment">     * &lt;li&gt;SUPER_A4 (227x356 mm ; 8.94x14.02 in)&lt;/li&gt;</span>
<a name="l02168"></a>02168 <span class="comment">     * &lt;li&gt;A4_LONG (210x348 mm ; 8.27x13.70 in)&lt;/li&gt;</span>
<a name="l02169"></a>02169 <span class="comment">     * &lt;li&gt;F4 (210x330 mm ; 8.27x12.99 in)&lt;/li&gt;</span>
<a name="l02170"></a>02170 <span class="comment">     * &lt;li&gt;SO_B5_EXTRA (202x276 mm ; 7.95x10.87 in)&lt;/li&gt;</span>
<a name="l02171"></a>02171 <span class="comment">     * &lt;li&gt;A5_EXTRA (173x235 mm ; 6.81x9.25 in)&lt;/li&gt;</span>
<a name="l02172"></a>02172 <span class="comment">     * &lt;li&gt;&lt;b&gt;ANSI Series&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02173"></a>02173 <span class="comment">     * &lt;li&gt;ANSI_E (864x1118 mm ; 34.00x44.00 in)&lt;/li&gt;</span>
<a name="l02174"></a>02174 <span class="comment">     * &lt;li&gt;ANSI_D (559x864 mm ; 22.00x34.00 in)&lt;/li&gt;</span>
<a name="l02175"></a>02175 <span class="comment">     * &lt;li&gt;ANSI_C (432x559 mm ; 17.00x22.00 in)&lt;/li&gt;</span>
<a name="l02176"></a>02176 <span class="comment">     * &lt;li&gt;ANSI_B (279x432 mm ; 11.00x17.00 in)&lt;/li&gt;</span>
<a name="l02177"></a>02177 <span class="comment">     * &lt;li&gt;ANSI_A (216x279 mm ; 8.50x11.00 in)&lt;/li&gt;</span>
<a name="l02178"></a>02178 <span class="comment">     * &lt;li&gt;&lt;b&gt;Traditional &#39;Loose&#39; North American Paper Sizes&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02179"></a>02179 <span class="comment">     * &lt;li&gt;LEDGER, USLEDGER (432x279 mm ; 17.00x11.00 in)&lt;/li&gt;</span>
<a name="l02180"></a>02180 <span class="comment">     * &lt;li&gt;TABLOID, USTABLOID, BIBLE, ORGANIZERK (279x432 mm ; 11.00x17.00 in)&lt;/li&gt;</span>
<a name="l02181"></a>02181 <span class="comment">     * &lt;li&gt;LETTER, USLETTER, ORGANIZERM (216x279 mm ; 8.50x11.00 in)&lt;/li&gt;</span>
<a name="l02182"></a>02182 <span class="comment">     * &lt;li&gt;LEGAL, USLEGAL (216x356 mm ; 8.50x14.00 in)&lt;/li&gt;</span>
<a name="l02183"></a>02183 <span class="comment">     * &lt;li&gt;GLETTER, GOVERNMENTLETTER (203x267 mm ; 8.00x10.50 in)&lt;/li&gt;</span>
<a name="l02184"></a>02184 <span class="comment">     * &lt;li&gt;JLEGAL, JUNIORLEGAL (203x127 mm ; 8.00x5.00 in)&lt;/li&gt;</span>
<a name="l02185"></a>02185 <span class="comment">     * &lt;li&gt;&lt;b&gt;Other North American Paper Sizes&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02186"></a>02186 <span class="comment">     * &lt;li&gt;QUADDEMY (889x1143 mm ; 35.00x45.00 in)&lt;/li&gt;</span>
<a name="l02187"></a>02187 <span class="comment">     * &lt;li&gt;SUPER_B (330x483 mm ; 13.00x19.00 in)&lt;/li&gt;</span>
<a name="l02188"></a>02188 <span class="comment">     * &lt;li&gt;QUARTO (229x279 mm ; 9.00x11.00 in)&lt;/li&gt;</span>
<a name="l02189"></a>02189 <span class="comment">     * &lt;li&gt;FOLIO, GOVERNMENTLEGAL (216x330 mm ; 8.50x13.00 in)&lt;/li&gt;</span>
<a name="l02190"></a>02190 <span class="comment">     * &lt;li&gt;EXECUTIVE, MONARCH (184x267 mm ; 7.25x10.50 in)&lt;/li&gt;</span>
<a name="l02191"></a>02191 <span class="comment">     * &lt;li&gt;MEMO, STATEMENT, ORGANIZERL (140x216 mm ; 5.50x8.50 in)&lt;/li&gt;</span>
<a name="l02192"></a>02192 <span class="comment">     * &lt;li&gt;FOOLSCAP (210x330 mm ; 8.27x13.00 in)&lt;/li&gt;</span>
<a name="l02193"></a>02193 <span class="comment">     * &lt;li&gt;COMPACT (108x171 mm ; 4.25x6.75 in)&lt;/li&gt;</span>
<a name="l02194"></a>02194 <span class="comment">     * &lt;li&gt;ORGANIZERJ (70x127 mm ; 2.75x5.00 in)&lt;/li&gt;</span>
<a name="l02195"></a>02195 <span class="comment">     * &lt;li&gt;&lt;b&gt;Canadian standard CAN 2-9.60M&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02196"></a>02196 <span class="comment">     * &lt;li&gt;P1 (560x860 mm ; 22.05x33.86 in)&lt;/li&gt;</span>
<a name="l02197"></a>02197 <span class="comment">     * &lt;li&gt;P2 (430x560 mm ; 16.93x22.05 in)&lt;/li&gt;</span>
<a name="l02198"></a>02198 <span class="comment">     * &lt;li&gt;P3 (280x430 mm ; 11.02x16.93 in)&lt;/li&gt;</span>
<a name="l02199"></a>02199 <span class="comment">     * &lt;li&gt;P4 (215x280 mm ; 8.46x11.02 in)&lt;/li&gt;</span>
<a name="l02200"></a>02200 <span class="comment">     * &lt;li&gt;P5 (140x215 mm ; 5.51x8.46 in)&lt;/li&gt;</span>
<a name="l02201"></a>02201 <span class="comment">     * &lt;li&gt;P6 (107x140 mm ; 4.21x5.51 in)&lt;/li&gt;</span>
<a name="l02202"></a>02202 <span class="comment">     * &lt;li&gt;&lt;b&gt;North American Architectural Sizes&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02203"></a>02203 <span class="comment">     * &lt;li&gt;ARCH_E (914x1219 mm ; 36.00x48.00 in)&lt;/li&gt;</span>
<a name="l02204"></a>02204 <span class="comment">     * &lt;li&gt;ARCH_E1 (762x1067 mm ; 30.00x42.00 in)&lt;/li&gt;</span>
<a name="l02205"></a>02205 <span class="comment">     * &lt;li&gt;ARCH_D (610x914 mm ; 24.00x36.00 in)&lt;/li&gt;</span>
<a name="l02206"></a>02206 <span class="comment">     * &lt;li&gt;ARCH_C, BROADSHEET (457x610 mm ; 18.00x24.00 in)&lt;/li&gt;</span>
<a name="l02207"></a>02207 <span class="comment">     * &lt;li&gt;ARCH_B (305x457 mm ; 12.00x18.00 in)&lt;/li&gt;</span>
<a name="l02208"></a>02208 <span class="comment">     * &lt;li&gt;ARCH_A (229x305 mm ; 9.00x12.00 in)&lt;/li&gt;</span>
<a name="l02209"></a>02209 <span class="comment">     * &lt;li&gt;&lt;b&gt;Announcement Envelopes&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02210"></a>02210 <span class="comment">     * &lt;li&gt;ANNENV_A2 (111x146 mm ; 4.37x5.75 in)&lt;/li&gt;</span>
<a name="l02211"></a>02211 <span class="comment">     * &lt;li&gt;ANNENV_A6 (121x165 mm ; 4.75x6.50 in)&lt;/li&gt;</span>
<a name="l02212"></a>02212 <span class="comment">     * &lt;li&gt;ANNENV_A7 (133x184 mm ; 5.25x7.25 in)&lt;/li&gt;</span>
<a name="l02213"></a>02213 <span class="comment">     * &lt;li&gt;ANNENV_A8 (140x206 mm ; 5.50x8.12 in)&lt;/li&gt;</span>
<a name="l02214"></a>02214 <span class="comment">     * &lt;li&gt;ANNENV_A10 (159x244 mm ; 6.25x9.62 in)&lt;/li&gt;</span>
<a name="l02215"></a>02215 <span class="comment">     * &lt;li&gt;ANNENV_SLIM (98x225 mm ; 3.87x8.87 in)&lt;/li&gt;</span>
<a name="l02216"></a>02216 <span class="comment">     * &lt;li&gt;&lt;b&gt;Commercial Envelopes&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02217"></a>02217 <span class="comment">     * &lt;li&gt;COMMENV_N6_1/4 (89x152 mm ; 3.50x6.00 in)&lt;/li&gt;</span>
<a name="l02218"></a>02218 <span class="comment">     * &lt;li&gt;COMMENV_N6_3/4 (92x165 mm ; 3.62x6.50 in)&lt;/li&gt;</span>
<a name="l02219"></a>02219 <span class="comment">     * &lt;li&gt;COMMENV_N8 (98x191 mm ; 3.87x7.50 in)&lt;/li&gt;</span>
<a name="l02220"></a>02220 <span class="comment">     * &lt;li&gt;COMMENV_N9 (98x225 mm ; 3.87x8.87 in)&lt;/li&gt;</span>
<a name="l02221"></a>02221 <span class="comment">     * &lt;li&gt;COMMENV_N10 (105x241 mm ; 4.12x9.50 in)&lt;/li&gt;</span>
<a name="l02222"></a>02222 <span class="comment">     * &lt;li&gt;COMMENV_N11 (114x263 mm ; 4.50x10.37 in)&lt;/li&gt;</span>
<a name="l02223"></a>02223 <span class="comment">     * &lt;li&gt;COMMENV_N12 (121x279 mm ; 4.75x11.00 in)&lt;/li&gt;</span>
<a name="l02224"></a>02224 <span class="comment">     * &lt;li&gt;COMMENV_N14 (127x292 mm ; 5.00x11.50 in)&lt;/li&gt;</span>
<a name="l02225"></a>02225 <span class="comment">     * &lt;li&gt;&lt;b&gt;Catalogue Envelopes&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02226"></a>02226 <span class="comment">     * &lt;li&gt;CATENV_N1 (152x229 mm ; 6.00x9.00 in)&lt;/li&gt;</span>
<a name="l02227"></a>02227 <span class="comment">     * &lt;li&gt;CATENV_N1_3/4 (165x241 mm ; 6.50x9.50 in)&lt;/li&gt;</span>
<a name="l02228"></a>02228 <span class="comment">     * &lt;li&gt;CATENV_N2 (165x254 mm ; 6.50x10.00 in)&lt;/li&gt;</span>
<a name="l02229"></a>02229 <span class="comment">     * &lt;li&gt;CATENV_N3 (178x254 mm ; 7.00x10.00 in)&lt;/li&gt;</span>
<a name="l02230"></a>02230 <span class="comment">     * &lt;li&gt;CATENV_N6 (191x267 mm ; 7.50x10.50 in)&lt;/li&gt;</span>
<a name="l02231"></a>02231 <span class="comment">     * &lt;li&gt;CATENV_N7 (203x279 mm ; 8.00x11.00 in)&lt;/li&gt;</span>
<a name="l02232"></a>02232 <span class="comment">     * &lt;li&gt;CATENV_N8 (210x286 mm ; 8.25x11.25 in)&lt;/li&gt;</span>
<a name="l02233"></a>02233 <span class="comment">     * &lt;li&gt;CATENV_N9_1/2 (216x267 mm ; 8.50x10.50 in)&lt;/li&gt;</span>
<a name="l02234"></a>02234 <span class="comment">     * &lt;li&gt;CATENV_N9_3/4 (222x286 mm ; 8.75x11.25 in)&lt;/li&gt;</span>
<a name="l02235"></a>02235 <span class="comment">     * &lt;li&gt;CATENV_N10_1/2 (229x305 mm ; 9.00x12.00 in)&lt;/li&gt;</span>
<a name="l02236"></a>02236 <span class="comment">     * &lt;li&gt;CATENV_N12_1/2 (241x318 mm ; 9.50x12.50 in)&lt;/li&gt;</span>
<a name="l02237"></a>02237 <span class="comment">     * &lt;li&gt;CATENV_N13_1/2 (254x330 mm ; 10.00x13.00 in)&lt;/li&gt;</span>
<a name="l02238"></a>02238 <span class="comment">     * &lt;li&gt;CATENV_N14_1/4 (286x311 mm ; 11.25x12.25 in)&lt;/li&gt;</span>
<a name="l02239"></a>02239 <span class="comment">     * &lt;li&gt;CATENV_N14_1/2 (292x368 mm ; 11.50x14.50 in)&lt;/li&gt;</span>
<a name="l02240"></a>02240 <span class="comment">     * &lt;li&gt;&lt;b&gt;Japanese (JIS P 0138-61) Standard B-Series&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02241"></a>02241 <span class="comment">     * &lt;li&gt;JIS_B0 (1030x1456 mm ; 40.55x57.32 in)&lt;/li&gt;</span>
<a name="l02242"></a>02242 <span class="comment">     * &lt;li&gt;JIS_B1 (728x1030 mm ; 28.66x40.55 in)&lt;/li&gt;</span>
<a name="l02243"></a>02243 <span class="comment">     * &lt;li&gt;JIS_B2 (515x728 mm ; 20.28x28.66 in)&lt;/li&gt;</span>
<a name="l02244"></a>02244 <span class="comment">     * &lt;li&gt;JIS_B3 (364x515 mm ; 14.33x20.28 in)&lt;/li&gt;</span>
<a name="l02245"></a>02245 <span class="comment">     * &lt;li&gt;JIS_B4 (257x364 mm ; 10.12x14.33 in)&lt;/li&gt;</span>
<a name="l02246"></a>02246 <span class="comment">     * &lt;li&gt;JIS_B5 (182x257 mm ; 7.17x10.12 in)&lt;/li&gt;</span>
<a name="l02247"></a>02247 <span class="comment">     * &lt;li&gt;JIS_B6 (128x182 mm ; 5.04x7.17 in)&lt;/li&gt;</span>
<a name="l02248"></a>02248 <span class="comment">     * &lt;li&gt;JIS_B7 (91x128 mm ; 3.58x5.04 in)&lt;/li&gt;</span>
<a name="l02249"></a>02249 <span class="comment">     * &lt;li&gt;JIS_B8 (64x91 mm ; 2.52x3.58 in)&lt;/li&gt;</span>
<a name="l02250"></a>02250 <span class="comment">     * &lt;li&gt;JIS_B9 (45x64 mm ; 1.77x2.52 in)&lt;/li&gt;</span>
<a name="l02251"></a>02251 <span class="comment">     * &lt;li&gt;JIS_B10 (32x45 mm ; 1.26x1.77 in)&lt;/li&gt;</span>
<a name="l02252"></a>02252 <span class="comment">     * &lt;li&gt;JIS_B11 (22x32 mm ; 0.87x1.26 in)&lt;/li&gt;</span>
<a name="l02253"></a>02253 <span class="comment">     * &lt;li&gt;JIS_B12 (16x22 mm ; 0.63x0.87 in)&lt;/li&gt;</span>
<a name="l02254"></a>02254 <span class="comment">     * &lt;li&gt;&lt;b&gt;PA Series&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02255"></a>02255 <span class="comment">     * &lt;li&gt;PA0 (840x1120 mm ; 33.07x44.09 in)&lt;/li&gt;</span>
<a name="l02256"></a>02256 <span class="comment">     * &lt;li&gt;PA1 (560x840 mm ; 22.05x33.07 in)&lt;/li&gt;</span>
<a name="l02257"></a>02257 <span class="comment">     * &lt;li&gt;PA2 (420x560 mm ; 16.54x22.05 in)&lt;/li&gt;</span>
<a name="l02258"></a>02258 <span class="comment">     * &lt;li&gt;PA3 (280x420 mm ; 11.02x16.54 in)&lt;/li&gt;</span>
<a name="l02259"></a>02259 <span class="comment">     * &lt;li&gt;PA4 (210x280 mm ; 8.27x11.02 in)&lt;/li&gt;</span>
<a name="l02260"></a>02260 <span class="comment">     * &lt;li&gt;PA5 (140x210 mm ; 5.51x8.27 in)&lt;/li&gt;</span>
<a name="l02261"></a>02261 <span class="comment">     * &lt;li&gt;PA6 (105x140 mm ; 4.13x5.51 in)&lt;/li&gt;</span>
<a name="l02262"></a>02262 <span class="comment">     * &lt;li&gt;PA7 (70x105 mm ; 2.76x4.13 in)&lt;/li&gt;</span>
<a name="l02263"></a>02263 <span class="comment">     * &lt;li&gt;PA8 (52x70 mm ; 2.05x2.76 in)&lt;/li&gt;</span>
<a name="l02264"></a>02264 <span class="comment">     * &lt;li&gt;PA9 (35x52 mm ; 1.38x2.05 in)&lt;/li&gt;</span>
<a name="l02265"></a>02265 <span class="comment">     * &lt;li&gt;PA10 (26x35 mm ; 1.02x1.38 in)&lt;/li&gt;</span>
<a name="l02266"></a>02266 <span class="comment">     * &lt;li&gt;&lt;b&gt;Standard Photographic Print Sizes&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02267"></a>02267 <span class="comment">     * &lt;li&gt;PASSPORT_PHOTO (35x45 mm ; 1.38x1.77 in)&lt;/li&gt;</span>
<a name="l02268"></a>02268 <span class="comment">     * &lt;li&gt;E (82x120 mm ; 3.25x4.72 in)&lt;/li&gt;</span>
<a name="l02269"></a>02269 <span class="comment">     * &lt;li&gt;3R, L (89x127 mm ; 3.50x5.00 in)&lt;/li&gt;</span>
<a name="l02270"></a>02270 <span class="comment">     * &lt;li&gt;4R, KG (102x152 mm ; 4.02x5.98 in)&lt;/li&gt;</span>
<a name="l02271"></a>02271 <span class="comment">     * &lt;li&gt;4D (120x152 mm ; 4.72x5.98 in)&lt;/li&gt;</span>
<a name="l02272"></a>02272 <span class="comment">     * &lt;li&gt;5R, 2L (127x178 mm ; 5.00x7.01 in)&lt;/li&gt;</span>
<a name="l02273"></a>02273 <span class="comment">     * &lt;li&gt;6R, 8P (152x203 mm ; 5.98x7.99 in)&lt;/li&gt;</span>
<a name="l02274"></a>02274 <span class="comment">     * &lt;li&gt;8R, 6P (203x254 mm ; 7.99x10.00 in)&lt;/li&gt;</span>
<a name="l02275"></a>02275 <span class="comment">     * &lt;li&gt;S8R, 6PW (203x305 mm ; 7.99x12.01 in)&lt;/li&gt;</span>
<a name="l02276"></a>02276 <span class="comment">     * &lt;li&gt;10R, 4P (254x305 mm ; 10.00x12.01 in)&lt;/li&gt;</span>
<a name="l02277"></a>02277 <span class="comment">     * &lt;li&gt;S10R, 4PW (254x381 mm ; 10.00x15.00 in)&lt;/li&gt;</span>
<a name="l02278"></a>02278 <span class="comment">     * &lt;li&gt;11R (279x356 mm ; 10.98x14.02 in)&lt;/li&gt;</span>
<a name="l02279"></a>02279 <span class="comment">     * &lt;li&gt;S11R (279x432 mm ; 10.98x17.01 in)&lt;/li&gt;</span>
<a name="l02280"></a>02280 <span class="comment">     * &lt;li&gt;12R (305x381 mm ; 12.01x15.00 in)&lt;/li&gt;</span>
<a name="l02281"></a>02281 <span class="comment">     * &lt;li&gt;S12R (305x456 mm ; 12.01x17.95 in)&lt;/li&gt;</span>
<a name="l02282"></a>02282 <span class="comment">     * &lt;li&gt;&lt;b&gt;Common Newspaper Sizes&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02283"></a>02283 <span class="comment">     * &lt;li&gt;NEWSPAPER_BROADSHEET (750x600 mm ; 29.53x23.62 in)&lt;/li&gt;</span>
<a name="l02284"></a>02284 <span class="comment">     * &lt;li&gt;NEWSPAPER_BERLINER (470x315 mm ; 18.50x12.40 in)&lt;/li&gt;</span>
<a name="l02285"></a>02285 <span class="comment">     * &lt;li&gt;NEWSPAPER_COMPACT, NEWSPAPER_TABLOID (430x280 mm ; 16.93x11.02 in)&lt;/li&gt;</span>
<a name="l02286"></a>02286 <span class="comment">     * &lt;li&gt;&lt;b&gt;Business Cards&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02287"></a>02287 <span class="comment">     * &lt;li&gt;CREDIT_CARD, BUSINESS_CARD, BUSINESS_CARD_ISO7810 (54x86 mm ; 2.13x3.37 in)&lt;/li&gt;</span>
<a name="l02288"></a>02288 <span class="comment">     * &lt;li&gt;BUSINESS_CARD_ISO216 (52x74 mm ; 2.05x2.91 in)&lt;/li&gt;</span>
<a name="l02289"></a>02289 <span class="comment">     * &lt;li&gt;BUSINESS_CARD_IT, BUSINESS_CARD_UK, BUSINESS_CARD_FR, BUSINESS_CARD_DE, BUSINESS_CARD_ES (55x85 mm ; 2.17x3.35 in)&lt;/li&gt;</span>
<a name="l02290"></a>02290 <span class="comment">     * &lt;li&gt;BUSINESS_CARD_US, BUSINESS_CARD_CA (51x89 mm ; 2.01x3.50 in)&lt;/li&gt;</span>
<a name="l02291"></a>02291 <span class="comment">     * &lt;li&gt;BUSINESS_CARD_JP (55x91 mm ; 2.17x3.58 in)&lt;/li&gt;</span>
<a name="l02292"></a>02292 <span class="comment">     * &lt;li&gt;BUSINESS_CARD_HK (54x90 mm ; 2.13x3.54 in)&lt;/li&gt;</span>
<a name="l02293"></a>02293 <span class="comment">     * &lt;li&gt;BUSINESS_CARD_AU, BUSINESS_CARD_DK, BUSINESS_CARD_SE (55x90 mm ; 2.17x3.54 in)&lt;/li&gt;</span>
<a name="l02294"></a>02294 <span class="comment">     * &lt;li&gt;BUSINESS_CARD_RU, BUSINESS_CARD_CZ, BUSINESS_CARD_FI, BUSINESS_CARD_HU, BUSINESS_CARD_IL (50x90 mm ; 1.97x3.54 in)&lt;/li&gt;</span>
<a name="l02295"></a>02295 <span class="comment">     * &lt;li&gt;&lt;b&gt;Billboards&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02296"></a>02296 <span class="comment">     * &lt;li&gt;4SHEET (1016x1524 mm ; 40.00x60.00 in)&lt;/li&gt;</span>
<a name="l02297"></a>02297 <span class="comment">     * &lt;li&gt;6SHEET (1200x1800 mm ; 47.24x70.87 in)&lt;/li&gt;</span>
<a name="l02298"></a>02298 <span class="comment">     * &lt;li&gt;12SHEET (3048x1524 mm ; 120.00x60.00 in)&lt;/li&gt;</span>
<a name="l02299"></a>02299 <span class="comment">     * &lt;li&gt;16SHEET (2032x3048 mm ; 80.00x120.00 in)&lt;/li&gt;</span>
<a name="l02300"></a>02300 <span class="comment">     * &lt;li&gt;32SHEET (4064x3048 mm ; 160.00x120.00 in)&lt;/li&gt;</span>
<a name="l02301"></a>02301 <span class="comment">     * &lt;li&gt;48SHEET (6096x3048 mm ; 240.00x120.00 in)&lt;/li&gt;</span>
<a name="l02302"></a>02302 <span class="comment">     * &lt;li&gt;64SHEET (8128x3048 mm ; 320.00x120.00 in)&lt;/li&gt;</span>
<a name="l02303"></a>02303 <span class="comment">     * &lt;li&gt;96SHEET (12192x3048 mm ; 480.00x120.00 in)&lt;/li&gt;</span>
<a name="l02304"></a>02304 <span class="comment">     * &lt;li&gt;&lt;b&gt;Old Imperial English (some are still used in USA)&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02305"></a>02305 <span class="comment">     * &lt;li&gt;EN_EMPEROR (1219x1829 mm ; 48.00x72.00 in)&lt;/li&gt;</span>
<a name="l02306"></a>02306 <span class="comment">     * &lt;li&gt;EN_ANTIQUARIAN (787x1346 mm ; 31.00x53.00 in)&lt;/li&gt;</span>
<a name="l02307"></a>02307 <span class="comment">     * &lt;li&gt;EN_GRAND_EAGLE (730x1067 mm ; 28.75x42.00 in)&lt;/li&gt;</span>
<a name="l02308"></a>02308 <span class="comment">     * &lt;li&gt;EN_DOUBLE_ELEPHANT (679x1016 mm ; 26.75x40.00 in)&lt;/li&gt;</span>
<a name="l02309"></a>02309 <span class="comment">     * &lt;li&gt;EN_ATLAS (660x864 mm ; 26.00x34.00 in)&lt;/li&gt;</span>
<a name="l02310"></a>02310 <span class="comment">     * &lt;li&gt;EN_COLOMBIER (597x876 mm ; 23.50x34.50 in)&lt;/li&gt;</span>
<a name="l02311"></a>02311 <span class="comment">     * &lt;li&gt;EN_ELEPHANT (584x711 mm ; 23.00x28.00 in)&lt;/li&gt;</span>
<a name="l02312"></a>02312 <span class="comment">     * &lt;li&gt;EN_DOUBLE_DEMY (572x902 mm ; 22.50x35.50 in)&lt;/li&gt;</span>
<a name="l02313"></a>02313 <span class="comment">     * &lt;li&gt;EN_IMPERIAL (559x762 mm ; 22.00x30.00 in)&lt;/li&gt;</span>
<a name="l02314"></a>02314 <span class="comment">     * &lt;li&gt;EN_PRINCESS (546x711 mm ; 21.50x28.00 in)&lt;/li&gt;</span>
<a name="l02315"></a>02315 <span class="comment">     * &lt;li&gt;EN_CARTRIDGE (533x660 mm ; 21.00x26.00 in)&lt;/li&gt;</span>
<a name="l02316"></a>02316 <span class="comment">     * &lt;li&gt;EN_DOUBLE_LARGE_POST (533x838 mm ; 21.00x33.00 in)&lt;/li&gt;</span>
<a name="l02317"></a>02317 <span class="comment">     * &lt;li&gt;EN_ROYAL (508x635 mm ; 20.00x25.00 in)&lt;/li&gt;</span>
<a name="l02318"></a>02318 <span class="comment">     * &lt;li&gt;EN_SHEET, EN_HALF_POST (495x597 mm ; 19.50x23.50 in)&lt;/li&gt;</span>
<a name="l02319"></a>02319 <span class="comment">     * &lt;li&gt;EN_SUPER_ROYAL (483x686 mm ; 19.00x27.00 in)&lt;/li&gt;</span>
<a name="l02320"></a>02320 <span class="comment">     * &lt;li&gt;EN_DOUBLE_POST (483x775 mm ; 19.00x30.50 in)&lt;/li&gt;</span>
<a name="l02321"></a>02321 <span class="comment">     * &lt;li&gt;EN_MEDIUM (445x584 mm ; 17.50x23.00 in)&lt;/li&gt;</span>
<a name="l02322"></a>02322 <span class="comment">     * &lt;li&gt;EN_DEMY (445x572 mm ; 17.50x22.50 in)&lt;/li&gt;</span>
<a name="l02323"></a>02323 <span class="comment">     * &lt;li&gt;EN_LARGE_POST (419x533 mm ; 16.50x21.00 in)&lt;/li&gt;</span>
<a name="l02324"></a>02324 <span class="comment">     * &lt;li&gt;EN_COPY_DRAUGHT (406x508 mm ; 16.00x20.00 in)&lt;/li&gt;</span>
<a name="l02325"></a>02325 <span class="comment">     * &lt;li&gt;EN_POST (394x489 mm ; 15.50x19.25 in)&lt;/li&gt;</span>
<a name="l02326"></a>02326 <span class="comment">     * &lt;li&gt;EN_CROWN (381x508 mm ; 15.00x20.00 in)&lt;/li&gt;</span>
<a name="l02327"></a>02327 <span class="comment">     * &lt;li&gt;EN_PINCHED_POST (375x470 mm ; 14.75x18.50 in)&lt;/li&gt;</span>
<a name="l02328"></a>02328 <span class="comment">     * &lt;li&gt;EN_BRIEF (343x406 mm ; 13.50x16.00 in)&lt;/li&gt;</span>
<a name="l02329"></a>02329 <span class="comment">     * &lt;li&gt;EN_FOOLSCAP (343x432 mm ; 13.50x17.00 in)&lt;/li&gt;</span>
<a name="l02330"></a>02330 <span class="comment">     * &lt;li&gt;EN_SMALL_FOOLSCAP (337x419 mm ; 13.25x16.50 in)&lt;/li&gt;</span>
<a name="l02331"></a>02331 <span class="comment">     * &lt;li&gt;EN_POTT (318x381 mm ; 12.50x15.00 in)&lt;/li&gt;</span>
<a name="l02332"></a>02332 <span class="comment">     * &lt;li&gt;&lt;b&gt;Old Imperial Belgian&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02333"></a>02333 <span class="comment">     * &lt;li&gt;BE_GRAND_AIGLE (700x1040 mm ; 27.56x40.94 in)&lt;/li&gt;</span>
<a name="l02334"></a>02334 <span class="comment">     * &lt;li&gt;BE_COLOMBIER (620x850 mm ; 24.41x33.46 in)&lt;/li&gt;</span>
<a name="l02335"></a>02335 <span class="comment">     * &lt;li&gt;BE_DOUBLE_CARRE (620x920 mm ; 24.41x36.22 in)&lt;/li&gt;</span>
<a name="l02336"></a>02336 <span class="comment">     * &lt;li&gt;BE_ELEPHANT (616x770 mm ; 24.25x30.31 in)&lt;/li&gt;</span>
<a name="l02337"></a>02337 <span class="comment">     * &lt;li&gt;BE_PETIT_AIGLE (600x840 mm ; 23.62x33.07 in)&lt;/li&gt;</span>
<a name="l02338"></a>02338 <span class="comment">     * &lt;li&gt;BE_GRAND_JESUS (550x730 mm ; 21.65x28.74 in)&lt;/li&gt;</span>
<a name="l02339"></a>02339 <span class="comment">     * &lt;li&gt;BE_JESUS (540x730 mm ; 21.26x28.74 in)&lt;/li&gt;</span>
<a name="l02340"></a>02340 <span class="comment">     * &lt;li&gt;BE_RAISIN (500x650 mm ; 19.69x25.59 in)&lt;/li&gt;</span>
<a name="l02341"></a>02341 <span class="comment">     * &lt;li&gt;BE_GRAND_MEDIAN (460x605 mm ; 18.11x23.82 in)&lt;/li&gt;</span>
<a name="l02342"></a>02342 <span class="comment">     * &lt;li&gt;BE_DOUBLE_POSTE (435x565 mm ; 17.13x22.24 in)&lt;/li&gt;</span>
<a name="l02343"></a>02343 <span class="comment">     * &lt;li&gt;BE_COQUILLE (430x560 mm ; 16.93x22.05 in)&lt;/li&gt;</span>
<a name="l02344"></a>02344 <span class="comment">     * &lt;li&gt;BE_PETIT_MEDIAN (415x530 mm ; 16.34x20.87 in)&lt;/li&gt;</span>
<a name="l02345"></a>02345 <span class="comment">     * &lt;li&gt;BE_RUCHE (360x460 mm ; 14.17x18.11 in)&lt;/li&gt;</span>
<a name="l02346"></a>02346 <span class="comment">     * &lt;li&gt;BE_PROPATRIA (345x430 mm ; 13.58x16.93 in)&lt;/li&gt;</span>
<a name="l02347"></a>02347 <span class="comment">     * &lt;li&gt;BE_LYS (317x397 mm ; 12.48x15.63 in)&lt;/li&gt;</span>
<a name="l02348"></a>02348 <span class="comment">     * &lt;li&gt;BE_POT (307x384 mm ; 12.09x15.12 in)&lt;/li&gt;</span>
<a name="l02349"></a>02349 <span class="comment">     * &lt;li&gt;BE_ROSETTE (270x347 mm ; 10.63x13.66 in)&lt;/li&gt;</span>
<a name="l02350"></a>02350 <span class="comment">     * &lt;li&gt;&lt;b&gt;Old Imperial French&lt;/b&gt;&lt;/li&gt;</span>
<a name="l02351"></a>02351 <span class="comment">     * &lt;li&gt;FR_UNIVERS (1000x1300 mm ; 39.37x51.18 in)&lt;/li&gt;</span>
<a name="l02352"></a>02352 <span class="comment">     * &lt;li&gt;FR_DOUBLE_COLOMBIER (900x1260 mm ; 35.43x49.61 in)&lt;/li&gt;</span>
<a name="l02353"></a>02353 <span class="comment">     * &lt;li&gt;FR_GRANDE_MONDE (900x1260 mm ; 35.43x49.61 in)&lt;/li&gt;</span>
<a name="l02354"></a>02354 <span class="comment">     * &lt;li&gt;FR_DOUBLE_SOLEIL (800x1200 mm ; 31.50x47.24 in)&lt;/li&gt;</span>
<a name="l02355"></a>02355 <span class="comment">     * &lt;li&gt;FR_DOUBLE_JESUS (760x1120 mm ; 29.92x44.09 in)&lt;/li&gt;</span>
<a name="l02356"></a>02356 <span class="comment">     * &lt;li&gt;FR_GRAND_AIGLE (750x1060 mm ; 29.53x41.73 in)&lt;/li&gt;</span>
<a name="l02357"></a>02357 <span class="comment">     * &lt;li&gt;FR_PETIT_AIGLE (700x940 mm ; 27.56x37.01 in)&lt;/li&gt;</span>
<a name="l02358"></a>02358 <span class="comment">     * &lt;li&gt;FR_DOUBLE_RAISIN (650x1000 mm ; 25.59x39.37 in)&lt;/li&gt;</span>
<a name="l02359"></a>02359 <span class="comment">     * &lt;li&gt;FR_JOURNAL (650x940 mm ; 25.59x37.01 in)&lt;/li&gt;</span>
<a name="l02360"></a>02360 <span class="comment">     * &lt;li&gt;FR_COLOMBIER_AFFICHE (630x900 mm ; 24.80x35.43 in)&lt;/li&gt;</span>
<a name="l02361"></a>02361 <span class="comment">     * &lt;li&gt;FR_DOUBLE_CAVALIER (620x920 mm ; 24.41x36.22 in)&lt;/li&gt;</span>
<a name="l02362"></a>02362 <span class="comment">     * &lt;li&gt;FR_CLOCHE (600x800 mm ; 23.62x31.50 in)&lt;/li&gt;</span>
<a name="l02363"></a>02363 <span class="comment">     * &lt;li&gt;FR_SOLEIL (600x800 mm ; 23.62x31.50 in)&lt;/li&gt;</span>
<a name="l02364"></a>02364 <span class="comment">     * &lt;li&gt;FR_DOUBLE_CARRE (560x900 mm ; 22.05x35.43 in)&lt;/li&gt;</span>
<a name="l02365"></a>02365 <span class="comment">     * &lt;li&gt;FR_DOUBLE_COQUILLE (560x880 mm ; 22.05x34.65 in)&lt;/li&gt;</span>
<a name="l02366"></a>02366 <span class="comment">     * &lt;li&gt;FR_JESUS (560x760 mm ; 22.05x29.92 in)&lt;/li&gt;</span>
<a name="l02367"></a>02367 <span class="comment">     * &lt;li&gt;FR_RAISIN (500x650 mm ; 19.69x25.59 in)&lt;/li&gt;</span>
<a name="l02368"></a>02368 <span class="comment">     * &lt;li&gt;FR_CAVALIER (460x620 mm ; 18.11x24.41 in)&lt;/li&gt;</span>
<a name="l02369"></a>02369 <span class="comment">     * &lt;li&gt;FR_DOUBLE_COURONNE (460x720 mm ; 18.11x28.35 in)&lt;/li&gt;</span>
<a name="l02370"></a>02370 <span class="comment">     * &lt;li&gt;FR_CARRE (450x560 mm ; 17.72x22.05 in)&lt;/li&gt;</span>
<a name="l02371"></a>02371 <span class="comment">     * &lt;li&gt;FR_COQUILLE (440x560 mm ; 17.32x22.05 in)&lt;/li&gt;</span>
<a name="l02372"></a>02372 <span class="comment">     * &lt;li&gt;FR_DOUBLE_TELLIERE (440x680 mm ; 17.32x26.77 in)&lt;/li&gt;</span>
<a name="l02373"></a>02373 <span class="comment">     * &lt;li&gt;FR_DOUBLE_CLOCHE (400x600 mm ; 15.75x23.62 in)&lt;/li&gt;</span>
<a name="l02374"></a>02374 <span class="comment">     * &lt;li&gt;FR_DOUBLE_POT (400x620 mm ; 15.75x24.41 in)&lt;/li&gt;</span>
<a name="l02375"></a>02375 <span class="comment">     * &lt;li&gt;FR_ECU (400x520 mm ; 15.75x20.47 in)&lt;/li&gt;</span>
<a name="l02376"></a>02376 <span class="comment">     * &lt;li&gt;FR_COURONNE (360x460 mm ; 14.17x18.11 in)&lt;/li&gt;</span>
<a name="l02377"></a>02377 <span class="comment">     * &lt;li&gt;FR_TELLIERE (340x440 mm ; 13.39x17.32 in)&lt;/li&gt;</span>
<a name="l02378"></a>02378 <span class="comment">     * &lt;li&gt;FR_POT (310x400 mm ; 12.20x15.75 in)&lt;/li&gt;</span>
<a name="l02379"></a>02379 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l02380"></a>02380 <span class="comment">     * @return array containing page width and height in points</span>
<a name="l02381"></a>02381 <span class="comment">     * @public</span>
<a name="l02382"></a>02382 <span class="comment">     * @since 5.0.010 (2010-05-17)</span>
<a name="l02383"></a>02383 <span class="comment">     */</span>
<a name="l02384"></a><a class="code" href="classTCPDF.html#a087d4df77e60b7054e97804069ed32c5">02384</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a087d4df77e60b7054e97804069ed32c5" title="Get page dimensions from format name.">getPageSizeFromFormat</a>(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>) {
<a name="l02385"></a>02385         <span class="comment">// Paper cordinates are calculated in this way: (inches * 72) where (1 inch = 25.4 mm)</span>
<a name="l02386"></a>02386         <span class="keywordflow">switch</span> (strtoupper(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>)) {
<a name="l02387"></a>02387             <span class="comment">// ISO 216 A Series + 2 SIS 014711 extensions</span>
<a name="l02388"></a>02388             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A0&#39;</span> : {$pf = array( 2383.937, 3370.394); <span class="keywordflow">break</span>;}
<a name="l02389"></a>02389             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A1&#39;</span> : {$pf = array( 1683.780, 2383.937); <span class="keywordflow">break</span>;}
<a name="l02390"></a>02390             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A2&#39;</span> : {$pf = array( 1190.551, 1683.780); <span class="keywordflow">break</span>;}
<a name="l02391"></a>02391             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A3&#39;</span> : {$pf = array(  841.890, 1190.551); <span class="keywordflow">break</span>;}
<a name="l02392"></a>02392             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A4&#39;</span> : {$pf = array(  595.276,  841.890); <span class="keywordflow">break</span>;}
<a name="l02393"></a>02393             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A5&#39;</span> : {$pf = array(  419.528,  595.276); <span class="keywordflow">break</span>;}
<a name="l02394"></a>02394             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A6&#39;</span> : {$pf = array(  297.638,  419.528); <span class="keywordflow">break</span>;}
<a name="l02395"></a>02395             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A7&#39;</span> : {$pf = array(  209.764,  297.638); <span class="keywordflow">break</span>;}
<a name="l02396"></a>02396             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A8&#39;</span> : {$pf = array(  147.402,  209.764); <span class="keywordflow">break</span>;}
<a name="l02397"></a>02397             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A9&#39;</span> : {$pf = array(  104.882,  147.402); <span class="keywordflow">break</span>;}
<a name="l02398"></a>02398             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A10&#39;</span>: {$pf = array(   73.701,  104.882); <span class="keywordflow">break</span>;}
<a name="l02399"></a>02399             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A11&#39;</span>: {$pf = array(   51.024,   73.701); <span class="keywordflow">break</span>;}
<a name="l02400"></a>02400             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A12&#39;</span>: {$pf = array(   36.850,   51.024); <span class="keywordflow">break</span>;}
<a name="l02401"></a>02401             <span class="comment">// ISO 216 B Series + 2 SIS 014711 extensions</span>
<a name="l02402"></a>02402             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B0&#39;</span> : {$pf = array( 2834.646, 4008.189); <span class="keywordflow">break</span>;}
<a name="l02403"></a>02403             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B1&#39;</span> : {$pf = array( 2004.094, 2834.646); <span class="keywordflow">break</span>;}
<a name="l02404"></a>02404             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B2&#39;</span> : {$pf = array( 1417.323, 2004.094); <span class="keywordflow">break</span>;}
<a name="l02405"></a>02405             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B3&#39;</span> : {$pf = array( 1000.630, 1417.323); <span class="keywordflow">break</span>;}
<a name="l02406"></a>02406             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B4&#39;</span> : {$pf = array(  708.661, 1000.630); <span class="keywordflow">break</span>;}
<a name="l02407"></a>02407             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B5&#39;</span> : {$pf = array(  498.898,  708.661); <span class="keywordflow">break</span>;}
<a name="l02408"></a>02408             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B6&#39;</span> : {$pf = array(  354.331,  498.898); <span class="keywordflow">break</span>;}
<a name="l02409"></a>02409             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B7&#39;</span> : {$pf = array(  249.449,  354.331); <span class="keywordflow">break</span>;}
<a name="l02410"></a>02410             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B8&#39;</span> : {$pf = array(  175.748,  249.449); <span class="keywordflow">break</span>;}
<a name="l02411"></a>02411             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B9&#39;</span> : {$pf = array(  124.724,  175.748); <span class="keywordflow">break</span>;}
<a name="l02412"></a>02412             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B10&#39;</span>: {$pf = array(   87.874,  124.724); <span class="keywordflow">break</span>;}
<a name="l02413"></a>02413             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B11&#39;</span>: {$pf = array(   62.362,   87.874); <span class="keywordflow">break</span>;}
<a name="l02414"></a>02414             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B12&#39;</span>: {$pf = array(   42.520,   62.362); <span class="keywordflow">break</span>;}
<a name="l02415"></a>02415             <span class="comment">// ISO 216 C Series + 2 SIS 014711 extensions + 2 EXTENSION</span>
<a name="l02416"></a>02416             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C0&#39;</span> : {$pf = array( 2599.370, 3676.535); <span class="keywordflow">break</span>;}
<a name="l02417"></a>02417             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C1&#39;</span> : {$pf = array( 1836.850, 2599.370); <span class="keywordflow">break</span>;}
<a name="l02418"></a>02418             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C2&#39;</span> : {$pf = array( 1298.268, 1836.850); <span class="keywordflow">break</span>;}
<a name="l02419"></a>02419             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C3&#39;</span> : {$pf = array(  918.425, 1298.268); <span class="keywordflow">break</span>;}
<a name="l02420"></a>02420             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C4&#39;</span> : {$pf = array(  649.134,  918.425); <span class="keywordflow">break</span>;}
<a name="l02421"></a>02421             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C5&#39;</span> : {$pf = array(  459.213,  649.134); <span class="keywordflow">break</span>;}
<a name="l02422"></a>02422             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C6&#39;</span> : {$pf = array(  323.150,  459.213); <span class="keywordflow">break</span>;}
<a name="l02423"></a>02423             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C7&#39;</span> : {$pf = array(  229.606,  323.150); <span class="keywordflow">break</span>;}
<a name="l02424"></a>02424             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C8&#39;</span> : {$pf = array(  161.575,  229.606); <span class="keywordflow">break</span>;}
<a name="l02425"></a>02425             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C9&#39;</span> : {$pf = array(  113.386,  161.575); <span class="keywordflow">break</span>;}
<a name="l02426"></a>02426             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C10&#39;</span>: {$pf = array(   79.370,  113.386); <span class="keywordflow">break</span>;}
<a name="l02427"></a>02427             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C11&#39;</span>: {$pf = array(   56.693,   79.370); <span class="keywordflow">break</span>;}
<a name="l02428"></a>02428             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C12&#39;</span>: {$pf = array(   39.685,   56.693); <span class="keywordflow">break</span>;}
<a name="l02429"></a>02429             <span class="keywordflow">case</span> <span class="stringliteral">&#39;C76&#39;</span>: {$pf = array(  229.606,  459.213); <span class="keywordflow">break</span>;}
<a name="l02430"></a>02430             <span class="keywordflow">case</span> <span class="stringliteral">&#39;DL&#39;</span> : {$pf = array(  311.811,  623.622); <span class="keywordflow">break</span>;}
<a name="l02431"></a>02431             <span class="comment">// SIS 014711 E Series</span>
<a name="l02432"></a>02432             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E0&#39;</span> : {$pf = array( 2491.654, 3517.795); <span class="keywordflow">break</span>;}
<a name="l02433"></a>02433             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E1&#39;</span> : {$pf = array( 1757.480, 2491.654); <span class="keywordflow">break</span>;}
<a name="l02434"></a>02434             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E2&#39;</span> : {$pf = array( 1247.244, 1757.480); <span class="keywordflow">break</span>;}
<a name="l02435"></a>02435             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E3&#39;</span> : {$pf = array(  878.740, 1247.244); <span class="keywordflow">break</span>;}
<a name="l02436"></a>02436             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E4&#39;</span> : {$pf = array(  623.622,  878.740); <span class="keywordflow">break</span>;}
<a name="l02437"></a>02437             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E5&#39;</span> : {$pf = array(  439.370,  623.622); <span class="keywordflow">break</span>;}
<a name="l02438"></a>02438             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E6&#39;</span> : {$pf = array(  311.811,  439.370); <span class="keywordflow">break</span>;}
<a name="l02439"></a>02439             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E7&#39;</span> : {$pf = array(  221.102,  311.811); <span class="keywordflow">break</span>;}
<a name="l02440"></a>02440             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E8&#39;</span> : {$pf = array(  155.906,  221.102); <span class="keywordflow">break</span>;}
<a name="l02441"></a>02441             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E9&#39;</span> : {$pf = array(  110.551,  155.906); <span class="keywordflow">break</span>;}
<a name="l02442"></a>02442             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E10&#39;</span>: {$pf = array(   76.535,  110.551); <span class="keywordflow">break</span>;}
<a name="l02443"></a>02443             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E11&#39;</span>: {$pf = array(   53.858,   76.535); <span class="keywordflow">break</span>;}
<a name="l02444"></a>02444             <span class="keywordflow">case</span> <span class="stringliteral">&#39;E12&#39;</span>: {$pf = array(   36.850,   53.858); <span class="keywordflow">break</span>;}
<a name="l02445"></a>02445             <span class="comment">// SIS 014711 G Series</span>
<a name="l02446"></a>02446             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G0&#39;</span> : {$pf = array( 2715.591, 3838.110); <span class="keywordflow">break</span>;}
<a name="l02447"></a>02447             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G1&#39;</span> : {$pf = array( 1919.055, 2715.591); <span class="keywordflow">break</span>;}
<a name="l02448"></a>02448             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G2&#39;</span> : {$pf = array( 1357.795, 1919.055); <span class="keywordflow">break</span>;}
<a name="l02449"></a>02449             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G3&#39;</span> : {$pf = array(  958.110, 1357.795); <span class="keywordflow">break</span>;}
<a name="l02450"></a>02450             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G4&#39;</span> : {$pf = array(  677.480,  958.110); <span class="keywordflow">break</span>;}
<a name="l02451"></a>02451             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G5&#39;</span> : {$pf = array(  479.055,  677.480); <span class="keywordflow">break</span>;}
<a name="l02452"></a>02452             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G6&#39;</span> : {$pf = array(  337.323,  479.055); <span class="keywordflow">break</span>;}
<a name="l02453"></a>02453             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G7&#39;</span> : {$pf = array(  238.110,  337.323); <span class="keywordflow">break</span>;}
<a name="l02454"></a>02454             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G8&#39;</span> : {$pf = array(  167.244,  238.110); <span class="keywordflow">break</span>;}
<a name="l02455"></a>02455             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G9&#39;</span> : {$pf = array(  119.055,  167.244); <span class="keywordflow">break</span>;}
<a name="l02456"></a>02456             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G10&#39;</span>: {$pf = array(   82.205,  119.055); <span class="keywordflow">break</span>;}
<a name="l02457"></a>02457             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G11&#39;</span>: {$pf = array(   59.528,   82.205); <span class="keywordflow">break</span>;}
<a name="l02458"></a>02458             <span class="keywordflow">case</span> <span class="stringliteral">&#39;G12&#39;</span>: {$pf = array(   39.685,   59.528); <span class="keywordflow">break</span>;}
<a name="l02459"></a>02459             <span class="comment">// ISO Press</span>
<a name="l02460"></a>02460             <span class="keywordflow">case</span> <span class="stringliteral">&#39;RA0&#39;</span>: {$pf = array( 2437.795, 3458.268); <span class="keywordflow">break</span>;}
<a name="l02461"></a>02461             <span class="keywordflow">case</span> <span class="stringliteral">&#39;RA1&#39;</span>: {$pf = array( 1729.134, 2437.795); <span class="keywordflow">break</span>;}
<a name="l02462"></a>02462             <span class="keywordflow">case</span> <span class="stringliteral">&#39;RA2&#39;</span>: {$pf = array( 1218.898, 1729.134); <span class="keywordflow">break</span>;}
<a name="l02463"></a>02463             <span class="keywordflow">case</span> <span class="stringliteral">&#39;RA3&#39;</span>: {$pf = array(  864.567, 1218.898); <span class="keywordflow">break</span>;}
<a name="l02464"></a>02464             <span class="keywordflow">case</span> <span class="stringliteral">&#39;RA4&#39;</span>: {$pf = array(  609.449,  864.567); <span class="keywordflow">break</span>;}
<a name="l02465"></a>02465             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SRA0&#39;</span>: {$pf = array( 2551.181, 3628.346); <span class="keywordflow">break</span>;}
<a name="l02466"></a>02466             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SRA1&#39;</span>: {$pf = array( 1814.173, 2551.181); <span class="keywordflow">break</span>;}
<a name="l02467"></a>02467             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SRA2&#39;</span>: {$pf = array( 1275.591, 1814.173); <span class="keywordflow">break</span>;}
<a name="l02468"></a>02468             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SRA3&#39;</span>: {$pf = array(  907.087, 1275.591); <span class="keywordflow">break</span>;}
<a name="l02469"></a>02469             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SRA4&#39;</span>: {$pf = array(  637.795,  907.087); <span class="keywordflow">break</span>;}
<a name="l02470"></a>02470             <span class="comment">// German  DIN 476</span>
<a name="l02471"></a>02471             <span class="keywordflow">case</span> <span class="stringliteral">&#39;4A0&#39;</span>: {$pf = array( 4767.874, 6740.787); <span class="keywordflow">break</span>;}
<a name="l02472"></a>02472             <span class="keywordflow">case</span> <span class="stringliteral">&#39;2A0&#39;</span>: {$pf = array( 3370.394, 4767.874); <span class="keywordflow">break</span>;}
<a name="l02473"></a>02473             <span class="comment">// Variations on the ISO Standard</span>
<a name="l02474"></a>02474             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A2_EXTRA&#39;</span>   : {$pf = array( 1261.417, 1754.646); <span class="keywordflow">break</span>;}
<a name="l02475"></a>02475             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A3+&#39;</span>        : {$pf = array(  932.598, 1369.134); <span class="keywordflow">break</span>;}
<a name="l02476"></a>02476             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A3_EXTRA&#39;</span>   : {$pf = array(  912.756, 1261.417); <span class="keywordflow">break</span>;}
<a name="l02477"></a>02477             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A3_SUPER&#39;</span>   : {$pf = array(  864.567, 1440.000); <span class="keywordflow">break</span>;}
<a name="l02478"></a>02478             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SUPER_A3&#39;</span>   : {$pf = array(  864.567, 1380.472); <span class="keywordflow">break</span>;}
<a name="l02479"></a>02479             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A4_EXTRA&#39;</span>   : {$pf = array(  666.142,  912.756); <span class="keywordflow">break</span>;}
<a name="l02480"></a>02480             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A4_SUPER&#39;</span>   : {$pf = array(  649.134,  912.756); <span class="keywordflow">break</span>;}
<a name="l02481"></a>02481             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SUPER_A4&#39;</span>   : {$pf = array(  643.465, 1009.134); <span class="keywordflow">break</span>;}
<a name="l02482"></a>02482             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A4_LONG&#39;</span>    : {$pf = array(  595.276,  986.457); <span class="keywordflow">break</span>;}
<a name="l02483"></a>02483             <span class="keywordflow">case</span> <span class="stringliteral">&#39;F4&#39;</span>         : {$pf = array(  595.276,  935.433); <span class="keywordflow">break</span>;}
<a name="l02484"></a>02484             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SO_B5_EXTRA&#39;</span>: {$pf = array(  572.598,  782.362); <span class="keywordflow">break</span>;}
<a name="l02485"></a>02485             <span class="keywordflow">case</span> <span class="stringliteral">&#39;A5_EXTRA&#39;</span>   : {$pf = array(  490.394,  666.142); <span class="keywordflow">break</span>;}
<a name="l02486"></a>02486             <span class="comment">// ANSI Series</span>
<a name="l02487"></a>02487             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANSI_E&#39;</span>: {$pf = array( 2448.000, 3168.000); <span class="keywordflow">break</span>;}
<a name="l02488"></a>02488             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANSI_D&#39;</span>: {$pf = array( 1584.000, 2448.000); <span class="keywordflow">break</span>;}
<a name="l02489"></a>02489             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANSI_C&#39;</span>: {$pf = array( 1224.000, 1584.000); <span class="keywordflow">break</span>;}
<a name="l02490"></a>02490             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANSI_B&#39;</span>: {$pf = array(  792.000, 1224.000); <span class="keywordflow">break</span>;}
<a name="l02491"></a>02491             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANSI_A&#39;</span>: {$pf = array(  612.000,  792.000); <span class="keywordflow">break</span>;}
<a name="l02492"></a>02492             <span class="comment">// Traditional &#39;Loose&#39; North American Paper Sizes</span>
<a name="l02493"></a>02493             <span class="keywordflow">case</span> <span class="stringliteral">&#39;USLEDGER&#39;</span>:
<a name="l02494"></a>02494             <span class="keywordflow">case</span> <span class="stringliteral">&#39;LEDGER&#39;</span> : {$pf = array( 1224.000,  792.000); <span class="keywordflow">break</span>;}
<a name="l02495"></a>02495             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ORGANIZERK&#39;</span>:
<a name="l02496"></a>02496             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BIBLE&#39;</span>:
<a name="l02497"></a>02497             <span class="keywordflow">case</span> <span class="stringliteral">&#39;USTABLOID&#39;</span>:
<a name="l02498"></a>02498             <span class="keywordflow">case</span> <span class="stringliteral">&#39;TABLOID&#39;</span>: {$pf = array(  792.000, 1224.000); <span class="keywordflow">break</span>;}
<a name="l02499"></a>02499             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ORGANIZERM&#39;</span>:
<a name="l02500"></a>02500             <span class="keywordflow">case</span> <span class="stringliteral">&#39;USLETTER&#39;</span>:
<a name="l02501"></a>02501             <span class="keywordflow">case</span> <span class="stringliteral">&#39;LETTER&#39;</span> : {$pf = array(  612.000,  792.000); <span class="keywordflow">break</span>;}
<a name="l02502"></a>02502             <span class="keywordflow">case</span> <span class="stringliteral">&#39;USLEGAL&#39;</span>:
<a name="l02503"></a>02503             <span class="keywordflow">case</span> <span class="stringliteral">&#39;LEGAL&#39;</span>  : {$pf = array(  612.000, 1008.000); <span class="keywordflow">break</span>;}
<a name="l02504"></a>02504             <span class="keywordflow">case</span> <span class="stringliteral">&#39;GOVERNMENTLETTER&#39;</span>:
<a name="l02505"></a>02505             <span class="keywordflow">case</span> <span class="stringliteral">&#39;GLETTER&#39;</span>: {$pf = array(  576.000,  756.000); <span class="keywordflow">break</span>;}
<a name="l02506"></a>02506             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JUNIORLEGAL&#39;</span>:
<a name="l02507"></a>02507             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JLEGAL&#39;</span> : {$pf = array(  576.000,  360.000); <span class="keywordflow">break</span>;}
<a name="l02508"></a>02508             <span class="comment">// Other North American Paper Sizes</span>
<a name="l02509"></a>02509             <span class="keywordflow">case</span> <span class="stringliteral">&#39;QUADDEMY&#39;</span>: {$pf = array( 2520.000, 3240.000); <span class="keywordflow">break</span>;}
<a name="l02510"></a>02510             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SUPER_B&#39;</span>: {$pf = array(  936.000, 1368.000); <span class="keywordflow">break</span>;}
<a name="l02511"></a>02511             <span class="keywordflow">case</span> <span class="stringliteral">&#39;QUARTO&#39;</span>: {$pf = array(  648.000,  792.000); <span class="keywordflow">break</span>;}
<a name="l02512"></a>02512             <span class="keywordflow">case</span> <span class="stringliteral">&#39;GOVERNMENTLEGAL&#39;</span>:
<a name="l02513"></a>02513             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FOLIO&#39;</span>: {$pf = array(  612.000,  936.000); <span class="keywordflow">break</span>;}
<a name="l02514"></a>02514             <span class="keywordflow">case</span> <span class="stringliteral">&#39;MONARCH&#39;</span>:
<a name="l02515"></a>02515             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EXECUTIVE&#39;</span>: {$pf = array(  522.000,  756.000); <span class="keywordflow">break</span>;}
<a name="l02516"></a>02516             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ORGANIZERL&#39;</span>:
<a name="l02517"></a>02517             <span class="keywordflow">case</span> <span class="stringliteral">&#39;STATEMENT&#39;</span>:
<a name="l02518"></a>02518             <span class="keywordflow">case</span> <span class="stringliteral">&#39;MEMO&#39;</span>: {$pf = array(  396.000,  612.000); <span class="keywordflow">break</span>;}
<a name="l02519"></a>02519             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FOOLSCAP&#39;</span>: {$pf = array(  595.440,  936.000); <span class="keywordflow">break</span>;}
<a name="l02520"></a>02520             <span class="keywordflow">case</span> <span class="stringliteral">&#39;COMPACT&#39;</span>: {$pf = array(  306.000,  486.000); <span class="keywordflow">break</span>;}
<a name="l02521"></a>02521             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ORGANIZERJ&#39;</span>: {$pf = array(  198.000,  360.000); <span class="keywordflow">break</span>;}
<a name="l02522"></a>02522             <span class="comment">// Canadian standard CAN 2-9.60M</span>
<a name="l02523"></a>02523             <span class="keywordflow">case</span> <span class="stringliteral">&#39;P1&#39;</span>: {$pf = array( 1587.402, 2437.795); <span class="keywordflow">break</span>;}
<a name="l02524"></a>02524             <span class="keywordflow">case</span> <span class="stringliteral">&#39;P2&#39;</span>: {$pf = array( 1218.898, 1587.402); <span class="keywordflow">break</span>;}
<a name="l02525"></a>02525             <span class="keywordflow">case</span> <span class="stringliteral">&#39;P3&#39;</span>: {$pf = array(  793.701, 1218.898); <span class="keywordflow">break</span>;}
<a name="l02526"></a>02526             <span class="keywordflow">case</span> <span class="stringliteral">&#39;P4&#39;</span>: {$pf = array(  609.449,  793.701); <span class="keywordflow">break</span>;}
<a name="l02527"></a>02527             <span class="keywordflow">case</span> <span class="stringliteral">&#39;P5&#39;</span>: {$pf = array(  396.850,  609.449); <span class="keywordflow">break</span>;}
<a name="l02528"></a>02528             <span class="keywordflow">case</span> <span class="stringliteral">&#39;P6&#39;</span>: {$pf = array(  303.307,  396.850); <span class="keywordflow">break</span>;}
<a name="l02529"></a>02529             <span class="comment">// North American Architectural Sizes</span>
<a name="l02530"></a>02530             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ARCH_E&#39;</span> : {$pf = array( 2592.000, 3456.000); <span class="keywordflow">break</span>;}
<a name="l02531"></a>02531             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ARCH_E1&#39;</span>: {$pf = array( 2160.000, 3024.000); <span class="keywordflow">break</span>;}
<a name="l02532"></a>02532             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ARCH_D&#39;</span> : {$pf = array( 1728.000, 2592.000); <span class="keywordflow">break</span>;}
<a name="l02533"></a>02533             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BROADSHEET&#39;</span>:
<a name="l02534"></a>02534             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ARCH_C&#39;</span> : {$pf = array( 1296.000, 1728.000); <span class="keywordflow">break</span>;}
<a name="l02535"></a>02535             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ARCH_B&#39;</span> : {$pf = array(  864.000, 1296.000); <span class="keywordflow">break</span>;}
<a name="l02536"></a>02536             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ARCH_A&#39;</span> : {$pf = array(  648.000,  864.000); <span class="keywordflow">break</span>;}
<a name="l02537"></a>02537             <span class="comment">// --- North American Envelope Sizes ---</span>
<a name="l02538"></a>02538             <span class="comment">//   - Announcement Envelopes</span>
<a name="l02539"></a>02539             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANNENV_A2&#39;</span>  : {$pf = array(  314.640,  414.000); <span class="keywordflow">break</span>;}
<a name="l02540"></a>02540             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANNENV_A6&#39;</span>  : {$pf = array(  342.000,  468.000); <span class="keywordflow">break</span>;}
<a name="l02541"></a>02541             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANNENV_A7&#39;</span>  : {$pf = array(  378.000,  522.000); <span class="keywordflow">break</span>;}
<a name="l02542"></a>02542             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANNENV_A8&#39;</span>  : {$pf = array(  396.000,  584.640); <span class="keywordflow">break</span>;}
<a name="l02543"></a>02543             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANNENV_A10&#39;</span> : {$pf = array(  450.000,  692.640); <span class="keywordflow">break</span>;}
<a name="l02544"></a>02544             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ANNENV_SLIM&#39;</span>: {$pf = array(  278.640,  638.640); <span class="keywordflow">break</span>;}
<a name="l02545"></a>02545             <span class="comment">//   - Commercial Envelopes</span>
<a name="l02546"></a>02546             <span class="keywordflow">case</span> <span class="stringliteral">&#39;COMMENV_N6_1/4&#39;</span>: {$pf = array(  252.000,  432.000); <span class="keywordflow">break</span>;}
<a name="l02547"></a>02547             <span class="keywordflow">case</span> <span class="stringliteral">&#39;COMMENV_N6_3/4&#39;</span>: {$pf = array(  260.640,  468.000); <span class="keywordflow">break</span>;}
<a name="l02548"></a>02548             <span class="keywordflow">case</span> <span class="stringliteral">&#39;COMMENV_N8&#39;</span>    : {$pf = array(  278.640,  540.000); <span class="keywordflow">break</span>;}
<a name="l02549"></a>02549             <span class="keywordflow">case</span> <span class="stringliteral">&#39;COMMENV_N9&#39;</span>    : {$pf = array(  278.640,  638.640); <span class="keywordflow">break</span>;}
<a name="l02550"></a>02550             <span class="keywordflow">case</span> <span class="stringliteral">&#39;COMMENV_N10&#39;</span>   : {$pf = array(  296.640,  684.000); <span class="keywordflow">break</span>;}
<a name="l02551"></a>02551             <span class="keywordflow">case</span> <span class="stringliteral">&#39;COMMENV_N11&#39;</span>   : {$pf = array(  324.000,  746.640); <span class="keywordflow">break</span>;}
<a name="l02552"></a>02552             <span class="keywordflow">case</span> <span class="stringliteral">&#39;COMMENV_N12&#39;</span>   : {$pf = array(  342.000,  792.000); <span class="keywordflow">break</span>;}
<a name="l02553"></a>02553             <span class="keywordflow">case</span> <span class="stringliteral">&#39;COMMENV_N14&#39;</span>   : {$pf = array(  360.000,  828.000); <span class="keywordflow">break</span>;}
<a name="l02554"></a>02554             <span class="comment">//   - Catalogue Envelopes</span>
<a name="l02555"></a>02555             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N1&#39;</span>     : {$pf = array(  432.000,  648.000); <span class="keywordflow">break</span>;}
<a name="l02556"></a>02556             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N1_3/4&#39;</span> : {$pf = array(  468.000,  684.000); <span class="keywordflow">break</span>;}
<a name="l02557"></a>02557             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N2&#39;</span>     : {$pf = array(  468.000,  720.000); <span class="keywordflow">break</span>;}
<a name="l02558"></a>02558             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N3&#39;</span>     : {$pf = array(  504.000,  720.000); <span class="keywordflow">break</span>;}
<a name="l02559"></a>02559             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N6&#39;</span>     : {$pf = array(  540.000,  756.000); <span class="keywordflow">break</span>;}
<a name="l02560"></a>02560             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N7&#39;</span>     : {$pf = array(  576.000,  792.000); <span class="keywordflow">break</span>;}
<a name="l02561"></a>02561             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N8&#39;</span>     : {$pf = array(  594.000,  810.000); <span class="keywordflow">break</span>;}
<a name="l02562"></a>02562             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N9_1/2&#39;</span> : {$pf = array(  612.000,  756.000); <span class="keywordflow">break</span>;}
<a name="l02563"></a>02563             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N9_3/4&#39;</span> : {$pf = array(  630.000,  810.000); <span class="keywordflow">break</span>;}
<a name="l02564"></a>02564             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N10_1/2&#39;</span>: {$pf = array(  648.000,  864.000); <span class="keywordflow">break</span>;}
<a name="l02565"></a>02565             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N12_1/2&#39;</span>: {$pf = array(  684.000,  900.000); <span class="keywordflow">break</span>;}
<a name="l02566"></a>02566             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N13_1/2&#39;</span>: {$pf = array(  720.000,  936.000); <span class="keywordflow">break</span>;}
<a name="l02567"></a>02567             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N14_1/4&#39;</span>: {$pf = array(  810.000,  882.000); <span class="keywordflow">break</span>;}
<a name="l02568"></a>02568             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CATENV_N14_1/2&#39;</span>: {$pf = array(  828.000, 1044.000); <span class="keywordflow">break</span>;}
<a name="l02569"></a>02569             <span class="comment">// Japanese (JIS P 0138-61) Standard B-Series</span>
<a name="l02570"></a>02570             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B0&#39;</span> : {$pf = array( 2919.685, 4127.244); <span class="keywordflow">break</span>;}
<a name="l02571"></a>02571             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B1&#39;</span> : {$pf = array( 2063.622, 2919.685); <span class="keywordflow">break</span>;}
<a name="l02572"></a>02572             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B2&#39;</span> : {$pf = array( 1459.843, 2063.622); <span class="keywordflow">break</span>;}
<a name="l02573"></a>02573             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B3&#39;</span> : {$pf = array( 1031.811, 1459.843); <span class="keywordflow">break</span>;}
<a name="l02574"></a>02574             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B4&#39;</span> : {$pf = array(  728.504, 1031.811); <span class="keywordflow">break</span>;}
<a name="l02575"></a>02575             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B5&#39;</span> : {$pf = array(  515.906,  728.504); <span class="keywordflow">break</span>;}
<a name="l02576"></a>02576             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B6&#39;</span> : {$pf = array(  362.835,  515.906); <span class="keywordflow">break</span>;}
<a name="l02577"></a>02577             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B7&#39;</span> : {$pf = array(  257.953,  362.835); <span class="keywordflow">break</span>;}
<a name="l02578"></a>02578             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B8&#39;</span> : {$pf = array(  181.417,  257.953); <span class="keywordflow">break</span>;}
<a name="l02579"></a>02579             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B9&#39;</span> : {$pf = array(  127.559,  181.417); <span class="keywordflow">break</span>;}
<a name="l02580"></a>02580             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B10&#39;</span>: {$pf = array(   90.709,  127.559); <span class="keywordflow">break</span>;}
<a name="l02581"></a>02581             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B11&#39;</span>: {$pf = array(   62.362,   90.709); <span class="keywordflow">break</span>;}
<a name="l02582"></a>02582             <span class="keywordflow">case</span> <span class="stringliteral">&#39;JIS_B12&#39;</span>: {$pf = array(   45.354,   62.362); <span class="keywordflow">break</span>;}
<a name="l02583"></a>02583             <span class="comment">// PA Series</span>
<a name="l02584"></a>02584             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA0&#39;</span> : {$pf = array( 2381.102, 3174.803,); <span class="keywordflow">break</span>;}
<a name="l02585"></a>02585             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA1&#39;</span> : {$pf = array( 1587.402, 2381.102); <span class="keywordflow">break</span>;}
<a name="l02586"></a>02586             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA2&#39;</span> : {$pf = array( 1190.551, 1587.402); <span class="keywordflow">break</span>;}
<a name="l02587"></a>02587             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA3&#39;</span> : {$pf = array(  793.701, 1190.551); <span class="keywordflow">break</span>;}
<a name="l02588"></a>02588             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA4&#39;</span> : {$pf = array(  595.276,  793.701); <span class="keywordflow">break</span>;}
<a name="l02589"></a>02589             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA5&#39;</span> : {$pf = array(  396.850,  595.276); <span class="keywordflow">break</span>;}
<a name="l02590"></a>02590             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA6&#39;</span> : {$pf = array(  297.638,  396.850); <span class="keywordflow">break</span>;}
<a name="l02591"></a>02591             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA7&#39;</span> : {$pf = array(  198.425,  297.638); <span class="keywordflow">break</span>;}
<a name="l02592"></a>02592             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA8&#39;</span> : {$pf = array(  147.402,  198.425); <span class="keywordflow">break</span>;}
<a name="l02593"></a>02593             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA9&#39;</span> : {$pf = array(   99.213,  147.402); <span class="keywordflow">break</span>;}
<a name="l02594"></a>02594             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PA10&#39;</span>: {$pf = array(   73.701,   99.213); <span class="keywordflow">break</span>;}
<a name="l02595"></a>02595             <span class="comment">// Standard Photographic Print Sizes</span>
<a name="l02596"></a>02596             <span class="keywordflow">case</span> <span class="stringliteral">&#39;PASSPORT_PHOTO&#39;</span>: {$pf = array(   99.213,  127.559); <span class="keywordflow">break</span>;}
<a name="l02597"></a>02597             <span class="keywordflow">case</span> <span class="charliteral">&#39;E&#39;</span>   : {$pf = array(  233.858,  340.157); <span class="keywordflow">break</span>;}
<a name="l02598"></a>02598             <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:
<a name="l02599"></a>02599             <span class="keywordflow">case</span> <span class="stringliteral">&#39;3R&#39;</span>  : {$pf = array(  252.283,  360.000); <span class="keywordflow">break</span>;}
<a name="l02600"></a>02600             <span class="keywordflow">case</span> <span class="stringliteral">&#39;KG&#39;</span>:
<a name="l02601"></a>02601             <span class="keywordflow">case</span> <span class="stringliteral">&#39;4R&#39;</span>  : {$pf = array(  289.134,  430.866); <span class="keywordflow">break</span>;}
<a name="l02602"></a>02602             <span class="keywordflow">case</span> <span class="stringliteral">&#39;4D&#39;</span>  : {$pf = array(  340.157,  430.866); <span class="keywordflow">break</span>;}
<a name="l02603"></a>02603             <span class="keywordflow">case</span> <span class="stringliteral">&#39;2L&#39;</span>:
<a name="l02604"></a>02604             <span class="keywordflow">case</span> <span class="stringliteral">&#39;5R&#39;</span>  : {$pf = array(  360.000,  504.567); <span class="keywordflow">break</span>;}
<a name="l02605"></a>02605             <span class="keywordflow">case</span> <span class="stringliteral">&#39;8P&#39;</span>:
<a name="l02606"></a>02606             <span class="keywordflow">case</span> <span class="stringliteral">&#39;6R&#39;</span>  : {$pf = array(  430.866,  575.433); <span class="keywordflow">break</span>;}
<a name="l02607"></a>02607             <span class="keywordflow">case</span> <span class="stringliteral">&#39;6P&#39;</span>:
<a name="l02608"></a>02608             <span class="keywordflow">case</span> <span class="stringliteral">&#39;8R&#39;</span>  : {$pf = array(  575.433,  720.000); <span class="keywordflow">break</span>;}
<a name="l02609"></a>02609             <span class="keywordflow">case</span> <span class="stringliteral">&#39;6PW&#39;</span>:
<a name="l02610"></a>02610             <span class="keywordflow">case</span> <span class="stringliteral">&#39;S8R&#39;</span> : {$pf = array(  575.433,  864.567); <span class="keywordflow">break</span>;}
<a name="l02611"></a>02611             <span class="keywordflow">case</span> <span class="stringliteral">&#39;4P&#39;</span>:
<a name="l02612"></a>02612             <span class="keywordflow">case</span> <span class="stringliteral">&#39;10R&#39;</span> : {$pf = array(  720.000,  864.567); <span class="keywordflow">break</span>;}
<a name="l02613"></a>02613             <span class="keywordflow">case</span> <span class="stringliteral">&#39;4PW&#39;</span>:
<a name="l02614"></a>02614             <span class="keywordflow">case</span> <span class="stringliteral">&#39;S10R&#39;</span>: {$pf = array(  720.000, 1080.000); <span class="keywordflow">break</span>;}
<a name="l02615"></a>02615             <span class="keywordflow">case</span> <span class="stringliteral">&#39;11R&#39;</span> : {$pf = array(  790.866, 1009.134); <span class="keywordflow">break</span>;}
<a name="l02616"></a>02616             <span class="keywordflow">case</span> <span class="stringliteral">&#39;S11R&#39;</span>: {$pf = array(  790.866, 1224.567); <span class="keywordflow">break</span>;}
<a name="l02617"></a>02617             <span class="keywordflow">case</span> <span class="stringliteral">&#39;12R&#39;</span> : {$pf = array(  864.567, 1080.000); <span class="keywordflow">break</span>;}
<a name="l02618"></a>02618             <span class="keywordflow">case</span> <span class="stringliteral">&#39;S12R&#39;</span>: {$pf = array(  864.567, 1292.598); <span class="keywordflow">break</span>;}
<a name="l02619"></a>02619             <span class="comment">// Common Newspaper Sizes</span>
<a name="l02620"></a>02620             <span class="keywordflow">case</span> <span class="stringliteral">&#39;NEWSPAPER_BROADSHEET&#39;</span>: {$pf = array( 2125.984, 1700.787); <span class="keywordflow">break</span>;}
<a name="l02621"></a>02621             <span class="keywordflow">case</span> <span class="stringliteral">&#39;NEWSPAPER_BERLINER&#39;</span>  : {$pf = array( 1332.283,  892.913); <span class="keywordflow">break</span>;}
<a name="l02622"></a>02622             <span class="keywordflow">case</span> <span class="stringliteral">&#39;NEWSPAPER_TABLOID&#39;</span>:
<a name="l02623"></a>02623             <span class="keywordflow">case</span> <span class="stringliteral">&#39;NEWSPAPER_COMPACT&#39;</span>   : {$pf = array( 1218.898,  793.701); <span class="keywordflow">break</span>;}
<a name="l02624"></a>02624             <span class="comment">// Business Cards</span>
<a name="l02625"></a>02625             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CREDIT_CARD&#39;</span>:
<a name="l02626"></a>02626             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD&#39;</span>:
<a name="l02627"></a>02627             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_ISO7810&#39;</span>: {$pf = array(  153.014,  242.646); <span class="keywordflow">break</span>;}
<a name="l02628"></a>02628             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_ISO216&#39;</span> : {$pf = array(  147.402,  209.764); <span class="keywordflow">break</span>;}
<a name="l02629"></a>02629             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_IT&#39;</span>:
<a name="l02630"></a>02630             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_UK&#39;</span>:
<a name="l02631"></a>02631             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_FR&#39;</span>:
<a name="l02632"></a>02632             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_DE&#39;</span>:
<a name="l02633"></a>02633             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_ES&#39;</span>     : {$pf = array(  155.906,  240.945); <span class="keywordflow">break</span>;}
<a name="l02634"></a>02634             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_CA&#39;</span>:
<a name="l02635"></a>02635             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_US&#39;</span>     : {$pf = array(  144.567,  252.283); <span class="keywordflow">break</span>;}
<a name="l02636"></a>02636             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_JP&#39;</span>     : {$pf = array(  155.906,  257.953); <span class="keywordflow">break</span>;}
<a name="l02637"></a>02637             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_HK&#39;</span>     : {$pf = array(  153.071,  255.118); <span class="keywordflow">break</span>;}
<a name="l02638"></a>02638             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_AU&#39;</span>:
<a name="l02639"></a>02639             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_DK&#39;</span>:
<a name="l02640"></a>02640             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_SE&#39;</span>     : {$pf = array(  155.906,  255.118); <span class="keywordflow">break</span>;}
<a name="l02641"></a>02641             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_RU&#39;</span>:
<a name="l02642"></a>02642             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_CZ&#39;</span>:
<a name="l02643"></a>02643             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_FI&#39;</span>:
<a name="l02644"></a>02644             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_HU&#39;</span>:
<a name="l02645"></a>02645             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BUSINESS_CARD_IL&#39;</span>     : {$pf = array(  141.732,  255.118); <span class="keywordflow">break</span>;}
<a name="l02646"></a>02646             <span class="comment">// Billboards</span>
<a name="l02647"></a>02647             <span class="keywordflow">case</span> <span class="stringliteral">&#39;4SHEET&#39;</span> : {$pf = array( 2880.000, 4320.000); <span class="keywordflow">break</span>;}
<a name="l02648"></a>02648             <span class="keywordflow">case</span> <span class="stringliteral">&#39;6SHEET&#39;</span> : {$pf = array( 3401.575, 5102.362); <span class="keywordflow">break</span>;}
<a name="l02649"></a>02649             <span class="keywordflow">case</span> <span class="stringliteral">&#39;12SHEET&#39;</span>: {$pf = array( 8640.000, 4320.000); <span class="keywordflow">break</span>;}
<a name="l02650"></a>02650             <span class="keywordflow">case</span> <span class="stringliteral">&#39;16SHEET&#39;</span>: {$pf = array( 5760.000, 8640.000); <span class="keywordflow">break</span>;}
<a name="l02651"></a>02651             <span class="keywordflow">case</span> <span class="stringliteral">&#39;32SHEET&#39;</span>: {$pf = array(11520.000, 8640.000); <span class="keywordflow">break</span>;}
<a name="l02652"></a>02652             <span class="keywordflow">case</span> <span class="stringliteral">&#39;48SHEET&#39;</span>: {$pf = array(17280.000, 8640.000); <span class="keywordflow">break</span>;}
<a name="l02653"></a>02653             <span class="keywordflow">case</span> <span class="stringliteral">&#39;64SHEET&#39;</span>: {$pf = array(23040.000, 8640.000); <span class="keywordflow">break</span>;}
<a name="l02654"></a>02654             <span class="keywordflow">case</span> <span class="stringliteral">&#39;96SHEET&#39;</span>: {$pf = array(34560.000, 8640.000); <span class="keywordflow">break</span>;}
<a name="l02655"></a>02655             <span class="comment">// Old European Sizes</span>
<a name="l02656"></a>02656             <span class="comment">//   - Old Imperial English Sizes</span>
<a name="l02657"></a>02657             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_EMPEROR&#39;</span>          : {$pf = array( 3456.000, 5184.000); <span class="keywordflow">break</span>;}
<a name="l02658"></a>02658             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_ANTIQUARIAN&#39;</span>      : {$pf = array( 2232.000, 3816.000); <span class="keywordflow">break</span>;}
<a name="l02659"></a>02659             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_GRAND_EAGLE&#39;</span>      : {$pf = array( 2070.000, 3024.000); <span class="keywordflow">break</span>;}
<a name="l02660"></a>02660             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_DOUBLE_ELEPHANT&#39;</span>  : {$pf = array( 1926.000, 2880.000); <span class="keywordflow">break</span>;}
<a name="l02661"></a>02661             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_ATLAS&#39;</span>            : {$pf = array( 1872.000, 2448.000); <span class="keywordflow">break</span>;}
<a name="l02662"></a>02662             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_COLOMBIER&#39;</span>        : {$pf = array( 1692.000, 2484.000); <span class="keywordflow">break</span>;}
<a name="l02663"></a>02663             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_ELEPHANT&#39;</span>         : {$pf = array( 1656.000, 2016.000); <span class="keywordflow">break</span>;}
<a name="l02664"></a>02664             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_DOUBLE_DEMY&#39;</span>      : {$pf = array( 1620.000, 2556.000); <span class="keywordflow">break</span>;}
<a name="l02665"></a>02665             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_IMPERIAL&#39;</span>         : {$pf = array( 1584.000, 2160.000); <span class="keywordflow">break</span>;}
<a name="l02666"></a>02666             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_PRINCESS&#39;</span>         : {$pf = array( 1548.000, 2016.000); <span class="keywordflow">break</span>;}
<a name="l02667"></a>02667             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_CARTRIDGE&#39;</span>        : {$pf = array( 1512.000, 1872.000); <span class="keywordflow">break</span>;}
<a name="l02668"></a>02668             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_DOUBLE_LARGE_POST&#39;</span>: {$pf = array( 1512.000, 2376.000); <span class="keywordflow">break</span>;}
<a name="l02669"></a>02669             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_ROYAL&#39;</span>            : {$pf = array( 1440.000, 1800.000); <span class="keywordflow">break</span>;}
<a name="l02670"></a>02670             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_SHEET&#39;</span>:
<a name="l02671"></a>02671             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_HALF_POST&#39;</span>        : {$pf = array( 1404.000, 1692.000); <span class="keywordflow">break</span>;}
<a name="l02672"></a>02672             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_SUPER_ROYAL&#39;</span>      : {$pf = array( 1368.000, 1944.000); <span class="keywordflow">break</span>;}
<a name="l02673"></a>02673             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_DOUBLE_POST&#39;</span>      : {$pf = array( 1368.000, 2196.000); <span class="keywordflow">break</span>;}
<a name="l02674"></a>02674             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_MEDIUM&#39;</span>           : {$pf = array( 1260.000, 1656.000); <span class="keywordflow">break</span>;}
<a name="l02675"></a>02675             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_DEMY&#39;</span>             : {$pf = array( 1260.000, 1620.000); <span class="keywordflow">break</span>;}
<a name="l02676"></a>02676             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_LARGE_POST&#39;</span>       : {$pf = array( 1188.000, 1512.000); <span class="keywordflow">break</span>;}
<a name="l02677"></a>02677             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_COPY_DRAUGHT&#39;</span>     : {$pf = array( 1152.000, 1440.000); <span class="keywordflow">break</span>;}
<a name="l02678"></a>02678             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_POST&#39;</span>             : {$pf = array( 1116.000, 1386.000); <span class="keywordflow">break</span>;}
<a name="l02679"></a>02679             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_CROWN&#39;</span>            : {$pf = array( 1080.000, 1440.000); <span class="keywordflow">break</span>;}
<a name="l02680"></a>02680             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_PINCHED_POST&#39;</span>     : {$pf = array( 1062.000, 1332.000); <span class="keywordflow">break</span>;}
<a name="l02681"></a>02681             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_BRIEF&#39;</span>            : {$pf = array(  972.000, 1152.000); <span class="keywordflow">break</span>;}
<a name="l02682"></a>02682             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_FOOLSCAP&#39;</span>         : {$pf = array(  972.000, 1224.000); <span class="keywordflow">break</span>;}
<a name="l02683"></a>02683             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_SMALL_FOOLSCAP&#39;</span>   : {$pf = array(  954.000, 1188.000); <span class="keywordflow">break</span>;}
<a name="l02684"></a>02684             <span class="keywordflow">case</span> <span class="stringliteral">&#39;EN_POTT&#39;</span>             : {$pf = array(  900.000, 1080.000); <span class="keywordflow">break</span>;}
<a name="l02685"></a>02685             <span class="comment">//   - Old Imperial Belgian Sizes</span>
<a name="l02686"></a>02686             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_GRAND_AIGLE&#39;</span> : {$pf = array( 1984.252, 2948.031); <span class="keywordflow">break</span>;}
<a name="l02687"></a>02687             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_COLOMBIER&#39;</span>   : {$pf = array( 1757.480, 2409.449); <span class="keywordflow">break</span>;}
<a name="l02688"></a>02688             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_DOUBLE_CARRE&#39;</span>: {$pf = array( 1757.480, 2607.874); <span class="keywordflow">break</span>;}
<a name="l02689"></a>02689             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_ELEPHANT&#39;</span>    : {$pf = array( 1746.142, 2182.677); <span class="keywordflow">break</span>;}
<a name="l02690"></a>02690             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_PETIT_AIGLE&#39;</span> : {$pf = array( 1700.787, 2381.102); <span class="keywordflow">break</span>;}
<a name="l02691"></a>02691             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_GRAND_JESUS&#39;</span> : {$pf = array( 1559.055, 2069.291); <span class="keywordflow">break</span>;}
<a name="l02692"></a>02692             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_JESUS&#39;</span>       : {$pf = array( 1530.709, 2069.291); <span class="keywordflow">break</span>;}
<a name="l02693"></a>02693             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_RAISIN&#39;</span>      : {$pf = array( 1417.323, 1842.520); <span class="keywordflow">break</span>;}
<a name="l02694"></a>02694             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_GRAND_MEDIAN&#39;</span>: {$pf = array( 1303.937, 1714.961); <span class="keywordflow">break</span>;}
<a name="l02695"></a>02695             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_DOUBLE_POSTE&#39;</span>: {$pf = array( 1233.071, 1601.575); <span class="keywordflow">break</span>;}
<a name="l02696"></a>02696             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_COQUILLE&#39;</span>    : {$pf = array( 1218.898, 1587.402); <span class="keywordflow">break</span>;}
<a name="l02697"></a>02697             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_PETIT_MEDIAN&#39;</span>: {$pf = array( 1176.378, 1502.362); <span class="keywordflow">break</span>;}
<a name="l02698"></a>02698             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_RUCHE&#39;</span>       : {$pf = array( 1020.472, 1303.937); <span class="keywordflow">break</span>;}
<a name="l02699"></a>02699             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_PROPATRIA&#39;</span>   : {$pf = array(  977.953, 1218.898); <span class="keywordflow">break</span>;}
<a name="l02700"></a>02700             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_LYS&#39;</span>         : {$pf = array(  898.583, 1125.354); <span class="keywordflow">break</span>;}
<a name="l02701"></a>02701             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_POT&#39;</span>         : {$pf = array(  870.236, 1088.504); <span class="keywordflow">break</span>;}
<a name="l02702"></a>02702             <span class="keywordflow">case</span> <span class="stringliteral">&#39;BE_ROSETTE&#39;</span>     : {$pf = array(  765.354,  983.622); <span class="keywordflow">break</span>;}
<a name="l02703"></a>02703             <span class="comment">//   - Old Imperial French Sizes</span>
<a name="l02704"></a>02704             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_UNIVERS&#39;</span>          : {$pf = array( 2834.646, 3685.039); <span class="keywordflow">break</span>;}
<a name="l02705"></a>02705             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_COLOMBIER&#39;</span> : {$pf = array( 2551.181, 3571.654); <span class="keywordflow">break</span>;}
<a name="l02706"></a>02706             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_GRANDE_MONDE&#39;</span>     : {$pf = array( 2551.181, 3571.654); <span class="keywordflow">break</span>;}
<a name="l02707"></a>02707             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_SOLEIL&#39;</span>    : {$pf = array( 2267.717, 3401.575); <span class="keywordflow">break</span>;}
<a name="l02708"></a>02708             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_JESUS&#39;</span>     : {$pf = array( 2154.331, 3174.803); <span class="keywordflow">break</span>;}
<a name="l02709"></a>02709             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_GRAND_AIGLE&#39;</span>      : {$pf = array( 2125.984, 3004.724); <span class="keywordflow">break</span>;}
<a name="l02710"></a>02710             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_PETIT_AIGLE&#39;</span>      : {$pf = array( 1984.252, 2664.567); <span class="keywordflow">break</span>;}
<a name="l02711"></a>02711             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_RAISIN&#39;</span>    : {$pf = array( 1842.520, 2834.646); <span class="keywordflow">break</span>;}
<a name="l02712"></a>02712             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_JOURNAL&#39;</span>          : {$pf = array( 1842.520, 2664.567); <span class="keywordflow">break</span>;}
<a name="l02713"></a>02713             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_COLOMBIER_AFFICHE&#39;</span>: {$pf = array( 1785.827, 2551.181); <span class="keywordflow">break</span>;}
<a name="l02714"></a>02714             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_CAVALIER&#39;</span>  : {$pf = array( 1757.480, 2607.874); <span class="keywordflow">break</span>;}
<a name="l02715"></a>02715             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_CLOCHE&#39;</span>           : {$pf = array( 1700.787, 2267.717); <span class="keywordflow">break</span>;}
<a name="l02716"></a>02716             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_SOLEIL&#39;</span>           : {$pf = array( 1700.787, 2267.717); <span class="keywordflow">break</span>;}
<a name="l02717"></a>02717             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_CARRE&#39;</span>     : {$pf = array( 1587.402, 2551.181); <span class="keywordflow">break</span>;}
<a name="l02718"></a>02718             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_COQUILLE&#39;</span>  : {$pf = array( 1587.402, 2494.488); <span class="keywordflow">break</span>;}
<a name="l02719"></a>02719             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_JESUS&#39;</span>            : {$pf = array( 1587.402, 2154.331); <span class="keywordflow">break</span>;}
<a name="l02720"></a>02720             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_RAISIN&#39;</span>           : {$pf = array( 1417.323, 1842.520); <span class="keywordflow">break</span>;}
<a name="l02721"></a>02721             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_CAVALIER&#39;</span>         : {$pf = array( 1303.937, 1757.480); <span class="keywordflow">break</span>;}
<a name="l02722"></a>02722             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_COURONNE&#39;</span>  : {$pf = array( 1303.937, 2040.945); <span class="keywordflow">break</span>;}
<a name="l02723"></a>02723             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_CARRE&#39;</span>            : {$pf = array( 1275.591, 1587.402); <span class="keywordflow">break</span>;}
<a name="l02724"></a>02724             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_COQUILLE&#39;</span>         : {$pf = array( 1247.244, 1587.402); <span class="keywordflow">break</span>;}
<a name="l02725"></a>02725             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_TELLIERE&#39;</span>  : {$pf = array( 1247.244, 1927.559); <span class="keywordflow">break</span>;}
<a name="l02726"></a>02726             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_CLOCHE&#39;</span>    : {$pf = array( 1133.858, 1700.787); <span class="keywordflow">break</span>;}
<a name="l02727"></a>02727             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_DOUBLE_POT&#39;</span>       : {$pf = array( 1133.858, 1757.480); <span class="keywordflow">break</span>;}
<a name="l02728"></a>02728             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_ECU&#39;</span>              : {$pf = array( 1133.858, 1474.016); <span class="keywordflow">break</span>;}
<a name="l02729"></a>02729             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_COURONNE&#39;</span>         : {$pf = array( 1020.472, 1303.937); <span class="keywordflow">break</span>;}
<a name="l02730"></a>02730             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_TELLIERE&#39;</span>         : {$pf = array(  963.780, 1247.244); <span class="keywordflow">break</span>;}
<a name="l02731"></a>02731             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FR_POT&#39;</span>              : {$pf = array(  878.740, 1133.858); <span class="keywordflow">break</span>;}
<a name="l02732"></a>02732             <span class="comment">// DEFAULT ISO A4</span>
<a name="l02733"></a>02733             <span class="keywordflow">default</span>: {$pf = array(  595.276,  841.890); <span class="keywordflow">break</span>;}
<a name="l02734"></a>02734         }
<a name="l02735"></a>02735         <span class="keywordflow">return</span> $pf;
<a name="l02736"></a>02736     }
<a name="l02737"></a>02737 <span class="comment"></span>
<a name="l02738"></a>02738 <span class="comment">    /**</span>
<a name="l02739"></a>02739 <span class="comment">     * Change the format of the current page</span>
<a name="l02740"></a>02740 <span class="comment">     * @param $format (mixed) The format used for pages. It can be either: one of the string values specified at getPageSizeFromFormat() documentation or an array of two numners (width, height) or an array containing the following measures and options:&lt;ul&gt;</span>
<a name="l02741"></a>02741 <span class="comment">     * &lt;li&gt;[&#39;format&#39;] = page format name (one of the above);&lt;/li&gt;</span>
<a name="l02742"></a>02742 <span class="comment">     * &lt;li&gt;[&#39;Rotate&#39;] : The number of degrees by which the page shall be rotated clockwise when displayed or printed. The value shall be a multiple of 90.&lt;/li&gt;</span>
<a name="l02743"></a>02743 <span class="comment">     * &lt;li&gt;[&#39;PZ&#39;] : The page&#39;s preferred zoom (magnification) factor.&lt;/li&gt;</span>
<a name="l02744"></a>02744 <span class="comment">     * &lt;li&gt;[&#39;MediaBox&#39;] : the boundaries of the physical medium on which the page shall be displayed or printed:&lt;/li&gt;</span>
<a name="l02745"></a>02745 <span class="comment">     * &lt;li&gt;[&#39;MediaBox&#39;][&#39;llx&#39;] : lower-left x coordinate in points&lt;/li&gt;</span>
<a name="l02746"></a>02746 <span class="comment">     * &lt;li&gt;[&#39;MediaBox&#39;][&#39;lly&#39;] : lower-left y coordinate in points&lt;/li&gt;</span>
<a name="l02747"></a>02747 <span class="comment">     * &lt;li&gt;[&#39;MediaBox&#39;][&#39;urx&#39;] : upper-right x coordinate in points&lt;/li&gt;</span>
<a name="l02748"></a>02748 <span class="comment">     * &lt;li&gt;[&#39;MediaBox&#39;][&#39;ury&#39;] : upper-right y coordinate in points&lt;/li&gt;</span>
<a name="l02749"></a>02749 <span class="comment">     * &lt;li&gt;[&#39;CropBox&#39;] : the visible region of default user space:&lt;/li&gt;</span>
<a name="l02750"></a>02750 <span class="comment">     * &lt;li&gt;[&#39;CropBox&#39;][&#39;llx&#39;] : lower-left x coordinate in points&lt;/li&gt;</span>
<a name="l02751"></a>02751 <span class="comment">     * &lt;li&gt;[&#39;CropBox&#39;][&#39;lly&#39;] : lower-left y coordinate in points&lt;/li&gt;</span>
<a name="l02752"></a>02752 <span class="comment">     * &lt;li&gt;[&#39;CropBox&#39;][&#39;urx&#39;] : upper-right x coordinate in points&lt;/li&gt;</span>
<a name="l02753"></a>02753 <span class="comment">     * &lt;li&gt;[&#39;CropBox&#39;][&#39;ury&#39;] : upper-right y coordinate in points&lt;/li&gt;</span>
<a name="l02754"></a>02754 <span class="comment">     * &lt;li&gt;[&#39;BleedBox&#39;] : the region to which the contents of the page shall be clipped when output in a production environment:&lt;/li&gt;</span>
<a name="l02755"></a>02755 <span class="comment">     * &lt;li&gt;[&#39;BleedBox&#39;][&#39;llx&#39;] : lower-left x coordinate in points&lt;/li&gt;</span>
<a name="l02756"></a>02756 <span class="comment">     * &lt;li&gt;[&#39;BleedBox&#39;][&#39;lly&#39;] : lower-left y coordinate in points&lt;/li&gt;</span>
<a name="l02757"></a>02757 <span class="comment">     * &lt;li&gt;[&#39;BleedBox&#39;][&#39;urx&#39;] : upper-right x coordinate in points&lt;/li&gt;</span>
<a name="l02758"></a>02758 <span class="comment">     * &lt;li&gt;[&#39;BleedBox&#39;][&#39;ury&#39;] : upper-right y coordinate in points&lt;/li&gt;</span>
<a name="l02759"></a>02759 <span class="comment">     * &lt;li&gt;[&#39;TrimBox&#39;] : the intended dimensions of the finished page after trimming:&lt;/li&gt;</span>
<a name="l02760"></a>02760 <span class="comment">     * &lt;li&gt;[&#39;TrimBox&#39;][&#39;llx&#39;] : lower-left x coordinate in points&lt;/li&gt;</span>
<a name="l02761"></a>02761 <span class="comment">     * &lt;li&gt;[&#39;TrimBox&#39;][&#39;lly&#39;] : lower-left y coordinate in points&lt;/li&gt;</span>
<a name="l02762"></a>02762 <span class="comment">     * &lt;li&gt;[&#39;TrimBox&#39;][&#39;urx&#39;] : upper-right x coordinate in points&lt;/li&gt;</span>
<a name="l02763"></a>02763 <span class="comment">     * &lt;li&gt;[&#39;TrimBox&#39;][&#39;ury&#39;] : upper-right y coordinate in points&lt;/li&gt;</span>
<a name="l02764"></a>02764 <span class="comment">     * &lt;li&gt;[&#39;ArtBox&#39;] : the extent of the page&#39;s meaningful content:&lt;/li&gt;</span>
<a name="l02765"></a>02765 <span class="comment">     * &lt;li&gt;[&#39;ArtBox&#39;][&#39;llx&#39;] : lower-left x coordinate in points&lt;/li&gt;</span>
<a name="l02766"></a>02766 <span class="comment">     * &lt;li&gt;[&#39;ArtBox&#39;][&#39;lly&#39;] : lower-left y coordinate in points&lt;/li&gt;</span>
<a name="l02767"></a>02767 <span class="comment">     * &lt;li&gt;[&#39;ArtBox&#39;][&#39;urx&#39;] : upper-right x coordinate in points&lt;/li&gt;</span>
<a name="l02768"></a>02768 <span class="comment">     * &lt;li&gt;[&#39;ArtBox&#39;][&#39;ury&#39;] : upper-right y coordinate in points&lt;/li&gt;</span>
<a name="l02769"></a>02769 <span class="comment">     * &lt;li&gt;[&#39;BoxColorInfo&#39;] :specify the colours and other visual characteristics that should be used in displaying guidelines on the screen for each of the possible page boundaries other than the MediaBox:&lt;/li&gt;</span>
<a name="l02770"></a>02770 <span class="comment">     * &lt;li&gt;[&#39;BoxColorInfo&#39;][BOXTYPE][&#39;C&#39;] : an array of three numbers in the range 0-255, representing the components in the DeviceRGB colour space.&lt;/li&gt;</span>
<a name="l02771"></a>02771 <span class="comment">     * &lt;li&gt;[&#39;BoxColorInfo&#39;][BOXTYPE][&#39;W&#39;] : the guideline width in default user units&lt;/li&gt;</span>
<a name="l02772"></a>02772 <span class="comment">     * &lt;li&gt;[&#39;BoxColorInfo&#39;][BOXTYPE][&#39;S&#39;] : the guideline style: S = Solid; D = Dashed&lt;/li&gt;</span>
<a name="l02773"></a>02773 <span class="comment">     * &lt;li&gt;[&#39;BoxColorInfo&#39;][BOXTYPE][&#39;D&#39;] : dash array defining a pattern of dashes and gaps to be used in drawing dashed guidelines&lt;/li&gt;</span>
<a name="l02774"></a>02774 <span class="comment">     * &lt;li&gt;[&#39;trans&#39;] : the style and duration of the visual transition to use when moving from another page to the given page during a presentation&lt;/li&gt;</span>
<a name="l02775"></a>02775 <span class="comment">     * &lt;li&gt;[&#39;trans&#39;][&#39;Dur&#39;] : The page&#39;s display duration (also called its advance timing): the maximum length of time, in seconds, that the page shall be displayed during presentations before the viewer application shall automatically advance to the next page.&lt;/li&gt;</span>
<a name="l02776"></a>02776 <span class="comment">     * &lt;li&gt;[&#39;trans&#39;][&#39;S&#39;] : transition style : Split, Blinds, Box, Wipe, Dissolve, Glitter, R, Fly, Push, Cover, Uncover, Fade&lt;/li&gt;</span>
<a name="l02777"></a>02777 <span class="comment">     * &lt;li&gt;[&#39;trans&#39;][&#39;D&#39;] : The duration of the transition effect, in seconds.&lt;/li&gt;</span>
<a name="l02778"></a>02778 <span class="comment">     * &lt;li&gt;[&#39;trans&#39;][&#39;Dm&#39;] : (Split and Blinds transition styles only) The dimension in which the specified transition effect shall occur: H = Horizontal, V = Vertical. Default value: H.&lt;/li&gt;</span>
<a name="l02779"></a>02779 <span class="comment">     * &lt;li&gt;[&#39;trans&#39;][&#39;M&#39;] : (Split, Box and Fly transition styles only) The direction of motion for the specified transition effect: I = Inward from the edges of the page, O = Outward from the center of the pageDefault value: I.&lt;/li&gt;</span>
<a name="l02780"></a>02780 <span class="comment">     * &lt;li&gt;[&#39;trans&#39;][&#39;Di&#39;] : (Wipe, Glitter, Fly, Cover, Uncover and Push transition styles only) The direction in which the specified transition effect shall moves, expressed in degrees counterclockwise starting from a left-to-right direction. If the value is a number, it shall be one of: 0 = Left to right, 90 = Bottom to top (Wipe only), 180 = Right to left (Wipe only), 270 = Top to bottom, 315 = Top-left to bottom-right (Glitter only). If the value is a name, it shall be None, which is relevant only for the Fly transition when the value of SS is not 1.0. Default value: 0.&lt;/li&gt;</span>
<a name="l02781"></a>02781 <span class="comment">     * &lt;li&gt;[&#39;trans&#39;][&#39;SS&#39;] : (Fly transition style only) The starting or ending scale at which the changes shall be drawn. If M specifies an inward transition, the scale of the changes drawn shall progress from SS to 1.0 over the course of the transition. If M specifies an outward transition, the scale of the changes drawn shall progress from 1.0 to SS over the course of the transition. Default: 1.0.&lt;/li&gt;</span>
<a name="l02782"></a>02782 <span class="comment">     * &lt;li&gt;[&#39;trans&#39;][&#39;B&#39;] : (Fly transition style only) If true, the area that shall be flown in is rectangular and opaque. Default: false.&lt;/li&gt;</span>
<a name="l02783"></a>02783 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l02784"></a>02784 <span class="comment">     * @param $orientation (string) page orientation. Possible values are (case insensitive):&lt;ul&gt;</span>
<a name="l02785"></a>02785 <span class="comment">     * &lt;li&gt;P or Portrait (default)&lt;/li&gt;</span>
<a name="l02786"></a>02786 <span class="comment">     * &lt;li&gt;L or Landscape&lt;/li&gt;</span>
<a name="l02787"></a>02787 <span class="comment">     * &lt;li&gt;&#39;&#39; (empty string) for automatic orientation&lt;/li&gt;</span>
<a name="l02788"></a>02788 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l02789"></a>02789 <span class="comment">     * @protected</span>
<a name="l02790"></a>02790 <span class="comment">     * @since 3.0.015 (2008-06-06)</span>
<a name="l02791"></a>02791 <span class="comment">     * @see getPageSizeFromFormat()</span>
<a name="l02792"></a>02792 <span class="comment">     */</span>
<a name="l02793"></a><a class="code" href="classTCPDF.html#aa389d4419c77510dc3998f0af78d8a00">02793</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa389d4419c77510dc3998f0af78d8a00" title="Change the format of the current page.">setPageFormat</a>(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>, $orientation=<span class="charliteral">&#39;P&#39;</span>) {
<a name="l02794"></a>02794         <span class="keywordflow">if</span> (!empty(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>) AND isset($this-&gt;pagedim[$this-&gt;page])) {
<a name="l02795"></a>02795             <span class="comment">// remove inherited values</span>
<a name="l02796"></a>02796             unset($this-&gt;pagedim[$this-&gt;page]);
<a name="l02797"></a>02797         }
<a name="l02798"></a>02798         <span class="keywordflow">if</span> (is_string(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>)) {
<a name="l02799"></a>02799             <span class="comment">// get page measures from format name</span>
<a name="l02800"></a>02800             $pf = $this-&gt;<a class="code" href="classTCPDF.html#a087d4df77e60b7054e97804069ed32c5" title="Get page dimensions from format name.">getPageSizeFromFormat</a>(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>);
<a name="l02801"></a>02801             $this-&gt;fwPt = $pf[0];
<a name="l02802"></a>02802             $this-&gt;fhPt = $pf[1];
<a name="l02803"></a>02803         } <span class="keywordflow">else</span> {
<a name="l02804"></a>02804             <span class="comment">// the boundaries of the physical medium on which the page shall be displayed or printed</span>
<a name="l02805"></a>02805             <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;MediaBox&#39;</span>])) {
<a name="l02806"></a>02806                 $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;MediaBox&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>);
<a name="l02807"></a>02807                 $this-&gt;fwPt = ((<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>] - <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>]) * $this-&gt;k);
<a name="l02808"></a>02808                 $this-&gt;fhPt = ((<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>] - <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>]) * $this-&gt;k);
<a name="l02809"></a>02809             } <span class="keywordflow">else</span> {
<a name="l02810"></a>02810                 <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[0]) AND is_numeric(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[0]) AND isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[1]) AND is_numeric(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[1])) {
<a name="l02811"></a>02811                     $pf = array((<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[0] * $this-&gt;k), (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[1] * $this-&gt;k));
<a name="l02812"></a>02812                 } <span class="keywordflow">else</span> {
<a name="l02813"></a>02813                     <span class="keywordflow">if</span> (!isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;format&#39;</span>])) {
<a name="l02814"></a>02814                         <span class="comment">// default value</span>
<a name="l02815"></a>02815                         <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;format&#39;</span>] = <span class="stringliteral">&#39;A4&#39;</span>;
<a name="l02816"></a>02816                     }
<a name="l02817"></a>02817                     $pf = $this-&gt;<a class="code" href="classTCPDF.html#a087d4df77e60b7054e97804069ed32c5" title="Get page dimensions from format name.">getPageSizeFromFormat</a>(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;format&#39;</span>]);
<a name="l02818"></a>02818                 }
<a name="l02819"></a>02819                 $this-&gt;fwPt = $pf[0];
<a name="l02820"></a>02820                 $this-&gt;fhPt = $pf[1];
<a name="l02821"></a>02821                 $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;MediaBox&#39;</span>, 0, 0, $this-&gt;fwPt, $this-&gt;fhPt, <span class="keyword">true</span>);
<a name="l02822"></a>02822             }
<a name="l02823"></a>02823             <span class="comment">// the visible region of default user space</span>
<a name="l02824"></a>02824             <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;CropBox&#39;</span>])) {
<a name="l02825"></a>02825                 $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;CropBox&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>);
<a name="l02826"></a>02826             }
<a name="l02827"></a>02827             <span class="comment">// the region to which the contents of the page shall be clipped when output in a production environment</span>
<a name="l02828"></a>02828             <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;BleedBox&#39;</span>])) {
<a name="l02829"></a>02829                 $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;BleedBox&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;BleedBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;BleedBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;BleedBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;BleedBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>);
<a name="l02830"></a>02830             }
<a name="l02831"></a>02831             <span class="comment">// the intended dimensions of the finished page after trimming</span>
<a name="l02832"></a>02832             <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;TrimBox&#39;</span>])) {
<a name="l02833"></a>02833                 $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;TrimBox&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;TrimBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;TrimBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;TrimBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;TrimBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>);
<a name="l02834"></a>02834             }
<a name="l02835"></a>02835             <span class="comment">// the page&#39;s meaningful content (including potential white space)</span>
<a name="l02836"></a>02836             <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;ArtBox&#39;</span>])) {
<a name="l02837"></a>02837                 $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;ArtBox&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;ArtBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;ArtBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;ArtBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;ArtBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>);
<a name="l02838"></a>02838             }
<a name="l02839"></a>02839             <span class="comment">// specify the colours and other visual characteristics that should be used in displaying guidelines on the screen for the various page boundaries</span>
<a name="l02840"></a>02840             <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;BoxColorInfo&#39;</span>])) {
<a name="l02841"></a>02841                 $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>] = <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;BoxColorInfo&#39;</span>];
<a name="l02842"></a>02842             }
<a name="l02843"></a>02843             <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;Rotate&#39;</span>]) AND ((<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;Rotate&#39;</span>] % 90) == 0)) {
<a name="l02844"></a>02844                 <span class="comment">// The number of degrees by which the page shall be rotated clockwise when displayed or printed. The value shall be a multiple of 90.</span>
<a name="l02845"></a>02845                 $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;Rotate&#39;</span>] = intval(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;Rotate&#39;</span>]);
<a name="l02846"></a>02846             }
<a name="l02847"></a>02847             <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;PZ&#39;</span>])) {
<a name="l02848"></a>02848                 <span class="comment">// The page&#39;s preferred zoom (magnification) factor</span>
<a name="l02849"></a>02849                 $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;PZ&#39;</span>] = floatval(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;PZ&#39;</span>]);
<a name="l02850"></a>02850             }
<a name="l02851"></a>02851             <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>])) {
<a name="l02852"></a>02852                 <span class="comment">// The style and duration of the visual transition to use when moving from another page to the given page during a presentation</span>
<a name="l02853"></a>02853                 <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>])) {
<a name="l02854"></a>02854                     <span class="comment">// The page&#39;s display duration</span>
<a name="l02855"></a>02855                     $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>] = floatval(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>]);
<a name="l02856"></a>02856                 }
<a name="l02857"></a>02857                 $stansition_styles = array(<span class="stringliteral">&#39;Split&#39;</span>, <span class="stringliteral">&#39;Blinds&#39;</span>, <span class="stringliteral">&#39;Box&#39;</span>, <span class="stringliteral">&#39;Wipe&#39;</span>, <span class="stringliteral">&#39;Dissolve&#39;</span>, <span class="stringliteral">&#39;Glitter&#39;</span>, <span class="charliteral">&#39;R&#39;</span>, <span class="stringliteral">&#39;Fly&#39;</span>, <span class="stringliteral">&#39;Push&#39;</span>, <span class="stringliteral">&#39;Cover&#39;</span>, <span class="stringliteral">&#39;Uncover&#39;</span>, <span class="stringliteral">&#39;Fade&#39;</span>);
<a name="l02858"></a>02858                 <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>]) AND in_array(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>], $stansition_styles)) {
<a name="l02859"></a>02859                     <span class="comment">// The transition style that shall be used when moving to this page from another during a presentation</span>
<a name="l02860"></a>02860                     $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] = <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>];
<a name="l02861"></a>02861                     $valid_effect = array(<span class="stringliteral">&#39;Split&#39;</span>, <span class="stringliteral">&#39;Blinds&#39;</span>);
<a name="l02862"></a>02862                     $valid_vals = array(<span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;V&#39;</span>);
<a name="l02863"></a>02863                     <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>]) AND in_array(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>], $valid_effect) AND in_array(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>], $valid_vals)) {
<a name="l02864"></a>02864                         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>] = <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>];
<a name="l02865"></a>02865                     }
<a name="l02866"></a>02866                     $valid_effect = array(<span class="stringliteral">&#39;Split&#39;</span>, <span class="stringliteral">&#39;Box&#39;</span>, <span class="stringliteral">&#39;Fly&#39;</span>);
<a name="l02867"></a>02867                     $valid_vals = array(<span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;O&#39;</span>);
<a name="l02868"></a>02868                     <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>]) AND in_array(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>], $valid_effect) AND in_array(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>], $valid_vals)) {
<a name="l02869"></a>02869                         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>] = <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>];
<a name="l02870"></a>02870                     }
<a name="l02871"></a>02871                     $valid_effect = array(<span class="stringliteral">&#39;Wipe&#39;</span>, <span class="stringliteral">&#39;Glitter&#39;</span>, <span class="stringliteral">&#39;Fly&#39;</span>, <span class="stringliteral">&#39;Cover&#39;</span>, <span class="stringliteral">&#39;Uncover&#39;</span>, <span class="stringliteral">&#39;Push&#39;</span>);
<a name="l02872"></a>02872                     <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>]) AND in_array(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>], $valid_effect)) {
<a name="l02873"></a>02873                         <span class="keywordflow">if</span> ((((<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 90) OR (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 180)) AND (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] == <span class="stringliteral">&#39;Wipe&#39;</span>))
<a name="l02874"></a>02874                             OR ((<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 315) AND (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] == <span class="stringliteral">&#39;Glitter&#39;</span>))
<a name="l02875"></a>02875                             OR ((<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 0) OR (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 270))) {
<a name="l02876"></a>02876                             $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] = intval(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>]);
<a name="l02877"></a>02877                         }
<a name="l02878"></a>02878                     }
<a name="l02879"></a>02879                     <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>]) AND (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] == <span class="stringliteral">&#39;Fly&#39;</span>)) {
<a name="l02880"></a>02880                         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>] = floatval(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>]);
<a name="l02881"></a>02881                     }
<a name="l02882"></a>02882                     <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>]) AND (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>] === <span class="keyword">true</span>) AND (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] == <span class="stringliteral">&#39;Fly&#39;</span>)) {
<a name="l02883"></a>02883                         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l02884"></a>02884                     }
<a name="l02885"></a>02885                 } <span class="keywordflow">else</span> {
<a name="l02886"></a>02886                     $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] = <span class="charliteral">&#39;R&#39;</span>;
<a name="l02887"></a>02887                 }
<a name="l02888"></a>02888                 <span class="keywordflow">if</span> (isset(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>])) {
<a name="l02889"></a>02889                     <span class="comment">// The duration of the transition effect, in seconds</span>
<a name="l02890"></a>02890                     $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>] = floatval(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>]);
<a name="l02891"></a>02891                 } <span class="keywordflow">else</span> {
<a name="l02892"></a>02892                     $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>] = 1;
<a name="l02893"></a>02893                 }
<a name="l02894"></a>02894             }
<a name="l02895"></a>02895         }
<a name="l02896"></a>02896         $this-&gt;<a class="code" href="classTCPDF.html#ad6a3575405b61049ff85ce019df5451d" title="Set page orientation.">setPageOrientation</a>($orientation);
<a name="l02897"></a>02897     }
<a name="l02898"></a>02898 <span class="comment"></span>
<a name="l02899"></a>02899 <span class="comment">    /**</span>
<a name="l02900"></a>02900 <span class="comment">     * Set page boundaries.</span>
<a name="l02901"></a>02901 <span class="comment">     * @param $page (int) page number</span>
<a name="l02902"></a>02902 <span class="comment">     * @param $type (string) valid values are: &lt;ul&gt;&lt;li&gt;&#39;MediaBox&#39; : the boundaries of the physical medium on which the page shall be displayed or printed;&lt;/li&gt;&lt;li&gt;&#39;CropBox&#39; : the visible region of default user space;&lt;/li&gt;&lt;li&gt;&#39;BleedBox&#39; : the region to which the contents of the page shall be clipped when output in a production environment;&lt;/li&gt;&lt;li&gt;&#39;TrimBox&#39; : the intended dimensions of the finished page after trimming;&lt;/li&gt;&lt;li&gt;&#39;ArtBox&#39; : the page&#39;s meaningful content (including potential white space).&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l02903"></a>02903 <span class="comment">     * @param $llx (float) lower-left x coordinate in user units</span>
<a name="l02904"></a>02904 <span class="comment">     * @param $lly (float) lower-left y coordinate in user units</span>
<a name="l02905"></a>02905 <span class="comment">     * @param $urx (float) upper-right x coordinate in user units</span>
<a name="l02906"></a>02906 <span class="comment">     * @param $ury (float) upper-right y coordinate in user units</span>
<a name="l02907"></a>02907 <span class="comment">     * @param $points (boolean) if true uses user units as unit of measure, otherwise uses PDF points</span>
<a name="l02908"></a>02908 <span class="comment">     * @public</span>
<a name="l02909"></a>02909 <span class="comment">     * @since 5.0.010 (2010-05-17)</span>
<a name="l02910"></a>02910 <span class="comment">     */</span>
<a name="l02911"></a><a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0">02911</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $llx, $lly, $urx, $ury, $points=<span class="keyword">false</span>) {
<a name="l02912"></a>02912         <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>])) {
<a name="l02913"></a>02913             <span class="comment">// initialize array</span>
<a name="l02914"></a>02914             $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>] = array();
<a name="l02915"></a>02915         }
<a name="l02916"></a>02916         $pageboxes = array(<span class="stringliteral">&#39;MediaBox&#39;</span>, <span class="stringliteral">&#39;CropBox&#39;</span>, <span class="stringliteral">&#39;BleedBox&#39;</span>, <span class="stringliteral">&#39;TrimBox&#39;</span>, <span class="stringliteral">&#39;ArtBox&#39;</span>);
<a name="l02917"></a>02917         <span class="keywordflow">if</span> (!in_array(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $pageboxes)) {
<a name="l02918"></a>02918             <span class="keywordflow">return</span>;
<a name="l02919"></a>02919         }
<a name="l02920"></a>02920         <span class="keywordflow">if</span> ($points) {
<a name="l02921"></a>02921             <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 1;
<a name="l02922"></a>02922         } <span class="keywordflow">else</span> {
<a name="l02923"></a>02923             <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = $this-&gt;k;
<a name="l02924"></a>02924         }
<a name="l02925"></a>02925         $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;llx&#39;</span>] = ($llx * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l02926"></a>02926         $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;lly&#39;</span>] = ($lly * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l02927"></a>02927         $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;urx&#39;</span>] = ($urx * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l02928"></a>02928         $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;ury&#39;</span>] = ($ury * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l02929"></a>02929     }
<a name="l02930"></a>02930 <span class="comment"></span>
<a name="l02931"></a>02931 <span class="comment">    /**</span>
<a name="l02932"></a>02932 <span class="comment">     * Swap X and Y coordinates of page boxes (change page boxes orientation).</span>
<a name="l02933"></a>02933 <span class="comment">     * @param $page (int) page number</span>
<a name="l02934"></a>02934 <span class="comment">     * @protected</span>
<a name="l02935"></a>02935 <span class="comment">     * @since 5.0.010 (2010-05-17)</span>
<a name="l02936"></a>02936 <span class="comment">     */</span>
<a name="l02937"></a><a class="code" href="classTCPDF.html#a36a26d0b6e2ae2d356a5567105f7db41">02937</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a36a26d0b6e2ae2d356a5567105f7db41" title="Swap X and Y coordinates of page boxes (change page boxes orientation).">swapPageBoxCoordinates</a>(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>) {
<a name="l02938"></a>02938         $pageboxes = array(<span class="stringliteral">&#39;MediaBox&#39;</span>, <span class="stringliteral">&#39;CropBox&#39;</span>, <span class="stringliteral">&#39;BleedBox&#39;</span>, <span class="stringliteral">&#39;TrimBox&#39;</span>, <span class="stringliteral">&#39;ArtBox&#39;</span>);
<a name="l02939"></a>02939         <span class="keywordflow">foreach</span> ($pageboxes as <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>) {
<a name="l02940"></a>02940             <span class="comment">// swap X and Y coordinates</span>
<a name="l02941"></a>02941             <span class="keywordflow">if</span> (isset($this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][$type])) {
<a name="l02942"></a>02942                 $tmp = $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;llx&#39;</span>];
<a name="l02943"></a>02943                 $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;llx&#39;</span>] = $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;lly&#39;</span>];
<a name="l02944"></a>02944                 $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;lly&#39;</span>] = $tmp;
<a name="l02945"></a>02945                 $tmp = $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;urx&#39;</span>];
<a name="l02946"></a>02946                 $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;urx&#39;</span>] = $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;ury&#39;</span>];
<a name="l02947"></a>02947                 $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>][<span class="stringliteral">&#39;ury&#39;</span>] = $tmp;
<a name="l02948"></a>02948             }
<a name="l02949"></a>02949         }
<a name="l02950"></a>02950     }
<a name="l02951"></a>02951 <span class="comment"></span>
<a name="l02952"></a>02952 <span class="comment">    /**</span>
<a name="l02953"></a>02953 <span class="comment">     * Set page orientation.</span>
<a name="l02954"></a>02954 <span class="comment">     * @param $orientation (string) page orientation. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;P or Portrait (default)&lt;/li&gt;&lt;li&gt;L or Landscape&lt;/li&gt;&lt;li&gt;&#39;&#39; (empty string) for automatic orientation&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l02955"></a>02955 <span class="comment">     * @param $autopagebreak (boolean) Boolean indicating if auto-page-break mode should be on or off.</span>
<a name="l02956"></a>02956 <span class="comment">     * @param $bottommargin (float) bottom margin of the page.</span>
<a name="l02957"></a>02957 <span class="comment">     * @public</span>
<a name="l02958"></a>02958 <span class="comment">     * @since 3.0.015 (2008-06-06)</span>
<a name="l02959"></a>02959 <span class="comment">     */</span>
<a name="l02960"></a><a class="code" href="classTCPDF.html#ad6a3575405b61049ff85ce019df5451d">02960</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad6a3575405b61049ff85ce019df5451d" title="Set page orientation.">setPageOrientation</a>($orientation, $autopagebreak=<span class="stringliteral">&#39;&#39;</span>, $bottommargin=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l02961"></a>02961         <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>])) {
<a name="l02962"></a>02962             <span class="comment">// the boundaries of the physical medium on which the page shall be displayed or printed</span>
<a name="l02963"></a>02963             $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;MediaBox&#39;</span>, 0, 0, $this-&gt;fwPt, $this-&gt;fhPt, <span class="keyword">true</span>);
<a name="l02964"></a>02964         }
<a name="l02965"></a>02965         <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>])) {
<a name="l02966"></a>02966             <span class="comment">// the visible region of default user space</span>
<a name="l02967"></a>02967             $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;CropBox&#39;</span>, $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">true</span>);
<a name="l02968"></a>02968         }
<a name="l02969"></a>02969         <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;BleedBox&#39;</span>])) {
<a name="l02970"></a>02970             <span class="comment">// the region to which the contents of the page shall be clipped when output in a production environment</span>
<a name="l02971"></a>02971             $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;BleedBox&#39;</span>, $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">true</span>);
<a name="l02972"></a>02972         }
<a name="l02973"></a>02973         <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;TrimBox&#39;</span>])) {
<a name="l02974"></a>02974             <span class="comment">// the intended dimensions of the finished page after trimming</span>
<a name="l02975"></a>02975             $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;TrimBox&#39;</span>, $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">true</span>);
<a name="l02976"></a>02976         }
<a name="l02977"></a>02977         <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;ArtBox&#39;</span>])) {
<a name="l02978"></a>02978             <span class="comment">// the page&#39;s meaningful content (including potential white space)</span>
<a name="l02979"></a>02979             $this-&gt;<a class="code" href="classTCPDF.html#a09a578a5ed1c9a57a4fa8322272ff7b0" title="Set page boundaries.">setPageBoxes</a>($this-&gt;page, <span class="stringliteral">&#39;ArtBox&#39;</span>, $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">true</span>);
<a name="l02980"></a>02980         }
<a name="l02981"></a>02981         <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;Rotate&#39;</span>])) {
<a name="l02982"></a>02982             <span class="comment">// The number of degrees by which the page shall be rotated clockwise when displayed or printed. The value shall be a multiple of 90.</span>
<a name="l02983"></a>02983             $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;Rotate&#39;</span>] = 0;
<a name="l02984"></a>02984         }
<a name="l02985"></a>02985         <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;PZ&#39;</span>])) {
<a name="l02986"></a>02986             <span class="comment">// The page&#39;s preferred zoom (magnification) factor</span>
<a name="l02987"></a>02987             $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;PZ&#39;</span>] = 1;
<a name="l02988"></a>02988         }
<a name="l02989"></a>02989         <span class="keywordflow">if</span> ($this-&gt;fwPt &gt; $this-&gt;fhPt) {
<a name="l02990"></a>02990             <span class="comment">// landscape</span>
<a name="l02991"></a>02991             $default_orientation = <span class="charliteral">&#39;L&#39;</span>;
<a name="l02992"></a>02992         } <span class="keywordflow">else</span> {
<a name="l02993"></a>02993             <span class="comment">// portrait</span>
<a name="l02994"></a>02994             $default_orientation = <span class="charliteral">&#39;P&#39;</span>;
<a name="l02995"></a>02995         }
<a name="l02996"></a>02996         $valid_orientations = array(<span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;L&#39;</span>);
<a name="l02997"></a>02997         <span class="keywordflow">if</span> (empty($orientation)) {
<a name="l02998"></a>02998             $orientation = $default_orientation;
<a name="l02999"></a>02999         } <span class="keywordflow">else</span> {
<a name="l03000"></a>03000             $orientation = strtoupper($orientation{0});
<a name="l03001"></a>03001         }
<a name="l03002"></a>03002         <span class="keywordflow">if</span> (in_array($orientation, $valid_orientations) AND ($orientation != $default_orientation)) {
<a name="l03003"></a>03003             $this-&gt;CurOrientation = $orientation;
<a name="l03004"></a>03004             $this-&gt;wPt = $this-&gt;fhPt;
<a name="l03005"></a>03005             $this-&gt;hPt = $this-&gt;fwPt;
<a name="l03006"></a>03006         } <span class="keywordflow">else</span> {
<a name="l03007"></a>03007             $this-&gt;CurOrientation = $default_orientation;
<a name="l03008"></a>03008             $this-&gt;wPt = $this-&gt;fwPt;
<a name="l03009"></a>03009             $this-&gt;hPt = $this-&gt;fhPt;
<a name="l03010"></a>03010         }
<a name="l03011"></a>03011         <span class="keywordflow">if</span> ((abs($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>] - $this-&gt;hPt) &lt; $this-&gt;feps) AND (abs($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>] - $this-&gt;wPt) &lt; $this-&gt;feps)){
<a name="l03012"></a>03012             <span class="comment">// swap X and Y coordinates (change page orientation)</span>
<a name="l03013"></a>03013             $this-&gt;<a class="code" href="classTCPDF.html#a36a26d0b6e2ae2d356a5567105f7db41" title="Swap X and Y coordinates of page boxes (change page boxes orientation).">swapPageBoxCoordinates</a>($this-&gt;page);
<a name="l03014"></a>03014         }
<a name="l03015"></a>03015         $this-&gt;w = $this-&gt;wPt / $this-&gt;k;
<a name="l03016"></a>03016         $this-&gt;h = $this-&gt;hPt / $this-&gt;k;
<a name="l03017"></a>03017         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($autopagebreak)) {
<a name="l03018"></a>03018             <span class="keywordflow">if</span> (isset($this-&gt;AutoPageBreak)) {
<a name="l03019"></a>03019                 $autopagebreak = $this-&gt;AutoPageBreak;
<a name="l03020"></a>03020             } <span class="keywordflow">else</span> {
<a name="l03021"></a>03021                 $autopagebreak = <span class="keyword">true</span>;
<a name="l03022"></a>03022             }
<a name="l03023"></a>03023         }
<a name="l03024"></a>03024         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($bottommargin)) {
<a name="l03025"></a>03025             <span class="keywordflow">if</span> (isset($this-&gt;bMargin)) {
<a name="l03026"></a>03026                 $bottommargin = $this-&gt;bMargin;
<a name="l03027"></a>03027             } <span class="keywordflow">else</span> {
<a name="l03028"></a>03028                 <span class="comment">// default value = 2 cm</span>
<a name="l03029"></a>03029                 $bottommargin = 2 * 28.35 / $this-&gt;k;
<a name="l03030"></a>03030             }
<a name="l03031"></a>03031         }
<a name="l03032"></a>03032         $this-&gt;<a class="code" href="classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9" title="Enables or disables the automatic page breaking mode.">SetAutoPageBreak</a>($autopagebreak, $bottommargin);
<a name="l03033"></a>03033         <span class="comment">// store page dimensions</span>
<a name="l03034"></a>03034         $this-&gt;pagedim[$this-&gt;page][<span class="charliteral">&#39;w&#39;</span>] = $this-&gt;wPt;
<a name="l03035"></a>03035         $this-&gt;pagedim[$this-&gt;page][<span class="charliteral">&#39;h&#39;</span>] = $this-&gt;hPt;
<a name="l03036"></a>03036         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;wk&#39;</span>] = $this-&gt;w;
<a name="l03037"></a>03037         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;hk&#39;</span>] = $this-&gt;h;
<a name="l03038"></a>03038         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;tm&#39;</span>] = $this-&gt;tMargin;
<a name="l03039"></a>03039         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;bm&#39;</span>] = $bottommargin;
<a name="l03040"></a>03040         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;lm&#39;</span>] = $this-&gt;lMargin;
<a name="l03041"></a>03041         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;rm&#39;</span>] = $this-&gt;rMargin;
<a name="l03042"></a>03042         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;pb&#39;</span>] = $autopagebreak;
<a name="l03043"></a>03043         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;or&#39;</span>] = $this-&gt;CurOrientation;
<a name="l03044"></a>03044         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] = $this-&gt;original_lMargin;
<a name="l03045"></a>03045         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>] = $this-&gt;original_rMargin;
<a name="l03046"></a>03046     }
<a name="l03047"></a>03047 <span class="comment"></span>
<a name="l03048"></a>03048 <span class="comment">    /**</span>
<a name="l03049"></a>03049 <span class="comment">     * Set regular expression to detect withespaces or word separators.</span>
<a name="l03050"></a>03050 <span class="comment">     * The pattern delimiter must be the forward-slash character &quot;/&quot;.</span>
<a name="l03051"></a>03051 <span class="comment">     * Some example patterns are:</span>
<a name="l03052"></a>03052 <span class="comment">     * &lt;pre&gt;</span>
<a name="l03053"></a>03053 <span class="comment">     * Non-Unicode or missing PCRE unicode support: &quot;/[^\S\xa0]/&quot;</span>
<a name="l03054"></a>03054 <span class="comment">     * Unicode and PCRE unicode support: &quot;/[^\S\P{Z}\xa0]/u&quot;</span>
<a name="l03055"></a>03055 <span class="comment">     * Unicode and PCRE unicode support in Chinese mode: &quot;/[^\S\P{Z}\P{Lo}\xa0]/u&quot;</span>
<a name="l03056"></a>03056 <span class="comment">     * if PCRE unicode support is turned ON (&quot;\P&quot; is the negate class of &quot;\p&quot;):</span>
<a name="l03057"></a>03057 <span class="comment">     * &quot;\p{Z}&quot; or &quot;\p{Separator}&quot;: any kind of Unicode whitespace or invisible separator.</span>
<a name="l03058"></a>03058 <span class="comment">     * &quot;\p{Lo}&quot; or &quot;\p{Other_Letter}&quot;: a Unicode letter or ideograph that does not have lowercase and uppercase variants.</span>
<a name="l03059"></a>03059 <span class="comment">     * &quot;\p{Lo}&quot; is needed for Chinese characters because are packed next to each other without spaces in between.</span>
<a name="l03060"></a>03060 <span class="comment">     * &lt;/pre&gt;</span>
<a name="l03061"></a>03061 <span class="comment">     * @param $re (string) regular expression (leave empty for default).</span>
<a name="l03062"></a>03062 <span class="comment">     * @public</span>
<a name="l03063"></a>03063 <span class="comment">     * @since 4.6.016 (2009-06-15)</span>
<a name="l03064"></a>03064 <span class="comment">     */</span>
<a name="l03065"></a><a class="code" href="classTCPDF.html#a937dcd07bad79ae3900236f87b29194b">03065</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a937dcd07bad79ae3900236f87b29194b" title="Set regular expression to detect withespaces or word separators.">setSpacesRE</a>($re=<span class="stringliteral">&#39;/[^\S\xa0]/&#39;</span>) {
<a name="l03066"></a>03066         $this-&gt;re_spaces = $re;
<a name="l03067"></a>03067         $re_parts = explode(<span class="charliteral">&#39;/&#39;</span>, $re);
<a name="l03068"></a>03068         <span class="comment">// get pattern parts</span>
<a name="l03069"></a>03069         $this-&gt;re_space = array();
<a name="l03070"></a>03070         <span class="keywordflow">if</span> (isset($re_parts[1]) AND !empty($re_parts[1])) {
<a name="l03071"></a>03071             $this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>] = $re_parts[1];
<a name="l03072"></a>03072         } <span class="keywordflow">else</span> {
<a name="l03073"></a>03073             $this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>] = <span class="stringliteral">&#39;[\s]&#39;</span>;
<a name="l03074"></a>03074         }
<a name="l03075"></a>03075         <span class="comment">// set pattern modifiers</span>
<a name="l03076"></a>03076         <span class="keywordflow">if</span> (isset($re_parts[2]) AND !empty($re_parts[2])) {
<a name="l03077"></a>03077             $this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>] = $re_parts[2];
<a name="l03078"></a>03078         } <span class="keywordflow">else</span> {
<a name="l03079"></a>03079             $this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l03080"></a>03080         }
<a name="l03081"></a>03081     }
<a name="l03082"></a>03082 <span class="comment"></span>
<a name="l03083"></a>03083 <span class="comment">    /**</span>
<a name="l03084"></a>03084 <span class="comment">     * Enable or disable Right-To-Left language mode</span>
<a name="l03085"></a>03085 <span class="comment">     * @param $enable (Boolean) if true enable Right-To-Left language mode.</span>
<a name="l03086"></a>03086 <span class="comment">     * @param $resetx (Boolean) if true reset the X position on direction change.</span>
<a name="l03087"></a>03087 <span class="comment">     * @public</span>
<a name="l03088"></a>03088 <span class="comment">     * @since 2.0.000 (2008-01-03)</span>
<a name="l03089"></a>03089 <span class="comment">     */</span>
<a name="l03090"></a><a class="code" href="classTCPDF.html#a7d067c080614c7f55b6623adfc80a1c1">03090</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7d067c080614c7f55b6623adfc80a1c1" title="Enable or disable Right-To-Left language mode.">setRTL</a>($enable, $resetx=<span class="keyword">true</span>) {
<a name="l03091"></a>03091         $enable = $enable ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l03092"></a>03092         $resetx = ($resetx AND ($enable != $this-&gt;rtl));
<a name="l03093"></a>03093         $this-&gt;rtl = $enable;
<a name="l03094"></a>03094         $this-&gt;tmprtl = <span class="keyword">false</span>;
<a name="l03095"></a>03095         <span class="keywordflow">if</span> ($resetx) {
<a name="l03096"></a>03096             $this-&gt;<a class="code" href="classTCPDF.html#a00969cf629d72b3d29ee435f15906820" title="Performs a line break.">Ln</a>(0);
<a name="l03097"></a>03097         }
<a name="l03098"></a>03098     }
<a name="l03099"></a>03099 <span class="comment"></span>
<a name="l03100"></a>03100 <span class="comment">    /**</span>
<a name="l03101"></a>03101 <span class="comment">     * Return the RTL status</span>
<a name="l03102"></a>03102 <span class="comment">     * @return boolean</span>
<a name="l03103"></a>03103 <span class="comment">     * @public</span>
<a name="l03104"></a>03104 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l03105"></a>03105 <span class="comment">     */</span>
<a name="l03106"></a><a class="code" href="classTCPDF.html#af01238bb928c4e3de6ed6aaa855fd788">03106</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af01238bb928c4e3de6ed6aaa855fd788" title="Return the RTL status.">getRTL</a>() {
<a name="l03107"></a>03107         <span class="keywordflow">return</span> $this-&gt;rtl;
<a name="l03108"></a>03108     }
<a name="l03109"></a>03109 <span class="comment"></span>
<a name="l03110"></a>03110 <span class="comment">    /**</span>
<a name="l03111"></a>03111 <span class="comment">     * Force temporary RTL language direction</span>
<a name="l03112"></a>03112 <span class="comment">     * @param $mode (mixed) can be false, &#39;L&#39; for LTR or &#39;R&#39; for RTL</span>
<a name="l03113"></a>03113 <span class="comment">     * @public</span>
<a name="l03114"></a>03114 <span class="comment">     * @since 2.1.000 (2008-01-09)</span>
<a name="l03115"></a>03115 <span class="comment">     */</span>
<a name="l03116"></a><a class="code" href="classTCPDF.html#a6bada8d1ad88d9fa54368619de43b866">03116</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6bada8d1ad88d9fa54368619de43b866" title="Force temporary RTL language direction.">setTempRTL</a>(<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>) {
<a name="l03117"></a>03117         $newmode = <span class="keyword">false</span>;
<a name="l03118"></a>03118         <span class="keywordflow">switch</span> (strtoupper(<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>)) {
<a name="l03119"></a>03119             <span class="keywordflow">case</span> <span class="stringliteral">&#39;LTR&#39;</span>:
<a name="l03120"></a>03120             <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {
<a name="l03121"></a>03121                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l03122"></a>03122                     $newmode = <span class="charliteral">&#39;L&#39;</span>;
<a name="l03123"></a>03123                 }
<a name="l03124"></a>03124                 <span class="keywordflow">break</span>;
<a name="l03125"></a>03125             }
<a name="l03126"></a>03126             <span class="keywordflow">case</span> <span class="stringliteral">&#39;RTL&#39;</span>:
<a name="l03127"></a>03127             <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {
<a name="l03128"></a>03128                 <span class="keywordflow">if</span> (!$this-&gt;rtl) {
<a name="l03129"></a>03129                     $newmode = <span class="charliteral">&#39;R&#39;</span>;
<a name="l03130"></a>03130                 }
<a name="l03131"></a>03131                 <span class="keywordflow">break</span>;
<a name="l03132"></a>03132             }
<a name="l03133"></a>03133             <span class="keywordflow">case</span> <span class="keyword">false</span>:
<a name="l03134"></a>03134             <span class="keywordflow">default</span>: {
<a name="l03135"></a>03135                 $newmode = <span class="keyword">false</span>;
<a name="l03136"></a>03136                 <span class="keywordflow">break</span>;
<a name="l03137"></a>03137             }
<a name="l03138"></a>03138         }
<a name="l03139"></a>03139         $this-&gt;tmprtl = $newmode;
<a name="l03140"></a>03140     }
<a name="l03141"></a>03141 <span class="comment"></span>
<a name="l03142"></a>03142 <span class="comment">    /**</span>
<a name="l03143"></a>03143 <span class="comment">     * Return the current temporary RTL status</span>
<a name="l03144"></a>03144 <span class="comment">     * @return boolean</span>
<a name="l03145"></a>03145 <span class="comment">     * @public</span>
<a name="l03146"></a>03146 <span class="comment">     * @since 4.8.014 (2009-11-04)</span>
<a name="l03147"></a>03147 <span class="comment">     */</span>
<a name="l03148"></a><a class="code" href="classTCPDF.html#accba6f1471acb211de74e6b34107041d">03148</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#accba6f1471acb211de74e6b34107041d" title="Return the current temporary RTL status.">isRTLTextDir</a>() {
<a name="l03149"></a>03149         <span class="keywordflow">return</span> ($this-&gt;rtl OR ($this-&gt;tmprtl == <span class="charliteral">&#39;R&#39;</span>));
<a name="l03150"></a>03150     }
<a name="l03151"></a>03151 <span class="comment"></span>
<a name="l03152"></a>03152 <span class="comment">    /**</span>
<a name="l03153"></a>03153 <span class="comment">     * Set the last cell height.</span>
<a name="l03154"></a>03154 <span class="comment">     * @param $h (float) cell height.</span>
<a name="l03155"></a>03155 <span class="comment">     * @author Nicola Asuni</span>
<a name="l03156"></a>03156 <span class="comment">     * @public</span>
<a name="l03157"></a>03157 <span class="comment">     * @since 1.53.0.TC034</span>
<a name="l03158"></a>03158 <span class="comment">     */</span>
<a name="l03159"></a><a class="code" href="classTCPDF.html#a188a10529c5479241c1403f2d438e861">03159</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a188a10529c5479241c1403f2d438e861" title="Set the last cell height.">setLastH</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>) {
<a name="l03160"></a>03160         $this-&gt;lasth = <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l03161"></a>03161     }
<a name="l03162"></a>03162 <span class="comment"></span>
<a name="l03163"></a>03163 <span class="comment">    /**</span>
<a name="l03164"></a>03164 <span class="comment">     * Reset the last cell height.</span>
<a name="l03165"></a>03165 <span class="comment">     * @public</span>
<a name="l03166"></a>03166 <span class="comment">     * @since 5.9.000 (2010-10-03)</span>
<a name="l03167"></a>03167 <span class="comment">     */</span>
<a name="l03168"></a><a class="code" href="classTCPDF.html#a10215105777b306528a827f3669e936e">03168</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a10215105777b306528a827f3669e936e" title="Reset the last cell height.">resetLastH</a>() {
<a name="l03169"></a>03169         $this-&gt;lasth = ($this-&gt;FontSize * $this-&gt;cell_height_ratio) + $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>];
<a name="l03170"></a>03170     }
<a name="l03171"></a>03171 <span class="comment"></span>
<a name="l03172"></a>03172 <span class="comment">    /**</span>
<a name="l03173"></a>03173 <span class="comment">     * Get the last cell height.</span>
<a name="l03174"></a>03174 <span class="comment">     * @return last cell height</span>
<a name="l03175"></a>03175 <span class="comment">     * @public</span>
<a name="l03176"></a>03176 <span class="comment">     * @since 4.0.017 (2008-08-05)</span>
<a name="l03177"></a>03177 <span class="comment">     */</span>
<a name="l03178"></a><a class="code" href="classTCPDF.html#afe93f88db5be010a17cdf7c5ba4b9b10">03178</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#afe93f88db5be010a17cdf7c5ba4b9b10" title="Get the last cell height.">getLastH</a>() {
<a name="l03179"></a>03179         <span class="keywordflow">return</span> $this-&gt;lasth;
<a name="l03180"></a>03180     }
<a name="l03181"></a>03181 <span class="comment"></span>
<a name="l03182"></a>03182 <span class="comment">    /**</span>
<a name="l03183"></a>03183 <span class="comment">     * Set the adjusting factor to convert pixels to user units.</span>
<a name="l03184"></a>03184 <span class="comment">     * @param $scale (float) adjusting factor to convert pixels to user units.</span>
<a name="l03185"></a>03185 <span class="comment">     * @author Nicola Asuni</span>
<a name="l03186"></a>03186 <span class="comment">     * @public</span>
<a name="l03187"></a>03187 <span class="comment">     * @since 1.5.2</span>
<a name="l03188"></a>03188 <span class="comment">     */</span>
<a name="l03189"></a><a class="code" href="classTCPDF.html#af4e98dda815a0a7123c6480a951b4e24">03189</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af4e98dda815a0a7123c6480a951b4e24" title="Set the adjusting factor to convert pixels to user units.">setImageScale</a>($scale) {
<a name="l03190"></a>03190         $this-&gt;imgscale = $scale;
<a name="l03191"></a>03191     }
<a name="l03192"></a>03192 <span class="comment"></span>
<a name="l03193"></a>03193 <span class="comment">    /**</span>
<a name="l03194"></a>03194 <span class="comment">     * Returns the adjusting factor to convert pixels to user units.</span>
<a name="l03195"></a>03195 <span class="comment">     * @return float adjusting factor to convert pixels to user units.</span>
<a name="l03196"></a>03196 <span class="comment">     * @author Nicola Asuni</span>
<a name="l03197"></a>03197 <span class="comment">     * @public</span>
<a name="l03198"></a>03198 <span class="comment">     * @since 1.5.2</span>
<a name="l03199"></a>03199 <span class="comment">     */</span>
<a name="l03200"></a><a class="code" href="classTCPDF.html#a3cfc462353c8c404e621556232319d81">03200</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3cfc462353c8c404e621556232319d81" title="Returns the adjusting factor to convert pixels to user units.">getImageScale</a>() {
<a name="l03201"></a>03201         <span class="keywordflow">return</span> $this-&gt;imgscale;
<a name="l03202"></a>03202     }
<a name="l03203"></a>03203 <span class="comment"></span>
<a name="l03204"></a>03204 <span class="comment">    /**</span>
<a name="l03205"></a>03205 <span class="comment">     * Returns an array of page dimensions:</span>
<a name="l03206"></a>03206 <span class="comment">     * &lt;ul&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;w&#39;] = page width in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;h&#39;] = height in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;wk&#39;] = page width in user units&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;hk&#39;] = page height in user units&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;tm&#39;] = top margin&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;bm&#39;] = bottom margin&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;lm&#39;] = left margin&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;rm&#39;] = right margin&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;pb&#39;] = auto page break&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;or&#39;] = page orientation&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;olm&#39;] = original left margin&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;orm&#39;] = original right margin&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;Rotate&#39;] = The number of degrees by which the page shall be rotated clockwise when displayed or printed. The value shall be a multiple of 90.&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;PZ&#39;] = The page&#39;s preferred zoom (magnification) factor.&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;trans&#39;] : the style and duration of the visual transition to use when moving from another page to the given page during a presentation&lt;ul&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;trans&#39;][&#39;Dur&#39;] = The page&#39;s display duration (also called its advance timing): the maximum length of time, in seconds, that the page shall be displayed during presentations before the viewer application shall automatically advance to the next page.&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;trans&#39;][&#39;S&#39;] = transition style : Split, Blinds, Box, Wipe, Dissolve, Glitter, R, Fly, Push, Cover, Uncover, Fade&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;trans&#39;][&#39;D&#39;] = The duration of the transition effect, in seconds.&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;trans&#39;][&#39;Dm&#39;] = (Split and Blinds transition styles only) The dimension in which the specified transition effect shall occur: H = Horizontal, V = Vertical. Default value: H.&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;trans&#39;][&#39;M&#39;] = (Split, Box and Fly transition styles only) The direction of motion for the specified transition effect: I = Inward from the edges of the page, O = Outward from the center of the pageDefault value: I.&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;trans&#39;][&#39;Di&#39;] = (Wipe, Glitter, Fly, Cover, Uncover and Push transition styles only) The direction in which the specified transition effect shall moves, expressed in degrees counterclockwise starting from a left-to-right direction. If the value is a number, it shall be one of: 0 = Left to right, 90 = Bottom to top (Wipe only), 180 = Right to left (Wipe only), 270 = Top to bottom, 315 = Top-left to bottom-right (Glitter only). If the value is a name, it shall be None, which is relevant only for the Fly transition when the value of SS is not 1.0. Default value: 0.&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;trans&#39;][&#39;SS&#39;] = (Fly transition style only) The starting or ending scale at which the changes shall be drawn. If M specifies an inward transition, the scale of the changes drawn shall progress from SS to 1.0 over the course of the transition. If M specifies an outward transition, the scale of the changes drawn shall progress from 1.0 to SS over the course of the transition. Default: 1.0. &lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;trans&#39;][&#39;B&#39;] = (Fly transition style only) If true, the area that shall be flown in is rectangular and opaque. Default: false.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;MediaBox&#39;] : the boundaries of the physical medium on which the page shall be displayed or printed&lt;ul&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;MediaBox&#39;][&#39;llx&#39;] = lower-left x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;MediaBox&#39;][&#39;lly&#39;] = lower-left y coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;MediaBox&#39;][&#39;urx&#39;] = upper-right x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;MediaBox&#39;][&#39;ury&#39;] = upper-right y coordinate in points&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;CropBox&#39;] : the visible region of default user space&lt;ul&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;CropBox&#39;][&#39;llx&#39;] = lower-left x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;CropBox&#39;][&#39;lly&#39;] = lower-left y coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;CropBox&#39;][&#39;urx&#39;] = upper-right x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;CropBox&#39;][&#39;ury&#39;] = upper-right y coordinate in points&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;BleedBox&#39;] : the region to which the contents of the page shall be clipped when output in a production environment&lt;ul&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;BleedBox&#39;][&#39;llx&#39;] = lower-left x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;BleedBox&#39;][&#39;lly&#39;] = lower-left y coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;BleedBox&#39;][&#39;urx&#39;] = upper-right x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;BleedBox&#39;][&#39;ury&#39;] = upper-right y coordinate in points&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;TrimBox&#39;] : the intended dimensions of the finished page after trimming&lt;ul&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;TrimBox&#39;][&#39;llx&#39;] = lower-left x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;TrimBox&#39;][&#39;lly&#39;] = lower-left y coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;TrimBox&#39;][&#39;urx&#39;] = upper-right x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;TrimBox&#39;][&#39;ury&#39;] = upper-right y coordinate in points&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;ArtBox&#39;] : the extent of the page&#39;s meaningful content&lt;ul&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;ArtBox&#39;][&#39;llx&#39;] = lower-left x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;ArtBox&#39;][&#39;lly&#39;] = lower-left y coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;ArtBox&#39;][&#39;urx&#39;] = upper-right x coordinate in points&lt;/li&gt;&lt;li&gt;$this-&gt;pagedim[$this-&gt;page][&#39;ArtBox&#39;][&#39;ury&#39;] = upper-right y coordinate in points&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l03207"></a>03207 <span class="comment">     * @param $pagenum (int) page number (empty = current page)</span>
<a name="l03208"></a>03208 <span class="comment">     * @return array of page dimensions.</span>
<a name="l03209"></a>03209 <span class="comment">     * @author Nicola Asuni</span>
<a name="l03210"></a>03210 <span class="comment">     * @public</span>
<a name="l03211"></a>03211 <span class="comment">     * @since 4.5.027 (2009-03-16)</span>
<a name="l03212"></a>03212 <span class="comment">     */</span>
<a name="l03213"></a><a class="code" href="classTCPDF.html#a62e82c3bdf531f0c898926124696e77e">03213</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a62e82c3bdf531f0c898926124696e77e" title="Returns an array of page dimensions:">getPageDimensions</a>($pagenum=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l03214"></a>03214         <span class="keywordflow">if</span> (empty($pagenum)) {
<a name="l03215"></a>03215             $pagenum = $this-&gt;page;
<a name="l03216"></a>03216         }
<a name="l03217"></a>03217         <span class="keywordflow">return</span> $this-&gt;pagedim[$pagenum];
<a name="l03218"></a>03218     }
<a name="l03219"></a>03219 <span class="comment"></span>
<a name="l03220"></a>03220 <span class="comment">    /**</span>
<a name="l03221"></a>03221 <span class="comment">     * Returns the page width in units.</span>
<a name="l03222"></a>03222 <span class="comment">     * @param $pagenum (int) page number (empty = current page)</span>
<a name="l03223"></a>03223 <span class="comment">     * @return int page width.</span>
<a name="l03224"></a>03224 <span class="comment">     * @author Nicola Asuni</span>
<a name="l03225"></a>03225 <span class="comment">     * @public</span>
<a name="l03226"></a>03226 <span class="comment">     * @since 1.5.2</span>
<a name="l03227"></a>03227 <span class="comment">     * @see getPageDimensions()</span>
<a name="l03228"></a>03228 <span class="comment">     */</span>
<a name="l03229"></a><a class="code" href="classTCPDF.html#a510ab21d6a373934bcd3bd4683704b7e">03229</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a510ab21d6a373934bcd3bd4683704b7e" title="Returns the page width in units.">getPageWidth</a>($pagenum=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l03230"></a>03230         <span class="keywordflow">if</span> (empty($pagenum)) {
<a name="l03231"></a>03231             <span class="keywordflow">return</span> $this-&gt;w;
<a name="l03232"></a>03232         }
<a name="l03233"></a>03233         <span class="keywordflow">return</span> $this-&gt;pagedim[$pagenum][<span class="charliteral">&#39;w&#39;</span>];
<a name="l03234"></a>03234     }
<a name="l03235"></a>03235 <span class="comment"></span>
<a name="l03236"></a>03236 <span class="comment">    /**</span>
<a name="l03237"></a>03237 <span class="comment">     * Returns the page height in units.</span>
<a name="l03238"></a>03238 <span class="comment">     * @param $pagenum (int) page number (empty = current page)</span>
<a name="l03239"></a>03239 <span class="comment">     * @return int page height.</span>
<a name="l03240"></a>03240 <span class="comment">     * @author Nicola Asuni</span>
<a name="l03241"></a>03241 <span class="comment">     * @public</span>
<a name="l03242"></a>03242 <span class="comment">     * @since 1.5.2</span>
<a name="l03243"></a>03243 <span class="comment">     * @see getPageDimensions()</span>
<a name="l03244"></a>03244 <span class="comment">     */</span>
<a name="l03245"></a><a class="code" href="classTCPDF.html#a8c7be67402e96a5220556cfa9db8500a">03245</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8c7be67402e96a5220556cfa9db8500a" title="Returns the page height in units.">getPageHeight</a>($pagenum=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l03246"></a>03246         <span class="keywordflow">if</span> (empty($pagenum)) {
<a name="l03247"></a>03247             <span class="keywordflow">return</span> $this-&gt;h;
<a name="l03248"></a>03248         }
<a name="l03249"></a>03249         <span class="keywordflow">return</span> $this-&gt;pagedim[$pagenum][<span class="charliteral">&#39;h&#39;</span>];
<a name="l03250"></a>03250     }
<a name="l03251"></a>03251 <span class="comment"></span>
<a name="l03252"></a>03252 <span class="comment">    /**</span>
<a name="l03253"></a>03253 <span class="comment">     * Returns the page break margin.</span>
<a name="l03254"></a>03254 <span class="comment">     * @param $pagenum (int) page number (empty = current page)</span>
<a name="l03255"></a>03255 <span class="comment">     * @return int page break margin.</span>
<a name="l03256"></a>03256 <span class="comment">     * @author Nicola Asuni</span>
<a name="l03257"></a>03257 <span class="comment">     * @public</span>
<a name="l03258"></a>03258 <span class="comment">     * @since 1.5.2</span>
<a name="l03259"></a>03259 <span class="comment">     * @see getPageDimensions()</span>
<a name="l03260"></a>03260 <span class="comment">     */</span>
<a name="l03261"></a><a class="code" href="classTCPDF.html#a8203a3a6bda94f38f973de2825b76ea3">03261</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8203a3a6bda94f38f973de2825b76ea3" title="Returns the page break margin.">getBreakMargin</a>($pagenum=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l03262"></a>03262         <span class="keywordflow">if</span> (empty($pagenum)) {
<a name="l03263"></a>03263             <span class="keywordflow">return</span> $this-&gt;bMargin;
<a name="l03264"></a>03264         }
<a name="l03265"></a>03265         <span class="keywordflow">return</span> $this-&gt;pagedim[$pagenum][<span class="stringliteral">&#39;bm&#39;</span>];
<a name="l03266"></a>03266     }
<a name="l03267"></a>03267 <span class="comment"></span>
<a name="l03268"></a>03268 <span class="comment">    /**</span>
<a name="l03269"></a>03269 <span class="comment">     * Returns the scale factor (number of points in user unit).</span>
<a name="l03270"></a>03270 <span class="comment">     * @return int scale factor.</span>
<a name="l03271"></a>03271 <span class="comment">     * @author Nicola Asuni</span>
<a name="l03272"></a>03272 <span class="comment">     * @public</span>
<a name="l03273"></a>03273 <span class="comment">     * @since 1.5.2</span>
<a name="l03274"></a>03274 <span class="comment">     */</span>
<a name="l03275"></a><a class="code" href="classTCPDF.html#aae92c359fcd3d68b063b38de2a92aa51">03275</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aae92c359fcd3d68b063b38de2a92aa51" title="Returns the scale factor (number of points in user unit).">getScaleFactor</a>() {
<a name="l03276"></a>03276         <span class="keywordflow">return</span> $this-&gt;k;
<a name="l03277"></a>03277     }
<a name="l03278"></a>03278 <span class="comment"></span>
<a name="l03279"></a>03279 <span class="comment">    /**</span>
<a name="l03280"></a>03280 <span class="comment">     * Defines the left, top and right margins.</span>
<a name="l03281"></a>03281 <span class="comment">     * @param $left (float) Left margin.</span>
<a name="l03282"></a>03282 <span class="comment">     * @param $top (float) Top margin.</span>
<a name="l03283"></a>03283 <span class="comment">     * @param $right (float) Right margin. Default value is the left one.</span>
<a name="l03284"></a>03284 <span class="comment">     * @param $keepmargins (boolean) if true overwrites the default page margins</span>
<a name="l03285"></a>03285 <span class="comment">     * @public</span>
<a name="l03286"></a>03286 <span class="comment">     * @since 1.0</span>
<a name="l03287"></a>03287 <span class="comment">     * @see SetLeftMargin(), SetTopMargin(), SetRightMargin(), SetAutoPageBreak()</span>
<a name="l03288"></a>03288 <span class="comment">     */</span>
<a name="l03289"></a><a class="code" href="classTCPDF.html#ab3bbdb7c85ea08d175fd559be6132ba0">03289</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab3bbdb7c85ea08d175fd559be6132ba0" title="Defines the left, top and right margins.">SetMargins</a>($left, $top, $right=-1, $keepmargins=<span class="keyword">false</span>) {
<a name="l03290"></a>03290         <span class="comment">//Set left, top and right margins</span>
<a name="l03291"></a>03291         $this-&gt;lMargin = $left;
<a name="l03292"></a>03292         $this-&gt;tMargin = $top;
<a name="l03293"></a>03293         <span class="keywordflow">if</span> ($right == -1) {
<a name="l03294"></a>03294             $right = $left;
<a name="l03295"></a>03295         }
<a name="l03296"></a>03296         $this-&gt;rMargin = $right;
<a name="l03297"></a>03297         <span class="keywordflow">if</span> ($keepmargins) {
<a name="l03298"></a>03298             <span class="comment">// overwrite original values</span>
<a name="l03299"></a>03299             $this-&gt;original_lMargin = $this-&gt;lMargin;
<a name="l03300"></a>03300             $this-&gt;original_rMargin = $this-&gt;rMargin;
<a name="l03301"></a>03301         }
<a name="l03302"></a>03302     }
<a name="l03303"></a>03303 <span class="comment"></span>
<a name="l03304"></a>03304 <span class="comment">    /**</span>
<a name="l03305"></a>03305 <span class="comment">     * Defines the left margin. The method can be called before creating the first page. If the current abscissa gets out of page, it is brought back to the margin.</span>
<a name="l03306"></a>03306 <span class="comment">     * @param $margin (float) The margin.</span>
<a name="l03307"></a>03307 <span class="comment">     * @public</span>
<a name="l03308"></a>03308 <span class="comment">     * @since 1.4</span>
<a name="l03309"></a>03309 <span class="comment">     * @see SetTopMargin(), SetRightMargin(), SetAutoPageBreak(), SetMargins()</span>
<a name="l03310"></a>03310 <span class="comment">     */</span>
<a name="l03311"></a><a class="code" href="classTCPDF.html#a28372fd5aa301e06535d2223025a0b29">03311</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a28372fd5aa301e06535d2223025a0b29" title="Defines the left margin.">SetLeftMargin</a>($margin) {
<a name="l03312"></a>03312         <span class="comment">//Set left margin</span>
<a name="l03313"></a>03313         $this-&gt;lMargin = $margin;
<a name="l03314"></a>03314         <span class="keywordflow">if</span> (($this-&gt;page &gt; 0) AND ($this-&gt;x &lt; $margin)) {
<a name="l03315"></a>03315             $this-&gt;x = $margin;
<a name="l03316"></a>03316         }
<a name="l03317"></a>03317     }
<a name="l03318"></a>03318 <span class="comment"></span>
<a name="l03319"></a>03319 <span class="comment">    /**</span>
<a name="l03320"></a>03320 <span class="comment">     * Defines the top margin. The method can be called before creating the first page.</span>
<a name="l03321"></a>03321 <span class="comment">     * @param $margin (float) The margin.</span>
<a name="l03322"></a>03322 <span class="comment">     * @public</span>
<a name="l03323"></a>03323 <span class="comment">     * @since 1.5</span>
<a name="l03324"></a>03324 <span class="comment">     * @see SetLeftMargin(), SetRightMargin(), SetAutoPageBreak(), SetMargins()</span>
<a name="l03325"></a>03325 <span class="comment">     */</span>
<a name="l03326"></a><a class="code" href="classTCPDF.html#a10b35d62b1ca2a4c8726aa910ccf7f57">03326</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a10b35d62b1ca2a4c8726aa910ccf7f57" title="Defines the top margin.">SetTopMargin</a>($margin) {
<a name="l03327"></a>03327         <span class="comment">//Set top margin</span>
<a name="l03328"></a>03328         $this-&gt;tMargin = $margin;
<a name="l03329"></a>03329         <span class="keywordflow">if</span> (($this-&gt;page &gt; 0) AND ($this-&gt;y &lt; $margin)) {
<a name="l03330"></a>03330             $this-&gt;y = $margin;
<a name="l03331"></a>03331         }
<a name="l03332"></a>03332     }
<a name="l03333"></a>03333 <span class="comment"></span>
<a name="l03334"></a>03334 <span class="comment">    /**</span>
<a name="l03335"></a>03335 <span class="comment">     * Defines the right margin. The method can be called before creating the first page.</span>
<a name="l03336"></a>03336 <span class="comment">     * @param $margin (float) The margin.</span>
<a name="l03337"></a>03337 <span class="comment">     * @public</span>
<a name="l03338"></a>03338 <span class="comment">     * @since 1.5</span>
<a name="l03339"></a>03339 <span class="comment">     * @see SetLeftMargin(), SetTopMargin(), SetAutoPageBreak(), SetMargins()</span>
<a name="l03340"></a>03340 <span class="comment">     */</span>
<a name="l03341"></a><a class="code" href="classTCPDF.html#a3cc157ddb157c99b7001bead20c6e7b0">03341</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3cc157ddb157c99b7001bead20c6e7b0" title="Defines the right margin.">SetRightMargin</a>($margin) {
<a name="l03342"></a>03342         $this-&gt;rMargin = $margin;
<a name="l03343"></a>03343         <span class="keywordflow">if</span> (($this-&gt;page &gt; 0) AND ($this-&gt;x &gt; ($this-&gt;w - $margin))) {
<a name="l03344"></a>03344             $this-&gt;x = $this-&gt;w - $margin;
<a name="l03345"></a>03345         }
<a name="l03346"></a>03346     }
<a name="l03347"></a>03347 <span class="comment"></span>
<a name="l03348"></a>03348 <span class="comment">    /**</span>
<a name="l03349"></a>03349 <span class="comment">     * Set the same internal Cell padding for top, right, bottom, left-</span>
<a name="l03350"></a>03350 <span class="comment">     * @param $pad (float) internal padding.</span>
<a name="l03351"></a>03351 <span class="comment">     * @public</span>
<a name="l03352"></a>03352 <span class="comment">     * @since 2.1.000 (2008-01-09)</span>
<a name="l03353"></a>03353 <span class="comment">     * @see getCellPaddings(), setCellPaddings()</span>
<a name="l03354"></a>03354 <span class="comment">     */</span>
<a name="l03355"></a><a class="code" href="classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">03355</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1" title="Set the same internal Cell padding for top, right, bottom, left-.">SetCellPadding</a>($pad) {
<a name="l03356"></a>03356         <span class="keywordflow">if</span> ($pad &gt;= 0) {
<a name="l03357"></a>03357             $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $pad;
<a name="l03358"></a>03358             $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $pad;
<a name="l03359"></a>03359             $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $pad;
<a name="l03360"></a>03360             $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $pad;
<a name="l03361"></a>03361         }
<a name="l03362"></a>03362     }
<a name="l03363"></a>03363 <span class="comment"></span>
<a name="l03364"></a>03364 <span class="comment">    /**</span>
<a name="l03365"></a>03365 <span class="comment">     * Set the internal Cell paddings.</span>
<a name="l03366"></a>03366 <span class="comment">     * @param $left (float) left padding</span>
<a name="l03367"></a>03367 <span class="comment">     * @param $top (float) top padding</span>
<a name="l03368"></a>03368 <span class="comment">     * @param $right (float) right padding</span>
<a name="l03369"></a>03369 <span class="comment">     * @param $bottom (float) bottom padding</span>
<a name="l03370"></a>03370 <span class="comment">     * @public</span>
<a name="l03371"></a>03371 <span class="comment">     * @since 5.9.000 (2010-10-03)</span>
<a name="l03372"></a>03372 <span class="comment">     * @see getCellPaddings(), SetCellPadding()</span>
<a name="l03373"></a>03373 <span class="comment">     */</span>
<a name="l03374"></a><a class="code" href="classTCPDF.html#aba22c5159414bb96cadfa66efd89bc7c">03374</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aba22c5159414bb96cadfa66efd89bc7c" title="Set the internal Cell paddings.">setCellPaddings</a>($left=<span class="stringliteral">&#39;&#39;</span>, $top=<span class="stringliteral">&#39;&#39;</span>, $right=<span class="stringliteral">&#39;&#39;</span>, $bottom=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l03375"></a>03375         <span class="keywordflow">if</span> (($left !== <span class="stringliteral">&#39;&#39;</span>) AND ($left &gt;= 0)) {
<a name="l03376"></a>03376             $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $left;
<a name="l03377"></a>03377         }
<a name="l03378"></a>03378         <span class="keywordflow">if</span> (($top !== <span class="stringliteral">&#39;&#39;</span>) AND ($top &gt;= 0)) {
<a name="l03379"></a>03379             $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $top;
<a name="l03380"></a>03380         }
<a name="l03381"></a>03381         <span class="keywordflow">if</span> (($right !== <span class="stringliteral">&#39;&#39;</span>) AND ($right &gt;= 0)) {
<a name="l03382"></a>03382             $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $right;
<a name="l03383"></a>03383         }
<a name="l03384"></a>03384         <span class="keywordflow">if</span> (($bottom !== <span class="stringliteral">&#39;&#39;</span>) AND ($bottom &gt;= 0)) {
<a name="l03385"></a>03385             $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $bottom;
<a name="l03386"></a>03386         }
<a name="l03387"></a>03387     }
<a name="l03388"></a>03388 <span class="comment"></span>
<a name="l03389"></a>03389 <span class="comment">    /**</span>
<a name="l03390"></a>03390 <span class="comment">     * Get the internal Cell padding array.</span>
<a name="l03391"></a>03391 <span class="comment">     * @return array of padding values</span>
<a name="l03392"></a>03392 <span class="comment">     * @public</span>
<a name="l03393"></a>03393 <span class="comment">     * @since 5.9.000 (2010-10-03)</span>
<a name="l03394"></a>03394 <span class="comment">     * @see setCellPaddings(), SetCellPadding()</span>
<a name="l03395"></a>03395 <span class="comment">     */</span>
<a name="l03396"></a><a class="code" href="classTCPDF.html#ae34b176081245381bd47ba322a3a522e">03396</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae34b176081245381bd47ba322a3a522e" title="Get the internal Cell padding array.">getCellPaddings</a>() {
<a name="l03397"></a>03397         <span class="keywordflow">return</span> $this-&gt;cell_padding;
<a name="l03398"></a>03398     }
<a name="l03399"></a>03399 <span class="comment"></span>
<a name="l03400"></a>03400 <span class="comment">    /**</span>
<a name="l03401"></a>03401 <span class="comment">     * Set the internal Cell margins.</span>
<a name="l03402"></a>03402 <span class="comment">     * @param $left (float) left margin</span>
<a name="l03403"></a>03403 <span class="comment">     * @param $top (float) top margin</span>
<a name="l03404"></a>03404 <span class="comment">     * @param $right (float) right margin</span>
<a name="l03405"></a>03405 <span class="comment">     * @param $bottom (float) bottom margin</span>
<a name="l03406"></a>03406 <span class="comment">     * @public</span>
<a name="l03407"></a>03407 <span class="comment">     * @since 5.9.000 (2010-10-03)</span>
<a name="l03408"></a>03408 <span class="comment">     * @see getCellMargins()</span>
<a name="l03409"></a>03409 <span class="comment">     */</span>
<a name="l03410"></a><a class="code" href="classTCPDF.html#a80e96cb97ad08e7feb952d2e5e8dc36d">03410</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a80e96cb97ad08e7feb952d2e5e8dc36d" title="Set the internal Cell margins.">setCellMargins</a>($left=<span class="stringliteral">&#39;&#39;</span>, $top=<span class="stringliteral">&#39;&#39;</span>, $right=<span class="stringliteral">&#39;&#39;</span>, $bottom=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l03411"></a>03411         <span class="keywordflow">if</span> (($left !== <span class="stringliteral">&#39;&#39;</span>) AND ($left &gt;= 0)) {
<a name="l03412"></a>03412             $this-&gt;cell_margin[<span class="charliteral">&#39;L&#39;</span>] = $left;
<a name="l03413"></a>03413         }
<a name="l03414"></a>03414         <span class="keywordflow">if</span> (($top !== <span class="stringliteral">&#39;&#39;</span>) AND ($top &gt;= 0)) {
<a name="l03415"></a>03415             $this-&gt;cell_margin[<span class="charliteral">&#39;T&#39;</span>] = $top;
<a name="l03416"></a>03416         }
<a name="l03417"></a>03417         <span class="keywordflow">if</span> (($right !== <span class="stringliteral">&#39;&#39;</span>) AND ($right &gt;= 0)) {
<a name="l03418"></a>03418             $this-&gt;cell_margin[<span class="charliteral">&#39;R&#39;</span>] = $right;
<a name="l03419"></a>03419         }
<a name="l03420"></a>03420         <span class="keywordflow">if</span> (($bottom !== <span class="stringliteral">&#39;&#39;</span>) AND ($bottom &gt;= 0)) {
<a name="l03421"></a>03421             $this-&gt;cell_margin[<span class="charliteral">&#39;B&#39;</span>] = $bottom;
<a name="l03422"></a>03422         }
<a name="l03423"></a>03423     }
<a name="l03424"></a>03424 <span class="comment"></span>
<a name="l03425"></a>03425 <span class="comment">    /**</span>
<a name="l03426"></a>03426 <span class="comment">     * Get the internal Cell margin array.</span>
<a name="l03427"></a>03427 <span class="comment">     * @return array of margin values</span>
<a name="l03428"></a>03428 <span class="comment">     * @public</span>
<a name="l03429"></a>03429 <span class="comment">     * @since 5.9.000 (2010-10-03)</span>
<a name="l03430"></a>03430 <span class="comment">     * @see setCellMargins()</span>
<a name="l03431"></a>03431 <span class="comment">     */</span>
<a name="l03432"></a><a class="code" href="classTCPDF.html#aebb91d5d8046cf1b91b65d3a2d8694be">03432</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aebb91d5d8046cf1b91b65d3a2d8694be" title="Get the internal Cell margin array.">getCellMargins</a>() {
<a name="l03433"></a>03433         <span class="keywordflow">return</span> $this-&gt;cell_margin;
<a name="l03434"></a>03434     }
<a name="l03435"></a>03435 <span class="comment"></span>
<a name="l03436"></a>03436 <span class="comment">    /**</span>
<a name="l03437"></a>03437 <span class="comment">     * Adjust the internal Cell padding array to take account of the line width.</span>
<a name="l03438"></a>03438 <span class="comment">     * @param $brd (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l03439"></a>03439 <span class="comment">     * @return array of adjustments</span>
<a name="l03440"></a>03440 <span class="comment">     * @public</span>
<a name="l03441"></a>03441 <span class="comment">     * @since 5.9.000 (2010-10-03)</span>
<a name="l03442"></a>03442 <span class="comment">     */</span>
<a name="l03443"></a><a class="code" href="classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4">03443</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4" title="Adjust the internal Cell padding array to take account of the line width.">adjustCellPadding</a>($brd=0) {
<a name="l03444"></a>03444         <span class="keywordflow">if</span> (empty($brd)) {
<a name="l03445"></a>03445             <span class="keywordflow">return</span>;
<a name="l03446"></a>03446         }
<a name="l03447"></a>03447         <span class="keywordflow">if</span> (is_string($brd)) {
<a name="l03448"></a>03448             <span class="comment">// convert string to array</span>
<a name="l03449"></a>03449             $slen = strlen($brd);
<a name="l03450"></a>03450             $newbrd = array();
<a name="l03451"></a>03451             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $slen; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l03452"></a>03452                 $newbrd[$brd[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]] = <span class="keyword">true</span>;
<a name="l03453"></a>03453             }
<a name="l03454"></a>03454             $brd = $newbrd;
<a name="l03455"></a>03455         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($brd === 1) OR ($brd === <span class="keyword">true</span>) OR (is_numeric($brd) AND (intval($brd) &gt; 0))) {
<a name="l03456"></a>03456             $brd = array(<span class="stringliteral">&#39;LRTB&#39;</span> =&gt; <span class="keyword">true</span>);
<a name="l03457"></a>03457         }
<a name="l03458"></a>03458         <span class="keywordflow">if</span> (!is_array($brd)) {
<a name="l03459"></a>03459             <span class="keywordflow">return</span>;
<a name="l03460"></a>03460         }
<a name="l03461"></a>03461         <span class="comment">// store current cell padding</span>
<a name="l03462"></a>03462         $cp = $this-&gt;cell_padding;
<a name="l03463"></a>03463         <span class="comment">// select border mode</span>
<a name="l03464"></a>03464         <span class="keywordflow">if</span> (isset($brd[<span class="stringliteral">&#39;mode&#39;</span>])) {
<a name="l03465"></a>03465             <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> = $brd[<span class="stringliteral">&#39;mode&#39;</span>];
<a name="l03466"></a>03466             unset($brd[<span class="stringliteral">&#39;mode&#39;</span>]);
<a name="l03467"></a>03467         } <span class="keywordflow">else</span> {
<a name="l03468"></a>03468             <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> = <span class="stringliteral">&#39;normal&#39;</span>;
<a name="l03469"></a>03469         }
<a name="l03470"></a>03470         <span class="comment">// process borders</span>
<a name="l03471"></a>03471         <span class="keywordflow">foreach</span> ($brd as $border =&gt; $style) {
<a name="l03472"></a>03472             $line_width = $this-&gt;LineWidth;
<a name="l03473"></a>03473             <span class="keywordflow">if</span> (is_array($style) AND isset($style[<span class="stringliteral">&#39;width&#39;</span>])) {
<a name="l03474"></a>03474                 <span class="comment">// get border width</span>
<a name="l03475"></a>03475                 $line_width = $style[<span class="stringliteral">&#39;width&#39;</span>];
<a name="l03476"></a>03476             }
<a name="l03477"></a>03477             $adj = 0; <span class="comment">// line width inside the cell</span>
<a name="l03478"></a>03478             <span class="keywordflow">switch</span> (<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>) {
<a name="l03479"></a>03479                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;ext&#39;</span>: {
<a name="l03480"></a>03480                     $adj = 0;
<a name="l03481"></a>03481                     <span class="keywordflow">break</span>;
<a name="l03482"></a>03482                 }
<a name="l03483"></a>03483                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;int&#39;</span>: {
<a name="l03484"></a>03484                     $adj = $line_width;
<a name="l03485"></a>03485                     <span class="keywordflow">break</span>;
<a name="l03486"></a>03486                 }
<a name="l03487"></a>03487                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>:
<a name="l03488"></a>03488                 <span class="keywordflow">default</span>: {
<a name="l03489"></a>03489                     $adj = ($line_width / 2);
<a name="l03490"></a>03490                     <span class="keywordflow">break</span>;
<a name="l03491"></a>03491                 }
<a name="l03492"></a>03492             }
<a name="l03493"></a>03493             <span class="comment">// correct internal cell padding if required to avoid overlap between text and lines</span>
<a name="l03494"></a>03494             <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) AND ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] &lt; $adj)) {
<a name="l03495"></a>03495                 $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $adj;
<a name="l03496"></a>03496             }
<a name="l03497"></a>03497             <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>) AND ($this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] &lt; $adj)) {
<a name="l03498"></a>03498                 $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $adj;
<a name="l03499"></a>03499             }
<a name="l03500"></a>03500             <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) AND ($this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] &lt; $adj)) {
<a name="l03501"></a>03501                 $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $adj;
<a name="l03502"></a>03502             }
<a name="l03503"></a>03503             <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>) AND ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] &lt; $adj)) {
<a name="l03504"></a>03504                 $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $adj;
<a name="l03505"></a>03505             }
<a name="l03506"></a>03506         }
<a name="l03507"></a>03507         <span class="keywordflow">return</span> array(<span class="charliteral">&#39;T&#39;</span> =&gt; ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] - $cp[<span class="charliteral">&#39;T&#39;</span>]), <span class="charliteral">&#39;R&#39;</span> =&gt; ($this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] - $cp[<span class="charliteral">&#39;R&#39;</span>]), <span class="charliteral">&#39;B&#39;</span> =&gt; ($this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] - $cp[<span class="charliteral">&#39;B&#39;</span>]), <span class="charliteral">&#39;L&#39;</span> =&gt; ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $cp[<span class="charliteral">&#39;L&#39;</span>]));
<a name="l03508"></a>03508     }
<a name="l03509"></a>03509 <span class="comment"></span>
<a name="l03510"></a>03510 <span class="comment">    /**</span>
<a name="l03511"></a>03511 <span class="comment">     * Enables or disables the automatic page breaking mode. When enabling, the second parameter is the distance from the bottom of the page that defines the triggering limit. By default, the mode is on and the margin is 2 cm.</span>
<a name="l03512"></a>03512 <span class="comment">     * @param $auto (boolean) Boolean indicating if mode should be on or off.</span>
<a name="l03513"></a>03513 <span class="comment">     * @param $margin (float) Distance from the bottom of the page.</span>
<a name="l03514"></a>03514 <span class="comment">     * @public</span>
<a name="l03515"></a>03515 <span class="comment">     * @since 1.0</span>
<a name="l03516"></a>03516 <span class="comment">     * @see Cell(), MultiCell(), AcceptPageBreak()</span>
<a name="l03517"></a>03517 <span class="comment">     */</span>
<a name="l03518"></a><a class="code" href="classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9">03518</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9" title="Enables or disables the automatic page breaking mode.">SetAutoPageBreak</a>($auto, $margin=0) {
<a name="l03519"></a>03519         $this-&gt;AutoPageBreak = $auto ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l03520"></a>03520         $this-&gt;bMargin = $margin;
<a name="l03521"></a>03521         $this-&gt;PageBreakTrigger = $this-&gt;h - $margin;
<a name="l03522"></a>03522     }
<a name="l03523"></a>03523 <span class="comment"></span>
<a name="l03524"></a>03524 <span class="comment">    /**</span>
<a name="l03525"></a>03525 <span class="comment">     * Return the auto-page-break mode (true or false).</span>
<a name="l03526"></a>03526 <span class="comment">     * @return boolean auto-page-break mode</span>
<a name="l03527"></a>03527 <span class="comment">     * @public</span>
<a name="l03528"></a>03528 <span class="comment">     * @since 5.9.088</span>
<a name="l03529"></a>03529 <span class="comment">     */</span>
<a name="l03530"></a><a class="code" href="classTCPDF.html#a73f32971feef0aa29e061bac60a90e7a">03530</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a73f32971feef0aa29e061bac60a90e7a" title="Return the auto-page-break mode (true or false).">getAutoPageBreak</a>() {
<a name="l03531"></a>03531         <span class="keywordflow">return</span> $this-&gt;AutoPageBreak;
<a name="l03532"></a>03532     }
<a name="l03533"></a>03533 <span class="comment"></span>
<a name="l03534"></a>03534 <span class="comment">    /**</span>
<a name="l03535"></a>03535 <span class="comment">     * Defines the way the document is to be displayed by the viewer.</span>
<a name="l03536"></a>03536 <span class="comment">     * @param $zoom (mixed) The zoom to use. It can be one of the following string values or a number indicating the zooming factor to use. &lt;ul&gt;&lt;li&gt;fullpage: displays the entire page on screen &lt;/li&gt;&lt;li&gt;fullwidth: uses maximum width of window&lt;/li&gt;&lt;li&gt;real: uses real size (equivalent to 100% zoom)&lt;/li&gt;&lt;li&gt;default: uses viewer default mode&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l03537"></a>03537 <span class="comment">     * @param $layout (string) The page layout. Possible values are:&lt;ul&gt;&lt;li&gt;SinglePage Display one page at a time&lt;/li&gt;&lt;li&gt;OneColumn Display the pages in one column&lt;/li&gt;&lt;li&gt;TwoColumnLeft Display the pages in two columns, with odd-numbered pages on the left&lt;/li&gt;&lt;li&gt;TwoColumnRight Display the pages in two columns, with odd-numbered pages on the right&lt;/li&gt;&lt;li&gt;TwoPageLeft (PDF 1.5) Display the pages two at a time, with odd-numbered pages on the left&lt;/li&gt;&lt;li&gt;TwoPageRight (PDF 1.5) Display the pages two at a time, with odd-numbered pages on the right&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l03538"></a>03538 <span class="comment">     * @param $mode (string) A name object specifying how the document should be displayed when opened:&lt;ul&gt;&lt;li&gt;UseNone Neither document outline nor thumbnail images visible&lt;/li&gt;&lt;li&gt;UseOutlines Document outline visible&lt;/li&gt;&lt;li&gt;UseThumbs Thumbnail images visible&lt;/li&gt;&lt;li&gt;FullScreen Full-screen mode, with no menu bar, window controls, or any other window visible&lt;/li&gt;&lt;li&gt;UseOC (PDF 1.5) Optional content group panel visible&lt;/li&gt;&lt;li&gt;UseAttachments (PDF 1.6) Attachments panel visible&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l03539"></a>03539 <span class="comment">     * @public</span>
<a name="l03540"></a>03540 <span class="comment">     * @since 1.2</span>
<a name="l03541"></a>03541 <span class="comment">     */</span>
<a name="l03542"></a><a class="code" href="classTCPDF.html#ad99d9dea88f659fedf9fe11f30586a99">03542</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad99d9dea88f659fedf9fe11f30586a99" title="Defines the way the document is to be displayed by the viewer.">SetDisplayMode</a>($zoom, $layout=<span class="stringliteral">&#39;SinglePage&#39;</span>, <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>=<span class="stringliteral">&#39;UseNone&#39;</span>) {
<a name="l03543"></a>03543         <span class="keywordflow">if</span> (($zoom == <span class="stringliteral">&#39;fullpage&#39;</span>) OR ($zoom == <span class="stringliteral">&#39;fullwidth&#39;</span>) OR ($zoom == <span class="stringliteral">&#39;real&#39;</span>) OR ($zoom == <span class="stringliteral">&#39;default&#39;</span>) OR (!is_string($zoom))) {
<a name="l03544"></a>03544             $this-&gt;ZoomMode = $zoom;
<a name="l03545"></a>03545         } <span class="keywordflow">else</span> {
<a name="l03546"></a>03546             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Incorrect zoom display mode: &#39;</span>.$zoom);
<a name="l03547"></a>03547         }
<a name="l03548"></a>03548         <span class="keywordflow">switch</span> ($layout) {
<a name="l03549"></a>03549             <span class="keywordflow">case</span> <span class="stringliteral">&#39;default&#39;</span>:
<a name="l03550"></a>03550             <span class="keywordflow">case</span> <span class="stringliteral">&#39;single&#39;</span>:
<a name="l03551"></a>03551             <span class="keywordflow">case</span> <span class="stringliteral">&#39;SinglePage&#39;</span>: {
<a name="l03552"></a>03552                 $this-&gt;LayoutMode = <span class="stringliteral">&#39;SinglePage&#39;</span>;
<a name="l03553"></a>03553                 <span class="keywordflow">break</span>;
<a name="l03554"></a>03554             }
<a name="l03555"></a>03555             <span class="keywordflow">case</span> <span class="stringliteral">&#39;continuous&#39;</span>:
<a name="l03556"></a>03556             <span class="keywordflow">case</span> <span class="stringliteral">&#39;OneColumn&#39;</span>: {
<a name="l03557"></a>03557                 $this-&gt;LayoutMode = <span class="stringliteral">&#39;OneColumn&#39;</span>;
<a name="l03558"></a>03558                 <span class="keywordflow">break</span>;
<a name="l03559"></a>03559             }
<a name="l03560"></a>03560             <span class="keywordflow">case</span> <span class="stringliteral">&#39;two&#39;</span>:
<a name="l03561"></a>03561             <span class="keywordflow">case</span> <span class="stringliteral">&#39;TwoColumnLeft&#39;</span>: {
<a name="l03562"></a>03562                 $this-&gt;LayoutMode = <span class="stringliteral">&#39;TwoColumnLeft&#39;</span>;
<a name="l03563"></a>03563                 <span class="keywordflow">break</span>;
<a name="l03564"></a>03564             }
<a name="l03565"></a>03565             <span class="keywordflow">case</span> <span class="stringliteral">&#39;TwoColumnRight&#39;</span>: {
<a name="l03566"></a>03566                 $this-&gt;LayoutMode = <span class="stringliteral">&#39;TwoColumnRight&#39;</span>;
<a name="l03567"></a>03567                 <span class="keywordflow">break</span>;
<a name="l03568"></a>03568             }
<a name="l03569"></a>03569             <span class="keywordflow">case</span> <span class="stringliteral">&#39;TwoPageLeft&#39;</span>: {
<a name="l03570"></a>03570                 $this-&gt;LayoutMode = <span class="stringliteral">&#39;TwoPageLeft&#39;</span>;
<a name="l03571"></a>03571                 <span class="keywordflow">break</span>;
<a name="l03572"></a>03572             }
<a name="l03573"></a>03573             <span class="keywordflow">case</span> <span class="stringliteral">&#39;TwoPageRight&#39;</span>: {
<a name="l03574"></a>03574                 $this-&gt;LayoutMode = <span class="stringliteral">&#39;TwoPageRight&#39;</span>;
<a name="l03575"></a>03575                 <span class="keywordflow">break</span>;
<a name="l03576"></a>03576             }
<a name="l03577"></a>03577             <span class="keywordflow">default</span>: {
<a name="l03578"></a>03578                 $this-&gt;LayoutMode = <span class="stringliteral">&#39;SinglePage&#39;</span>;
<a name="l03579"></a>03579             }
<a name="l03580"></a>03580         }
<a name="l03581"></a>03581         <span class="keywordflow">switch</span> (<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>) {
<a name="l03582"></a>03582             <span class="keywordflow">case</span> <span class="stringliteral">&#39;UseNone&#39;</span>: {
<a name="l03583"></a>03583                 $this-&gt;PageMode = <span class="stringliteral">&#39;UseNone&#39;</span>;
<a name="l03584"></a>03584                 <span class="keywordflow">break</span>;
<a name="l03585"></a>03585             }
<a name="l03586"></a>03586             <span class="keywordflow">case</span> <span class="stringliteral">&#39;UseOutlines&#39;</span>: {
<a name="l03587"></a>03587                 $this-&gt;PageMode = <span class="stringliteral">&#39;UseOutlines&#39;</span>;
<a name="l03588"></a>03588                 <span class="keywordflow">break</span>;
<a name="l03589"></a>03589             }
<a name="l03590"></a>03590             <span class="keywordflow">case</span> <span class="stringliteral">&#39;UseThumbs&#39;</span>: {
<a name="l03591"></a>03591                 $this-&gt;PageMode = <span class="stringliteral">&#39;UseThumbs&#39;</span>;
<a name="l03592"></a>03592                 <span class="keywordflow">break</span>;
<a name="l03593"></a>03593             }
<a name="l03594"></a>03594             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FullScreen&#39;</span>: {
<a name="l03595"></a>03595                 $this-&gt;PageMode = <span class="stringliteral">&#39;FullScreen&#39;</span>;
<a name="l03596"></a>03596                 <span class="keywordflow">break</span>;
<a name="l03597"></a>03597             }
<a name="l03598"></a>03598             <span class="keywordflow">case</span> <span class="stringliteral">&#39;UseOC&#39;</span>: {
<a name="l03599"></a>03599                 $this-&gt;PageMode = <span class="stringliteral">&#39;UseOC&#39;</span>;
<a name="l03600"></a>03600                 <span class="keywordflow">break</span>;
<a name="l03601"></a>03601             }
<a name="l03602"></a>03602             <span class="keywordflow">case</span> <span class="stringliteral">&#39;&#39;</span>: {
<a name="l03603"></a>03603                 $this-&gt;PageMode = <span class="stringliteral">&#39;UseAttachments&#39;</span>;
<a name="l03604"></a>03604                 <span class="keywordflow">break</span>;
<a name="l03605"></a>03605             }
<a name="l03606"></a>03606             <span class="keywordflow">default</span>: {
<a name="l03607"></a>03607                 $this-&gt;PageMode = <span class="stringliteral">&#39;UseNone&#39;</span>;
<a name="l03608"></a>03608             }
<a name="l03609"></a>03609         }
<a name="l03610"></a>03610     }
<a name="l03611"></a>03611 <span class="comment"></span>
<a name="l03612"></a>03612 <span class="comment">    /**</span>
<a name="l03613"></a>03613 <span class="comment">     * Activates or deactivates page compression. When activated, the internal representation of each page is compressed, which leads to a compression ratio of about 2 for the resulting document. Compression is on by default.</span>
<a name="l03614"></a>03614 <span class="comment">     * Note: the Zlib extension is required for this feature. If not present, compression will be turned off.</span>
<a name="l03615"></a>03615 <span class="comment">     * @param $compress (boolean) Boolean indicating if compression must be enabled.</span>
<a name="l03616"></a>03616 <span class="comment">     * @public</span>
<a name="l03617"></a>03617 <span class="comment">     * @since 1.4</span>
<a name="l03618"></a>03618 <span class="comment">     */</span>
<a name="l03619"></a><a class="code" href="classTCPDF.html#a6140a1ff2c5ed3f490592b6917f5adf3">03619</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6140a1ff2c5ed3f490592b6917f5adf3" title="Activates or deactivates page compression.">SetCompression</a>(<a class="code" href="classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0" title="Compression flag.">$compress</a>=<span class="keyword">true</span>) {
<a name="l03620"></a>03620         <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;gzcompress&#39;</span>)) {
<a name="l03621"></a>03621             $this-&gt;compress = <a class="code" href="classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0" title="Compression flag.">$compress</a> ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l03622"></a>03622         } <span class="keywordflow">else</span> {
<a name="l03623"></a>03623             $this-&gt;compress = <span class="keyword">false</span>;
<a name="l03624"></a>03624         }
<a name="l03625"></a>03625     }
<a name="l03626"></a>03626 <span class="comment"></span>
<a name="l03627"></a>03627 <span class="comment">    /**</span>
<a name="l03628"></a>03628 <span class="comment">     * Set flag to force sRGB_IEC61966-2.1 black scaled ICC color profile for the whole document.</span>
<a name="l03629"></a>03629 <span class="comment">     * @param $mode (boolean) If true force sRGB output intent.</span>
<a name="l03630"></a>03630 <span class="comment">     * @public</span>
<a name="l03631"></a>03631 <span class="comment">     * @since 5.9.121 (2011-09-28)</span>
<a name="l03632"></a>03632 <span class="comment">     */</span>
<a name="l03633"></a><a class="code" href="classTCPDF.html#a304b018598f42b236e0720a97a192e04">03633</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a304b018598f42b236e0720a97a192e04" title="Set flag to force sRGB_IEC61966-2.1 black scaled ICC color profile for the whole document.">setSRGBmode</a>(<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>=<span class="keyword">false</span>) {
<a name="l03634"></a>03634         $this-&gt;force_srgb = <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l03635"></a>03635     }
<a name="l03636"></a>03636 <span class="comment"></span>
<a name="l03637"></a>03637 <span class="comment">    /**</span>
<a name="l03638"></a>03638 <span class="comment">     * Turn on/off Unicode mode for document information dictionary (meta tags).</span>
<a name="l03639"></a>03639 <span class="comment">     * This has effect only when unicode mode is set to false.</span>
<a name="l03640"></a>03640 <span class="comment">     * @param $unicode (boolean) if true set the meta information in Unicode</span>
<a name="l03641"></a>03641 <span class="comment">     * @since 5.9.027 (2010-12-01)</span>
<a name="l03642"></a>03642 <span class="comment">     * @public</span>
<a name="l03643"></a>03643 <span class="comment">     */</span>
<a name="l03644"></a><a class="code" href="classTCPDF.html#aa63bed5d5f585edcbfedceecea15a1db">03644</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa63bed5d5f585edcbfedceecea15a1db" title="Turn on/off Unicode mode for document information dictionary (meta tags).">SetDocInfoUnicode</a>(<a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>=<span class="keyword">true</span>) {
<a name="l03645"></a>03645         $this-&gt;docinfounicode = <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a> ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l03646"></a>03646     }
<a name="l03647"></a>03647 <span class="comment"></span>
<a name="l03648"></a>03648 <span class="comment">    /**</span>
<a name="l03649"></a>03649 <span class="comment">     * Defines the title of the document.</span>
<a name="l03650"></a>03650 <span class="comment">     * @param $title (string) The title.</span>
<a name="l03651"></a>03651 <span class="comment">     * @public</span>
<a name="l03652"></a>03652 <span class="comment">     * @since 1.2</span>
<a name="l03653"></a>03653 <span class="comment">     * @see SetAuthor(), SetCreator(), SetKeywords(), SetSubject()</span>
<a name="l03654"></a>03654 <span class="comment">     */</span>
<a name="l03655"></a><a class="code" href="classTCPDF.html#ac467f297fed79882bcab2bf20d423efb">03655</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac467f297fed79882bcab2bf20d423efb" title="Defines the title of the document.">SetTitle</a>(<a class="code" href="classTCPDF.html#a63acf0babc0299784cbb54354329a734" title="Document title.">$title</a>) {
<a name="l03656"></a>03656         $this-&gt;title = <a class="code" href="classTCPDF.html#a63acf0babc0299784cbb54354329a734" title="Document title.">$title</a>;
<a name="l03657"></a>03657     }
<a name="l03658"></a>03658 <span class="comment"></span>
<a name="l03659"></a>03659 <span class="comment">    /**</span>
<a name="l03660"></a>03660 <span class="comment">     * Defines the subject of the document.</span>
<a name="l03661"></a>03661 <span class="comment">     * @param $subject (string) The subject.</span>
<a name="l03662"></a>03662 <span class="comment">     * @public</span>
<a name="l03663"></a>03663 <span class="comment">     * @since 1.2</span>
<a name="l03664"></a>03664 <span class="comment">     * @see SetAuthor(), SetCreator(), SetKeywords(), SetTitle()</span>
<a name="l03665"></a>03665 <span class="comment">     */</span>
<a name="l03666"></a><a class="code" href="classTCPDF.html#aca6e7dacb9814682736ba2c7129be338">03666</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aca6e7dacb9814682736ba2c7129be338" title="Defines the subject of the document.">SetSubject</a>(<a class="code" href="classTCPDF.html#abb4e21366924e76df3400312434d95e1" title="Document subject.">$subject</a>) {
<a name="l03667"></a>03667         $this-&gt;subject = <a class="code" href="classTCPDF.html#abb4e21366924e76df3400312434d95e1" title="Document subject.">$subject</a>;
<a name="l03668"></a>03668     }
<a name="l03669"></a>03669 <span class="comment"></span>
<a name="l03670"></a>03670 <span class="comment">    /**</span>
<a name="l03671"></a>03671 <span class="comment">     * Defines the author of the document.</span>
<a name="l03672"></a>03672 <span class="comment">     * @param $author (string) The name of the author.</span>
<a name="l03673"></a>03673 <span class="comment">     * @public</span>
<a name="l03674"></a>03674 <span class="comment">     * @since 1.2</span>
<a name="l03675"></a>03675 <span class="comment">     * @see SetCreator(), SetKeywords(), SetSubject(), SetTitle()</span>
<a name="l03676"></a>03676 <span class="comment">     */</span>
<a name="l03677"></a><a class="code" href="classTCPDF.html#a983e0a8da2a4d76c24efb0a91281712a">03677</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a983e0a8da2a4d76c24efb0a91281712a" title="Defines the author of the document.">SetAuthor</a>(<a class="code" href="classTCPDF.html#a25c26ce9fab4b1d38773ab3629d985aa" title="Document author.">$author</a>) {
<a name="l03678"></a>03678         $this-&gt;author = <a class="code" href="classTCPDF.html#a25c26ce9fab4b1d38773ab3629d985aa" title="Document author.">$author</a>;
<a name="l03679"></a>03679     }
<a name="l03680"></a>03680 <span class="comment"></span>
<a name="l03681"></a>03681 <span class="comment">    /**</span>
<a name="l03682"></a>03682 <span class="comment">     * Associates keywords with the document, generally in the form &#39;keyword1 keyword2 ...&#39;.</span>
<a name="l03683"></a>03683 <span class="comment">     * @param $keywords (string) The list of keywords.</span>
<a name="l03684"></a>03684 <span class="comment">     * @public</span>
<a name="l03685"></a>03685 <span class="comment">     * @since 1.2</span>
<a name="l03686"></a>03686 <span class="comment">     * @see SetAuthor(), SetCreator(), SetSubject(), SetTitle()</span>
<a name="l03687"></a>03687 <span class="comment">     */</span>
<a name="l03688"></a><a class="code" href="classTCPDF.html#afbe8a897cf05ec784297f9b660c698b7">03688</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#afbe8a897cf05ec784297f9b660c698b7" title="Associates keywords with the document, generally in the form &#39;keyword1 keyword2 ...&#39;.">SetKeywords</a>(<a class="code" href="classTCPDF.html#a752bede1485e51bff5ad315ca83c804d" title="Document keywords.">$keywords</a>) {
<a name="l03689"></a>03689         $this-&gt;keywords = <a class="code" href="classTCPDF.html#a752bede1485e51bff5ad315ca83c804d" title="Document keywords.">$keywords</a>;
<a name="l03690"></a>03690     }
<a name="l03691"></a>03691 <span class="comment"></span>
<a name="l03692"></a>03692 <span class="comment">    /**</span>
<a name="l03693"></a>03693 <span class="comment">     * Defines the creator of the document. This is typically the name of the application that generates the PDF.</span>
<a name="l03694"></a>03694 <span class="comment">     * @param $creator (string) The name of the creator.</span>
<a name="l03695"></a>03695 <span class="comment">     * @public</span>
<a name="l03696"></a>03696 <span class="comment">     * @since 1.2</span>
<a name="l03697"></a>03697 <span class="comment">     * @see SetAuthor(), SetKeywords(), SetSubject(), SetTitle()</span>
<a name="l03698"></a>03698 <span class="comment">     */</span>
<a name="l03699"></a><a class="code" href="classTCPDF.html#a1df083d5359c42f8b124771f1f92d9fa">03699</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1df083d5359c42f8b124771f1f92d9fa" title="Defines the creator of the document.">SetCreator</a>(<a class="code" href="classTCPDF.html#a79a8b6ca37c76f3d5ebfb26be77613db" title="Document creator.">$creator</a>) {
<a name="l03700"></a>03700         $this-&gt;creator = <a class="code" href="classTCPDF.html#a79a8b6ca37c76f3d5ebfb26be77613db" title="Document creator.">$creator</a>;
<a name="l03701"></a>03701     }
<a name="l03702"></a>03702 <span class="comment"></span>
<a name="l03703"></a>03703 <span class="comment">    /**</span>
<a name="l03704"></a>03704 <span class="comment">     * This method is automatically called in case of fatal error; it simply outputs the message and halts the execution. An inherited class may override it to customize the error handling but should always halt the script, or the resulting document would probably be invalid.</span>
<a name="l03705"></a>03705 <span class="comment">     * 2004-06-11 :: Nicola Asuni : changed bold tag with strong</span>
<a name="l03706"></a>03706 <span class="comment">     * @param $msg (string) The error message</span>
<a name="l03707"></a>03707 <span class="comment">     * @public</span>
<a name="l03708"></a>03708 <span class="comment">     * @since 1.0</span>
<a name="l03709"></a>03709 <span class="comment">     */</span>
<a name="l03710"></a><a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">03710</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>($msg) {
<a name="l03711"></a>03711         <span class="comment">// unset all class variables</span>
<a name="l03712"></a>03712         $this-&gt;<a class="code" href="classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa" title="Unset all class variables except the following critical variables: internal_encoding, state, bufferlen, buffer and diskcache.">_destroy</a>(<span class="keyword">true</span>);
<a name="l03713"></a>03713         <span class="comment">// exit program and print error</span>
<a name="l03714"></a>03714         die(<span class="stringliteral">&#39;&lt;strong&gt;TCPDF ERROR: &lt;/strong&gt;&#39;</span>.$msg);
<a name="l03715"></a>03715     }
<a name="l03716"></a>03716 <span class="comment"></span>
<a name="l03717"></a>03717 <span class="comment">    /**</span>
<a name="l03718"></a>03718 <span class="comment">     * This method begins the generation of the PDF document.</span>
<a name="l03719"></a>03719 <span class="comment">     * It is not necessary to call it explicitly because AddPage() does it automatically.</span>
<a name="l03720"></a>03720 <span class="comment">     * Note: no page is created by this method</span>
<a name="l03721"></a>03721 <span class="comment">     * @public</span>
<a name="l03722"></a>03722 <span class="comment">     * @since 1.0</span>
<a name="l03723"></a>03723 <span class="comment">     * @see AddPage(), Close()</span>
<a name="l03724"></a>03724 <span class="comment">     */</span>
<a name="l03725"></a><a class="code" href="classTCPDF.html#a58f93b800daf9a608c3c1ad90a69e46e">03725</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a58f93b800daf9a608c3c1ad90a69e46e" title="This method begins the generation of the PDF document.">Open</a>() {
<a name="l03726"></a>03726         $this-&gt;state = 1;
<a name="l03727"></a>03727     }
<a name="l03728"></a>03728 <span class="comment"></span>
<a name="l03729"></a>03729 <span class="comment">    /**</span>
<a name="l03730"></a>03730 <span class="comment">     * Terminates the PDF document.</span>
<a name="l03731"></a>03731 <span class="comment">     * It is not necessary to call this method explicitly because Output() does it automatically.</span>
<a name="l03732"></a>03732 <span class="comment">     * If the document contains no page, AddPage() is called to prevent from getting an invalid document.</span>
<a name="l03733"></a>03733 <span class="comment">     * @public</span>
<a name="l03734"></a>03734 <span class="comment">     * @since 1.0</span>
<a name="l03735"></a>03735 <span class="comment">     * @see Open(), Output()</span>
<a name="l03736"></a>03736 <span class="comment">     */</span>
<a name="l03737"></a><a class="code" href="classTCPDF.html#a2ea842192062587293c25981098c820c">03737</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2ea842192062587293c25981098c820c" title="Terminates the PDF document.">Close</a>() {
<a name="l03738"></a>03738         <span class="keywordflow">if</span> ($this-&gt;state == 3) {
<a name="l03739"></a>03739             <span class="keywordflow">return</span>;
<a name="l03740"></a>03740         }
<a name="l03741"></a>03741         <span class="keywordflow">if</span> ($this-&gt;page == 0) {
<a name="l03742"></a>03742             $this-&gt;<a class="code" href="classTCPDF.html#a5171e20b366b74523709d84c349c1ced" title="Adds a new page to the document.">AddPage</a>();
<a name="l03743"></a>03743         }
<a name="l03744"></a>03744         $this-&gt;<a class="code" href="classTCPDF.html#a996258e3c16a3bb8de1f5c1ff8b8c9d8" title="End the current PDF layer.">endLayer</a>();
<a name="l03745"></a>03745         <span class="comment">// save current graphic settings</span>
<a name="l03746"></a>03746         $gvars = $this-&gt;<a class="code" href="classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a" title="Returns current graphic variables as array.">getGraphicVars</a>();
<a name="l03747"></a>03747         $this-&gt;<a class="code" href="classTCPDF.html#aeb84582f37f9d68c1a9f5723849d0009" title="Set multiple columns of the same size.">setEqualColumns</a>();
<a name="l03748"></a>03748         $this-&gt;lastpage(<span class="keyword">true</span>);
<a name="l03749"></a>03749         $this-&gt;<a class="code" href="classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9" title="Enables or disables the automatic page breaking mode.">SetAutoPageBreak</a>(<span class="keyword">false</span>);
<a name="l03750"></a>03750         $this-&gt;x = 0;
<a name="l03751"></a>03751         $this-&gt;y = $this-&gt;h - (1 / $this-&gt;k);
<a name="l03752"></a>03752         $this-&gt;lMargin = 0;
<a name="l03753"></a>03753         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<span class="charliteral">&#39;q&#39;</span>);
<a name="l03754"></a>03754         $this-&gt;<a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e" title="Sets the font used to print character strings.">SetFont</a>(<span class="stringliteral">&#39;helvetica&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 1);
<a name="l03755"></a>03755         $this-&gt;<a class="code" href="classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107" title="Set Text rendering mode.">setTextRenderingMode</a>(0, <span class="keyword">false</span>, <span class="keyword">false</span>);
<a name="l03756"></a>03756         $msg = <span class="stringliteral">&quot;\x50\x6f\x77\x65\x72\x65\x64\x20\x62\x79\x20\x54\x43\x50\x44\x46\x20\x28\x77\x77\x77\x2e\x74\x63\x70\x64\x66\x2e\x6f\x72\x67\x29&quot;</span>;
<a name="l03757"></a>03757         <a class="code" href="wab_8php.html#a100e2e23c167615e01910e2b186bd894">$lnk</a> = <span class="stringliteral">&quot;\x68\x74\x74\x70\x3a\x2f\x2f\x77\x77\x77\x2e\x74\x63\x70\x64\x66\x2e\x6f\x72\x67&quot;</span>;
<a name="l03758"></a>03758         $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(0, 0, $msg, 0, 0, <span class="charliteral">&#39;L&#39;</span>, 0, <a class="code" href="wab_8php.html#a100e2e23c167615e01910e2b186bd894">$lnk</a>, 0, <span class="keyword">false</span>, <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;B&#39;</span>);
<a name="l03759"></a>03759         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<span class="charliteral">&#39;Q&#39;</span>);
<a name="l03760"></a>03760         <span class="comment">// restore graphic settings</span>
<a name="l03761"></a>03761         $this-&gt;<a class="code" href="classTCPDF.html#a072053646725b19770a795050b3b6221" title="Set graphic variables.">setGraphicVars</a>($gvars);
<a name="l03762"></a>03762         <span class="comment">// close page</span>
<a name="l03763"></a>03763         $this-&gt;<a class="code" href="classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c" title="Terminate the current page.">endPage</a>();
<a name="l03764"></a>03764         <span class="comment">// close document</span>
<a name="l03765"></a>03765         $this-&gt;<a class="code" href="classTCPDF.html#a55c3dfafc6dd5b278d0bc7298e829d77" title="Output end of document (EOF).">_enddoc</a>();
<a name="l03766"></a>03766         <span class="comment">// unset all class variables (except critical ones)</span>
<a name="l03767"></a>03767         $this-&gt;<a class="code" href="classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa" title="Unset all class variables except the following critical variables: internal_encoding, state, bufferlen, buffer and diskcache.">_destroy</a>(<span class="keyword">false</span>);
<a name="l03768"></a>03768     }
<a name="l03769"></a>03769 <span class="comment"></span>
<a name="l03770"></a>03770 <span class="comment">    /**</span>
<a name="l03771"></a>03771 <span class="comment">     * Move pointer at the specified document page and update page dimensions.</span>
<a name="l03772"></a>03772 <span class="comment">     * @param $pnum (int) page number (1 ... numpages)</span>
<a name="l03773"></a>03773 <span class="comment">     * @param $resetmargins (boolean) if true reset left, right, top margins and Y position.</span>
<a name="l03774"></a>03774 <span class="comment">     * @public</span>
<a name="l03775"></a>03775 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l03776"></a>03776 <span class="comment">     * @see getPage(), lastpage(), getNumPages()</span>
<a name="l03777"></a>03777 <span class="comment">     */</span>
<a name="l03778"></a><a class="code" href="classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00">03778</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00" title="Move pointer at the specified document page and update page dimensions.">setPage</a>($pnum, $resetmargins=<span class="keyword">false</span>) {
<a name="l03779"></a>03779         <span class="keywordflow">if</span> (($pnum == $this-&gt;page) AND ($this-&gt;state == 2)) {
<a name="l03780"></a>03780             <span class="keywordflow">return</span>;
<a name="l03781"></a>03781         }
<a name="l03782"></a>03782         <span class="keywordflow">if</span> (($pnum &gt; 0) AND ($pnum &lt;= $this-&gt;numpages)) {
<a name="l03783"></a>03783             $this-&gt;state = 2;
<a name="l03784"></a>03784             <span class="comment">// save current graphic settings</span>
<a name="l03785"></a>03785             <span class="comment">//$gvars = $this-&gt;getGraphicVars();</span>
<a name="l03786"></a>03786             $oldpage = $this-&gt;page;
<a name="l03787"></a>03787             $this-&gt;page = $pnum;
<a name="l03788"></a>03788             $this-&gt;wPt = $this-&gt;pagedim[$this-&gt;page][<span class="charliteral">&#39;w&#39;</span>];
<a name="l03789"></a>03789             $this-&gt;hPt = $this-&gt;pagedim[$this-&gt;page][<span class="charliteral">&#39;h&#39;</span>];
<a name="l03790"></a>03790             $this-&gt;w = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;wk&#39;</span>];
<a name="l03791"></a>03791             $this-&gt;h = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;hk&#39;</span>];
<a name="l03792"></a>03792             $this-&gt;tMargin = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;tm&#39;</span>];
<a name="l03793"></a>03793             $this-&gt;bMargin = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;bm&#39;</span>];
<a name="l03794"></a>03794             $this-&gt;original_lMargin = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>];
<a name="l03795"></a>03795             $this-&gt;original_rMargin = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>];
<a name="l03796"></a>03796             $this-&gt;AutoPageBreak = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;pb&#39;</span>];
<a name="l03797"></a>03797             $this-&gt;CurOrientation = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;or&#39;</span>];
<a name="l03798"></a>03798             $this-&gt;<a class="code" href="classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9" title="Enables or disables the automatic page breaking mode.">SetAutoPageBreak</a>($this-&gt;AutoPageBreak, $this-&gt;bMargin);
<a name="l03799"></a>03799             <span class="comment">// restore graphic settings</span>
<a name="l03800"></a>03800             <span class="comment">//$this-&gt;setGraphicVars($gvars);</span>
<a name="l03801"></a>03801             <span class="keywordflow">if</span> ($resetmargins) {
<a name="l03802"></a>03802                 $this-&gt;lMargin = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>];
<a name="l03803"></a>03803                 $this-&gt;rMargin = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>];
<a name="l03804"></a>03804                 $this-&gt;<a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758" title="Moves the current abscissa back to the left margin and sets the ordinate.">SetY</a>($this-&gt;tMargin);
<a name="l03805"></a>03805             } <span class="keywordflow">else</span> {
<a name="l03806"></a>03806                 <span class="comment">// account for booklet mode</span>
<a name="l03807"></a>03807                 <span class="keywordflow">if</span> ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;olm&#39;</span>]) {
<a name="l03808"></a>03808                     $deltam = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>];
<a name="l03809"></a>03809                     $this-&gt;lMargin += $deltam;
<a name="l03810"></a>03810                     $this-&gt;rMargin -= $deltam;
<a name="l03811"></a>03811                 }
<a name="l03812"></a>03812             }
<a name="l03813"></a>03813         } <span class="keywordflow">else</span> {
<a name="l03814"></a>03814             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Wrong page number on setPage() function: &#39;</span>.$pnum);
<a name="l03815"></a>03815         }
<a name="l03816"></a>03816     }
<a name="l03817"></a>03817 <span class="comment"></span>
<a name="l03818"></a>03818 <span class="comment">    /**</span>
<a name="l03819"></a>03819 <span class="comment">     * Reset pointer to the last document page.</span>
<a name="l03820"></a>03820 <span class="comment">     * @param $resetmargins (boolean) if true reset left, right, top margins and Y position.</span>
<a name="l03821"></a>03821 <span class="comment">     * @public</span>
<a name="l03822"></a>03822 <span class="comment">     * @since 2.0.000 (2008-01-04)</span>
<a name="l03823"></a>03823 <span class="comment">     * @see setPage(), getPage(), getNumPages()</span>
<a name="l03824"></a>03824 <span class="comment">     */</span>
<a name="l03825"></a><a class="code" href="classTCPDF.html#a0c5df96854236ada4bd14962d9ddbbb5">03825</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0c5df96854236ada4bd14962d9ddbbb5" title="Reset pointer to the last document page.">lastPage</a>($resetmargins=<span class="keyword">false</span>) {
<a name="l03826"></a>03826         $this-&gt;<a class="code" href="classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00" title="Move pointer at the specified document page and update page dimensions.">setPage</a>($this-&gt;<a class="code" href="classTCPDF.html#a9612d9b2bafafa217fc425a6dae4e5ac" title="Get the total number of insered pages.">getNumPages</a>(), $resetmargins);
<a name="l03827"></a>03827     }
<a name="l03828"></a>03828 <span class="comment"></span>
<a name="l03829"></a>03829 <span class="comment">    /**</span>
<a name="l03830"></a>03830 <span class="comment">     * Get current document page number.</span>
<a name="l03831"></a>03831 <span class="comment">     * @return int page number</span>
<a name="l03832"></a>03832 <span class="comment">     * @public</span>
<a name="l03833"></a>03833 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l03834"></a>03834 <span class="comment">     * @see setPage(), lastpage(), getNumPages()</span>
<a name="l03835"></a>03835 <span class="comment">     */</span>
<a name="l03836"></a><a class="code" href="classTCPDF.html#aa6e5b824889f7c484cc76ce1c134e2ed">03836</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa6e5b824889f7c484cc76ce1c134e2ed" title="Get current document page number.">getPage</a>() {
<a name="l03837"></a>03837         <span class="keywordflow">return</span> $this-&gt;page;
<a name="l03838"></a>03838     }
<a name="l03839"></a>03839 <span class="comment"></span>
<a name="l03840"></a>03840 <span class="comment">    /**</span>
<a name="l03841"></a>03841 <span class="comment">     * Get the total number of insered pages.</span>
<a name="l03842"></a>03842 <span class="comment">     * @return int number of pages</span>
<a name="l03843"></a>03843 <span class="comment">     * @public</span>
<a name="l03844"></a>03844 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l03845"></a>03845 <span class="comment">     * @see setPage(), getPage(), lastpage()</span>
<a name="l03846"></a>03846 <span class="comment">     */</span>
<a name="l03847"></a><a class="code" href="classTCPDF.html#a9612d9b2bafafa217fc425a6dae4e5ac">03847</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9612d9b2bafafa217fc425a6dae4e5ac" title="Get the total number of insered pages.">getNumPages</a>() {
<a name="l03848"></a>03848         <span class="keywordflow">return</span> $this-&gt;numpages;
<a name="l03849"></a>03849     }
<a name="l03850"></a>03850 <span class="comment"></span>
<a name="l03851"></a>03851 <span class="comment">    /**</span>
<a name="l03852"></a>03852 <span class="comment">     * Adds a new TOC (Table Of Content) page to the document.</span>
<a name="l03853"></a>03853 <span class="comment">     * @param $orientation (string) page orientation.</span>
<a name="l03854"></a>03854 <span class="comment">     * @param $format (mixed) The format used for pages. It can be either: one of the string values specified at getPageSizeFromFormat() or an array of parameters specified at setPageFormat().</span>
<a name="l03855"></a>03855 <span class="comment">     * @param $keepmargins (boolean) if true overwrites the default page margins with the current margins</span>
<a name="l03856"></a>03856 <span class="comment">     * @public</span>
<a name="l03857"></a>03857 <span class="comment">     * @since 5.0.001 (2010-05-06)</span>
<a name="l03858"></a>03858 <span class="comment">     * @see AddPage(), startPage(), endPage(), endTOCPage()</span>
<a name="l03859"></a>03859 <span class="comment">     */</span>
<a name="l03860"></a><a class="code" href="classTCPDF.html#ad5303676c4d5a355672dd599eb263a50">03860</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad5303676c4d5a355672dd599eb263a50" title="Adds a new TOC (Table Of Content) page to the document.">addTOCPage</a>($orientation=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>=<span class="stringliteral">&#39;&#39;</span>, $keepmargins=<span class="keyword">false</span>) {
<a name="l03861"></a>03861         $this-&gt;<a class="code" href="classTCPDF.html#a5171e20b366b74523709d84c349c1ced" title="Adds a new page to the document.">AddPage</a>($orientation, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>, $keepmargins, <span class="keyword">true</span>);
<a name="l03862"></a>03862     }
<a name="l03863"></a>03863 <span class="comment"></span>
<a name="l03864"></a>03864 <span class="comment">    /**</span>
<a name="l03865"></a>03865 <span class="comment">     * Terminate the current TOC (Table Of Content) page</span>
<a name="l03866"></a>03866 <span class="comment">     * @public</span>
<a name="l03867"></a>03867 <span class="comment">     * @since 5.0.001 (2010-05-06)</span>
<a name="l03868"></a>03868 <span class="comment">     * @see AddPage(), startPage(), endPage(), addTOCPage()</span>
<a name="l03869"></a>03869 <span class="comment">     */</span>
<a name="l03870"></a><a class="code" href="classTCPDF.html#a02a272341e600d3c69836d1a564d29e0">03870</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a02a272341e600d3c69836d1a564d29e0" title="Terminate the current TOC (Table Of Content) page.">endTOCPage</a>() {
<a name="l03871"></a>03871         $this-&gt;<a class="code" href="classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c" title="Terminate the current page.">endPage</a>(<span class="keyword">true</span>);
<a name="l03872"></a>03872     }
<a name="l03873"></a>03873 <span class="comment"></span>
<a name="l03874"></a>03874 <span class="comment">    /**</span>
<a name="l03875"></a>03875 <span class="comment">     * Adds a new page to the document. If a page is already present, the Footer() method is called first to output the footer (if enabled). Then the page is added, the current position set to the top-left corner according to the left and top margins (or top-right if in RTL mode), and Header() is called to display the header (if enabled).</span>
<a name="l03876"></a>03876 <span class="comment">     * The origin of the coordinate system is at the top-left corner (or top-right for RTL) and increasing ordinates go downwards.</span>
<a name="l03877"></a>03877 <span class="comment">     * @param $orientation (string) page orientation. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;P or PORTRAIT (default)&lt;/li&gt;&lt;li&gt;L or LANDSCAPE&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l03878"></a>03878 <span class="comment">     * @param $format (mixed) The format used for pages. It can be either: one of the string values specified at getPageSizeFromFormat() or an array of parameters specified at setPageFormat().</span>
<a name="l03879"></a>03879 <span class="comment">     * @param $keepmargins (boolean) if true overwrites the default page margins with the current margins</span>
<a name="l03880"></a>03880 <span class="comment">     * @param $tocpage (boolean) if true set the tocpage state to true (the added page will be used to display Table Of Content).</span>
<a name="l03881"></a>03881 <span class="comment">     * @public</span>
<a name="l03882"></a>03882 <span class="comment">     * @since 1.0</span>
<a name="l03883"></a>03883 <span class="comment">     * @see startPage(), endPage(), addTOCPage(), endTOCPage(), getPageSizeFromFormat(), setPageFormat()</span>
<a name="l03884"></a>03884 <span class="comment">     */</span>
<a name="l03885"></a><a class="code" href="classTCPDF.html#a5171e20b366b74523709d84c349c1ced">03885</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5171e20b366b74523709d84c349c1ced" title="Adds a new page to the document.">AddPage</a>($orientation=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>=<span class="stringliteral">&#39;&#39;</span>, $keepmargins=<span class="keyword">false</span>, <a class="code" href="classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f" title="Boolean flag true when we are on TOC (Table Of Content) page.">$tocpage</a>=<span class="keyword">false</span>) {
<a name="l03886"></a>03886         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l03887"></a>03887             <span class="comment">// we are inside an XObject template</span>
<a name="l03888"></a>03888             <span class="keywordflow">return</span>;
<a name="l03889"></a>03889         }
<a name="l03890"></a>03890         <span class="keywordflow">if</span> (!isset($this-&gt;original_lMargin) OR $keepmargins) {
<a name="l03891"></a>03891             $this-&gt;original_lMargin = $this-&gt;lMargin;
<a name="l03892"></a>03892         }
<a name="l03893"></a>03893         <span class="keywordflow">if</span> (!isset($this-&gt;original_rMargin) OR $keepmargins) {
<a name="l03894"></a>03894             $this-&gt;original_rMargin = $this-&gt;rMargin;
<a name="l03895"></a>03895         }
<a name="l03896"></a>03896         <span class="comment">// terminate previous page</span>
<a name="l03897"></a>03897         $this-&gt;<a class="code" href="classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c" title="Terminate the current page.">endPage</a>();
<a name="l03898"></a>03898         <span class="comment">// start new page</span>
<a name="l03899"></a>03899         $this-&gt;<a class="code" href="classTCPDF.html#a02c319c0adc5a464351d428ae4602aae" title="Starts a new page to the document.">startPage</a>($orientation, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>, <a class="code" href="classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f" title="Boolean flag true when we are on TOC (Table Of Content) page.">$tocpage</a>);
<a name="l03900"></a>03900     }
<a name="l03901"></a>03901 <span class="comment"></span>
<a name="l03902"></a>03902 <span class="comment">    /**</span>
<a name="l03903"></a>03903 <span class="comment">     * Terminate the current page</span>
<a name="l03904"></a>03904 <span class="comment">     * @param $tocpage (boolean) if true set the tocpage state to false (end the page used to display Table Of Content).</span>
<a name="l03905"></a>03905 <span class="comment">     * @public</span>
<a name="l03906"></a>03906 <span class="comment">     * @since 4.2.010 (2008-11-14)</span>
<a name="l03907"></a>03907 <span class="comment">     * @see AddPage(), startPage(), addTOCPage(), endTOCPage()</span>
<a name="l03908"></a>03908 <span class="comment">     */</span>
<a name="l03909"></a><a class="code" href="classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c">03909</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c" title="Terminate the current page.">endPage</a>(<a class="code" href="classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f" title="Boolean flag true when we are on TOC (Table Of Content) page.">$tocpage</a>=<span class="keyword">false</span>) {
<a name="l03910"></a>03910         <span class="comment">// check if page is already closed</span>
<a name="l03911"></a>03911         <span class="keywordflow">if</span> (($this-&gt;page == 0) OR ($this-&gt;numpages &gt; $this-&gt;page) OR (!$this-&gt;pageopen[$this-&gt;page])) {
<a name="l03912"></a>03912             <span class="keywordflow">return</span>;
<a name="l03913"></a>03913         }
<a name="l03914"></a>03914         <span class="comment">// print page footer</span>
<a name="l03915"></a>03915         $this-&gt;<a class="code" href="classTCPDF.html#a7b0675e51b6f7ab3e4730feef3c86fb5" title="This method is used to render the page footer.">setFooter</a>();
<a name="l03916"></a>03916         <span class="comment">// close page</span>
<a name="l03917"></a>03917         $this-&gt;<a class="code" href="classTCPDF.html#af037a681d72f4eeaecd641680257a16f" title="Mark end of page.">_endpage</a>();
<a name="l03918"></a>03918         <span class="comment">// mark page as closed</span>
<a name="l03919"></a>03919         $this-&gt;pageopen[$this-&gt;page] = <span class="keyword">false</span>;
<a name="l03920"></a>03920         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f" title="Boolean flag true when we are on TOC (Table Of Content) page.">$tocpage</a>) {
<a name="l03921"></a>03921             $this-&gt;tocpage = <span class="keyword">false</span>;
<a name="l03922"></a>03922         }
<a name="l03923"></a>03923     }
<a name="l03924"></a>03924 <span class="comment"></span>
<a name="l03925"></a>03925 <span class="comment">    /**</span>
<a name="l03926"></a>03926 <span class="comment">     * Starts a new page to the document. The page must be closed using the endPage() function.</span>
<a name="l03927"></a>03927 <span class="comment">     * The origin of the coordinate system is at the top-left corner and increasing ordinates go downwards.</span>
<a name="l03928"></a>03928 <span class="comment">     * @param $orientation (string) page orientation. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;P or PORTRAIT (default)&lt;/li&gt;&lt;li&gt;L or LANDSCAPE&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l03929"></a>03929 <span class="comment">     * @param $format (mixed) The format used for pages. It can be either: one of the string values specified at getPageSizeFromFormat() or an array of parameters specified at setPageFormat().</span>
<a name="l03930"></a>03930 <span class="comment">     * @param $tocpage (boolean) if true the page is designated to contain the Table-Of-Content.</span>
<a name="l03931"></a>03931 <span class="comment">     * @since 4.2.010 (2008-11-14)</span>
<a name="l03932"></a>03932 <span class="comment">     * @see AddPage(), endPage(), addTOCPage(), endTOCPage(), getPageSizeFromFormat(), setPageFormat()</span>
<a name="l03933"></a>03933 <span class="comment">     * @public</span>
<a name="l03934"></a>03934 <span class="comment">     */</span>
<a name="l03935"></a><a class="code" href="classTCPDF.html#a02c319c0adc5a464351d428ae4602aae">03935</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a02c319c0adc5a464351d428ae4602aae" title="Starts a new page to the document.">startPage</a>($orientation=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f" title="Boolean flag true when we are on TOC (Table Of Content) page.">$tocpage</a>=<span class="keyword">false</span>) {
<a name="l03936"></a>03936         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f" title="Boolean flag true when we are on TOC (Table Of Content) page.">$tocpage</a>) {
<a name="l03937"></a>03937             $this-&gt;tocpage = <span class="keyword">true</span>;
<a name="l03938"></a>03938         }
<a name="l03939"></a>03939         <span class="comment">// move page numbers of documents to be attached</span>
<a name="l03940"></a>03940         <span class="keywordflow">if</span> ($this-&gt;tocpage) {
<a name="l03941"></a>03941             <span class="comment">// move reference to unexistent pages (used for page attachments)</span>
<a name="l03942"></a>03942             <span class="comment">// adjust outlines</span>
<a name="l03943"></a>03943             $tmpoutlines = $this-&gt;outlines;
<a name="l03944"></a>03944             <span class="keywordflow">foreach</span> ($tmpoutlines as $key =&gt; $outline) {
<a name="l03945"></a>03945                 <span class="keywordflow">if</span> ($outline[<span class="charliteral">&#39;p&#39;</span>] &gt; $this-&gt;numpages) {
<a name="l03946"></a>03946                     $this-&gt;outlines[$key][<span class="charliteral">&#39;p&#39;</span>] = ($outline[<span class="charliteral">&#39;p&#39;</span>] + 1);
<a name="l03947"></a>03947                 }
<a name="l03948"></a>03948             }
<a name="l03949"></a>03949             <span class="comment">// adjust dests</span>
<a name="l03950"></a>03950             $tmpdests = $this-&gt;dests;
<a name="l03951"></a>03951             <span class="keywordflow">foreach</span> ($tmpdests as $key =&gt; $dest) {
<a name="l03952"></a>03952                 <span class="keywordflow">if</span> ($dest[<span class="charliteral">&#39;p&#39;</span>] &gt; $this-&gt;numpages) {
<a name="l03953"></a>03953                     $this-&gt;dests[$key][<span class="charliteral">&#39;p&#39;</span>] = ($dest[<span class="charliteral">&#39;p&#39;</span>] + 1);
<a name="l03954"></a>03954                 }
<a name="l03955"></a>03955             }
<a name="l03956"></a>03956             <span class="comment">// adjust links</span>
<a name="l03957"></a>03957             $tmplinks = $this-&gt;links;
<a name="l03958"></a>03958             <span class="keywordflow">foreach</span> ($tmplinks as $key =&gt; $link) {
<a name="l03959"></a>03959                 <span class="keywordflow">if</span> ($link[0] &gt; $this-&gt;numpages) {
<a name="l03960"></a>03960                     $this-&gt;links[$key][0] = ($link[0] + 1);
<a name="l03961"></a>03961                 }
<a name="l03962"></a>03962             }
<a name="l03963"></a>03963         }
<a name="l03964"></a>03964         <span class="keywordflow">if</span> ($this-&gt;numpages &gt; $this-&gt;page) {
<a name="l03965"></a>03965             <span class="comment">// this page has been already added</span>
<a name="l03966"></a>03966             $this-&gt;<a class="code" href="classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00" title="Move pointer at the specified document page and update page dimensions.">setPage</a>($this-&gt;page + 1);
<a name="l03967"></a>03967             $this-&gt;<a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758" title="Moves the current abscissa back to the left margin and sets the ordinate.">SetY</a>($this-&gt;tMargin);
<a name="l03968"></a>03968             <span class="keywordflow">return</span>;
<a name="l03969"></a>03969         }
<a name="l03970"></a>03970         <span class="comment">// start a new page</span>
<a name="l03971"></a>03971         <span class="keywordflow">if</span> ($this-&gt;state == 0) {
<a name="l03972"></a>03972             $this-&gt;<a class="code" href="classTCPDF.html#a58f93b800daf9a608c3c1ad90a69e46e" title="This method begins the generation of the PDF document.">Open</a>();
<a name="l03973"></a>03973         }
<a name="l03974"></a>03974         ++$this-&gt;numpages;
<a name="l03975"></a>03975         $this-&gt;<a class="code" href="classTCPDF.html#aae16fb109eb4f3aaa9ba860cfb1cf1f2" title="Swap the left and right margins.">swapMargins</a>($this-&gt;booklet);
<a name="l03976"></a>03976         <span class="comment">// save current graphic settings</span>
<a name="l03977"></a>03977         $gvars = $this-&gt;<a class="code" href="classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a" title="Returns current graphic variables as array.">getGraphicVars</a>();
<a name="l03978"></a>03978         <span class="comment">// start new page</span>
<a name="l03979"></a>03979         $this-&gt;<a class="code" href="classTCPDF.html#aeba2b911ed732e58cb99c0b9b29ed05f" title="Initialize a new page.">_beginpage</a>($orientation, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>);
<a name="l03980"></a>03980         <span class="comment">// mark page as open</span>
<a name="l03981"></a>03981         $this-&gt;pageopen[$this-&gt;page] = <span class="keyword">true</span>;
<a name="l03982"></a>03982         <span class="comment">// restore graphic settings</span>
<a name="l03983"></a>03983         $this-&gt;<a class="code" href="classTCPDF.html#a072053646725b19770a795050b3b6221" title="Set graphic variables.">setGraphicVars</a>($gvars);
<a name="l03984"></a>03984         <span class="comment">// mark this point</span>
<a name="l03985"></a>03985         $this-&gt;<a class="code" href="classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22" title="Set start-writing mark on current page stream used to put borders and fills.">setPageMark</a>();
<a name="l03986"></a>03986         <span class="comment">// print page header</span>
<a name="l03987"></a>03987         $this-&gt;<a class="code" href="classTCPDF.html#a9e36d6b325764815dd652636ece7eead" title="This method is used to render the page header.">setHeader</a>();
<a name="l03988"></a>03988         <span class="comment">// restore graphic settings</span>
<a name="l03989"></a>03989         $this-&gt;<a class="code" href="classTCPDF.html#a072053646725b19770a795050b3b6221" title="Set graphic variables.">setGraphicVars</a>($gvars);
<a name="l03990"></a>03990         <span class="comment">// mark this point</span>
<a name="l03991"></a>03991         $this-&gt;<a class="code" href="classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22" title="Set start-writing mark on current page stream used to put borders and fills.">setPageMark</a>();
<a name="l03992"></a>03992         <span class="comment">// print table header (if any)</span>
<a name="l03993"></a>03993         $this-&gt;<a class="code" href="classTCPDF.html#a52a8502589754eefe8da17efdd40329b" title="This method is used to render the table header on new page (if any).">setTableHeader</a>();
<a name="l03994"></a>03994         <span class="comment">// set mark for empty page check</span>
<a name="l03995"></a>03995         $this-&gt;emptypagemrk[$this-&gt;page]= $this-&gt;pagelen[$this-&gt;page];
<a name="l03996"></a>03996     }
<a name="l03997"></a>03997 <span class="comment"></span>
<a name="l03998"></a>03998 <span class="comment">    /**</span>
<a name="l03999"></a>03999 <span class="comment">     * Set start-writing mark on current page stream used to put borders and fills.</span>
<a name="l04000"></a>04000 <span class="comment">     * Borders and fills are always created after content and inserted on the position marked by this method.</span>
<a name="l04001"></a>04001 <span class="comment">     * This function must be called after calling Image() function for a background image.</span>
<a name="l04002"></a>04002 <span class="comment">     * Background images must be always inserted before calling Multicell() or WriteHTMLCell() or WriteHTML() functions.</span>
<a name="l04003"></a>04003 <span class="comment">     * @public</span>
<a name="l04004"></a>04004 <span class="comment">     * @since 4.0.016 (2008-07-30)</span>
<a name="l04005"></a>04005 <span class="comment">     */</span>
<a name="l04006"></a><a class="code" href="classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22">04006</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22" title="Set start-writing mark on current page stream used to put borders and fills.">setPageMark</a>() {
<a name="l04007"></a>04007         $this-&gt;intmrk[$this-&gt;page] = $this-&gt;pagelen[$this-&gt;page];
<a name="l04008"></a>04008         $this-&gt;bordermrk[$this-&gt;page] = $this-&gt;intmrk[$this-&gt;page];
<a name="l04009"></a>04009         $this-&gt;<a class="code" href="classTCPDF.html#a278cba1881265c0b47036a629a67863f" title="Set start-writing mark on selected page.">setContentMark</a>();
<a name="l04010"></a>04010     }
<a name="l04011"></a>04011 <span class="comment"></span>
<a name="l04012"></a>04012 <span class="comment">    /**</span>
<a name="l04013"></a>04013 <span class="comment">     * Set start-writing mark on selected page.</span>
<a name="l04014"></a>04014 <span class="comment">     * Borders and fills are always created after content and inserted on the position marked by this method.</span>
<a name="l04015"></a>04015 <span class="comment">     * @param $page (int) page number (default is the current page)</span>
<a name="l04016"></a>04016 <span class="comment">     * @protected</span>
<a name="l04017"></a>04017 <span class="comment">     * @since 4.6.021 (2009-07-20)</span>
<a name="l04018"></a>04018 <span class="comment">     */</span>
<a name="l04019"></a><a class="code" href="classTCPDF.html#a278cba1881265c0b47036a629a67863f">04019</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a278cba1881265c0b47036a629a67863f" title="Set start-writing mark on selected page.">setContentMark</a>(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>=0) {
<a name="l04020"></a>04020         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> &lt;= 0) {
<a name="l04021"></a>04021             <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> = $this-&gt;page;
<a name="l04022"></a>04022         }
<a name="l04023"></a>04023         <span class="keywordflow">if</span> (isset($this-&gt;footerlen[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>])) {
<a name="l04024"></a>04024             $this-&gt;cntmrk[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>] = $this-&gt;pagelen[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>] - $this-&gt;footerlen[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>];
<a name="l04025"></a>04025         } <span class="keywordflow">else</span> {
<a name="l04026"></a>04026             $this-&gt;cntmrk[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>] = $this-&gt;pagelen[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>];
<a name="l04027"></a>04027         }
<a name="l04028"></a>04028     }
<a name="l04029"></a>04029 <span class="comment"></span>
<a name="l04030"></a>04030 <span class="comment">    /**</span>
<a name="l04031"></a>04031 <span class="comment">     * Set header data.</span>
<a name="l04032"></a>04032 <span class="comment">     * @param $ln (string) header image logo</span>
<a name="l04033"></a>04033 <span class="comment">     * @param $lw (string) header image logo width in mm</span>
<a name="l04034"></a>04034 <span class="comment">     * @param $ht (string) string to print as title on document header</span>
<a name="l04035"></a>04035 <span class="comment">     * @param $hs (string) string to print on document header</span>
<a name="l04036"></a>04036 <span class="comment">     * @public</span>
<a name="l04037"></a>04037 <span class="comment">     */</span>
<a name="l04038"></a><a class="code" href="classTCPDF.html#a072c3747bfaaeafc010702ddaf6c24ee">04038</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a072c3747bfaaeafc010702ddaf6c24ee" title="Set header data.">setHeaderData</a>($ln=<span class="stringliteral">&#39;&#39;</span>, $lw=0, $ht=<span class="stringliteral">&#39;&#39;</span>, $hs=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l04039"></a>04039         $this-&gt;header_logo = $ln;
<a name="l04040"></a>04040         $this-&gt;header_logo_width = $lw;
<a name="l04041"></a>04041         $this-&gt;header_title = $ht;
<a name="l04042"></a>04042         $this-&gt;header_string = $hs;
<a name="l04043"></a>04043     }
<a name="l04044"></a>04044 <span class="comment"></span>
<a name="l04045"></a>04045 <span class="comment">    /**</span>
<a name="l04046"></a>04046 <span class="comment">     * Returns header data:</span>
<a name="l04047"></a>04047 <span class="comment">     * &lt;ul&gt;&lt;li&gt;$ret[&#39;logo&#39;] = logo image&lt;/li&gt;&lt;li&gt;$ret[&#39;logo_width&#39;] = width of the image logo in user units&lt;/li&gt;&lt;li&gt;$ret[&#39;title&#39;] = header title&lt;/li&gt;&lt;li&gt;$ret[&#39;string&#39;] = header description string&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l04048"></a>04048 <span class="comment">     * @return array()</span>
<a name="l04049"></a>04049 <span class="comment">     * @public</span>
<a name="l04050"></a>04050 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l04051"></a>04051 <span class="comment">     */</span>
<a name="l04052"></a><a class="code" href="classTCPDF.html#a70437676b6ee2c9ff985b38d5789fb90">04052</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a70437676b6ee2c9ff985b38d5789fb90" title="Returns header data:">getHeaderData</a>() {
<a name="l04053"></a>04053         $ret = array();
<a name="l04054"></a>04054         $ret[<span class="stringliteral">&#39;logo&#39;</span>] = $this-&gt;header_logo;
<a name="l04055"></a>04055         $ret[<span class="stringliteral">&#39;logo_width&#39;</span>] = $this-&gt;header_logo_width;
<a name="l04056"></a>04056         $ret[<span class="stringliteral">&#39;title&#39;</span>] = $this-&gt;header_title;
<a name="l04057"></a>04057         $ret[<span class="stringliteral">&#39;string&#39;</span>] = $this-&gt;header_string;
<a name="l04058"></a>04058         <span class="keywordflow">return</span> $ret;
<a name="l04059"></a>04059     }
<a name="l04060"></a>04060 <span class="comment"></span>
<a name="l04061"></a>04061 <span class="comment">    /**</span>
<a name="l04062"></a>04062 <span class="comment">     * Set header margin.</span>
<a name="l04063"></a>04063 <span class="comment">     * (minimum distance between header and top page margin)</span>
<a name="l04064"></a>04064 <span class="comment">     * @param $hm (int) distance in user units</span>
<a name="l04065"></a>04065 <span class="comment">     * @public</span>
<a name="l04066"></a>04066 <span class="comment">     */</span>
<a name="l04067"></a><a class="code" href="classTCPDF.html#adf1682524d9c24f3b8c8f4aabf4bd034">04067</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#adf1682524d9c24f3b8c8f4aabf4bd034" title="Set header margin.">setHeaderMargin</a>($hm=10) {
<a name="l04068"></a>04068         $this-&gt;header_margin = $hm;
<a name="l04069"></a>04069     }
<a name="l04070"></a>04070 <span class="comment"></span>
<a name="l04071"></a>04071 <span class="comment">    /**</span>
<a name="l04072"></a>04072 <span class="comment">     * Returns header margin in user units.</span>
<a name="l04073"></a>04073 <span class="comment">     * @return float</span>
<a name="l04074"></a>04074 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l04075"></a>04075 <span class="comment">     * @public</span>
<a name="l04076"></a>04076 <span class="comment">     */</span>
<a name="l04077"></a><a class="code" href="classTCPDF.html#af2bfd0376f18244ad8c7aa3a85399c58">04077</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af2bfd0376f18244ad8c7aa3a85399c58" title="Returns header margin in user units.">getHeaderMargin</a>() {
<a name="l04078"></a>04078         <span class="keywordflow">return</span> $this-&gt;header_margin;
<a name="l04079"></a>04079     }
<a name="l04080"></a>04080 <span class="comment"></span>
<a name="l04081"></a>04081 <span class="comment">    /**</span>
<a name="l04082"></a>04082 <span class="comment">     * Set footer margin.</span>
<a name="l04083"></a>04083 <span class="comment">     * (minimum distance between footer and bottom page margin)</span>
<a name="l04084"></a>04084 <span class="comment">     * @param $fm (int) distance in user units</span>
<a name="l04085"></a>04085 <span class="comment">     * @public</span>
<a name="l04086"></a>04086 <span class="comment">     */</span>
<a name="l04087"></a><a class="code" href="classTCPDF.html#a83d9c1f132f0147413259259b4a2ca7d">04087</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a83d9c1f132f0147413259259b4a2ca7d" title="Set footer margin.">setFooterMargin</a>($fm=10) {
<a name="l04088"></a>04088         $this-&gt;footer_margin = $fm;
<a name="l04089"></a>04089     }
<a name="l04090"></a>04090 <span class="comment"></span>
<a name="l04091"></a>04091 <span class="comment">    /**</span>
<a name="l04092"></a>04092 <span class="comment">     * Returns footer margin in user units.</span>
<a name="l04093"></a>04093 <span class="comment">     * @return float</span>
<a name="l04094"></a>04094 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l04095"></a>04095 <span class="comment">     * @public</span>
<a name="l04096"></a>04096 <span class="comment">     */</span>
<a name="l04097"></a><a class="code" href="classTCPDF.html#a7f1fa220561198a793cdd56a3390438d">04097</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7f1fa220561198a793cdd56a3390438d" title="Returns footer margin in user units.">getFooterMargin</a>() {
<a name="l04098"></a>04098         <span class="keywordflow">return</span> $this-&gt;footer_margin;
<a name="l04099"></a>04099     }<span class="comment"></span>
<a name="l04100"></a>04100 <span class="comment">    /**</span>
<a name="l04101"></a>04101 <span class="comment">     * Set a flag to print page header.</span>
<a name="l04102"></a>04102 <span class="comment">     * @param $val (boolean) set to true to print the page header (default), false otherwise.</span>
<a name="l04103"></a>04103 <span class="comment">     * @public</span>
<a name="l04104"></a>04104 <span class="comment">     */</span>
<a name="l04105"></a><a class="code" href="classTCPDF.html#a9240c96d0ce715acb3ebe8e8362202f7">04105</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9240c96d0ce715acb3ebe8e8362202f7" title="Set a flag to print page header.">setPrintHeader</a>($val=<span class="keyword">true</span>) {
<a name="l04106"></a>04106         $this-&gt;print_header = $val ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l04107"></a>04107     }
<a name="l04108"></a>04108 <span class="comment"></span>
<a name="l04109"></a>04109 <span class="comment">    /**</span>
<a name="l04110"></a>04110 <span class="comment">     * Set a flag to print page footer.</span>
<a name="l04111"></a>04111 <span class="comment">     * @param $val (boolean) set to true to print the page footer (default), false otherwise.</span>
<a name="l04112"></a>04112 <span class="comment">     * @public</span>
<a name="l04113"></a>04113 <span class="comment">     */</span>
<a name="l04114"></a><a class="code" href="classTCPDF.html#a8dc91462430bd190502e04aec229153f">04114</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8dc91462430bd190502e04aec229153f" title="Set a flag to print page footer.">setPrintFooter</a>($val=<span class="keyword">true</span>) {
<a name="l04115"></a>04115         $this-&gt;print_footer = $val ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l04116"></a>04116     }
<a name="l04117"></a>04117 <span class="comment"></span>
<a name="l04118"></a>04118 <span class="comment">    /**</span>
<a name="l04119"></a>04119 <span class="comment">     * Return the right-bottom (or left-bottom for RTL) corner X coordinate of last inserted image</span>
<a name="l04120"></a>04120 <span class="comment">     * @return float</span>
<a name="l04121"></a>04121 <span class="comment">     * @public</span>
<a name="l04122"></a>04122 <span class="comment">     */</span>
<a name="l04123"></a><a class="code" href="classTCPDF.html#a67b4394647eef529a62e103d20324a76">04123</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a67b4394647eef529a62e103d20324a76" title="Return the right-bottom (or left-bottom for RTL) corner X coordinate of last inserted image...">getImageRBX</a>() {
<a name="l04124"></a>04124         <span class="keywordflow">return</span> $this-&gt;img_rb_x;
<a name="l04125"></a>04125     }
<a name="l04126"></a>04126 <span class="comment"></span>
<a name="l04127"></a>04127 <span class="comment">    /**</span>
<a name="l04128"></a>04128 <span class="comment">     * Return the right-bottom (or left-bottom for RTL) corner Y coordinate of last inserted image</span>
<a name="l04129"></a>04129 <span class="comment">     * @return float</span>
<a name="l04130"></a>04130 <span class="comment">     * @public</span>
<a name="l04131"></a>04131 <span class="comment">     */</span>
<a name="l04132"></a><a class="code" href="classTCPDF.html#a0368d51e3742f13e5972b2e2f7d6fd28">04132</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0368d51e3742f13e5972b2e2f7d6fd28" title="Return the right-bottom (or left-bottom for RTL) corner Y coordinate of last inserted image...">getImageRBY</a>() {
<a name="l04133"></a>04133         <span class="keywordflow">return</span> $this-&gt;img_rb_y;
<a name="l04134"></a>04134     }
<a name="l04135"></a>04135 <span class="comment"></span>
<a name="l04136"></a>04136 <span class="comment">    /**</span>
<a name="l04137"></a>04137 <span class="comment">     * Reset the xobject template used by Header() method.</span>
<a name="l04138"></a>04138 <span class="comment">     * @public</span>
<a name="l04139"></a>04139 <span class="comment">     */</span>
<a name="l04140"></a><a class="code" href="classTCPDF.html#a615b71100b4526459d22e385fffe1660">04140</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a615b71100b4526459d22e385fffe1660" title="Reset the xobject template used by Header() method.">resetHeaderTemplate</a>() {
<a name="l04141"></a>04141         $this-&gt;header_xobjid = -1;
<a name="l04142"></a>04142     }
<a name="l04143"></a>04143 <span class="comment"></span>
<a name="l04144"></a>04144 <span class="comment">    /**</span>
<a name="l04145"></a>04145 <span class="comment">     * Set a flag to automatically reset the xobject template used by Header() method at each page.</span>
<a name="l04146"></a>04146 <span class="comment">     * @param $val (boolean) set to true to reset Header xobject template at each page, false otherwise.</span>
<a name="l04147"></a>04147 <span class="comment">     * @public</span>
<a name="l04148"></a>04148 <span class="comment">     */</span>
<a name="l04149"></a><a class="code" href="classTCPDF.html#a94ed72c3dc79bd9436fd02ad6de955a1">04149</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a94ed72c3dc79bd9436fd02ad6de955a1" title="Set a flag to automatically reset the xobject template used by Header() method at each page...">setHeaderTemplateAutoreset</a>($val=<span class="keyword">true</span>) {
<a name="l04150"></a>04150         $this-&gt;header_xobj_autoreset = $val ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l04151"></a>04151     }
<a name="l04152"></a>04152 <span class="comment"></span>
<a name="l04153"></a>04153 <span class="comment">    /**</span>
<a name="l04154"></a>04154 <span class="comment">     * This method is used to render the page header.</span>
<a name="l04155"></a>04155 <span class="comment">     * It is automatically called by AddPage() and could be overwritten in your own inherited class.</span>
<a name="l04156"></a>04156 <span class="comment">     * @public</span>
<a name="l04157"></a>04157 <span class="comment">     */</span>
<a name="l04158"></a><a class="code" href="classTCPDF.html#a553f8a9bbb5301f983ebfd64544cb7a8">04158</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a553f8a9bbb5301f983ebfd64544cb7a8" title="This method is used to render the page header.">Header</a>() {
<a name="l04159"></a>04159         <span class="keywordflow">if</span> ($this-&gt;header_xobjid &lt; 0) {
<a name="l04160"></a>04160             <span class="comment">// start a new XObject Template</span>
<a name="l04161"></a>04161             $this-&gt;header_xobjid = $this-&gt;<a class="code" href="classTCPDF.html#a7eae5df3511dac591b5b76ab5d8b9a68" title="Start a new XObject Template.">startTemplate</a>($this-&gt;w, $this-&gt;tMargin);
<a name="l04162"></a>04162             $headerfont = $this-&gt;<a class="code" href="classTCPDF.html#a2490e635d8ff11d41b6578bab46acba5" title="Get header font.">getHeaderFont</a>();
<a name="l04163"></a>04163             $headerdata = $this-&gt;<a class="code" href="classTCPDF.html#a70437676b6ee2c9ff985b38d5789fb90" title="Returns header data:">getHeaderData</a>();
<a name="l04164"></a>04164             $this-&gt;y = $this-&gt;header_margin;
<a name="l04165"></a>04165             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l04166"></a>04166                 $this-&gt;x = $this-&gt;w - $this-&gt;original_rMargin;
<a name="l04167"></a>04167             } <span class="keywordflow">else</span> {
<a name="l04168"></a>04168                 $this-&gt;x = $this-&gt;original_lMargin;
<a name="l04169"></a>04169             }
<a name="l04170"></a>04170             <span class="keywordflow">if</span> (($headerdata[<span class="stringliteral">&#39;logo&#39;</span>]) AND ($headerdata[<span class="stringliteral">&#39;logo&#39;</span>] != K_BLANK_IMAGE)) {
<a name="l04171"></a>04171                 $imgtype = $this-&gt;<a class="code" href="classTCPDF.html#a69d6b919e84ff00a19e750efd29fba18" title="Return the image type given the file name or array returned by getimagesize() function.">getImageFileType</a>(K_PATH_IMAGES.$headerdata[<span class="stringliteral">&#39;logo&#39;</span>]);
<a name="l04172"></a>04172                 <span class="keywordflow">if</span> (($imgtype == <span class="stringliteral">&#39;eps&#39;</span>) OR ($imgtype == <span class="stringliteral">&#39;ai&#39;</span>)) {
<a name="l04173"></a>04173                     $this-&gt;<a class="code" href="classTCPDF.html#ace0583441eed657b827420fcfb37a3bd" title="Embed vector-based Adobe Illustrator (AI) or AI-compatible EPS files.">ImageEps</a>(K_PATH_IMAGES.$headerdata[<span class="stringliteral">&#39;logo&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>]);
<a name="l04174"></a>04174                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($imgtype == <span class="stringliteral">&#39;svg&#39;</span>) {
<a name="l04175"></a>04175                     $this-&gt;<a class="code" href="classTCPDF.html#a56536508fb1b5aede7d2ed27f56c2353" title="Embedd a Scalable Vector Graphics (SVG) image.">ImageSVG</a>(K_PATH_IMAGES.$headerdata[<span class="stringliteral">&#39;logo&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>]);
<a name="l04176"></a>04176                 } <span class="keywordflow">else</span> {
<a name="l04177"></a>04177                     $this-&gt;<a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352" title="Puts an image in the page.">Image</a>(K_PATH_IMAGES.$headerdata[<span class="stringliteral">&#39;logo&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>]);
<a name="l04178"></a>04178                 }
<a name="l04179"></a>04179                 $imgy = $this-&gt;<a class="code" href="classTCPDF.html#a0368d51e3742f13e5972b2e2f7d6fd28" title="Return the right-bottom (or left-bottom for RTL) corner Y coordinate of last inserted image...">getImageRBY</a>();
<a name="l04180"></a>04180             } <span class="keywordflow">else</span> {
<a name="l04181"></a>04181                 $imgy = $this-&gt;y;
<a name="l04182"></a>04182             }
<a name="l04183"></a>04183             $cell_height = round(($this-&gt;cell_height_ratio * $headerfont[2]) / $this-&gt;k, 2);
<a name="l04184"></a>04184             <span class="comment">// set starting margin for text data cell</span>
<a name="l04185"></a>04185             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#af01238bb928c4e3de6ed6aaa855fd788" title="Return the RTL status.">getRTL</a>()) {
<a name="l04186"></a>04186                 $header_x = $this-&gt;original_rMargin + ($headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>] * 1.1);
<a name="l04187"></a>04187             } <span class="keywordflow">else</span> {
<a name="l04188"></a>04188                 $header_x = $this-&gt;original_lMargin + ($headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>] * 1.1);
<a name="l04189"></a>04189             }
<a name="l04190"></a>04190             <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> = $this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin - ($headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>] * 1.1);
<a name="l04191"></a>04191             $this-&gt;<a class="code" href="classTCPDF.html#ab1c0ea925d0e76abd0298ebab4f75140" title="Defines the color used for text.">SetTextColor</a>(0, 0, 0);
<a name="l04192"></a>04192             <span class="comment">// header title</span>
<a name="l04193"></a>04193             $this-&gt;<a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e" title="Sets the font used to print character strings.">SetFont</a>($headerfont[0], <span class="charliteral">&#39;B&#39;</span>, $headerfont[2] + 1);
<a name="l04194"></a>04194             $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>($header_x);
<a name="l04195"></a>04195             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>, $cell_height, $headerdata[<span class="stringliteral">&#39;title&#39;</span>], 0, 1, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, 0);
<a name="l04196"></a>04196             <span class="comment">// header string</span>
<a name="l04197"></a>04197             $this-&gt;<a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e" title="Sets the font used to print character strings.">SetFont</a>($headerfont[0], $headerfont[1], $headerfont[2]);
<a name="l04198"></a>04198             $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>($header_x);
<a name="l04199"></a>04199             $this-&gt;<a class="code" href="classTCPDF.html#aa81d4b585de305c054760ec983ed3ece" title="This method allows printing text with line breaks.">MultiCell</a>(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>, $cell_height, $headerdata[<span class="stringliteral">&#39;string&#39;</span>], 0, <span class="stringliteral">&#39;&#39;</span>, 0, 1, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>, 0, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>);
<a name="l04200"></a>04200             <span class="comment">// print an ending header line</span>
<a name="l04201"></a>04201             $this-&gt;<a class="code" href="classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148" title="Set line style.">SetLineStyle</a>(array(<span class="stringliteral">&#39;width&#39;</span> =&gt; 0.85 / $this-&gt;k, <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; array(0, 0, 0)));
<a name="l04202"></a>04202             $this-&gt;<a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758" title="Moves the current abscissa back to the left margin and sets the ordinate.">SetY</a>((2.835 / $this-&gt;k) + max($imgy, $this-&gt;y));
<a name="l04203"></a>04203             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l04204"></a>04204                 $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>($this-&gt;original_rMargin);
<a name="l04205"></a>04205             } <span class="keywordflow">else</span> {
<a name="l04206"></a>04206                 $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>($this-&gt;original_lMargin);
<a name="l04207"></a>04207             }
<a name="l04208"></a>04208             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(($this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin), 0, <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, 0, <span class="charliteral">&#39;C&#39;</span>);
<a name="l04209"></a>04209             $this-&gt;<a class="code" href="classTCPDF.html#a0b98de81d99a1a0e983dd0016e30fc75" title="End the current XObject Template started with startTemplate() and restore the previous graphic state...">endTemplate</a>();
<a name="l04210"></a>04210         }
<a name="l04211"></a>04211         <span class="comment">// print header template</span>
<a name="l04212"></a>04212         <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = 0;
<a name="l04213"></a>04213         $dx = 0;
<a name="l04214"></a>04214         <span class="keywordflow">if</span> ($this-&gt;booklet AND (($this-&gt;page % 2) == 0)) {
<a name="l04215"></a>04215             <span class="comment">// adjust margins for booklet mode</span>
<a name="l04216"></a>04216             $dx = ($this-&gt;original_lMargin - $this-&gt;original_rMargin);
<a name="l04217"></a>04217         }
<a name="l04218"></a>04218         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l04219"></a>04219             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = $this-&gt;w + $dx;
<a name="l04220"></a>04220         } <span class="keywordflow">else</span> {
<a name="l04221"></a>04221             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = 0 + $dx;
<a name="l04222"></a>04222         }
<a name="l04223"></a>04223         $this-&gt;<a class="code" href="classTCPDF.html#a3a58677c9c6a6e9e7702fcb3041b7253" title="Print an XObject Template.">printTemplate</a>($this-&gt;header_xobjid, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, 0, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);
<a name="l04224"></a>04224         <span class="keywordflow">if</span> ($this-&gt;header_xobj_autoreset) {
<a name="l04225"></a>04225             <span class="comment">// reset header xobject template at each page</span>
<a name="l04226"></a>04226             $this-&gt;header_xobjid = -1;
<a name="l04227"></a>04227         }
<a name="l04228"></a>04228     }
<a name="l04229"></a>04229 <span class="comment"></span>
<a name="l04230"></a>04230 <span class="comment">    /**</span>
<a name="l04231"></a>04231 <span class="comment">     * This method is used to render the page footer.</span>
<a name="l04232"></a>04232 <span class="comment">     * It is automatically called by AddPage() and could be overwritten in your own inherited class.</span>
<a name="l04233"></a>04233 <span class="comment">     * @public</span>
<a name="l04234"></a>04234 <span class="comment">     */</span>
<a name="l04235"></a><a class="code" href="classTCPDF.html#ae40eff8871e1deebf4bea96de4d8a3e4">04235</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae40eff8871e1deebf4bea96de4d8a3e4" title="This method is used to render the page footer.">Footer</a>() {
<a name="l04236"></a>04236         $cur_y = $this-&gt;y;
<a name="l04237"></a>04237         $this-&gt;<a class="code" href="classTCPDF.html#ab1c0ea925d0e76abd0298ebab4f75140" title="Defines the color used for text.">SetTextColor</a>(0, 0, 0);
<a name="l04238"></a>04238         <span class="comment">//set style for cell border</span>
<a name="l04239"></a>04239         $line_width = 0.85 / $this-&gt;k;
<a name="l04240"></a>04240         $this-&gt;<a class="code" href="classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148" title="Set line style.">SetLineStyle</a>(array(<span class="stringliteral">&#39;width&#39;</span> =&gt; $line_width, <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; array(0, 0, 0)));
<a name="l04241"></a>04241         <span class="comment">//print document barcode</span>
<a name="l04242"></a>04242         <a class="code" href="classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8" title="Barcode to print on page footer (only if set).">$barcode</a> = $this-&gt;<a class="code" href="classTCPDF.html#aa3deb91c4ae36afa6253c831df589b3d" title="Get current barcode.">getBarcode</a>();
<a name="l04243"></a>04243         <span class="keywordflow">if</span> (!empty(<a class="code" href="classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8" title="Barcode to print on page footer (only if set).">$barcode</a>)) {
<a name="l04244"></a>04244             $this-&gt;<a class="code" href="classTCPDF.html#a00969cf629d72b3d29ee435f15906820" title="Performs a line break.">Ln</a>($line_width);
<a name="l04245"></a>04245             $barcode_width = round(($this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin) / 3);
<a name="l04246"></a>04246             $style = array(
<a name="l04247"></a>04247                 <span class="stringliteral">&#39;position&#39;</span> =&gt; $this-&gt;rtl?<span class="charliteral">&#39;R&#39;</span>:<span class="charliteral">&#39;L&#39;</span>,
<a name="l04248"></a>04248                 <span class="stringliteral">&#39;align&#39;</span> =&gt; $this-&gt;rtl?<span class="charliteral">&#39;R&#39;</span>:<span class="charliteral">&#39;L&#39;</span>,
<a name="l04249"></a>04249                 <span class="stringliteral">&#39;stretch&#39;</span> =&gt; <span class="keyword">false</span>,
<a name="l04250"></a>04250                 <span class="stringliteral">&#39;fitwidth&#39;</span> =&gt; <span class="keyword">true</span>,
<a name="l04251"></a>04251                 <span class="stringliteral">&#39;cellfitalign&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,
<a name="l04252"></a>04252                 <span class="stringliteral">&#39;border&#39;</span> =&gt; <span class="keyword">false</span>,
<a name="l04253"></a>04253                 <span class="stringliteral">&#39;padding&#39;</span> =&gt; 0,
<a name="l04254"></a>04254                 <span class="stringliteral">&#39;fgcolor&#39;</span> =&gt; array(0,0,0),
<a name="l04255"></a>04255                 <span class="stringliteral">&#39;bgcolor&#39;</span> =&gt; <span class="keyword">false</span>,
<a name="l04256"></a>04256                 <span class="stringliteral">&#39;text&#39;</span> =&gt; <span class="keyword">false</span>
<a name="l04257"></a>04257             );
<a name="l04258"></a>04258             $this-&gt;<a class="code" href="classTCPDF.html#a4816d61822a4bad6e35bb441c1699aab" title="Print a Linear Barcode.">write1DBarcode</a>(<a class="code" href="classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8" title="Barcode to print on page footer (only if set).">$barcode</a>, <span class="stringliteral">&#39;C128&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $cur_y + $line_width, <span class="stringliteral">&#39;&#39;</span>, (($this-&gt;footer_margin / 3) - $line_width), 0.3, $style, <span class="stringliteral">&#39;&#39;</span>);
<a name="l04259"></a>04259         }
<a name="l04260"></a>04260         <span class="keywordflow">if</span> (empty($this-&gt;pagegroups)) {
<a name="l04261"></a>04261             $pagenumtxt = $this-&gt;l[<span class="stringliteral">&#39;w_page&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$this-&gt;<a class="code" href="classTCPDF.html#ae11c5f52caa0df8609ec22c30cd54055" title="Returns the string alias used for the page number.">getAliasNumPage</a>().<span class="stringliteral">&#39; / &#39;</span>.$this-&gt;<a class="code" href="classTCPDF.html#a3a6255516dcf07089fe29f13b3ef67bf" title="Returns the string alias used for the total number of pages.">getAliasNbPages</a>();
<a name="l04262"></a>04262         } <span class="keywordflow">else</span> {
<a name="l04263"></a>04263             $pagenumtxt = $this-&gt;l[<span class="stringliteral">&#39;w_page&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$this-&gt;<a class="code" href="classTCPDF.html#a015d1f6a5d39877206bf2b12163eddcc" title="Return the alias for the page number on the current page group.">getPageNumGroupAlias</a>().<span class="stringliteral">&#39; / &#39;</span>.$this-&gt;<a class="code" href="classTCPDF.html#af73382321461f24798a639c2f433a67f" title="Return the alias for the total number of pages in the current page group.">getPageGroupAlias</a>();
<a name="l04264"></a>04264         }
<a name="l04265"></a>04265         $this-&gt;<a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758" title="Moves the current abscissa back to the left margin and sets the ordinate.">SetY</a>($cur_y);
<a name="l04266"></a>04266         <span class="comment">//Print page number</span>
<a name="l04267"></a>04267         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#af01238bb928c4e3de6ed6aaa855fd788" title="Return the RTL status.">getRTL</a>()) {
<a name="l04268"></a>04268             $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>($this-&gt;original_rMargin);
<a name="l04269"></a>04269             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(0, 0, $pagenumtxt, <span class="charliteral">&#39;T&#39;</span>, 0, <span class="charliteral">&#39;L&#39;</span>);
<a name="l04270"></a>04270         } <span class="keywordflow">else</span> {
<a name="l04271"></a>04271             $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>($this-&gt;original_lMargin);
<a name="l04272"></a>04272             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(0, 0, $this-&gt;<a class="code" href="classTCPDF.html#ad089fa332b723086484ae0497ae90590" title="Returns the string alias used right align page numbers.">getAliasRightShift</a>().$pagenumtxt, <span class="charliteral">&#39;T&#39;</span>, 0, <span class="charliteral">&#39;R&#39;</span>);
<a name="l04273"></a>04273         }
<a name="l04274"></a>04274     }
<a name="l04275"></a>04275 <span class="comment"></span>
<a name="l04276"></a>04276 <span class="comment">    /**</span>
<a name="l04277"></a>04277 <span class="comment">     * This method is used to render the page header.</span>
<a name="l04278"></a>04278 <span class="comment">     * @protected</span>
<a name="l04279"></a>04279 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l04280"></a>04280 <span class="comment">     */</span>
<a name="l04281"></a><a class="code" href="classTCPDF.html#a9e36d6b325764815dd652636ece7eead">04281</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9e36d6b325764815dd652636ece7eead" title="This method is used to render the page header.">setHeader</a>() {
<a name="l04282"></a>04282         <span class="keywordflow">if</span> (!$this-&gt;print_header) {
<a name="l04283"></a>04283             <span class="keywordflow">return</span>;
<a name="l04284"></a>04284         }
<a name="l04285"></a>04285         $this-&gt;InHeader = <span class="keyword">true</span>;
<a name="l04286"></a>04286         $this-&gt;<a class="code" href="classTCPDF.html#a072053646725b19770a795050b3b6221" title="Set graphic variables.">setGraphicVars</a>($this-&gt;default_graphic_vars);
<a name="l04287"></a>04287         $temp_thead = $this-&gt;thead;
<a name="l04288"></a>04288         $temp_theadMargins = $this-&gt;theadMargins;
<a name="l04289"></a>04289         <a class="code" href="classTCPDF.html#a41e87b05a84dd56c2c824af49470e295" title="Height of last cell printed.">$lasth</a> = $this-&gt;lasth;
<a name="l04290"></a>04290         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<span class="charliteral">&#39;q&#39;</span>);
<a name="l04291"></a>04291         $this-&gt;rMargin = $this-&gt;original_rMargin;
<a name="l04292"></a>04292         $this-&gt;lMargin = $this-&gt;original_lMargin;
<a name="l04293"></a>04293         $this-&gt;<a class="code" href="classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1" title="Set the same internal Cell padding for top, right, bottom, left-.">SetCellPadding</a>(0);
<a name="l04294"></a>04294         <span class="comment">//set current position</span>
<a name="l04295"></a>04295         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l04296"></a>04296             $this-&gt;<a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>($this-&gt;original_rMargin, $this-&gt;header_margin);
<a name="l04297"></a>04297         } <span class="keywordflow">else</span> {
<a name="l04298"></a>04298             $this-&gt;<a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>($this-&gt;original_lMargin, $this-&gt;header_margin);
<a name="l04299"></a>04299         }
<a name="l04300"></a>04300         $this-&gt;<a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e" title="Sets the font used to print character strings.">SetFont</a>($this-&gt;header_font[0], $this-&gt;header_font[1], $this-&gt;header_font[2]);
<a name="l04301"></a>04301         $this-&gt;<a class="code" href="classTCPDF.html#a553f8a9bbb5301f983ebfd64544cb7a8" title="This method is used to render the page header.">Header</a>();
<a name="l04302"></a>04302         <span class="comment">//restore position</span>
<a name="l04303"></a>04303         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l04304"></a>04304             $this-&gt;<a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>($this-&gt;original_rMargin, $this-&gt;tMargin);
<a name="l04305"></a>04305         } <span class="keywordflow">else</span> {
<a name="l04306"></a>04306             $this-&gt;<a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>($this-&gt;original_lMargin, $this-&gt;tMargin);
<a name="l04307"></a>04307         }
<a name="l04308"></a>04308         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<span class="charliteral">&#39;Q&#39;</span>);
<a name="l04309"></a>04309         $this-&gt;lasth = <a class="code" href="classTCPDF.html#a41e87b05a84dd56c2c824af49470e295" title="Height of last cell printed.">$lasth</a>;
<a name="l04310"></a>04310         $this-&gt;thead = $temp_thead;
<a name="l04311"></a>04311         $this-&gt;theadMargins = $temp_theadMargins;
<a name="l04312"></a>04312         $this-&gt;newline = <span class="keyword">false</span>;
<a name="l04313"></a>04313         $this-&gt;InHeader = <span class="keyword">false</span>;
<a name="l04314"></a>04314     }
<a name="l04315"></a>04315 <span class="comment"></span>
<a name="l04316"></a>04316 <span class="comment">    /**</span>
<a name="l04317"></a>04317 <span class="comment">     * This method is used to render the page footer.</span>
<a name="l04318"></a>04318 <span class="comment">     * @protected</span>
<a name="l04319"></a>04319 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l04320"></a>04320 <span class="comment">     */</span>
<a name="l04321"></a><a class="code" href="classTCPDF.html#a7b0675e51b6f7ab3e4730feef3c86fb5">04321</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7b0675e51b6f7ab3e4730feef3c86fb5" title="This method is used to render the page footer.">setFooter</a>() {
<a name="l04322"></a>04322         <span class="comment">//Page footer</span>
<a name="l04323"></a>04323         $this-&gt;InFooter = <span class="keyword">true</span>;
<a name="l04324"></a>04324         <span class="comment">// save current graphic settings</span>
<a name="l04325"></a>04325         $gvars = $this-&gt;<a class="code" href="classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a" title="Returns current graphic variables as array.">getGraphicVars</a>();
<a name="l04326"></a>04326         <span class="comment">// mark this point</span>
<a name="l04327"></a>04327         $this-&gt;footerpos[$this-&gt;page] = $this-&gt;pagelen[$this-&gt;page];
<a name="l04328"></a>04328         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l04329"></a>04329         <span class="keywordflow">if</span> ($this-&gt;print_footer) {
<a name="l04330"></a>04330             $this-&gt;<a class="code" href="classTCPDF.html#a072053646725b19770a795050b3b6221" title="Set graphic variables.">setGraphicVars</a>($this-&gt;default_graphic_vars);
<a name="l04331"></a>04331             $this-&gt;current_column = 0;
<a name="l04332"></a>04332             $this-&gt;num_columns = 1;
<a name="l04333"></a>04333             $temp_thead = $this-&gt;thead;
<a name="l04334"></a>04334             $temp_theadMargins = $this-&gt;theadMargins;
<a name="l04335"></a>04335             <a class="code" href="classTCPDF.html#a41e87b05a84dd56c2c824af49470e295" title="Height of last cell printed.">$lasth</a> = $this-&gt;lasth;
<a name="l04336"></a>04336             $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<span class="charliteral">&#39;q&#39;</span>);
<a name="l04337"></a>04337             $this-&gt;rMargin = $this-&gt;original_rMargin;
<a name="l04338"></a>04338             $this-&gt;lMargin = $this-&gt;original_lMargin;
<a name="l04339"></a>04339             $this-&gt;<a class="code" href="classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1" title="Set the same internal Cell padding for top, right, bottom, left-.">SetCellPadding</a>(0);
<a name="l04340"></a>04340             <span class="comment">//set current position</span>
<a name="l04341"></a>04341             $footer_y = $this-&gt;h - $this-&gt;footer_margin;
<a name="l04342"></a>04342             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l04343"></a>04343                 $this-&gt;<a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>($this-&gt;original_rMargin, $footer_y);
<a name="l04344"></a>04344             } <span class="keywordflow">else</span> {
<a name="l04345"></a>04345                 $this-&gt;<a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>($this-&gt;original_lMargin, $footer_y);
<a name="l04346"></a>04346             }
<a name="l04347"></a>04347             $this-&gt;<a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e" title="Sets the font used to print character strings.">SetFont</a>($this-&gt;footer_font[0], $this-&gt;footer_font[1], $this-&gt;footer_font[2]);
<a name="l04348"></a>04348             $this-&gt;<a class="code" href="classTCPDF.html#ae40eff8871e1deebf4bea96de4d8a3e4" title="This method is used to render the page footer.">Footer</a>();
<a name="l04349"></a>04349             <span class="comment">//restore position</span>
<a name="l04350"></a>04350             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l04351"></a>04351                 $this-&gt;<a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>($this-&gt;original_rMargin, $this-&gt;tMargin);
<a name="l04352"></a>04352             } <span class="keywordflow">else</span> {
<a name="l04353"></a>04353                 $this-&gt;<a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>($this-&gt;original_lMargin, $this-&gt;tMargin);
<a name="l04354"></a>04354             }
<a name="l04355"></a>04355             $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<span class="charliteral">&#39;Q&#39;</span>);
<a name="l04356"></a>04356             $this-&gt;lasth = <a class="code" href="classTCPDF.html#a41e87b05a84dd56c2c824af49470e295" title="Height of last cell printed.">$lasth</a>;
<a name="l04357"></a>04357             $this-&gt;thead = $temp_thead;
<a name="l04358"></a>04358             $this-&gt;theadMargins = $temp_theadMargins;
<a name="l04359"></a>04359         }
<a name="l04360"></a>04360         <span class="comment">// restore graphic settings</span>
<a name="l04361"></a>04361         $this-&gt;<a class="code" href="classTCPDF.html#a072053646725b19770a795050b3b6221" title="Set graphic variables.">setGraphicVars</a>($gvars);
<a name="l04362"></a>04362         $this-&gt;current_column = $gvars[<span class="stringliteral">&#39;current_column&#39;</span>];
<a name="l04363"></a>04363         $this-&gt;num_columns = $gvars[<span class="stringliteral">&#39;num_columns&#39;</span>];
<a name="l04364"></a>04364         <span class="comment">// calculate footer length</span>
<a name="l04365"></a>04365         $this-&gt;footerlen[$this-&gt;page] = $this-&gt;pagelen[$this-&gt;page] - $this-&gt;footerpos[$this-&gt;page] + 1;
<a name="l04366"></a>04366         $this-&gt;InFooter = <span class="keyword">false</span>;
<a name="l04367"></a>04367     }
<a name="l04368"></a>04368 <span class="comment"></span>
<a name="l04369"></a>04369 <span class="comment">    /**</span>
<a name="l04370"></a>04370 <span class="comment">     * Check if we are on the page body (excluding page header and footer).</span>
<a name="l04371"></a>04371 <span class="comment">     * @return true if we are not in page header nor in page footer, false otherwise.</span>
<a name="l04372"></a>04372 <span class="comment">     * @protected</span>
<a name="l04373"></a>04373 <span class="comment">     * @since 5.9.091 (2011-06-15)</span>
<a name="l04374"></a>04374 <span class="comment">     */</span>
<a name="l04375"></a><a class="code" href="classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c">04375</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c" title="Check if we are on the page body (excluding page header and footer).">inPageBody</a>() {
<a name="l04376"></a>04376         <span class="keywordflow">return</span> (($this-&gt;InHeader === <span class="keyword">false</span>) AND ($this-&gt;InFooter === <span class="keyword">false</span>));
<a name="l04377"></a>04377     }
<a name="l04378"></a>04378 <span class="comment"></span>
<a name="l04379"></a>04379 <span class="comment">    /**</span>
<a name="l04380"></a>04380 <span class="comment">     * This method is used to render the table header on new page (if any).</span>
<a name="l04381"></a>04381 <span class="comment">     * @protected</span>
<a name="l04382"></a>04382 <span class="comment">     * @since 4.5.030 (2009-03-25)</span>
<a name="l04383"></a>04383 <span class="comment">     */</span>
<a name="l04384"></a><a class="code" href="classTCPDF.html#a52a8502589754eefe8da17efdd40329b">04384</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a52a8502589754eefe8da17efdd40329b" title="This method is used to render the table header on new page (if any).">setTableHeader</a>() {
<a name="l04385"></a>04385         <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {
<a name="l04386"></a>04386             <span class="comment">// multi column mode</span>
<a name="l04387"></a>04387             <span class="keywordflow">return</span>;
<a name="l04388"></a>04388         }
<a name="l04389"></a>04389         <span class="keywordflow">if</span> (isset($this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>])) {
<a name="l04390"></a>04390             <span class="comment">// restore the original top-margin</span>
<a name="l04391"></a>04391             $this-&gt;tMargin = $this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>];
<a name="l04392"></a>04392             $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;tm&#39;</span>] = $this-&gt;tMargin;
<a name="l04393"></a>04393             $this-&gt;y = $this-&gt;tMargin;
<a name="l04394"></a>04394         }
<a name="l04395"></a>04395         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($this-&gt;thead) AND (!$this-&gt;inthead)) {
<a name="l04396"></a>04396             <span class="comment">// set margins</span>
<a name="l04397"></a>04397             $prev_lMargin = $this-&gt;lMargin;
<a name="l04398"></a>04398             $prev_rMargin = $this-&gt;rMargin;
<a name="l04399"></a>04399             $prev_cell_padding = $this-&gt;cell_padding;
<a name="l04400"></a>04400             $this-&gt;lMargin = $this-&gt;theadMargins[<span class="stringliteral">&#39;lmargin&#39;</span>] + ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$this-&gt;theadMargins[<span class="stringliteral">&#39;page&#39;</span>]][<span class="stringliteral">&#39;olm&#39;</span>]);
<a name="l04401"></a>04401             $this-&gt;rMargin = $this-&gt;theadMargins[<span class="stringliteral">&#39;rmargin&#39;</span>] + ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$this-&gt;theadMargins[<span class="stringliteral">&#39;page&#39;</span>]][<span class="stringliteral">&#39;orm&#39;</span>]);
<a name="l04402"></a>04402             $this-&gt;cell_padding = $this-&gt;theadMargins[<span class="stringliteral">&#39;cell_padding&#39;</span>];
<a name="l04403"></a>04403             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l04404"></a>04404                 $this-&gt;x = $this-&gt;w - $this-&gt;rMargin;
<a name="l04405"></a>04405             } <span class="keywordflow">else</span> {
<a name="l04406"></a>04406                 $this-&gt;x = $this-&gt;lMargin;
<a name="l04407"></a>04407             }
<a name="l04408"></a>04408             <span class="comment">// account for special &quot;cell&quot; mode</span>
<a name="l04409"></a>04409             <span class="keywordflow">if</span> ($this-&gt;theadMargins[<span class="stringliteral">&#39;cell&#39;</span>]) {
<a name="l04410"></a>04410                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l04411"></a>04411                     $this-&gt;x -= $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l04412"></a>04412                 } <span class="keywordflow">else</span> {
<a name="l04413"></a>04413                     $this-&gt;x += $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];
<a name="l04414"></a>04414                 }
<a name="l04415"></a>04415             }
<a name="l04416"></a>04416             <span class="comment">// print table header</span>
<a name="l04417"></a>04417             $this-&gt;<a class="code" href="classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407" title="Allows to preserve some HTML formatting (limited support).">writeHTML</a>($this-&gt;thead, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l04418"></a>04418             <span class="comment">// set new top margin to skip the table headers</span>
<a name="l04419"></a>04419             <span class="keywordflow">if</span> (!isset($this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>])) {
<a name="l04420"></a>04420                 $this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>] = $this-&gt;tMargin;
<a name="l04421"></a>04421             }
<a name="l04422"></a>04422             <span class="comment">// store end of header position</span>
<a name="l04423"></a>04423             <span class="keywordflow">if</span> (!isset($this-&gt;columns[0][<span class="stringliteral">&#39;th&#39;</span>])) {
<a name="l04424"></a>04424                 $this-&gt;columns[0][<span class="stringliteral">&#39;th&#39;</span>] = array();
<a name="l04425"></a>04425             }
<a name="l04426"></a>04426             $this-&gt;columns[0][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$this-&gt;page.<span class="charliteral">&#39;\&#39;&#39;</span>] = $this-&gt;y;
<a name="l04427"></a>04427             $this-&gt;tMargin = $this-&gt;y;
<a name="l04428"></a>04428             $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;tm&#39;</span>] = $this-&gt;tMargin;
<a name="l04429"></a>04429             $this-&gt;lasth = 0;
<a name="l04430"></a>04430             $this-&gt;lMargin = $prev_lMargin;
<a name="l04431"></a>04431             $this-&gt;rMargin = $prev_rMargin;
<a name="l04432"></a>04432             $this-&gt;cell_padding = $prev_cell_padding;
<a name="l04433"></a>04433         }
<a name="l04434"></a>04434     }
<a name="l04435"></a>04435 <span class="comment"></span>
<a name="l04436"></a>04436 <span class="comment">    /**</span>
<a name="l04437"></a>04437 <span class="comment">     * Returns the current page number.</span>
<a name="l04438"></a>04438 <span class="comment">     * @return int page number</span>
<a name="l04439"></a>04439 <span class="comment">     * @public</span>
<a name="l04440"></a>04440 <span class="comment">     * @since 1.0</span>
<a name="l04441"></a>04441 <span class="comment">     * @see getAliasNbPages()</span>
<a name="l04442"></a>04442 <span class="comment">     */</span>
<a name="l04443"></a><a class="code" href="classTCPDF.html#a9ad828b184f08828f570a7e52316ba79">04443</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9ad828b184f08828f570a7e52316ba79" title="Returns the current page number.">PageNo</a>() {
<a name="l04444"></a>04444         <span class="keywordflow">return</span> $this-&gt;page;
<a name="l04445"></a>04445     }
<a name="l04446"></a>04446 <span class="comment"></span>
<a name="l04447"></a>04447 <span class="comment">    /**</span>
<a name="l04448"></a>04448 <span class="comment">     * Defines a new spot color.</span>
<a name="l04449"></a>04449 <span class="comment">     * It can be expressed in RGB components or gray scale.</span>
<a name="l04450"></a>04450 <span class="comment">     * The method can be called before the first page is created and the value is retained from page to page.</span>
<a name="l04451"></a>04451 <span class="comment">     * @param $name (string) Full name of the spot color.</span>
<a name="l04452"></a>04452 <span class="comment">     * @param $c (float) Cyan color for CMYK. Value between 0 and 100.</span>
<a name="l04453"></a>04453 <span class="comment">     * @param $m (float) Magenta color for CMYK. Value between 0 and 100.</span>
<a name="l04454"></a>04454 <span class="comment">     * @param $y (float) Yellow color for CMYK. Value between 0 and 100.</span>
<a name="l04455"></a>04455 <span class="comment">     * @param $k (float) Key (Black) color for CMYK. Value between 0 and 100.</span>
<a name="l04456"></a>04456 <span class="comment">     * @public</span>
<a name="l04457"></a>04457 <span class="comment">     * @since 4.0.024 (2008-09-12)</span>
<a name="l04458"></a>04458 <span class="comment">     * @see SetDrawSpotColor(), SetFillSpotColor(), SetTextSpotColor()</span>
<a name="l04459"></a>04459 <span class="comment">     */</span>
<a name="l04460"></a><a class="code" href="classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457">04460</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457" title="Defines a new spot color.">AddSpotColor</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, <a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l04461"></a>04461         <span class="keywordflow">if</span> (!isset($this-&gt;spot_colors[<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>])) {
<a name="l04462"></a>04462             <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = (1 + count($this-&gt;spot_colors));
<a name="l04463"></a>04463             $this-&gt;spot_colors[<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>] = array(<span class="charliteral">&#39;C&#39;</span> =&gt; <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, <span class="charliteral">&#39;M&#39;</span> =&gt; <a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>, <span class="charliteral">&#39;Y&#39;</span> =&gt; <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <span class="charliteral">&#39;K&#39;</span> =&gt; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>, <span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="charliteral">&#39;i&#39;</span> =&gt; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>);
<a name="l04464"></a>04464         }
<a name="l04465"></a>04465     }
<a name="l04466"></a>04466 <span class="comment"></span>
<a name="l04467"></a>04467 <span class="comment">    /**</span>
<a name="l04468"></a>04468 <span class="comment">     * Return the Spot color array.</span>
<a name="l04469"></a>04469 <span class="comment">     * @param $name (string) Name of the spot color.</span>
<a name="l04470"></a>04470 <span class="comment">     * @return (array) Spot color array or false if not defined.</span>
<a name="l04471"></a>04471 <span class="comment">     * @public</span>
<a name="l04472"></a>04472 <span class="comment">     * @since 5.9.125 (2011-10-03)</span>
<a name="l04473"></a>04473 <span class="comment">     */</span>
<a name="l04474"></a><a class="code" href="classTCPDF.html#a29cc6f2fc282c8c0a3c3ea3e29729ec9">04474</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a29cc6f2fc282c8c0a3c3ea3e29729ec9" title="Return the Spot color array.">getSpotColor</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) {
<a name="l04475"></a>04475         <span class="keywordflow">if</span> (isset($this-&gt;spot_colors[<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>])) {
<a name="l04476"></a>04476             <span class="keywordflow">return</span> $this-&gt;spot_colors[<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>];
<a name="l04477"></a>04477         }
<a name="l04478"></a>04478         $color = preg_replace(<span class="stringliteral">&#39;/[\s]*/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $name); <span class="comment">// remove extra spaces</span>
<a name="l04479"></a>04479         $color = strtolower($color);
<a name="l04480"></a>04480         <span class="keywordflow">if</span> (isset($this-&gt;spotcolor[$color])) {
<a name="l04481"></a>04481             $this-&gt;<a class="code" href="classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457" title="Defines a new spot color.">AddSpotColor</a>($this-&gt;spotcolor[$color][4], $this-&gt;spotcolor[$color][0], $this-&gt;spotcolor[$color][1], $this-&gt;spotcolor[$color][2], $this-&gt;spotcolor[$color][3]);
<a name="l04482"></a>04482             <span class="keywordflow">return</span> $this-&gt;spot_colors[$this-&gt;spotcolor[$color][4]];
<a name="l04483"></a>04483         }
<a name="l04484"></a>04484         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l04485"></a>04485     }
<a name="l04486"></a>04486 <span class="comment"></span>
<a name="l04487"></a>04487 <span class="comment">    /**</span>
<a name="l04488"></a>04488 <span class="comment">     * Set the spot color for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).</span>
<a name="l04489"></a>04489 <span class="comment">     * @param $type (string) Type of object affected by this color: (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).</span>
<a name="l04490"></a>04490 <span class="comment">     * @param $name (string) Name of the spot color.</span>
<a name="l04491"></a>04491 <span class="comment">     * @param $tint (float) Intensity of the color (from 0 to 100 ; 100 = full intensity by default).</span>
<a name="l04492"></a>04492 <span class="comment">     * @return (string) PDF color command.</span>
<a name="l04493"></a>04493 <span class="comment">     * @public</span>
<a name="l04494"></a>04494 <span class="comment">     * @since 5.9.125 (2011-10-03)</span>
<a name="l04495"></a>04495 <span class="comment">     */</span>
<a name="l04496"></a><a class="code" href="classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf">04496</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf" title="Set the spot color for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setSpotColor</a>(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $tint=100) {
<a name="l04497"></a>04497         <a class="code" href="classTCPDF.html#a5d5366fdb9fc2ad74898e5fc149e801c" title="Array containing spot color names and values.">$spotcolor</a> = $this-&gt;<a class="code" href="classTCPDF.html#a29cc6f2fc282c8c0a3c3ea3e29729ec9" title="Return the Spot color array.">getSpotColor</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l04498"></a>04498         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a5d5366fdb9fc2ad74898e5fc149e801c" title="Array containing spot color names and values.">$spotcolor</a> === <span class="keyword">false</span>) {
<a name="l04499"></a>04499             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Undefined spot color: &#39;</span>.<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>.<span class="stringliteral">&#39;, you must add it on the spotcolors.php file.&#39;</span>);
<a name="l04500"></a>04500         }
<a name="l04501"></a>04501         $tint = (max(0, min(100, $tint)) / 100);
<a name="l04502"></a>04502         $pdfcolor = sprintf(<span class="stringliteral">&#39;/CS%d &#39;</span>, $this-&gt;spot_colors[<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>][<span class="charliteral">&#39;i&#39;</span>]);
<a name="l04503"></a>04503         <span class="keywordflow">switch</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>) {
<a name="l04504"></a>04504             <span class="keywordflow">case</span> <span class="stringliteral">&#39;draw&#39;</span>: {
<a name="l04505"></a>04505                 $pdfcolor .= sprintf(<span class="stringliteral">&#39;CS %.3F SCN&#39;</span>, $tint);
<a name="l04506"></a>04506                 $this-&gt;DrawColor = $pdfcolor;
<a name="l04507"></a>04507                 $this-&gt;strokecolor = <a class="code" href="classTCPDF.html#a5d5366fdb9fc2ad74898e5fc149e801c" title="Array containing spot color names and values.">$spotcolor</a>;
<a name="l04508"></a>04508                 <span class="keywordflow">break</span>;
<a name="l04509"></a>04509             }
<a name="l04510"></a>04510             <span class="keywordflow">case</span> <span class="stringliteral">&#39;fill&#39;</span>: {
<a name="l04511"></a>04511                 $pdfcolor .= sprintf(<span class="stringliteral">&#39;cs %.3F scn&#39;</span>, $tint);
<a name="l04512"></a>04512                 $this-&gt;FillColor = $pdfcolor;
<a name="l04513"></a>04513                 $this-&gt;bgcolor = <a class="code" href="classTCPDF.html#a5d5366fdb9fc2ad74898e5fc149e801c" title="Array containing spot color names and values.">$spotcolor</a>;
<a name="l04514"></a>04514                 <span class="keywordflow">break</span>;
<a name="l04515"></a>04515             }
<a name="l04516"></a>04516             <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>: {
<a name="l04517"></a>04517                 $pdfcolor .= sprintf(<span class="stringliteral">&#39;cs %.3F scn&#39;</span>, $tint);
<a name="l04518"></a>04518                 $this-&gt;TextColor = $pdfcolor;
<a name="l04519"></a>04519                 $this-&gt;fgcolor = <a class="code" href="classTCPDF.html#a5d5366fdb9fc2ad74898e5fc149e801c" title="Array containing spot color names and values.">$spotcolor</a>;
<a name="l04520"></a>04520                 <span class="keywordflow">break</span>;
<a name="l04521"></a>04521             }
<a name="l04522"></a>04522         }
<a name="l04523"></a>04523         $this-&gt;ColorFlag = ($this-&gt;FillColor != $this-&gt;TextColor);
<a name="l04524"></a>04524         <span class="keywordflow">if</span> ($this-&gt;page &gt; 0) {
<a name="l04525"></a>04525             $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>($pdfcolor);
<a name="l04526"></a>04526         }
<a name="l04527"></a>04527         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l04528"></a>04528             <span class="comment">// we are inside an XObject template</span>
<a name="l04529"></a>04529             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;spot_colors&#39;</span>][<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>] = $this-&gt;spot_colors[<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>];
<a name="l04530"></a>04530         }
<a name="l04531"></a>04531         <span class="keywordflow">return</span> $pdfcolor;
<a name="l04532"></a>04532     }
<a name="l04533"></a>04533 <span class="comment"></span>
<a name="l04534"></a>04534 <span class="comment">    /**</span>
<a name="l04535"></a>04535 <span class="comment">     * Defines the spot color used for all drawing operations (lines, rectangles and cell borders).</span>
<a name="l04536"></a>04536 <span class="comment">     * @param $name (string) Name of the spot color.</span>
<a name="l04537"></a>04537 <span class="comment">     * @param $tint (float) Intensity of the color (from 0 to 100 ; 100 = full intensity by default).</span>
<a name="l04538"></a>04538 <span class="comment">     * @public</span>
<a name="l04539"></a>04539 <span class="comment">     * @since 4.0.024 (2008-09-12)</span>
<a name="l04540"></a>04540 <span class="comment">     * @see AddSpotColor(), SetFillSpotColor(), SetTextSpotColor()</span>
<a name="l04541"></a>04541 <span class="comment">     */</span>
<a name="l04542"></a><a class="code" href="classTCPDF.html#af17e978f511addd7a3000d71ebf4ab55">04542</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af17e978f511addd7a3000d71ebf4ab55" title="Defines the spot color used for all drawing operations (lines, rectangles and cell borders)...">SetDrawSpotColor</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $tint=100) {
<a name="l04543"></a>04543         $this-&gt;<a class="code" href="classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf" title="Set the spot color for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setSpotColor</a>(<span class="stringliteral">&#39;draw&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $tint);
<a name="l04544"></a>04544     }
<a name="l04545"></a>04545 <span class="comment"></span>
<a name="l04546"></a>04546 <span class="comment">    /**</span>
<a name="l04547"></a>04547 <span class="comment">     * Defines the spot color used for all filling operations (filled rectangles and cell backgrounds).</span>
<a name="l04548"></a>04548 <span class="comment">     * @param $name (string) Name of the spot color.</span>
<a name="l04549"></a>04549 <span class="comment">     * @param $tint (float) Intensity of the color (from 0 to 100 ; 100 = full intensity by default).</span>
<a name="l04550"></a>04550 <span class="comment">     * @public</span>
<a name="l04551"></a>04551 <span class="comment">     * @since 4.0.024 (2008-09-12)</span>
<a name="l04552"></a>04552 <span class="comment">     * @see AddSpotColor(), SetDrawSpotColor(), SetTextSpotColor()</span>
<a name="l04553"></a>04553 <span class="comment">     */</span>
<a name="l04554"></a><a class="code" href="classTCPDF.html#a78c46e485a0c0c10b0f8aee7169ffc67">04554</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a78c46e485a0c0c10b0f8aee7169ffc67" title="Defines the spot color used for all filling operations (filled rectangles and cell backgrounds)...">SetFillSpotColor</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $tint=100) {
<a name="l04555"></a>04555         $this-&gt;<a class="code" href="classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf" title="Set the spot color for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setSpotColor</a>(<span class="stringliteral">&#39;fill&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $tint);
<a name="l04556"></a>04556     }
<a name="l04557"></a>04557 <span class="comment"></span>
<a name="l04558"></a>04558 <span class="comment">    /**</span>
<a name="l04559"></a>04559 <span class="comment">     * Defines the spot color used for text.</span>
<a name="l04560"></a>04560 <span class="comment">     * @param $name (string) Name of the spot color.</span>
<a name="l04561"></a>04561 <span class="comment">     * @param $tint (int) Intensity of the color (from 0 to 100 ; 100 = full intensity by default).</span>
<a name="l04562"></a>04562 <span class="comment">     * @public</span>
<a name="l04563"></a>04563 <span class="comment">     * @since 4.0.024 (2008-09-12)</span>
<a name="l04564"></a>04564 <span class="comment">     * @see AddSpotColor(), SetDrawSpotColor(), SetFillSpotColor()</span>
<a name="l04565"></a>04565 <span class="comment">     */</span>
<a name="l04566"></a><a class="code" href="classTCPDF.html#af18f6bdb79e68fd8ed6386d2bb98e9a2">04566</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af18f6bdb79e68fd8ed6386d2bb98e9a2" title="Defines the spot color used for text.">SetTextSpotColor</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $tint=100) {
<a name="l04567"></a>04567         $this-&gt;<a class="code" href="classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf" title="Set the spot color for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setSpotColor</a>(<span class="stringliteral">&#39;text&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $tint);
<a name="l04568"></a>04568     }
<a name="l04569"></a>04569 <span class="comment"></span>
<a name="l04570"></a>04570 <span class="comment">    /**</span>
<a name="l04571"></a>04571 <span class="comment">     * Set the color array for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).</span>
<a name="l04572"></a>04572 <span class="comment">     * It can be expressed in RGB, CMYK or GRAY SCALE components.</span>
<a name="l04573"></a>04573 <span class="comment">     * The method can be called before the first page is created and the value is retained from page to page.</span>
<a name="l04574"></a>04574 <span class="comment">     * @param $type (string) Type of object affected by this color: (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).</span>
<a name="l04575"></a>04575 <span class="comment">     * @param $color (array) Array of colors (1=gray, 3=RGB, 4=CMYK or 5=spotcolor=CMYK+name values).</span>
<a name="l04576"></a>04576 <span class="comment">     * @param $ret (boolean) If true do not send the PDF command.</span>
<a name="l04577"></a>04577 <span class="comment">     * @return (string) The PDF command or empty string.</span>
<a name="l04578"></a>04578 <span class="comment">     * @public</span>
<a name="l04579"></a>04579 <span class="comment">     * @since 3.1.000 (2008-06-11)</span>
<a name="l04580"></a>04580 <span class="comment">     */</span>
<a name="l04581"></a><a class="code" href="classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14">04581</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14" title="Set the color array for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setColorArray</a>(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $color, $ret=<span class="keyword">false</span>) {
<a name="l04582"></a>04582         <span class="keywordflow">if</span> (is_array($color)) {
<a name="l04583"></a>04583             $color = array_values($color);
<a name="l04584"></a>04584             <span class="comment">// component: grey, RGB red or CMYK cyan</span>
<a name="l04585"></a>04585             <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = isset($color[0]) ? $color[0] : -1;
<a name="l04586"></a>04586             <span class="comment">// component: RGB green or CMYK magenta</span>
<a name="l04587"></a>04587             <a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a> = isset($color[1]) ? $color[1] : -1;
<a name="l04588"></a>04588             <span class="comment">// component: RGB blue or CMYK yellow</span>
<a name="l04589"></a>04589             <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = isset($color[2]) ? $color[2] : -1;
<a name="l04590"></a>04590             <span class="comment">// component: CMYK black</span>
<a name="l04591"></a>04591             <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = isset($color[3]) ? $color[3] : -1;
<a name="l04592"></a>04592             <span class="comment">// color name</span>
<a name="l04593"></a>04593             <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = isset($color[4]) ? $color[4] : <span class="stringliteral">&#39;&#39;</span>;
<a name="l04594"></a>04594             <span class="keywordflow">if</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &gt;= 0) {
<a name="l04595"></a>04595                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd" title="Defines the color used by the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setColor</a>(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, <a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>, $ret, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l04596"></a>04596             }
<a name="l04597"></a>04597         }
<a name="l04598"></a>04598         <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l04599"></a>04599     }
<a name="l04600"></a>04600 <span class="comment"></span>
<a name="l04601"></a>04601 <span class="comment">    /**</span>
<a name="l04602"></a>04602 <span class="comment">     * Defines the color used for all drawing operations (lines, rectangles and cell borders).</span>
<a name="l04603"></a>04603 <span class="comment">     * It can be expressed in RGB, CMYK or GRAY SCALE components.</span>
<a name="l04604"></a>04604 <span class="comment">     * The method can be called before the first page is created and the value is retained from page to page.</span>
<a name="l04605"></a>04605 <span class="comment">     * @param $color (array) Array of colors (1, 3 or 4 values).</span>
<a name="l04606"></a>04606 <span class="comment">     * @param $ret (boolean) If true do not send the PDF command.</span>
<a name="l04607"></a>04607 <span class="comment">     * @return string the PDF command</span>
<a name="l04608"></a>04608 <span class="comment">     * @public</span>
<a name="l04609"></a>04609 <span class="comment">     * @since 3.1.000 (2008-06-11)</span>
<a name="l04610"></a>04610 <span class="comment">     * @see SetDrawColor()</span>
<a name="l04611"></a>04611 <span class="comment">     */</span>
<a name="l04612"></a><a class="code" href="classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e">04612</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e" title="Defines the color used for all drawing operations (lines, rectangles and cell borders).">SetDrawColorArray</a>($color, $ret=<span class="keyword">false</span>) {
<a name="l04613"></a>04613         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14" title="Set the color array for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setColorArray</a>(<span class="stringliteral">&#39;draw&#39;</span>, $color, $ret);
<a name="l04614"></a>04614     }
<a name="l04615"></a>04615 <span class="comment"></span>
<a name="l04616"></a>04616 <span class="comment">    /**</span>
<a name="l04617"></a>04617 <span class="comment">     * Defines the color used for all filling operations (filled rectangles and cell backgrounds).</span>
<a name="l04618"></a>04618 <span class="comment">     * It can be expressed in RGB, CMYK or GRAY SCALE components.</span>
<a name="l04619"></a>04619 <span class="comment">     * The method can be called before the first page is created and the value is retained from page to page.</span>
<a name="l04620"></a>04620 <span class="comment">     * @param $color (array) Array of colors (1, 3 or 4 values).</span>
<a name="l04621"></a>04621 <span class="comment">     * @param $ret (boolean) If true do not send the PDF command.</span>
<a name="l04622"></a>04622 <span class="comment">     * @public</span>
<a name="l04623"></a>04623 <span class="comment">     * @since 3.1.000 (2008-6-11)</span>
<a name="l04624"></a>04624 <span class="comment">     * @see SetFillColor()</span>
<a name="l04625"></a>04625 <span class="comment">     */</span>
<a name="l04626"></a><a class="code" href="classTCPDF.html#a850dd347f649c99548a193f2b84a502e">04626</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a850dd347f649c99548a193f2b84a502e" title="Defines the color used for all filling operations (filled rectangles and cell backgrounds).">SetFillColorArray</a>($color, $ret=<span class="keyword">false</span>) {
<a name="l04627"></a>04627         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14" title="Set the color array for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setColorArray</a>(<span class="stringliteral">&#39;fill&#39;</span>, $color, $ret);
<a name="l04628"></a>04628     }
<a name="l04629"></a>04629 <span class="comment"></span>
<a name="l04630"></a>04630 <span class="comment">    /**</span>
<a name="l04631"></a>04631 <span class="comment">     * Defines the color used for text. It can be expressed in RGB components or gray scale.</span>
<a name="l04632"></a>04632 <span class="comment">     * The method can be called before the first page is created and the value is retained from page to page.</span>
<a name="l04633"></a>04633 <span class="comment">     * @param $color (array) Array of colors (1, 3 or 4 values).</span>
<a name="l04634"></a>04634 <span class="comment">     * @param $ret (boolean) If true do not send the PDF command.</span>
<a name="l04635"></a>04635 <span class="comment">     * @public</span>
<a name="l04636"></a>04636 <span class="comment">     * @since 3.1.000 (2008-6-11)</span>
<a name="l04637"></a>04637 <span class="comment">     * @see SetFillColor()</span>
<a name="l04638"></a>04638 <span class="comment">     */</span>
<a name="l04639"></a><a class="code" href="classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">04639</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566" title="Defines the color used for text.">SetTextColorArray</a>($color, $ret=<span class="keyword">false</span>) {
<a name="l04640"></a>04640         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14" title="Set the color array for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setColorArray</a>(<span class="stringliteral">&#39;text&#39;</span>, $color, $ret);
<a name="l04641"></a>04641     }
<a name="l04642"></a>04642 <span class="comment"></span>
<a name="l04643"></a>04643 <span class="comment">    /**</span>
<a name="l04644"></a>04644 <span class="comment">     * Defines the color used by the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).</span>
<a name="l04645"></a>04645 <span class="comment">     * @param $type (string) Type of object affected by this color: (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).</span>
<a name="l04646"></a>04646 <span class="comment">     * @param $col1 (float) GRAY level for single color, or Red color for RGB (0-255), or CYAN color for CMYK (0-100).</span>
<a name="l04647"></a>04647 <span class="comment">     * @param $col2 (float) GREEN color for RGB (0-255), or MAGENTA color for CMYK (0-100).</span>
<a name="l04648"></a>04648 <span class="comment">     * @param $col3 (float) BLUE color for RGB (0-255), or YELLOW color for CMYK (0-100).</span>
<a name="l04649"></a>04649 <span class="comment">     * @param $col4 (float) KEY (BLACK) color for CMYK (0-100).</span>
<a name="l04650"></a>04650 <span class="comment">     * @param $ret (boolean) If true do not send the command.</span>
<a name="l04651"></a>04651 <span class="comment">     * @param $name (string) spot color name (if any)</span>
<a name="l04652"></a>04652 <span class="comment">     * @return (string) The PDF command or empty string.</span>
<a name="l04653"></a>04653 <span class="comment">     * @public</span>
<a name="l04654"></a>04654 <span class="comment">     * @since 5.9.125 (2011-10-03)</span>
<a name="l04655"></a>04655 <span class="comment">     */</span>
<a name="l04656"></a><a class="code" href="classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd">04656</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd" title="Defines the color used by the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setColor</a>(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=<span class="keyword">false</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l04657"></a>04657         <span class="comment">// set default values</span>
<a name="l04658"></a>04658         <span class="keywordflow">if</span> (!is_numeric($col1)) {
<a name="l04659"></a>04659             $col1 = 0;
<a name="l04660"></a>04660         }
<a name="l04661"></a>04661         <span class="keywordflow">if</span> (!is_numeric($col2)) {
<a name="l04662"></a>04662             $col2 = -1;
<a name="l04663"></a>04663         }
<a name="l04664"></a>04664         <span class="keywordflow">if</span> (!is_numeric($col3)) {
<a name="l04665"></a>04665             $col3 = -1;
<a name="l04666"></a>04666         }
<a name="l04667"></a>04667         <span class="keywordflow">if</span> (!is_numeric($col4)) {
<a name="l04668"></a>04668             $col4 = -1;
<a name="l04669"></a>04669         }
<a name="l04670"></a>04670         <span class="comment">// set color by case</span>
<a name="l04671"></a>04671         $suffix = <span class="stringliteral">&#39;&#39;</span>;
<a name="l04672"></a>04672         <span class="keywordflow">if</span> (($col2 == -1) AND ($col3 == -1) AND ($col4 == -1)) {
<a name="l04673"></a>04673             <span class="comment">// Grey scale</span>
<a name="l04674"></a>04674             $col1 = max(0, min(255, $col1));
<a name="l04675"></a>04675             $intcolor = array(<span class="charliteral">&#39;G&#39;</span> =&gt; $col1);
<a name="l04676"></a>04676             $pdfcolor = sprintf(<span class="stringliteral">&#39;%.3F &#39;</span>, ($col1 / 255));
<a name="l04677"></a>04677             $suffix = <span class="charliteral">&#39;g&#39;</span>;
<a name="l04678"></a>04678         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($col4 == -1) {
<a name="l04679"></a>04679             <span class="comment">// RGB</span>
<a name="l04680"></a>04680             $col1 = max(0, min(255, $col1));
<a name="l04681"></a>04681             $col2 = max(0, min(255, $col2));
<a name="l04682"></a>04682             $col3 = max(0, min(255, $col3));
<a name="l04683"></a>04683             $intcolor = array(<span class="charliteral">&#39;R&#39;</span> =&gt; $col1, <span class="charliteral">&#39;G&#39;</span> =&gt; $col2, <span class="charliteral">&#39;B&#39;</span> =&gt; $col3);
<a name="l04684"></a>04684             $pdfcolor = sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F &#39;</span>, ($col1 / 255), ($col2 / 255), ($col3 / 255));
<a name="l04685"></a>04685             $suffix = <span class="stringliteral">&#39;rg&#39;</span>;
<a name="l04686"></a>04686         } <span class="keywordflow">else</span> {
<a name="l04687"></a>04687             $col1 = max(0, min(100, $col1));
<a name="l04688"></a>04688             $col2 = max(0, min(100, $col2));
<a name="l04689"></a>04689             $col3 = max(0, min(100, $col3));
<a name="l04690"></a>04690             $col4 = max(0, min(100, $col4));
<a name="l04691"></a>04691             <span class="keywordflow">if</span> (empty(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>)) {
<a name="l04692"></a>04692                 <span class="comment">// CMYK</span>
<a name="l04693"></a>04693                 $intcolor = array(<span class="charliteral">&#39;C&#39;</span> =&gt; $col1, <span class="charliteral">&#39;M&#39;</span> =&gt; $col2, <span class="charliteral">&#39;Y&#39;</span> =&gt; $col3, <span class="charliteral">&#39;K&#39;</span> =&gt; $col4);
<a name="l04694"></a>04694                 $pdfcolor = sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F %.3F &#39;</span>, ($col1 / 100), ($col2 / 100), ($col3 / 100), ($col4 / 100));
<a name="l04695"></a>04695                 $suffix = <span class="charliteral">&#39;k&#39;</span>;
<a name="l04696"></a>04696             } <span class="keywordflow">else</span> {
<a name="l04697"></a>04697                 <span class="comment">// SPOT COLOR</span>
<a name="l04698"></a>04698                 $intcolor = array(<span class="charliteral">&#39;C&#39;</span> =&gt; $col1, <span class="charliteral">&#39;M&#39;</span> =&gt; $col2, <span class="charliteral">&#39;Y&#39;</span> =&gt; $col3, <span class="charliteral">&#39;K&#39;</span> =&gt; $col4, <span class="stringliteral">&#39;name&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l04699"></a>04699                 $this-&gt;<a class="code" href="classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457" title="Defines a new spot color.">AddSpotColor</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $col1, $col2, $col3, $col4);
<a name="l04700"></a>04700                 $pdfcolor = $this-&gt;<a class="code" href="classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf" title="Set the spot color for the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setSpotColor</a>(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, 100);
<a name="l04701"></a>04701             }
<a name="l04702"></a>04702         }
<a name="l04703"></a>04703         <span class="keywordflow">switch</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>) {
<a name="l04704"></a>04704             <span class="keywordflow">case</span> <span class="stringliteral">&#39;draw&#39;</span>: {
<a name="l04705"></a>04705                 $pdfcolor .= strtoupper($suffix);
<a name="l04706"></a>04706                 $this-&gt;DrawColor = $pdfcolor;
<a name="l04707"></a>04707                 $this-&gt;strokecolor = $intcolor;
<a name="l04708"></a>04708                 <span class="keywordflow">break</span>;
<a name="l04709"></a>04709             }
<a name="l04710"></a>04710             <span class="keywordflow">case</span> <span class="stringliteral">&#39;fill&#39;</span>: {
<a name="l04711"></a>04711                 $pdfcolor .= $suffix;
<a name="l04712"></a>04712                 $this-&gt;FillColor = $pdfcolor;
<a name="l04713"></a>04713                 $this-&gt;bgcolor = $intcolor;
<a name="l04714"></a>04714                 <span class="keywordflow">break</span>;
<a name="l04715"></a>04715             }
<a name="l04716"></a>04716             <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>: {
<a name="l04717"></a>04717                 $pdfcolor .= $suffix;
<a name="l04718"></a>04718                 $this-&gt;TextColor = $pdfcolor;
<a name="l04719"></a>04719                 $this-&gt;fgcolor = $intcolor;
<a name="l04720"></a>04720                 <span class="keywordflow">break</span>;
<a name="l04721"></a>04721             }
<a name="l04722"></a>04722         }
<a name="l04723"></a>04723         $this-&gt;ColorFlag = ($this-&gt;FillColor != $this-&gt;TextColor);
<a name="l04724"></a>04724         <span class="keywordflow">if</span> ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> != <span class="stringliteral">&#39;text&#39;</span>) AND ($this-&gt;page &gt; 0)) {
<a name="l04725"></a>04725             <span class="keywordflow">if</span> (!$ret) {
<a name="l04726"></a>04726                 $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>($pdfcolor);
<a name="l04727"></a>04727             }
<a name="l04728"></a>04728             <span class="keywordflow">return</span> $pdfcolor;
<a name="l04729"></a>04729         }
<a name="l04730"></a>04730         <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l04731"></a>04731     }
<a name="l04732"></a>04732 <span class="comment"></span>
<a name="l04733"></a>04733 <span class="comment">    /**</span>
<a name="l04734"></a>04734 <span class="comment">     * Convert a color array into a string representation.</span>
<a name="l04735"></a>04735 <span class="comment">     * @param $c (array) Array of colors.</span>
<a name="l04736"></a>04736 <span class="comment">     * @return (string) The color array representation.</span>
<a name="l04737"></a>04737 <span class="comment">     * @protected</span>
<a name="l04738"></a>04738 <span class="comment">     * @since 5.9.137 (2011-12-01)</span>
<a name="l04739"></a>04739 <span class="comment">     */</span>
<a name="l04740"></a><a class="code" href="classTCPDF.html#a7f8aaea37d377bc3143a1544b053ad52">04740</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7f8aaea37d377bc3143a1544b053ad52" title="Convert a color array into a string representation.">getColorStringFromArray</a>(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l04741"></a>04741         <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = array_values(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>);
<a name="l04742"></a>04742         $color = <span class="charliteral">&#39;[&#39;</span>;
<a name="l04743"></a>04743         <span class="keywordflow">switch</span> (count(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>)) {
<a name="l04744"></a>04744             <span class="keywordflow">case</span> 4: {
<a name="l04745"></a>04745                 <span class="comment">// CMYK</span>
<a name="l04746"></a>04746                 $color .= sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F %.3F&#39;</span>, (max(0, min(100, floatval(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>[0]))) / 100), (max(0, min(100, floatval(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>[1]))) / 100), (max(0, min(100, floatval(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>[2]))) / 100), (max(0, min(100, floatval(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>[3]))) / 100));
<a name="l04747"></a>04747                 <span class="keywordflow">break</span>;
<a name="l04748"></a>04748             }
<a name="l04749"></a>04749             <span class="keywordflow">case</span> 3: {
<a name="l04750"></a>04750                 <span class="comment">// RGB</span>
<a name="l04751"></a>04751                 $color .= sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F&#39;</span>, (max(0, min(255, floatval(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>[0]))) / 255), (max(0, min(255, floatval(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>[1]))) / 255), (max(0, min(255, floatval(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>[2]))) / 255));
<a name="l04752"></a>04752                 <span class="keywordflow">break</span>;
<a name="l04753"></a>04753             }
<a name="l04754"></a>04754             <span class="keywordflow">case</span> 1: {
<a name="l04755"></a>04755                 <span class="comment">// grayscale</span>
<a name="l04756"></a>04756                 $color .= sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, (max(0, min(255, floatval(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>[0]))) / 255));
<a name="l04757"></a>04757                 <span class="keywordflow">break</span>;
<a name="l04758"></a>04758             }
<a name="l04759"></a>04759         }
<a name="l04760"></a>04760         $color .= <span class="charliteral">&#39;]&#39;</span>;
<a name="l04761"></a>04761         <span class="keywordflow">return</span> $color;
<a name="l04762"></a>04762     }
<a name="l04763"></a>04763 <span class="comment"></span>
<a name="l04764"></a>04764 <span class="comment">    /**</span>
<a name="l04765"></a>04765 <span class="comment">     * Defines the color used for all drawing operations (lines, rectangles and cell borders). It can be expressed in RGB components or gray scale. The method can be called before the first page is created and the value is retained from page to page.</span>
<a name="l04766"></a>04766 <span class="comment">     * @param $col1 (float) GRAY level for single color, or Red color for RGB (0-255), or CYAN color for CMYK (0-100).</span>
<a name="l04767"></a>04767 <span class="comment">     * @param $col2 (float) GREEN color for RGB (0-255), or MAGENTA color for CMYK (0-100).</span>
<a name="l04768"></a>04768 <span class="comment">     * @param $col3 (float) BLUE color for RGB (0-255), or YELLOW color for CMYK (0-100).</span>
<a name="l04769"></a>04769 <span class="comment">     * @param $col4 (float) KEY (BLACK) color for CMYK (0-100).</span>
<a name="l04770"></a>04770 <span class="comment">     * @param $ret (boolean) If true do not send the command.</span>
<a name="l04771"></a>04771 <span class="comment">     * @param $name (string) spot color name (if any)</span>
<a name="l04772"></a>04772 <span class="comment">     * @return string the PDF command</span>
<a name="l04773"></a>04773 <span class="comment">     * @public</span>
<a name="l04774"></a>04774 <span class="comment">     * @since 1.3</span>
<a name="l04775"></a>04775 <span class="comment">     * @see SetDrawColorArray(), SetFillColor(), SetTextColor(), Line(), Rect(), Cell(), MultiCell()</span>
<a name="l04776"></a>04776 <span class="comment">     */</span>
<a name="l04777"></a><a class="code" href="classTCPDF.html#a3d0447ea40384cf67763041a55cf6eca">04777</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3d0447ea40384cf67763041a55cf6eca" title="Defines the color used for all drawing operations (lines, rectangles and cell borders).">SetDrawColor</a>($col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=<span class="keyword">false</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l04778"></a>04778         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd" title="Defines the color used by the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setColor</a>(<span class="stringliteral">&#39;draw&#39;</span>, $col1, $col2, $col3, $col4, $ret, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l04779"></a>04779     }
<a name="l04780"></a>04780 <span class="comment"></span>
<a name="l04781"></a>04781 <span class="comment">    /**</span>
<a name="l04782"></a>04782 <span class="comment">     * Defines the color used for all filling operations (filled rectangles and cell backgrounds). It can be expressed in RGB components or gray scale. The method can be called before the first page is created and the value is retained from page to page.</span>
<a name="l04783"></a>04783 <span class="comment">     * @param $col1 (float) GRAY level for single color, or Red color for RGB (0-255), or CYAN color for CMYK (0-100).</span>
<a name="l04784"></a>04784 <span class="comment">     * @param $col2 (float) GREEN color for RGB (0-255), or MAGENTA color for CMYK (0-100).</span>
<a name="l04785"></a>04785 <span class="comment">     * @param $col3 (float) BLUE color for RGB (0-255), or YELLOW color for CMYK (0-100).</span>
<a name="l04786"></a>04786 <span class="comment">     * @param $col4 (float) KEY (BLACK) color for CMYK (0-100).</span>
<a name="l04787"></a>04787 <span class="comment">     * @param $ret (boolean) If true do not send the command.</span>
<a name="l04788"></a>04788 <span class="comment">     * @param $name (string) Spot color name (if any).</span>
<a name="l04789"></a>04789 <span class="comment">     * @return (string) The PDF command.</span>
<a name="l04790"></a>04790 <span class="comment">     * @public</span>
<a name="l04791"></a>04791 <span class="comment">     * @since 1.3</span>
<a name="l04792"></a>04792 <span class="comment">     * @see SetFillColorArray(), SetDrawColor(), SetTextColor(), Rect(), Cell(), MultiCell()</span>
<a name="l04793"></a>04793 <span class="comment">     */</span>
<a name="l04794"></a><a class="code" href="classTCPDF.html#abad599cd85cc60cbe9cbb7765ccfb535">04794</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#abad599cd85cc60cbe9cbb7765ccfb535" title="Defines the color used for all filling operations (filled rectangles and cell backgrounds).">SetFillColor</a>($col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=<span class="keyword">false</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l04795"></a>04795         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd" title="Defines the color used by the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setColor</a>(<span class="stringliteral">&#39;fill&#39;</span>, $col1, $col2, $col3, $col4, $ret, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l04796"></a>04796     }
<a name="l04797"></a>04797 <span class="comment"></span>
<a name="l04798"></a>04798 <span class="comment">    /**</span>
<a name="l04799"></a>04799 <span class="comment">     * Defines the color used for text. It can be expressed in RGB components or gray scale. The method can be called before the first page is created and the value is retained from page to page.</span>
<a name="l04800"></a>04800 <span class="comment">     * @param $col1 (float) GRAY level for single color, or Red color for RGB (0-255), or CYAN color for CMYK (0-100).</span>
<a name="l04801"></a>04801 <span class="comment">     * @param $col2 (float) GREEN color for RGB (0-255), or MAGENTA color for CMYK (0-100).</span>
<a name="l04802"></a>04802 <span class="comment">     * @param $col3 (float) BLUE color for RGB (0-255), or YELLOW color for CMYK (0-100).</span>
<a name="l04803"></a>04803 <span class="comment">     * @param $col4 (float) KEY (BLACK) color for CMYK (0-100).</span>
<a name="l04804"></a>04804 <span class="comment">     * @param $ret (boolean) If true do not send the command.</span>
<a name="l04805"></a>04805 <span class="comment">     * @param $name (string) Spot color name (if any).</span>
<a name="l04806"></a>04806 <span class="comment">     * @return (string) Empty string.</span>
<a name="l04807"></a>04807 <span class="comment">     * @public</span>
<a name="l04808"></a>04808 <span class="comment">     * @since 1.3</span>
<a name="l04809"></a>04809 <span class="comment">     * @see SetTextColorArray(), SetDrawColor(), SetFillColor(), Text(), Cell(), MultiCell()</span>
<a name="l04810"></a>04810 <span class="comment">     */</span>
<a name="l04811"></a><a class="code" href="classTCPDF.html#ab1c0ea925d0e76abd0298ebab4f75140">04811</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab1c0ea925d0e76abd0298ebab4f75140" title="Defines the color used for text.">SetTextColor</a>($col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=<span class="keyword">false</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l04812"></a>04812         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd" title="Defines the color used by the specified type (&#39;draw&#39;, &#39;fill&#39;, &#39;text&#39;).">setColor</a>(<span class="stringliteral">&#39;text&#39;</span>, $col1, $col2, $col3, $col4, $ret, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l04813"></a>04813     }
<a name="l04814"></a>04814 <span class="comment"></span>
<a name="l04815"></a>04815 <span class="comment">    /**</span>
<a name="l04816"></a>04816 <span class="comment">     * Returns the length of a string in user unit. A font must be selected.&lt;br&gt;</span>
<a name="l04817"></a>04817 <span class="comment">     * @param $s (string) The string whose length is to be computed</span>
<a name="l04818"></a>04818 <span class="comment">     * @param $fontname (string) Family font. It can be either a name defined by AddFont() or one of the standard families. It is also possible to pass an empty string, in that case, the current family is retained.</span>
<a name="l04819"></a>04819 <span class="comment">     * @param $fontstyle (string) Font style. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;empty string: regular&lt;/li&gt;&lt;li&gt;B: bold&lt;/li&gt;&lt;li&gt;I: italic&lt;/li&gt;&lt;li&gt;U: underline&lt;/li&gt;&lt;li&gt;D: line-trough&lt;/li&gt;&lt;li&gt;O: overline&lt;/li&gt;&lt;/ul&gt; or any combination. The default value is regular.</span>
<a name="l04820"></a>04820 <span class="comment">     * @param $fontsize (float) Font size in points. The default value is the current size.</span>
<a name="l04821"></a>04821 <span class="comment">     * @param $getarray (boolean) if true returns an array of characters widths, if false returns the total length.</span>
<a name="l04822"></a>04822 <span class="comment">     * @return mixed int total string length or array of characted widths</span>
<a name="l04823"></a>04823 <span class="comment">     * @author Nicola Asuni</span>
<a name="l04824"></a>04824 <span class="comment">     * @public</span>
<a name="l04825"></a>04825 <span class="comment">     * @since 1.2</span>
<a name="l04826"></a>04826 <span class="comment">     */</span>
<a name="l04827"></a><a class="code" href="classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">04827</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9" title="Returns the length of a string in user unit.">GetStringWidth</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $fontname=<span class="stringliteral">&#39;&#39;</span>, $fontstyle=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>=0, $getarray=<span class="keyword">false</span>) {
<a name="l04828"></a>04828         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>($this-&gt;<a class="code" href="classTCPDF.html#a35a90a2cd5b8ab143d978128a21de09e" title="Converts UTF-8 strings to codepoints array.">UTF8StringToArray</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>), <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $this-&gt;tmprtl), $fontname, $fontstyle, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>, $getarray);
<a name="l04829"></a>04829     }
<a name="l04830"></a>04830 <span class="comment"></span>
<a name="l04831"></a>04831 <span class="comment">    /**</span>
<a name="l04832"></a>04832 <span class="comment">     * Returns the string length of an array of chars in user unit or an array of characters widths. A font must be selected.&lt;br&gt;</span>
<a name="l04833"></a>04833 <span class="comment">     * @param $sa (string) The array of chars whose total length is to be computed</span>
<a name="l04834"></a>04834 <span class="comment">     * @param $fontname (string) Family font. It can be either a name defined by AddFont() or one of the standard families. It is also possible to pass an empty string, in that case, the current family is retained.</span>
<a name="l04835"></a>04835 <span class="comment">     * @param $fontstyle (string) Font style. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;empty string: regular&lt;/li&gt;&lt;li&gt;B: bold&lt;/li&gt;&lt;li&gt;I: italic&lt;/li&gt;&lt;li&gt;U: underline&lt;/li&gt;&lt;li&gt;D: line trough&lt;/li&gt;&lt;li&gt;O: overline&lt;/li&gt;&lt;/ul&gt; or any combination. The default value is regular.</span>
<a name="l04836"></a>04836 <span class="comment">     * @param $fontsize (float) Font size in points. The default value is the current size.</span>
<a name="l04837"></a>04837 <span class="comment">     * @param $getarray (boolean) if true returns an array of characters widths, if false returns the total length.</span>
<a name="l04838"></a>04838 <span class="comment">     * @return mixed int total string length or array of characted widths</span>
<a name="l04839"></a>04839 <span class="comment">     * @author Nicola Asuni</span>
<a name="l04840"></a>04840 <span class="comment">     * @public</span>
<a name="l04841"></a>04841 <span class="comment">     * @since 2.4.000 (2008-03-06)</span>
<a name="l04842"></a>04842 <span class="comment">     */</span>
<a name="l04843"></a><a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">04843</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($sa, $fontname=<span class="stringliteral">&#39;&#39;</span>, $fontstyle=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>=0, $getarray=<span class="keyword">false</span>) {
<a name="l04844"></a>04844         <span class="comment">// store current values</span>
<a name="l04845"></a>04845         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($fontname)) {
<a name="l04846"></a>04846             $prev_FontFamily = $this-&gt;FontFamily;
<a name="l04847"></a>04847             $prev_FontStyle = $this-&gt;FontStyle;
<a name="l04848"></a>04848             $prev_FontSizePt = $this-&gt;FontSizePt;
<a name="l04849"></a>04849             $this-&gt;<a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e" title="Sets the font used to print character strings.">SetFont</a>($fontname, $fontstyle, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;default&#39;</span>, <span class="keyword">false</span>);
<a name="l04850"></a>04850         }
<a name="l04851"></a>04851         <span class="comment">// convert UTF-8 array to Latin1 if required</span>
<a name="l04852"></a>04852         $sa = $this-&gt;<a class="code" href="classTCPDF.html#a49045c2ce294f72c7720decbc96ebbbb" title="Converts UTF-8 characters array to array of Latin1 characters ">UTF8ArrToLatin1</a>($sa);
<a name="l04853"></a>04853         <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = 0; <span class="comment">// total width</span>
<a name="l04854"></a>04854         $wa = array(); <span class="comment">// array of characters widths</span>
<a name="l04855"></a>04855         <span class="keywordflow">foreach</span> ($sa as $ck =&gt; $char) {
<a name="l04856"></a>04856             <span class="comment">// character width</span>
<a name="l04857"></a>04857             <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> = $this-&gt;<a class="code" href="classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4" title="Returns the length of the char in user unit for the current font considering current stretching and s...">GetCharWidth</a>($char, isset($sa[($ck + 1)]));
<a name="l04858"></a>04858             $wa[] = <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>;
<a name="l04859"></a>04859             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> += <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>;
<a name="l04860"></a>04860         }
<a name="l04861"></a>04861         <span class="comment">// restore previous values</span>
<a name="l04862"></a>04862         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($fontname)) {
<a name="l04863"></a>04863             $this-&gt;<a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e" title="Sets the font used to print character strings.">SetFont</a>($prev_FontFamily, $prev_FontStyle, $prev_FontSizePt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;default&#39;</span>, <span class="keyword">false</span>);
<a name="l04864"></a>04864         }
<a name="l04865"></a>04865         <span class="keywordflow">if</span> ($getarray) {
<a name="l04866"></a>04866             <span class="keywordflow">return</span> $wa;
<a name="l04867"></a>04867         }
<a name="l04868"></a>04868         <span class="keywordflow">return</span> <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l04869"></a>04869     }
<a name="l04870"></a>04870 <span class="comment"></span>
<a name="l04871"></a>04871 <span class="comment">    /**</span>
<a name="l04872"></a>04872 <span class="comment">     * Returns the length of the char in user unit for the current font considering current stretching and spacing (tracking/kerning).</span>
<a name="l04873"></a>04873 <span class="comment">     * @param $char (int) The char code whose length is to be returned</span>
<a name="l04874"></a>04874 <span class="comment">     * @param $notlast (boolean) set to false for the latest character on string, true otherwise (default)</span>
<a name="l04875"></a>04875 <span class="comment">     * @return float char width</span>
<a name="l04876"></a>04876 <span class="comment">     * @author Nicola Asuni</span>
<a name="l04877"></a>04877 <span class="comment">     * @public</span>
<a name="l04878"></a>04878 <span class="comment">     * @since 2.4.000 (2008-03-06)</span>
<a name="l04879"></a>04879 <span class="comment">     */</span>
<a name="l04880"></a><a class="code" href="classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4">04880</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4" title="Returns the length of the char in user unit for the current font considering current stretching and s...">GetCharWidth</a>($char, $notlast=<span class="keyword">true</span>) {
<a name="l04881"></a>04881         <span class="comment">// get raw width</span>
<a name="l04882"></a>04882         $chw = $this-&gt;<a class="code" href="classTCPDF.html#af484c6dc7debd34e2310f9f391448de7" title="Returns the length of the char in user unit for the current font.">getRawCharWidth</a>($char);
<a name="l04883"></a>04883         <span class="keywordflow">if</span> (($this-&gt;font_spacing != 0) AND $notlast) {
<a name="l04884"></a>04884             <span class="comment">// increase/decrease font spacing</span>
<a name="l04885"></a>04885             $chw += $this-&gt;font_spacing;
<a name="l04886"></a>04886         }
<a name="l04887"></a>04887         <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {
<a name="l04888"></a>04888             <span class="comment">// fixed stretching mode</span>
<a name="l04889"></a>04889             $chw *= ($this-&gt;font_stretching / 100);
<a name="l04890"></a>04890         }
<a name="l04891"></a>04891         <span class="keywordflow">return</span> $chw;
<a name="l04892"></a>04892     }
<a name="l04893"></a>04893 <span class="comment"></span>
<a name="l04894"></a>04894 <span class="comment">    /**</span>
<a name="l04895"></a>04895 <span class="comment">     * Returns the length of the char in user unit for the current font.</span>
<a name="l04896"></a>04896 <span class="comment">     * @param $char (int) The char code whose length is to be returned</span>
<a name="l04897"></a>04897 <span class="comment">     * @return float char width</span>
<a name="l04898"></a>04898 <span class="comment">     * @author Nicola Asuni</span>
<a name="l04899"></a>04899 <span class="comment">     * @public</span>
<a name="l04900"></a>04900 <span class="comment">     * @since 5.9.000 (2010-09-28)</span>
<a name="l04901"></a>04901 <span class="comment">     */</span>
<a name="l04902"></a><a class="code" href="classTCPDF.html#af484c6dc7debd34e2310f9f391448de7">04902</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af484c6dc7debd34e2310f9f391448de7" title="Returns the length of the char in user unit for the current font.">getRawCharWidth</a>($char) {
<a name="l04903"></a>04903         <span class="keywordflow">if</span> ($char == 173) {
<a name="l04904"></a>04904             <span class="comment">// SHY character will not be printed</span>
<a name="l04905"></a>04905             <span class="keywordflow">return</span> (0);
<a name="l04906"></a>04906         }
<a name="l04907"></a>04907         <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][$char])) {
<a name="l04908"></a>04908             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][$char];
<a name="l04909"></a>04909         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;dw&#39;</span>])) {
<a name="l04910"></a>04910             <span class="comment">// default width</span>
<a name="l04911"></a>04911             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;CurrentFont[<span class="stringliteral">&#39;dw&#39;</span>];
<a name="l04912"></a>04912         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][32])) {
<a name="l04913"></a>04913             <span class="comment">// default width</span>
<a name="l04914"></a>04914             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][32];
<a name="l04915"></a>04915         } <span class="keywordflow">else</span> {
<a name="l04916"></a>04916             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = 600;
<a name="l04917"></a>04917         }
<a name="l04918"></a>04918         <span class="keywordflow">return</span> (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> * $this-&gt;FontSize / 1000);
<a name="l04919"></a>04919     }
<a name="l04920"></a>04920 <span class="comment"></span>
<a name="l04921"></a>04921 <span class="comment">    /**</span>
<a name="l04922"></a>04922 <span class="comment">     * Returns the numbero of characters in a string.</span>
<a name="l04923"></a>04923 <span class="comment">     * @param $s (string) The input string.</span>
<a name="l04924"></a>04924 <span class="comment">     * @return int number of characters</span>
<a name="l04925"></a>04925 <span class="comment">     * @public</span>
<a name="l04926"></a>04926 <span class="comment">     * @since 2.0.0001 (2008-01-07)</span>
<a name="l04927"></a>04927 <span class="comment">     */</span>
<a name="l04928"></a><a class="code" href="classTCPDF.html#ac9dc6318fd217971aff282532ab91e43">04928</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac9dc6318fd217971aff282532ab91e43" title="Returns the numbero of characters in a string.">GetNumChars</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>) {
<a name="l04929"></a>04929         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97" title="Return true if the current font is unicode type.">isUnicodeFont</a>()) {
<a name="l04930"></a>04930             <span class="keywordflow">return</span> count($this-&gt;<a class="code" href="classTCPDF.html#a35a90a2cd5b8ab143d978128a21de09e" title="Converts UTF-8 strings to codepoints array.">UTF8StringToArray</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>));
<a name="l04931"></a>04931         }
<a name="l04932"></a>04932         <span class="keywordflow">return</span> strlen(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l04933"></a>04933     }
<a name="l04934"></a>04934 <span class="comment"></span>
<a name="l04935"></a>04935 <span class="comment">    /**</span>
<a name="l04936"></a>04936 <span class="comment">     * Fill the list of available fonts ($this-&gt;fontlist).</span>
<a name="l04937"></a>04937 <span class="comment">     * @protected</span>
<a name="l04938"></a>04938 <span class="comment">     * @since 4.0.013 (2008-07-28)</span>
<a name="l04939"></a>04939 <span class="comment">     */</span>
<a name="l04940"></a><a class="code" href="classTCPDF.html#ae87d16aa348205f2a1654cc2ac42367c">04940</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae87d16aa348205f2a1654cc2ac42367c" title="Fill the list of available fonts ($this-&gt;fontlist).">getFontsList</a>() {
<a name="l04941"></a>04941         $fontsdir = opendir($this-&gt;<a class="code" href="classTCPDF.html#a859c9ff83c417b518afa83c0da7a62b1" title="Return fonts path.">_getfontpath</a>());
<a name="l04942"></a>04942         <span class="keywordflow">while</span> ((<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> = readdir($fontsdir)) !== <span class="keyword">false</span>) {
<a name="l04943"></a>04943             <span class="keywordflow">if</span> (substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, -4) == <span class="stringliteral">&#39;.php&#39;</span>) {
<a name="l04944"></a>04944                 array_push($this-&gt;fontlist, strtolower(basename(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">&#39;.php&#39;</span>)));
<a name="l04945"></a>04945             }
<a name="l04946"></a>04946         }
<a name="l04947"></a>04947         closedir($fontsdir);
<a name="l04948"></a>04948     }
<a name="l04949"></a>04949 <span class="comment"></span>
<a name="l04950"></a>04950 <span class="comment">    /**</span>
<a name="l04951"></a>04951 <span class="comment">     * Imports a TrueType, Type1, core, or CID0 font and makes it available.</span>
<a name="l04952"></a>04952 <span class="comment">     * It is necessary to generate a font definition file first (read /fonts/utils/README.TXT).</span>
<a name="l04953"></a>04953 <span class="comment">     * The definition file (and the font file itself when embedding) must be present either in the current directory or in the one indicated by K_PATH_FONTS if the constant is defined. If it could not be found, the error &quot;Could not include font definition file&quot; is generated.</span>
<a name="l04954"></a>04954 <span class="comment">     * @param $family (string) Font family. The name can be chosen arbitrarily. If it is a standard family name, it will override the corresponding font.</span>
<a name="l04955"></a>04955 <span class="comment">     * @param $style (string) Font style. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;empty string: regular (default)&lt;/li&gt;&lt;li&gt;B: bold&lt;/li&gt;&lt;li&gt;I: italic&lt;/li&gt;&lt;li&gt;BI or IB: bold italic&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l04956"></a>04956 <span class="comment">     * @param $fontfile (string) The font definition file. By default, the name is built from the family and style, in lower case with no spaces.</span>
<a name="l04957"></a>04957 <span class="comment">     * @return array containing the font data, or false in case of error.</span>
<a name="l04958"></a>04958 <span class="comment">     * @param $subset (mixed) if true embedd only a subset of the font (stores only the information related to the used characters); if false embedd full font; if &#39;default&#39; uses the default value set using setFontSubsetting(). This option is valid only for TrueTypeUnicode fonts. If you want to enable users to change the document, set this parameter to false. If you subset the font, the person who receives your PDF would need to have your same font in order to make changes to your PDF. The file size of the PDF would also be smaller because you are embedding only part of a font.</span>
<a name="l04959"></a>04959 <span class="comment">     * @public</span>
<a name="l04960"></a>04960 <span class="comment">     * @since 1.5</span>
<a name="l04961"></a>04961 <span class="comment">     * @see SetFont(), setFontSubsetting()</span>
<a name="l04962"></a>04962 <span class="comment">     */</span>
<a name="l04963"></a><a class="code" href="classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776">04963</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776" title="Imports a TrueType, Type1, core, or CID0 font and makes it available.">AddFont</a>($family, $style=<span class="stringliteral">&#39;&#39;</span>, $fontfile=<span class="stringliteral">&#39;&#39;</span>, $subset=<span class="stringliteral">&#39;default&#39;</span>) {
<a name="l04964"></a>04964         <span class="keywordflow">if</span> ($subset === <span class="stringliteral">&#39;default&#39;</span>) {
<a name="l04965"></a>04965             $subset = $this-&gt;font_subsetting;
<a name="l04966"></a>04966         }
<a name="l04967"></a>04967         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l04968"></a>04968             $subset = <span class="keyword">false</span>;
<a name="l04969"></a>04969         }
<a name="l04970"></a>04970         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($family)) {
<a name="l04971"></a>04971             <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($this-&gt;FontFamily)) {
<a name="l04972"></a>04972                 $family = $this-&gt;FontFamily;
<a name="l04973"></a>04973             } <span class="keywordflow">else</span> {
<a name="l04974"></a>04974                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Empty font family&#39;</span>);
<a name="l04975"></a>04975             }
<a name="l04976"></a>04976         }
<a name="l04977"></a>04977         <span class="comment">// move embedded styles on $style</span>
<a name="l04978"></a>04978         <span class="keywordflow">if</span> (substr($family, -1) == <span class="charliteral">&#39;I&#39;</span>) {
<a name="l04979"></a>04979             $style .= <span class="charliteral">&#39;I&#39;</span>;
<a name="l04980"></a>04980             $family = substr($family, 0, -1);
<a name="l04981"></a>04981         }
<a name="l04982"></a>04982         <span class="keywordflow">if</span> (substr($family, -1) == <span class="charliteral">&#39;B&#39;</span>) {
<a name="l04983"></a>04983             $style .= <span class="charliteral">&#39;B&#39;</span>;
<a name="l04984"></a>04984             $family = substr($family, 0, -1);
<a name="l04985"></a>04985         }
<a name="l04986"></a>04986         <span class="comment">// normalize family name</span>
<a name="l04987"></a>04987         $family = strtolower($family);
<a name="l04988"></a>04988         <span class="keywordflow">if</span> ((!$this-&gt;isunicode) AND ($family == <span class="stringliteral">&#39;arial&#39;</span>)) {
<a name="l04989"></a>04989             $family = <span class="stringliteral">&#39;helvetica&#39;</span>;
<a name="l04990"></a>04990         }
<a name="l04991"></a>04991         <span class="keywordflow">if</span> (($family == <span class="stringliteral">&#39;symbol&#39;</span>) OR ($family == <span class="stringliteral">&#39;zapfdingbats&#39;</span>)) {
<a name="l04992"></a>04992             $style = <span class="stringliteral">&#39;&#39;</span>;
<a name="l04993"></a>04993         }
<a name="l04994"></a>04994         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode AND (isset($this-&gt;CoreFonts[$family]))) {
<a name="l04995"></a>04995             <span class="comment">// all fonts must be embedded</span>
<a name="l04996"></a>04996             $family = <span class="stringliteral">&#39;pdfa&#39;</span>.$family;
<a name="l04997"></a>04997         }
<a name="l04998"></a>04998         $tempstyle = strtoupper($style);
<a name="l04999"></a>04999         $style = <span class="stringliteral">&#39;&#39;</span>;
<a name="l05000"></a>05000         <span class="comment">// underline</span>
<a name="l05001"></a>05001         <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;U&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l05002"></a>05002             $this-&gt;underline = <span class="keyword">true</span>;
<a name="l05003"></a>05003         } <span class="keywordflow">else</span> {
<a name="l05004"></a>05004             $this-&gt;underline = <span class="keyword">false</span>;
<a name="l05005"></a>05005         }
<a name="l05006"></a>05006         <span class="comment">// line-through (deleted)</span>
<a name="l05007"></a>05007         <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;D&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l05008"></a>05008             $this-&gt;linethrough = <span class="keyword">true</span>;
<a name="l05009"></a>05009         } <span class="keywordflow">else</span> {
<a name="l05010"></a>05010             $this-&gt;linethrough = <span class="keyword">false</span>;
<a name="l05011"></a>05011         }
<a name="l05012"></a>05012         <span class="comment">// overline</span>
<a name="l05013"></a>05013         <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;O&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l05014"></a>05014             $this-&gt;overline = <span class="keyword">true</span>;
<a name="l05015"></a>05015         } <span class="keywordflow">else</span> {
<a name="l05016"></a>05016             $this-&gt;overline = <span class="keyword">false</span>;
<a name="l05017"></a>05017         }
<a name="l05018"></a>05018         <span class="comment">// bold</span>
<a name="l05019"></a>05019         <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l05020"></a>05020             $style .= <span class="charliteral">&#39;B&#39;</span>;
<a name="l05021"></a>05021         }
<a name="l05022"></a>05022         <span class="comment">// oblique</span>
<a name="l05023"></a>05023         <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;I&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l05024"></a>05024             $style .= <span class="charliteral">&#39;I&#39;</span>;
<a name="l05025"></a>05025         }
<a name="l05026"></a>05026         $bistyle = $style;
<a name="l05027"></a>05027         $fontkey = $family.$style;
<a name="l05028"></a>05028         $font_style = $style.($this-&gt;underline ? <span class="charliteral">&#39;U&#39;</span> : <span class="stringliteral">&#39;&#39;</span>).($this-&gt;linethrough ? <span class="charliteral">&#39;D&#39;</span> : <span class="stringliteral">&#39;&#39;</span>).($this-&gt;overline ? <span class="charliteral">&#39;O&#39;</span> : <span class="stringliteral">&#39;&#39;</span>);
<a name="l05029"></a>05029         $fontdata = array(<span class="stringliteral">&#39;fontkey&#39;</span> =&gt; $fontkey, <span class="stringliteral">&#39;family&#39;</span> =&gt; $family, <span class="stringliteral">&#39;style&#39;</span> =&gt; $font_style);
<a name="l05030"></a>05030         <span class="comment">// check if the font has been already added</span>
<a name="l05031"></a>05031         $fb = $this-&gt;<a class="code" href="classTCPDF.html#ac63fff093a17846764bbcc09af7c8640" title="Get font buffer content.">getFontBuffer</a>($fontkey);
<a name="l05032"></a>05032         <span class="keywordflow">if</span> ($fb !== <span class="keyword">false</span>) {
<a name="l05033"></a>05033             <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l05034"></a>05034                 <span class="comment">// we are inside an XObject template</span>
<a name="l05035"></a>05035                 $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;fonts&#39;</span>][$fontkey] = $fb[<span class="charliteral">&#39;i&#39;</span>];
<a name="l05036"></a>05036             }
<a name="l05037"></a>05037             <span class="keywordflow">return</span> $fontdata;
<a name="l05038"></a>05038         }
<a name="l05039"></a>05039         <span class="keywordflow">if</span> (isset(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>)) {
<a name="l05040"></a>05040             unset(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l05041"></a>05041         }
<a name="l05042"></a>05042         <span class="keywordflow">if</span> (isset(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>)) {
<a name="l05043"></a>05043             unset(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>);
<a name="l05044"></a>05044         }
<a name="l05045"></a>05045         <span class="comment">// get specified font directory (if any)</span>
<a name="l05046"></a>05046         $fontdir = <span class="keyword">false</span>;
<a name="l05047"></a>05047         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($fontfile)) {
<a name="l05048"></a>05048             $fontdir = dirname($fontfile);
<a name="l05049"></a>05049             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($fontdir) OR ($fontdir == <span class="charliteral">&#39;.&#39;</span>)) {
<a name="l05050"></a>05050                 $fontdir = <span class="stringliteral">&#39;&#39;</span>;
<a name="l05051"></a>05051             } <span class="keywordflow">else</span> {
<a name="l05052"></a>05052                 $fontdir .= <span class="charliteral">&#39;/&#39;</span>;
<a name="l05053"></a>05053             }
<a name="l05054"></a>05054         }
<a name="l05055"></a>05055         $missing_style = <span class="keyword">false</span>; <span class="comment">// true when the font style variation is missing</span>
<a name="l05056"></a>05056         <span class="comment">// search and include font file</span>
<a name="l05057"></a>05057         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($fontfile) OR (!file_exists($fontfile))) {
<a name="l05058"></a>05058             <span class="comment">// build a standard filenames for specified font</span>
<a name="l05059"></a>05059             $tmp_fontfile = str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $family).strtolower($style).<span class="stringliteral">&#39;.php&#39;</span>;
<a name="l05060"></a>05060             <span class="comment">// search files on various directories</span>
<a name="l05061"></a>05061             <span class="keywordflow">if</span> (($fontdir !== <span class="keyword">false</span>) AND file_exists($fontdir.$tmp_fontfile)) {
<a name="l05062"></a>05062                 $fontfile = $fontdir.$tmp_fontfile;
<a name="l05063"></a>05063             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (file_exists($this-&gt;<a class="code" href="classTCPDF.html#a859c9ff83c417b518afa83c0da7a62b1" title="Return fonts path.">_getfontpath</a>().$tmp_fontfile)) {
<a name="l05064"></a>05064                 $fontfile = $this-&gt;<a class="code" href="classTCPDF.html#a859c9ff83c417b518afa83c0da7a62b1" title="Return fonts path.">_getfontpath</a>().$tmp_fontfile;
<a name="l05065"></a>05065             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (file_exists($tmp_fontfile)) {
<a name="l05066"></a>05066                 $fontfile = $tmp_fontfile;
<a name="l05067"></a>05067             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($style)) {
<a name="l05068"></a>05068                 $missing_style = <span class="keyword">true</span>;
<a name="l05069"></a>05069                 <span class="comment">// try to remove the style part</span>
<a name="l05070"></a>05070                 $tmp_fontfile = str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $family).<span class="stringliteral">&#39;.php&#39;</span>;
<a name="l05071"></a>05071                 <span class="keywordflow">if</span> (($fontdir !== <span class="keyword">false</span>) AND file_exists($fontdir.$tmp_fontfile)) {
<a name="l05072"></a>05072                     $fontfile = $fontdir.$tmp_fontfile;
<a name="l05073"></a>05073                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (file_exists($this-&gt;<a class="code" href="classTCPDF.html#a859c9ff83c417b518afa83c0da7a62b1" title="Return fonts path.">_getfontpath</a>().$tmp_fontfile)) {
<a name="l05074"></a>05074                     $fontfile = $this-&gt;<a class="code" href="classTCPDF.html#a859c9ff83c417b518afa83c0da7a62b1" title="Return fonts path.">_getfontpath</a>().$tmp_fontfile;
<a name="l05075"></a>05075                 } <span class="keywordflow">else</span> {
<a name="l05076"></a>05076                     $fontfile = $tmp_fontfile;
<a name="l05077"></a>05077                 }
<a name="l05078"></a>05078             }
<a name="l05079"></a>05079         }
<a name="l05080"></a>05080         <span class="comment">// include font file</span>
<a name="l05081"></a>05081         <span class="keywordflow">if</span> (file_exists($fontfile)) {
<a name="l05082"></a>05082             include($fontfile);
<a name="l05083"></a>05083         } <span class="keywordflow">else</span> {
<a name="l05084"></a>05084             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Could not include font definition file: &#39;</span>.$family.<span class="stringliteral">&#39;&#39;</span>);
<a name="l05085"></a>05085         }
<a name="l05086"></a>05086         <span class="comment">// check font parameters</span>
<a name="l05087"></a>05087         <span class="keywordflow">if</span> ((!isset(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>)) OR (!isset(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>))) {
<a name="l05088"></a>05088             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;The font definition file has a bad format: &#39;</span>.$fontfile.<span class="stringliteral">&#39;&#39;</span>);
<a name="l05089"></a>05089         }
<a name="l05090"></a>05090         <span class="comment">// SET default parameters</span>
<a name="l05091"></a>05091         <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>) OR $this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l05092"></a>05092             <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l05093"></a>05093         }
<a name="l05094"></a>05094         <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>) OR $this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>)) {
<a name="l05095"></a>05095             <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l05096"></a>05096         }
<a name="l05097"></a>05097         <span class="keywordflow">if</span> (!isset($cidinfo) OR $this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($cidinfo)) {
<a name="l05098"></a>05098             $cidinfo = array(<span class="stringliteral">&#39;Registry&#39;</span>=&gt;<span class="stringliteral">&#39;Adobe&#39;</span>, <span class="stringliteral">&#39;Ordering&#39;</span>=&gt;<span class="stringliteral">&#39;Identity&#39;</span>, <span class="stringliteral">&#39;Supplement&#39;</span>=&gt;0);
<a name="l05099"></a>05099             $cidinfo[<span class="stringliteral">&#39;uni2cid&#39;</span>] = array();
<a name="l05100"></a>05100         }
<a name="l05101"></a>05101         <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>) OR $this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>)) {
<a name="l05102"></a>05102             <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l05103"></a>05103         }
<a name="l05104"></a>05104         <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>) OR $this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>)) {
<a name="l05105"></a>05105             <a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a> = array();
<a name="l05106"></a>05106         }
<a name="l05107"></a>05107         <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#a6b5ad2ac55f9df46e8f34e78fbd6f176">$up</a>) OR $this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="dejavusans_8php.html#a6b5ad2ac55f9df46e8f34e78fbd6f176">$up</a>)) {
<a name="l05108"></a>05108             <a class="code" href="dejavusans_8php.html#a6b5ad2ac55f9df46e8f34e78fbd6f176">$up</a> = -100;
<a name="l05109"></a>05109         }
<a name="l05110"></a>05110         <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#aadd3f841051043ee58e587e840e8dd0b">$ut</a>) OR $this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="dejavusans_8php.html#aadd3f841051043ee58e587e840e8dd0b">$ut</a>)) {
<a name="l05111"></a>05111             <a class="code" href="dejavusans_8php.html#aadd3f841051043ee58e587e840e8dd0b">$ut</a> = 50;
<a name="l05112"></a>05112         }
<a name="l05113"></a>05113         <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>) OR $this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>)) {
<a name="l05114"></a>05114             <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> = array();
<a name="l05115"></a>05115         }
<a name="l05116"></a>05116         <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a>) OR $this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a>)) {
<a name="l05117"></a>05117             <span class="comment">// set default width</span>
<a name="l05118"></a>05118             <span class="keywordflow">if</span> (isset(<a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;MissingWidth&#39;</span>]) AND (<a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;MissingWidth&#39;</span>] &gt; 0)) {
<a name="l05119"></a>05119                 <a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a> = <a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;MissingWidth&#39;</span>];
<a name="l05120"></a>05120             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>[32])) {
<a name="l05121"></a>05121                 <a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a> = <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>[32];
<a name="l05122"></a>05122             } <span class="keywordflow">else</span> {
<a name="l05123"></a>05123                 <a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a> = 600;
<a name="l05124"></a>05124             }
<a name="l05125"></a>05125         }
<a name="l05126"></a>05126         ++$this-&gt;numfonts;
<a name="l05127"></a>05127         <span class="keywordflow">if</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;core&#39;</span>) {
<a name="l05128"></a>05128             <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = $this-&gt;CoreFonts[$fontkey];
<a name="l05129"></a>05129             $subset = <span class="keyword">false</span>;
<a name="l05130"></a>05130         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;TrueType&#39;</span>) OR (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;Type1&#39;</span>)) {
<a name="l05131"></a>05131             $subset = <span class="keyword">false</span>;
<a name="l05132"></a>05132         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>) {
<a name="l05133"></a>05133             <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> = <span class="stringliteral">&#39;Identity-H&#39;</span>;
<a name="l05134"></a>05134         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;cidfont0&#39;</span>) {
<a name="l05135"></a>05135             <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l05136"></a>05136                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;All fonts must be embedded in PDF/A mode!&#39;</span>);
<a name="l05137"></a>05137             }
<a name="l05138"></a>05138         } <span class="keywordflow">else</span> {
<a name="l05139"></a>05139             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Unknow font type: &#39;</span>.<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>.<span class="stringliteral">&#39;&#39;</span>);
<a name="l05140"></a>05140         }
<a name="l05141"></a>05141         <span class="comment">// set name if unset</span>
<a name="l05142"></a>05142         <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) OR empty(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>)) {
<a name="l05143"></a>05143             <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = $fontkey;
<a name="l05144"></a>05144         }
<a name="l05145"></a>05145         <span class="comment">// create artificial font style variations if missing (only works with non-embedded fonts)</span>
<a name="l05146"></a>05146         <span class="keywordflow">if</span> ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> != <span class="stringliteral">&#39;core&#39;</span>) AND $missing_style) {
<a name="l05147"></a>05147             <span class="comment">// style variations</span>
<a name="l05148"></a>05148             $styles = array(<span class="stringliteral">&#39;&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;B&#39;</span> =&gt; <span class="stringliteral">&#39;,Bold&#39;</span>, <span class="charliteral">&#39;I&#39;</span> =&gt; <span class="stringliteral">&#39;,Italic&#39;</span>, <span class="stringliteral">&#39;BI&#39;</span> =&gt; <span class="stringliteral">&#39;,BoldItalic&#39;</span>);
<a name="l05149"></a>05149             <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> .= $styles[$bistyle];
<a name="l05150"></a>05150             <span class="comment">// artificial bold</span>
<a name="l05151"></a>05151             <span class="keywordflow">if</span> (strpos($bistyle, <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l05152"></a>05152                 <span class="keywordflow">if</span> (isset(<a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;StemV&#39;</span>])) {
<a name="l05153"></a>05153                     <span class="comment">// from normal to bold</span>
<a name="l05154"></a>05154                     <a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;StemV&#39;</span>] = round(<a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;StemV&#39;</span>] * 1.75);
<a name="l05155"></a>05155                 } <span class="keywordflow">else</span> {
<a name="l05156"></a>05156                     <span class="comment">// bold</span>
<a name="l05157"></a>05157                     <a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;StemV&#39;</span>] = 123;
<a name="l05158"></a>05158                 }
<a name="l05159"></a>05159             }
<a name="l05160"></a>05160             <span class="comment">// artificial italic</span>
<a name="l05161"></a>05161             <span class="keywordflow">if</span> (strpos($bistyle, <span class="charliteral">&#39;I&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l05162"></a>05162                 <span class="keywordflow">if</span> (isset(<a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;ItalicAngle&#39;</span>])) {
<a name="l05163"></a>05163                     <a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;ItalicAngle&#39;</span>] -= 11;
<a name="l05164"></a>05164                 } <span class="keywordflow">else</span> {
<a name="l05165"></a>05165                     <a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;ItalicAngle&#39;</span>] = -11;
<a name="l05166"></a>05166                 }
<a name="l05167"></a>05167                 <span class="keywordflow">if</span> (isset(<a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;Flags&#39;</span>])) {
<a name="l05168"></a>05168                     <a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;Flags&#39;</span>] |= 64; <span class="comment">//bit 7</span>
<a name="l05169"></a>05169                 } <span class="keywordflow">else</span> {
<a name="l05170"></a>05170                     <a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>[<span class="stringliteral">&#39;Flags&#39;</span>] = 64;
<a name="l05171"></a>05171                 }
<a name="l05172"></a>05172             }
<a name="l05173"></a>05173         }
<a name="l05174"></a>05174         <span class="comment">// initialize subsetchars to contain default ASCII values (0-255)</span>
<a name="l05175"></a>05175         $subsetchars = array_fill(0, 256, <span class="keyword">true</span>);
<a name="l05176"></a>05176         $this-&gt;<a class="code" href="classTCPDF.html#aa9eb763490acb3dfdf3f0cf445e83ca6" title="Set font buffer content.">setFontBuffer</a>($fontkey, array(<span class="stringliteral">&#39;fontkey&#39;</span> =&gt; $fontkey, <span class="charliteral">&#39;i&#39;</span> =&gt; $this-&gt;numfonts, <span class="stringliteral">&#39;type&#39;</span> =&gt; <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, <span class="stringliteral">&#39;name&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <span class="stringliteral">&#39;desc&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>, <span class="stringliteral">&#39;up&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#a6b5ad2ac55f9df46e8f34e78fbd6f176">$up</a>, <span class="stringliteral">&#39;ut&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#aadd3f841051043ee58e587e840e8dd0b">$ut</a>, <span class="stringliteral">&#39;cw&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>, <span class="stringliteral">&#39;dw&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a>, <span class="stringliteral">&#39;enc&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>, <span class="stringliteral">&#39;cidinfo&#39;</span> =&gt; $cidinfo, <span class="stringliteral">&#39;file&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">&#39;ctg&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>, <span class="stringliteral">&#39;subset&#39;</span> =&gt; $subset, <span class="stringliteral">&#39;subsetchars&#39;</span> =&gt; $subsetchars));
<a name="l05177"></a>05177         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l05178"></a>05178             <span class="comment">// we are inside an XObject template</span>
<a name="l05179"></a>05179             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;fonts&#39;</span>][$fontkey] = $this-&gt;numfonts;
<a name="l05180"></a>05180         }
<a name="l05181"></a>05181         <span class="keywordflow">if</span> (isset(<a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a>) AND (!empty(<a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a>))) {
<a name="l05182"></a>05182             <span class="comment">//Search existing encodings</span>
<a name="l05183"></a>05183             $d = 0;
<a name="l05184"></a>05184             $nb = count($this-&gt;diffs);
<a name="l05185"></a>05185             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;= $nb; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l05186"></a>05186                 <span class="keywordflow">if</span> ($this-&gt;diffs[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] == <a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a>) {
<a name="l05187"></a>05187                     $d = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l05188"></a>05188                     <span class="keywordflow">break</span>;
<a name="l05189"></a>05189                 }
<a name="l05190"></a>05190             }
<a name="l05191"></a>05191             <span class="keywordflow">if</span> ($d == 0) {
<a name="l05192"></a>05192                 $d = $nb + 1;
<a name="l05193"></a>05193                 $this-&gt;diffs[$d] = <a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a>;
<a name="l05194"></a>05194             }
<a name="l05195"></a>05195             $this-&gt;<a class="code" href="classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb" title="Set font buffer content.">setFontSubBuffer</a>($fontkey, <span class="stringliteral">&#39;diff&#39;</span>, $d);
<a name="l05196"></a>05196         }
<a name="l05197"></a>05197         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l05198"></a>05198             <span class="keywordflow">if</span> (!isset($this-&gt;FontFiles[<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>])) {
<a name="l05199"></a>05199                 <span class="keywordflow">if</span> ((strcasecmp(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>,<span class="stringliteral">&#39;TrueType&#39;</span>) == 0) OR (strcasecmp(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>) == 0)) {
<a name="l05200"></a>05200                     $this-&gt;FontFiles[<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>] = array(<span class="stringliteral">&#39;length1&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#a25e8bdbc8267d6e88bc21fde74a2c0e8">$originalsize</a>, <span class="stringliteral">&#39;fontdir&#39;</span> =&gt; $fontdir, <span class="stringliteral">&#39;subset&#39;</span> =&gt; $subset, <span class="stringliteral">&#39;fontkeys&#39;</span> =&gt; array($fontkey));
<a name="l05201"></a>05201                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> != <span class="stringliteral">&#39;core&#39;</span>) {
<a name="l05202"></a>05202                     $this-&gt;FontFiles[<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>] = array(<span class="stringliteral">&#39;length1&#39;</span> =&gt; $size1, <span class="stringliteral">&#39;length2&#39;</span> =&gt; $size2, <span class="stringliteral">&#39;fontdir&#39;</span> =&gt; $fontdir, <span class="stringliteral">&#39;subset&#39;</span> =&gt; $subset, <span class="stringliteral">&#39;fontkeys&#39;</span> =&gt; array($fontkey));
<a name="l05203"></a>05203                 }
<a name="l05204"></a>05204             } <span class="keywordflow">else</span> {
<a name="l05205"></a>05205                 <span class="comment">// update fontkeys that are sharing this font file</span>
<a name="l05206"></a>05206                 $this-&gt;FontFiles[<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>][<span class="stringliteral">&#39;subset&#39;</span>] = ($this-&gt;FontFiles[<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>][<span class="stringliteral">&#39;subset&#39;</span>] AND $subset);
<a name="l05207"></a>05207                 <span class="keywordflow">if</span> (!in_array($fontkey, $this-&gt;FontFiles[$file][<span class="stringliteral">&#39;fontkeys&#39;</span>])) {
<a name="l05208"></a>05208                     $this-&gt;FontFiles[<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>][<span class="stringliteral">&#39;fontkeys&#39;</span>][] = $fontkey;
<a name="l05209"></a>05209                 }
<a name="l05210"></a>05210             }
<a name="l05211"></a>05211         }
<a name="l05212"></a>05212         <span class="keywordflow">return</span> $fontdata;
<a name="l05213"></a>05213     }
<a name="l05214"></a>05214 <span class="comment"></span>
<a name="l05215"></a>05215 <span class="comment">    /**</span>
<a name="l05216"></a>05216 <span class="comment">     * Sets the font used to print character strings.</span>
<a name="l05217"></a>05217 <span class="comment">     * The font can be either a standard one or a font added via the AddFont() method. Standard fonts use Windows encoding cp1252 (Western Europe).</span>
<a name="l05218"></a>05218 <span class="comment">     * The method can be called before the first page is created and the font is retained from page to page.</span>
<a name="l05219"></a>05219 <span class="comment">     * If you just wish to change the current font size, it is simpler to call SetFontSize().</span>
<a name="l05220"></a>05220 <span class="comment">     * Note: for the standard fonts, the font metric files must be accessible. There are three possibilities for this:&lt;ul&gt;&lt;li&gt;They are in the current directory (the one where the running script lies)&lt;/li&gt;&lt;li&gt;They are in one of the directories defined by the include_path parameter&lt;/li&gt;&lt;li&gt;They are in the directory defined by the K_PATH_FONTS constant&lt;/li&gt;&lt;/ul&gt;&lt;br /&gt;</span>
<a name="l05221"></a>05221 <span class="comment">     * @param $family (string) Family font. It can be either a name defined by AddFont() or one of the standard Type1 families (case insensitive):&lt;ul&gt;&lt;li&gt;times (Times-Roman)&lt;/li&gt;&lt;li&gt;timesb (Times-Bold)&lt;/li&gt;&lt;li&gt;timesi (Times-Italic)&lt;/li&gt;&lt;li&gt;timesbi (Times-BoldItalic)&lt;/li&gt;&lt;li&gt;helvetica (Helvetica)&lt;/li&gt;&lt;li&gt;helveticab (Helvetica-Bold)&lt;/li&gt;&lt;li&gt;helveticai (Helvetica-Oblique)&lt;/li&gt;&lt;li&gt;helveticabi (Helvetica-BoldOblique)&lt;/li&gt;&lt;li&gt;courier (Courier)&lt;/li&gt;&lt;li&gt;courierb (Courier-Bold)&lt;/li&gt;&lt;li&gt;courieri (Courier-Oblique)&lt;/li&gt;&lt;li&gt;courierbi (Courier-BoldOblique)&lt;/li&gt;&lt;li&gt;symbol (Symbol)&lt;/li&gt;&lt;li&gt;zapfdingbats (ZapfDingbats)&lt;/li&gt;&lt;/ul&gt; It is also possible to pass an empty string. In that case, the current family is retained.</span>
<a name="l05222"></a>05222 <span class="comment">     * @param $style (string) Font style. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;empty string: regular&lt;/li&gt;&lt;li&gt;B: bold&lt;/li&gt;&lt;li&gt;I: italic&lt;/li&gt;&lt;li&gt;U: underline&lt;/li&gt;&lt;li&gt;D: line trough&lt;/li&gt;&lt;li&gt;O: overline&lt;/li&gt;&lt;/ul&gt; or any combination. The default value is regular. Bold and italic styles do not apply to Symbol and ZapfDingbats basic fonts or other fonts when not defined.</span>
<a name="l05223"></a>05223 <span class="comment">     * @param $size (float) Font size in points. The default value is the current size. If no size has been specified since the beginning of the document, the value taken is 12</span>
<a name="l05224"></a>05224 <span class="comment">     * @param $fontfile (string) The font definition file. By default, the name is built from the family and style, in lower case with no spaces.</span>
<a name="l05225"></a>05225 <span class="comment">     * @param $subset (mixed) if true embedd only a subset of the font (stores only the information related to the used characters); if false embedd full font; if &#39;default&#39; uses the default value set using setFontSubsetting(). This option is valid only for TrueTypeUnicode fonts. If you want to enable users to change the document, set this parameter to false. If you subset the font, the person who receives your PDF would need to have your same font in order to make changes to your PDF. The file size of the PDF would also be smaller because you are embedding only part of a font.</span>
<a name="l05226"></a>05226 <span class="comment">     * @param $out (boolean) if true output the font size command, otherwise only set the font properties.</span>
<a name="l05227"></a>05227 <span class="comment">     * @author Nicola Asuni</span>
<a name="l05228"></a>05228 <span class="comment">     * @public</span>
<a name="l05229"></a>05229 <span class="comment">     * @since 1.0</span>
<a name="l05230"></a>05230 <span class="comment">     * @see AddFont(), SetFontSize()</span>
<a name="l05231"></a>05231 <span class="comment">     */</span>
<a name="l05232"></a><a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e">05232</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5b5d57a2e74820e41c69737b2d4b6c9e" title="Sets the font used to print character strings.">SetFont</a>($family, $style=<span class="stringliteral">&#39;&#39;</span>, $size=0, $fontfile=<span class="stringliteral">&#39;&#39;</span>, $subset=<span class="stringliteral">&#39;default&#39;</span>, <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>=<span class="keyword">true</span>) {
<a name="l05233"></a>05233         <span class="comment">//Select a font; size given in points</span>
<a name="l05234"></a>05234         <span class="keywordflow">if</span> ($size == 0) {
<a name="l05235"></a>05235             $size = $this-&gt;FontSizePt;
<a name="l05236"></a>05236         }
<a name="l05237"></a>05237         <span class="comment">// try to add font (if not already added)</span>
<a name="l05238"></a>05238         $fontdata = $this-&gt;<a class="code" href="classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776" title="Imports a TrueType, Type1, core, or CID0 font and makes it available.">AddFont</a>($family, $style, $fontfile, $subset);
<a name="l05239"></a>05239         $this-&gt;FontFamily = $fontdata[<span class="stringliteral">&#39;family&#39;</span>];
<a name="l05240"></a>05240         $this-&gt;FontStyle = $fontdata[<span class="stringliteral">&#39;style&#39;</span>];
<a name="l05241"></a>05241         $this-&gt;CurrentFont = $this-&gt;<a class="code" href="classTCPDF.html#ac63fff093a17846764bbcc09af7c8640" title="Get font buffer content.">getFontBuffer</a>($fontdata[<span class="stringliteral">&#39;fontkey&#39;</span>]);
<a name="l05242"></a>05242         $this-&gt;<a class="code" href="classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f" title="Defines the size of the current font.">SetFontSize</a>($size, <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l05243"></a>05243     }
<a name="l05244"></a>05244 <span class="comment"></span>
<a name="l05245"></a>05245 <span class="comment">    /**</span>
<a name="l05246"></a>05246 <span class="comment">     * Defines the size of the current font.</span>
<a name="l05247"></a>05247 <span class="comment">     * @param $size (float) The font size in points.</span>
<a name="l05248"></a>05248 <span class="comment">     * @param $out (boolean) if true output the font size command, otherwise only set the font properties.</span>
<a name="l05249"></a>05249 <span class="comment">     * @public</span>
<a name="l05250"></a>05250 <span class="comment">     * @since 1.0</span>
<a name="l05251"></a>05251 <span class="comment">     * @see SetFont()</span>
<a name="l05252"></a>05252 <span class="comment">     */</span>
<a name="l05253"></a><a class="code" href="classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f">05253</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f" title="Defines the size of the current font.">SetFontSize</a>($size, <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>=<span class="keyword">true</span>) {
<a name="l05254"></a>05254         <span class="comment">// font size in points</span>
<a name="l05255"></a>05255         $this-&gt;FontSizePt = $size;
<a name="l05256"></a>05256         <span class="comment">// font size in user units</span>
<a name="l05257"></a>05257         $this-&gt;FontSize = $size / $this-&gt;k;
<a name="l05258"></a>05258         <span class="comment">// calculate some font metrics</span>
<a name="l05259"></a>05259         <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;FontBBox&#39;</span>])) {
<a name="l05260"></a>05260             $bbox = explode(<span class="charliteral">&#39; &#39;</span>, substr($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;FontBBox&#39;</span>], 1, -1));
<a name="l05261"></a>05261             $font_height = ((intval($bbox[3]) - intval($bbox[1])) * $size / 1000);
<a name="l05262"></a>05262         } <span class="keywordflow">else</span> {
<a name="l05263"></a>05263             $font_height = $size * 1.219;
<a name="l05264"></a>05264         }
<a name="l05265"></a>05265         <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>]) AND ($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] &gt; 0)) {
<a name="l05266"></a>05266             $font_ascent = ($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] * $size / 1000);
<a name="l05267"></a>05267         }
<a name="l05268"></a>05268         <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>]) AND ($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>] &lt;= 0)) {
<a name="l05269"></a>05269             $font_descent = (- $this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>] * $size / 1000);
<a name="l05270"></a>05270         }
<a name="l05271"></a>05271         <span class="keywordflow">if</span> (!isset($font_ascent) AND !isset($font_descent)) {
<a name="l05272"></a>05272             <span class="comment">// core font</span>
<a name="l05273"></a>05273             $font_ascent = 0.76 * $font_height;
<a name="l05274"></a>05274             $font_descent = $font_height - $font_ascent;
<a name="l05275"></a>05275         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (!isset($font_descent)) {
<a name="l05276"></a>05276             $font_descent = $font_height - $font_ascent;
<a name="l05277"></a>05277         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (!isset($font_ascent)) {
<a name="l05278"></a>05278             $font_ascent = $font_height - $font_descent;
<a name="l05279"></a>05279         }
<a name="l05280"></a>05280         $this-&gt;FontAscent = ($font_ascent / $this-&gt;k);
<a name="l05281"></a>05281         $this-&gt;FontDescent = ($font_descent / $this-&gt;k);
<a name="l05282"></a>05282         <span class="keywordflow">if</span> (<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> AND ($this-&gt;page &gt; 0) AND (isset($this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>]))) {
<a name="l05283"></a>05283             $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(sprintf(<span class="stringliteral">&#39;BT /F%d %.2F Tf ET&#39;</span>, $this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt));
<a name="l05284"></a>05284         }
<a name="l05285"></a>05285     }
<a name="l05286"></a>05286 <span class="comment"></span>
<a name="l05287"></a>05287 <span class="comment">    /**</span>
<a name="l05288"></a>05288 <span class="comment">     * Return the font descent value</span>
<a name="l05289"></a>05289 <span class="comment">     * @param $font (string) font name</span>
<a name="l05290"></a>05290 <span class="comment">     * @param $style (string) font style</span>
<a name="l05291"></a>05291 <span class="comment">     * @param $size (float) The size (in points)</span>
<a name="l05292"></a>05292 <span class="comment">     * @return int font descent</span>
<a name="l05293"></a>05293 <span class="comment">     * @public</span>
<a name="l05294"></a>05294 <span class="comment">     * @author Nicola Asuni</span>
<a name="l05295"></a>05295 <span class="comment">     * @since 4.9.003 (2010-03-30)</span>
<a name="l05296"></a>05296 <span class="comment">     */</span>
<a name="l05297"></a><a class="code" href="classTCPDF.html#a0c8374150dbc8ca092618ca430713f70">05297</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0c8374150dbc8ca092618ca430713f70" title="Return the font descent value.">getFontDescent</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $style=<span class="stringliteral">&#39;&#39;</span>, $size=0) {
<a name="l05298"></a>05298         $fontdata = $this-&gt;<a class="code" href="classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776" title="Imports a TrueType, Type1, core, or CID0 font and makes it available.">AddFont</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $style);
<a name="l05299"></a>05299         $fontinfo = $this-&gt;<a class="code" href="classTCPDF.html#ac63fff093a17846764bbcc09af7c8640" title="Get font buffer content.">getFontBuffer</a>($fontdata[<span class="stringliteral">&#39;fontkey&#39;</span>]);
<a name="l05300"></a>05300         <span class="keywordflow">if</span> (isset($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>]) AND ($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>] &lt;= 0)) {
<a name="l05301"></a>05301             $descent = (- $fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>] * $size / 1000);
<a name="l05302"></a>05302         } <span class="keywordflow">else</span> {
<a name="l05303"></a>05303             $descent = 1.219 * 0.24 * $size;
<a name="l05304"></a>05304         }
<a name="l05305"></a>05305         <span class="keywordflow">return</span> ($descent / $this-&gt;k);
<a name="l05306"></a>05306     }
<a name="l05307"></a>05307 <span class="comment"></span>
<a name="l05308"></a>05308 <span class="comment">    /**</span>
<a name="l05309"></a>05309 <span class="comment">     * Return the font ascent value</span>
<a name="l05310"></a>05310 <span class="comment">     * @param $font (string) font name</span>
<a name="l05311"></a>05311 <span class="comment">     * @param $style (string) font style</span>
<a name="l05312"></a>05312 <span class="comment">     * @param $size (float) The size (in points)</span>
<a name="l05313"></a>05313 <span class="comment">     * @return int font ascent</span>
<a name="l05314"></a>05314 <span class="comment">     * @public</span>
<a name="l05315"></a>05315 <span class="comment">     * @author Nicola Asuni</span>
<a name="l05316"></a>05316 <span class="comment">     * @since 4.9.003 (2010-03-30)</span>
<a name="l05317"></a>05317 <span class="comment">     */</span>
<a name="l05318"></a><a class="code" href="classTCPDF.html#acf41c6c04c29e1323bb270fdea6b5a9f">05318</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#acf41c6c04c29e1323bb270fdea6b5a9f" title="Return the font ascent value.">getFontAscent</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $style=<span class="stringliteral">&#39;&#39;</span>, $size=0) {
<a name="l05319"></a>05319         $fontdata = $this-&gt;<a class="code" href="classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776" title="Imports a TrueType, Type1, core, or CID0 font and makes it available.">AddFont</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $style);
<a name="l05320"></a>05320         $fontinfo = $this-&gt;<a class="code" href="classTCPDF.html#ac63fff093a17846764bbcc09af7c8640" title="Get font buffer content.">getFontBuffer</a>($fontdata[<span class="stringliteral">&#39;fontkey&#39;</span>]);
<a name="l05321"></a>05321         <span class="keywordflow">if</span> (isset($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>]) AND ($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] &gt; 0)) {
<a name="l05322"></a>05322             $ascent = ($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] * $size / 1000);
<a name="l05323"></a>05323         } <span class="keywordflow">else</span> {
<a name="l05324"></a>05324             $ascent = 1.219 * 0.76 * $size;
<a name="l05325"></a>05325         }
<a name="l05326"></a>05326         <span class="keywordflow">return</span> ($ascent / $this-&gt;k);
<a name="l05327"></a>05327     }
<a name="l05328"></a>05328 <span class="comment"></span>
<a name="l05329"></a>05329 <span class="comment">    /**</span>
<a name="l05330"></a>05330 <span class="comment">     * Defines the default monospaced font.</span>
<a name="l05331"></a>05331 <span class="comment">     * @param $font (string) Font name.</span>
<a name="l05332"></a>05332 <span class="comment">     * @public</span>
<a name="l05333"></a>05333 <span class="comment">     * @since 4.5.025</span>
<a name="l05334"></a>05334 <span class="comment">     */</span>
<a name="l05335"></a><a class="code" href="classTCPDF.html#ae9b45d6f58118e2bc12c44cca8eed61b">05335</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae9b45d6f58118e2bc12c44cca8eed61b" title="Defines the default monospaced font.">SetDefaultMonospacedFont</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>) {
<a name="l05336"></a>05336         $this-&gt;default_monospaced_font = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l05337"></a>05337     }
<a name="l05338"></a>05338 <span class="comment"></span>
<a name="l05339"></a>05339 <span class="comment">    /**</span>
<a name="l05340"></a>05340 <span class="comment">     * Creates a new internal link and returns its identifier. An internal link is a clickable area which directs to another place within the document.&lt;br /&gt;</span>
<a name="l05341"></a>05341 <span class="comment">     * The identifier can then be passed to Cell(), Write(), Image() or Link(). The destination is defined with SetLink().</span>
<a name="l05342"></a>05342 <span class="comment">     * @public</span>
<a name="l05343"></a>05343 <span class="comment">     * @since 1.5</span>
<a name="l05344"></a>05344 <span class="comment">     * @see Cell(), Write(), Image(), Link(), SetLink()</span>
<a name="l05345"></a>05345 <span class="comment">     */</span>
<a name="l05346"></a><a class="code" href="classTCPDF.html#a749522038ed7786c3e1701435dcb891e">05346</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a749522038ed7786c3e1701435dcb891e" title="Creates a new internal link and returns its identifier.">AddLink</a>() {
<a name="l05347"></a>05347         <span class="comment">//Create a new internal link</span>
<a name="l05348"></a>05348         <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a> = count($this-&gt;links) + 1;
<a name="l05349"></a>05349         $this-&gt;links[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>] = array(0, 0);
<a name="l05350"></a>05350         <span class="keywordflow">return</span> <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>;
<a name="l05351"></a>05351     }
<a name="l05352"></a>05352 <span class="comment"></span>
<a name="l05353"></a>05353 <span class="comment">    /**</span>
<a name="l05354"></a>05354 <span class="comment">     * Defines the page and position a link points to.</span>
<a name="l05355"></a>05355 <span class="comment">     * @param $link (int) The link identifier returned by AddLink()</span>
<a name="l05356"></a>05356 <span class="comment">     * @param $y (float) Ordinate of target position; -1 indicates the current position. The default value is 0 (top of page)</span>
<a name="l05357"></a>05357 <span class="comment">     * @param $page (int) Number of target page; -1 indicates the current page. This is the default value</span>
<a name="l05358"></a>05358 <span class="comment">     * @public</span>
<a name="l05359"></a>05359 <span class="comment">     * @since 1.5</span>
<a name="l05360"></a>05360 <span class="comment">     * @see AddLink()</span>
<a name="l05361"></a>05361 <span class="comment">     */</span>
<a name="l05362"></a><a class="code" href="classTCPDF.html#ace5be60e7857953ea5e2b89cb90df0ae">05362</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ace5be60e7857953ea5e2b89cb90df0ae" title="Defines the page and position a link points to.">SetLink</a>($link, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>=0, <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>=-1) {
<a name="l05363"></a>05363         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> == -1) {
<a name="l05364"></a>05364             <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = $this-&gt;y;
<a name="l05365"></a>05365         }
<a name="l05366"></a>05366         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> == -1) {
<a name="l05367"></a>05367             <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> = $this-&gt;page;
<a name="l05368"></a>05368         }
<a name="l05369"></a>05369         $this-&gt;links[$link] = array(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>);
<a name="l05370"></a>05370     }
<a name="l05371"></a>05371 <span class="comment"></span>
<a name="l05372"></a>05372 <span class="comment">    /**</span>
<a name="l05373"></a>05373 <span class="comment">     * Puts a link on a rectangular area of the page.</span>
<a name="l05374"></a>05374 <span class="comment">     * Text or image links are generally put via Cell(), Write() or Image(), but this method can be useful for instance to define a clickable area inside an image.</span>
<a name="l05375"></a>05375 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner of the rectangle</span>
<a name="l05376"></a>05376 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner of the rectangle</span>
<a name="l05377"></a>05377 <span class="comment">     * @param $w (float) Width of the rectangle</span>
<a name="l05378"></a>05378 <span class="comment">     * @param $h (float) Height of the rectangle</span>
<a name="l05379"></a>05379 <span class="comment">     * @param $link (mixed) URL or identifier returned by AddLink()</span>
<a name="l05380"></a>05380 <span class="comment">     * @param $spaces (int) number of spaces on the text to link</span>
<a name="l05381"></a>05381 <span class="comment">     * @public</span>
<a name="l05382"></a>05382 <span class="comment">     * @since 1.5</span>
<a name="l05383"></a>05383 <span class="comment">     * @see AddLink(), Annotation(), Cell(), Write(), Image()</span>
<a name="l05384"></a>05384 <span class="comment">     */</span>
<a name="l05385"></a><a class="code" href="classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994">05385</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994" title="Puts a link on a rectangular area of the page.">Link</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $link, $spaces=0) {
<a name="l05386"></a>05386         $this-&gt;<a class="code" href="classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b" title="Puts a markup annotation on a rectangular area of the page.">Annotation</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $link, array(<span class="stringliteral">&#39;Subtype&#39;</span>=&gt;<span class="stringliteral">&#39;Link&#39;</span>), $spaces);
<a name="l05387"></a>05387     }
<a name="l05388"></a>05388 <span class="comment"></span>
<a name="l05389"></a>05389 <span class="comment">    /**</span>
<a name="l05390"></a>05390 <span class="comment">     * Puts a markup annotation on a rectangular area of the page.</span>
<a name="l05391"></a>05391 <span class="comment">     * !!!!THE ANNOTATION SUPPORT IS NOT YET FULLY IMPLEMENTED !!!!</span>
<a name="l05392"></a>05392 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner of the rectangle</span>
<a name="l05393"></a>05393 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner of the rectangle</span>
<a name="l05394"></a>05394 <span class="comment">     * @param $w (float) Width of the rectangle</span>
<a name="l05395"></a>05395 <span class="comment">     * @param $h (float) Height of the rectangle</span>
<a name="l05396"></a>05396 <span class="comment">     * @param $text (string) annotation text or alternate content</span>
<a name="l05397"></a>05397 <span class="comment">     * @param $opt (array) array of options (see section 8.4 of PDF reference 1.7).</span>
<a name="l05398"></a>05398 <span class="comment">     * @param $spaces (int) number of spaces on the text to link</span>
<a name="l05399"></a>05399 <span class="comment">     * @public</span>
<a name="l05400"></a>05400 <span class="comment">     * @since 4.0.018 (2008-08-06)</span>
<a name="l05401"></a>05401 <span class="comment">     */</span>
<a name="l05402"></a><a class="code" href="classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b">05402</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b" title="Puts a markup annotation on a rectangular area of the page.">Annotation</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>, $opt=array(<span class="stringliteral">&#39;Subtype&#39;</span>=&gt;<span class="stringliteral">&#39;Text&#39;</span>), $spaces=0) {
<a name="l05403"></a>05403         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l05404"></a>05404             <span class="comment">// store parameters for later use on template</span>
<a name="l05405"></a>05405             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>][] = array(<span class="charliteral">&#39;x&#39;</span> =&gt; <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <span class="charliteral">&#39;y&#39;</span> =&gt; <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <span class="charliteral">&#39;w&#39;</span> =&gt; <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <span class="charliteral">&#39;h&#39;</span> =&gt; <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;text&#39;</span> =&gt; <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>, <span class="stringliteral">&#39;opt&#39;</span> =&gt; $opt, <span class="stringliteral">&#39;spaces&#39;</span> =&gt; $spaces);
<a name="l05406"></a>05406             <span class="keywordflow">return</span>;
<a name="l05407"></a>05407         }
<a name="l05408"></a>05408         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l05409"></a>05409             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = $this-&gt;x;
<a name="l05410"></a>05410         }
<a name="l05411"></a>05411         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l05412"></a>05412             <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = $this-&gt;y;
<a name="l05413"></a>05413         }
<a name="l05414"></a>05414         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l05415"></a>05415         list(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>) = $this-&gt;<a class="code" href="classTCPDF.html#a1d99e81697a90efb13a6734001427f40" title="Check page for no-write regions and adapt current coordinates and page margins if necessary...">checkPageRegions</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>);
<a name="l05416"></a>05416         <span class="comment">// recalculate coordinates to account for graphic transformations</span>
<a name="l05417"></a>05417         <span class="keywordflow">if</span> (isset($this-&gt;transfmatrix) AND !empty($this-&gt;transfmatrix)) {
<a name="l05418"></a>05418             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=$this-&gt;transfmatrix_key; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; 0; --<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l05419"></a>05419                 $maxid = count($this-&gt;transfmatrix[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) - 1;
<a name="l05420"></a>05420                 <span class="keywordflow">for</span> ($j=$maxid; $j &gt;= 0; --$j) {
<a name="l05421"></a>05421                     $ctm = $this-&gt;transfmatrix[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][$j];
<a name="l05422"></a>05422                     <span class="keywordflow">if</span> (isset($ctm[<span class="charliteral">&#39;a&#39;</span>])) {
<a name="l05423"></a>05423                         <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> * $this-&gt;k;
<a name="l05424"></a>05424                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = ($this-&gt;h - <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>) * $this-&gt;k;
<a name="l05425"></a>05425                         <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> * $this-&gt;k;
<a name="l05426"></a>05426                         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> * $this-&gt;k;
<a name="l05427"></a>05427                         <span class="comment">// top left</span>
<a name="l05428"></a>05428                         $xt = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l05429"></a>05429                         $yt = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>;
<a name="l05430"></a>05430                         $x1 = ($ctm[<span class="charliteral">&#39;a&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;c&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;e&#39;</span>];
<a name="l05431"></a>05431                         $y1 = ($ctm[<span class="charliteral">&#39;b&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;d&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;f&#39;</span>];
<a name="l05432"></a>05432                         <span class="comment">// top right</span>
<a name="l05433"></a>05433                         $xt = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l05434"></a>05434                         $yt = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>;
<a name="l05435"></a>05435                         $x2 = ($ctm[<span class="charliteral">&#39;a&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;c&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;e&#39;</span>];
<a name="l05436"></a>05436                         $y2 = ($ctm[<span class="charliteral">&#39;b&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;d&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;f&#39;</span>];
<a name="l05437"></a>05437                         <span class="comment">// bottom left</span>
<a name="l05438"></a>05438                         $xt = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l05439"></a>05439                         $yt = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> - <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l05440"></a>05440                         $x3 = ($ctm[<span class="charliteral">&#39;a&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;c&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;e&#39;</span>];
<a name="l05441"></a>05441                         $y3 = ($ctm[<span class="charliteral">&#39;b&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;d&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;f&#39;</span>];
<a name="l05442"></a>05442                         <span class="comment">// bottom right</span>
<a name="l05443"></a>05443                         $xt = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l05444"></a>05444                         $yt = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> - <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l05445"></a>05445                         $x4 = ($ctm[<span class="charliteral">&#39;a&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;c&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;e&#39;</span>];
<a name="l05446"></a>05446                         $y4 = ($ctm[<span class="charliteral">&#39;b&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;d&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;f&#39;</span>];
<a name="l05447"></a>05447                         <span class="comment">// new coordinates (rectangle area)</span>
<a name="l05448"></a>05448                         <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = min($x1, $x2, $x3, $x4);
<a name="l05449"></a>05449                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = max($y1, $y2, $y3, $y4);
<a name="l05450"></a>05450                         $w = (max($x1, $x2, $x3, $x4) - <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>) / $this-&gt;k;
<a name="l05451"></a>05451                         $h = (<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> - min($y1, $y2, $y3, $y4)) / $this-&gt;k;
<a name="l05452"></a>05452                         <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> / $this-&gt;k;
<a name="l05453"></a>05453                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = $this-&gt;h - (<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> / $this-&gt;k);
<a name="l05454"></a>05454                     }
<a name="l05455"></a>05455                 }
<a name="l05456"></a>05456             }
<a name="l05457"></a>05457         }
<a name="l05458"></a>05458         <span class="keywordflow">if</span> ($this-&gt;page &lt;= 0) {
<a name="l05459"></a>05459             <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> = 1;
<a name="l05460"></a>05460         } <span class="keywordflow">else</span> {
<a name="l05461"></a>05461             <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> = $this-&gt;page;
<a name="l05462"></a>05462         }
<a name="l05463"></a>05463         <span class="keywordflow">if</span> (!isset($this-&gt;PageAnnots[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>])) {
<a name="l05464"></a>05464             $this-&gt;PageAnnots[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>] = array();
<a name="l05465"></a>05465         }
<a name="l05466"></a>05466         ++$this-&gt;n;
<a name="l05467"></a>05467         $this-&gt;PageAnnots[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n, <span class="charliteral">&#39;x&#39;</span> =&gt; <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <span class="charliteral">&#39;y&#39;</span> =&gt; <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <span class="charliteral">&#39;w&#39;</span> =&gt; <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <span class="charliteral">&#39;h&#39;</span> =&gt; <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;txt&#39;</span> =&gt; <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>, <span class="stringliteral">&#39;opt&#39;</span> =&gt; $opt, <span class="stringliteral">&#39;numspaces&#39;</span> =&gt; $spaces);
<a name="l05468"></a>05468         <span class="keywordflow">if</span> (!$this-&gt;pdfa_mode) {
<a name="l05469"></a>05469             <span class="keywordflow">if</span> ((($opt[<span class="stringliteral">&#39;Subtype&#39;</span>] == <span class="stringliteral">&#39;FileAttachment&#39;</span>) OR ($opt[<span class="stringliteral">&#39;Subtype&#39;</span>] == <span class="stringliteral">&#39;Sound&#39;</span>)) AND (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($opt[<span class="stringliteral">&#39;FS&#39;</span>])) AND file_exists($opt[<span class="stringliteral">&#39;FS&#39;</span>]) AND (!isset($this-&gt;embeddedfiles[basename($opt[<span class="stringliteral">&#39;FS&#39;</span>])]))) {
<a name="l05470"></a>05470                 ++$this-&gt;n;
<a name="l05471"></a>05471                 $this-&gt;embeddedfiles[basename($opt[<span class="stringliteral">&#39;FS&#39;</span>])] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n, <span class="stringliteral">&#39;file&#39;</span> =&gt; $opt[<span class="stringliteral">&#39;FS&#39;</span>]);
<a name="l05472"></a>05472             }
<a name="l05473"></a>05473         }
<a name="l05474"></a>05474         <span class="comment">// Add widgets annotation&#39;s icons</span>
<a name="l05475"></a>05475         <span class="keywordflow">if</span> (isset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]) AND file_exists($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>])) {
<a name="l05476"></a>05476             $this-&gt;<a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352" title="Puts an image in the page.">Image</a>($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 10, 10, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>);
<a name="l05477"></a>05477         }
<a name="l05478"></a>05478         <span class="keywordflow">if</span> (isset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>]) AND file_exists($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>])) {
<a name="l05479"></a>05479             $this-&gt;<a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352" title="Puts an image in the page.">Image</a>($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>);
<a name="l05480"></a>05480         }
<a name="l05481"></a>05481         <span class="keywordflow">if</span> (isset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>]) AND file_exists($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>])) {
<a name="l05482"></a>05482             $this-&gt;<a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352" title="Puts an image in the page.">Image</a>($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>);
<a name="l05483"></a>05483         }
<a name="l05484"></a>05484     }
<a name="l05485"></a>05485 <span class="comment"></span>
<a name="l05486"></a>05486 <span class="comment">    /**</span>
<a name="l05487"></a>05487 <span class="comment">     * Embedd the attached files.</span>
<a name="l05488"></a>05488 <span class="comment">     * @since 4.4.000 (2008-12-07)</span>
<a name="l05489"></a>05489 <span class="comment">     * @protected</span>
<a name="l05490"></a>05490 <span class="comment">     * @see Annotation()</span>
<a name="l05491"></a>05491 <span class="comment">     */</span>
<a name="l05492"></a><a class="code" href="classTCPDF.html#ad3e9b80cfbd309301aa9a10d29282749">05492</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad3e9b80cfbd309301aa9a10d29282749" title="Embedd the attached files.">_putEmbeddedFiles</a>() {
<a name="l05493"></a>05493         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l05494"></a>05494             <span class="comment">// embedded files are not allowed in PDF/A mode</span>
<a name="l05495"></a>05495             <span class="keywordflow">return</span>;
<a name="l05496"></a>05496         }
<a name="l05497"></a>05497         reset($this-&gt;embeddedfiles);
<a name="l05498"></a>05498         <span class="keywordflow">foreach</span> ($this-&gt;embeddedfiles as <a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a> =&gt; $filedata) {
<a name="l05499"></a>05499             <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = file_get_contents($filedata[<span class="stringliteral">&#39;file&#39;</span>]);
<a name="l05500"></a>05500             $filter = <span class="stringliteral">&#39;&#39;</span>;
<a name="l05501"></a>05501             <span class="keywordflow">if</span> ($this-&gt;compress) {
<a name="l05502"></a>05502                 <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = gzcompress(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l05503"></a>05503                 $filter = <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;
<a name="l05504"></a>05504             }
<a name="l05505"></a>05505             $stream = $this-&gt;<a class="code" href="classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb" title="get raw output stream.">_getrawstream</a>(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, $filedata[<span class="charliteral">&#39;n&#39;</span>]);
<a name="l05506"></a>05506             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;<a class="code" href="classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1" title="Return the starting object string for the selected object ID.">_getobj</a>($filedata[<span class="charliteral">&#39;n&#39;</span>]).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l05507"></a>05507             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt; /Type /EmbeddedFile&#39;</span>.$filter.<span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream).<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l05508"></a>05508             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l05509"></a>05509             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l05510"></a>05510             $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l05511"></a>05511         }
<a name="l05512"></a>05512     }
<a name="l05513"></a>05513 <span class="comment"></span>
<a name="l05514"></a>05514 <span class="comment">    /**</span>
<a name="l05515"></a>05515 <span class="comment">     * Prints a text cell at the specified position.</span>
<a name="l05516"></a>05516 <span class="comment">     * This method allows to place a string precisely on the page.</span>
<a name="l05517"></a>05517 <span class="comment">     * @param $x (float) Abscissa of the cell origin</span>
<a name="l05518"></a>05518 <span class="comment">     * @param $y (float) Ordinate of the cell origin</span>
<a name="l05519"></a>05519 <span class="comment">     * @param $txt (string) String to print</span>
<a name="l05520"></a>05520 <span class="comment">     * @param $fstroke (int) outline size in user units (false = disable)</span>
<a name="l05521"></a>05521 <span class="comment">     * @param $fclip (boolean) if true activate clipping mode (you must call StartTransform() before this function and StopTransform() to stop the clipping tranformation).</span>
<a name="l05522"></a>05522 <span class="comment">     * @param $ffill (boolean) if true fills the text</span>
<a name="l05523"></a>05523 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l05524"></a>05524 <span class="comment">     * @param $ln (int) Indicates where the current position should go after the call. Possible values are:&lt;ul&gt;&lt;li&gt;0: to the right (or left for RTL languages)&lt;/li&gt;&lt;li&gt;1: to the beginning of the next line&lt;/li&gt;&lt;li&gt;2: below&lt;/li&gt;&lt;/ul&gt;Putting 1 is equivalent to putting 0 and calling Ln() just after. Default value: 0.</span>
<a name="l05525"></a>05525 <span class="comment">     * @param $align (string) Allows to center or align the text. Possible values are:&lt;ul&gt;&lt;li&gt;L or empty string: left align (default value)&lt;/li&gt;&lt;li&gt;C: center&lt;/li&gt;&lt;li&gt;R: right align&lt;/li&gt;&lt;li&gt;J: justify&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l05526"></a>05526 <span class="comment">     * @param $fill (boolean) Indicates if the cell background must be painted (true) or transparent (false).</span>
<a name="l05527"></a>05527 <span class="comment">     * @param $link (mixed) URL or identifier returned by AddLink().</span>
<a name="l05528"></a>05528 <span class="comment">     * @param $stretch (int) font stretch mode: &lt;ul&gt;&lt;li&gt;0 = disabled&lt;/li&gt;&lt;li&gt;1 = horizontal scaling only if text is larger than cell width&lt;/li&gt;&lt;li&gt;2 = forced horizontal scaling to fit cell width&lt;/li&gt;&lt;li&gt;3 = character spacing only if text is larger than cell width&lt;/li&gt;&lt;li&gt;4 = forced character spacing to fit cell width&lt;/li&gt;&lt;/ul&gt; General font stretching and scaling values will be preserved when possible.</span>
<a name="l05529"></a>05529 <span class="comment">     * @param $ignore_min_height (boolean) if true ignore automatic minimum height value.</span>
<a name="l05530"></a>05530 <span class="comment">     * @param $calign (string) cell vertical alignment relative to the specified Y value. Possible values are:&lt;ul&gt;&lt;li&gt;T : cell top&lt;/li&gt;&lt;li&gt;A : font top&lt;/li&gt;&lt;li&gt;L : font baseline&lt;/li&gt;&lt;li&gt;D : font bottom&lt;/li&gt;&lt;li&gt;B : cell bottom&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l05531"></a>05531 <span class="comment">     * @param $valign (string) text vertical alignment inside the cell. Possible values are:&lt;ul&gt;&lt;li&gt;T : top&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;B : bottom&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l05532"></a>05532 <span class="comment">     * @param $rtloff (boolean) if true uses the page top-left corner as origin of axis for $x and $y initial position.</span>
<a name="l05533"></a>05533 <span class="comment">     * @public</span>
<a name="l05534"></a>05534 <span class="comment">     * @since 1.0</span>
<a name="l05535"></a>05535 <span class="comment">     * @see Cell(), Write(), MultiCell(), WriteHTML(), WriteHTMLCell()</span>
<a name="l05536"></a>05536 <span class="comment">     */</span>
<a name="l05537"></a><a class="code" href="classTCPDF.html#abf1daa47cbb1f2abe310d19124a1e35e">05537</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#abf1daa47cbb1f2abe310d19124a1e35e" title="Prints a text cell at the specified position.">Text</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, $txt, $fstroke=<span class="keyword">false</span>, $fclip=<span class="keyword">false</span>, $ffill=<span class="keyword">true</span>, $border=0, $ln=0, $align=<span class="stringliteral">&#39;&#39;</span>, $fill=<span class="keyword">false</span>, $link=<span class="stringliteral">&#39;&#39;</span>, $stretch=0, $ignore_min_height=<span class="keyword">false</span>, $calign=<span class="charliteral">&#39;T&#39;</span>, $valign=<span class="charliteral">&#39;M&#39;</span>, $rtloff=<span class="keyword">false</span>) {
<a name="l05538"></a>05538         <a class="code" href="classTCPDF.html#a45310f49168f541285b71f190645ff45" title="Text rendering mode: 0 = Fill text; 1 = Stroke text; 2 = Fill, then stroke text; 3 = Neither fill nor...">$textrendermode</a> = $this-&gt;textrendermode;
<a name="l05539"></a>05539         <a class="code" href="classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922" title="Text stroke width in doc units.">$textstrokewidth</a> = $this-&gt;textstrokewidth;
<a name="l05540"></a>05540         $this-&gt;<a class="code" href="classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107" title="Set Text rendering mode.">setTextRenderingMode</a>($fstroke, $ffill, $fclip);
<a name="l05541"></a>05541         $this-&gt;<a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, $rtloff);
<a name="l05542"></a>05542         $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(0, 0, $txt, $border, $ln, $align, $fill, $link, $stretch, $ignore_min_height, $calign, $valign);
<a name="l05543"></a>05543         <span class="comment">// restore previous rendering mode</span>
<a name="l05544"></a>05544         $this-&gt;textrendermode = <a class="code" href="classTCPDF.html#a45310f49168f541285b71f190645ff45" title="Text rendering mode: 0 = Fill text; 1 = Stroke text; 2 = Fill, then stroke text; 3 = Neither fill nor...">$textrendermode</a>;
<a name="l05545"></a>05545         $this-&gt;textstrokewidth = <a class="code" href="classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922" title="Text stroke width in doc units.">$textstrokewidth</a>;
<a name="l05546"></a>05546     }
<a name="l05547"></a>05547 <span class="comment"></span>
<a name="l05548"></a>05548 <span class="comment">    /**</span>
<a name="l05549"></a>05549 <span class="comment">     * Whenever a page break condition is met, the method is called, and the break is issued or not depending on the returned value.</span>
<a name="l05550"></a>05550 <span class="comment">     * The default implementation returns a value according to the mode selected by SetAutoPageBreak().&lt;br /&gt;</span>
<a name="l05551"></a>05551 <span class="comment">     * This method is called automatically and should not be called directly by the application.</span>
<a name="l05552"></a>05552 <span class="comment">     * @return boolean</span>
<a name="l05553"></a>05553 <span class="comment">     * @public</span>
<a name="l05554"></a>05554 <span class="comment">     * @since 1.4</span>
<a name="l05555"></a>05555 <span class="comment">     * @see SetAutoPageBreak()</span>
<a name="l05556"></a>05556 <span class="comment">     */</span>
<a name="l05557"></a><a class="code" href="classTCPDF.html#aa24046de2993933f62d60a2936a22970">05557</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa24046de2993933f62d60a2936a22970" title="Whenever a page break condition is met, the method is called, and the break is issued or not dependin...">AcceptPageBreak</a>() {
<a name="l05558"></a>05558         <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {
<a name="l05559"></a>05559             <span class="comment">// multi column mode</span>
<a name="l05560"></a>05560             <span class="keywordflow">if</span> ($this-&gt;current_column &lt; ($this-&gt;num_columns - 1)) {
<a name="l05561"></a>05561                 <span class="comment">// go to next column</span>
<a name="l05562"></a>05562                 $this-&gt;<a class="code" href="classTCPDF.html#a4f11d769024fd07e1f663efd02d10517" title="Set position at a given column.">selectColumn</a>($this-&gt;current_column + 1);
<a name="l05563"></a>05563             } <span class="keywordflow">else</span> {
<a name="l05564"></a>05564                 <span class="comment">// add a new page</span>
<a name="l05565"></a>05565                 $this-&gt;<a class="code" href="classTCPDF.html#a5171e20b366b74523709d84c349c1ced" title="Adds a new page to the document.">AddPage</a>();
<a name="l05566"></a>05566                 <span class="comment">// set first column</span>
<a name="l05567"></a>05567                 $this-&gt;<a class="code" href="classTCPDF.html#a4f11d769024fd07e1f663efd02d10517" title="Set position at a given column.">selectColumn</a>(0);
<a name="l05568"></a>05568             }
<a name="l05569"></a>05569             <span class="comment">// avoid page breaking from checkPageBreak()</span>
<a name="l05570"></a>05570             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l05571"></a>05571         }
<a name="l05572"></a>05572         <span class="keywordflow">return</span> $this-&gt;AutoPageBreak;
<a name="l05573"></a>05573     }
<a name="l05574"></a>05574 <span class="comment"></span>
<a name="l05575"></a>05575 <span class="comment">    /**</span>
<a name="l05576"></a>05576 <span class="comment">     * Add page if needed.</span>
<a name="l05577"></a>05577 <span class="comment">     * @param $h (float) Cell height. Default value: 0.</span>
<a name="l05578"></a>05578 <span class="comment">     * @param $y (mixed) starting y position, leave empty for current position.</span>
<a name="l05579"></a>05579 <span class="comment">     * @param $addpage (boolean) if true add a page, otherwise only return the true/false state</span>
<a name="l05580"></a>05580 <span class="comment">     * @return boolean true in case of page break, false otherwise.</span>
<a name="l05581"></a>05581 <span class="comment">     * @since 3.2.000 (2008-07-01)</span>
<a name="l05582"></a>05582 <span class="comment">     * @protected</span>
<a name="l05583"></a>05583 <span class="comment">     */</span>
<a name="l05584"></a><a class="code" href="classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">05584</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50" title="Add page if needed.">checkPageBreak</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>=0, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>=<span class="stringliteral">&#39;&#39;</span>, $addpage=<span class="keyword">true</span>) {
<a name="l05585"></a>05585         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>)) {
<a name="l05586"></a>05586             <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = $this-&gt;y;
<a name="l05587"></a>05587         }
<a name="l05588"></a>05588         $current_page = $this-&gt;page;
<a name="l05589"></a>05589         <span class="keywordflow">if</span> (((<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>) &gt; $this-&gt;PageBreakTrigger) AND ($this-&gt;<a class="code" href="classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c" title="Check if we are on the page body (excluding page header and footer).">inPageBody</a>()) AND ($this-&gt;<a class="code" href="classTCPDF.html#aa24046de2993933f62d60a2936a22970" title="Whenever a page break condition is met, the method is called, and the break is issued or not dependin...">AcceptPageBreak</a>())) {
<a name="l05590"></a>05590             <span class="keywordflow">if</span> ($addpage) {
<a name="l05591"></a>05591                 <span class="comment">//Automatic page break</span>
<a name="l05592"></a>05592                 <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = $this-&gt;x;
<a name="l05593"></a>05593                 $this-&gt;<a class="code" href="classTCPDF.html#a5171e20b366b74523709d84c349c1ced" title="Adds a new page to the document.">AddPage</a>($this-&gt;CurOrientation);
<a name="l05594"></a>05594                 $this-&gt;y = $this-&gt;tMargin;
<a name="l05595"></a>05595                 $oldpage = $this-&gt;page - 1;
<a name="l05596"></a>05596                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l05597"></a>05597                     <span class="keywordflow">if</span> ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;orm&#39;</span>]) {
<a name="l05598"></a>05598                         $this-&gt;x = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;orm&#39;</span>]);
<a name="l05599"></a>05599                     } <span class="keywordflow">else</span> {
<a name="l05600"></a>05600                         $this-&gt;x = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l05601"></a>05601                     }
<a name="l05602"></a>05602                 } <span class="keywordflow">else</span> {
<a name="l05603"></a>05603                     <span class="keywordflow">if</span> ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;olm&#39;</span>]) {
<a name="l05604"></a>05604                         $this-&gt;x = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;olm&#39;</span>]);
<a name="l05605"></a>05605                     } <span class="keywordflow">else</span> {
<a name="l05606"></a>05606                         $this-&gt;x = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l05607"></a>05607                     }
<a name="l05608"></a>05608                 }
<a name="l05609"></a>05609             }
<a name="l05610"></a>05610             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l05611"></a>05611         }
<a name="l05612"></a>05612         <span class="keywordflow">if</span> ($current_page != $this-&gt;page) {
<a name="l05613"></a>05613             <span class="comment">// account for columns mode</span>
<a name="l05614"></a>05614             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l05615"></a>05615         }
<a name="l05616"></a>05616         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l05617"></a>05617     }
<a name="l05618"></a>05618 <span class="comment"></span>
<a name="l05619"></a>05619 <span class="comment">    /**</span>
<a name="l05620"></a>05620 <span class="comment">     * Removes SHY characters from text.</span>
<a name="l05621"></a>05621 <span class="comment">     * Unicode Data:&lt;ul&gt;</span>
<a name="l05622"></a>05622 <span class="comment">     * &lt;li&gt;Name : SOFT HYPHEN, commonly abbreviated as SHY&lt;/li&gt;</span>
<a name="l05623"></a>05623 <span class="comment">     * &lt;li&gt;HTML Entity (decimal): &quot;&amp;amp;#173;&quot;&lt;/li&gt;</span>
<a name="l05624"></a>05624 <span class="comment">     * &lt;li&gt;HTML Entity (hex): &quot;&amp;amp;#xad;&quot;&lt;/li&gt;</span>
<a name="l05625"></a>05625 <span class="comment">     * &lt;li&gt;HTML Entity (named): &quot;&amp;amp;shy;&quot;&lt;/li&gt;</span>
<a name="l05626"></a>05626 <span class="comment">     * &lt;li&gt;How to type in Microsoft Windows: [Alt +00AD] or [Alt 0173]&lt;/li&gt;</span>
<a name="l05627"></a>05627 <span class="comment">     * &lt;li&gt;UTF-8 (hex): 0xC2 0xAD (c2ad)&lt;/li&gt;</span>
<a name="l05628"></a>05628 <span class="comment">     * &lt;li&gt;UTF-8 character: chr(194).chr(173)&lt;/li&gt;</span>
<a name="l05629"></a>05629 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l05630"></a>05630 <span class="comment">     * @param $txt (string) input string</span>
<a name="l05631"></a>05631 <span class="comment">     * @return string without SHY characters.</span>
<a name="l05632"></a>05632 <span class="comment">     * @public</span>
<a name="l05633"></a>05633 <span class="comment">     * @since (4.5.019) 2009-02-28</span>
<a name="l05634"></a>05634 <span class="comment">     */</span>
<a name="l05635"></a><a class="code" href="classTCPDF.html#aece420a79e6100810c95f5a767ecacb0">05635</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aece420a79e6100810c95f5a767ecacb0" title="Removes SHY characters from text.">removeSHY</a>($txt=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l05636"></a>05636         $txt = preg_replace(<span class="stringliteral">&#39;/([\\xc2]{1}[\\xad]{1})/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $txt);
<a name="l05637"></a>05637         <span class="keywordflow">if</span> (!$this-&gt;isunicode) {
<a name="l05638"></a>05638             $txt = preg_replace(<span class="stringliteral">&#39;/([\\xad]{1})/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $txt);
<a name="l05639"></a>05639         }
<a name="l05640"></a>05640         <span class="keywordflow">return</span> $txt;
<a name="l05641"></a>05641     }
<a name="l05642"></a>05642 <span class="comment"></span>
<a name="l05643"></a>05643 <span class="comment">    /**</span>
<a name="l05644"></a>05644 <span class="comment">     * Prints a cell (rectangular area) with optional borders, background color and character string. The upper-left corner of the cell corresponds to the current position. The text can be aligned or centered. After the call, the current position moves to the right or to the next line. It is possible to put a link on the text.&lt;br /&gt;</span>
<a name="l05645"></a>05645 <span class="comment">     * If automatic page breaking is enabled and the cell goes beyond the limit, a page break is done before outputting.</span>
<a name="l05646"></a>05646 <span class="comment">     * @param $w (float) Cell width. If 0, the cell extends up to the right margin.</span>
<a name="l05647"></a>05647 <span class="comment">     * @param $h (float) Cell height. Default value: 0.</span>
<a name="l05648"></a>05648 <span class="comment">     * @param $txt (string) String to print. Default value: empty string.</span>
<a name="l05649"></a>05649 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l05650"></a>05650 <span class="comment">     * @param $ln (int) Indicates where the current position should go after the call. Possible values are:&lt;ul&gt;&lt;li&gt;0: to the right (or left for RTL languages)&lt;/li&gt;&lt;li&gt;1: to the beginning of the next line&lt;/li&gt;&lt;li&gt;2: below&lt;/li&gt;&lt;/ul&gt; Putting 1 is equivalent to putting 0 and calling Ln() just after. Default value: 0.</span>
<a name="l05651"></a>05651 <span class="comment">     * @param $align (string) Allows to center or align the text. Possible values are:&lt;ul&gt;&lt;li&gt;L or empty string: left align (default value)&lt;/li&gt;&lt;li&gt;C: center&lt;/li&gt;&lt;li&gt;R: right align&lt;/li&gt;&lt;li&gt;J: justify&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l05652"></a>05652 <span class="comment">     * @param $fill (boolean) Indicates if the cell background must be painted (true) or transparent (false).</span>
<a name="l05653"></a>05653 <span class="comment">     * @param $link (mixed) URL or identifier returned by AddLink().</span>
<a name="l05654"></a>05654 <span class="comment">     * @param $stretch (int) font stretch mode: &lt;ul&gt;&lt;li&gt;0 = disabled&lt;/li&gt;&lt;li&gt;1 = horizontal scaling only if text is larger than cell width&lt;/li&gt;&lt;li&gt;2 = forced horizontal scaling to fit cell width&lt;/li&gt;&lt;li&gt;3 = character spacing only if text is larger than cell width&lt;/li&gt;&lt;li&gt;4 = forced character spacing to fit cell width&lt;/li&gt;&lt;/ul&gt; General font stretching and scaling values will be preserved when possible.</span>
<a name="l05655"></a>05655 <span class="comment">     * @param $ignore_min_height (boolean) if true ignore automatic minimum height value.</span>
<a name="l05656"></a>05656 <span class="comment">     * @param $calign (string) cell vertical alignment relative to the specified Y value. Possible values are:&lt;ul&gt;&lt;li&gt;T : cell top&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;B : cell bottom&lt;/li&gt;&lt;li&gt;A : font top&lt;/li&gt;&lt;li&gt;L : font baseline&lt;/li&gt;&lt;li&gt;D : font bottom&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l05657"></a>05657 <span class="comment">     * @param $valign (string) text vertical alignment inside the cell. Possible values are:&lt;ul&gt;&lt;li&gt;T : top&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;B : bottom&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l05658"></a>05658 <span class="comment">     * @public</span>
<a name="l05659"></a>05659 <span class="comment">     * @since 1.0</span>
<a name="l05660"></a>05660 <span class="comment">     * @see SetFont(), SetDrawColor(), SetFillColor(), SetTextColor(), SetLineWidth(), AddLink(), Ln(), MultiCell(), Write(), SetAutoPageBreak()</span>
<a name="l05661"></a>05661 <span class="comment">     */</span>
<a name="l05662"></a><a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">05662</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>=0, $txt=<span class="stringliteral">&#39;&#39;</span>, $border=0, $ln=0, $align=<span class="stringliteral">&#39;&#39;</span>, $fill=<span class="keyword">false</span>, $link=<span class="stringliteral">&#39;&#39;</span>, $stretch=0, $ignore_min_height=<span class="keyword">false</span>, $calign=<span class="charliteral">&#39;T&#39;</span>, $valign=<span class="charliteral">&#39;M&#39;</span>) {
<a name="l05663"></a>05663         $prev_cell_margin = $this-&gt;cell_margin;
<a name="l05664"></a>05664         $prev_cell_padding = $this-&gt;cell_padding;
<a name="l05665"></a>05665         $this-&gt;<a class="code" href="classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4" title="Adjust the internal Cell padding array to take account of the line width.">adjustCellPadding</a>($border);
<a name="l05666"></a>05666         <span class="keywordflow">if</span> (!$ignore_min_height) {
<a name="l05667"></a>05667             $min_cell_height = ($this-&gt;FontSize * $this-&gt;cell_height_ratio) + $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>];
<a name="l05668"></a>05668             <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> &lt; $min_cell_height) {
<a name="l05669"></a>05669                 <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $min_cell_height;
<a name="l05670"></a>05670             }
<a name="l05671"></a>05671         }
<a name="l05672"></a>05672         $this-&gt;<a class="code" href="classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50" title="Add page if needed.">checkPageBreak</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> + $this-&gt;cell_margin[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;cell_margin[<span class="charliteral">&#39;B&#39;</span>]);
<a name="l05673"></a>05673         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>($this-&gt;<a class="code" href="classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc" title="Returns the PDF string code to print a cell (rectangular area) with optional borders, background color and character string.">getCellCode</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $txt, $border, $ln, $align, $fill, $link, $stretch, <span class="keyword">true</span>, $calign, $valign));
<a name="l05674"></a>05674         $this-&gt;cell_padding = $prev_cell_padding;
<a name="l05675"></a>05675         $this-&gt;cell_margin = $prev_cell_margin;
<a name="l05676"></a>05676     }
<a name="l05677"></a>05677 <span class="comment"></span>
<a name="l05678"></a>05678 <span class="comment">    /**</span>
<a name="l05679"></a>05679 <span class="comment">     * Returns the PDF string code to print a cell (rectangular area) with optional borders, background color and character string. The upper-left corner of the cell corresponds to the current position. The text can be aligned or centered. After the call, the current position moves to the right or to the next line. It is possible to put a link on the text.&lt;br /&gt;</span>
<a name="l05680"></a>05680 <span class="comment">     * If automatic page breaking is enabled and the cell goes beyond the limit, a page break is done before outputting.</span>
<a name="l05681"></a>05681 <span class="comment">     * @param $w (float) Cell width. If 0, the cell extends up to the right margin.</span>
<a name="l05682"></a>05682 <span class="comment">     * @param $h (float) Cell height. Default value: 0.</span>
<a name="l05683"></a>05683 <span class="comment">     * @param $txt (string) String to print. Default value: empty string.</span>
<a name="l05684"></a>05684 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l05685"></a>05685 <span class="comment">     * @param $ln (int) Indicates where the current position should go after the call. Possible values are:&lt;ul&gt;&lt;li&gt;0: to the right (or left for RTL languages)&lt;/li&gt;&lt;li&gt;1: to the beginning of the next line&lt;/li&gt;&lt;li&gt;2: below&lt;/li&gt;&lt;/ul&gt;Putting 1 is equivalent to putting 0 and calling Ln() just after. Default value: 0.</span>
<a name="l05686"></a>05686 <span class="comment">     * @param $align (string) Allows to center or align the text. Possible values are:&lt;ul&gt;&lt;li&gt;L or empty string: left align (default value)&lt;/li&gt;&lt;li&gt;C: center&lt;/li&gt;&lt;li&gt;R: right align&lt;/li&gt;&lt;li&gt;J: justify&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l05687"></a>05687 <span class="comment">     * @param $fill (boolean) Indicates if the cell background must be painted (true) or transparent (false).</span>
<a name="l05688"></a>05688 <span class="comment">     * @param $link (mixed) URL or identifier returned by AddLink().</span>
<a name="l05689"></a>05689 <span class="comment">     * @param $stretch (int) font stretch mode: &lt;ul&gt;&lt;li&gt;0 = disabled&lt;/li&gt;&lt;li&gt;1 = horizontal scaling only if text is larger than cell width&lt;/li&gt;&lt;li&gt;2 = forced horizontal scaling to fit cell width&lt;/li&gt;&lt;li&gt;3 = character spacing only if text is larger than cell width&lt;/li&gt;&lt;li&gt;4 = forced character spacing to fit cell width&lt;/li&gt;&lt;/ul&gt; General font stretching and scaling values will be preserved when possible.</span>
<a name="l05690"></a>05690 <span class="comment">     * @param $ignore_min_height (boolean) if true ignore automatic minimum height value.</span>
<a name="l05691"></a>05691 <span class="comment">     * @param $calign (string) cell vertical alignment relative to the specified Y value. Possible values are:&lt;ul&gt;&lt;li&gt;T : cell top&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;B : cell bottom&lt;/li&gt;&lt;li&gt;A : font top&lt;/li&gt;&lt;li&gt;L : font baseline&lt;/li&gt;&lt;li&gt;D : font bottom&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l05692"></a>05692 <span class="comment">     * @param $valign (string) text vertical alignment inside the cell. Possible values are:&lt;ul&gt;&lt;li&gt;T : top&lt;/li&gt;&lt;li&gt;M : middle&lt;/li&gt;&lt;li&gt;B : bottom&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l05693"></a>05693 <span class="comment">     * @return string containing cell code</span>
<a name="l05694"></a>05694 <span class="comment">     * @protected</span>
<a name="l05695"></a>05695 <span class="comment">     * @since 1.0</span>
<a name="l05696"></a>05696 <span class="comment">     * @see Cell()</span>
<a name="l05697"></a>05697 <span class="comment">     */</span>
<a name="l05698"></a><a class="code" href="classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">05698</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc" title="Returns the PDF string code to print a cell (rectangular area) with optional borders, background color and character string.">getCellCode</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>=0, $txt=<span class="stringliteral">&#39;&#39;</span>, $border=0, $ln=0, $align=<span class="stringliteral">&#39;&#39;</span>, $fill=<span class="keyword">false</span>, $link=<span class="stringliteral">&#39;&#39;</span>, $stretch=0, $ignore_min_height=<span class="keyword">false</span>, $calign=<span class="charliteral">&#39;T&#39;</span>, $valign=<span class="charliteral">&#39;M&#39;</span>) {
<a name="l05699"></a>05699         <span class="comment">// replace &#39;NO-BREAK SPACE&#39; (U+00A0) character with a simple space</span>
<a name="l05700"></a>05700         $txt = str_replace($this-&gt;<a class="code" href="classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b" title="Returns the unicode caracter specified by UTF-8 value.">unichr</a>(160), <span class="charliteral">&#39; &#39;</span>, $txt);
<a name="l05701"></a>05701         $prev_cell_margin = $this-&gt;cell_margin;
<a name="l05702"></a>05702         $prev_cell_padding = $this-&gt;cell_padding;
<a name="l05703"></a>05703         $txt = $this-&gt;<a class="code" href="classTCPDF.html#aece420a79e6100810c95f5a767ecacb0" title="Removes SHY characters from text.">removeSHY</a>($txt);
<a name="l05704"></a>05704         $rs = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">//string to be returned</span>
<a name="l05705"></a>05705         $this-&gt;<a class="code" href="classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4" title="Adjust the internal Cell padding array to take account of the line width.">adjustCellPadding</a>($border);
<a name="l05706"></a>05706         <span class="keywordflow">if</span> (!$ignore_min_height) {
<a name="l05707"></a>05707             $min_cell_height = ($this-&gt;FontSize * $this-&gt;cell_height_ratio) + $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>];
<a name="l05708"></a>05708             <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> &lt; $min_cell_height) {
<a name="l05709"></a>05709                 <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $min_cell_height;
<a name="l05710"></a>05710             }
<a name="l05711"></a>05711         }
<a name="l05712"></a>05712         <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = $this-&gt;k;
<a name="l05713"></a>05713         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l05714"></a>05714         list($this-&gt;x, $this-&gt;y) = $this-&gt;<a class="code" href="classTCPDF.html#a1d99e81697a90efb13a6734001427f40" title="Check page for no-write regions and adapt current coordinates and page margins if necessary...">checkPageRegions</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $this-&gt;x, $this-&gt;y);
<a name="l05715"></a>05715         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l05716"></a>05716             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = $this-&gt;x - $this-&gt;cell_margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l05717"></a>05717         } <span class="keywordflow">else</span> {
<a name="l05718"></a>05718             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = $this-&gt;x + $this-&gt;cell_margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l05719"></a>05719         }
<a name="l05720"></a>05720         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = $this-&gt;y + $this-&gt;cell_margin[<span class="charliteral">&#39;T&#39;</span>];
<a name="l05721"></a>05721         $prev_font_stretching = $this-&gt;font_stretching;
<a name="l05722"></a>05722         $prev_font_spacing = $this-&gt;font_spacing;
<a name="l05723"></a>05723         <span class="comment">// cell vertical alignment</span>
<a name="l05724"></a>05724         <span class="keywordflow">switch</span> ($calign) {
<a name="l05725"></a>05725             <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: {
<a name="l05726"></a>05726                 <span class="comment">// font top</span>
<a name="l05727"></a>05727                 <span class="keywordflow">switch</span> ($valign) {
<a name="l05728"></a>05728                     <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {
<a name="l05729"></a>05729                         <span class="comment">// top</span>
<a name="l05730"></a>05730                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>];
<a name="l05731"></a>05731                         <span class="keywordflow">break</span>;
<a name="l05732"></a>05732                     }
<a name="l05733"></a>05733                     <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l05734"></a>05734                         <span class="comment">// bottom</span>
<a name="l05735"></a>05735                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] - $this-&gt;FontAscent - $this-&gt;FontDescent);
<a name="l05736"></a>05736                         <span class="keywordflow">break</span>;
<a name="l05737"></a>05737                     }
<a name="l05738"></a>05738                     <span class="keywordflow">default</span>:
<a name="l05739"></a>05739                     <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
<a name="l05740"></a>05740                     <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {
<a name="l05741"></a>05741                         <span class="comment">// center</span>
<a name="l05742"></a>05742                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= ((<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> - $this-&gt;FontAscent - $this-&gt;FontDescent) / 2);
<a name="l05743"></a>05743                         <span class="keywordflow">break</span>;
<a name="l05744"></a>05744                     }
<a name="l05745"></a>05745                 }
<a name="l05746"></a>05746                 <span class="keywordflow">break</span>;
<a name="l05747"></a>05747             }
<a name="l05748"></a>05748             <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {
<a name="l05749"></a>05749                 <span class="comment">// font baseline</span>
<a name="l05750"></a>05750                 <span class="keywordflow">switch</span> ($valign) {
<a name="l05751"></a>05751                     <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {
<a name="l05752"></a>05752                         <span class="comment">// top</span>
<a name="l05753"></a>05753                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;FontAscent);
<a name="l05754"></a>05754                         <span class="keywordflow">break</span>;
<a name="l05755"></a>05755                     }
<a name="l05756"></a>05756                     <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l05757"></a>05757                         <span class="comment">// bottom</span>
<a name="l05758"></a>05758                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] - $this-&gt;FontDescent);
<a name="l05759"></a>05759                         <span class="keywordflow">break</span>;
<a name="l05760"></a>05760                     }
<a name="l05761"></a>05761                     <span class="keywordflow">default</span>:
<a name="l05762"></a>05762                     <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
<a name="l05763"></a>05763                     <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {
<a name="l05764"></a>05764                         <span class="comment">// center</span>
<a name="l05765"></a>05765                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= ((<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> + $this-&gt;FontAscent - $this-&gt;FontDescent) / 2);
<a name="l05766"></a>05766                         <span class="keywordflow">break</span>;
<a name="l05767"></a>05767                     }
<a name="l05768"></a>05768                 }
<a name="l05769"></a>05769                 <span class="keywordflow">break</span>;
<a name="l05770"></a>05770             }
<a name="l05771"></a>05771             <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>: {
<a name="l05772"></a>05772                 <span class="comment">// font bottom</span>
<a name="l05773"></a>05773                 <span class="keywordflow">switch</span> ($valign) {
<a name="l05774"></a>05774                     <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {
<a name="l05775"></a>05775                         <span class="comment">// top</span>
<a name="l05776"></a>05776                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;FontAscent + $this-&gt;FontDescent);
<a name="l05777"></a>05777                         <span class="keywordflow">break</span>;
<a name="l05778"></a>05778                     }
<a name="l05779"></a>05779                     <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l05780"></a>05780                         <span class="comment">// bottom</span>
<a name="l05781"></a>05781                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>]);
<a name="l05782"></a>05782                         <span class="keywordflow">break</span>;
<a name="l05783"></a>05783                     }
<a name="l05784"></a>05784                     <span class="keywordflow">default</span>:
<a name="l05785"></a>05785                     <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
<a name="l05786"></a>05786                     <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {
<a name="l05787"></a>05787                         <span class="comment">// center</span>
<a name="l05788"></a>05788                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= ((<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> + $this-&gt;FontAscent + $this-&gt;FontDescent) / 2);
<a name="l05789"></a>05789                         <span class="keywordflow">break</span>;
<a name="l05790"></a>05790                     }
<a name="l05791"></a>05791                 }
<a name="l05792"></a>05792                 <span class="keywordflow">break</span>;
<a name="l05793"></a>05793             }
<a name="l05794"></a>05794             <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l05795"></a>05795                 <span class="comment">// cell bottom</span>
<a name="l05796"></a>05796                 <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l05797"></a>05797                 <span class="keywordflow">break</span>;
<a name="l05798"></a>05798             }
<a name="l05799"></a>05799             <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
<a name="l05800"></a>05800             <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {
<a name="l05801"></a>05801                 <span class="comment">// cell center</span>
<a name="l05802"></a>05802                 <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> -= (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> / 2);
<a name="l05803"></a>05803                 <span class="keywordflow">break</span>;
<a name="l05804"></a>05804             }
<a name="l05805"></a>05805             <span class="keywordflow">default</span>:
<a name="l05806"></a>05806             <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {
<a name="l05807"></a>05807                 <span class="comment">// cell top</span>
<a name="l05808"></a>05808                 <span class="keywordflow">break</span>;
<a name="l05809"></a>05809             }
<a name="l05810"></a>05810         }
<a name="l05811"></a>05811         <span class="comment">// text vertical alignment</span>
<a name="l05812"></a>05812         <span class="keywordflow">switch</span> ($valign) {
<a name="l05813"></a>05813             <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {
<a name="l05814"></a>05814                 <span class="comment">// top</span>
<a name="l05815"></a>05815                 $yt = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>];
<a name="l05816"></a>05816                 <span class="keywordflow">break</span>;
<a name="l05817"></a>05817             }
<a name="l05818"></a>05818             <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l05819"></a>05819                 <span class="comment">// bottom</span>
<a name="l05820"></a>05820                 $yt = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] - $this-&gt;FontAscent - $this-&gt;FontDescent;
<a name="l05821"></a>05821                 <span class="keywordflow">break</span>;
<a name="l05822"></a>05822             }
<a name="l05823"></a>05823             <span class="keywordflow">default</span>:
<a name="l05824"></a>05824             <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
<a name="l05825"></a>05825             <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {
<a name="l05826"></a>05826                 <span class="comment">// center</span>
<a name="l05827"></a>05827                 $yt = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + ((<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> - $this-&gt;FontAscent - $this-&gt;FontDescent) / 2);
<a name="l05828"></a>05828                 <span class="keywordflow">break</span>;
<a name="l05829"></a>05829             }
<a name="l05830"></a>05830         }
<a name="l05831"></a>05831         $basefonty = $yt + $this-&gt;FontAscent;
<a name="l05832"></a>05832         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) OR (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> &lt;= 0)) {
<a name="l05833"></a>05833             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l05834"></a>05834                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - $this-&gt;lMargin;
<a name="l05835"></a>05835             } <span class="keywordflow">else</span> {
<a name="l05836"></a>05836                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l05837"></a>05837             }
<a name="l05838"></a>05838         }
<a name="l05839"></a>05839         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l05840"></a>05840         <span class="comment">// fill and borders</span>
<a name="l05841"></a>05841         <span class="keywordflow">if</span> (is_string($border) AND (strlen($border) == 4)) {
<a name="l05842"></a>05842             <span class="comment">// full border</span>
<a name="l05843"></a>05843             $border = 1;
<a name="l05844"></a>05844         }
<a name="l05845"></a>05845         <span class="keywordflow">if</span> ($fill OR ($border == 1)) {
<a name="l05846"></a>05846             <span class="keywordflow">if</span> ($fill) {
<a name="l05847"></a>05847                 $op = ($border == 1) ? <span class="charliteral">&#39;B&#39;</span> : <span class="charliteral">&#39;f&#39;</span>;
<a name="l05848"></a>05848             } <span class="keywordflow">else</span> {
<a name="l05849"></a>05849                 $op = <span class="charliteral">&#39;S&#39;</span>;
<a name="l05850"></a>05850             }
<a name="l05851"></a>05851             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l05852"></a>05852                 $xk = ((<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l05853"></a>05853             } <span class="keywordflow">else</span> {
<a name="l05854"></a>05854                 $xk = (<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l05855"></a>05855             }
<a name="l05856"></a>05856             <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F re %s &#39;</span>, $xk, (($this-&gt;h - <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>) * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>), (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> * $k), (-<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> * $k), $op);
<a name="l05857"></a>05857         }
<a name="l05858"></a>05858         <span class="comment">// draw borders</span>
<a name="l05859"></a>05859         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= $this-&gt;<a class="code" href="classTCPDF.html#a128e3d25eed996dbd78dd10be6f0c4c4" title="Returns the code to draw the cell border.">getCellBorder</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $border);
<a name="l05860"></a>05860         <span class="keywordflow">if</span> ($txt != <span class="stringliteral">&#39;&#39;</span>) {
<a name="l05861"></a>05861             $txt2 = $txt;
<a name="l05862"></a>05862             <span class="keywordflow">if</span> ($this-&gt;isunicode) {
<a name="l05863"></a>05863                 <span class="keywordflow">if</span> (($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;core&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;TrueType&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;Type1&#39;</span>)) {
<a name="l05864"></a>05864                     $txt2 = $this-&gt;<a class="code" href="classTCPDF.html#a60c04a399d19927e7a3ee249694aaa62" title="Converts UTF-8 strings to Latin1 when using the standard 14 core fonts.">UTF8ToLatin1</a>($txt2);
<a name="l05865"></a>05865                 } <span class="keywordflow">else</span> {
<a name="l05866"></a>05866                     <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a> = $this-&gt;<a class="code" href="classTCPDF.html#a35a90a2cd5b8ab143d978128a21de09e" title="Converts UTF-8 strings to codepoints array.">UTF8StringToArray</a>($txt); <span class="comment">// array of UTF-8 unicode values</span>
<a name="l05867"></a>05867                     <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a> = $this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>(<a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>, <span class="stringliteral">&#39;&#39;</span>, $this-&gt;tmprtl);
<a name="l05868"></a>05868                     <span class="keywordflow">if</span> (defined(<span class="stringliteral">&#39;K_THAI_TOPCHARS&#39;</span>) AND (K_THAI_TOPCHARS == <span class="keyword">true</span>)) {
<a name="l05869"></a>05869                         <span class="comment">// ---- Fix for bug #2977340 &quot;Incorrect Thai characters position arrangement&quot; ----</span>
<a name="l05870"></a>05870                         <span class="comment">// NOTE: this doesn&#39;t work with HTML justification</span>
<a name="l05871"></a>05871                         <span class="comment">// Symbols that could overlap on the font top (only works in LTR)</span>
<a name="l05872"></a>05872                         $topchar = array(3611, 3613, 3615, 3650, 3651, 3652); <span class="comment">// chars that extends on top</span>
<a name="l05873"></a>05873                         $topsym = array(3633, 3636, 3637, 3638, 3639, 3655, 3656, 3657, 3658, 3659, 3660, 3661, 3662); <span class="comment">// symbols with top position</span>
<a name="l05874"></a>05874                         $numchars = count(<a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>); <span class="comment">// number of chars</span>
<a name="l05875"></a>05875                         $unik = 0;
<a name="l05876"></a>05876                         $uniblock = array();
<a name="l05877"></a>05877                         $uniblock[$unik] = array();
<a name="l05878"></a>05878                         $uniblock[$unik][] = <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>[0];
<a name="l05879"></a>05879                         <span class="comment">// resolve overlapping conflicts by splitting the string in several parts</span>
<a name="l05880"></a>05880                         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l05881"></a>05881                             <span class="comment">// check if symbols overlaps at top</span>
<a name="l05882"></a>05882                             <span class="keywordflow">if</span> (in_array(<a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>], $topsym) AND (in_array(<a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>[($i - 1)], $topsym) OR in_array(<a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>[($i - 1)], $topchar))) {
<a name="l05883"></a>05883                                 <span class="comment">// move symbols to another array</span>
<a name="l05884"></a>05884                                 ++$unik;
<a name="l05885"></a>05885                                 $uniblock[$unik] = array();
<a name="l05886"></a>05886                                 $uniblock[$unik][] = <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l05887"></a>05887                                 ++$unik;
<a name="l05888"></a>05888                                 $uniblock[$unik] = array();
<a name="l05889"></a>05889                                 <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = 0x200b; <span class="comment">// Unicode Character &#39;ZERO WIDTH SPACE&#39; (DEC:8203, U+200B)</span>
<a name="l05890"></a>05890                             } <span class="keywordflow">else</span> {
<a name="l05891"></a>05891                                 $uniblock[$unik][] = <a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l05892"></a>05892                             }
<a name="l05893"></a>05893                         }
<a name="l05894"></a>05894                         <span class="comment">// ---- END OF Fix for bug #2977340</span>
<a name="l05895"></a>05895                     }
<a name="l05896"></a>05896                     $txt2 = $this-&gt;<a class="code" href="classTCPDF.html#a8b9c15b8e72db768753c5dc1a96bb2ce" title="Converts array of UTF-8 characters to UTF16-BE string.">arrUTF8ToUTF16BE</a>(<a class="code" href="classTCPDF.html#a5cd0c3e4c0cd7cfeaacfe76d9b4ee587" title="Object containing unicode data.">$unicode</a>, <span class="keyword">false</span>);
<a name="l05897"></a>05897                 }
<a name="l05898"></a>05898             }
<a name="l05899"></a>05899             $txt2 = $this-&gt;<a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf" title="Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;.">_escape</a>($txt2);
<a name="l05900"></a>05900             <span class="comment">// get current text width (considering general font stretching and spacing)</span>
<a name="l05901"></a>05901             $txwidth = $this-&gt;<a class="code" href="classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9" title="Returns the length of a string in user unit.">GetStringWidth</a>($txt);
<a name="l05902"></a>05902             $width = $txwidth;
<a name="l05903"></a>05903             <span class="comment">// check for stretch mode</span>
<a name="l05904"></a>05904             <span class="keywordflow">if</span> ($stretch &gt; 0) {
<a name="l05905"></a>05905                 <span class="comment">// calculate ratio between cell width and text width</span>
<a name="l05906"></a>05906                 <span class="keywordflow">if</span> ($width &lt;= 0) {
<a name="l05907"></a>05907                     $ratio = 1;
<a name="l05908"></a>05908                 } <span class="keywordflow">else</span> {
<a name="l05909"></a>05909                     $ratio = ((<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]) / $width);
<a name="l05910"></a>05910                 }
<a name="l05911"></a>05911                 <span class="comment">// check if stretching is required</span>
<a name="l05912"></a>05912                 <span class="keywordflow">if</span> (($ratio &lt; 1) OR (($ratio &gt; 1) AND (($stretch % 2) == 0))) {
<a name="l05913"></a>05913                     <span class="comment">// the text will be stretched to fit cell width</span>
<a name="l05914"></a>05914                     <span class="keywordflow">if</span> ($stretch &gt; 2) {
<a name="l05915"></a>05915                         <span class="comment">// set new character spacing</span>
<a name="l05916"></a>05916                         $this-&gt;font_spacing += (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] - $width) / (max(($this-&gt;<a class="code" href="classTCPDF.html#ac9dc6318fd217971aff282532ab91e43" title="Returns the numbero of characters in a string.">GetNumChars</a>($txt) - 1), 1) * ($this-&gt;font_stretching / 100));
<a name="l05917"></a>05917                     } <span class="keywordflow">else</span> {
<a name="l05918"></a>05918                         <span class="comment">// set new horizontal stretching</span>
<a name="l05919"></a>05919                         $this-&gt;font_stretching *= $ratio;
<a name="l05920"></a>05920                     }
<a name="l05921"></a>05921                     <span class="comment">// recalculate text width (the text fills the entire cell)</span>
<a name="l05922"></a>05922                     $width = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l05923"></a>05923                     <span class="comment">// reset alignment</span>
<a name="l05924"></a>05924                     $align = <span class="stringliteral">&#39;&#39;</span>;
<a name="l05925"></a>05925                 }
<a name="l05926"></a>05926             }
<a name="l05927"></a>05927             <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {
<a name="l05928"></a>05928                 <span class="comment">// apply font stretching</span>
<a name="l05929"></a>05929                 $rs .= sprintf(<span class="stringliteral">&#39;BT %.2F Tz ET &#39;</span>, $this-&gt;font_stretching);
<a name="l05930"></a>05930             }
<a name="l05931"></a>05931             <span class="keywordflow">if</span> ($this-&gt;font_spacing != 0) {
<a name="l05932"></a>05932                 <span class="comment">// increase/decrease font spacing</span>
<a name="l05933"></a>05933                 $rs .= sprintf(<span class="stringliteral">&#39;BT %.2F Tc ET &#39;</span>, ($this-&gt;font_spacing * $this-&gt;k));
<a name="l05934"></a>05934             }
<a name="l05935"></a>05935             <span class="keywordflow">if</span> ($this-&gt;ColorFlag AND ($this-&gt;textrendermode &lt; 4)) {
<a name="l05936"></a>05936                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;q &#39;</span>.$this-&gt;TextColor.<span class="charliteral">&#39; &#39;</span>;
<a name="l05937"></a>05937             }
<a name="l05938"></a>05938             <span class="comment">// rendering mode</span>
<a name="l05939"></a>05939             <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;BT %d Tr %.2F w ET &#39;</span>, $this-&gt;textrendermode, $this-&gt;textstrokewidth);
<a name="l05940"></a>05940             <span class="comment">// count number of spaces</span>
<a name="l05941"></a>05941             $ns = substr_count($txt, chr(32));
<a name="l05942"></a>05942             <span class="comment">// Justification</span>
<a name="l05943"></a>05943             $spacewidth = 0;
<a name="l05944"></a>05944             <span class="keywordflow">if</span> (($align == <span class="charliteral">&#39;J&#39;</span>) AND ($ns &gt; 0)) {
<a name="l05945"></a>05945                 <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97" title="Return true if the current font is unicode type.">isUnicodeFont</a>()) {
<a name="l05946"></a>05946                     <span class="comment">// get string width without spaces</span>
<a name="l05947"></a>05947                     $width = $this-&gt;<a class="code" href="classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9" title="Returns the length of a string in user unit.">GetStringWidth</a>(str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $txt));
<a name="l05948"></a>05948                     <span class="comment">// calculate average space width</span>
<a name="l05949"></a>05949                     $spacewidth = -1000 * (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $width - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]) / ($ns?$ns:1) / $this-&gt;FontSize;
<a name="l05950"></a>05950                     <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {
<a name="l05951"></a>05951                         <span class="comment">// word spacing is affected by stretching</span>
<a name="l05952"></a>05952                         $spacewidth /= ($this-&gt;font_stretching / 100);
<a name="l05953"></a>05953                     }
<a name="l05954"></a>05954                     <span class="comment">// set word position to be used with TJ operator</span>
<a name="l05955"></a>05955                     $txt2 = str_replace(chr(0).chr(32), <span class="stringliteral">&#39;) &#39;</span>.sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, $spacewidth).<span class="stringliteral">&#39; (&#39;</span>, $txt2);
<a name="l05956"></a>05956                     $unicode_justification = <span class="keyword">true</span>;
<a name="l05957"></a>05957                 } <span class="keywordflow">else</span> {
<a name="l05958"></a>05958                     <span class="comment">// get string width</span>
<a name="l05959"></a>05959                     $width = $txwidth;
<a name="l05960"></a>05960                     <span class="comment">// new space width</span>
<a name="l05961"></a>05961                     $spacewidth = ((<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $width - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]) / ($ns?$ns:1)) * $this-&gt;k;
<a name="l05962"></a>05962                     <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {
<a name="l05963"></a>05963                         <span class="comment">// word spacing (Tw) is affected by stretching</span>
<a name="l05964"></a>05964                         $spacewidth /= ($this-&gt;font_stretching / 100);
<a name="l05965"></a>05965                     }
<a name="l05966"></a>05966                     <span class="comment">// set word spacing</span>
<a name="l05967"></a>05967                     $rs .= sprintf(<span class="stringliteral">&#39;BT %.3F Tw ET &#39;</span>, $spacewidth);
<a name="l05968"></a>05968                 }
<a name="l05969"></a>05969                 $width = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l05970"></a>05970             }
<a name="l05971"></a>05971             <span class="comment">// replace carriage return characters</span>
<a name="l05972"></a>05972             $txt2 = str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="charliteral">&#39; &#39;</span>, $txt2);
<a name="l05973"></a>05973             <span class="keywordflow">switch</span> ($align) {
<a name="l05974"></a>05974                 <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {
<a name="l05975"></a>05975                     $dx = (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $width) / 2;
<a name="l05976"></a>05976                     <span class="keywordflow">break</span>;
<a name="l05977"></a>05977                 }
<a name="l05978"></a>05978                 <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {
<a name="l05979"></a>05979                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l05980"></a>05980                         $dx = $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l05981"></a>05981                     } <span class="keywordflow">else</span> {
<a name="l05982"></a>05982                         $dx = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $width - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l05983"></a>05983                     }
<a name="l05984"></a>05984                     <span class="keywordflow">break</span>;
<a name="l05985"></a>05985                 }
<a name="l05986"></a>05986                 <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {
<a name="l05987"></a>05987                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l05988"></a>05988                         $dx = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $width - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];
<a name="l05989"></a>05989                     } <span class="keywordflow">else</span> {
<a name="l05990"></a>05990                         $dx = $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];
<a name="l05991"></a>05991                     }
<a name="l05992"></a>05992                     <span class="keywordflow">break</span>;
<a name="l05993"></a>05993                 }
<a name="l05994"></a>05994                 <span class="keywordflow">case</span> <span class="charliteral">&#39;J&#39;</span>:
<a name="l05995"></a>05995                 <span class="keywordflow">default</span>: {
<a name="l05996"></a>05996                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l05997"></a>05997                         $dx = $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l05998"></a>05998                     } <span class="keywordflow">else</span> {
<a name="l05999"></a>05999                         $dx = $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06000"></a>06000                     }
<a name="l06001"></a>06001                     <span class="keywordflow">break</span>;
<a name="l06002"></a>06002                 }
<a name="l06003"></a>06003             }
<a name="l06004"></a>06004             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06005"></a>06005                 $xdx = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - $dx - $width;
<a name="l06006"></a>06006             } <span class="keywordflow">else</span> {
<a name="l06007"></a>06007                 $xdx = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + $dx;
<a name="l06008"></a>06008             }
<a name="l06009"></a>06009             $xdk = $xdx * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>;
<a name="l06010"></a>06010             <span class="comment">// print text</span>
<a name="l06011"></a>06011             <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;BT %.2F %.2F Td [(%s)] TJ ET&#39;</span>, $xdk, (($this-&gt;h - $basefonty) * $k), $txt2);
<a name="l06012"></a>06012             <span class="keywordflow">if</span> (isset($uniblock)) {
<a name="l06013"></a>06013                 <span class="comment">// print overlapping characters as separate string</span>
<a name="l06014"></a>06014                 $xshift = 0; <span class="comment">// horizontal shift</span>
<a name="l06015"></a>06015                 $ty = (($this-&gt;h - $basefonty + (0.2 * $this-&gt;FontSize)) * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l06016"></a>06016                 $spw = ((<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $txwidth - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]) / ($ns?$ns:1));
<a name="l06017"></a>06017                 <span class="keywordflow">foreach</span> ($uniblock as $uk =&gt; $uniarr) {
<a name="l06018"></a>06018                     <span class="keywordflow">if</span> (($uk % 2) == 0) {
<a name="l06019"></a>06019                         <span class="comment">// x space to skip</span>
<a name="l06020"></a>06020                         <span class="keywordflow">if</span> ($spacewidth != 0) {
<a name="l06021"></a>06021                             <span class="comment">// justification shift</span>
<a name="l06022"></a>06022                             $xshift += (count(array_keys($uniarr, 32)) * $spw);
<a name="l06023"></a>06023                         }
<a name="l06024"></a>06024                         $xshift += $this-&gt;<a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($uniarr); <span class="comment">// + shift justification</span>
<a name="l06025"></a>06025                     } <span class="keywordflow">else</span> {
<a name="l06026"></a>06026                         <span class="comment">// character to print</span>
<a name="l06027"></a>06027                         $topchr = $this-&gt;<a class="code" href="classTCPDF.html#a8b9c15b8e72db768753c5dc1a96bb2ce" title="Converts array of UTF-8 characters to UTF16-BE string.">arrUTF8ToUTF16BE</a>($uniarr, <span class="keyword">false</span>);
<a name="l06028"></a>06028                         $topchr = $this-&gt;<a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf" title="Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;.">_escape</a>($topchr);
<a name="l06029"></a>06029                         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39; BT %.2F %.2F Td [(%s)] TJ ET&#39;</span>, ($xdk + ($xshift * $k)), $ty, $topchr);
<a name="l06030"></a>06030                     }
<a name="l06031"></a>06031                 }
<a name="l06032"></a>06032             }
<a name="l06033"></a>06033             <span class="keywordflow">if</span> ($this-&gt;underline) {
<a name="l06034"></a>06034                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_dounderlinew($xdx, $basefonty, $width);
<a name="l06035"></a>06035             }
<a name="l06036"></a>06036             <span class="keywordflow">if</span> ($this-&gt;linethrough) {
<a name="l06037"></a>06037                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_dolinethroughw($xdx, $basefonty, $width);
<a name="l06038"></a>06038             }
<a name="l06039"></a>06039             <span class="keywordflow">if</span> ($this-&gt;overline) {
<a name="l06040"></a>06040                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_dooverlinew($xdx, $basefonty, $width);
<a name="l06041"></a>06041             }
<a name="l06042"></a>06042             <span class="keywordflow">if</span> ($this-&gt;ColorFlag AND ($this-&gt;textrendermode &lt; 4)) {
<a name="l06043"></a>06043                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39; Q&#39;</span>;
<a name="l06044"></a>06044             }
<a name="l06045"></a>06045             <span class="keywordflow">if</span> ($link) {
<a name="l06046"></a>06046                 $this-&gt;<a class="code" href="classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994" title="Puts a link on a rectangular area of the page.">Link</a>($xdx, $yt, $width, ($this-&gt;FontAscent + $this-&gt;FontDescent), $link, $ns);
<a name="l06047"></a>06047             }
<a name="l06048"></a>06048         }
<a name="l06049"></a>06049         <span class="comment">// output cell</span>
<a name="l06050"></a>06050         <span class="keywordflow">if</span> (<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>) {
<a name="l06051"></a>06051             <span class="comment">// output cell</span>
<a name="l06052"></a>06052             $rs .= <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>;
<a name="l06053"></a>06053             <span class="keywordflow">if</span> ($this-&gt;font_spacing != 0) {
<a name="l06054"></a>06054                 <span class="comment">// reset font spacing mode</span>
<a name="l06055"></a>06055                 $rs .= <span class="stringliteral">&#39; BT 0 Tc ET&#39;</span>;
<a name="l06056"></a>06056             }
<a name="l06057"></a>06057             <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {
<a name="l06058"></a>06058                 <span class="comment">// reset font stretching mode</span>
<a name="l06059"></a>06059                 $rs .= <span class="stringliteral">&#39; BT 100 Tz ET&#39;</span>;
<a name="l06060"></a>06060             }
<a name="l06061"></a>06061         }
<a name="l06062"></a>06062         <span class="comment">// reset word spacing</span>
<a name="l06063"></a>06063         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97" title="Return true if the current font is unicode type.">isUnicodeFont</a>() AND ($align == <span class="charliteral">&#39;J&#39;</span>)) {
<a name="l06064"></a>06064             $rs .= <span class="stringliteral">&#39; BT 0 Tw ET&#39;</span>;
<a name="l06065"></a>06065         }
<a name="l06066"></a>06066         <span class="comment">// reset stretching and spacing</span>
<a name="l06067"></a>06067         $this-&gt;font_stretching = $prev_font_stretching;
<a name="l06068"></a>06068         $this-&gt;font_spacing = $prev_font_spacing;
<a name="l06069"></a>06069         $this-&gt;lasth = <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l06070"></a>06070         <span class="keywordflow">if</span> ($ln &gt; 0) {
<a name="l06071"></a>06071             <span class="comment">//Go to the beginning of the next line</span>
<a name="l06072"></a>06072             $this-&gt;y = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> + $this-&gt;cell_margin[<span class="charliteral">&#39;B&#39;</span>];
<a name="l06073"></a>06073             <span class="keywordflow">if</span> ($ln == 1) {
<a name="l06074"></a>06074                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06075"></a>06075                     $this-&gt;x = $this-&gt;w - $this-&gt;rMargin;
<a name="l06076"></a>06076                 } <span class="keywordflow">else</span> {
<a name="l06077"></a>06077                     $this-&gt;x = $this-&gt;lMargin;
<a name="l06078"></a>06078                 }
<a name="l06079"></a>06079             }
<a name="l06080"></a>06080         } <span class="keywordflow">else</span> {
<a name="l06081"></a>06081             <span class="comment">// go left or right by case</span>
<a name="l06082"></a>06082             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06083"></a>06083                 $this-&gt;x = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $this-&gt;cell_margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06084"></a>06084             } <span class="keywordflow">else</span> {
<a name="l06085"></a>06085                 $this-&gt;x = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> + $this-&gt;cell_margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06086"></a>06086             }
<a name="l06087"></a>06087         }
<a name="l06088"></a>06088         $gstyles = <span class="stringliteral">&#39;&#39;</span>.$this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor.<span class="charliteral">&#39; &#39;</span>.$this-&gt;FillColor.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l06089"></a>06089         $rs = $gstyles.$rs;
<a name="l06090"></a>06090         $this-&gt;cell_padding = $prev_cell_padding;
<a name="l06091"></a>06091         $this-&gt;cell_margin = $prev_cell_margin;
<a name="l06092"></a>06092         <span class="keywordflow">return</span> $rs;
<a name="l06093"></a>06093     }
<a name="l06094"></a>06094 <span class="comment"></span>
<a name="l06095"></a>06095 <span class="comment">    /**</span>
<a name="l06096"></a>06096 <span class="comment">     * Returns the code to draw the cell border</span>
<a name="l06097"></a>06097 <span class="comment">     * @param $x (float) X coordinate.</span>
<a name="l06098"></a>06098 <span class="comment">     * @param $y (float) Y coordinate.</span>
<a name="l06099"></a>06099 <span class="comment">     * @param $w (float) Cell width.</span>
<a name="l06100"></a>06100 <span class="comment">     * @param $h (float) Cell height.</span>
<a name="l06101"></a>06101 <span class="comment">     * @param $brd (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l06102"></a>06102 <span class="comment">     * @return string containing cell border code</span>
<a name="l06103"></a>06103 <span class="comment">     * @protected</span>
<a name="l06104"></a>06104 <span class="comment">     * @see SetLineStyle()</span>
<a name="l06105"></a>06105 <span class="comment">     * @since 5.7.000 (2010-08-02)</span>
<a name="l06106"></a>06106 <span class="comment">     */</span>
<a name="l06107"></a><a class="code" href="classTCPDF.html#a128e3d25eed996dbd78dd10be6f0c4c4">06107</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a128e3d25eed996dbd78dd10be6f0c4c4" title="Returns the code to draw the cell border.">getCellBorder</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $brd) {
<a name="l06108"></a>06108         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// string to be returned</span>
<a name="l06109"></a>06109         <span class="keywordflow">if</span> (empty($brd)) {
<a name="l06110"></a>06110             <span class="keywordflow">return</span> <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>;
<a name="l06111"></a>06111         }
<a name="l06112"></a>06112         <span class="keywordflow">if</span> ($brd == 1) {
<a name="l06113"></a>06113             $brd = array(<span class="stringliteral">&#39;LRTB&#39;</span> =&gt; <span class="keyword">true</span>);
<a name="l06114"></a>06114         }
<a name="l06115"></a>06115         <span class="comment">// calculate coordinates for border</span>
<a name="l06116"></a>06116         <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = $this-&gt;k;
<a name="l06117"></a>06117         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06118"></a>06118             $xeL = (<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>;
<a name="l06119"></a>06119             $xeR = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>;
<a name="l06120"></a>06120         } <span class="keywordflow">else</span> {
<a name="l06121"></a>06121             $xeL = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>;
<a name="l06122"></a>06122             $xeR = (<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) * $k;
<a name="l06123"></a>06123         }
<a name="l06124"></a>06124         $yeL = (($this-&gt;h - (<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>)) * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l06125"></a>06125         $yeT = (($this-&gt;h - <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>) * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l06126"></a>06126         $xeT = $xeL;
<a name="l06127"></a>06127         $xeB = $xeR;
<a name="l06128"></a>06128         $yeR = $yeT;
<a name="l06129"></a>06129         $yeB = $yeL;
<a name="l06130"></a>06130         <span class="keywordflow">if</span> (is_string($brd)) {
<a name="l06131"></a>06131             <span class="comment">// convert string to array</span>
<a name="l06132"></a>06132             $slen = strlen($brd);
<a name="l06133"></a>06133             $newbrd = array();
<a name="l06134"></a>06134             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $slen; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l06135"></a>06135                 $newbrd[$brd[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]] = array(<span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;square&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>);
<a name="l06136"></a>06136             }
<a name="l06137"></a>06137             $brd = $newbrd;
<a name="l06138"></a>06138         }
<a name="l06139"></a>06139         <span class="keywordflow">if</span> (isset($brd[<span class="stringliteral">&#39;mode&#39;</span>])) {
<a name="l06140"></a>06140             <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> = $brd[<span class="stringliteral">&#39;mode&#39;</span>];
<a name="l06141"></a>06141             unset($brd[<span class="stringliteral">&#39;mode&#39;</span>]);
<a name="l06142"></a>06142         } <span class="keywordflow">else</span> {
<a name="l06143"></a>06143             <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> = <span class="stringliteral">&#39;normal&#39;</span>;
<a name="l06144"></a>06144         }
<a name="l06145"></a>06145         <span class="keywordflow">foreach</span> ($brd as $border =&gt; $style) {
<a name="l06146"></a>06146             <span class="keywordflow">if</span> (is_array($style) AND !empty($style)) {
<a name="l06147"></a>06147                 <span class="comment">// apply border style</span>
<a name="l06148"></a>06148                 $prev_style = $this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor.<span class="charliteral">&#39; &#39;</span>;
<a name="l06149"></a>06149                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= $this-&gt;<a class="code" href="classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148" title="Set line style.">SetLineStyle</a>($style, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l06150"></a>06150             }
<a name="l06151"></a>06151             <span class="keywordflow">switch</span> (<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>) {
<a name="l06152"></a>06152                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;ext&#39;</span>: {
<a name="l06153"></a>06153                     $off = (($this-&gt;LineWidth / 2) * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>);
<a name="l06154"></a>06154                     $xL = $xeL - $off;
<a name="l06155"></a>06155                     $xR = $xeR + $off;
<a name="l06156"></a>06156                     $yT = $yeT + $off;
<a name="l06157"></a>06157                     $yL = $yeL - $off;
<a name="l06158"></a>06158                     $xT = $xL;
<a name="l06159"></a>06159                     $xB = $xR;
<a name="l06160"></a>06160                     $yR = $yT;
<a name="l06161"></a>06161                     $yB = $yL;
<a name="l06162"></a>06162                     <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> += $this-&gt;LineWidth;
<a name="l06163"></a>06163                     <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> += $this-&gt;LineWidth;
<a name="l06164"></a>06164                     <span class="keywordflow">break</span>;
<a name="l06165"></a>06165                 }
<a name="l06166"></a>06166                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;int&#39;</span>: {
<a name="l06167"></a>06167                     $off = ($this-&gt;LineWidth / 2) * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>;
<a name="l06168"></a>06168                     $xL = $xeL + $off;
<a name="l06169"></a>06169                     $xR = $xeR - $off;
<a name="l06170"></a>06170                     $yT = $yeT - $off;
<a name="l06171"></a>06171                     $yL = $yeL + $off;
<a name="l06172"></a>06172                     $xT = $xL;
<a name="l06173"></a>06173                     $xB = $xR;
<a name="l06174"></a>06174                     $yR = $yT;
<a name="l06175"></a>06175                     $yB = $yL;
<a name="l06176"></a>06176                     <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> -= $this-&gt;LineWidth;
<a name="l06177"></a>06177                     <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> -= $this-&gt;LineWidth;
<a name="l06178"></a>06178                     <span class="keywordflow">break</span>;
<a name="l06179"></a>06179                 }
<a name="l06180"></a>06180                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>:
<a name="l06181"></a>06181                 <span class="keywordflow">default</span>: {
<a name="l06182"></a>06182                     $xL = $xeL;
<a name="l06183"></a>06183                     $xT = $xeT;
<a name="l06184"></a>06184                     $xB = $xeB;
<a name="l06185"></a>06185                     $xR = $xeR;
<a name="l06186"></a>06186                     $yL = $yeL;
<a name="l06187"></a>06187                     $yT = $yeT;
<a name="l06188"></a>06188                     $yB = $yeB;
<a name="l06189"></a>06189                     $yR = $yeR;
<a name="l06190"></a>06190                     <span class="keywordflow">break</span>;
<a name="l06191"></a>06191                 }
<a name="l06192"></a>06192             }
<a name="l06193"></a>06193             <span class="comment">// draw borders by case</span>
<a name="l06194"></a>06194             <span class="keywordflow">if</span> (strlen($border) == 4) {
<a name="l06195"></a>06195                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F re S &#39;</span>, $xT, $yT, (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> * <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>), (-<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> * $k));
<a name="l06196"></a>06196             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strlen($border) == 3) {
<a name="l06197"></a>06197                 <span class="keywordflow">if</span> (strpos($border,<span class="charliteral">&#39;B&#39;</span>) === <span class="keyword">false</span>) { <span class="comment">// LTR</span>
<a name="l06198"></a>06198                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xL, $yL);
<a name="l06199"></a>06199                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xT, $yT);
<a name="l06200"></a>06200                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xR, $yR);
<a name="l06201"></a>06201                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xB, $yB);
<a name="l06202"></a>06202                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06203"></a>06203                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strpos($border,<span class="charliteral">&#39;L&#39;</span>) === <span class="keyword">false</span>) { <span class="comment">// TRB</span>
<a name="l06204"></a>06204                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xT, $yT);
<a name="l06205"></a>06205                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xR, $yR);
<a name="l06206"></a>06206                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xB, $yB);
<a name="l06207"></a>06207                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xL, $yL);
<a name="l06208"></a>06208                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06209"></a>06209                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strpos($border,<span class="charliteral">&#39;T&#39;</span>) === <span class="keyword">false</span>) { <span class="comment">// RBL</span>
<a name="l06210"></a>06210                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xR, $yR);
<a name="l06211"></a>06211                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xB, $yB);
<a name="l06212"></a>06212                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xL, $yL);
<a name="l06213"></a>06213                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xT, $yT);
<a name="l06214"></a>06214                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06215"></a>06215                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strpos($border,<span class="charliteral">&#39;R&#39;</span>) === <span class="keyword">false</span>) { <span class="comment">// BLT</span>
<a name="l06216"></a>06216                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xB, $yB);
<a name="l06217"></a>06217                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xL, $yL);
<a name="l06218"></a>06218                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xT, $yT);
<a name="l06219"></a>06219                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xR, $yR);
<a name="l06220"></a>06220                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06221"></a>06221                 }
<a name="l06222"></a>06222             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strlen($border) == 2) {
<a name="l06223"></a>06223                 <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// LT</span>
<a name="l06224"></a>06224                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xL, $yL);
<a name="l06225"></a>06225                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xT, $yT);
<a name="l06226"></a>06226                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xR, $yR);
<a name="l06227"></a>06227                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06228"></a>06228                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// TR</span>
<a name="l06229"></a>06229                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xT, $yT);
<a name="l06230"></a>06230                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xR, $yR);
<a name="l06231"></a>06231                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xB, $yB);
<a name="l06232"></a>06232                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06233"></a>06233                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// RB</span>
<a name="l06234"></a>06234                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xR, $yR);
<a name="l06235"></a>06235                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xB, $yB);
<a name="l06236"></a>06236                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xL, $yL);
<a name="l06237"></a>06237                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06238"></a>06238                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// BL</span>
<a name="l06239"></a>06239                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xB, $yB);
<a name="l06240"></a>06240                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xL, $yL);
<a name="l06241"></a>06241                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xT, $yT);
<a name="l06242"></a>06242                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06243"></a>06243                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// LR</span>
<a name="l06244"></a>06244                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xL, $yL);
<a name="l06245"></a>06245                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xT, $yT);
<a name="l06246"></a>06246                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06247"></a>06247                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xR, $yR);
<a name="l06248"></a>06248                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xB, $yB);
<a name="l06249"></a>06249                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06250"></a>06250                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// TB</span>
<a name="l06251"></a>06251                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xT, $yT);
<a name="l06252"></a>06252                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xR, $yR);
<a name="l06253"></a>06253                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06254"></a>06254                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xB, $yB);
<a name="l06255"></a>06255                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xL, $yL);
<a name="l06256"></a>06256                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06257"></a>06257                 }
<a name="l06258"></a>06258             } <span class="keywordflow">else</span> { <span class="comment">// strlen($border) == 1</span>
<a name="l06259"></a>06259                 <span class="keywordflow">if</span> (strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>) { <span class="comment">// L</span>
<a name="l06260"></a>06260                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xL, $yL);
<a name="l06261"></a>06261                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xT, $yT);
<a name="l06262"></a>06262                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06263"></a>06263                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) { <span class="comment">// T</span>
<a name="l06264"></a>06264                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xT, $yT);
<a name="l06265"></a>06265                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xR, $yR);
<a name="l06266"></a>06266                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06267"></a>06267                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>) { <span class="comment">// R</span>
<a name="l06268"></a>06268                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xR, $yR);
<a name="l06269"></a>06269                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xB, $yB);
<a name="l06270"></a>06270                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06271"></a>06271                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) { <span class="comment">// B</span>
<a name="l06272"></a>06272                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F m &#39;</span>, $xB, $yB);
<a name="l06273"></a>06273                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39;%.2F %.2F l &#39;</span>, $xL, $yL);
<a name="l06274"></a>06274                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;S &#39;</span>;
<a name="l06275"></a>06275                 }
<a name="l06276"></a>06276             }
<a name="l06277"></a>06277             <span class="keywordflow">if</span> (is_array($style) AND !empty($style)) {
<a name="l06278"></a>06278                 <span class="comment">// reset border style to previous value</span>
<a name="l06279"></a>06279                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&quot;\n&quot;</span>.$this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l06280"></a>06280             }
<a name="l06281"></a>06281         }
<a name="l06282"></a>06282         <span class="keywordflow">return</span> <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>;
<a name="l06283"></a>06283     }
<a name="l06284"></a>06284 <span class="comment"></span>
<a name="l06285"></a>06285 <span class="comment">    /**</span>
<a name="l06286"></a>06286 <span class="comment">     * This method allows printing text with line breaks.</span>
<a name="l06287"></a>06287 <span class="comment">     * They can be automatic (as soon as the text reaches the right border of the cell) or explicit (via the \n character). As many cells as necessary are output, one below the other.&lt;br /&gt;</span>
<a name="l06288"></a>06288 <span class="comment">     * Text can be aligned, centered or justified. The cell block can be framed and the background painted.</span>
<a name="l06289"></a>06289 <span class="comment">     * @param $w (float) Width of cells. If 0, they extend up to the right margin of the page.</span>
<a name="l06290"></a>06290 <span class="comment">     * @param $h (float) Cell minimum height. The cell extends automatically if needed.</span>
<a name="l06291"></a>06291 <span class="comment">     * @param $txt (string) String to print</span>
<a name="l06292"></a>06292 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l06293"></a>06293 <span class="comment">     * @param $align (string) Allows to center or align the text. Possible values are:&lt;ul&gt;&lt;li&gt;L or empty string: left align&lt;/li&gt;&lt;li&gt;C: center&lt;/li&gt;&lt;li&gt;R: right align&lt;/li&gt;&lt;li&gt;J: justification (default value when $ishtml=false)&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l06294"></a>06294 <span class="comment">     * @param $fill (boolean) Indicates if the cell background must be painted (true) or transparent (false).</span>
<a name="l06295"></a>06295 <span class="comment">     * @param $ln (int) Indicates where the current position should go after the call. Possible values are:&lt;ul&gt;&lt;li&gt;0: to the right&lt;/li&gt;&lt;li&gt;1: to the beginning of the next line [DEFAULT]&lt;/li&gt;&lt;li&gt;2: below&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l06296"></a>06296 <span class="comment">     * @param $x (float) x position in user units</span>
<a name="l06297"></a>06297 <span class="comment">     * @param $y (float) y position in user units</span>
<a name="l06298"></a>06298 <span class="comment">     * @param $reseth (boolean) if true reset the last cell height (default true).</span>
<a name="l06299"></a>06299 <span class="comment">     * @param $stretch (int) font stretch mode: &lt;ul&gt;&lt;li&gt;0 = disabled&lt;/li&gt;&lt;li&gt;1 = horizontal scaling only if text is larger than cell width&lt;/li&gt;&lt;li&gt;2 = forced horizontal scaling to fit cell width&lt;/li&gt;&lt;li&gt;3 = character spacing only if text is larger than cell width&lt;/li&gt;&lt;li&gt;4 = forced character spacing to fit cell width&lt;/li&gt;&lt;/ul&gt; General font stretching and scaling values will be preserved when possible.</span>
<a name="l06300"></a>06300 <span class="comment">     * @param $ishtml (boolean) INTERNAL USE ONLY -- set to true if $txt is HTML content (default = false). Never set this parameter to true, use instead writeHTMLCell() or writeHTML() methods.</span>
<a name="l06301"></a>06301 <span class="comment">     * @param $autopadding (boolean) if true, uses internal padding and automatically adjust it to account for line width.</span>
<a name="l06302"></a>06302 <span class="comment">     * @param $maxh (float) maximum height. It should be &gt;= $h and less than remaining space to the bottom of the page, or 0 for disable this feature. This feature works only when $ishtml=false.</span>
<a name="l06303"></a>06303 <span class="comment">     * @param $valign (string) Vertical alignment of text (requires $maxh = $h &gt; 0). Possible values are:&lt;ul&gt;&lt;li&gt;T: TOP&lt;/li&gt;&lt;li&gt;M: middle&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt;. This feature works only when $ishtml=false and the cell must fit in a single page.</span>
<a name="l06304"></a>06304 <span class="comment">     * @param $fitcell (boolean) if true attempt to fit all the text within the cell by reducing the font size (do not work in HTML mode).</span>
<a name="l06305"></a>06305 <span class="comment">     * @return int Return the number of cells or 1 for html mode.</span>
<a name="l06306"></a>06306 <span class="comment">     * @public</span>
<a name="l06307"></a>06307 <span class="comment">     * @since 1.3</span>
<a name="l06308"></a>06308 <span class="comment">     * @see SetFont(), SetDrawColor(), SetFillColor(), SetTextColor(), SetLineWidth(), Cell(), Write(), SetAutoPageBreak()</span>
<a name="l06309"></a>06309 <span class="comment">     */</span>
<a name="l06310"></a><a class="code" href="classTCPDF.html#aa81d4b585de305c054760ec983ed3ece">06310</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa81d4b585de305c054760ec983ed3ece" title="This method allows printing text with line breaks.">MultiCell</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $txt, $border=0, $align=<span class="charliteral">&#39;J&#39;</span>, $fill=<span class="keyword">false</span>, $ln=1, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>=<span class="stringliteral">&#39;&#39;</span>, $reseth=<span class="keyword">true</span>, $stretch=0, $ishtml=<span class="keyword">false</span>, $autopadding=<span class="keyword">true</span>, $maxh=0, $valign=<span class="charliteral">&#39;T&#39;</span>, $fitcell=<span class="keyword">false</span>) {
<a name="l06311"></a>06311         $prev_cell_margin = $this-&gt;cell_margin;
<a name="l06312"></a>06312         $prev_cell_padding = $this-&gt;cell_padding;
<a name="l06313"></a>06313         <span class="comment">// adjust internal padding</span>
<a name="l06314"></a>06314         $this-&gt;<a class="code" href="classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4" title="Adjust the internal Cell padding array to take account of the line width.">adjustCellPadding</a>($border);
<a name="l06315"></a>06315         $mc_padding = $this-&gt;cell_padding;
<a name="l06316"></a>06316         $mc_margin = $this-&gt;cell_margin;
<a name="l06317"></a>06317         $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] = 0;
<a name="l06318"></a>06318         $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] = 0;
<a name="l06319"></a>06319         $this-&gt;<a class="code" href="classTCPDF.html#a80e96cb97ad08e7feb952d2e5e8dc36d" title="Set the internal Cell margins.">setCellMargins</a>(0, 0, 0, 0);
<a name="l06320"></a>06320         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($this-&gt;lasth) OR $reseth) {
<a name="l06321"></a>06321             <span class="comment">// reset row height</span>
<a name="l06322"></a>06322             $this-&gt;<a class="code" href="classTCPDF.html#a10215105777b306528a827f3669e936e" title="Reset the last cell height.">resetLastH</a>();
<a name="l06323"></a>06323         }
<a name="l06324"></a>06324         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>)) {
<a name="l06325"></a>06325             $this-&gt;<a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758" title="Moves the current abscissa back to the left margin and sets the ordinate.">SetY</a>(<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>);
<a name="l06326"></a>06326         } <span class="keywordflow">else</span> {
<a name="l06327"></a>06327             <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = $this-&gt;<a class="code" href="classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799" title="Returns the ordinate of the current position.">GetY</a>();
<a name="l06328"></a>06328         }
<a name="l06329"></a>06329         $resth = 0;
<a name="l06330"></a>06330         <span class="keywordflow">if</span> ((<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> &gt; 0) AND $this-&gt;<a class="code" href="classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c" title="Check if we are on the page body (excluding page header and footer).">inPageBody</a>() AND ((<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> + $mc_margin[<span class="charliteral">&#39;T&#39;</span>] + $mc_margin[<span class="charliteral">&#39;B&#39;</span>]) &gt; $this-&gt;PageBreakTrigger)) {
<a name="l06331"></a>06331             <span class="comment">// spit cell in more pages/columns</span>
<a name="l06332"></a>06332             $newh = ($this-&gt;PageBreakTrigger - <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>);
<a name="l06333"></a>06333             $resth = (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> - $newh); <span class="comment">// cell to be printed on the next page/column</span>
<a name="l06334"></a>06334             <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $newh;
<a name="l06335"></a>06335         }
<a name="l06336"></a>06336         <span class="comment">// get current page number</span>
<a name="l06337"></a>06337         $startpage = $this-&gt;page;
<a name="l06338"></a>06338         <span class="comment">// get current column</span>
<a name="l06339"></a>06339         $startcolumn = $this-&gt;current_column;
<a name="l06340"></a>06340         <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>)) {
<a name="l06341"></a>06341             $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>);
<a name="l06342"></a>06342         } <span class="keywordflow">else</span> {
<a name="l06343"></a>06343             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = $this-&gt;<a class="code" href="classTCPDF.html#a415a80a301208fa77552048b27d2e0ce" title="Returns the relative X value of current position.">GetX</a>();
<a name="l06344"></a>06344         }
<a name="l06345"></a>06345         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l06346"></a>06346         list(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>) = $this-&gt;<a class="code" href="classTCPDF.html#a1d99e81697a90efb13a6734001427f40" title="Check page for no-write regions and adapt current coordinates and page margins if necessary...">checkPageRegions</a>(0, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>);
<a name="l06347"></a>06347         <span class="comment">// apply margins</span>
<a name="l06348"></a>06348         <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a> = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + $mc_margin[<span class="charliteral">&#39;T&#39;</span>];
<a name="l06349"></a>06349         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06350"></a>06350             <a class="code" href="indexfb_8php.html#a33a0a09e9029d3d77e80de32b4e1c7b1">$ox</a> = $this-&gt;w - <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - $mc_margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06351"></a>06351         } <span class="keywordflow">else</span> {
<a name="l06352"></a>06352             <a class="code" href="indexfb_8php.html#a33a0a09e9029d3d77e80de32b4e1c7b1">$ox</a> = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + $mc_margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06353"></a>06353         }
<a name="l06354"></a>06354         $this-&gt;x = <a class="code" href="indexfb_8php.html#a33a0a09e9029d3d77e80de32b4e1c7b1">$ox</a>;
<a name="l06355"></a>06355         $this-&gt;y = <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a>;
<a name="l06356"></a>06356         <span class="comment">// set width</span>
<a name="l06357"></a>06357         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) OR (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> &lt;= 0)) {
<a name="l06358"></a>06358             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06359"></a>06359                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;x - $this-&gt;lMargin - $mc_margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06360"></a>06360             } <span class="keywordflow">else</span> {
<a name="l06361"></a>06361                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;w - $this-&gt;x - $this-&gt;rMargin - $mc_margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06362"></a>06362             }
<a name="l06363"></a>06363         }
<a name="l06364"></a>06364         <span class="comment">// store original margin values</span>
<a name="l06365"></a>06365         <a class="code" href="classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da" title="Left margin.">$lMargin</a> = $this-&gt;lMargin;
<a name="l06366"></a>06366         <a class="code" href="classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9" title="Right margin.">$rMargin</a> = $this-&gt;rMargin;
<a name="l06367"></a>06367         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06368"></a>06368             $this-&gt;rMargin = $this-&gt;w - $this-&gt;x;
<a name="l06369"></a>06369             $this-&gt;lMargin = $this-&gt;x - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l06370"></a>06370         } <span class="keywordflow">else</span> {
<a name="l06371"></a>06371             $this-&gt;lMargin = $this-&gt;x;
<a name="l06372"></a>06372             $this-&gt;rMargin = $this-&gt;w - $this-&gt;x - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l06373"></a>06373         }
<a name="l06374"></a>06374         <span class="keywordflow">if</span> ($autopadding) {
<a name="l06375"></a>06375             <span class="comment">// add top padding</span>
<a name="l06376"></a>06376             $this-&gt;y += $mc_padding[<span class="charliteral">&#39;T&#39;</span>];
<a name="l06377"></a>06377         }
<a name="l06378"></a>06378         <span class="keywordflow">if</span> ($ishtml) { <span class="comment">// ******* Write HTML text</span>
<a name="l06379"></a>06379             $this-&gt;<a class="code" href="classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407" title="Allows to preserve some HTML formatting (limited support).">writeHTML</a>($txt, <span class="keyword">true</span>, <span class="keyword">false</span>, $reseth, <span class="keyword">true</span>, $align);
<a name="l06380"></a>06380             $nl = 1;
<a name="l06381"></a>06381         } <span class="keywordflow">else</span> { <span class="comment">// ******* Write simple text</span>
<a name="l06382"></a>06382             $prev_FontSizePt = $this-&gt;FontSizePt;
<a name="l06383"></a>06383             <span class="comment">// vertical alignment</span>
<a name="l06384"></a>06384             <span class="keywordflow">if</span> ($maxh &gt; 0) {
<a name="l06385"></a>06385                 <span class="comment">// get text height</span>
<a name="l06386"></a>06386                 $text_height = $this-&gt;<a class="code" href="classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9" title="This method return the estimated height needed for printing a simple text string using the Multicell(...">getStringHeight</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, $txt, $reseth, $autopadding, $mc_padding, $border);
<a name="l06387"></a>06387                 <span class="keywordflow">if</span> ($fitcell) {
<a name="l06388"></a>06388                     <span class="comment">// try to reduce font size to fit text on cell (use a quick search algorithm)</span>
<a name="l06389"></a>06389                     $fmin = 1;
<a name="l06390"></a>06390                     $fmax = $this-&gt;FontSizePt;
<a name="l06391"></a>06391                     $prev_text_height = $text_height;
<a name="l06392"></a>06392                     $maxit = 100; <span class="comment">// max number of iterations</span>
<a name="l06393"></a>06393                     <span class="keywordflow">while</span> ($maxit &gt; 0) {
<a name="l06394"></a>06394                         $fmid = (($fmax + $fmin) / 2);
<a name="l06395"></a>06395                         $this-&gt;<a class="code" href="classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f" title="Defines the size of the current font.">SetFontSize</a>($fmid, <span class="keyword">false</span>);
<a name="l06396"></a>06396                         $this-&gt;<a class="code" href="classTCPDF.html#a10215105777b306528a827f3669e936e" title="Reset the last cell height.">resetLastH</a>();
<a name="l06397"></a>06397                         $text_height = $this-&gt;<a class="code" href="classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9" title="This method return the estimated height needed for printing a simple text string using the Multicell(...">getStringHeight</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, $txt, $reseth, $autopadding, $mc_padding, $border);
<a name="l06398"></a>06398                         <span class="keywordflow">if</span> (($text_height == $maxh) OR (($text_height &lt; $maxh) AND ($fmin &gt;= ($fmax - 0.01)))) {
<a name="l06399"></a>06399                             <span class="keywordflow">break</span>;
<a name="l06400"></a>06400                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($text_height &lt; $maxh) {
<a name="l06401"></a>06401                             $fmin = $fmid;
<a name="l06402"></a>06402                         } <span class="keywordflow">else</span> {
<a name="l06403"></a>06403                             $fmax = $fmid;
<a name="l06404"></a>06404                         }
<a name="l06405"></a>06405                         --$maxit;
<a name="l06406"></a>06406                     }
<a name="l06407"></a>06407                     $this-&gt;<a class="code" href="classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f" title="Defines the size of the current font.">SetFontSize</a>($this-&gt;FontSizePt);
<a name="l06408"></a>06408                 }
<a name="l06409"></a>06409                 <span class="keywordflow">if</span> ($text_height &lt; $maxh) {
<a name="l06410"></a>06410                     <span class="keywordflow">if</span> ($valign == <span class="charliteral">&#39;M&#39;</span>) {
<a name="l06411"></a>06411                         <span class="comment">// text vertically centered</span>
<a name="l06412"></a>06412                         $this-&gt;y += (($maxh - $text_height) / 2);
<a name="l06413"></a>06413                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($valign == <span class="charliteral">&#39;B&#39;</span>) {
<a name="l06414"></a>06414                         <span class="comment">// text vertically aligned on bottom</span>
<a name="l06415"></a>06415                         $this-&gt;y += ($maxh - $text_height);
<a name="l06416"></a>06416                     }
<a name="l06417"></a>06417                 }
<a name="l06418"></a>06418             }
<a name="l06419"></a>06419             $nl = $this-&gt;<a class="code" href="classTCPDF.html#a6669ae88090963e9487d0388c7577dc9" title="This method prints text from the current position.">Write</a>($this-&gt;lasth, $txt, <span class="stringliteral">&#39;&#39;</span>, 0, $align, <span class="keyword">true</span>, $stretch, <span class="keyword">false</span>, <span class="keyword">true</span>, $maxh, 0, $mc_margin);
<a name="l06420"></a>06420             <span class="keywordflow">if</span> ($fitcell) {
<a name="l06421"></a>06421                 <span class="comment">// restore font size</span>
<a name="l06422"></a>06422                 $this-&gt;<a class="code" href="classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f" title="Defines the size of the current font.">SetFontSize</a>($prev_FontSizePt);
<a name="l06423"></a>06423             }
<a name="l06424"></a>06424         }
<a name="l06425"></a>06425         <span class="keywordflow">if</span> ($autopadding) {
<a name="l06426"></a>06426             <span class="comment">// add bottom padding</span>
<a name="l06427"></a>06427             $this-&gt;y += $mc_padding[<span class="charliteral">&#39;B&#39;</span>];
<a name="l06428"></a>06428         }
<a name="l06429"></a>06429         <span class="comment">// Get end-of-text Y position</span>
<a name="l06430"></a>06430         $currentY = $this-&gt;y;
<a name="l06431"></a>06431         <span class="comment">// get latest page number</span>
<a name="l06432"></a>06432         $endpage = $this-&gt;page;
<a name="l06433"></a>06433         <span class="keywordflow">if</span> ($resth &gt; 0) {
<a name="l06434"></a>06434             $skip = ($endpage - $startpage);
<a name="l06435"></a>06435             $tmpresth = $resth;
<a name="l06436"></a>06436             <span class="keywordflow">while</span> ($tmpresth &gt; 0) {
<a name="l06437"></a>06437                 <span class="keywordflow">if</span> ($skip &lt;= 0) {
<a name="l06438"></a>06438                     <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l06439"></a>06439                     $this-&gt;<a class="code" href="classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50" title="Add page if needed.">checkPageBreak</a>($this-&gt;PageBreakTrigger + 1);
<a name="l06440"></a>06440                 }
<a name="l06441"></a>06441                 <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {
<a name="l06442"></a>06442                     $tmpresth -= ($this-&gt;h - $this-&gt;y - $this-&gt;bMargin);
<a name="l06443"></a>06443                 } <span class="keywordflow">else</span> {
<a name="l06444"></a>06444                     $tmpresth -= ($this-&gt;h - $this-&gt;tMargin - $this-&gt;bMargin);
<a name="l06445"></a>06445                 }
<a name="l06446"></a>06446                 --$skip;
<a name="l06447"></a>06447             }
<a name="l06448"></a>06448             $currentY = $this-&gt;y;
<a name="l06449"></a>06449             $endpage = $this-&gt;page;
<a name="l06450"></a>06450         }
<a name="l06451"></a>06451         <span class="comment">// get latest column</span>
<a name="l06452"></a>06452         $endcolumn = $this-&gt;current_column;
<a name="l06453"></a>06453         <span class="keywordflow">if</span> ($this-&gt;num_columns == 0) {
<a name="l06454"></a>06454             $this-&gt;num_columns = 1;
<a name="l06455"></a>06455         }
<a name="l06456"></a>06456         <span class="comment">// get border modes</span>
<a name="l06457"></a>06457         $border_start = $this-&gt;<a class="code" href="classTCPDF.html#a4135c3785257deb216dd884262bf3587" title="Get the border mode accounting for multicell position (opens bottom side of multicell crossing pages)...">getBorderMode</a>($border, $position=<span class="stringliteral">&#39;start&#39;</span>);
<a name="l06458"></a>06458         $border_end = $this-&gt;<a class="code" href="classTCPDF.html#a4135c3785257deb216dd884262bf3587" title="Get the border mode accounting for multicell position (opens bottom side of multicell crossing pages)...">getBorderMode</a>($border, $position=<span class="stringliteral">&#39;end&#39;</span>);
<a name="l06459"></a>06459         $border_middle = $this-&gt;<a class="code" href="classTCPDF.html#a4135c3785257deb216dd884262bf3587" title="Get the border mode accounting for multicell position (opens bottom side of multicell crossing pages)...">getBorderMode</a>($border, $position=<span class="stringliteral">&#39;middle&#39;</span>);
<a name="l06460"></a>06460         <span class="comment">// design borders around HTML cells.</span>
<a name="l06461"></a>06461         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> = $startpage; <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> &lt;= $endpage; ++<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>) { <span class="comment">// for each page</span>
<a name="l06462"></a>06462             $ccode = <span class="stringliteral">&#39;&#39;</span>;
<a name="l06463"></a>06463             $this-&gt;<a class="code" href="classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00" title="Move pointer at the specified document page and update page dimensions.">setPage</a>(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>);
<a name="l06464"></a>06464             <span class="keywordflow">if</span> ($this-&gt;num_columns &lt; 2) {
<a name="l06465"></a>06465                 <span class="comment">// single-column mode</span>
<a name="l06466"></a>06466                 $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>);
<a name="l06467"></a>06467                 $this-&gt;y = $this-&gt;tMargin;
<a name="l06468"></a>06468             }
<a name="l06469"></a>06469             <span class="comment">// account for margin changes</span>
<a name="l06470"></a>06470             <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> &gt; $startpage) {
<a name="l06471"></a>06471                 <span class="keywordflow">if</span> (($this-&gt;rtl) AND ($this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>])) {
<a name="l06472"></a>06472                     $this-&gt;x -= ($this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>]);
<a name="l06473"></a>06473                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((!$this-&gt;rtl) AND ($this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>])) {
<a name="l06474"></a>06474                     $this-&gt;x += ($this-&gt;pagedim[<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>]);
<a name="l06475"></a>06475                 }
<a name="l06476"></a>06476             }
<a name="l06477"></a>06477             <span class="keywordflow">if</span> ($startpage == $endpage) {
<a name="l06478"></a>06478                 <span class="comment">// single page</span>
<a name="l06479"></a>06479                 <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span>
<a name="l06480"></a>06480                     $this-&gt;<a class="code" href="classTCPDF.html#a4f11d769024fd07e1f663efd02d10517" title="Set position at a given column.">selectColumn</a>($column);
<a name="l06481"></a>06481                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06482"></a>06482                         $this-&gt;x -= $mc_margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06483"></a>06483                     } <span class="keywordflow">else</span> {
<a name="l06484"></a>06484                         $this-&gt;x += $mc_margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06485"></a>06485                     }
<a name="l06486"></a>06486                     <span class="keywordflow">if</span> ($startcolumn == $endcolumn) { <span class="comment">// single column</span>
<a name="l06487"></a>06487                         $cborder = $border;
<a name="l06488"></a>06488                         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = max(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, ($currentY - <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a>));
<a name="l06489"></a>06489                         $this-&gt;y = <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a>;
<a name="l06490"></a>06490                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($column == $startcolumn) { <span class="comment">// first column</span>
<a name="l06491"></a>06491                         $cborder = $border_start;
<a name="l06492"></a>06492                         $this-&gt;y = <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a>;
<a name="l06493"></a>06493                         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l06494"></a>06494                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($column == $endcolumn) { <span class="comment">// end column</span>
<a name="l06495"></a>06495                         $cborder = $border_end;
<a name="l06496"></a>06496                         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $currentY - $this-&gt;y;
<a name="l06497"></a>06497                         <span class="keywordflow">if</span> ($resth &gt; <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>) {
<a name="l06498"></a>06498                             <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $resth;
<a name="l06499"></a>06499                         }
<a name="l06500"></a>06500                     } <span class="keywordflow">else</span> { <span class="comment">// middle column</span>
<a name="l06501"></a>06501                         $cborder = $border_middle;
<a name="l06502"></a>06502                         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l06503"></a>06503                         $resth -= <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l06504"></a>06504                     }
<a name="l06505"></a>06505                     $ccode .= $this-&gt;<a class="code" href="classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc" title="Returns the PDF string code to print a cell (rectangular area) with optional borders, background color and character string.">getCellCode</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l06506"></a>06506                 } <span class="comment">// end for each column</span>
<a name="l06507"></a>06507             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> == $startpage) { <span class="comment">// first page</span>
<a name="l06508"></a>06508                 <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt; $this-&gt;num_columns; ++$column) { <span class="comment">// for each column</span>
<a name="l06509"></a>06509                     $this-&gt;<a class="code" href="classTCPDF.html#a4f11d769024fd07e1f663efd02d10517" title="Set position at a given column.">selectColumn</a>($column);
<a name="l06510"></a>06510                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06511"></a>06511                         $this-&gt;x -= $mc_margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06512"></a>06512                     } <span class="keywordflow">else</span> {
<a name="l06513"></a>06513                         $this-&gt;x += $mc_margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06514"></a>06514                     }
<a name="l06515"></a>06515                     <span class="keywordflow">if</span> ($column == $startcolumn) { <span class="comment">// first column</span>
<a name="l06516"></a>06516                         $cborder = $border_start;
<a name="l06517"></a>06517                         $this-&gt;y = <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a>;
<a name="l06518"></a>06518                         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l06519"></a>06519                     } <span class="keywordflow">else</span> { <span class="comment">// middle column</span>
<a name="l06520"></a>06520                         $cborder = $border_middle;
<a name="l06521"></a>06521                         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l06522"></a>06522                         $resth -= <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l06523"></a>06523                     }
<a name="l06524"></a>06524                     $ccode .= $this-&gt;<a class="code" href="classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc" title="Returns the PDF string code to print a cell (rectangular area) with optional borders, background color and character string.">getCellCode</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l06525"></a>06525                 } <span class="comment">// end for each column</span>
<a name="l06526"></a>06526             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> == $endpage) { <span class="comment">// last page</span>
<a name="l06527"></a>06527                 <span class="keywordflow">for</span> ($column = 0; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span>
<a name="l06528"></a>06528                     $this-&gt;<a class="code" href="classTCPDF.html#a4f11d769024fd07e1f663efd02d10517" title="Set position at a given column.">selectColumn</a>($column);
<a name="l06529"></a>06529                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06530"></a>06530                         $this-&gt;x -= $mc_margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06531"></a>06531                     } <span class="keywordflow">else</span> {
<a name="l06532"></a>06532                         $this-&gt;x += $mc_margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06533"></a>06533                     }
<a name="l06534"></a>06534                     <span class="keywordflow">if</span> ($column == $endcolumn) {
<a name="l06535"></a>06535                         <span class="comment">// end column</span>
<a name="l06536"></a>06536                         $cborder = $border_end;
<a name="l06537"></a>06537                         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $currentY - $this-&gt;y;
<a name="l06538"></a>06538                         <span class="keywordflow">if</span> ($resth &gt; <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>) {
<a name="l06539"></a>06539                             <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $resth;
<a name="l06540"></a>06540                         }
<a name="l06541"></a>06541                     } <span class="keywordflow">else</span> {
<a name="l06542"></a>06542                         <span class="comment">// middle column</span>
<a name="l06543"></a>06543                         $cborder = $border_middle;
<a name="l06544"></a>06544                         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l06545"></a>06545                         $resth -= <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l06546"></a>06546                     }
<a name="l06547"></a>06547                     $ccode .= $this-&gt;<a class="code" href="classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc" title="Returns the PDF string code to print a cell (rectangular area) with optional borders, background color and character string.">getCellCode</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l06548"></a>06548                 } <span class="comment">// end for each column</span>
<a name="l06549"></a>06549             } <span class="keywordflow">else</span> { <span class="comment">// middle page</span>
<a name="l06550"></a>06550                 <span class="keywordflow">for</span> ($column = 0; $column &lt; $this-&gt;num_columns; ++$column) { <span class="comment">// for each column</span>
<a name="l06551"></a>06551                     $this-&gt;<a class="code" href="classTCPDF.html#a4f11d769024fd07e1f663efd02d10517" title="Set position at a given column.">selectColumn</a>($column);
<a name="l06552"></a>06552                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06553"></a>06553                         $this-&gt;x -= $mc_margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06554"></a>06554                     } <span class="keywordflow">else</span> {
<a name="l06555"></a>06555                         $this-&gt;x += $mc_margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06556"></a>06556                     }
<a name="l06557"></a>06557                     $cborder = $border_middle;
<a name="l06558"></a>06558                     <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l06559"></a>06559                     $resth -= <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l06560"></a>06560                     $ccode .= $this-&gt;<a class="code" href="classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc" title="Returns the PDF string code to print a cell (rectangular area) with optional borders, background color and character string.">getCellCode</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l06561"></a>06561                 } <span class="comment">// end for each column</span>
<a name="l06562"></a>06562             }
<a name="l06563"></a>06563             <span class="keywordflow">if</span> ($cborder OR $fill) {
<a name="l06564"></a>06564                 $offsetlen = strlen($ccode);
<a name="l06565"></a>06565                 <span class="comment">// draw border and fill</span>
<a name="l06566"></a>06566                 <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l06567"></a>06567                     <span class="comment">// we are inside an XObject template</span>
<a name="l06568"></a>06568                     <span class="keywordflow">if</span> (end($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]) !== <span class="keyword">false</span>) {
<a name="l06569"></a>06569                         $pagemarkkey = key($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);
<a name="l06570"></a>06570                         $pagemark = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey];
<a name="l06571"></a>06571                         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey] += $offsetlen;
<a name="l06572"></a>06572                     } <span class="keywordflow">else</span> {
<a name="l06573"></a>06573                         $pagemark = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>];
<a name="l06574"></a>06574                         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>] += $offsetlen;
<a name="l06575"></a>06575                     }
<a name="l06576"></a>06576                     $pagebuff = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>];
<a name="l06577"></a>06577                     $pstart = substr($pagebuff, 0, $pagemark);
<a name="l06578"></a>06578                     $pend = substr($pagebuff, $pagemark);
<a name="l06579"></a>06579                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$ccode.$pend;
<a name="l06580"></a>06580                 } <span class="keywordflow">else</span> {
<a name="l06581"></a>06581                     <span class="keywordflow">if</span> (end($this-&gt;transfmrk[$this-&gt;page]) !== <span class="keyword">false</span>) {
<a name="l06582"></a>06582                         $pagemarkkey = key($this-&gt;transfmrk[$this-&gt;page]);
<a name="l06583"></a>06583                         $pagemark = $this-&gt;transfmrk[$this-&gt;page][$pagemarkkey];
<a name="l06584"></a>06584                         $this-&gt;transfmrk[$this-&gt;page][$pagemarkkey] += $offsetlen;
<a name="l06585"></a>06585                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;InFooter) {
<a name="l06586"></a>06586                         $pagemark = $this-&gt;footerpos[$this-&gt;page];
<a name="l06587"></a>06587                         $this-&gt;footerpos[$this-&gt;page] += $offsetlen;
<a name="l06588"></a>06588                     } <span class="keywordflow">else</span> {
<a name="l06589"></a>06589                         $pagemark = $this-&gt;intmrk[$this-&gt;page];
<a name="l06590"></a>06590                         $this-&gt;intmrk[$this-&gt;page] += $offsetlen;
<a name="l06591"></a>06591                     }
<a name="l06592"></a>06592                     $pagebuff = $this-&gt;<a class="code" href="classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56" title="Get page buffer content.">getPageBuffer</a>($this-&gt;page);
<a name="l06593"></a>06593                     $pstart = substr($pagebuff, 0, $pagemark);
<a name="l06594"></a>06594                     $pend = substr($pagebuff, $pagemark);
<a name="l06595"></a>06595                     $this-&gt;<a class="code" href="classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8" title="Set page buffer content.">setPageBuffer</a>($this-&gt;page, $pstart.$ccode.$pend);
<a name="l06596"></a>06596                 }
<a name="l06597"></a>06597             }
<a name="l06598"></a>06598         } <span class="comment">// end for each page</span>
<a name="l06599"></a>06599         <span class="comment">// Get end-of-cell Y position</span>
<a name="l06600"></a>06600         $currentY = $this-&gt;<a class="code" href="classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799" title="Returns the ordinate of the current position.">GetY</a>();
<a name="l06601"></a>06601         <span class="comment">// restore previous values</span>
<a name="l06602"></a>06602         <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {
<a name="l06603"></a>06603             $this-&gt;<a class="code" href="classTCPDF.html#a4f11d769024fd07e1f663efd02d10517" title="Set position at a given column.">selectColumn</a>();
<a name="l06604"></a>06604         } <span class="keywordflow">else</span> {
<a name="l06605"></a>06605             <span class="comment">// restore original margins</span>
<a name="l06606"></a>06606             $this-&gt;lMargin = <a class="code" href="classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da" title="Left margin.">$lMargin</a>;
<a name="l06607"></a>06607             $this-&gt;rMargin = <a class="code" href="classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9" title="Right margin.">$rMargin</a>;
<a name="l06608"></a>06608             <span class="keywordflow">if</span> ($this-&gt;page &gt; $startpage) {
<a name="l06609"></a>06609                 <span class="comment">// check for margin variations between pages (i.e. booklet mode)</span>
<a name="l06610"></a>06610                 $dl = ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>]);
<a name="l06611"></a>06611                 $dr = ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>]);
<a name="l06612"></a>06612                 <span class="keywordflow">if</span> (($dl != 0) OR ($dr != 0)) {
<a name="l06613"></a>06613                     $this-&gt;lMargin += $dl;
<a name="l06614"></a>06614                     $this-&gt;rMargin += $dr;
<a name="l06615"></a>06615                 }
<a name="l06616"></a>06616             }
<a name="l06617"></a>06617         }
<a name="l06618"></a>06618         <span class="keywordflow">if</span> ($ln &gt; 0) {
<a name="l06619"></a>06619             <span class="comment">//Go to the beginning of the next line</span>
<a name="l06620"></a>06620             $this-&gt;<a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758" title="Moves the current abscissa back to the left margin and sets the ordinate.">SetY</a>($currentY + $mc_margin[<span class="charliteral">&#39;B&#39;</span>]);
<a name="l06621"></a>06621             <span class="keywordflow">if</span> ($ln == 2) {
<a name="l06622"></a>06622                 $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> + $mc_margin[<span class="charliteral">&#39;L&#39;</span>] + $mc_margin[<span class="charliteral">&#39;R&#39;</span>]);
<a name="l06623"></a>06623             }
<a name="l06624"></a>06624         } <span class="keywordflow">else</span> {
<a name="l06625"></a>06625             <span class="comment">// go left or right by case</span>
<a name="l06626"></a>06626             $this-&gt;<a class="code" href="classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00" title="Move pointer at the specified document page and update page dimensions.">setPage</a>($startpage);
<a name="l06627"></a>06627             $this-&gt;y = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>;
<a name="l06628"></a>06628             $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> + $mc_margin[<span class="charliteral">&#39;L&#39;</span>] + $mc_margin[<span class="charliteral">&#39;R&#39;</span>]);
<a name="l06629"></a>06629         }
<a name="l06630"></a>06630         $this-&gt;<a class="code" href="classTCPDF.html#a278cba1881265c0b47036a629a67863f" title="Set start-writing mark on selected page.">setContentMark</a>();
<a name="l06631"></a>06631         $this-&gt;cell_padding = $prev_cell_padding;
<a name="l06632"></a>06632         $this-&gt;cell_margin = $prev_cell_margin;
<a name="l06633"></a>06633         <span class="keywordflow">return</span> $nl;
<a name="l06634"></a>06634     }
<a name="l06635"></a>06635 <span class="comment"></span>
<a name="l06636"></a>06636 <span class="comment">    /**</span>
<a name="l06637"></a>06637 <span class="comment">     * Get the border mode accounting for multicell position (opens bottom side of multicell crossing pages)</span>
<a name="l06638"></a>06638 <span class="comment">     * @param $brd (mixed) Indicates if borders must be drawn around the cell block. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt;or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l06639"></a>06639 <span class="comment">     * @param $position (string) multicell position: &#39;start&#39;, &#39;middle&#39;, &#39;end&#39;</span>
<a name="l06640"></a>06640 <span class="comment">     * @return border mode array</span>
<a name="l06641"></a>06641 <span class="comment">     * @protected</span>
<a name="l06642"></a>06642 <span class="comment">     * @since 4.4.002 (2008-12-09)</span>
<a name="l06643"></a>06643 <span class="comment">     */</span>
<a name="l06644"></a><a class="code" href="classTCPDF.html#a4135c3785257deb216dd884262bf3587">06644</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4135c3785257deb216dd884262bf3587" title="Get the border mode accounting for multicell position (opens bottom side of multicell crossing pages)...">getBorderMode</a>($brd, $position=<span class="stringliteral">&#39;start&#39;</span>) {
<a name="l06645"></a>06645         <span class="keywordflow">if</span> ((!$this-&gt;opencell) OR empty($brd)) {
<a name="l06646"></a>06646             <span class="keywordflow">return</span> $brd;
<a name="l06647"></a>06647         }
<a name="l06648"></a>06648         <span class="keywordflow">if</span> ($brd == 1) {
<a name="l06649"></a>06649             $brd = <span class="stringliteral">&#39;LTRB&#39;</span>;
<a name="l06650"></a>06650         }
<a name="l06651"></a>06651         <span class="keywordflow">if</span> (is_string($brd)) {
<a name="l06652"></a>06652             <span class="comment">// convert string to array</span>
<a name="l06653"></a>06653             $slen = strlen($brd);
<a name="l06654"></a>06654             $newbrd = array();
<a name="l06655"></a>06655             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $slen; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l06656"></a>06656                 $newbrd[$brd[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]] = array(<span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;square&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>);
<a name="l06657"></a>06657             }
<a name="l06658"></a>06658             $brd = $newbrd;
<a name="l06659"></a>06659         }
<a name="l06660"></a>06660         <span class="keywordflow">foreach</span> ($brd as $border =&gt; $style) {
<a name="l06661"></a>06661             <span class="keywordflow">switch</span> ($position) {
<a name="l06662"></a>06662                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;start&#39;</span>: {
<a name="l06663"></a>06663                     <span class="keywordflow">if</span> (strpos($border, <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l06664"></a>06664                         <span class="comment">// remove bottom line</span>
<a name="l06665"></a>06665                         $newkey = str_replace(<span class="charliteral">&#39;B&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $border);
<a name="l06666"></a>06666                         <span class="keywordflow">if</span> (strlen($newkey) &gt; 0) {
<a name="l06667"></a>06667                             $brd[$newkey] = $style;
<a name="l06668"></a>06668                         }
<a name="l06669"></a>06669                         unset($brd[$border]);
<a name="l06670"></a>06670                     }
<a name="l06671"></a>06671                     <span class="keywordflow">break</span>;
<a name="l06672"></a>06672                 }
<a name="l06673"></a>06673                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;middle&#39;</span>: {
<a name="l06674"></a>06674                     <span class="keywordflow">if</span> (strpos($border, <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l06675"></a>06675                         <span class="comment">// remove bottom line</span>
<a name="l06676"></a>06676                         $newkey = str_replace(<span class="charliteral">&#39;B&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $border);
<a name="l06677"></a>06677                         <span class="keywordflow">if</span> (strlen($newkey) &gt; 0) {
<a name="l06678"></a>06678                             $brd[$newkey] = $style;
<a name="l06679"></a>06679                         }
<a name="l06680"></a>06680                         unset($brd[$border]);
<a name="l06681"></a>06681                         $border = $newkey;
<a name="l06682"></a>06682                     }
<a name="l06683"></a>06683                     <span class="keywordflow">if</span> (strpos($border, <span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l06684"></a>06684                         <span class="comment">// remove bottom line</span>
<a name="l06685"></a>06685                         $newkey = str_replace(<span class="charliteral">&#39;T&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $border);
<a name="l06686"></a>06686                         <span class="keywordflow">if</span> (strlen($newkey) &gt; 0) {
<a name="l06687"></a>06687                             $brd[$newkey] = $style;
<a name="l06688"></a>06688                         }
<a name="l06689"></a>06689                         unset($brd[$border]);
<a name="l06690"></a>06690                     }
<a name="l06691"></a>06691                     <span class="keywordflow">break</span>;
<a name="l06692"></a>06692                 }
<a name="l06693"></a>06693                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;end&#39;</span>: {
<a name="l06694"></a>06694                     <span class="keywordflow">if</span> (strpos($border, <span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l06695"></a>06695                         <span class="comment">// remove bottom line</span>
<a name="l06696"></a>06696                         $newkey = str_replace(<span class="charliteral">&#39;T&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $border);
<a name="l06697"></a>06697                         <span class="keywordflow">if</span> (strlen($newkey) &gt; 0) {
<a name="l06698"></a>06698                             $brd[$newkey] = $style;
<a name="l06699"></a>06699                         }
<a name="l06700"></a>06700                         unset($brd[$border]);
<a name="l06701"></a>06701                     }
<a name="l06702"></a>06702                     <span class="keywordflow">break</span>;
<a name="l06703"></a>06703                 }
<a name="l06704"></a>06704             }
<a name="l06705"></a>06705         }
<a name="l06706"></a>06706         <span class="keywordflow">return</span> $brd;
<a name="l06707"></a>06707     }
<a name="l06708"></a>06708 <span class="comment"></span>
<a name="l06709"></a>06709 <span class="comment">    /**</span>
<a name="l06710"></a>06710 <span class="comment">     * This method return the estimated number of lines for print a simple text string using Multicell() method.</span>
<a name="l06711"></a>06711 <span class="comment">     * @param $txt (string) String for calculating his height</span>
<a name="l06712"></a>06712 <span class="comment">     * @param $w (float) Width of cells. If 0, they extend up to the right margin of the page.</span>
<a name="l06713"></a>06713 <span class="comment">     * @param $reseth (boolean) if true reset the last cell height (default false).</span>
<a name="l06714"></a>06714 <span class="comment">     * @param $autopadding (boolean) if true, uses internal padding and automatically adjust it to account for line width (default true).</span>
<a name="l06715"></a>06715 <span class="comment">     * @param $cellpadding (float) Internal cell padding, if empty uses default cell padding.</span>
<a name="l06716"></a>06716 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l06717"></a>06717 <span class="comment">     * @return float Return the minimal height needed for multicell method for printing the $txt param.</span>
<a name="l06718"></a>06718 <span class="comment">     * @author Alexander Escalona Fernández, Nicola Asuni</span>
<a name="l06719"></a>06719 <span class="comment">     * @public</span>
<a name="l06720"></a>06720 <span class="comment">     * @since 4.5.011</span>
<a name="l06721"></a>06721 <span class="comment">     */</span>
<a name="l06722"></a><a class="code" href="classTCPDF.html#af5cab8b0e1e29a3ee19a14007e37bd99">06722</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af5cab8b0e1e29a3ee19a14007e37bd99" title="This method return the estimated number of lines for print a simple text string using Multicell() met...">getNumLines</a>($txt, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>=0, $reseth=<span class="keyword">false</span>, $autopadding=<span class="keyword">true</span>, $cellpadding=<span class="stringliteral">&#39;&#39;</span>, $border=0) {
<a name="l06723"></a>06723         <span class="keywordflow">if</span> ($txt === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l06724"></a>06724             <span class="comment">// empty string</span>
<a name="l06725"></a>06725             <span class="keywordflow">return</span> 1;
<a name="l06726"></a>06726         }
<a name="l06727"></a>06727         <span class="comment">// adjust internal padding</span>
<a name="l06728"></a>06728         $prev_cell_padding = $this-&gt;cell_padding;
<a name="l06729"></a>06729         $prev_lasth = $this-&gt;lasth;
<a name="l06730"></a>06730         <span class="keywordflow">if</span> (is_array($cellpadding)) {
<a name="l06731"></a>06731             $this-&gt;cell_padding = $cellpadding;
<a name="l06732"></a>06732         }
<a name="l06733"></a>06733         $this-&gt;<a class="code" href="classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4" title="Adjust the internal Cell padding array to take account of the line width.">adjustCellPadding</a>($border);
<a name="l06734"></a>06734         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) OR (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> &lt;= 0)) {
<a name="l06735"></a>06735             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06736"></a>06736                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;x - $this-&gt;lMargin;
<a name="l06737"></a>06737             } <span class="keywordflow">else</span> {
<a name="l06738"></a>06738                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;
<a name="l06739"></a>06739             }
<a name="l06740"></a>06740         }
<a name="l06741"></a>06741         $wmax = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06742"></a>06742         <span class="keywordflow">if</span> ($reseth) {
<a name="l06743"></a>06743             <span class="comment">// reset row height</span>
<a name="l06744"></a>06744             $this-&gt;<a class="code" href="classTCPDF.html#a10215105777b306528a827f3669e936e" title="Reset the last cell height.">resetLastH</a>();
<a name="l06745"></a>06745         }
<a name="l06746"></a>06746         $lines = 1;
<a name="l06747"></a>06747         $sum = 0;
<a name="l06748"></a>06748         $chars = $this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>($this-&gt;<a class="code" href="classTCPDF.html#a35a90a2cd5b8ab143d978128a21de09e" title="Converts UTF-8 strings to codepoints array.">UTF8StringToArray</a>($txt), $txt, $this-&gt;tmprtl);
<a name="l06749"></a>06749         $charsWidth = $this-&gt;<a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($chars, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>);
<a name="l06750"></a>06750         $length = count($chars);
<a name="l06751"></a>06751         $lastSeparator = -1;
<a name="l06752"></a>06752         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $length; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l06753"></a>06753             $charWidth = $charsWidth[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l06754"></a>06754             <span class="keywordflow">if</span> (preg_match($this-&gt;re_spaces, $this-&gt;<a class="code" href="classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b" title="Returns the unicode caracter specified by UTF-8 value.">unichr</a>($chars[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]))) {
<a name="l06755"></a>06755                 $lastSeparator = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l06756"></a>06756             }
<a name="l06757"></a>06757             <span class="keywordflow">if</span> ((($sum + $charWidth) &gt; $wmax) OR ($chars[$i] == 10)) {
<a name="l06758"></a>06758                 ++$lines;
<a name="l06759"></a>06759                 <span class="keywordflow">if</span> ($chars[$i] == 10) {
<a name="l06760"></a>06760                     $lastSeparator = -1;
<a name="l06761"></a>06761                     $sum = 0;
<a name="l06762"></a>06762                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($lastSeparator != -1) {
<a name="l06763"></a>06763                     $i = $lastSeparator;
<a name="l06764"></a>06764                     $lastSeparator = -1;
<a name="l06765"></a>06765                     $sum = 0;
<a name="l06766"></a>06766                 } <span class="keywordflow">else</span> {
<a name="l06767"></a>06767                     $sum = $charWidth;
<a name="l06768"></a>06768                 }
<a name="l06769"></a>06769             } <span class="keywordflow">else</span> {
<a name="l06770"></a>06770                 $sum += $charWidth;
<a name="l06771"></a>06771             }
<a name="l06772"></a>06772         }
<a name="l06773"></a>06773         <span class="keywordflow">if</span> ($chars[($length - 1)] == 10) {
<a name="l06774"></a>06774             --$lines;
<a name="l06775"></a>06775         }
<a name="l06776"></a>06776         $this-&gt;cell_padding = $prev_cell_padding;
<a name="l06777"></a>06777         $this-&gt;lasth = $prev_lasth;
<a name="l06778"></a>06778         <span class="keywordflow">return</span> $lines;
<a name="l06779"></a>06779     }
<a name="l06780"></a>06780 <span class="comment"></span>
<a name="l06781"></a>06781 <span class="comment">    /**</span>
<a name="l06782"></a>06782 <span class="comment">     * This method return the estimated height needed for printing a simple text string using the Multicell() method.</span>
<a name="l06783"></a>06783 <span class="comment">     * Generally, if you want to know the exact height for a block of content you can use the following alternative technique:</span>
<a name="l06784"></a>06784 <span class="comment">     * @pre</span>
<a name="l06785"></a>06785 <span class="comment">     *  // store current object</span>
<a name="l06786"></a>06786 <span class="comment">     *  $pdf-&gt;startTransaction();</span>
<a name="l06787"></a>06787 <span class="comment">     *  // store starting values</span>
<a name="l06788"></a>06788 <span class="comment">     *  $start_y = $pdf-&gt;GetY();</span>
<a name="l06789"></a>06789 <span class="comment">     *  $start_page = $pdf-&gt;getPage();</span>
<a name="l06790"></a>06790 <span class="comment">     *  // call your printing functions with your parameters</span>
<a name="l06791"></a>06791 <span class="comment">     *  // - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<a name="l06792"></a>06792 <span class="comment">     *  $pdf-&gt;MultiCell($w=0, $h=0, $txt, $border=1, $align=&#39;L&#39;, $fill=false, $ln=1, $x=&#39;&#39;, $y=&#39;&#39;, $reseth=true, $stretch=0, $ishtml=false, $autopadding=true, $maxh=0);</span>
<a name="l06793"></a>06793 <span class="comment">     *  // - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<a name="l06794"></a>06794 <span class="comment">     *  // get the new Y</span>
<a name="l06795"></a>06795 <span class="comment">     *  $end_y = $pdf-&gt;GetY();</span>
<a name="l06796"></a>06796 <span class="comment">     *  $end_page = $pdf-&gt;getPage();</span>
<a name="l06797"></a>06797 <span class="comment">     *  // calculate height</span>
<a name="l06798"></a>06798 <span class="comment">     *  $height = 0;</span>
<a name="l06799"></a>06799 <span class="comment">     *  if ($end_page == $start_page) {</span>
<a name="l06800"></a>06800 <span class="comment">     *      $height = $end_y - $start_y;</span>
<a name="l06801"></a>06801 <span class="comment">     *  } else {</span>
<a name="l06802"></a>06802 <span class="comment">     *      for ($page=$start_page; $page &lt;= $end_page; ++$page) {</span>
<a name="l06803"></a>06803 <span class="comment">     *          $this-&gt;setPage($page);</span>
<a name="l06804"></a>06804 <span class="comment">     *          if ($page == $start_page) {</span>
<a name="l06805"></a>06805 <span class="comment">     *              // first page</span>
<a name="l06806"></a>06806 <span class="comment">     *              $height = $this-&gt;h - $start_y - $this-&gt;bMargin;</span>
<a name="l06807"></a>06807 <span class="comment">     *          } elseif ($page == $end_page) {</span>
<a name="l06808"></a>06808 <span class="comment">     *              // last page</span>
<a name="l06809"></a>06809 <span class="comment">     *              $height = $end_y - $this-&gt;tMargin;</span>
<a name="l06810"></a>06810 <span class="comment">     *          } else {</span>
<a name="l06811"></a>06811 <span class="comment">     *              $height = $this-&gt;h - $this-&gt;tMargin - $this-&gt;bMargin;</span>
<a name="l06812"></a>06812 <span class="comment">     *          }</span>
<a name="l06813"></a>06813 <span class="comment">     *      }</span>
<a name="l06814"></a>06814 <span class="comment">     *  }</span>
<a name="l06815"></a>06815 <span class="comment">     *  // restore previous object</span>
<a name="l06816"></a>06816 <span class="comment">     *  $pdf = $pdf-&gt;rollbackTransaction();</span>
<a name="l06817"></a>06817 <span class="comment">     *</span>
<a name="l06818"></a>06818 <span class="comment">     * @param $w (float) Width of cells. If 0, they extend up to the right margin of the page.</span>
<a name="l06819"></a>06819 <span class="comment">     * @param $txt (string) String for calculating his height</span>
<a name="l06820"></a>06820 <span class="comment">     * @param $reseth (boolean) if true reset the last cell height (default false).</span>
<a name="l06821"></a>06821 <span class="comment">     * @param $autopadding (boolean) if true, uses internal padding and automatically adjust it to account for line width (default true).</span>
<a name="l06822"></a>06822 <span class="comment">     * @param $cellpadding (float) Internal cell padding, if empty uses default cell padding.</span>
<a name="l06823"></a>06823 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l06824"></a>06824 <span class="comment">     * @return float Return the minimal height needed for multicell method for printing the $txt param.</span>
<a name="l06825"></a>06825 <span class="comment">     * @author Nicola Asuni, Alexander Escalona Fernández</span>
<a name="l06826"></a>06826 <span class="comment">     * @public</span>
<a name="l06827"></a>06827 <span class="comment">     */</span>
<a name="l06828"></a><a class="code" href="classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9">06828</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9" title="This method return the estimated height needed for printing a simple text string using the Multicell(...">getStringHeight</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, $txt, $reseth=<span class="keyword">false</span>, $autopadding=<span class="keyword">true</span>, $cellpadding=<span class="stringliteral">&#39;&#39;</span>, $border=0) {
<a name="l06829"></a>06829         <span class="comment">// adjust internal padding</span>
<a name="l06830"></a>06830         $prev_cell_padding = $this-&gt;cell_padding;
<a name="l06831"></a>06831         $prev_lasth = $this-&gt;lasth;
<a name="l06832"></a>06832         <span class="keywordflow">if</span> (is_array($cellpadding)) {
<a name="l06833"></a>06833             $this-&gt;cell_padding = $cellpadding;
<a name="l06834"></a>06834         }
<a name="l06835"></a>06835         $this-&gt;<a class="code" href="classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4" title="Adjust the internal Cell padding array to take account of the line width.">adjustCellPadding</a>($border);
<a name="l06836"></a>06836         $lines = $this-&gt;<a class="code" href="classTCPDF.html#af5cab8b0e1e29a3ee19a14007e37bd99" title="This method return the estimated number of lines for print a simple text string using Multicell() met...">getNumLines</a>($txt, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, $reseth, $autopadding, $cellpadding, $border);
<a name="l06837"></a>06837         $height = $lines * ($this-&gt;FontSize * $this-&gt;cell_height_ratio);
<a name="l06838"></a>06838         <span class="keywordflow">if</span> ($autopadding) {
<a name="l06839"></a>06839             <span class="comment">// add top and bottom padding</span>
<a name="l06840"></a>06840             $height += ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>]);
<a name="l06841"></a>06841         }
<a name="l06842"></a>06842         $this-&gt;cell_padding = $prev_cell_padding;
<a name="l06843"></a>06843         $this-&gt;lasth = $prev_lasth;
<a name="l06844"></a>06844         <span class="keywordflow">return</span> $height;
<a name="l06845"></a>06845     }
<a name="l06846"></a>06846 <span class="comment"></span>
<a name="l06847"></a>06847 <span class="comment">    /**</span>
<a name="l06848"></a>06848 <span class="comment">     * This method prints text from the current position.&lt;br /&gt;</span>
<a name="l06849"></a>06849 <span class="comment">     * @param $h (float) Line height</span>
<a name="l06850"></a>06850 <span class="comment">     * @param $txt (string) String to print</span>
<a name="l06851"></a>06851 <span class="comment">     * @param $link (mixed) URL or identifier returned by AddLink()</span>
<a name="l06852"></a>06852 <span class="comment">     * @param $fill (boolean) Indicates if the cell background must be painted (true) or transparent (false).</span>
<a name="l06853"></a>06853 <span class="comment">     * @param $align (string) Allows to center or align the text. Possible values are:&lt;ul&gt;&lt;li&gt;L or empty string: left align (default value)&lt;/li&gt;&lt;li&gt;C: center&lt;/li&gt;&lt;li&gt;R: right align&lt;/li&gt;&lt;li&gt;J: justify&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l06854"></a>06854 <span class="comment">     * @param $ln (boolean) if true set cursor at the bottom of the line, otherwise set cursor at the top of the line.</span>
<a name="l06855"></a>06855 <span class="comment">     * @param $stretch (int) font stretch mode: &lt;ul&gt;&lt;li&gt;0 = disabled&lt;/li&gt;&lt;li&gt;1 = horizontal scaling only if text is larger than cell width&lt;/li&gt;&lt;li&gt;2 = forced horizontal scaling to fit cell width&lt;/li&gt;&lt;li&gt;3 = character spacing only if text is larger than cell width&lt;/li&gt;&lt;li&gt;4 = forced character spacing to fit cell width&lt;/li&gt;&lt;/ul&gt; General font stretching and scaling values will be preserved when possible.</span>
<a name="l06856"></a>06856 <span class="comment">     * @param $firstline (boolean) if true prints only the first line and return the remaining string.</span>
<a name="l06857"></a>06857 <span class="comment">     * @param $firstblock (boolean) if true the string is the starting of a line.</span>
<a name="l06858"></a>06858 <span class="comment">     * @param $maxh (float) maximum height. The remaining unprinted text will be returned. It should be &gt;= $h and less than remaining space to the bottom of the page, or 0 for disable this feature.</span>
<a name="l06859"></a>06859 <span class="comment">     * @param $wadj (float) first line width will be reduced by this amount (used in HTML mode).</span>
<a name="l06860"></a>06860 <span class="comment">     * @param $margin (array) margin array of the parent container</span>
<a name="l06861"></a>06861 <span class="comment">     * @return mixed Return the number of cells or the remaining string if $firstline = true.</span>
<a name="l06862"></a>06862 <span class="comment">     * @public</span>
<a name="l06863"></a>06863 <span class="comment">     * @since 1.5</span>
<a name="l06864"></a>06864 <span class="comment">     */</span>
<a name="l06865"></a><a class="code" href="classTCPDF.html#a6669ae88090963e9487d0388c7577dc9">06865</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6669ae88090963e9487d0388c7577dc9" title="This method prints text from the current position.">Write</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $txt, $link=<span class="stringliteral">&#39;&#39;</span>, $fill=<span class="keyword">false</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $ln=<span class="keyword">false</span>, $stretch=0, $firstline=<span class="keyword">false</span>, $firstblock=<span class="keyword">false</span>, $maxh=0, $wadj=0, $margin=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l06866"></a>06866         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l06867"></a>06867         list($this-&gt;x, $this-&gt;y) = $this-&gt;<a class="code" href="classTCPDF.html#a1d99e81697a90efb13a6734001427f40" title="Check page for no-write regions and adapt current coordinates and page margins if necessary...">checkPageRegions</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $this-&gt;x, $this-&gt;y);
<a name="l06868"></a>06868         <span class="keywordflow">if</span> (strlen($txt) == 0) {
<a name="l06869"></a>06869             <span class="comment">// fix empty text</span>
<a name="l06870"></a>06870             $txt = <span class="charliteral">&#39; &#39;</span>;
<a name="l06871"></a>06871         }
<a name="l06872"></a>06872         <span class="keywordflow">if</span> ($margin === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l06873"></a>06873             <span class="comment">// set default margins</span>
<a name="l06874"></a>06874             $margin = $this-&gt;cell_margin;
<a name="l06875"></a>06875         }
<a name="l06876"></a>06876         <span class="comment">// remove carriage returns</span>
<a name="l06877"></a>06877         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, $txt);
<a name="l06878"></a>06878         <span class="comment">// check if string contains arabic text</span>
<a name="l06879"></a>06879         <span class="keywordflow">if</span> (preg_match($this-&gt;unicode-&gt;uni_RE_PATTERN_ARABIC, <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>)) {
<a name="l06880"></a>06880             $arabic = <span class="keyword">true</span>;
<a name="l06881"></a>06881         } <span class="keywordflow">else</span> {
<a name="l06882"></a>06882             $arabic = <span class="keyword">false</span>;
<a name="l06883"></a>06883         }
<a name="l06884"></a>06884         <span class="comment">// check if string contains RTL text</span>
<a name="l06885"></a>06885         <span class="keywordflow">if</span> ($arabic OR ($this-&gt;tmprtl == <span class="charliteral">&#39;R&#39;</span>) OR preg_match($this-&gt;unicode-&gt;uni_RE_PATTERN_RTL, <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>)) {
<a name="l06886"></a>06886             $rtlmode = <span class="keyword">true</span>;
<a name="l06887"></a>06887         } <span class="keywordflow">else</span> {
<a name="l06888"></a>06888             $rtlmode = <span class="keyword">false</span>;
<a name="l06889"></a>06889         }
<a name="l06890"></a>06890         <span class="comment">// get a char width</span>
<a name="l06891"></a>06891         $chrwidth = $this-&gt;<a class="code" href="classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4" title="Returns the length of the char in user unit for the current font considering current stretching and s...">GetCharWidth</a>(46); <span class="comment">// dot character</span>
<a name="l06892"></a>06892         <span class="comment">// get array of unicode values</span>
<a name="l06893"></a>06893         $chars = $this-&gt;<a class="code" href="classTCPDF.html#a35a90a2cd5b8ab143d978128a21de09e" title="Converts UTF-8 strings to codepoints array.">UTF8StringToArray</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l06894"></a>06894         <span class="comment">// get array of chars</span>
<a name="l06895"></a>06895         $uchars = $this-&gt;<a class="code" href="classTCPDF.html#aa40ab5a75479522984c27da10a4608ed" title="Convert an array of UTF8 values to array of unicode characters.">UTF8ArrayToUniArray</a>($chars);
<a name="l06896"></a>06896         <span class="comment">// get the number of characters</span>
<a name="l06897"></a>06897         $nb = count($chars);
<a name="l06898"></a>06898         <span class="comment">// replacement for SHY character (minus symbol)</span>
<a name="l06899"></a>06899         $shy_replacement = 45;
<a name="l06900"></a>06900         $shy_replacement_char = $this-&gt;<a class="code" href="classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b" title="Returns the unicode caracter specified by UTF-8 value.">unichr</a>($shy_replacement);
<a name="l06901"></a>06901         <span class="comment">// widht for SHY replacement</span>
<a name="l06902"></a>06902         $shy_replacement_width = $this-&gt;<a class="code" href="classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4" title="Returns the length of the char in user unit for the current font considering current stretching and s...">GetCharWidth</a>($shy_replacement);
<a name="l06903"></a>06903         <span class="comment">// max Y</span>
<a name="l06904"></a>06904         $maxy = $this-&gt;y + $maxh - <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>];
<a name="l06905"></a>06905         <span class="comment">// page width</span>
<a name="l06906"></a>06906         $pw = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin;
<a name="l06907"></a>06907         <span class="comment">// calculate remaining line width ($w)</span>
<a name="l06908"></a>06908         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06909"></a>06909             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;x - $this-&gt;lMargin;
<a name="l06910"></a>06910         } <span class="keywordflow">else</span> {
<a name="l06911"></a>06911             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;
<a name="l06912"></a>06912         }
<a name="l06913"></a>06913         <span class="comment">// max column width</span>
<a name="l06914"></a>06914         $wmax = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $wadj;
<a name="l06915"></a>06915         <span class="keywordflow">if</span> (!$firstline) {
<a name="l06916"></a>06916             $wmax -= ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]);
<a name="l06917"></a>06917         }
<a name="l06918"></a>06918         <span class="keywordflow">if</span> ((!$firstline) AND (($chrwidth &gt; $wmax) OR ($this-&gt;<a class="code" href="classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4" title="Returns the length of the char in user unit for the current font considering current stretching and s...">GetCharWidth</a>($chars[0]) &gt; $wmax))) {
<a name="l06919"></a>06919             <span class="comment">// a single character do not fit on column</span>
<a name="l06920"></a>06920             <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l06921"></a>06921         }
<a name="l06922"></a>06922         <span class="comment">// minimum row height</span>
<a name="l06923"></a>06923         $row_height = max(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $this-&gt;FontSize * $this-&gt;cell_height_ratio);
<a name="l06924"></a>06924         $start_page = $this-&gt;page;
<a name="l06925"></a>06925         <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <span class="comment">// character position</span>
<a name="l06926"></a>06926         $j = 0; <span class="comment">// current starting position</span>
<a name="l06927"></a>06927         <a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> = -1; <span class="comment">// position of the last blank space</span>
<a name="l06928"></a>06928         $shy = <span class="keyword">false</span>; <span class="comment">// true if the last blank is a soft hypen (SHY)</span>
<a name="l06929"></a>06929         <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> = 0; <span class="comment">// current string length</span>
<a name="l06930"></a>06930         $nl = 0; <span class="comment">//number of lines</span>
<a name="l06931"></a>06931         $linebreak = <span class="keyword">false</span>;
<a name="l06932"></a>06932         $pc = 0; <span class="comment">// previous character</span>
<a name="l06933"></a>06933         <span class="comment">// for each character</span>
<a name="l06934"></a>06934         <span class="keywordflow">while</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $nb) {
<a name="l06935"></a>06935             <span class="keywordflow">if</span> (($maxh &gt; 0) AND ($this-&gt;y &gt;= $maxy) ) {
<a name="l06936"></a>06936                 <span class="keywordflow">break</span>;
<a name="l06937"></a>06937             }
<a name="l06938"></a>06938             <span class="comment">//Get the current character</span>
<a name="l06939"></a>06939             <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = $chars[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l06940"></a>06940             <span class="keywordflow">if</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> == 10) { <span class="comment">// 10 = &quot;\n&quot; = new line</span>
<a name="l06941"></a>06941                 <span class="comment">//Explicit line break</span>
<a name="l06942"></a>06942                 <span class="keywordflow">if</span> ($align == <span class="charliteral">&#39;J&#39;</span>) {
<a name="l06943"></a>06943                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06944"></a>06944                         $talign = <span class="charliteral">&#39;R&#39;</span>;
<a name="l06945"></a>06945                     } <span class="keywordflow">else</span> {
<a name="l06946"></a>06946                         $talign = <span class="charliteral">&#39;L&#39;</span>;
<a name="l06947"></a>06947                     }
<a name="l06948"></a>06948                 } <span class="keywordflow">else</span> {
<a name="l06949"></a>06949                     $talign = $align;
<a name="l06950"></a>06950                 }
<a name="l06951"></a>06951                 $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, $j, <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>);
<a name="l06952"></a>06952                 <span class="keywordflow">if</span> ($firstline) {
<a name="l06953"></a>06953                     $startx = $this-&gt;x;
<a name="l06954"></a>06954                     $tmparr = array_slice($chars, $j, (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> - $j));
<a name="l06955"></a>06955                     <span class="keywordflow">if</span> ($rtlmode) {
<a name="l06956"></a>06956                         $tmparr = $this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>($tmparr, $tmpstr, $this-&gt;tmprtl);
<a name="l06957"></a>06957                     }
<a name="l06958"></a>06958                     $linew = $this-&gt;<a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($tmparr);
<a name="l06959"></a>06959                     unset($tmparr);
<a name="l06960"></a>06960                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06961"></a>06961                         $this-&gt;endlinex = $startx - $linew;
<a name="l06962"></a>06962                     } <span class="keywordflow">else</span> {
<a name="l06963"></a>06963                         $this-&gt;endlinex = $startx + $linew;
<a name="l06964"></a>06964                     }
<a name="l06965"></a>06965                     <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $linew;
<a name="l06966"></a>06966                     $tmpcellpadding = $this-&gt;cell_padding;
<a name="l06967"></a>06967                     <span class="keywordflow">if</span> ($maxh == 0) {
<a name="l06968"></a>06968                         $this-&gt;<a class="code" href="classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1" title="Set the same internal Cell padding for top, right, bottom, left-.">SetCellPadding</a>(0);
<a name="l06969"></a>06969                     }
<a name="l06970"></a>06970                 }
<a name="l06971"></a>06971                 <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="classTCPDF.html#accba6f1471acb211de74e6b34107041d" title="Return the current temporary RTL status.">isRTLTextDir</a>()) {
<a name="l06972"></a>06972                     $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a" title="Right trim the input string.">stringRightTrim</a>($tmpstr);
<a name="l06973"></a>06973                 }
<a name="l06974"></a>06974                 <span class="comment">// Skip newlines at the begining of a page or column</span>
<a name="l06975"></a>06975                 <span class="keywordflow">if</span> (!empty($tmpstr) OR ($this-&gt;y &lt; ($this-&gt;PageBreakTrigger - $row_height))) {
<a name="l06976"></a>06976                     $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $tmpstr, 0, 1, $talign, $fill, $link, $stretch);
<a name="l06977"></a>06977                 }
<a name="l06978"></a>06978                 unset($tmpstr);
<a name="l06979"></a>06979                 <span class="keywordflow">if</span> ($firstline) {
<a name="l06980"></a>06980                     $this-&gt;cell_padding = $tmpcellpadding;
<a name="l06981"></a>06981                     <span class="keywordflow">return</span> ($this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>));
<a name="l06982"></a>06982                 }
<a name="l06983"></a>06983                 ++$nl;
<a name="l06984"></a>06984                 $j = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 1;
<a name="l06985"></a>06985                 <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> = 0;
<a name="l06986"></a>06986                 <a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> = -1;
<a name="l06987"></a>06987                 $shy = <span class="keyword">false</span>;
<a name="l06988"></a>06988                 <span class="comment">// account for margin changes</span>
<a name="l06989"></a>06989                 <span class="keywordflow">if</span> ((($this-&gt;y + $this-&gt;lasth) &gt; $this-&gt;PageBreakTrigger) AND ($this-&gt;<a class="code" href="classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c" title="Check if we are on the page body (excluding page header and footer).">inPageBody</a>())) {
<a name="l06990"></a>06990                     $this-&gt;<a class="code" href="classTCPDF.html#aa24046de2993933f62d60a2936a22970" title="Whenever a page break condition is met, the method is called, and the break is issued or not dependin...">AcceptPageBreak</a>();
<a name="l06991"></a>06991                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l06992"></a>06992                         $this-&gt;x -= $margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06993"></a>06993                     } <span class="keywordflow">else</span> {
<a name="l06994"></a>06994                         $this-&gt;x += $margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06995"></a>06995                     }
<a name="l06996"></a>06996                     $this-&gt;lMargin += $margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l06997"></a>06997                     $this-&gt;rMargin += $margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l06998"></a>06998                 }
<a name="l06999"></a>06999                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;<a class="code" href="classTCPDF.html#a56507b79d0b3c74332aaacc32dab873a" title="Returns the remaining width between the current position and margins.">getRemainingWidth</a>();
<a name="l07000"></a>07000                 $wmax = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l07001"></a>07001             } <span class="keywordflow">else</span> {
<a name="l07002"></a>07002                 <span class="comment">// 160 is the non-breaking space.</span>
<a name="l07003"></a>07003                 <span class="comment">// 173 is SHY (Soft Hypen).</span>
<a name="l07004"></a>07004                 <span class="comment">// \p{Z} or \p{Separator}: any kind of Unicode whitespace or invisible separator.</span>
<a name="l07005"></a>07005                 <span class="comment">// \p{Lo} or \p{Other_Letter}: a Unicode letter or ideograph that does not have lowercase and uppercase variants.</span>
<a name="l07006"></a>07006                 <span class="comment">// \p{Lo} is needed because Chinese characters are packed next to each other without spaces in between.</span>
<a name="l07007"></a>07007                 <span class="keywordflow">if</span> ((<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> != 160) AND ((<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> == 173) OR preg_match($this-&gt;re_spaces, $this-&gt;<a class="code" href="classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b" title="Returns the unicode caracter specified by UTF-8 value.">unichr</a>(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>)))) {
<a name="l07008"></a>07008                     <span class="comment">// update last blank space position</span>
<a name="l07009"></a>07009                     <a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l07010"></a>07010                     <span class="comment">// check if is a SHY</span>
<a name="l07011"></a>07011                     <span class="keywordflow">if</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> == 173) {
<a name="l07012"></a>07012                         $shy = <span class="keyword">true</span>;
<a name="l07013"></a>07013                         <span class="keywordflow">if</span> ($pc == 45) {
<a name="l07014"></a>07014                             $tmp_shy_replacement_width = 0;
<a name="l07015"></a>07015                             $tmp_shy_replacement_char = <span class="stringliteral">&#39;&#39;</span>;
<a name="l07016"></a>07016                         } <span class="keywordflow">else</span> {
<a name="l07017"></a>07017                             $tmp_shy_replacement_width = $shy_replacement_width;
<a name="l07018"></a>07018                             $tmp_shy_replacement_char = $shy_replacement_char;
<a name="l07019"></a>07019                         }
<a name="l07020"></a>07020                     } <span class="keywordflow">else</span> {
<a name="l07021"></a>07021                         $shy = <span class="keyword">false</span>;
<a name="l07022"></a>07022                     }
<a name="l07023"></a>07023                 }
<a name="l07024"></a>07024                 <span class="comment">// update string length</span>
<a name="l07025"></a>07025                 <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97" title="Return true if the current font is unicode type.">isUnicodeFont</a>() AND ($arabic)) {
<a name="l07026"></a>07026                     <span class="comment">// with bidirectional algorithm some chars may be changed affecting the line length</span>
<a name="l07027"></a>07027                     <span class="comment">// *** very slow ***</span>
<a name="l07028"></a>07028                     <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> = $this-&gt;<a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>(array_slice($chars, $j, (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> - $j)), <span class="stringliteral">&#39;&#39;</span>, $this-&gt;tmprtl));
<a name="l07029"></a>07029                 } <span class="keywordflow">else</span> {
<a name="l07030"></a>07030                     <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> += $this-&gt;<a class="code" href="classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4" title="Returns the length of the char in user unit for the current font considering current stretching and s...">GetCharWidth</a>(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>);
<a name="l07031"></a>07031                 }
<a name="l07032"></a>07032                 <span class="keywordflow">if</span> ((<a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> &gt; $wmax) OR ((<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> == 173) AND ((<a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> + $tmp_shy_replacement_width) &gt; $wmax)) ) {
<a name="l07033"></a>07033                     <span class="comment">// we have reached the end of column</span>
<a name="l07034"></a>07034                     <span class="keywordflow">if</span> (<a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> == -1) {
<a name="l07035"></a>07035                         <span class="comment">// check if the line was already started</span>
<a name="l07036"></a>07036                         <span class="keywordflow">if</span> (($this-&gt;rtl AND ($this-&gt;x &lt;= ($this-&gt;w - $this-&gt;rMargin - $chrwidth)))
<a name="l07037"></a>07037                             OR ((!$this-&gt;rtl) AND ($this-&gt;x &gt;= ($this-&gt;lMargin + $chrwidth)))) {
<a name="l07038"></a>07038                             <span class="comment">// print a void cell and go to next line</span>
<a name="l07039"></a>07039                             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;&#39;</span>, 0, 1);
<a name="l07040"></a>07040                             $linebreak = <span class="keyword">true</span>;
<a name="l07041"></a>07041                             <span class="keywordflow">if</span> ($firstline) {
<a name="l07042"></a>07042                                 <span class="keywordflow">return</span> ($this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, $j));
<a name="l07043"></a>07043                             }
<a name="l07044"></a>07044                         } <span class="keywordflow">else</span> {
<a name="l07045"></a>07045                             <span class="comment">// truncate the word because do not fit on column</span>
<a name="l07046"></a>07046                             $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, $j, <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>);
<a name="l07047"></a>07047                             <span class="keywordflow">if</span> ($firstline) {
<a name="l07048"></a>07048                                 $startx = $this-&gt;x;
<a name="l07049"></a>07049                                 $tmparr = array_slice($chars, $j, (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> - $j));
<a name="l07050"></a>07050                                 <span class="keywordflow">if</span> ($rtlmode) {
<a name="l07051"></a>07051                                     $tmparr = $this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>($tmparr, $tmpstr, $this-&gt;tmprtl);
<a name="l07052"></a>07052                                 }
<a name="l07053"></a>07053                                 $linew = $this-&gt;<a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($tmparr);
<a name="l07054"></a>07054                                 unset($tmparr);
<a name="l07055"></a>07055                                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07056"></a>07056                                     $this-&gt;endlinex = $startx - $linew;
<a name="l07057"></a>07057                                 } <span class="keywordflow">else</span> {
<a name="l07058"></a>07058                                     $this-&gt;endlinex = $startx + $linew;
<a name="l07059"></a>07059                                 }
<a name="l07060"></a>07060                                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $linew;
<a name="l07061"></a>07061                                 $tmpcellpadding = $this-&gt;cell_padding;
<a name="l07062"></a>07062                                 <span class="keywordflow">if</span> ($maxh == 0) {
<a name="l07063"></a>07063                                     $this-&gt;<a class="code" href="classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1" title="Set the same internal Cell padding for top, right, bottom, left-.">SetCellPadding</a>(0);
<a name="l07064"></a>07064                                 }
<a name="l07065"></a>07065                             }
<a name="l07066"></a>07066                             <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="classTCPDF.html#accba6f1471acb211de74e6b34107041d" title="Return the current temporary RTL status.">isRTLTextDir</a>()) {
<a name="l07067"></a>07067                                 $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a" title="Right trim the input string.">stringRightTrim</a>($tmpstr);
<a name="l07068"></a>07068                             }
<a name="l07069"></a>07069                             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $tmpstr, 0, 1, $align, $fill, $link, $stretch);
<a name="l07070"></a>07070                             unset($tmpstr);
<a name="l07071"></a>07071                             <span class="keywordflow">if</span> ($firstline) {
<a name="l07072"></a>07072                                 $this-&gt;cell_padding = $tmpcellpadding;
<a name="l07073"></a>07073                                 <span class="keywordflow">return</span> ($this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>));
<a name="l07074"></a>07074                             }
<a name="l07075"></a>07075                             $j = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l07076"></a>07076                             --<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l07077"></a>07077                         }
<a name="l07078"></a>07078                     } <span class="keywordflow">else</span> {
<a name="l07079"></a>07079                         <span class="comment">// word wrapping</span>
<a name="l07080"></a>07080                         <span class="keywordflow">if</span> ($this-&gt;rtl AND (!$firstblock) AND (<a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> &lt; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>)) {
<a name="l07081"></a>07081                             $endspace = 1;
<a name="l07082"></a>07082                         } <span class="keywordflow">else</span> {
<a name="l07083"></a>07083                             $endspace = 0;
<a name="l07084"></a>07084                         }
<a name="l07085"></a>07085                         <span class="comment">// check the length of the next string</span>
<a name="l07086"></a>07086                         $strrest = $this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, (<a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> + $endspace));
<a name="l07087"></a>07087                         $nextstr = preg_split(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $this-&gt;<a class="code" href="classTCPDF.html#abdc6aa462bc81023df2ec043742bcb4b" title="Trim the input string.">stringTrim</a>($strrest));
<a name="l07088"></a>07088                         <span class="keywordflow">if</span> (isset($nextstr[0]) AND ($this-&gt;<a class="code" href="classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9" title="Returns the length of a string in user unit.">GetStringWidth</a>($nextstr[0]) &gt; $pw)) {
<a name="l07089"></a>07089                             <span class="comment">// truncate the word because do not fit on a full page width</span>
<a name="l07090"></a>07090                             $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, $j, <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>);
<a name="l07091"></a>07091                             <span class="keywordflow">if</span> ($firstline) {
<a name="l07092"></a>07092                                 $startx = $this-&gt;x;
<a name="l07093"></a>07093                                 $tmparr = array_slice($chars, $j, (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> - $j));
<a name="l07094"></a>07094                                 <span class="keywordflow">if</span> ($rtlmode) {
<a name="l07095"></a>07095                                     $tmparr = $this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>($tmparr, $tmpstr, $this-&gt;tmprtl);
<a name="l07096"></a>07096                                 }
<a name="l07097"></a>07097                                 $linew = $this-&gt;<a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($tmparr);
<a name="l07098"></a>07098                                 unset($tmparr);
<a name="l07099"></a>07099                                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07100"></a>07100                                     $this-&gt;endlinex = $startx - $linew;
<a name="l07101"></a>07101                                 } <span class="keywordflow">else</span> {
<a name="l07102"></a>07102                                     $this-&gt;endlinex = $startx + $linew;
<a name="l07103"></a>07103                                 }
<a name="l07104"></a>07104                                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $linew;
<a name="l07105"></a>07105                                 $tmpcellpadding = $this-&gt;cell_padding;
<a name="l07106"></a>07106                                 <span class="keywordflow">if</span> ($maxh == 0) {
<a name="l07107"></a>07107                                     $this-&gt;<a class="code" href="classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1" title="Set the same internal Cell padding for top, right, bottom, left-.">SetCellPadding</a>(0);
<a name="l07108"></a>07108                                 }
<a name="l07109"></a>07109                             }
<a name="l07110"></a>07110                             <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="classTCPDF.html#accba6f1471acb211de74e6b34107041d" title="Return the current temporary RTL status.">isRTLTextDir</a>()) {
<a name="l07111"></a>07111                                 $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a" title="Right trim the input string.">stringRightTrim</a>($tmpstr);
<a name="l07112"></a>07112                             }
<a name="l07113"></a>07113                             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $tmpstr, 0, 1, $align, $fill, $link, $stretch);
<a name="l07114"></a>07114                             unset($tmpstr);
<a name="l07115"></a>07115                             <span class="keywordflow">if</span> ($firstline) {
<a name="l07116"></a>07116                                 $this-&gt;cell_padding = $tmpcellpadding;
<a name="l07117"></a>07117                                 <span class="keywordflow">return</span> ($this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>));
<a name="l07118"></a>07118                             }
<a name="l07119"></a>07119                             $j = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l07120"></a>07120                             --<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l07121"></a>07121                         } <span class="keywordflow">else</span> {
<a name="l07122"></a>07122                             <span class="comment">// word wrapping</span>
<a name="l07123"></a>07123                             <span class="keywordflow">if</span> ($shy) {
<a name="l07124"></a>07124                                 <span class="comment">// add hypen (minus symbol) at the end of the line</span>
<a name="l07125"></a>07125                                 $shy_width = $tmp_shy_replacement_width;
<a name="l07126"></a>07126                                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07127"></a>07127                                     $shy_char_left = $tmp_shy_replacement_char;
<a name="l07128"></a>07128                                     $shy_char_right = <span class="stringliteral">&#39;&#39;</span>;
<a name="l07129"></a>07129                                 } <span class="keywordflow">else</span> {
<a name="l07130"></a>07130                                     $shy_char_left = <span class="stringliteral">&#39;&#39;</span>;
<a name="l07131"></a>07131                                     $shy_char_right = $tmp_shy_replacement_char;
<a name="l07132"></a>07132                                 }
<a name="l07133"></a>07133                             } <span class="keywordflow">else</span> {
<a name="l07134"></a>07134                                 $shy_width = 0;
<a name="l07135"></a>07135                                 $shy_char_left = <span class="stringliteral">&#39;&#39;</span>;
<a name="l07136"></a>07136                                 $shy_char_right = <span class="stringliteral">&#39;&#39;</span>;
<a name="l07137"></a>07137                             }
<a name="l07138"></a>07138                             $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, $j, (<a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> + $endspace));
<a name="l07139"></a>07139                             <span class="keywordflow">if</span> ($firstline) {
<a name="l07140"></a>07140                                 $startx = $this-&gt;x;
<a name="l07141"></a>07141                                 $tmparr = array_slice($chars, $j, ((<a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> + $endspace) - $j));
<a name="l07142"></a>07142                                 <span class="keywordflow">if</span> ($rtlmode) {
<a name="l07143"></a>07143                                     $tmparr = $this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>($tmparr, $tmpstr, $this-&gt;tmprtl);
<a name="l07144"></a>07144                                 }
<a name="l07145"></a>07145                                 $linew = $this-&gt;<a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($tmparr);
<a name="l07146"></a>07146                                 unset($tmparr);
<a name="l07147"></a>07147                                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07148"></a>07148                                     $this-&gt;endlinex = $startx - $linew - $shy_width;
<a name="l07149"></a>07149                                 } <span class="keywordflow">else</span> {
<a name="l07150"></a>07150                                     $this-&gt;endlinex = $startx + $linew + $shy_width;
<a name="l07151"></a>07151                                 }
<a name="l07152"></a>07152                                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $linew;
<a name="l07153"></a>07153                                 $tmpcellpadding = $this-&gt;cell_padding;
<a name="l07154"></a>07154                                 <span class="keywordflow">if</span> ($maxh == 0) {
<a name="l07155"></a>07155                                     $this-&gt;<a class="code" href="classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1" title="Set the same internal Cell padding for top, right, bottom, left-.">SetCellPadding</a>(0);
<a name="l07156"></a>07156                                 }
<a name="l07157"></a>07157                             }
<a name="l07158"></a>07158                             <span class="comment">// print the line</span>
<a name="l07159"></a>07159                             <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="classTCPDF.html#accba6f1471acb211de74e6b34107041d" title="Return the current temporary RTL status.">isRTLTextDir</a>()) {
<a name="l07160"></a>07160                                 $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a" title="Right trim the input string.">stringRightTrim</a>($tmpstr);
<a name="l07161"></a>07161                             }
<a name="l07162"></a>07162                             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $shy_char_left.$tmpstr.$shy_char_right, 0, 1, $align, $fill, $link, $stretch);
<a name="l07163"></a>07163                             unset($tmpstr);
<a name="l07164"></a>07164                             <span class="keywordflow">if</span> ($firstline) {
<a name="l07165"></a>07165                                 <span class="comment">// return the remaining text</span>
<a name="l07166"></a>07166                                 $this-&gt;cell_padding = $tmpcellpadding;
<a name="l07167"></a>07167                                 <span class="keywordflow">return</span> ($this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, (<a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> + $endspace)));
<a name="l07168"></a>07168                             }
<a name="l07169"></a>07169                             <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = <a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a>;
<a name="l07170"></a>07170                             <a class="code" href="db__tracking_8php.html#a54e34e6b10207470ec30d82afeb75532">$sep</a> = -1;
<a name="l07171"></a>07171                             $shy = <span class="keyword">false</span>;
<a name="l07172"></a>07172                             $j = (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1);
<a name="l07173"></a>07173                         }
<a name="l07174"></a>07174                     }
<a name="l07175"></a>07175                     <span class="comment">// account for margin changes</span>
<a name="l07176"></a>07176                     <span class="keywordflow">if</span> ((($this-&gt;y + $this-&gt;lasth) &gt; $this-&gt;PageBreakTrigger) AND ($this-&gt;<a class="code" href="classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c" title="Check if we are on the page body (excluding page header and footer).">inPageBody</a>())) {
<a name="l07177"></a>07177                         $this-&gt;<a class="code" href="classTCPDF.html#aa24046de2993933f62d60a2936a22970" title="Whenever a page break condition is met, the method is called, and the break is issued or not dependin...">AcceptPageBreak</a>();
<a name="l07178"></a>07178                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07179"></a>07179                             $this-&gt;x -= $margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l07180"></a>07180                         } <span class="keywordflow">else</span> {
<a name="l07181"></a>07181                             $this-&gt;x += $margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l07182"></a>07182                         }
<a name="l07183"></a>07183                         $this-&gt;lMargin += $margin[<span class="charliteral">&#39;L&#39;</span>];
<a name="l07184"></a>07184                         $this-&gt;rMargin += $margin[<span class="charliteral">&#39;R&#39;</span>];
<a name="l07185"></a>07185                     }
<a name="l07186"></a>07186                     <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;<a class="code" href="classTCPDF.html#a56507b79d0b3c74332aaacc32dab873a" title="Returns the remaining width between the current position and margins.">getRemainingWidth</a>();
<a name="l07187"></a>07187                     $wmax = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l07188"></a>07188                     <span class="keywordflow">if</span> ($linebreak) {
<a name="l07189"></a>07189                         $linebreak = <span class="keyword">false</span>;
<a name="l07190"></a>07190                     } <span class="keywordflow">else</span> {
<a name="l07191"></a>07191                         ++$nl;
<a name="l07192"></a>07192                         <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> = 0;
<a name="l07193"></a>07193                     }
<a name="l07194"></a>07194                 }
<a name="l07195"></a>07195             }
<a name="l07196"></a>07196             <span class="comment">// save last character</span>
<a name="l07197"></a>07197             $pc = <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>;
<a name="l07198"></a>07198             ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l07199"></a>07199         } <span class="comment">// end while i &lt; nb</span>
<a name="l07200"></a>07200         <span class="comment">// print last substring (if any)</span>
<a name="l07201"></a>07201         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> &gt; 0) {
<a name="l07202"></a>07202             <span class="keywordflow">switch</span> ($align) {
<a name="l07203"></a>07203                 <span class="keywordflow">case</span> <span class="charliteral">&#39;J&#39;</span>:
<a name="l07204"></a>07204                 <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {
<a name="l07205"></a>07205                     <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07206"></a>07206                     <span class="keywordflow">break</span>;
<a name="l07207"></a>07207                 }
<a name="l07208"></a>07208                 <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {
<a name="l07209"></a>07209                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07210"></a>07210                         <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07211"></a>07211                     } <span class="keywordflow">else</span> {
<a name="l07212"></a>07212                         <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a>;
<a name="l07213"></a>07213                     }
<a name="l07214"></a>07214                     <span class="keywordflow">break</span>;
<a name="l07215"></a>07215                 }
<a name="l07216"></a>07216                 <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {
<a name="l07217"></a>07217                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07218"></a>07218                         <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a>;
<a name="l07219"></a>07219                     } <span class="keywordflow">else</span> {
<a name="l07220"></a>07220                         <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07221"></a>07221                     }
<a name="l07222"></a>07222                     <span class="keywordflow">break</span>;
<a name="l07223"></a>07223                 }
<a name="l07224"></a>07224                 <span class="keywordflow">default</span>: {
<a name="l07225"></a>07225                     <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a>;
<a name="l07226"></a>07226                     <span class="keywordflow">break</span>;
<a name="l07227"></a>07227                 }
<a name="l07228"></a>07228             }
<a name="l07229"></a>07229             $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, $j, $nb);
<a name="l07230"></a>07230             <span class="keywordflow">if</span> ($firstline) {
<a name="l07231"></a>07231                 $startx = $this-&gt;x;
<a name="l07232"></a>07232                 $tmparr = array_slice($chars, $j, ($nb - $j));
<a name="l07233"></a>07233                 <span class="keywordflow">if</span> ($rtlmode) {
<a name="l07234"></a>07234                     $tmparr = $this-&gt;<a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>($tmparr, $tmpstr, $this-&gt;tmprtl);
<a name="l07235"></a>07235                 }
<a name="l07236"></a>07236                 $linew = $this-&gt;<a class="code" href="classTCPDF.html#afe09291dfba7203e225a507e71e1d43e" title="Returns the string length of an array of chars in user unit or an array of characters widths...">GetArrStringWidth</a>($tmparr);
<a name="l07237"></a>07237                 unset($tmparr);
<a name="l07238"></a>07238                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07239"></a>07239                     $this-&gt;endlinex = $startx - $linew;
<a name="l07240"></a>07240                 } <span class="keywordflow">else</span> {
<a name="l07241"></a>07241                     $this-&gt;endlinex = $startx + $linew;
<a name="l07242"></a>07242                 }
<a name="l07243"></a>07243                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $linew;
<a name="l07244"></a>07244                 $tmpcellpadding = $this-&gt;cell_padding;
<a name="l07245"></a>07245                 <span class="keywordflow">if</span> ($maxh == 0) {
<a name="l07246"></a>07246                     $this-&gt;<a class="code" href="classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1" title="Set the same internal Cell padding for top, right, bottom, left-.">SetCellPadding</a>(0);
<a name="l07247"></a>07247                 }
<a name="l07248"></a>07248             }
<a name="l07249"></a>07249             <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="classTCPDF.html#accba6f1471acb211de74e6b34107041d" title="Return the current temporary RTL status.">isRTLTextDir</a>()) {
<a name="l07250"></a>07250                 $tmpstr = $this-&gt;<a class="code" href="classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a" title="Right trim the input string.">stringRightTrim</a>($tmpstr);
<a name="l07251"></a>07251             }
<a name="l07252"></a>07252             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, $tmpstr, 0, $ln, $align, $fill, $link, $stretch);
<a name="l07253"></a>07253             unset($tmpstr);
<a name="l07254"></a>07254             <span class="keywordflow">if</span> ($firstline) {
<a name="l07255"></a>07255                 $this-&gt;cell_padding = $tmpcellpadding;
<a name="l07256"></a>07256                 <span class="keywordflow">return</span> ($this-&gt;<a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uchars, $nb));
<a name="l07257"></a>07257             }
<a name="l07258"></a>07258             ++$nl;
<a name="l07259"></a>07259         }
<a name="l07260"></a>07260         <span class="keywordflow">if</span> ($firstline) {
<a name="l07261"></a>07261             <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l07262"></a>07262         }
<a name="l07263"></a>07263         <span class="keywordflow">return</span> $nl;
<a name="l07264"></a>07264     }
<a name="l07265"></a>07265 <span class="comment"></span>
<a name="l07266"></a>07266 <span class="comment">    /**</span>
<a name="l07267"></a>07267 <span class="comment">     * Returns the remaining width between the current position and margins.</span>
<a name="l07268"></a>07268 <span class="comment">     * @return int Return the remaining width</span>
<a name="l07269"></a>07269 <span class="comment">     * @protected</span>
<a name="l07270"></a>07270 <span class="comment">     */</span>
<a name="l07271"></a><a class="code" href="classTCPDF.html#a56507b79d0b3c74332aaacc32dab873a">07271</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a56507b79d0b3c74332aaacc32dab873a" title="Returns the remaining width between the current position and margins.">getRemainingWidth</a>() {
<a name="l07272"></a>07272         list($this-&gt;x, $this-&gt;y) = $this-&gt;<a class="code" href="classTCPDF.html#a1d99e81697a90efb13a6734001427f40" title="Check page for no-write regions and adapt current coordinates and page margins if necessary...">checkPageRegions</a>(0, $this-&gt;x, $this-&gt;y);
<a name="l07273"></a>07273         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07274"></a>07274             <span class="keywordflow">return</span> ($this-&gt;x - $this-&gt;lMargin);
<a name="l07275"></a>07275         } <span class="keywordflow">else</span> {
<a name="l07276"></a>07276             <span class="keywordflow">return</span> ($this-&gt;w - $this-&gt;rMargin - $this-&gt;x);
<a name="l07277"></a>07277         }
<a name="l07278"></a>07278     }
<a name="l07279"></a>07279 <span class="comment"></span>
<a name="l07280"></a>07280 <span class="comment">    /**</span>
<a name="l07281"></a>07281 <span class="comment">     * Extract a slice of the $strarr array and return it as string.</span>
<a name="l07282"></a>07282 <span class="comment">     * @param $strarr (string) The input array of characters.</span>
<a name="l07283"></a>07283 <span class="comment">     * @param $start (int) the starting element of $strarr.</span>
<a name="l07284"></a>07284 <span class="comment">     * @param $end (int) first element that will not be returned.</span>
<a name="l07285"></a>07285 <span class="comment">     * @return Return part of a string</span>
<a name="l07286"></a>07286 <span class="comment">     * @public</span>
<a name="l07287"></a>07287 <span class="comment">     */</span>
<a name="l07288"></a><a class="code" href="classTCPDF.html#a2f2fbad8719fbe519c781fd89d7c9e65">07288</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2f2fbad8719fbe519c781fd89d7c9e65" title="Extract a slice of the $strarr array and return it as string.">UTF8ArrSubString</a>($strarr, <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a>=<span class="stringliteral">&#39;&#39;</span>, $end=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l07289"></a>07289         <span class="keywordflow">if</span> (strlen(<a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a>) == 0) {
<a name="l07290"></a>07290             <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a> = 0;
<a name="l07291"></a>07291         }
<a name="l07292"></a>07292         <span class="keywordflow">if</span> (strlen($end) == 0) {
<a name="l07293"></a>07293             $end = count($strarr);
<a name="l07294"></a>07294         }
<a name="l07295"></a>07295         $string = <span class="stringliteral">&#39;&#39;</span>;
<a name="l07296"></a>07296         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=<a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a>; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $end; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l07297"></a>07297             $string .= $this-&gt;<a class="code" href="classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b" title="Returns the unicode caracter specified by UTF-8 value.">unichr</a>($strarr[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]);
<a name="l07298"></a>07298         }
<a name="l07299"></a>07299         <span class="keywordflow">return</span> $string;
<a name="l07300"></a>07300     }
<a name="l07301"></a>07301 <span class="comment"></span>
<a name="l07302"></a>07302 <span class="comment">    /**</span>
<a name="l07303"></a>07303 <span class="comment">     * Extract a slice of the $uniarr array and return it as string.</span>
<a name="l07304"></a>07304 <span class="comment">     * @param $uniarr (string) The input array of characters.</span>
<a name="l07305"></a>07305 <span class="comment">     * @param $start (int) the starting element of $strarr.</span>
<a name="l07306"></a>07306 <span class="comment">     * @param $end (int) first element that will not be returned.</span>
<a name="l07307"></a>07307 <span class="comment">     * @return Return part of a string</span>
<a name="l07308"></a>07308 <span class="comment">     * @public</span>
<a name="l07309"></a>07309 <span class="comment">     * @since 4.5.037 (2009-04-07)</span>
<a name="l07310"></a>07310 <span class="comment">     */</span>
<a name="l07311"></a><a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa">07311</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a11193998fe9c87092ed978f184998cfa" title="Extract a slice of the $uniarr array and return it as string.">UniArrSubString</a>($uniarr, <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a>=<span class="stringliteral">&#39;&#39;</span>, $end=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l07312"></a>07312         <span class="keywordflow">if</span> (strlen(<a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a>) == 0) {
<a name="l07313"></a>07313             <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a> = 0;
<a name="l07314"></a>07314         }
<a name="l07315"></a>07315         <span class="keywordflow">if</span> (strlen($end) == 0) {
<a name="l07316"></a>07316             $end = count($uniarr);
<a name="l07317"></a>07317         }
<a name="l07318"></a>07318         $string = <span class="stringliteral">&#39;&#39;</span>;
<a name="l07319"></a>07319         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=<a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a>; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $end; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l07320"></a>07320             $string .= $uniarr[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l07321"></a>07321         }
<a name="l07322"></a>07322         <span class="keywordflow">return</span> $string;
<a name="l07323"></a>07323     }
<a name="l07324"></a>07324 <span class="comment"></span>
<a name="l07325"></a>07325 <span class="comment">    /**</span>
<a name="l07326"></a>07326 <span class="comment">     * Convert an array of UTF8 values to array of unicode characters</span>
<a name="l07327"></a>07327 <span class="comment">     * @param $ta (string) The input array of UTF8 values.</span>
<a name="l07328"></a>07328 <span class="comment">     * @return Return array of unicode characters</span>
<a name="l07329"></a>07329 <span class="comment">     * @public</span>
<a name="l07330"></a>07330 <span class="comment">     * @since 4.5.037 (2009-04-07)</span>
<a name="l07331"></a>07331 <span class="comment">     */</span>
<a name="l07332"></a><a class="code" href="classTCPDF.html#aa40ab5a75479522984c27da10a4608ed">07332</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa40ab5a75479522984c27da10a4608ed" title="Convert an array of UTF8 values to array of unicode characters.">UTF8ArrayToUniArray</a>($ta) {
<a name="l07333"></a>07333         <span class="keywordflow">return</span> array_map(array($this, <span class="stringliteral">&#39;unichr&#39;</span>), $ta);
<a name="l07334"></a>07334     }
<a name="l07335"></a>07335 <span class="comment"></span>
<a name="l07336"></a>07336 <span class="comment">    /**</span>
<a name="l07337"></a>07337 <span class="comment">     * Returns the unicode caracter specified by UTF-8 value</span>
<a name="l07338"></a>07338 <span class="comment">     * @param $c (int) UTF-8 value</span>
<a name="l07339"></a>07339 <span class="comment">     * @return Returns the specified character.</span>
<a name="l07340"></a>07340 <span class="comment">     * @author Miguel Perez, Nicola Asuni</span>
<a name="l07341"></a>07341 <span class="comment">     * @public</span>
<a name="l07342"></a>07342 <span class="comment">     * @since 2.3.000 (2008-03-05)</span>
<a name="l07343"></a>07343 <span class="comment">     */</span>
<a name="l07344"></a><a class="code" href="classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b">07344</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b" title="Returns the unicode caracter specified by UTF-8 value.">unichr</a>(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l07345"></a>07345         <span class="keywordflow">if</span> (!$this-&gt;isunicode) {
<a name="l07346"></a>07346             <span class="keywordflow">return</span> chr(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>);
<a name="l07347"></a>07347         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt;= 0x7F) {
<a name="l07348"></a>07348             <span class="comment">// one byte</span>
<a name="l07349"></a>07349             <span class="keywordflow">return</span> chr(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>);
<a name="l07350"></a>07350         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt;= 0x7FF) {
<a name="l07351"></a>07351             <span class="comment">// two bytes</span>
<a name="l07352"></a>07352             <span class="keywordflow">return</span> chr(0xC0 | <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &gt;&gt; 6).chr(0x80 | <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &amp; 0x3F);
<a name="l07353"></a>07353         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt;= 0xFFFF) {
<a name="l07354"></a>07354             <span class="comment">// three bytes</span>
<a name="l07355"></a>07355             <span class="keywordflow">return</span> chr(0xE0 | <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &gt;&gt; 12).chr(0x80 | <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &gt;&gt; 6 &amp; 0x3F).chr(0x80 | <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &amp; 0x3F);
<a name="l07356"></a>07356         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt;= 0x10FFFF) {
<a name="l07357"></a>07357             <span class="comment">// four bytes</span>
<a name="l07358"></a>07358             <span class="keywordflow">return</span> chr(0xF0 | <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &gt;&gt; 18).chr(0x80 | <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &gt;&gt; 12 &amp; 0x3F).chr(0x80 | <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &gt;&gt; 6 &amp; 0x3F).chr(0x80 | <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &amp; 0x3F);
<a name="l07359"></a>07359         } <span class="keywordflow">else</span> {
<a name="l07360"></a>07360             <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l07361"></a>07361         }
<a name="l07362"></a>07362     }
<a name="l07363"></a>07363 <span class="comment"></span>
<a name="l07364"></a>07364 <span class="comment">    /**</span>
<a name="l07365"></a>07365 <span class="comment">     * Return the image type given the file name or array returned by getimagesize() function.</span>
<a name="l07366"></a>07366 <span class="comment">     * @param $imgfile (string) image file name</span>
<a name="l07367"></a>07367 <span class="comment">     * @param $iminfo (array) array of image information returned by getimagesize() function.</span>
<a name="l07368"></a>07368 <span class="comment">     * @return string image type</span>
<a name="l07369"></a>07369 <span class="comment">     * @since 4.8.017 (2009-11-27)</span>
<a name="l07370"></a>07370 <span class="comment">     */</span>
<a name="l07371"></a><a class="code" href="classTCPDF.html#a69d6b919e84ff00a19e750efd29fba18">07371</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a69d6b919e84ff00a19e750efd29fba18" title="Return the image type given the file name or array returned by getimagesize() function.">getImageFileType</a>(<a class="code" href="thumbnail_8php.html#a8dbfd6149875dfa452769eb3dade31b5">$imgfile</a>, $iminfo=array()) {
<a name="l07372"></a>07372         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l07373"></a>07373         <span class="keywordflow">if</span> (isset($iminfo[<span class="stringliteral">&#39;mime&#39;</span>]) AND !empty($iminfo[<span class="stringliteral">&#39;mime&#39;</span>])) {
<a name="l07374"></a>07374             $mime = explode(<span class="charliteral">&#39;/&#39;</span>, $iminfo[<span class="stringliteral">&#39;mime&#39;</span>]);
<a name="l07375"></a>07375             <span class="keywordflow">if</span> ((count($mime) &gt; 1) AND ($mime[0] == <span class="stringliteral">&#39;image&#39;</span>) AND (!empty($mime[1]))) {
<a name="l07376"></a>07376                 <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = strtolower(trim($mime[1]));
<a name="l07377"></a>07377             }
<a name="l07378"></a>07378         }
<a name="l07379"></a>07379         <span class="keywordflow">if</span> (empty(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>)) {
<a name="l07380"></a>07380             $fileinfo = pathinfo(<a class="code" href="thumbnail_8php.html#a8dbfd6149875dfa452769eb3dade31b5">$imgfile</a>);
<a name="l07381"></a>07381             <span class="keywordflow">if</span> (isset($fileinfo[<span class="stringliteral">&#39;extension&#39;</span>]) AND (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($fileinfo[<span class="stringliteral">&#39;extension&#39;</span>]))) {
<a name="l07382"></a>07382                 <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = strtolower(trim($fileinfo[<span class="stringliteral">&#39;extension&#39;</span>]));
<a name="l07383"></a>07383             }
<a name="l07384"></a>07384         }
<a name="l07385"></a>07385         <span class="keywordflow">if</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;jpg&#39;</span>) {
<a name="l07386"></a>07386             <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = <span class="stringliteral">&#39;jpeg&#39;</span>;
<a name="l07387"></a>07387         }
<a name="l07388"></a>07388         <span class="keywordflow">return</span> <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>;
<a name="l07389"></a>07389     }
<a name="l07390"></a>07390 <span class="comment"></span>
<a name="l07391"></a>07391 <span class="comment">    /**</span>
<a name="l07392"></a>07392 <span class="comment">     * Set the block dimensions accounting for page breaks and page/column fitting</span>
<a name="l07393"></a>07393 <span class="comment">     * @param $w (float) width</span>
<a name="l07394"></a>07394 <span class="comment">     * @param $h (float) height</span>
<a name="l07395"></a>07395 <span class="comment">     * @param $x (float) X coordinate</span>
<a name="l07396"></a>07396 <span class="comment">     * @param $y (float) Y coodiante</span>
<a name="l07397"></a>07397 <span class="comment">     * @param $fitonpage (boolean) if true the block is resized to not exceed page dimensions.</span>
<a name="l07398"></a>07398 <span class="comment">     * @return array($w, $h, $x, $y)</span>
<a name="l07399"></a>07399 <span class="comment">     * @protected</span>
<a name="l07400"></a>07400 <span class="comment">     * @since 5.5.009 (2010-07-05)</span>
<a name="l07401"></a>07401 <span class="comment">     */</span>
<a name="l07402"></a><a class="code" href="classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a">07402</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a" title="Set the block dimensions accounting for page breaks and page/column fitting.">fitBlock</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, $fitonpage=<span class="keyword">false</span>) {
<a name="l07403"></a>07403         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> &lt;= 0) {
<a name="l07404"></a>07404             <span class="comment">// set maximum width</span>
<a name="l07405"></a>07405             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = ($this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin);
<a name="l07406"></a>07406         }
<a name="l07407"></a>07407         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> &lt;= 0) {
<a name="l07408"></a>07408             <span class="comment">// set maximum height</span>
<a name="l07409"></a>07409             <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = ($this-&gt;PageBreakTrigger - $this-&gt;tMargin);
<a name="l07410"></a>07410         }
<a name="l07411"></a>07411         <span class="comment">// resize the block to be vertically contained on a single page or single column</span>
<a name="l07412"></a>07412         <span class="keywordflow">if</span> ($fitonpage OR $this-&gt;AutoPageBreak) {
<a name="l07413"></a>07413             $ratio_wh = (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> / <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>);
<a name="l07414"></a>07414             <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> &gt; ($this-&gt;PageBreakTrigger - $this-&gt;tMargin)) {
<a name="l07415"></a>07415                 <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;PageBreakTrigger - $this-&gt;tMargin;
<a name="l07416"></a>07416                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> * $ratio_wh);
<a name="l07417"></a>07417             }
<a name="l07418"></a>07418             <span class="comment">// resize the block to be horizontally contained on a single page or single column</span>
<a name="l07419"></a>07419             <span class="keywordflow">if</span> ($fitonpage) {
<a name="l07420"></a>07420                 $maxw = ($this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin);
<a name="l07421"></a>07421                 <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> &gt; $maxw) {
<a name="l07422"></a>07422                     <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $maxw;
<a name="l07423"></a>07423                     <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> / $ratio_wh);
<a name="l07424"></a>07424                 }
<a name="l07425"></a>07425             }
<a name="l07426"></a>07426         }
<a name="l07427"></a>07427         <span class="comment">// Check whether we need a new page or new column first as this does not fit</span>
<a name="l07428"></a>07428         $prev_x = $this-&gt;x;
<a name="l07429"></a>07429         $prev_y = $this-&gt;y;
<a name="l07430"></a>07430         <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50" title="Add page if needed.">checkPageBreak</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>) OR ($this-&gt;y &lt; $prev_y)) {
<a name="l07431"></a>07431             <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = $this-&gt;y;
<a name="l07432"></a>07432             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07433"></a>07433                 <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> += ($prev_x - $this-&gt;x);
<a name="l07434"></a>07434             } <span class="keywordflow">else</span> {
<a name="l07435"></a>07435                 <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> += ($this-&gt;x - $prev_x);
<a name="l07436"></a>07436             }
<a name="l07437"></a>07437             $this-&gt;newline = <span class="keyword">true</span>;
<a name="l07438"></a>07438         }
<a name="l07439"></a>07439         <span class="comment">// resize the block to be contained on the remaining available page or column space</span>
<a name="l07440"></a>07440         <span class="keywordflow">if</span> ($fitonpage) {
<a name="l07441"></a>07441             $ratio_wh = (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> / <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>);
<a name="l07442"></a>07442             <span class="keywordflow">if</span> ((<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>) &gt; $this-&gt;PageBreakTrigger) {
<a name="l07443"></a>07443                 <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;PageBreakTrigger - <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>;
<a name="l07444"></a>07444                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> * $ratio_wh);
<a name="l07445"></a>07445             }
<a name="l07446"></a>07446             <span class="keywordflow">if</span> ((!$this-&gt;rtl) AND ((<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> + <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) &gt; ($this-&gt;w - $this-&gt;rMargin))) {
<a name="l07447"></a>07447                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l07448"></a>07448                 <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> / $ratio_wh);
<a name="l07449"></a>07449             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($this-&gt;rtl) AND ((<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) &lt; ($this-&gt;lMargin))) {
<a name="l07450"></a>07450                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - $this-&gt;lMargin;
<a name="l07451"></a>07451                 <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> / $ratio_wh);
<a name="l07452"></a>07452             }
<a name="l07453"></a>07453         }
<a name="l07454"></a>07454         <span class="keywordflow">return</span> array(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>);
<a name="l07455"></a>07455     }
<a name="l07456"></a>07456 <span class="comment"></span>
<a name="l07457"></a>07457 <span class="comment">    /**</span>
<a name="l07458"></a>07458 <span class="comment">     * Puts an image in the page.</span>
<a name="l07459"></a>07459 <span class="comment">     * The upper-left corner must be given.</span>
<a name="l07460"></a>07460 <span class="comment">     * The dimensions can be specified in different ways:&lt;ul&gt;</span>
<a name="l07461"></a>07461 <span class="comment">     * &lt;li&gt;explicit width and height (expressed in user unit)&lt;/li&gt;</span>
<a name="l07462"></a>07462 <span class="comment">     * &lt;li&gt;one explicit dimension, the other being calculated automatically in order to keep the original proportions&lt;/li&gt;</span>
<a name="l07463"></a>07463 <span class="comment">     * &lt;li&gt;no explicit dimension, in which case the image is put at 72 dpi&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l07464"></a>07464 <span class="comment">     * Supported formats are JPEG and PNG images whitout GD library and all images supported by GD: GD, GD2, GD2PART, GIF, JPEG, PNG, BMP, XBM, XPM;</span>
<a name="l07465"></a>07465 <span class="comment">     * The format can be specified explicitly or inferred from the file extension.&lt;br /&gt;</span>
<a name="l07466"></a>07466 <span class="comment">     * It is possible to put a link on the image.&lt;br /&gt;</span>
<a name="l07467"></a>07467 <span class="comment">     * Remark: if an image is used several times, only one copy will be embedded in the file.&lt;br /&gt;</span>
<a name="l07468"></a>07468 <span class="comment">     * @param $file (string) Name of the file containing the image or a &#39;@&#39; character followed by the image data string. To link an image without embedding it on the document, set an asterisk character before the URL (i.e.: &#39;*http://www.example.com/image.jpg&#39;).</span>
<a name="l07469"></a>07469 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner (LTR) or upper-right corner (RTL).</span>
<a name="l07470"></a>07470 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner (LTR) or upper-right corner (RTL).</span>
<a name="l07471"></a>07471 <span class="comment">     * @param $w (float) Width of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
<a name="l07472"></a>07472 <span class="comment">     * @param $h (float) Height of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
<a name="l07473"></a>07473 <span class="comment">     * @param $type (string) Image format. Possible values are (case insensitive): JPEG and PNG (whitout GD library) and all images supported by GD: GD, GD2, GD2PART, GIF, JPEG, PNG, BMP, XBM, XPM;. If not specified, the type is inferred from the file extension.</span>
<a name="l07474"></a>07474 <span class="comment">     * @param $link (mixed) URL or identifier returned by AddLink().</span>
<a name="l07475"></a>07475 <span class="comment">     * @param $align (string) Indicates the alignment of the pointer next to image insertion relative to image height. The value can be:&lt;ul&gt;&lt;li&gt;T: top-right for LTR or top-left for RTL&lt;/li&gt;&lt;li&gt;M: middle-right for LTR or middle-left for RTL&lt;/li&gt;&lt;li&gt;B: bottom-right for LTR or bottom-left for RTL&lt;/li&gt;&lt;li&gt;N: next line&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l07476"></a>07476 <span class="comment">     * @param $resize (mixed) If true resize (reduce) the image to fit $w and $h (requires GD or ImageMagick library); if false do not resize; if 2 force resize in all cases (upscaling and downscaling).</span>
<a name="l07477"></a>07477 <span class="comment">     * @param $dpi (int) dot-per-inch resolution used on resize</span>
<a name="l07478"></a>07478 <span class="comment">     * @param $palign (string) Allows to center or align the image on the current line. Possible values are:&lt;ul&gt;&lt;li&gt;L : left align&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;R : right align&lt;/li&gt;&lt;li&gt;&#39;&#39; : empty string : left for LTR or right for RTL&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l07479"></a>07479 <span class="comment">     * @param $ismask (boolean) true if this image is a mask, false otherwise</span>
<a name="l07480"></a>07480 <span class="comment">     * @param $imgmask (mixed) image object returned by this function or false</span>
<a name="l07481"></a>07481 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l07482"></a>07482 <span class="comment">     * @param $fitbox (mixed) If not false scale image dimensions proportionally to fit within the ($w, $h) box. $fitbox can be true or a 2 characters string indicating the image alignment inside the box. The first character indicate the horizontal alignment (L = left, C = center, R = right) the second character indicate the vertical algnment (T = top, M = middle, B = bottom).</span>
<a name="l07483"></a>07483 <span class="comment">     * @param $hidden (boolean) If true do not display the image.</span>
<a name="l07484"></a>07484 <span class="comment">     * @param $fitonpage (boolean) If true the image is resized to not exceed page dimensions.</span>
<a name="l07485"></a>07485 <span class="comment">     * @param $alt (boolean) If true the image will be added as alternative and not directly printed (the ID of the image will be returned).</span>
<a name="l07486"></a>07486 <span class="comment">     * @param $altimgs (array) Array of alternate images IDs. Each alternative image must be an array with two values: an integer representing the image ID (the value returned by the Image method) and a boolean value to indicate if the image is the default for printing.</span>
<a name="l07487"></a>07487 <span class="comment">     * @return image information</span>
<a name="l07488"></a>07488 <span class="comment">     * @public</span>
<a name="l07489"></a>07489 <span class="comment">     * @since 1.1</span>
<a name="l07490"></a>07490 <span class="comment">     */</span>
<a name="l07491"></a><a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">07491</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352" title="Puts an image in the page.">Image</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>=0, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>=0, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>=<span class="stringliteral">&#39;&#39;</span>, $link=<span class="stringliteral">&#39;&#39;</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $resize=<span class="keyword">false</span>, <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a>=300, $palign=<span class="stringliteral">&#39;&#39;</span>, $ismask=<span class="keyword">false</span>, $imgmask=<span class="keyword">false</span>, $border=0, $fitbox=<span class="keyword">false</span>, $hidden=<span class="keyword">false</span>, $fitonpage=<span class="keyword">false</span>, $alt=<span class="keyword">false</span>, $altimgs=array()) {
<a name="l07492"></a>07492         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l07493"></a>07493             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> = $this-&gt;x;
<a name="l07494"></a>07494         }
<a name="l07495"></a>07495         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l07496"></a>07496             <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> = $this-&gt;y;
<a name="l07497"></a>07497         }
<a name="l07498"></a>07498         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l07499"></a>07499         list(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>) = $this-&gt;<a class="code" href="classTCPDF.html#a1d99e81697a90efb13a6734001427f40" title="Check page for no-write regions and adapt current coordinates and page margins if necessary...">checkPageRegions</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>);
<a name="l07500"></a>07500         $cached_file = <span class="keyword">false</span>; <span class="comment">// true when the file is cached</span>
<a name="l07501"></a>07501         $exurl = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// external streams</span>
<a name="l07502"></a>07502         <span class="comment">// check if we are passing an image as file or string</span>
<a name="l07503"></a>07503         <span class="keywordflow">if</span> (<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>[0] === <span class="charliteral">&#39;@&#39;</span>) {
<a name="l07504"></a>07504             <span class="comment">// image from string</span>
<a name="l07505"></a>07505             $imgdata = substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, 1);
<a name="l07506"></a>07506             <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> = K_PATH_CACHE.<span class="stringliteral">&#39;img_&#39;</span>.md5($imgdata);
<a name="l07507"></a>07507             <a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a> = fopen(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <span class="charliteral">&#39;w&#39;</span>);
<a name="l07508"></a>07508             fwrite(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>, $imgdata);
<a name="l07509"></a>07509             fclose(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>);
<a name="l07510"></a>07510             unset($imgdata);
<a name="l07511"></a>07511             $cached_file = <span class="keyword">true</span>;
<a name="l07512"></a>07512             $imsize = @getimagesize(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07513"></a>07513             <span class="keywordflow">if</span> ($imsize === FALSE) {
<a name="l07514"></a>07514                 unlink(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07515"></a>07515                 $cached_file = <span class="keyword">false</span>;
<a name="l07516"></a>07516             }
<a name="l07517"></a>07517         } <span class="keywordflow">else</span> { <span class="comment">// image file</span>
<a name="l07518"></a>07518             <span class="keywordflow">if</span> (<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>{0} === <span class="charliteral">&#39;*&#39;</span>) {
<a name="l07519"></a>07519                 <span class="comment">// image as external stream</span>
<a name="l07520"></a>07520                 <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> = substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, 1);
<a name="l07521"></a>07521                 $exurl = <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>;
<a name="l07522"></a>07522             }
<a name="l07523"></a>07523             <span class="comment">// check if is local file</span>
<a name="l07524"></a>07524             <span class="keywordflow">if</span> (!@file_exists(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l07525"></a>07525                 <span class="comment">// encode spaces on filename (file is probably an URL)</span>
<a name="l07526"></a>07526                 <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> = str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;%20&#39;</span>, <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07527"></a>07527             }
<a name="l07528"></a>07528             <span class="keywordflow">if</span> (@file_exists(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l07529"></a>07529                 <span class="comment">// get image dimensions</span>
<a name="l07530"></a>07530                 $imsize = @getimagesize(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07531"></a>07531             } <span class="keywordflow">else</span> {
<a name="l07532"></a>07532                 $imsize = <span class="keyword">false</span>;
<a name="l07533"></a>07533             }
<a name="l07534"></a>07534             <span class="keywordflow">if</span> ($imsize === FALSE) {
<a name="l07535"></a>07535                 <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;curl_init&#39;</span>)) {
<a name="l07536"></a>07536                     <span class="comment">// try to get remote file data using cURL</span>
<a name="l07537"></a>07537                     $cs = curl_init(); <span class="comment">// curl session</span>
<a name="l07538"></a>07538                     curl_setopt($cs, CURLOPT_URL, <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07539"></a>07539                     curl_setopt($cs, CURLOPT_BINARYTRANSFER, <span class="keyword">true</span>);
<a name="l07540"></a>07540                     curl_setopt($cs, CURLOPT_FAILONERROR, <span class="keyword">true</span>);
<a name="l07541"></a>07541                     curl_setopt($cs, CURLOPT_RETURNTRANSFER, <span class="keyword">true</span>);
<a name="l07542"></a>07542                     curl_setopt($cs, CURLOPT_FOLLOWLOCATION, <span class="keyword">true</span>);
<a name="l07543"></a>07543                     curl_setopt($cs, CURLOPT_CONNECTTIMEOUT, 5);
<a name="l07544"></a>07544                     curl_setopt($cs, CURLOPT_TIMEOUT, 30);
<a name="l07545"></a>07545                     curl_setopt($cs, CURLOPT_SSL_VERIFYPEER, <span class="keyword">false</span>);
<a name="l07546"></a>07546                     curl_setopt($cs, CURLOPT_SSL_VERIFYHOST, <span class="keyword">false</span>);
<a name="l07547"></a>07547                     curl_setopt($cs, CURLOPT_USERAGENT, <span class="stringliteral">&#39;TCPDF&#39;</span>);
<a name="l07548"></a>07548                     $imgdata = curl_exec($cs);
<a name="l07549"></a>07549                     curl_close($cs);
<a name="l07550"></a>07550                     <span class="keywordflow">if</span> ($imgdata !== FALSE) {
<a name="l07551"></a>07551                         <span class="comment">// copy image to cache</span>
<a name="l07552"></a>07552                         <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> = K_PATH_CACHE.<span class="stringliteral">&#39;img_&#39;</span>.md5($imgdata);
<a name="l07553"></a>07553                         <a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a> = fopen(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <span class="charliteral">&#39;w&#39;</span>);
<a name="l07554"></a>07554                         fwrite(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>, $imgdata);
<a name="l07555"></a>07555                         fclose(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>);
<a name="l07556"></a>07556                         unset($imgdata);
<a name="l07557"></a>07557                         $cached_file = <span class="keyword">true</span>;
<a name="l07558"></a>07558                         $imsize = @getimagesize(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07559"></a>07559                         <span class="keywordflow">if</span> ($imsize === FALSE) {
<a name="l07560"></a>07560                             unlink(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07561"></a>07561                             $cached_file = <span class="keyword">false</span>;
<a name="l07562"></a>07562                         }
<a name="l07563"></a>07563                     }
<a name="l07564"></a>07564                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> &gt; 0) AND (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> &gt; 0)) {
<a name="l07565"></a>07565                     <span class="comment">// get measures from specified data</span>
<a name="l07566"></a>07566                     $pw = $this-&gt;<a class="code" href="classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9" title="Convert HTML string containing value and unit of measure to user&#39;s units or points.">getHTMLUnitToUnits</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, 0, $this-&gt;pdfunit, <span class="keyword">true</span>) * $this-&gt;imgscale * $this-&gt;k;
<a name="l07567"></a>07567                     $ph = $this-&gt;<a class="code" href="classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9" title="Convert HTML string containing value and unit of measure to user&#39;s units or points.">getHTMLUnitToUnits</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, 0, $this-&gt;pdfunit, <span class="keyword">true</span>) * $this-&gt;imgscale * $this-&gt;k;
<a name="l07568"></a>07568                     $imsize = array($pw, $ph);
<a name="l07569"></a>07569                 }
<a name="l07570"></a>07570             }
<a name="l07571"></a>07571         }
<a name="l07572"></a>07572         <span class="keywordflow">if</span> ($imsize === FALSE) {
<a name="l07573"></a>07573             <span class="keywordflow">if</span> (substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, 0, -34) == K_PATH_CACHE.<span class="stringliteral">&#39;msk&#39;</span>) { <span class="comment">// mask file</span>
<a name="l07574"></a>07574                 <span class="comment">// get measures from specified data</span>
<a name="l07575"></a>07575                 $pw = $this-&gt;<a class="code" href="classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9" title="Convert HTML string containing value and unit of measure to user&#39;s units or points.">getHTMLUnitToUnits</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, 0, $this-&gt;pdfunit, <span class="keyword">true</span>) * $this-&gt;imgscale * $this-&gt;k;
<a name="l07576"></a>07576                 $ph = $this-&gt;<a class="code" href="classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9" title="Convert HTML string containing value and unit of measure to user&#39;s units or points.">getHTMLUnitToUnits</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, 0, $this-&gt;pdfunit, <span class="keyword">true</span>) * $this-&gt;imgscale * $this-&gt;k;
<a name="l07577"></a>07577                 $imsize = array($pw, $ph);
<a name="l07578"></a>07578             } <span class="keywordflow">else</span> {
<a name="l07579"></a>07579                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;[Image] Unable to get image: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07580"></a>07580             }
<a name="l07581"></a>07581         }
<a name="l07582"></a>07582         <span class="comment">// get original image width and height in pixels</span>
<a name="l07583"></a>07583         list($pixw, $pixh) = $imsize;
<a name="l07584"></a>07584         <span class="comment">// calculate image width and height on document</span>
<a name="l07585"></a>07585         <span class="keywordflow">if</span> ((<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> &lt;= 0) AND (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> &lt;= 0)) {
<a name="l07586"></a>07586             <span class="comment">// convert image size to document unit</span>
<a name="l07587"></a>07587             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;<a class="code" href="classTCPDF.html#a9a0a09e2334f92e7a54cf1f550c3f921" title="Converts pixels to User&#39;s Units.">pixelsToUnits</a>($pixw);
<a name="l07588"></a>07588             <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;<a class="code" href="classTCPDF.html#a9a0a09e2334f92e7a54cf1f550c3f921" title="Converts pixels to User&#39;s Units.">pixelsToUnits</a>($pixh);
<a name="l07589"></a>07589         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> &lt;= 0) {
<a name="l07590"></a>07590             <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> * $pixw / $pixh;
<a name="l07591"></a>07591         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> &lt;= 0) {
<a name="l07592"></a>07592             <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> * $pixh / $pixw;
<a name="l07593"></a>07593         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($fitbox !== <span class="keyword">false</span>) AND (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> &gt; 0) AND (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> &gt; 0)) {
<a name="l07594"></a>07594             <span class="keywordflow">if</span> (strlen($fitbox) !== 2) {
<a name="l07595"></a>07595                 <span class="comment">// set default alignment</span>
<a name="l07596"></a>07596                 $fitbox = <span class="stringliteral">&#39;--&#39;</span>;
<a name="l07597"></a>07597             }
<a name="l07598"></a>07598             <span class="comment">// scale image dimensions proportionally to fit within the ($w, $h) box</span>
<a name="l07599"></a>07599             <span class="keywordflow">if</span> (((<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> * $pixh) / (<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> * $pixw)) &lt; 1) {
<a name="l07600"></a>07600                 <span class="comment">// store current height</span>
<a name="l07601"></a>07601                 $oldh = <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l07602"></a>07602                 <span class="comment">// calculate new height</span>
<a name="l07603"></a>07603                 <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> * $pixh / $pixw;
<a name="l07604"></a>07604                 <span class="comment">// height difference</span>
<a name="l07605"></a>07605                 $hdiff = ($oldh - <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>);
<a name="l07606"></a>07606                 <span class="comment">// vertical alignment</span>
<a name="l07607"></a>07607                 <span class="keywordflow">switch</span> (strtoupper($fitbox{1})) {
<a name="l07608"></a>07608                     <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {
<a name="l07609"></a>07609                         <span class="keywordflow">break</span>;
<a name="l07610"></a>07610                     }
<a name="l07611"></a>07611                     <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {
<a name="l07612"></a>07612                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> += ($hdiff / 2);
<a name="l07613"></a>07613                         <span class="keywordflow">break</span>;
<a name="l07614"></a>07614                     }
<a name="l07615"></a>07615                     <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l07616"></a>07616                         <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> += $hdiff;
<a name="l07617"></a>07617                         <span class="keywordflow">break</span>;
<a name="l07618"></a>07618                     }
<a name="l07619"></a>07619                 }
<a name="l07620"></a>07620             } <span class="keywordflow">else</span> {
<a name="l07621"></a>07621                 <span class="comment">// store current width</span>
<a name="l07622"></a>07622                 $oldw = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07623"></a>07623                 <span class="comment">// calculate new width</span>
<a name="l07624"></a>07624                 <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> * $pixw / $pixh;
<a name="l07625"></a>07625                 <span class="comment">// width difference</span>
<a name="l07626"></a>07626                 $wdiff = ($oldw - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>);
<a name="l07627"></a>07627                 <span class="comment">// horizontal alignment</span>
<a name="l07628"></a>07628                 <span class="keywordflow">switch</span> (strtoupper($fitbox{0})) {
<a name="l07629"></a>07629                     <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {
<a name="l07630"></a>07630                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07631"></a>07631                             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> -= $wdiff;
<a name="l07632"></a>07632                         }
<a name="l07633"></a>07633                         <span class="keywordflow">break</span>;
<a name="l07634"></a>07634                     }
<a name="l07635"></a>07635                     <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {
<a name="l07636"></a>07636                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07637"></a>07637                             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> -= ($wdiff / 2);
<a name="l07638"></a>07638                         } <span class="keywordflow">else</span> {
<a name="l07639"></a>07639                             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> += ($wdiff / 2);
<a name="l07640"></a>07640                         }
<a name="l07641"></a>07641                         <span class="keywordflow">break</span>;
<a name="l07642"></a>07642                     }
<a name="l07643"></a>07643                     <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {
<a name="l07644"></a>07644                         <span class="keywordflow">if</span> (!$this-&gt;rtl) {
<a name="l07645"></a>07645                             <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> += $wdiff;
<a name="l07646"></a>07646                         }
<a name="l07647"></a>07647                         <span class="keywordflow">break</span>;
<a name="l07648"></a>07648                     }
<a name="l07649"></a>07649                 }
<a name="l07650"></a>07650             }
<a name="l07651"></a>07651         }
<a name="l07652"></a>07652         <span class="comment">// fit the image on available space</span>
<a name="l07653"></a>07653         list(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>) = $this-&gt;<a class="code" href="classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a" title="Set the block dimensions accounting for page breaks and page/column fitting.">fitBlock</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, $fitonpage);
<a name="l07654"></a>07654         <span class="comment">// calculate new minimum dimensions in pixels</span>
<a name="l07655"></a>07655         $neww = round(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> * $this-&gt;k * <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a> / $this-&gt;dpi);
<a name="l07656"></a>07656         $newh = round(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> * $this-&gt;k * <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a> / $this-&gt;dpi);
<a name="l07657"></a>07657         <span class="comment">// check if resize is necessary (resize is used only to reduce the image)</span>
<a name="l07658"></a>07658         $newsize = ($neww * $newh);
<a name="l07659"></a>07659         $pixsize = ($pixw * $pixh);
<a name="l07660"></a>07660         <span class="keywordflow">if</span> (intval($resize) == 2) {
<a name="l07661"></a>07661             $resize = <span class="keyword">true</span>;
<a name="l07662"></a>07662         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($newsize &gt;= $pixsize) {
<a name="l07663"></a>07663             $resize = <span class="keyword">false</span>;
<a name="l07664"></a>07664         }
<a name="l07665"></a>07665         <span class="comment">// check if image has been already added on document</span>
<a name="l07666"></a>07666         $newimage = <span class="keyword">true</span>;
<a name="l07667"></a>07667         <span class="keywordflow">if</span> (in_array(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, $this-&gt;imagekeys)) {
<a name="l07668"></a>07668             $newimage = <span class="keyword">false</span>;
<a name="l07669"></a>07669             <span class="comment">// get existing image data</span>
<a name="l07670"></a>07670             $info = $this-&gt;<a class="code" href="classTCPDF.html#a1a003edf69be144993c85c07a220315c" title="Get image buffer content.">getImageBuffer</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07671"></a>07671             <span class="keywordflow">if</span> (substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, 0, -34) != K_PATH_CACHE.<span class="stringliteral">&#39;msk&#39;</span>) {
<a name="l07672"></a>07672                 <span class="comment">// check if the newer image is larger</span>
<a name="l07673"></a>07673                 $oldsize = ($info[<span class="charliteral">&#39;w&#39;</span>] * $info[<span class="charliteral">&#39;h&#39;</span>]);
<a name="l07674"></a>07674                 <span class="keywordflow">if</span> ((($oldsize &lt; $newsize) AND ($resize)) OR (($oldsize &lt; $pixsize) AND (!$resize))) {
<a name="l07675"></a>07675                     $newimage = <span class="keyword">true</span>;
<a name="l07676"></a>07676                 }
<a name="l07677"></a>07677             }
<a name="l07678"></a>07678         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, 0, -34) != K_PATH_CACHE.<span class="stringliteral">&#39;msk&#39;</span>) {
<a name="l07679"></a>07679             <span class="comment">// check for cached images with alpha channel</span>
<a name="l07680"></a>07680             $filehash = md5(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07681"></a>07681             $tempfile_plain = K_PATH_CACHE.<span class="stringliteral">&#39;mskp_&#39;</span>.$filehash;
<a name="l07682"></a>07682             $tempfile_alpha = K_PATH_CACHE.<span class="stringliteral">&#39;mska_&#39;</span>.$filehash;
<a name="l07683"></a>07683             <span class="keywordflow">if</span> (in_array($tempfile_plain, $this-&gt;imagekeys)) {
<a name="l07684"></a>07684                 <span class="comment">// get existing image data</span>
<a name="l07685"></a>07685                 $info = $this-&gt;<a class="code" href="classTCPDF.html#a1a003edf69be144993c85c07a220315c" title="Get image buffer content.">getImageBuffer</a>($tempfile_plain);
<a name="l07686"></a>07686                 <span class="comment">// check if the newer image is larger</span>
<a name="l07687"></a>07687                 $oldsize = ($info[<span class="charliteral">&#39;w&#39;</span>] * $info[<span class="charliteral">&#39;h&#39;</span>]);
<a name="l07688"></a>07688                 <span class="keywordflow">if</span> ((($oldsize &lt; $newsize) AND ($resize)) OR (($oldsize &lt; $pixsize) AND (!$resize))) {
<a name="l07689"></a>07689                     $newimage = <span class="keyword">true</span>;
<a name="l07690"></a>07690                 } <span class="keywordflow">else</span> {
<a name="l07691"></a>07691                     $newimage = <span class="keyword">false</span>;
<a name="l07692"></a>07692                     <span class="comment">// embed mask image</span>
<a name="l07693"></a>07693                     $imgmask = $this-&gt;<a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352" title="Puts an image in the page.">Image</a>($tempfile_alpha, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;PNG&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $resize, <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);
<a name="l07694"></a>07694                     <span class="comment">// embed image, masked with previously embedded mask</span>
<a name="l07695"></a>07695                     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352" title="Puts an image in the page.">Image</a>($tempfile_plain, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $link, $align, $resize, <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a>, $palign, <span class="keyword">false</span>, $imgmask);
<a name="l07696"></a>07696                 }
<a name="l07697"></a>07697             }
<a name="l07698"></a>07698         }
<a name="l07699"></a>07699         <span class="keywordflow">if</span> ($newimage) {
<a name="l07700"></a>07700             <span class="comment">//First use of image, get info</span>
<a name="l07701"></a>07701             <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = strtolower(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l07702"></a>07702             <span class="keywordflow">if</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;&#39;</span>) {
<a name="l07703"></a>07703                 <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = $this-&gt;<a class="code" href="classTCPDF.html#a69d6b919e84ff00a19e750efd29fba18" title="Return the image type given the file name or array returned by getimagesize() function.">getImageFileType</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, $imsize);
<a name="l07704"></a>07704             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;jpg&#39;</span>) {
<a name="l07705"></a>07705                 <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = <span class="stringliteral">&#39;jpeg&#39;</span>;
<a name="l07706"></a>07706             }
<a name="l07707"></a>07707             $mqr = $this-&gt;<a class="code" href="classTCPDF.html#a46b50f52e64f63ab8256380aa874a864" title="Gets the current active configuration setting of magic_quotes_runtime (if the get_magic_quotes_runtim...">get_mqr</a>();
<a name="l07708"></a>07708             $this-&gt;<a class="code" href="classTCPDF.html#a5d0cc02ec71ae43461d8ece30f111b82" title="Sets the current active configuration setting of magic_quotes_runtime (if the set_magic_quotes_runtim...">set_mqr</a>(<span class="keyword">false</span>);
<a name="l07709"></a>07709             <span class="comment">// Specific image handlers</span>
<a name="l07710"></a>07710             $mtd = <span class="stringliteral">&#39;_parse&#39;</span>.$type;
<a name="l07711"></a>07711             <span class="comment">// GD image handler function</span>
<a name="l07712"></a>07712             $gdfunction = <span class="stringliteral">&#39;imagecreatefrom&#39;</span>.$type;
<a name="l07713"></a>07713             $info = <span class="keyword">false</span>;
<a name="l07714"></a>07714             <span class="keywordflow">if</span> ((method_exists($this, $mtd)) AND (!($resize AND (function_exists($gdfunction) OR extension_loaded(<span class="stringliteral">&#39;imagick&#39;</span>))))) {
<a name="l07715"></a>07715                 <span class="comment">// TCPDF image functions</span>
<a name="l07716"></a>07716                 $info = $this-&gt;$mtd(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07717"></a>07717                 <span class="keywordflow">if</span> ($info == <span class="stringliteral">&#39;pngalpha&#39;</span>) {
<a name="l07718"></a>07718                     <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#a63318e9e32a06621bb98c59cd660a835" title="Extract info from a PNG image with alpha channel using the GD library.">ImagePngAlpha</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, $pixw, $pixh, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;PNG&#39;</span>, $link, $align, $resize, <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a>, $palign, $filehash);
<a name="l07719"></a>07719                 }
<a name="l07720"></a>07720             }
<a name="l07721"></a>07721             <span class="keywordflow">if</span> (!$info) {
<a name="l07722"></a>07722                 <span class="keywordflow">if</span> (function_exists($gdfunction)) {
<a name="l07723"></a>07723                     <span class="comment">// GD library</span>
<a name="l07724"></a>07724                     <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = $gdfunction(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07725"></a>07725                     <span class="keywordflow">if</span> ($resize) {
<a name="l07726"></a>07726                         $imgr = imagecreatetruecolor($neww, $newh);
<a name="l07727"></a>07727                         <span class="keywordflow">if</span> ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;gif&#39;</span>) OR (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;png&#39;</span>)) {
<a name="l07728"></a>07728                             $imgr = $this-&gt;<a class="code" href="classTCPDF.html#a20f6b6bb1c90995584852e26c47be5a9" title="Set the transparency for the given GD image.">_setGDImageTransparency</a>($imgr, <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>);
<a name="l07729"></a>07729                         }
<a name="l07730"></a>07730                         imagecopyresampled($imgr, <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>, 0, 0, 0, 0, $neww, $newh, $pixw, $pixh);
<a name="l07731"></a>07731                         <span class="keywordflow">if</span> ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;gif&#39;</span>) OR (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;png&#39;</span>)) {
<a name="l07732"></a>07732                             $info = $this-&gt;<a class="code" href="classTCPDF.html#a9d1bdec637545a283ed4b40e4e79835d" title="Convert the loaded image to a PNG and then return a structure for the PDF creator.">_toPNG</a>($imgr);
<a name="l07733"></a>07733                         } <span class="keywordflow">else</span> {
<a name="l07734"></a>07734                             $info = $this-&gt;<a class="code" href="classTCPDF.html#a77c0b3ee8fbf87a93c8b2ee6deec69b6" title="Convert the loaded image to a JPEG and then return a structure for the PDF creator.">_toJPEG</a>($imgr);
<a name="l07735"></a>07735                         }
<a name="l07736"></a>07736                     } <span class="keywordflow">else</span> {
<a name="l07737"></a>07737                         <span class="keywordflow">if</span> ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;gif&#39;</span>) OR (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;png&#39;</span>)) {
<a name="l07738"></a>07738                             $info = $this-&gt;<a class="code" href="classTCPDF.html#a9d1bdec637545a283ed4b40e4e79835d" title="Convert the loaded image to a PNG and then return a structure for the PDF creator.">_toPNG</a>(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>);
<a name="l07739"></a>07739                         } <span class="keywordflow">else</span> {
<a name="l07740"></a>07740                             $info = $this-&gt;<a class="code" href="classTCPDF.html#a77c0b3ee8fbf87a93c8b2ee6deec69b6" title="Convert the loaded image to a JPEG and then return a structure for the PDF creator.">_toJPEG</a>(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>);
<a name="l07741"></a>07741                         }
<a name="l07742"></a>07742                     }
<a name="l07743"></a>07743                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (extension_loaded(<span class="stringliteral">&#39;imagick&#39;</span>)) {
<a name="l07744"></a>07744                     <span class="comment">// ImageMagick library</span>
<a name="l07745"></a>07745                     <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = <span class="keyword">new</span> Imagick();
<a name="l07746"></a>07746                     <span class="keywordflow">if</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;SVG&#39;</span>) {
<a name="l07747"></a>07747                         <span class="comment">// get SVG file content</span>
<a name="l07748"></a>07748                         $svgimg = file_get_contents(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07749"></a>07749                         <span class="comment">// get width and height</span>
<a name="l07750"></a>07750                         $regs = array();
<a name="l07751"></a>07751                         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/&lt;svg([^&gt;]*)&gt;/si&#39;</span>, $svgimg, $regs)) {
<a name="l07752"></a>07752                             $svgtag = $regs[1];
<a name="l07753"></a>07753                             $tmp = array();
<a name="l07754"></a>07754                             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+width[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $svgtag, $tmp)) {
<a name="l07755"></a>07755                                 $ow = $this-&gt;<a class="code" href="classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9" title="Convert HTML string containing value and unit of measure to user&#39;s units or points.">getHTMLUnitToUnits</a>($tmp[1], 1, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l07756"></a>07756                                 $owu = sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, ($ow * <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a> / 72)).$this-&gt;pdfunit;
<a name="l07757"></a>07757                                 $svgtag = preg_replace(<span class="stringliteral">&#39;/[\s]+width[\s]*=[\s]*&quot;[^&quot;]*&quot;/si&#39;</span>, <span class="stringliteral">&#39; width=&quot;&#39;</span>.$owu.<span class="charliteral">&#39;&quot;&#39;</span>, $svgtag, 1);
<a name="l07758"></a>07758                             } <span class="keywordflow">else</span> {
<a name="l07759"></a>07759                                 $ow = <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07760"></a>07760                             }
<a name="l07761"></a>07761                             $tmp = array();
<a name="l07762"></a>07762                             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+height[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $svgtag, $tmp)) {
<a name="l07763"></a>07763                                 $oh = $this-&gt;<a class="code" href="classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9" title="Convert HTML string containing value and unit of measure to user&#39;s units or points.">getHTMLUnitToUnits</a>($tmp[1], 1, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l07764"></a>07764                                 $ohu = sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, ($oh * <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a> / 72)).$this-&gt;pdfunit;
<a name="l07765"></a>07765                                 $svgtag = preg_replace(<span class="stringliteral">&#39;/[\s]+height[\s]*=[\s]*&quot;[^&quot;]*&quot;/si&#39;</span>, <span class="stringliteral">&#39; height=&quot;&#39;</span>.$ohu.<span class="charliteral">&#39;&quot;&#39;</span>, $svgtag, 1);
<a name="l07766"></a>07766                             } <span class="keywordflow">else</span> {
<a name="l07767"></a>07767                                 $oh = <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l07768"></a>07768                             }
<a name="l07769"></a>07769                             $tmp = array();
<a name="l07770"></a>07770                             <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&#39;/[\s]+viewBox[\s]*=[\s]*&quot;[\s]*([0-9\.]+)[\s]+([0-9\.]+)[\s]+([0-9\.]+)[\s]+([0-9\.]+)[\s]*&quot;/si&#39;</span>, $svgtag, $tmp)) {
<a name="l07771"></a>07771                                 $vbw = ($ow * $this-&gt;imgscale * $this-&gt;k);
<a name="l07772"></a>07772                                 $vbh = ($oh * $this-&gt;imgscale * $this-&gt;k);
<a name="l07773"></a>07773                                 $vbox = sprintf(<span class="stringliteral">&#39; viewBox=&quot;0 0 %.3F %.3F&quot; &#39;</span>, $vbw, $vbh);
<a name="l07774"></a>07774                                 $svgtag = $vbox.$svgtag;
<a name="l07775"></a>07775                             }
<a name="l07776"></a>07776                             $svgimg = preg_replace(<span class="stringliteral">&#39;/&lt;svg([^&gt;]*)&gt;/si&#39;</span>, <span class="stringliteral">&#39;&lt;svg&#39;</span>.$svgtag.<span class="charliteral">&#39;&gt;&#39;</span>, $svgimg, 1);
<a name="l07777"></a>07777                         }
<a name="l07778"></a>07778                         <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;readImageBlob($svgimg);
<a name="l07779"></a>07779                     } <span class="keywordflow">else</span> {
<a name="l07780"></a>07780                         <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;readImage(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07781"></a>07781                     }
<a name="l07782"></a>07782                     <span class="keywordflow">if</span> ($resize) {
<a name="l07783"></a>07783                         <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;resizeImage($neww, $newh, 10, 1, <span class="keyword">false</span>);
<a name="l07784"></a>07784                     }
<a name="l07785"></a>07785                     <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;setCompressionQuality($this-&gt;jpeg_quality);
<a name="l07786"></a>07786                     <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;setImageFormat(<span class="stringliteral">&#39;jpeg&#39;</span>);
<a name="l07787"></a>07787                     $tempname = tempnam(K_PATH_CACHE, <span class="stringliteral">&#39;jpg_&#39;</span>);
<a name="l07788"></a>07788                     <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;writeImage($tempname);
<a name="l07789"></a>07789                     $info = $this-&gt;<a class="code" href="classTCPDF.html#a8c7676d84a0aceaec7dfa2ab2644a6ee" title="Extract info from a JPEG file without using the GD library.">_parsejpeg</a>($tempname);
<a name="l07790"></a>07790                     unlink($tempname);
<a name="l07791"></a>07791                     <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;destroy();
<a name="l07792"></a>07792                 } <span class="keywordflow">else</span> {
<a name="l07793"></a>07793                     <span class="keywordflow">return</span>;
<a name="l07794"></a>07794                 }
<a name="l07795"></a>07795             }
<a name="l07796"></a>07796             <span class="keywordflow">if</span> ($info === <span class="keyword">false</span>) {
<a name="l07797"></a>07797                 <span class="comment">//If false, we cannot process image</span>
<a name="l07798"></a>07798                 <span class="keywordflow">return</span>;
<a name="l07799"></a>07799             }
<a name="l07800"></a>07800             $this-&gt;<a class="code" href="classTCPDF.html#a5d0cc02ec71ae43461d8ece30f111b82" title="Sets the current active configuration setting of magic_quotes_runtime (if the set_magic_quotes_runtim...">set_mqr</a>($mqr);
<a name="l07801"></a>07801             <span class="keywordflow">if</span> ($ismask) {
<a name="l07802"></a>07802                 <span class="comment">// force grayscale</span>
<a name="l07803"></a>07803                 $info[<span class="stringliteral">&#39;cs&#39;</span>] = <span class="stringliteral">&#39;DeviceGray&#39;</span>;
<a name="l07804"></a>07804             }
<a name="l07805"></a>07805             $info[<span class="charliteral">&#39;i&#39;</span>] = $this-&gt;numimages;
<a name="l07806"></a>07806             <span class="keywordflow">if</span> (!in_array(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, $this-&gt;imagekeys)) {
<a name="l07807"></a>07807                 ++$info[<span class="charliteral">&#39;i&#39;</span>];
<a name="l07808"></a>07808             }
<a name="l07809"></a>07809             <span class="keywordflow">if</span> ($imgmask !== <span class="keyword">false</span>) {
<a name="l07810"></a>07810                 $info[<span class="stringliteral">&#39;masked&#39;</span>] = $imgmask;
<a name="l07811"></a>07811             }
<a name="l07812"></a>07812             <span class="keywordflow">if</span> (!empty($exurl)) {
<a name="l07813"></a>07813                 $info[<span class="stringliteral">&#39;exurl&#39;</span>] = $exurl;
<a name="l07814"></a>07814             }
<a name="l07815"></a>07815             <span class="comment">// array of alternative images</span>
<a name="l07816"></a>07816             $info[<span class="stringliteral">&#39;altimgs&#39;</span>] = $altimgs;
<a name="l07817"></a>07817             <span class="comment">// add image to document</span>
<a name="l07818"></a>07818             $this-&gt;<a class="code" href="classTCPDF.html#a68092d68b3e4947ea283efe0a990e7d9" title="Set image buffer content.">setImageBuffer</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, $info);
<a name="l07819"></a>07819         }
<a name="l07820"></a>07820         <span class="keywordflow">if</span> ($cached_file) {
<a name="l07821"></a>07821             <span class="comment">// remove cached file</span>
<a name="l07822"></a>07822             unlink(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l07823"></a>07823         }
<a name="l07824"></a>07824         <span class="comment">// set alignment</span>
<a name="l07825"></a>07825         $this-&gt;img_rb_y = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l07826"></a>07826         <span class="comment">// set alignment</span>
<a name="l07827"></a>07827         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07828"></a>07828             <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l07829"></a>07829                 $ximg = $this-&gt;lMargin;
<a name="l07830"></a>07830             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l07831"></a>07831                 $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) / 2;
<a name="l07832"></a>07832             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l07833"></a>07833                 $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07834"></a>07834             } <span class="keywordflow">else</span> {
<a name="l07835"></a>07835                 $ximg = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07836"></a>07836             }
<a name="l07837"></a>07837             $this-&gt;img_rb_x = $ximg;
<a name="l07838"></a>07838         } <span class="keywordflow">else</span> {
<a name="l07839"></a>07839             <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l07840"></a>07840                 $ximg = $this-&gt;lMargin;
<a name="l07841"></a>07841             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l07842"></a>07842                 $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>) / 2;
<a name="l07843"></a>07843             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l07844"></a>07844                 $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07845"></a>07845             } <span class="keywordflow">else</span> {
<a name="l07846"></a>07846                 $ximg = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l07847"></a>07847             }
<a name="l07848"></a>07848             $this-&gt;img_rb_x = $ximg + <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07849"></a>07849         }
<a name="l07850"></a>07850         <span class="keywordflow">if</span> ($ismask OR $hidden) {
<a name="l07851"></a>07851             <span class="comment">// image is not displayed</span>
<a name="l07852"></a>07852             <span class="keywordflow">return</span> $info[<span class="charliteral">&#39;i&#39;</span>];
<a name="l07853"></a>07853         }
<a name="l07854"></a>07854         $xkimg = $ximg * $this-&gt;k;
<a name="l07855"></a>07855         <span class="keywordflow">if</span> (!$alt) {
<a name="l07856"></a>07856             <span class="comment">// only non-alternative immages will be set</span>
<a name="l07857"></a>07857             $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(sprintf(<span class="stringliteral">&#39;q %.2F 0 0 %.2F %.2F %.2F cm /I%u Do Q&#39;</span>, (<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> * $this-&gt;k), ($h * $this-&gt;k), $xkimg, (($this-&gt;h - (<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + $h)) * $this-&gt;k), $info[<span class="charliteral">&#39;i&#39;</span>]));
<a name="l07858"></a>07858         }
<a name="l07859"></a>07859         <span class="keywordflow">if</span> (!empty($border)) {
<a name="l07860"></a>07860             $bx = $this-&gt;x;
<a name="l07861"></a>07861             $by = $this-&gt;y;
<a name="l07862"></a>07862             $this-&gt;x = $ximg;
<a name="l07863"></a>07863             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l07864"></a>07864                 $this-&gt;x += <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>;
<a name="l07865"></a>07865             }
<a name="l07866"></a>07866             $this-&gt;y = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>;
<a name="l07867"></a>07867             $this-&gt;<a class="code" href="classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31" title="Prints a cell (rectangular area) with optional borders, background color and character string...">Cell</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, $h, <span class="stringliteral">&#39;&#39;</span>, $border, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>);
<a name="l07868"></a>07868             $this-&gt;x = $bx;
<a name="l07869"></a>07869             $this-&gt;y = $by;
<a name="l07870"></a>07870         }
<a name="l07871"></a>07871         <span class="keywordflow">if</span> ($link) {
<a name="l07872"></a>07872             $this-&gt;<a class="code" href="classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994" title="Puts a link on a rectangular area of the page.">Link</a>($ximg, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, $h, $link, 0);
<a name="l07873"></a>07873         }
<a name="l07874"></a>07874         <span class="comment">// set pointer to align the next text/objects</span>
<a name="l07875"></a>07875         <span class="keywordflow">switch</span>($align) {
<a name="l07876"></a>07876             <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {
<a name="l07877"></a>07877                 $this-&gt;y = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>;
<a name="l07878"></a>07878                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l07879"></a>07879                 <span class="keywordflow">break</span>;
<a name="l07880"></a>07880             }
<a name="l07881"></a>07881             <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {
<a name="l07882"></a>07882                 $this-&gt;y = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> + round($h/2);
<a name="l07883"></a>07883                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l07884"></a>07884                 <span class="keywordflow">break</span>;
<a name="l07885"></a>07885             }
<a name="l07886"></a>07886             <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l07887"></a>07887                 $this-&gt;y = $this-&gt;img_rb_y;
<a name="l07888"></a>07888                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l07889"></a>07889                 <span class="keywordflow">break</span>;
<a name="l07890"></a>07890             }
<a name="l07891"></a>07891             <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>: {
<a name="l07892"></a>07892                 $this-&gt;<a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758" title="Moves the current abscissa back to the left margin and sets the ordinate.">SetY</a>($this-&gt;img_rb_y);
<a name="l07893"></a>07893                 <span class="keywordflow">break</span>;
<a name="l07894"></a>07894             }
<a name="l07895"></a>07895             <span class="keywordflow">default</span>:{
<a name="l07896"></a>07896                 <span class="keywordflow">break</span>;
<a name="l07897"></a>07897             }
<a name="l07898"></a>07898         }
<a name="l07899"></a>07899         $this-&gt;endlinex = $this-&gt;img_rb_x;
<a name="l07900"></a>07900         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l07901"></a>07901             <span class="comment">// we are inside an XObject template</span>
<a name="l07902"></a>07902             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;images&#39;</span>][] = $info[<span class="charliteral">&#39;i&#39;</span>];
<a name="l07903"></a>07903         }
<a name="l07904"></a>07904         <span class="keywordflow">return</span> $info[<span class="charliteral">&#39;i&#39;</span>];
<a name="l07905"></a>07905     }
<a name="l07906"></a>07906 <span class="comment"></span>
<a name="l07907"></a>07907 <span class="comment">    /**</span>
<a name="l07908"></a>07908 <span class="comment">     * Sets the current active configuration setting of magic_quotes_runtime (if the set_magic_quotes_runtime function exist)</span>
<a name="l07909"></a>07909 <span class="comment">     * @param $mqr (boolean) FALSE for off, TRUE for on.</span>
<a name="l07910"></a>07910 <span class="comment">     * @since 4.6.025 (2009-08-17)</span>
<a name="l07911"></a>07911 <span class="comment">     */</span>
<a name="l07912"></a><a class="code" href="classTCPDF.html#a5d0cc02ec71ae43461d8ece30f111b82">07912</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5d0cc02ec71ae43461d8ece30f111b82" title="Sets the current active configuration setting of magic_quotes_runtime (if the set_magic_quotes_runtim...">set_mqr</a>($mqr) {
<a name="l07913"></a>07913         <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;PHP_VERSION_ID&#39;</span>)) {
<a name="l07914"></a>07914             $version = PHP_VERSION;
<a name="l07915"></a>07915             define(<span class="stringliteral">&#39;PHP_VERSION_ID&#39;</span>, (($version{0} * 10000) + ($version{2} * 100) + $version{4}));
<a name="l07916"></a>07916         }
<a name="l07917"></a>07917         <span class="keywordflow">if</span> (PHP_VERSION_ID &lt; 50300) {
<a name="l07918"></a>07918             @set_magic_quotes_runtime($mqr);
<a name="l07919"></a>07919         }
<a name="l07920"></a>07920     }
<a name="l07921"></a>07921 <span class="comment"></span>
<a name="l07922"></a>07922 <span class="comment">    /**</span>
<a name="l07923"></a>07923 <span class="comment">     * Gets the current active configuration setting of magic_quotes_runtime (if the get_magic_quotes_runtime function exist)</span>
<a name="l07924"></a>07924 <span class="comment">     * @return Returns 0 if magic quotes runtime is off or get_magic_quotes_runtime doesn&#39;t exist, 1 otherwise.</span>
<a name="l07925"></a>07925 <span class="comment">     * @since 4.6.025 (2009-08-17)</span>
<a name="l07926"></a>07926 <span class="comment">     */</span>
<a name="l07927"></a><a class="code" href="classTCPDF.html#a46b50f52e64f63ab8256380aa874a864">07927</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a46b50f52e64f63ab8256380aa874a864" title="Gets the current active configuration setting of magic_quotes_runtime (if the get_magic_quotes_runtim...">get_mqr</a>() {
<a name="l07928"></a>07928         <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;PHP_VERSION_ID&#39;</span>)) {
<a name="l07929"></a>07929             $version = PHP_VERSION;
<a name="l07930"></a>07930             define(<span class="stringliteral">&#39;PHP_VERSION_ID&#39;</span>, (($version{0} * 10000) + ($version{2} * 100) + $version{4}));
<a name="l07931"></a>07931         }
<a name="l07932"></a>07932         <span class="keywordflow">if</span> (PHP_VERSION_ID &lt; 50300) {
<a name="l07933"></a>07933             <span class="keywordflow">return</span> @get_magic_quotes_runtime();
<a name="l07934"></a>07934         }
<a name="l07935"></a>07935         <span class="keywordflow">return</span> 0;
<a name="l07936"></a>07936     }
<a name="l07937"></a>07937 <span class="comment"></span>
<a name="l07938"></a>07938 <span class="comment">    /**</span>
<a name="l07939"></a>07939 <span class="comment">     * Convert the loaded image to a JPEG and then return a structure for the PDF creator.</span>
<a name="l07940"></a>07940 <span class="comment">     * This function requires GD library and write access to the directory defined on K_PATH_CACHE constant.</span>
<a name="l07941"></a>07941 <span class="comment">     * @param $image (image) Image object.</span>
<a name="l07942"></a>07942 <span class="comment">     * return image JPEG image object.</span>
<a name="l07943"></a>07943 <span class="comment">     * @protected</span>
<a name="l07944"></a>07944 <span class="comment">     */</span>
<a name="l07945"></a><a class="code" href="classTCPDF.html#a77c0b3ee8fbf87a93c8b2ee6deec69b6">07945</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a77c0b3ee8fbf87a93c8b2ee6deec69b6" title="Convert the loaded image to a JPEG and then return a structure for the PDF creator.">_toJPEG</a>($image) {
<a name="l07946"></a>07946         $tempname = tempnam(K_PATH_CACHE, <span class="stringliteral">&#39;jpg_&#39;</span>);
<a name="l07947"></a>07947         imagejpeg($image, $tempname, $this-&gt;jpeg_quality);
<a name="l07948"></a>07948         imagedestroy($image);
<a name="l07949"></a>07949         $retvars = $this-&gt;<a class="code" href="classTCPDF.html#a8c7676d84a0aceaec7dfa2ab2644a6ee" title="Extract info from a JPEG file without using the GD library.">_parsejpeg</a>($tempname);
<a name="l07950"></a>07950         <span class="comment">// tidy up by removing temporary image</span>
<a name="l07951"></a>07951         unlink($tempname);
<a name="l07952"></a>07952         <span class="keywordflow">return</span> $retvars;
<a name="l07953"></a>07953     }
<a name="l07954"></a>07954 <span class="comment"></span>
<a name="l07955"></a>07955 <span class="comment">    /**</span>
<a name="l07956"></a>07956 <span class="comment">     * Convert the loaded image to a PNG and then return a structure for the PDF creator.</span>
<a name="l07957"></a>07957 <span class="comment">     * This function requires GD library and write access to the directory defined on K_PATH_CACHE constant.</span>
<a name="l07958"></a>07958 <span class="comment">     * @param $image (image) Image object.</span>
<a name="l07959"></a>07959 <span class="comment">     * return image PNG image object.</span>
<a name="l07960"></a>07960 <span class="comment">     * @protected</span>
<a name="l07961"></a>07961 <span class="comment">     * @since 4.9.016 (2010-04-20)</span>
<a name="l07962"></a>07962 <span class="comment">     */</span>
<a name="l07963"></a><a class="code" href="classTCPDF.html#a9d1bdec637545a283ed4b40e4e79835d">07963</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9d1bdec637545a283ed4b40e4e79835d" title="Convert the loaded image to a PNG and then return a structure for the PDF creator.">_toPNG</a>($image) {
<a name="l07964"></a>07964         <span class="comment">// set temporary image file name</span>
<a name="l07965"></a>07965         $tempname = tempnam(K_PATH_CACHE, <span class="stringliteral">&#39;jpg_&#39;</span>);
<a name="l07966"></a>07966         <span class="comment">// turn off interlaced mode</span>
<a name="l07967"></a>07967         imageinterlace($image, 0);
<a name="l07968"></a>07968         <span class="comment">// create temporary PNG image</span>
<a name="l07969"></a>07969         imagepng($image, $tempname);
<a name="l07970"></a>07970         <span class="comment">// remove image from memory</span>
<a name="l07971"></a>07971         imagedestroy($image);
<a name="l07972"></a>07972         <span class="comment">// get PNG image data</span>
<a name="l07973"></a>07973         $retvars = $this-&gt;<a class="code" href="classTCPDF.html#ab5f623f6fe3f7f50661d8a3005fb25be" title="Extract info from a PNG file without using the GD library.">_parsepng</a>($tempname);
<a name="l07974"></a>07974         <span class="comment">// tidy up by removing temporary image</span>
<a name="l07975"></a>07975         unlink($tempname);
<a name="l07976"></a>07976         <span class="keywordflow">return</span> $retvars;
<a name="l07977"></a>07977     }
<a name="l07978"></a>07978 <span class="comment"></span>
<a name="l07979"></a>07979 <span class="comment">    /**</span>
<a name="l07980"></a>07980 <span class="comment">     * Set the transparency for the given GD image.</span>
<a name="l07981"></a>07981 <span class="comment">     * @param $new_image (image) GD image object</span>
<a name="l07982"></a>07982 <span class="comment">     * @param $image (image) GD image object.</span>
<a name="l07983"></a>07983 <span class="comment">     * return GD image object.</span>
<a name="l07984"></a>07984 <span class="comment">     * @protected</span>
<a name="l07985"></a>07985 <span class="comment">     * @since 4.9.016 (2010-04-20)</span>
<a name="l07986"></a>07986 <span class="comment">     */</span>
<a name="l07987"></a><a class="code" href="classTCPDF.html#a20f6b6bb1c90995584852e26c47be5a9">07987</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a20f6b6bb1c90995584852e26c47be5a9" title="Set the transparency for the given GD image.">_setGDImageTransparency</a>(<a class="code" href="thumbnail_8php.html#ae2ab07b86512840f8eab0e0a2706c3a5">$new_image</a>, $image) {
<a name="l07988"></a>07988         <span class="comment">// transparency index</span>
<a name="l07989"></a>07989         $tid = imagecolortransparent($image);
<a name="l07990"></a>07990         <span class="comment">// default transparency color</span>
<a name="l07991"></a>07991         $tcol = array(<span class="stringliteral">&#39;red&#39;</span> =&gt; 255, <span class="stringliteral">&#39;green&#39;</span> =&gt; 255, <span class="stringliteral">&#39;blue&#39;</span> =&gt; 255);
<a name="l07992"></a>07992         <span class="keywordflow">if</span> ($tid &gt;= 0) {
<a name="l07993"></a>07993             <span class="comment">// get the colors for the transparency index</span>
<a name="l07994"></a>07994             $tcol = imagecolorsforindex($image, $tid);
<a name="l07995"></a>07995         }
<a name="l07996"></a>07996         $tid = imagecolorallocate(<a class="code" href="thumbnail_8php.html#ae2ab07b86512840f8eab0e0a2706c3a5">$new_image</a>, $tcol[<span class="stringliteral">&#39;red&#39;</span>], $tcol[<span class="stringliteral">&#39;green&#39;</span>], $tcol[<span class="stringliteral">&#39;blue&#39;</span>]);
<a name="l07997"></a>07997         imagefill(<a class="code" href="thumbnail_8php.html#ae2ab07b86512840f8eab0e0a2706c3a5">$new_image</a>, 0, 0, $tid);
<a name="l07998"></a>07998         imagecolortransparent(<a class="code" href="thumbnail_8php.html#ae2ab07b86512840f8eab0e0a2706c3a5">$new_image</a>, $tid);
<a name="l07999"></a>07999         <span class="keywordflow">return</span> <a class="code" href="thumbnail_8php.html#ae2ab07b86512840f8eab0e0a2706c3a5">$new_image</a>;
<a name="l08000"></a>08000     }
<a name="l08001"></a>08001 <span class="comment"></span>
<a name="l08002"></a>08002 <span class="comment">    /**</span>
<a name="l08003"></a>08003 <span class="comment">     * Extract info from a JPEG file without using the GD library.</span>
<a name="l08004"></a>08004 <span class="comment">     * @param $file (string) image file to parse</span>
<a name="l08005"></a>08005 <span class="comment">     * @return array structure containing the image data</span>
<a name="l08006"></a>08006 <span class="comment">     * @protected</span>
<a name="l08007"></a>08007 <span class="comment">     */</span>
<a name="l08008"></a><a class="code" href="classTCPDF.html#a8c7676d84a0aceaec7dfa2ab2644a6ee">08008</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8c7676d84a0aceaec7dfa2ab2644a6ee" title="Extract info from a JPEG file without using the GD library.">_parsejpeg</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>) {
<a name="l08009"></a>08009         $a = getimagesize(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08010"></a>08010         <span class="keywordflow">if</span> (empty($a)) {
<a name="l08011"></a>08011             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Missing or incorrect image file: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08012"></a>08012         }
<a name="l08013"></a>08013         <span class="keywordflow">if</span> ($a[2] != 2) {
<a name="l08014"></a>08014             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Not a JPEG file: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08015"></a>08015         }
<a name="l08016"></a>08016         <span class="comment">// bits per pixel</span>
<a name="l08017"></a>08017         $bpc = isset($a[<span class="stringliteral">&#39;bits&#39;</span>]) ? intval($a[<span class="stringliteral">&#39;bits&#39;</span>]) : 8;
<a name="l08018"></a>08018         <span class="comment">// number of image channels</span>
<a name="l08019"></a>08019         <span class="keywordflow">if</span> (!isset($a[<span class="stringliteral">&#39;channels&#39;</span>])) {
<a name="l08020"></a>08020             $channels = 3;
<a name="l08021"></a>08021         } <span class="keywordflow">else</span> {
<a name="l08022"></a>08022             $channels = intval($a[<span class="stringliteral">&#39;channels&#39;</span>]);
<a name="l08023"></a>08023         }
<a name="l08024"></a>08024         <span class="comment">// default colour space</span>
<a name="l08025"></a>08025         <span class="keywordflow">switch</span> ($channels) {
<a name="l08026"></a>08026             <span class="keywordflow">case</span> 1: {
<a name="l08027"></a>08027                 $colspace = <span class="stringliteral">&#39;DeviceGray&#39;</span>;
<a name="l08028"></a>08028                 <span class="keywordflow">break</span>;
<a name="l08029"></a>08029             }
<a name="l08030"></a>08030             <span class="keywordflow">case</span> 3: {
<a name="l08031"></a>08031                 $colspace = <span class="stringliteral">&#39;DeviceRGB&#39;</span>;
<a name="l08032"></a>08032                 <span class="keywordflow">break</span>;
<a name="l08033"></a>08033             }
<a name="l08034"></a>08034             <span class="keywordflow">case</span> 4: {
<a name="l08035"></a>08035                 $colspace = <span class="stringliteral">&#39;DeviceCMYK&#39;</span>;
<a name="l08036"></a>08036                 <span class="keywordflow">break</span>;
<a name="l08037"></a>08037             }
<a name="l08038"></a>08038             <span class="keywordflow">default</span>: {
<a name="l08039"></a>08039                 $channels = 3;
<a name="l08040"></a>08040                 $colspace = <span class="stringliteral">&#39;DeviceRGB&#39;</span>;
<a name="l08041"></a>08041                 <span class="keywordflow">break</span>;
<a name="l08042"></a>08042             }
<a name="l08043"></a>08043         }
<a name="l08044"></a>08044         <span class="comment">// get file content</span>
<a name="l08045"></a>08045         <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = file_get_contents(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08046"></a>08046         <span class="comment">// check for embedded ICC profile</span>
<a name="l08047"></a>08047         $icc = array();
<a name="l08048"></a>08048         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0;
<a name="l08049"></a>08049         <span class="keywordflow">while</span> ((<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <span class="stringliteral">&quot;ICC_PROFILE\0&quot;</span>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>)) !== <span class="keyword">false</span>) {
<a name="l08050"></a>08050             <span class="comment">// get ICC sequence length</span>
<a name="l08051"></a>08051             $length = ($this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> - 2)) - 16);
<a name="l08052"></a>08052             <span class="comment">// marker sequence number</span>
<a name="l08053"></a>08053             $msn = max(1, ord(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[(<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + 12)]));
<a name="l08054"></a>08054             <span class="comment">// number of markers (total of APP2 used)</span>
<a name="l08055"></a>08055             $nom = max(1, ord(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[(<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + 13)]));
<a name="l08056"></a>08056             <span class="comment">// get sequence segment</span>
<a name="l08057"></a>08057             $icc[($msn - 1)] = substr(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + 14), $length);
<a name="l08058"></a>08058             <span class="comment">// move forward to next sequence</span>
<a name="l08059"></a>08059             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + 14 + $length);
<a name="l08060"></a>08060         }
<a name="l08061"></a>08061         <span class="comment">// order and compact ICC segments</span>
<a name="l08062"></a>08062         <span class="keywordflow">if</span> (count($icc) &gt; 0) {
<a name="l08063"></a>08063             ksort($icc);
<a name="l08064"></a>08064             $icc = implode(<span class="stringliteral">&#39;&#39;</span>, $icc);
<a name="l08065"></a>08065             <span class="keywordflow">if</span> ((ord($icc{36}) != 0x61) OR (ord($icc{37}) != 0x63) OR (ord($icc{38}) != 0x73) OR (ord($icc{39}) != 0x70)) {
<a name="l08066"></a>08066                 <span class="comment">// invalid ICC profile</span>
<a name="l08067"></a>08067                 $icc = <span class="keyword">false</span>;
<a name="l08068"></a>08068             }
<a name="l08069"></a>08069         } <span class="keywordflow">else</span> {
<a name="l08070"></a>08070             $icc = <span class="keyword">false</span>;
<a name="l08071"></a>08071         }
<a name="l08072"></a>08072         <span class="keywordflow">return</span> array(<span class="charliteral">&#39;w&#39;</span> =&gt; $a[0], <span class="charliteral">&#39;h&#39;</span> =&gt; $a[1], <span class="stringliteral">&#39;ch&#39;</span> =&gt; $channels, <span class="stringliteral">&#39;icc&#39;</span> =&gt; $icc, <span class="stringliteral">&#39;cs&#39;</span> =&gt; $colspace, <span class="stringliteral">&#39;bpc&#39;</span> =&gt; $bpc, <span class="charliteral">&#39;f&#39;</span> =&gt; <span class="stringliteral">&#39;DCTDecode&#39;</span>, <span class="stringliteral">&#39;data&#39;</span> =&gt; <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l08073"></a>08073     }
<a name="l08074"></a>08074 <span class="comment"></span>
<a name="l08075"></a>08075 <span class="comment">    /**</span>
<a name="l08076"></a>08076 <span class="comment">     * Extract info from a PNG file without using the GD library.</span>
<a name="l08077"></a>08077 <span class="comment">     * @param $file (string) image file to parse</span>
<a name="l08078"></a>08078 <span class="comment">     * @return array structure containing the image data</span>
<a name="l08079"></a>08079 <span class="comment">     * @protected</span>
<a name="l08080"></a>08080 <span class="comment">     */</span>
<a name="l08081"></a><a class="code" href="classTCPDF.html#ab5f623f6fe3f7f50661d8a3005fb25be">08081</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab5f623f6fe3f7f50661d8a3005fb25be" title="Extract info from a PNG file without using the GD library.">_parsepng</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>) {
<a name="l08082"></a>08082         <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = fopen(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">&#39;rb&#39;</span>);
<a name="l08083"></a>08083         <span class="keywordflow">if</span> (<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> === <span class="keyword">false</span>) {
<a name="l08084"></a>08084             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Can\&#39;t open image file: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08085"></a>08085         }
<a name="l08086"></a>08086         <span class="comment">//Check signature</span>
<a name="l08087"></a>08087         <span class="keywordflow">if</span> (fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 8) != chr(137).<span class="stringliteral">&#39;PNG&#39;</span>.chr(13).chr(10).chr(26).chr(10)) {
<a name="l08088"></a>08088             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Not a PNG file: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08089"></a>08089         }
<a name="l08090"></a>08090         <span class="comment">//Read header chunk</span>
<a name="l08091"></a>08091         fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 4);
<a name="l08092"></a>08092         <span class="keywordflow">if</span> (fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 4) != <span class="stringliteral">&#39;IHDR&#39;</span>) {
<a name="l08093"></a>08093             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Incorrect PNG file: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08094"></a>08094         }
<a name="l08095"></a>08095         <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a> = $this-&gt;<a class="code" href="classTCPDF.html#a93c322bd214bd06c217f600de0fb5fba" title="Read a 4-byte (32 bit) integer from file.">_freadint</a>(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08096"></a>08096         <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a> = $this-&gt;<a class="code" href="classTCPDF.html#a93c322bd214bd06c217f600de0fb5fba" title="Read a 4-byte (32 bit) integer from file.">_freadint</a>(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08097"></a>08097         $bpc = ord(fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 1));
<a name="l08098"></a>08098         <span class="keywordflow">if</span> ($bpc &gt; 8) {
<a name="l08099"></a>08099             <span class="comment">//$this-&gt;Error(&#39;16-bit depth not supported: &#39;.$file);</span>
<a name="l08100"></a>08100             fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08101"></a>08101             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l08102"></a>08102         }
<a name="l08103"></a>08103         $ct = ord(fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 1));
<a name="l08104"></a>08104         <span class="keywordflow">if</span> ($ct == 0) {
<a name="l08105"></a>08105             $colspace = <span class="stringliteral">&#39;DeviceGray&#39;</span>;
<a name="l08106"></a>08106         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($ct == 2) {
<a name="l08107"></a>08107             $colspace = <span class="stringliteral">&#39;DeviceRGB&#39;</span>;
<a name="l08108"></a>08108         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($ct == 3) {
<a name="l08109"></a>08109             $colspace = <span class="stringliteral">&#39;Indexed&#39;</span>;
<a name="l08110"></a>08110         } <span class="keywordflow">else</span> {
<a name="l08111"></a>08111             <span class="comment">// alpha channel</span>
<a name="l08112"></a>08112             fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08113"></a>08113             <span class="keywordflow">return</span> <span class="stringliteral">&#39;pngalpha&#39;</span>;
<a name="l08114"></a>08114         }
<a name="l08115"></a>08115         <span class="keywordflow">if</span> (ord(fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 1)) != 0) {
<a name="l08116"></a>08116             <span class="comment">//$this-&gt;Error(&#39;Unknown compression method: &#39;.$file);</span>
<a name="l08117"></a>08117             fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08118"></a>08118             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l08119"></a>08119         }
<a name="l08120"></a>08120         <span class="keywordflow">if</span> (ord(fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 1)) != 0) {
<a name="l08121"></a>08121             <span class="comment">//$this-&gt;Error(&#39;Unknown filter method: &#39;.$file);</span>
<a name="l08122"></a>08122             fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08123"></a>08123             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l08124"></a>08124         }
<a name="l08125"></a>08125         <span class="keywordflow">if</span> (ord(fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 1)) != 0) {
<a name="l08126"></a>08126             <span class="comment">//$this-&gt;Error(&#39;Interlacing not supported: &#39;.$file);</span>
<a name="l08127"></a>08127             fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08128"></a>08128             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l08129"></a>08129         }
<a name="l08130"></a>08130         fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 4);
<a name="l08131"></a>08131         $channels = ($ct == 2 ? 3 : 1);
<a name="l08132"></a>08132         $parms = <span class="stringliteral">&#39;/DecodeParms &lt;&lt; /Predictor 15 /Colors &#39;</span>.$channels.<span class="stringliteral">&#39; /BitsPerComponent &#39;</span>.$bpc.<span class="stringliteral">&#39; /Columns &#39;</span>.<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l08133"></a>08133         <span class="comment">//Scan chunks looking for palette, transparency and image data</span>
<a name="l08134"></a>08134         $pal = <span class="stringliteral">&#39;&#39;</span>;
<a name="l08135"></a>08135         $trns = <span class="stringliteral">&#39;&#39;</span>;
<a name="l08136"></a>08136         <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l08137"></a>08137         $icc = <span class="keyword">false</span>;
<a name="l08138"></a>08138         <span class="keywordflow">do</span> {
<a name="l08139"></a>08139             <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a> = $this-&gt;<a class="code" href="classTCPDF.html#a93c322bd214bd06c217f600de0fb5fba" title="Read a 4-byte (32 bit) integer from file.">_freadint</a>(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08140"></a>08140             <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 4);
<a name="l08141"></a>08141             <span class="keywordflow">if</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;PLTE&#39;</span>) {
<a name="l08142"></a>08142                 <span class="comment">// read palette</span>
<a name="l08143"></a>08143                 $pal = $this-&gt;<a class="code" href="classTCPDF.html#a9b42842de5a35a9ca87c4b0a7bef1905" title="Binary-safe and URL-safe file read.">rfread</a>(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>);
<a name="l08144"></a>08144                 fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 4);
<a name="l08145"></a>08145             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;tRNS&#39;</span>) {
<a name="l08146"></a>08146                 <span class="comment">// read transparency info</span>
<a name="l08147"></a>08147                 $t = $this-&gt;<a class="code" href="classTCPDF.html#a9b42842de5a35a9ca87c4b0a7bef1905" title="Binary-safe and URL-safe file read.">rfread</a>(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>);
<a name="l08148"></a>08148                 <span class="keywordflow">if</span> ($ct == 0) {
<a name="l08149"></a>08149                     $trns = array(ord($t{1}));
<a name="l08150"></a>08150                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($ct == 2) {
<a name="l08151"></a>08151                     $trns = array(ord($t{1}), ord($t{3}), ord($t{5}));
<a name="l08152"></a>08152                 } <span class="keywordflow">else</span> {
<a name="l08153"></a>08153                     <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos($t, chr(0));
<a name="l08154"></a>08154                     <span class="keywordflow">if</span> (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> !== <span class="keyword">false</span>) {
<a name="l08155"></a>08155                         $trns = array(<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>);
<a name="l08156"></a>08156                     }
<a name="l08157"></a>08157                 }
<a name="l08158"></a>08158                 fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 4);
<a name="l08159"></a>08159             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;IDAT&#39;</span>) {
<a name="l08160"></a>08160                 <span class="comment">// read image data block</span>
<a name="l08161"></a>08161                 <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> .= $this-&gt;<a class="code" href="classTCPDF.html#a9b42842de5a35a9ca87c4b0a7bef1905" title="Binary-safe and URL-safe file read.">rfread</a>(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>);
<a name="l08162"></a>08162                 fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 4);
<a name="l08163"></a>08163             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;iCCP&#39;</span>) {
<a name="l08164"></a>08164                 <span class="comment">// skip profile name and null separator</span>
<a name="l08165"></a>08165                 <a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a> = 0;
<a name="l08166"></a>08166                 <span class="keywordflow">while</span> ((ord(fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 1)) &gt; 0) AND (<a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a> &lt; 80)) {
<a name="l08167"></a>08167                     ++<a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a>;
<a name="l08168"></a>08168                 }
<a name="l08169"></a>08169                 <span class="comment">// get compression method</span>
<a name="l08170"></a>08170                 <span class="keywordflow">if</span> (ord(fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 1)) != 0) {
<a name="l08171"></a>08171                     <span class="comment">//$this-&gt;Error(&#39;Unknown filter method: &#39;.$file);</span>
<a name="l08172"></a>08172                     fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08173"></a>08173                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l08174"></a>08174                 }
<a name="l08175"></a>08175                 <span class="comment">// read ICC Color Profile</span>
<a name="l08176"></a>08176                 $icc = $this-&gt;<a class="code" href="classTCPDF.html#a9b42842de5a35a9ca87c4b0a7bef1905" title="Binary-safe and URL-safe file read.">rfread</a>(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, (<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a> - <a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a> - 2));
<a name="l08177"></a>08177                 <span class="comment">// decompress profile</span>
<a name="l08178"></a>08178                 $icc = gzuncompress($icc);
<a name="l08179"></a>08179                 fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 4);
<a name="l08180"></a>08180             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;IEND&#39;</span>) {
<a name="l08181"></a>08181                 <span class="keywordflow">break</span>;
<a name="l08182"></a>08182             } <span class="keywordflow">else</span> {
<a name="l08183"></a>08183                 $this-&gt;<a class="code" href="classTCPDF.html#a9b42842de5a35a9ca87c4b0a7bef1905" title="Binary-safe and URL-safe file read.">rfread</a>(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a> + 4);
<a name="l08184"></a>08184             }
<a name="l08185"></a>08185         } <span class="keywordflow">while</span> (<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>);
<a name="l08186"></a>08186         <span class="keywordflow">if</span> (($colspace == <span class="stringliteral">&#39;Indexed&#39;</span>) AND (empty($pal))) {
<a name="l08187"></a>08187             <span class="comment">//$this-&gt;Error(&#39;Missing palette in &#39;.$file);</span>
<a name="l08188"></a>08188             fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08189"></a>08189             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l08190"></a>08190         }
<a name="l08191"></a>08191         fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08192"></a>08192         <span class="keywordflow">return</span> array(<span class="charliteral">&#39;w&#39;</span> =&gt; <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <span class="charliteral">&#39;h&#39;</span> =&gt; <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;ch&#39;</span> =&gt; $channels, <span class="stringliteral">&#39;icc&#39;</span> =&gt; $icc, <span class="stringliteral">&#39;cs&#39;</span> =&gt; $colspace, <span class="stringliteral">&#39;bpc&#39;</span> =&gt; $bpc, <span class="charliteral">&#39;f&#39;</span> =&gt; <span class="stringliteral">&#39;FlateDecode&#39;</span>, <span class="stringliteral">&#39;parms&#39;</span> =&gt; $parms, <span class="stringliteral">&#39;pal&#39;</span> =&gt; $pal, <span class="stringliteral">&#39;trns&#39;</span> =&gt; $trns, <span class="stringliteral">&#39;data&#39;</span> =&gt; <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l08193"></a>08193     }
<a name="l08194"></a>08194 <span class="comment"></span>
<a name="l08195"></a>08195 <span class="comment">    /**</span>
<a name="l08196"></a>08196 <span class="comment">     * Binary-safe and URL-safe file read.</span>
<a name="l08197"></a>08197 <span class="comment">     * Reads up to length bytes from the file pointer referenced by handle. Reading stops as soon as one of the following conditions is met: length bytes have been read; EOF (end of file) is reached.</span>
<a name="l08198"></a>08198 <span class="comment">     * @param $handle (resource)</span>
<a name="l08199"></a>08199 <span class="comment">     * @param $length (int)</span>
<a name="l08200"></a>08200 <span class="comment">     * @return Returns the read string or FALSE in case of error.</span>
<a name="l08201"></a>08201 <span class="comment">     * @author Nicola Asuni</span>
<a name="l08202"></a>08202 <span class="comment">     * @protected</span>
<a name="l08203"></a>08203 <span class="comment">     * @since 4.5.027 (2009-03-16)</span>
<a name="l08204"></a>08204 <span class="comment">     */</span>
<a name="l08205"></a><a class="code" href="classTCPDF.html#a9b42842de5a35a9ca87c4b0a7bef1905">08205</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9b42842de5a35a9ca87c4b0a7bef1905" title="Binary-safe and URL-safe file read.">rfread</a>($handle, $length) {
<a name="l08206"></a>08206         <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = fread($handle, $length);
<a name="l08207"></a>08207         <span class="keywordflow">if</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> === <span class="keyword">false</span>) {
<a name="l08208"></a>08208             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l08209"></a>08209         }
<a name="l08210"></a>08210         $rest = $length - strlen(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l08211"></a>08211         <span class="keywordflow">if</span> ($rest &gt; 0) {
<a name="l08212"></a>08212             <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> .= $this-&gt;<a class="code" href="classTCPDF.html#a9b42842de5a35a9ca87c4b0a7bef1905" title="Binary-safe and URL-safe file read.">rfread</a>($handle, $rest);
<a name="l08213"></a>08213         }
<a name="l08214"></a>08214         <span class="keywordflow">return</span> <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l08215"></a>08215     }
<a name="l08216"></a>08216 <span class="comment"></span>
<a name="l08217"></a>08217 <span class="comment">    /**</span>
<a name="l08218"></a>08218 <span class="comment">     * Extract info from a PNG image with alpha channel using the GD library.</span>
<a name="l08219"></a>08219 <span class="comment">     * @param $file (string) Name of the file containing the image.</span>
<a name="l08220"></a>08220 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner.</span>
<a name="l08221"></a>08221 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner.</span>
<a name="l08222"></a>08222 <span class="comment">     * @param $wpx (float) Original width of the image in pixels.</span>
<a name="l08223"></a>08223 <span class="comment">     * @param $hpx (float) original height of the image in pixels.</span>
<a name="l08224"></a>08224 <span class="comment">     * @param $w (float) Width of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
<a name="l08225"></a>08225 <span class="comment">     * @param $h (float) Height of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
<a name="l08226"></a>08226 <span class="comment">     * @param $type (string) Image format. Possible values are (case insensitive): JPEG and PNG (whitout GD library) and all images supported by GD: GD, GD2, GD2PART, GIF, JPEG, PNG, BMP, XBM, XPM;. If not specified, the type is inferred from the file extension.</span>
<a name="l08227"></a>08227 <span class="comment">     * @param $link (mixed) URL or identifier returned by AddLink().</span>
<a name="l08228"></a>08228 <span class="comment">     * @param $align (string) Indicates the alignment of the pointer next to image insertion relative to image height. The value can be:&lt;ul&gt;&lt;li&gt;T: top-right for LTR or top-left for RTL&lt;/li&gt;&lt;li&gt;M: middle-right for LTR or middle-left for RTL&lt;/li&gt;&lt;li&gt;B: bottom-right for LTR or bottom-left for RTL&lt;/li&gt;&lt;li&gt;N: next line&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l08229"></a>08229 <span class="comment">     * @param $resize (boolean) If true resize (reduce) the image to fit $w and $h (requires GD library).</span>
<a name="l08230"></a>08230 <span class="comment">     * @param $dpi (int) dot-per-inch resolution used on resize</span>
<a name="l08231"></a>08231 <span class="comment">     * @param $palign (string) Allows to center or align the image on the current line. Possible values are:&lt;ul&gt;&lt;li&gt;L : left align&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;R : right align&lt;/li&gt;&lt;li&gt;&#39;&#39; : empty string : left for LTR or right for RTL&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l08232"></a>08232 <span class="comment">     * @param $filehash (string) File hash used to build unique file names.</span>
<a name="l08233"></a>08233 <span class="comment">     * @author Nicola Asuni</span>
<a name="l08234"></a>08234 <span class="comment">     * @protected</span>
<a name="l08235"></a>08235 <span class="comment">     * @since 4.3.007 (2008-12-04)</span>
<a name="l08236"></a>08236 <span class="comment">     * @see Image()</span>
<a name="l08237"></a>08237 <span class="comment">     */</span>
<a name="l08238"></a><a class="code" href="classTCPDF.html#a63318e9e32a06621bb98c59cd660a835">08238</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a63318e9e32a06621bb98c59cd660a835" title="Extract info from a PNG image with alpha channel using the GD library.">ImagePngAlpha</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, $wpx, $hpx, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $link, $align, $resize, <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a>, $palign, $filehash=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l08239"></a>08239         <span class="keywordflow">if</span> (empty($filehash)) {
<a name="l08240"></a>08240             $filehash = md5(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08241"></a>08241         }
<a name="l08242"></a>08242         <span class="comment">// create temp image file (without alpha channel)</span>
<a name="l08243"></a>08243         $tempfile_plain = K_PATH_CACHE.<span class="stringliteral">&#39;mskp_&#39;</span>.$filehash;
<a name="l08244"></a>08244         <span class="comment">// create temp alpha file</span>
<a name="l08245"></a>08245         $tempfile_alpha = K_PATH_CACHE.<span class="stringliteral">&#39;mska_&#39;</span>.$filehash;
<a name="l08246"></a>08246         <span class="keywordflow">if</span> (extension_loaded(<span class="stringliteral">&#39;imagick&#39;</span>)) { <span class="comment">// ImageMagick extension</span>
<a name="l08247"></a>08247             <span class="comment">// ImageMagick library</span>
<a name="l08248"></a>08248             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = <span class="keyword">new</span> Imagick();
<a name="l08249"></a>08249             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;readImage(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08250"></a>08250             <span class="comment">// clone image object</span>
<a name="l08251"></a>08251             $imga = <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;clone();
<a name="l08252"></a>08252             <span class="comment">// extract alpha channel</span>
<a name="l08253"></a>08253             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;separateImageChannel(8); <span class="comment">// 8 = (imagick::CHANNEL_ALPHA | imagick::CHANNEL_OPACITY | imagick::CHANNEL_MATTE);</span>
<a name="l08254"></a>08254             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;negateImage(<span class="keyword">true</span>);
<a name="l08255"></a>08255             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;setImageFormat(<span class="stringliteral">&#39;png&#39;</span>);
<a name="l08256"></a>08256             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>-&gt;writeImage($tempfile_alpha);
<a name="l08257"></a>08257             <span class="comment">// remove alpha channel</span>
<a name="l08258"></a>08258             $imga-&gt;separateImageChannel(39); <span class="comment">// 39 = (imagick::CHANNEL_ALL &amp; ~(imagick::CHANNEL_ALPHA | imagick::CHANNEL_OPACITY | imagick::CHANNEL_MATTE));</span>
<a name="l08259"></a>08259             $imga-&gt;setImageFormat(<span class="stringliteral">&#39;png&#39;</span>);
<a name="l08260"></a>08260             $imga-&gt;writeImage($tempfile_plain);
<a name="l08261"></a>08261         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (function_exists(<span class="stringliteral">&#39;imagecreatefrompng&#39;</span>)) { <span class="comment">// GD extension</span>
<a name="l08262"></a>08262             <span class="comment">// generate images</span>
<a name="l08263"></a>08263             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = imagecreatefrompng(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l08264"></a>08264             $imgalpha = imagecreate($wpx, $hpx);
<a name="l08265"></a>08265             <span class="comment">// generate gray scale palette (0 -&gt; 255)</span>
<a name="l08266"></a>08266             <span class="keywordflow">for</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = 0; <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt; 256; ++<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l08267"></a>08267                 ImageColorAllocate($imgalpha, <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>);
<a name="l08268"></a>08268             }
<a name="l08269"></a>08269             <span class="comment">// extract alpha channel</span>
<a name="l08270"></a>08270             <span class="keywordflow">for</span> ($xpx = 0; $xpx &lt; $wpx; ++$xpx) {
<a name="l08271"></a>08271                 <span class="keywordflow">for</span> ($ypx = 0; $ypx &lt; $hpx; ++$ypx) {
<a name="l08272"></a>08272                     $color = imagecolorat(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>, $xpx, $ypx);
<a name="l08273"></a>08273                     $alpha = ($color &gt;&gt; 24); <span class="comment">// shifts off the first 24 bits (where 8x3 are used for each color), and returns the remaining 7 allocated bits (commonly used for alpha)</span>
<a name="l08274"></a>08274                     $alpha = (((127 - $alpha) / 127) * 255); <span class="comment">// GD alpha is only 7 bit (0 -&gt; 127)</span>
<a name="l08275"></a>08275                     $alpha = $this-&gt;<a class="code" href="classTCPDF.html#af83ef8b2d47f515e1513bb062f7f51a7" title="Correct the gamma value to be used with GD library.">getGDgamma</a>($alpha); <span class="comment">// correct gamma</span>
<a name="l08276"></a>08276                     imagesetpixel($imgalpha, $xpx, $ypx, $alpha);
<a name="l08277"></a>08277                 }
<a name="l08278"></a>08278             }
<a name="l08279"></a>08279             imagepng($imgalpha, $tempfile_alpha);
<a name="l08280"></a>08280             imagedestroy($imgalpha);
<a name="l08281"></a>08281             <span class="comment">// extract image without alpha channel</span>
<a name="l08282"></a>08282             $imgplain = imagecreatetruecolor($wpx, $hpx);
<a name="l08283"></a>08283             imagecopy($imgplain, <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>, 0, 0, 0, 0, $wpx, $hpx);
<a name="l08284"></a>08284             imagepng($imgplain, $tempfile_plain);
<a name="l08285"></a>08285             imagedestroy($imgplain);
<a name="l08286"></a>08286         } <span class="keywordflow">else</span> {
<a name="l08287"></a>08287             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;TCPDF requires the Imagick or GD extension to handle PNG images with alpha channel.&#39;</span>);
<a name="l08288"></a>08288         }
<a name="l08289"></a>08289         <span class="comment">// embed mask image</span>
<a name="l08290"></a>08290         $imgmask = $this-&gt;<a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352" title="Puts an image in the page.">Image</a>($tempfile_alpha, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <span class="stringliteral">&#39;PNG&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $resize, <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);
<a name="l08291"></a>08291         <span class="comment">// embed image, masked with previously embedded mask</span>
<a name="l08292"></a>08292         $this-&gt;<a class="code" href="classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352" title="Puts an image in the page.">Image</a>($tempfile_plain, <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $link, $align, $resize, <a class="code" href="classTCPDF.html#a22272525668774dab75d46dfd66ff2f2" title="DPI (Dot Per Inch) Document Resolution (do not change).">$dpi</a>, $palign, <span class="keyword">false</span>, $imgmask);
<a name="l08293"></a>08293         <span class="comment">// remove temp files</span>
<a name="l08294"></a>08294         unlink($tempfile_alpha);
<a name="l08295"></a>08295         unlink($tempfile_plain);
<a name="l08296"></a>08296     }
<a name="l08297"></a>08297 <span class="comment"></span>
<a name="l08298"></a>08298 <span class="comment">    /**</span>
<a name="l08299"></a>08299 <span class="comment">     * Correct the gamma value to be used with GD library</span>
<a name="l08300"></a>08300 <span class="comment">     * @param $v (float) the gamma value to be corrected</span>
<a name="l08301"></a>08301 <span class="comment">     * @protected</span>
<a name="l08302"></a>08302 <span class="comment">     * @since 4.3.007 (2008-12-04)</span>
<a name="l08303"></a>08303 <span class="comment">     */</span>
<a name="l08304"></a><a class="code" href="classTCPDF.html#af83ef8b2d47f515e1513bb062f7f51a7">08304</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af83ef8b2d47f515e1513bb062f7f51a7" title="Correct the gamma value to be used with GD library.">getGDgamma</a>($v) {
<a name="l08305"></a>08305         <span class="keywordflow">return</span> (pow(($v / 255), 2.2) * 255);
<a name="l08306"></a>08306     }
<a name="l08307"></a>08307 <span class="comment"></span>
<a name="l08308"></a>08308 <span class="comment">    /**</span>
<a name="l08309"></a>08309 <span class="comment">     * Performs a line break.</span>
<a name="l08310"></a>08310 <span class="comment">     * The current abscissa goes back to the left margin and the ordinate increases by the amount passed in parameter.</span>
<a name="l08311"></a>08311 <span class="comment">     * @param $h (float) The height of the break. By default, the value equals the height of the last printed cell.</span>
<a name="l08312"></a>08312 <span class="comment">     * @param $cell (boolean) if true add the current left (or right o for RTL) padding to the X coordinate</span>
<a name="l08313"></a>08313 <span class="comment">     * @public</span>
<a name="l08314"></a>08314 <span class="comment">     * @since 1.0</span>
<a name="l08315"></a>08315 <span class="comment">     * @see Cell()</span>
<a name="l08316"></a>08316 <span class="comment">     */</span>
<a name="l08317"></a><a class="code" href="classTCPDF.html#a00969cf629d72b3d29ee435f15906820">08317</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a00969cf629d72b3d29ee435f15906820" title="Performs a line break.">Ln</a>(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>=<span class="stringliteral">&#39;&#39;</span>, $cell=<span class="keyword">false</span>) {
<a name="l08318"></a>08318         <span class="keywordflow">if</span> (($this-&gt;num_columns &gt; 1) AND ($this-&gt;y == $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;y&#39;</span>]) AND isset($this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>]) AND ($this-&gt;x == $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>])) {
<a name="l08319"></a>08319             <span class="comment">// revove vertical space from the top of the column</span>
<a name="l08320"></a>08320             <span class="keywordflow">return</span>;
<a name="l08321"></a>08321         }
<a name="l08322"></a>08322         <span class="keywordflow">if</span> ($cell) {
<a name="l08323"></a>08323             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l08324"></a>08324                 $cellpadding = $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l08325"></a>08325             } <span class="keywordflow">else</span> {
<a name="l08326"></a>08326                 $cellpadding = $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];
<a name="l08327"></a>08327             }
<a name="l08328"></a>08328         } <span class="keywordflow">else</span> {
<a name="l08329"></a>08329             $cellpadding = 0;
<a name="l08330"></a>08330         }
<a name="l08331"></a>08331         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l08332"></a>08332             $this-&gt;x = $this-&gt;w - $this-&gt;rMargin - $cellpadding;
<a name="l08333"></a>08333         } <span class="keywordflow">else</span> {
<a name="l08334"></a>08334             $this-&gt;x = $this-&gt;lMargin + $cellpadding;
<a name="l08335"></a>08335         }
<a name="l08336"></a>08336         <span class="keywordflow">if</span> (is_string(<a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>)) {
<a name="l08337"></a>08337             $this-&gt;y += $this-&gt;lasth;
<a name="l08338"></a>08338         } <span class="keywordflow">else</span> {
<a name="l08339"></a>08339             $this-&gt;y += <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>;
<a name="l08340"></a>08340         }
<a name="l08341"></a>08341         $this-&gt;newline = <span class="keyword">true</span>;
<a name="l08342"></a>08342     }
<a name="l08343"></a>08343 <span class="comment"></span>
<a name="l08344"></a>08344 <span class="comment">    /**</span>
<a name="l08345"></a>08345 <span class="comment">     * Returns the relative X value of current position.</span>
<a name="l08346"></a>08346 <span class="comment">     * The value is relative to the left border for LTR languages and to the right border for RTL languages.</span>
<a name="l08347"></a>08347 <span class="comment">     * @return float</span>
<a name="l08348"></a>08348 <span class="comment">     * @public</span>
<a name="l08349"></a>08349 <span class="comment">     * @since 1.2</span>
<a name="l08350"></a>08350 <span class="comment">     * @see SetX(), GetY(), SetY()</span>
<a name="l08351"></a>08351 <span class="comment">     */</span>
<a name="l08352"></a><a class="code" href="classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">08352</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a415a80a301208fa77552048b27d2e0ce" title="Returns the relative X value of current position.">GetX</a>() {
<a name="l08353"></a>08353         <span class="comment">//Get x position</span>
<a name="l08354"></a>08354         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l08355"></a>08355             <span class="keywordflow">return</span> ($this-&gt;w - $this-&gt;x);
<a name="l08356"></a>08356         } <span class="keywordflow">else</span> {
<a name="l08357"></a>08357             <span class="keywordflow">return</span> $this-&gt;x;
<a name="l08358"></a>08358         }
<a name="l08359"></a>08359     }
<a name="l08360"></a>08360 <span class="comment"></span>
<a name="l08361"></a>08361 <span class="comment">    /**</span>
<a name="l08362"></a>08362 <span class="comment">     * Returns the absolute X value of current position.</span>
<a name="l08363"></a>08363 <span class="comment">     * @return float</span>
<a name="l08364"></a>08364 <span class="comment">     * @public</span>
<a name="l08365"></a>08365 <span class="comment">     * @since 1.2</span>
<a name="l08366"></a>08366 <span class="comment">     * @see SetX(), GetY(), SetY()</span>
<a name="l08367"></a>08367 <span class="comment">     */</span>
<a name="l08368"></a><a class="code" href="classTCPDF.html#a5c834acaa7ef363abc6bca4ab8545432">08368</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5c834acaa7ef363abc6bca4ab8545432" title="Returns the absolute X value of current position.">GetAbsX</a>() {
<a name="l08369"></a>08369         <span class="keywordflow">return</span> $this-&gt;x;
<a name="l08370"></a>08370     }
<a name="l08371"></a>08371 <span class="comment"></span>
<a name="l08372"></a>08372 <span class="comment">    /**</span>
<a name="l08373"></a>08373 <span class="comment">     * Returns the ordinate of the current position.</span>
<a name="l08374"></a>08374 <span class="comment">     * @return float</span>
<a name="l08375"></a>08375 <span class="comment">     * @public</span>
<a name="l08376"></a>08376 <span class="comment">     * @since 1.0</span>
<a name="l08377"></a>08377 <span class="comment">     * @see SetY(), GetX(), SetX()</span>
<a name="l08378"></a>08378 <span class="comment">     */</span>
<a name="l08379"></a><a class="code" href="classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">08379</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799" title="Returns the ordinate of the current position.">GetY</a>() {
<a name="l08380"></a>08380         <span class="keywordflow">return</span> $this-&gt;y;
<a name="l08381"></a>08381     }
<a name="l08382"></a>08382 <span class="comment"></span>
<a name="l08383"></a>08383 <span class="comment">    /**</span>
<a name="l08384"></a>08384 <span class="comment">     * Defines the abscissa of the current position.</span>
<a name="l08385"></a>08385 <span class="comment">     * If the passed value is negative, it is relative to the right of the page (or left if language is RTL).</span>
<a name="l08386"></a>08386 <span class="comment">     * @param $x (float) The value of the abscissa.</span>
<a name="l08387"></a>08387 <span class="comment">     * @param $rtloff (boolean) if true always uses the page top-left corner as origin of axis.</span>
<a name="l08388"></a>08388 <span class="comment">     * @public</span>
<a name="l08389"></a>08389 <span class="comment">     * @since 1.2</span>
<a name="l08390"></a>08390 <span class="comment">     * @see GetX(), GetY(), SetY(), SetXY()</span>
<a name="l08391"></a>08391 <span class="comment">     */</span>
<a name="l08392"></a><a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">08392</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, $rtloff=<span class="keyword">false</span>) {
<a name="l08393"></a>08393         <span class="keywordflow">if</span> (!$rtloff AND $this-&gt;rtl) {
<a name="l08394"></a>08394             <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> &gt;= 0) {
<a name="l08395"></a>08395                 $this-&gt;x = $this-&gt;w - <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l08396"></a>08396             } <span class="keywordflow">else</span> {
<a name="l08397"></a>08397                 $this-&gt;x = abs(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>);
<a name="l08398"></a>08398             }
<a name="l08399"></a>08399         } <span class="keywordflow">else</span> {
<a name="l08400"></a>08400             <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a> &gt;= 0) {
<a name="l08401"></a>08401                 $this-&gt;x = <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l08402"></a>08402             } <span class="keywordflow">else</span> {
<a name="l08403"></a>08403                 $this-&gt;x = $this-&gt;w + <a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>;
<a name="l08404"></a>08404             }
<a name="l08405"></a>08405         }
<a name="l08406"></a>08406         <span class="keywordflow">if</span> ($this-&gt;x &lt; 0) {
<a name="l08407"></a>08407             $this-&gt;x = 0;
<a name="l08408"></a>08408         }
<a name="l08409"></a>08409         <span class="keywordflow">if</span> ($this-&gt;x &gt; $this-&gt;w) {
<a name="l08410"></a>08410             $this-&gt;x = $this-&gt;w;
<a name="l08411"></a>08411         }
<a name="l08412"></a>08412     }
<a name="l08413"></a>08413 <span class="comment"></span>
<a name="l08414"></a>08414 <span class="comment">    /**</span>
<a name="l08415"></a>08415 <span class="comment">     * Moves the current abscissa back to the left margin and sets the ordinate.</span>
<a name="l08416"></a>08416 <span class="comment">     * If the passed value is negative, it is relative to the bottom of the page.</span>
<a name="l08417"></a>08417 <span class="comment">     * @param $y (float) The value of the ordinate.</span>
<a name="l08418"></a>08418 <span class="comment">     * @param $resetx (bool) if true (default) reset the X position.</span>
<a name="l08419"></a>08419 <span class="comment">     * @param $rtloff (boolean) if true always uses the page top-left corner as origin of axis.</span>
<a name="l08420"></a>08420 <span class="comment">     * @public</span>
<a name="l08421"></a>08421 <span class="comment">     * @since 1.0</span>
<a name="l08422"></a>08422 <span class="comment">     * @see GetX(), GetY(), SetY(), SetXY()</span>
<a name="l08423"></a>08423 <span class="comment">     */</span>
<a name="l08424"></a><a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758">08424</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758" title="Moves the current abscissa back to the left margin and sets the ordinate.">SetY</a>(<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, $resetx=<span class="keyword">true</span>, $rtloff=<span class="keyword">false</span>) {
<a name="l08425"></a>08425         <span class="keywordflow">if</span> ($resetx) {
<a name="l08426"></a>08426             <span class="comment">//reset x</span>
<a name="l08427"></a>08427             <span class="keywordflow">if</span> (!$rtloff AND $this-&gt;rtl) {
<a name="l08428"></a>08428                 $this-&gt;x = $this-&gt;w - $this-&gt;rMargin;
<a name="l08429"></a>08429             } <span class="keywordflow">else</span> {
<a name="l08430"></a>08430                 $this-&gt;x = $this-&gt;lMargin;
<a name="l08431"></a>08431             }
<a name="l08432"></a>08432         }
<a name="l08433"></a>08433         <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a> &gt;= 0) {
<a name="l08434"></a>08434             $this-&gt;y = <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>;
<a name="l08435"></a>08435         } <span class="keywordflow">else</span> {
<a name="l08436"></a>08436             $this-&gt;y = $this-&gt;h + <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>;
<a name="l08437"></a>08437         }
<a name="l08438"></a>08438         <span class="keywordflow">if</span> ($this-&gt;y &lt; 0) {
<a name="l08439"></a>08439             $this-&gt;y = 0;
<a name="l08440"></a>08440         }
<a name="l08441"></a>08441         <span class="keywordflow">if</span> ($this-&gt;y &gt; $this-&gt;h) {
<a name="l08442"></a>08442             $this-&gt;y = $this-&gt;h;
<a name="l08443"></a>08443         }
<a name="l08444"></a>08444     }
<a name="l08445"></a>08445 <span class="comment"></span>
<a name="l08446"></a>08446 <span class="comment">    /**</span>
<a name="l08447"></a>08447 <span class="comment">     * Defines the abscissa and ordinate of the current position.</span>
<a name="l08448"></a>08448 <span class="comment">     * If the passed values are negative, they are relative respectively to the right and bottom of the page.</span>
<a name="l08449"></a>08449 <span class="comment">     * @param $x (float) The value of the abscissa.</span>
<a name="l08450"></a>08450 <span class="comment">     * @param $y (float) The value of the ordinate.</span>
<a name="l08451"></a>08451 <span class="comment">     * @param $rtloff (boolean) if true always uses the page top-left corner as origin of axis.</span>
<a name="l08452"></a>08452 <span class="comment">     * @public</span>
<a name="l08453"></a>08453 <span class="comment">     * @since 1.2</span>
<a name="l08454"></a>08454 <span class="comment">     * @see SetX(), SetY()</span>
<a name="l08455"></a>08455 <span class="comment">     */</span>
<a name="l08456"></a><a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482">08456</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a00ec13928f57b17c21040acc881fe482" title="Defines the abscissa and ordinate of the current position.">SetXY</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, <a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, $rtloff=<span class="keyword">false</span>) {
<a name="l08457"></a>08457         $this-&gt;<a class="code" href="classTCPDF.html#ad3439990de56253b039bca6a09305758" title="Moves the current abscissa back to the left margin and sets the ordinate.">SetY</a>(<a class="code" href="classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe" title="Current vertical position in user unit for cell positioning.">$y</a>, <span class="keyword">false</span>, $rtloff);
<a name="l08458"></a>08458         $this-&gt;<a class="code" href="classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e" title="Defines the abscissa of the current position.">SetX</a>(<a class="code" href="classTCPDF.html#af63a9b95cacf42745e338057ce03c734" title="Current horizontal position in user unit for cell positioning.">$x</a>, $rtloff);
<a name="l08459"></a>08459     }
<a name="l08460"></a>08460 <span class="comment"></span>
<a name="l08461"></a>08461 <span class="comment">    /**</span>
<a name="l08462"></a>08462 <span class="comment">     * Ouput input data and compress it if possible.</span>
<a name="l08463"></a>08463 <span class="comment">     * @param $data (string) Data to output.</span>
<a name="l08464"></a>08464 <span class="comment">     * @param $length (int) Data length in bytes.</span>
<a name="l08465"></a>08465 <span class="comment">     * @protected</span>
<a name="l08466"></a>08466 <span class="comment">     * @since 5.9.086</span>
<a name="l08467"></a>08467 <span class="comment">     */</span>
<a name="l08468"></a><a class="code" href="classTCPDF.html#a9f3c95b9455481dc9bae1ee785d5614e">08468</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9f3c95b9455481dc9bae1ee785d5614e" title="Ouput input data and compress it if possible.">sendOutputData</a>(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, $length) {
<a name="l08469"></a>08469         <span class="keywordflow">if</span> (!isset($_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT_ENCODING&#39;</span>]) OR empty($_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT_ENCODING&#39;</span>])) {
<a name="l08470"></a>08470             <span class="comment">// the content length may vary if the server is using compression</span>
<a name="l08471"></a>08471             header(<span class="stringliteral">&#39;Content-Length: &#39;</span>.$length);
<a name="l08472"></a>08472         }
<a name="l08473"></a>08473         echo <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l08474"></a>08474     }
<a name="l08475"></a>08475 <span class="comment"></span>
<a name="l08476"></a>08476 <span class="comment">    /**</span>
<a name="l08477"></a>08477 <span class="comment">     * Send the document to a given destination: string, local file or browser.</span>
<a name="l08478"></a>08478 <span class="comment">     * In the last case, the plug-in may be used (if present) or a download (&quot;Save as&quot; dialog box) may be forced.&lt;br /&gt;</span>
<a name="l08479"></a>08479 <span class="comment">     * The method first calls Close() if necessary to terminate the document.</span>
<a name="l08480"></a>08480 <span class="comment">     * @param $name (string) The name of the file when saved. Note that special characters are removed and blanks characters are replaced with the underscore character.</span>
<a name="l08481"></a>08481 <span class="comment">     * @param $dest (string) Destination where to send the document. It can take one of the following values:&lt;ul&gt;&lt;li&gt;I: send the file inline to the browser (default). The plug-in is used if available. The name given by name is used when one selects the &quot;Save as&quot; option on the link generating the PDF.&lt;/li&gt;&lt;li&gt;D: send to the browser and force a file download with the name given by name.&lt;/li&gt;&lt;li&gt;F: save to a local server file with the name given by name.&lt;/li&gt;&lt;li&gt;S: return the document as a string (name is ignored).&lt;/li&gt;&lt;li&gt;FI: equivalent to F + I option&lt;/li&gt;&lt;li&gt;FD: equivalent to F + D option&lt;/li&gt;&lt;li&gt;E: return the document as base64 mime multi-part email attachment (RFC 2045)&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l08482"></a>08482 <span class="comment">     * @public</span>
<a name="l08483"></a>08483 <span class="comment">     * @since 1.0</span>
<a name="l08484"></a>08484 <span class="comment">     * @see Close()</span>
<a name="l08485"></a>08485 <span class="comment">     */</span>
<a name="l08486"></a><a class="code" href="classTCPDF.html#a3d6dcb62298ec9d42e9125ee2f5b23a1">08486</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3d6dcb62298ec9d42e9125ee2f5b23a1" title="Send the document to a given destination: string, local file or browser.">Output</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>=<span class="stringliteral">&#39;doc.pdf&#39;</span>, $dest=<span class="charliteral">&#39;I&#39;</span>) {
<a name="l08487"></a>08487         <span class="comment">//Output PDF to some destination</span>
<a name="l08488"></a>08488         <span class="comment">//Finish document if necessary</span>
<a name="l08489"></a>08489         <span class="keywordflow">if</span> ($this-&gt;state &lt; 3) {
<a name="l08490"></a>08490             $this-&gt;<a class="code" href="classTCPDF.html#a2ea842192062587293c25981098c820c" title="Terminates the PDF document.">Close</a>();
<a name="l08491"></a>08491         }
<a name="l08492"></a>08492         <span class="comment">//Normalize parameters</span>
<a name="l08493"></a>08493         <span class="keywordflow">if</span> (is_bool($dest)) {
<a name="l08494"></a>08494             $dest = $dest ? <span class="charliteral">&#39;D&#39;</span> : <span class="charliteral">&#39;F&#39;</span>;
<a name="l08495"></a>08495         }
<a name="l08496"></a>08496         $dest = strtoupper($dest);
<a name="l08497"></a>08497         <span class="keywordflow">if</span> ($dest{0} != <span class="charliteral">&#39;F&#39;</span>) {
<a name="l08498"></a>08498             <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = preg_replace(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, <span class="charliteral">&#39;_&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l08499"></a>08499             <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = preg_replace(<span class="stringliteral">&#39;/[^a-zA-Z0-9_\.-]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l08500"></a>08500         }
<a name="l08501"></a>08501         <span class="keywordflow">if</span> ($this-&gt;sign) {
<a name="l08502"></a>08502             <span class="comment">// *** apply digital signature to the document ***</span>
<a name="l08503"></a>08503             <span class="comment">// get the document content</span>
<a name="l08504"></a>08504             $pdfdoc = $this-&gt;<a class="code" href="classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7" title="Get buffer content.">getBuffer</a>();
<a name="l08505"></a>08505             <span class="comment">// remove last newline</span>
<a name="l08506"></a>08506             $pdfdoc = substr($pdfdoc, 0, -1);
<a name="l08507"></a>08507             <span class="comment">// Remove the original buffer</span>
<a name="l08508"></a>08508             <span class="keywordflow">if</span> (isset($this-&gt;diskcache) AND $this-&gt;diskcache) {
<a name="l08509"></a>08509                 <span class="comment">// remove buffer file from cache</span>
<a name="l08510"></a>08510                 unlink($this-&gt;buffer);
<a name="l08511"></a>08511             }
<a name="l08512"></a>08512             unset($this-&gt;buffer);
<a name="l08513"></a>08513             <span class="comment">// remove filler space</span>
<a name="l08514"></a>08514             $byterange_string_len = strlen($this-&gt;byterange_string);
<a name="l08515"></a>08515             <span class="comment">// define the ByteRange</span>
<a name="l08516"></a>08516             $byte_range = array();
<a name="l08517"></a>08517             $byte_range[0] = 0;
<a name="l08518"></a>08518             $byte_range[1] = strpos($pdfdoc, $this-&gt;byterange_string) + $byterange_string_len + 10;
<a name="l08519"></a>08519             $byte_range[2] = $byte_range[1] + $this-&gt;signature_max_length + 2;
<a name="l08520"></a>08520             $byte_range[3] = strlen($pdfdoc) - $byte_range[2];
<a name="l08521"></a>08521             $pdfdoc = substr($pdfdoc, 0, $byte_range[1]).substr($pdfdoc, $byte_range[2]);
<a name="l08522"></a>08522             <span class="comment">// replace the ByteRange</span>
<a name="l08523"></a>08523             $byterange = sprintf(<span class="stringliteral">&#39;/ByteRange[0 %u %u %u]&#39;</span>, $byte_range[1], $byte_range[2], $byte_range[3]);
<a name="l08524"></a>08524             $byterange .= str_repeat(<span class="charliteral">&#39; &#39;</span>, ($byterange_string_len - strlen($byterange)));
<a name="l08525"></a>08525             $pdfdoc = str_replace($this-&gt;byterange_string, $byterange, $pdfdoc);
<a name="l08526"></a>08526             <span class="comment">// write the document to a temporary folder</span>
<a name="l08527"></a>08527             $tempdoc = tempnam(K_PATH_CACHE, <span class="stringliteral">&#39;tmppdf_&#39;</span>);
<a name="l08528"></a>08528             <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = fopen($tempdoc, <span class="stringliteral">&#39;wb&#39;</span>);
<a name="l08529"></a>08529             <span class="keywordflow">if</span> (!<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>) {
<a name="l08530"></a>08530                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Unable to create temporary file: &#39;</span>.$tempdoc);
<a name="l08531"></a>08531             }
<a name="l08532"></a>08532             $pdfdoc_length = strlen($pdfdoc);
<a name="l08533"></a>08533             fwrite(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, $pdfdoc, $pdfdoc_length);
<a name="l08534"></a>08534             fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08535"></a>08535             <span class="comment">// get digital signature via openssl library</span>
<a name="l08536"></a>08536             $tempsign = tempnam(K_PATH_CACHE, <span class="stringliteral">&#39;tmpsig_&#39;</span>);
<a name="l08537"></a>08537             <span class="keywordflow">if</span> (empty($this-&gt;signature_data[<span class="stringliteral">&#39;extracerts&#39;</span>])) {
<a name="l08538"></a>08538                 openssl_pkcs7_sign($tempdoc, $tempsign, $this-&gt;signature_data[<span class="stringliteral">&#39;signcert&#39;</span>], array($this-&gt;signature_data[<span class="stringliteral">&#39;privkey&#39;</span>], $this-&gt;signature_data[<span class="stringliteral">&#39;password&#39;</span>]), array(), PKCS7_BINARY | PKCS7_DETACHED);
<a name="l08539"></a>08539             } <span class="keywordflow">else</span> {
<a name="l08540"></a>08540                 openssl_pkcs7_sign($tempdoc, $tempsign, $this-&gt;signature_data[<span class="stringliteral">&#39;signcert&#39;</span>], array($this-&gt;signature_data[<span class="stringliteral">&#39;privkey&#39;</span>], $this-&gt;signature_data[<span class="stringliteral">&#39;password&#39;</span>]), array(), PKCS7_BINARY | PKCS7_DETACHED, $this-&gt;signature_data[<span class="stringliteral">&#39;extracerts&#39;</span>]);
<a name="l08541"></a>08541             }
<a name="l08542"></a>08542             unlink($tempdoc);
<a name="l08543"></a>08543             <span class="comment">// read signature</span>
<a name="l08544"></a>08544             $signature = file_get_contents($tempsign);
<a name="l08545"></a>08545             unlink($tempsign);
<a name="l08546"></a>08546             <span class="comment">// extract signature</span>
<a name="l08547"></a>08547             $signature = substr($signature, $pdfdoc_length);
<a name="l08548"></a>08548             $signature = substr($signature, (strpos($signature, <span class="stringliteral">&quot;%%EOF\n\n------&quot;</span>) + 13));
<a name="l08549"></a>08549             $tmparr = explode(<span class="stringliteral">&quot;\n\n&quot;</span>, $signature);
<a name="l08550"></a>08550             $signature = $tmparr[1];
<a name="l08551"></a>08551             unset($tmparr);
<a name="l08552"></a>08552             <span class="comment">// decode signature</span>
<a name="l08553"></a>08553             $signature = base64_decode(trim($signature));
<a name="l08554"></a>08554             <span class="comment">// convert signature to hex</span>
<a name="l08555"></a>08555             $signature = current(unpack(<span class="stringliteral">&#39;H*&#39;</span>, $signature));
<a name="l08556"></a>08556             $signature = str_pad($signature, $this-&gt;signature_max_length, <span class="charliteral">&#39;0&#39;</span>);
<a name="l08557"></a>08557             <span class="comment">// disable disk caching</span>
<a name="l08558"></a>08558             $this-&gt;diskcache = <span class="keyword">false</span>;
<a name="l08559"></a>08559             <span class="comment">// Add signature to the document</span>
<a name="l08560"></a>08560             $this-&gt;buffer = substr($pdfdoc, 0, $byte_range[1]).<span class="charliteral">&#39;&lt;&#39;</span>.$signature.<span class="charliteral">&#39;&gt;&#39;</span>.substr($pdfdoc, $byte_range[1]);
<a name="l08561"></a>08561             $this-&gt;bufferlen = strlen($this-&gt;buffer);
<a name="l08562"></a>08562         }
<a name="l08563"></a>08563         <span class="keywordflow">switch</span>($dest) {
<a name="l08564"></a>08564             <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>: {
<a name="l08565"></a>08565                 <span class="comment">// Send PDF to the standard output</span>
<a name="l08566"></a>08566                 <span class="keywordflow">if</span> (ob_get_contents()) {
<a name="l08567"></a>08567                     $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Some data has already been output, can\&#39;t send PDF file&#39;</span>);
<a name="l08568"></a>08568                 }
<a name="l08569"></a>08569                 <span class="keywordflow">if</span> (php_sapi_name() != <span class="stringliteral">&#39;cli&#39;</span>) {
<a name="l08570"></a>08570                     <span class="comment">// send output to a browser</span>
<a name="l08571"></a>08571                     header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>);
<a name="l08572"></a>08572                     <span class="keywordflow">if</span> (headers_sent()) {
<a name="l08573"></a>08573                         $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Some data has already been output to browser, can\&#39;t send PDF file&#39;</span>);
<a name="l08574"></a>08574                     }
<a name="l08575"></a>08575                     header(<span class="stringliteral">&#39;Cache-Control: private, must-revalidate, post-check=0, pre-check=0, max-age=1&#39;</span>);
<a name="l08576"></a>08576                     <span class="comment">//header(&#39;Cache-Control: public, must-revalidate, max-age=0&#39;); // HTTP/1.1</span>
<a name="l08577"></a>08577                     header(<span class="stringliteral">&#39;Pragma: public&#39;</span>);
<a name="l08578"></a>08578                     header(<span class="stringliteral">&#39;Expires: Sat, 26 Jul 1997 05:00:00 GMT&#39;</span>); <span class="comment">// Date in the past</span>
<a name="l08579"></a>08579                     header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>).<span class="stringliteral">&#39; GMT&#39;</span>);
<a name="l08580"></a>08580                     header(<span class="stringliteral">&#39;Content-Disposition: inline; filename=&quot;&#39;</span>.basename(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>).<span class="stringliteral">&#39;&quot;;&#39;</span>);
<a name="l08581"></a>08581                     $this-&gt;<a class="code" href="classTCPDF.html#a9f3c95b9455481dc9bae1ee785d5614e" title="Ouput input data and compress it if possible.">sendOutputData</a>($this-&gt;<a class="code" href="classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7" title="Get buffer content.">getBuffer</a>(), $this-&gt;bufferlen);
<a name="l08582"></a>08582                 } <span class="keywordflow">else</span> {
<a name="l08583"></a>08583                     echo $this-&gt;<a class="code" href="classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7" title="Get buffer content.">getBuffer</a>();
<a name="l08584"></a>08584                 }
<a name="l08585"></a>08585                 <span class="keywordflow">break</span>;
<a name="l08586"></a>08586             }
<a name="l08587"></a>08587             <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>: {
<a name="l08588"></a>08588                 <span class="comment">// download PDF as file</span>
<a name="l08589"></a>08589                 <span class="keywordflow">if</span> (ob_get_contents()) {
<a name="l08590"></a>08590                     $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Some data has already been output, can\&#39;t send PDF file&#39;</span>);
<a name="l08591"></a>08591                 }
<a name="l08592"></a>08592                 header(<span class="stringliteral">&#39;Content-Description: File Transfer&#39;</span>);
<a name="l08593"></a>08593                 <span class="keywordflow">if</span> (headers_sent()) {
<a name="l08594"></a>08594                     $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Some data has already been output to browser, can\&#39;t send PDF file&#39;</span>);
<a name="l08595"></a>08595                 }
<a name="l08596"></a>08596                 header(<span class="stringliteral">&#39;Cache-Control: private, must-revalidate, post-check=0, pre-check=0, max-age=1&#39;</span>);
<a name="l08597"></a>08597                 <span class="comment">//header(&#39;Cache-Control: public, must-revalidate, max-age=0&#39;); // HTTP/1.1</span>
<a name="l08598"></a>08598                 header(<span class="stringliteral">&#39;Pragma: public&#39;</span>);
<a name="l08599"></a>08599                 header(<span class="stringliteral">&#39;Expires: Sat, 26 Jul 1997 05:00:00 GMT&#39;</span>); <span class="comment">// Date in the past</span>
<a name="l08600"></a>08600                 header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>).<span class="stringliteral">&#39; GMT&#39;</span>);
<a name="l08601"></a>08601                 <span class="comment">// force download dialog</span>
<a name="l08602"></a>08602                 <span class="keywordflow">if</span> (strpos(php_sapi_name(), <span class="stringliteral">&#39;cgi&#39;</span>) === <span class="keyword">false</span>) {
<a name="l08603"></a>08603                     header(<span class="stringliteral">&#39;Content-Type: application/force-download&#39;</span>);
<a name="l08604"></a>08604                     header(<span class="stringliteral">&#39;Content-Type: application/octet-stream&#39;</span>, <span class="keyword">false</span>);
<a name="l08605"></a>08605                     header(<span class="stringliteral">&#39;Content-Type: application/download&#39;</span>, <span class="keyword">false</span>);
<a name="l08606"></a>08606                     header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>, <span class="keyword">false</span>);
<a name="l08607"></a>08607                 } <span class="keywordflow">else</span> {
<a name="l08608"></a>08608                     header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>);
<a name="l08609"></a>08609                 }
<a name="l08610"></a>08610                 <span class="comment">// use the Content-Disposition header to supply a recommended filename</span>
<a name="l08611"></a>08611                 header(<span class="stringliteral">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span>.basename(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>).<span class="stringliteral">&#39;&quot;;&#39;</span>);
<a name="l08612"></a>08612                 header(<span class="stringliteral">&#39;Content-Transfer-Encoding: binary&#39;</span>);
<a name="l08613"></a>08613                 $this-&gt;<a class="code" href="classTCPDF.html#a9f3c95b9455481dc9bae1ee785d5614e" title="Ouput input data and compress it if possible.">sendOutputData</a>($this-&gt;<a class="code" href="classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7" title="Get buffer content.">getBuffer</a>(), $this-&gt;bufferlen);
<a name="l08614"></a>08614                 <span class="keywordflow">break</span>;
<a name="l08615"></a>08615             }
<a name="l08616"></a>08616             <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>:
<a name="l08617"></a>08617             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FI&#39;</span>:
<a name="l08618"></a>08618             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FD&#39;</span>: {
<a name="l08619"></a>08619                 <span class="comment">// save PDF to a local file</span>
<a name="l08620"></a>08620                 <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l08621"></a>08621                     copy($this-&gt;buffer, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l08622"></a>08622                 } <span class="keywordflow">else</span> {
<a name="l08623"></a>08623                     <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = fopen(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <span class="stringliteral">&#39;wb&#39;</span>);
<a name="l08624"></a>08624                     <span class="keywordflow">if</span> (!<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>) {
<a name="l08625"></a>08625                         $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Unable to create output file: &#39;</span>.<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l08626"></a>08626                     }
<a name="l08627"></a>08627                     fwrite(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, $this-&gt;<a class="code" href="classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7" title="Get buffer content.">getBuffer</a>(), $this-&gt;bufferlen);
<a name="l08628"></a>08628                     fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l08629"></a>08629                 }
<a name="l08630"></a>08630                 <span class="keywordflow">if</span> ($dest == <span class="stringliteral">&#39;FI&#39;</span>) {
<a name="l08631"></a>08631                     <span class="comment">// send headers to browser</span>
<a name="l08632"></a>08632                     header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>);
<a name="l08633"></a>08633                     header(<span class="stringliteral">&#39;Cache-Control: private, must-revalidate, post-check=0, pre-check=0, max-age=1&#39;</span>);
<a name="l08634"></a>08634                     <span class="comment">//header(&#39;Cache-Control: public, must-revalidate, max-age=0&#39;); // HTTP/1.1</span>
<a name="l08635"></a>08635                     header(<span class="stringliteral">&#39;Pragma: public&#39;</span>);
<a name="l08636"></a>08636                     header(<span class="stringliteral">&#39;Expires: Sat, 26 Jul 1997 05:00:00 GMT&#39;</span>); <span class="comment">// Date in the past</span>
<a name="l08637"></a>08637                     header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>).<span class="stringliteral">&#39; GMT&#39;</span>);
<a name="l08638"></a>08638                     header(<span class="stringliteral">&#39;Content-Disposition: inline; filename=&quot;&#39;</span>.basename(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>).<span class="stringliteral">&#39;&quot;;&#39;</span>);
<a name="l08639"></a>08639                     $this-&gt;<a class="code" href="classTCPDF.html#a9f3c95b9455481dc9bae1ee785d5614e" title="Ouput input data and compress it if possible.">sendOutputData</a>(file_get_contents(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>), filesize(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>));
<a name="l08640"></a>08640                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dest == <span class="stringliteral">&#39;FD&#39;</span>) {
<a name="l08641"></a>08641                     <span class="comment">// send headers to browser</span>
<a name="l08642"></a>08642                     <span class="keywordflow">if</span> (ob_get_contents()) {
<a name="l08643"></a>08643                         $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Some data has already been output, can\&#39;t send PDF file&#39;</span>);
<a name="l08644"></a>08644                     }
<a name="l08645"></a>08645                     header(<span class="stringliteral">&#39;Content-Description: File Transfer&#39;</span>);
<a name="l08646"></a>08646                     <span class="keywordflow">if</span> (headers_sent()) {
<a name="l08647"></a>08647                         $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Some data has already been output to browser, can\&#39;t send PDF file&#39;</span>);
<a name="l08648"></a>08648                     }
<a name="l08649"></a>08649                     header(<span class="stringliteral">&#39;Cache-Control: private, must-revalidate, post-check=0, pre-check=0, max-age=1&#39;</span>);
<a name="l08650"></a>08650                     header(<span class="stringliteral">&#39;Pragma: public&#39;</span>);
<a name="l08651"></a>08651                     header(<span class="stringliteral">&#39;Expires: Sat, 26 Jul 1997 05:00:00 GMT&#39;</span>); <span class="comment">// Date in the past</span>
<a name="l08652"></a>08652                     header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>).<span class="stringliteral">&#39; GMT&#39;</span>);
<a name="l08653"></a>08653                     <span class="comment">// force download dialog</span>
<a name="l08654"></a>08654                     <span class="keywordflow">if</span> (strpos(php_sapi_name(), <span class="stringliteral">&#39;cgi&#39;</span>) === <span class="keyword">false</span>) {
<a name="l08655"></a>08655                         header(<span class="stringliteral">&#39;Content-Type: application/force-download&#39;</span>);
<a name="l08656"></a>08656                         header(<span class="stringliteral">&#39;Content-Type: application/octet-stream&#39;</span>, <span class="keyword">false</span>);
<a name="l08657"></a>08657                         header(<span class="stringliteral">&#39;Content-Type: application/download&#39;</span>, <span class="keyword">false</span>);
<a name="l08658"></a>08658                         header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>, <span class="keyword">false</span>);
<a name="l08659"></a>08659                     } <span class="keywordflow">else</span> {
<a name="l08660"></a>08660                         header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>);
<a name="l08661"></a>08661                     }
<a name="l08662"></a>08662                     <span class="comment">// use the Content-Disposition header to supply a recommended filename</span>
<a name="l08663"></a>08663                     header(<span class="stringliteral">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span>.basename(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>).<span class="stringliteral">&#39;&quot;;&#39;</span>);
<a name="l08664"></a>08664                     header(<span class="stringliteral">&#39;Content-Transfer-Encoding: binary&#39;</span>);
<a name="l08665"></a>08665                     $this-&gt;<a class="code" href="classTCPDF.html#a9f3c95b9455481dc9bae1ee785d5614e" title="Ouput input data and compress it if possible.">sendOutputData</a>(file_get_contents(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>), filesize(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>));
<a name="l08666"></a>08666                 }
<a name="l08667"></a>08667                 <span class="keywordflow">break</span>;
<a name="l08668"></a>08668             }
<a name="l08669"></a>08669             <span class="keywordflow">case</span> <span class="charliteral">&#39;E&#39;</span>: {
<a name="l08670"></a>08670                 <span class="comment">// return PDF as base64 mime multi-part email attachment (RFC 2045)</span>
<a name="l08671"></a>08671                 $retval = <span class="stringliteral">&#39;Content-Type: application/pdf;&#39;</span>.<span class="stringliteral">&quot;\r\n&quot;</span>;
<a name="l08672"></a>08672                 $retval .= <span class="stringliteral">&#39; name=&quot;&#39;</span>.$name.<span class="charliteral">&#39;&quot;&#39;</span>.<span class="stringliteral">&quot;\r\n&quot;</span>;
<a name="l08673"></a>08673                 $retval .= <span class="stringliteral">&#39;Content-Transfer-Encoding: base64&#39;</span>.<span class="stringliteral">&quot;\r\n&quot;</span>;
<a name="l08674"></a>08674                 $retval .= <span class="stringliteral">&#39;Content-Disposition: attachment;&#39;</span>.<span class="stringliteral">&quot;\r\n&quot;</span>;
<a name="l08675"></a>08675                 $retval .= <span class="stringliteral">&#39; filename=&quot;&#39;</span>.$name.<span class="charliteral">&#39;&quot;&#39;</span>.<span class="stringliteral">&quot;\r\n\r\n&quot;</span>;
<a name="l08676"></a>08676                 $retval .= chunk_split(base64_encode($this-&gt;<a class="code" href="classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7" title="Get buffer content.">getBuffer</a>()), 76, <span class="stringliteral">&quot;\r\n&quot;</span>);
<a name="l08677"></a>08677                 <span class="keywordflow">return</span> $retval;
<a name="l08678"></a>08678             }
<a name="l08679"></a>08679             <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: {
<a name="l08680"></a>08680                 <span class="comment">// returns PDF as a string</span>
<a name="l08681"></a>08681                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7" title="Get buffer content.">getBuffer</a>();
<a name="l08682"></a>08682             }
<a name="l08683"></a>08683             <span class="keywordflow">default</span>: {
<a name="l08684"></a>08684                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Incorrect output destination: &#39;</span>.$dest);
<a name="l08685"></a>08685             }
<a name="l08686"></a>08686         }
<a name="l08687"></a>08687         <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l08688"></a>08688     }
<a name="l08689"></a>08689 <span class="comment"></span>
<a name="l08690"></a>08690 <span class="comment">    /**</span>
<a name="l08691"></a>08691 <span class="comment">     * Unset all class variables except the following critical variables: internal_encoding, state, bufferlen, buffer and diskcache.</span>
<a name="l08692"></a>08692 <span class="comment">     * @param $destroyall (boolean) if true destroys all class variables, otherwise preserves critical variables.</span>
<a name="l08693"></a>08693 <span class="comment">     * @param $preserve_objcopy (boolean) if true preserves the objcopy variable</span>
<a name="l08694"></a>08694 <span class="comment">     * @public</span>
<a name="l08695"></a>08695 <span class="comment">     * @since 4.5.016 (2009-02-24)</span>
<a name="l08696"></a>08696 <span class="comment">     */</span>
<a name="l08697"></a><a class="code" href="classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa">08697</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa" title="Unset all class variables except the following critical variables: internal_encoding, state, bufferlen, buffer and diskcache.">_destroy</a>($destroyall=<span class="keyword">false</span>, $preserve_objcopy=<span class="keyword">false</span>) {
<a name="l08698"></a>08698         <span class="keywordflow">if</span> ($destroyall AND isset($this-&gt;diskcache) AND $this-&gt;diskcache AND (!$preserve_objcopy) AND (!$this-&gt;<a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($this-&gt;buffer))) {
<a name="l08699"></a>08699             <span class="comment">// remove buffer file from cache</span>
<a name="l08700"></a>08700             unlink($this-&gt;buffer);
<a name="l08701"></a>08701         }
<a name="l08702"></a>08702         <span class="keywordflow">foreach</span> (array_keys(get_object_vars($this)) as $val) {
<a name="l08703"></a>08703             <span class="keywordflow">if</span> ($destroyall OR (
<a name="l08704"></a>08704                 ($val != <span class="stringliteral">&#39;internal_encoding&#39;</span>)
<a name="l08705"></a>08705                 AND ($val != <span class="stringliteral">&#39;state&#39;</span>)
<a name="l08706"></a>08706                 AND ($val != <span class="stringliteral">&#39;bufferlen&#39;</span>)
<a name="l08707"></a>08707                 AND ($val != <span class="stringliteral">&#39;buffer&#39;</span>)
<a name="l08708"></a>08708                 AND ($val != <span class="stringliteral">&#39;diskcache&#39;</span>)
<a name="l08709"></a>08709                 AND ($val != <span class="stringliteral">&#39;sign&#39;</span>)
<a name="l08710"></a>08710                 AND ($val != <span class="stringliteral">&#39;signature_data&#39;</span>)
<a name="l08711"></a>08711                 AND ($val != <span class="stringliteral">&#39;signature_max_length&#39;</span>)
<a name="l08712"></a>08712                 AND ($val != <span class="stringliteral">&#39;byterange_string&#39;</span>)
<a name="l08713"></a>08713                 )) {
<a name="l08714"></a>08714                 <span class="keywordflow">if</span> ((!$preserve_objcopy OR ($val != <span class="stringliteral">&#39;objcopy&#39;</span>)) AND isset($this-&gt;$val)) {
<a name="l08715"></a>08715                     unset($this-&gt;$val);
<a name="l08716"></a>08716                 }
<a name="l08717"></a>08717             }
<a name="l08718"></a>08718         }
<a name="l08719"></a>08719     }
<a name="l08720"></a>08720 <span class="comment"></span>
<a name="l08721"></a>08721 <span class="comment">    /**</span>
<a name="l08722"></a>08722 <span class="comment">     * Check for locale-related bug</span>
<a name="l08723"></a>08723 <span class="comment">     * @protected</span>
<a name="l08724"></a>08724 <span class="comment">     */</span>
<a name="l08725"></a><a class="code" href="classTCPDF.html#a17346daa2c4848e475ad4f408376e2c2">08725</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a17346daa2c4848e475ad4f408376e2c2" title="Check for locale-related bug.">_dochecks</a>() {
<a name="l08726"></a>08726         <span class="comment">//Check for locale-related bug</span>
<a name="l08727"></a>08727         <span class="keywordflow">if</span> (1.1 == 1) {
<a name="l08728"></a>08728             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Don\&#39;t alter the locale before including class file&#39;</span>);
<a name="l08729"></a>08729         }
<a name="l08730"></a>08730         <span class="comment">//Check for decimal separator</span>
<a name="l08731"></a>08731         <span class="keywordflow">if</span> (sprintf(<span class="stringliteral">&#39;%.1F&#39;</span>, 1.0) != <span class="stringliteral">&#39;1.0&#39;</span>) {
<a name="l08732"></a>08732             setlocale(LC_NUMERIC, <span class="charliteral">&#39;C&#39;</span>);
<a name="l08733"></a>08733         }
<a name="l08734"></a>08734     }
<a name="l08735"></a>08735 <span class="comment"></span>
<a name="l08736"></a>08736 <span class="comment">    /**</span>
<a name="l08737"></a>08737 <span class="comment">     * Return fonts path</span>
<a name="l08738"></a>08738 <span class="comment">     * @return string</span>
<a name="l08739"></a>08739 <span class="comment">     * @protected</span>
<a name="l08740"></a>08740 <span class="comment">     */</span>
<a name="l08741"></a><a class="code" href="classTCPDF.html#a859c9ff83c417b518afa83c0da7a62b1">08741</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a859c9ff83c417b518afa83c0da7a62b1" title="Return fonts path.">_getfontpath</a>() {
<a name="l08742"></a>08742         <span class="keywordflow">if</span> (!defined(<span class="stringliteral">&#39;K_PATH_FONTS&#39;</span>) AND is_dir(dirname(__FILE__).<span class="stringliteral">&#39;/fonts&#39;</span>)) {
<a name="l08743"></a>08743             define(<span class="stringliteral">&#39;K_PATH_FONTS&#39;</span>, dirname(__FILE__).<span class="stringliteral">&#39;/fonts/&#39;</span>);
<a name="l08744"></a>08744         }
<a name="l08745"></a>08745         <span class="keywordflow">return</span> defined(<span class="stringliteral">&#39;K_PATH_FONTS&#39;</span>) ? K_PATH_FONTS : <span class="stringliteral">&#39;&#39;</span>;
<a name="l08746"></a>08746     }
<a name="l08747"></a>08747 <span class="comment"></span>
<a name="l08748"></a>08748 <span class="comment">    /**</span>
<a name="l08749"></a>08749 <span class="comment">     * Return an array containing variations for the basic page number alias.</span>
<a name="l08750"></a>08750 <span class="comment">     * @param $a (string) Base alias.</span>
<a name="l08751"></a>08751 <span class="comment">     * @return array of page number aliases</span>
<a name="l08752"></a>08752 <span class="comment">     * @protected</span>
<a name="l08753"></a>08753 <span class="comment">     */</span>
<a name="l08754"></a><a class="code" href="classTCPDF.html#adaef81b9b034e5d10c56b3f2fea83175">08754</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#adaef81b9b034e5d10c56b3f2fea83175" title="Return an array containing variations for the basic page number alias.">getInternalPageNumberAliases</a>($a= <span class="stringliteral">&#39;&#39;</span>) {
<a name="l08755"></a>08755         $alias = array();
<a name="l08756"></a>08756         <span class="comment">// build array of Unicode + ASCII variants (the order is important)</span>
<a name="l08757"></a>08757         $alias = array(<span class="charliteral">&#39;u&#39;</span> =&gt; array(), <span class="charliteral">&#39;a&#39;</span> =&gt; array());
<a name="l08758"></a>08758         $u = <span class="charliteral">&#39;{&#39;</span>.$a.<span class="charliteral">&#39;}&#39;</span>;
<a name="l08759"></a>08759         $alias[<span class="charliteral">&#39;u&#39;</span>][] = $this-&gt;<a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf" title="Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;.">_escape</a>($u);
<a name="l08760"></a>08760         <span class="keywordflow">if</span> ($this-&gt;isunicode) {
<a name="l08761"></a>08761             $alias[<span class="charliteral">&#39;u&#39;</span>][] = $this-&gt;<a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf" title="Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;.">_escape</a>($this-&gt;<a class="code" href="classTCPDF.html#a60c04a399d19927e7a3ee249694aaa62" title="Converts UTF-8 strings to Latin1 when using the standard 14 core fonts.">UTF8ToLatin1</a>($u));
<a name="l08762"></a>08762             $alias[<span class="charliteral">&#39;u&#39;</span>][] = $this-&gt;<a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf" title="Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;.">_escape</a>($this-&gt;<a class="code" href="classTCPDF.html#a49060c1c6d0b49446e2cc1dd39f5734e" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8StrRev</a>($u, <span class="keyword">false</span>, $this-&gt;tmprtl));
<a name="l08763"></a>08763             $alias[<span class="charliteral">&#39;a&#39;</span>][] = $this-&gt;<a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf" title="Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;.">_escape</a>($this-&gt;<a class="code" href="classTCPDF.html#a60c04a399d19927e7a3ee249694aaa62" title="Converts UTF-8 strings to Latin1 when using the standard 14 core fonts.">UTF8ToLatin1</a>($a));
<a name="l08764"></a>08764             $alias[<span class="charliteral">&#39;a&#39;</span>][] = $this-&gt;<a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf" title="Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;.">_escape</a>($this-&gt;<a class="code" href="classTCPDF.html#a49060c1c6d0b49446e2cc1dd39f5734e" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8StrRev</a>($a, <span class="keyword">false</span>, $this-&gt;tmprtl));
<a name="l08765"></a>08765         }
<a name="l08766"></a>08766         $alias[<span class="charliteral">&#39;a&#39;</span>][] = $this-&gt;<a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf" title="Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;.">_escape</a>($a);
<a name="l08767"></a>08767         <span class="keywordflow">return</span> $alias;
<a name="l08768"></a>08768     }
<a name="l08769"></a>08769 <span class="comment"></span>
<a name="l08770"></a>08770 <span class="comment">    /**</span>
<a name="l08771"></a>08771 <span class="comment">     * Return an array containing all internal page aliases.</span>
<a name="l08772"></a>08772 <span class="comment">     * @return array of page number aliases</span>
<a name="l08773"></a>08773 <span class="comment">     * @protected</span>
<a name="l08774"></a>08774 <span class="comment">     */</span>
<a name="l08775"></a><a class="code" href="classTCPDF.html#af8fbad549f0384a7f76fa6db13193075">08775</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af8fbad549f0384a7f76fa6db13193075" title="Return an array containing all internal page aliases.">getAllInternalPageNumberAliases</a>() {
<a name="l08776"></a>08776         $basic_alias = array($this-&gt;alias_tot_pages, $this-&gt;alias_num_page, $this-&gt;alias_group_tot_pages, $this-&gt;alias_group_num_page, $this-&gt;alias_right_shift);
<a name="l08777"></a>08777         $pnalias = array();
<a name="l08778"></a>08778         <span class="keywordflow">foreach</span>($basic_alias as <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> =&gt; $a) {
<a name="l08779"></a>08779             $pnalias[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] = $this-&gt;<a class="code" href="classTCPDF.html#adaef81b9b034e5d10c56b3f2fea83175" title="Return an array containing variations for the basic page number alias.">getInternalPageNumberAliases</a>($a);
<a name="l08780"></a>08780         }
<a name="l08781"></a>08781         <span class="keywordflow">return</span> $pnalias;
<a name="l08782"></a>08782     }
<a name="l08783"></a>08783 <span class="comment"></span>
<a name="l08784"></a>08784 <span class="comment">    /**</span>
<a name="l08785"></a>08785 <span class="comment">     * Replace page number aliases with number.</span>
<a name="l08786"></a>08786 <span class="comment">     * @param $page (string) Page content.</span>
<a name="l08787"></a>08787 <span class="comment">     * @param $replace (array) Array of replacements (array keys are replacement strings, values are alias arrays).</span>
<a name="l08788"></a>08788 <span class="comment">     * @param $diff (int) If passed, this will be set to the total char number difference between alias and replacements.</span>
<a name="l08789"></a>08789 <span class="comment">     * @return replaced page content and updated $diff parameter as array.</span>
<a name="l08790"></a>08790 <span class="comment">     * @protected</span>
<a name="l08791"></a>08791 <span class="comment">     */</span>
<a name="l08792"></a><a class="code" href="classTCPDF.html#a9d433df65b8aa61b64375c95803f33dd">08792</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9d433df65b8aa61b64375c95803f33dd" title="Replace page number aliases with number.">replacePageNumAliases</a>(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, $replace, <a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a>=0) {
<a name="l08793"></a>08793         <span class="keywordflow">foreach</span> ($replace as $rep) {
<a name="l08794"></a>08794             <span class="keywordflow">foreach</span> ($rep[3] as $a) {
<a name="l08795"></a>08795                 <span class="keywordflow">if</span> (strpos(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, $a) !== <span class="keyword">false</span>) {
<a name="l08796"></a>08796                     <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> = str_replace($a, $rep[0], <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>);
<a name="l08797"></a>08797                     <a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a> += ($rep[2] - $rep[1]);
<a name="l08798"></a>08798                 }
<a name="l08799"></a>08799             }
<a name="l08800"></a>08800         }
<a name="l08801"></a>08801         <span class="keywordflow">return</span> array(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, <a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a>);
<a name="l08802"></a>08802     }
<a name="l08803"></a>08803 <span class="comment"></span>
<a name="l08804"></a>08804 <span class="comment">    /**</span>
<a name="l08805"></a>08805 <span class="comment">     * Replace right shift page number aliases with spaces to correct right alignment.</span>
<a name="l08806"></a>08806 <span class="comment">     * This works perfectly only when using monospaced fonts.</span>
<a name="l08807"></a>08807 <span class="comment">     * @param $page (string) Page content.</span>
<a name="l08808"></a>08808 <span class="comment">     * @param $aliases (array) Array of page aliases.</span>
<a name="l08809"></a>08809 <span class="comment">     * @param $diff (int) initial difference to add.</span>
<a name="l08810"></a>08810 <span class="comment">     * @return replaced page content.</span>
<a name="l08811"></a>08811 <span class="comment">     * @protected</span>
<a name="l08812"></a>08812 <span class="comment">     */</span>
<a name="l08813"></a><a class="code" href="classTCPDF.html#af3ca25bafc44372ca6d7fd7951dcad46">08813</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af3ca25bafc44372ca6d7fd7951dcad46" title="Replace right shift page number aliases with spaces to correct right alignment.">replaceRightShiftPageNumAliases</a>(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, $aliases, <a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a>) {
<a name="l08814"></a>08814         <span class="keywordflow">foreach</span> ($aliases as <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> =&gt; $alias) {
<a name="l08815"></a>08815             <span class="keywordflow">foreach</span> ($alias as $a) {
<a name="l08816"></a>08816                 <span class="comment">// find position of compensation factor</span>
<a name="l08817"></a>08817                 $startnum = (strpos($a, <span class="charliteral">&#39;:&#39;</span>) + 1);
<a name="l08818"></a>08818                 $a = substr($a, 0, $startnum);
<a name="l08819"></a>08819                 <span class="keywordflow">if</span> ((<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, $a)) !== <span class="keyword">false</span>) {
<a name="l08820"></a>08820                     <span class="comment">// end of alias</span>
<a name="l08821"></a>08821                     $endnum = strpos(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, <span class="charliteral">&#39;}&#39;</span>, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>);
<a name="l08822"></a>08822                     <span class="comment">// string to be replaced</span>
<a name="l08823"></a>08823                     $aa = substr(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>, ($endnum - <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + 1));
<a name="l08824"></a>08824                     <span class="comment">// get compensation factor</span>
<a name="l08825"></a>08825                     $ratio = substr(<a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>, (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + $startnum), ($endnum - <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> - $startnum));
<a name="l08826"></a>08826                     $ratio = preg_replace(<span class="stringliteral">&#39;/[^0-9\.]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $ratio);
<a name="l08827"></a>08827                     $ratio = floatval($ratio);
<a name="l08828"></a>08828                     <span class="keywordflow">if</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="charliteral">&#39;u&#39;</span>) {
<a name="l08829"></a>08829                         $chrdiff = floor((<a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a> + 12) * $ratio);
<a name="l08830"></a>08830                         $shift = str_repeat(<span class="charliteral">&#39; &#39;</span>, $chrdiff);
<a name="l08831"></a>08831                         $shift = $this-&gt;<a class="code" href="classTCPDF.html#a1b521359e6e473dc61ad966a90a7839e" title="Converts UTF-8 strings to UTF16-BE.">UTF8ToUTF16BE</a>($shift, <span class="keyword">false</span>);
<a name="l08832"></a>08832                     } <span class="keywordflow">else</span> {
<a name="l08833"></a>08833                         $chrdiff = floor((<a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a> + 11) * $ratio);
<a name="l08834"></a>08834                         $shift = str_repeat(<span class="charliteral">&#39; &#39;</span>, $chrdiff);
<a name="l08835"></a>08835                     }
<a name="l08836"></a>08836                     <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a> = str_replace($aa, $shift, <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>);
<a name="l08837"></a>08837                 }
<a name="l08838"></a>08838             }
<a name="l08839"></a>08839         }
<a name="l08840"></a>08840         <span class="keywordflow">return</span> <a class="code" href="classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1" title="Current page number.">$page</a>;
<a name="l08841"></a>08841     }
<a name="l08842"></a>08842 <span class="comment"></span>
<a name="l08843"></a>08843 <span class="comment">    /**</span>
<a name="l08844"></a>08844 <span class="comment">     * Output pages (and replace page number aliases).</span>
<a name="l08845"></a>08845 <span class="comment">     * @protected</span>
<a name="l08846"></a>08846 <span class="comment">     */</span>
<a name="l08847"></a><a class="code" href="classTCPDF.html#a65bfa0bffc92dd5c359c114b837c81c0">08847</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a65bfa0bffc92dd5c359c114b837c81c0" title="Output pages (and replace page number aliases).">_putpages</a>() {
<a name="l08848"></a>08848         $filter = ($this-&gt;compress) ? <span class="stringliteral">&#39;/Filter /FlateDecode &#39;</span> : <span class="stringliteral">&#39;&#39;</span>;
<a name="l08849"></a>08849         <span class="comment">// get internal aliases for page numbers</span>
<a name="l08850"></a>08850         $pnalias = $this-&gt;<a class="code" href="classTCPDF.html#af8fbad549f0384a7f76fa6db13193075" title="Return an array containing all internal page aliases.">getAllInternalPageNumberAliases</a>();
<a name="l08851"></a>08851         $num_pages = $this-&gt;numpages;
<a name="l08852"></a>08852         $ptpa = $this-&gt;<a class="code" href="classTCPDF.html#a0ab6ba21b10fcfba6422950b88d6ff8d" title="Format the page numbers.">formatPageNumber</a>(($this-&gt;starting_page_number + $num_pages - 1));
<a name="l08853"></a>08853         $ptpu = $this-&gt;<a class="code" href="classTCPDF.html#a1b521359e6e473dc61ad966a90a7839e" title="Converts UTF-8 strings to UTF16-BE.">UTF8ToUTF16BE</a>($ptpa, <span class="keyword">false</span>);
<a name="l08854"></a>08854         $ptp_num_chars = $this-&gt;<a class="code" href="classTCPDF.html#ac9dc6318fd217971aff282532ab91e43" title="Returns the numbero of characters in a string.">GetNumChars</a>($ptpa);
<a name="l08855"></a>08855         $pagegroupnum = 0;
<a name="l08856"></a>08856         $groupnum = 0;
<a name="l08857"></a>08857         $ptgu = 1;
<a name="l08858"></a>08858         $ptga = 1;
<a name="l08859"></a>08859         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a> = 1; <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a> &lt;= $num_pages; ++<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>) {
<a name="l08860"></a>08860             <span class="comment">// get current page</span>
<a name="l08861"></a>08861             $temppage = $this-&gt;<a class="code" href="classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56" title="Get page buffer content.">getPageBuffer</a>(<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>);
<a name="l08862"></a>08862             <a class="code" href="classTCPDF.html#a2111c4472eae611423616d58c1e85430" title="Array containing page lengths in bytes.">$pagelen</a> = strlen($temppage);
<a name="l08863"></a>08863             <span class="comment">// set replacements for total pages number</span>
<a name="l08864"></a>08864             $pnpa = $this-&gt;<a class="code" href="classTCPDF.html#a0ab6ba21b10fcfba6422950b88d6ff8d" title="Format the page numbers.">formatPageNumber</a>(($this-&gt;starting_page_number + <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a> - 1));
<a name="l08865"></a>08865             $pnpu = $this-&gt;<a class="code" href="classTCPDF.html#a1b521359e6e473dc61ad966a90a7839e" title="Converts UTF-8 strings to UTF16-BE.">UTF8ToUTF16BE</a>($pnpa, <span class="keyword">false</span>);
<a name="l08866"></a>08866             $pnp_num_chars = $this-&gt;<a class="code" href="classTCPDF.html#ac9dc6318fd217971aff282532ab91e43" title="Returns the numbero of characters in a string.">GetNumChars</a>($pnpa);
<a name="l08867"></a>08867             $pdiff = 0; <span class="comment">// difference used for right shift alignment of page numbers</span>
<a name="l08868"></a>08868             $gdiff = 0; <span class="comment">// difference used for right shift alignment of page group numbers</span>
<a name="l08869"></a>08869             <span class="keywordflow">if</span> (!empty($this-&gt;pagegroups)) {
<a name="l08870"></a>08870                 <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>])) {
<a name="l08871"></a>08871                     $pagegroupnum = 0;
<a name="l08872"></a>08872                     ++$groupnum;
<a name="l08873"></a>08873                     $ptga = $this-&gt;<a class="code" href="classTCPDF.html#a0ab6ba21b10fcfba6422950b88d6ff8d" title="Format the page numbers.">formatPageNumber</a>($this-&gt;pagegroups[$groupnum]);
<a name="l08874"></a>08874                     $ptgu = $this-&gt;<a class="code" href="classTCPDF.html#a1b521359e6e473dc61ad966a90a7839e" title="Converts UTF-8 strings to UTF16-BE.">UTF8ToUTF16BE</a>($ptga, <span class="keyword">false</span>);
<a name="l08875"></a>08875                     $ptg_num_chars = $this-&gt;<a class="code" href="classTCPDF.html#ac9dc6318fd217971aff282532ab91e43" title="Returns the numbero of characters in a string.">GetNumChars</a>($ptga);
<a name="l08876"></a>08876                 }
<a name="l08877"></a>08877                 ++$pagegroupnum;
<a name="l08878"></a>08878                 $pnga = $this-&gt;<a class="code" href="classTCPDF.html#a0ab6ba21b10fcfba6422950b88d6ff8d" title="Format the page numbers.">formatPageNumber</a>($pagegroupnum);
<a name="l08879"></a>08879                 $pngu = $this-&gt;<a class="code" href="classTCPDF.html#a1b521359e6e473dc61ad966a90a7839e" title="Converts UTF-8 strings to UTF16-BE.">UTF8ToUTF16BE</a>($pnga, <span class="keyword">false</span>);
<a name="l08880"></a>08880                 $png_num_chars = $this-&gt;<a class="code" href="classTCPDF.html#ac9dc6318fd217971aff282532ab91e43" title="Returns the numbero of characters in a string.">GetNumChars</a>($pnga);
<a name="l08881"></a>08881                 <span class="comment">// replace page numbers</span>
<a name="l08882"></a>08882                 $replace = array();
<a name="l08883"></a>08883                 $replace[] = array($ptgu, $ptg_num_chars, 9, $pnalias[2][<span class="charliteral">&#39;u&#39;</span>]);
<a name="l08884"></a>08884                 $replace[] = array($ptga, $ptg_num_chars, 7, $pnalias[2][<span class="charliteral">&#39;a&#39;</span>]);
<a name="l08885"></a>08885                 $replace[] = array($pngu, $png_num_chars, 9, $pnalias[3][<span class="charliteral">&#39;u&#39;</span>]);
<a name="l08886"></a>08886                 $replace[] = array($pnga, $png_num_chars, 7, $pnalias[3][<span class="charliteral">&#39;a&#39;</span>]);
<a name="l08887"></a>08887                 list($temppage, $gdiff) = $this-&gt;<a class="code" href="classTCPDF.html#a9d433df65b8aa61b64375c95803f33dd" title="Replace page number aliases with number.">replacePageNumAliases</a>($temppage, $replace, $gdiff);
<a name="l08888"></a>08888             }
<a name="l08889"></a>08889             <span class="comment">// replace page numbers</span>
<a name="l08890"></a>08890             $replace = array();
<a name="l08891"></a>08891             $replace[] = array($ptpu, $ptp_num_chars, 9, $pnalias[0][<span class="charliteral">&#39;u&#39;</span>]);
<a name="l08892"></a>08892             $replace[] = array($ptpa, $ptp_num_chars, 7, $pnalias[0][<span class="charliteral">&#39;a&#39;</span>]);
<a name="l08893"></a>08893             $replace[] = array($pnpu, $pnp_num_chars, 9, $pnalias[1][<span class="charliteral">&#39;u&#39;</span>]);
<a name="l08894"></a>08894             $replace[] = array($pnpa, $pnp_num_chars, 7, $pnalias[1][<span class="charliteral">&#39;a&#39;</span>]);
<a name="l08895"></a>08895             list($temppage, $pdiff) = $this-&gt;<a class="code" href="classTCPDF.html#a9d433df65b8aa61b64375c95803f33dd" title="Replace page number aliases with number.">replacePageNumAliases</a>($temppage, $replace, $pdiff);
<a name="l08896"></a>08896             <span class="comment">// replace right shift alias</span>
<a name="l08897"></a>08897             $temppage = $this-&gt;<a class="code" href="classTCPDF.html#af3ca25bafc44372ca6d7fd7951dcad46" title="Replace right shift page number aliases with spaces to correct right alignment.">replaceRightShiftPageNumAliases</a>($temppage, $pnalias[4], max($pdiff, $gdiff));
<a name="l08898"></a>08898             <span class="comment">// replace EPS marker</span>
<a name="l08899"></a>08899             $temppage = str_replace($this-&gt;epsmarker, <span class="stringliteral">&#39;&#39;</span>, $temppage);
<a name="l08900"></a>08900             <span class="comment">//Page</span>
<a name="l08901"></a>08901             $this-&gt;page_obj_id[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>] = $this-&gt;<a class="code" href="classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d" title="Begin a new object and return the object number.">_newobj</a>();
<a name="l08902"></a>08902             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l08903"></a>08903             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Type /Page&#39;</span>;
<a name="l08904"></a>08904             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Parent 1 0 R&#39;</span>;
<a name="l08905"></a>08905             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /LastModified &#39;</span>.$this-&gt;_datestring();
<a name="l08906"></a>08906             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Resources 2 0 R&#39;</span>;
<a name="l08907"></a>08907             $boxes = array(<span class="stringliteral">&#39;MediaBox&#39;</span>, <span class="stringliteral">&#39;CropBox&#39;</span>, <span class="stringliteral">&#39;BleedBox&#39;</span>, <span class="stringliteral">&#39;TrimBox&#39;</span>, <span class="stringliteral">&#39;ArtBox&#39;</span>);
<a name="l08908"></a>08908             <span class="keywordflow">foreach</span> ($boxes as $box) {
<a name="l08909"></a>08909                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$box;
<a name="l08910"></a>08910                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= sprintf(<span class="stringliteral">&#39; [%.2F %.2F %.2F %.2F]&#39;</span>, $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][$box][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][$box][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][$box][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][$box][<span class="stringliteral">&#39;ury&#39;</span>]);
<a name="l08911"></a>08911             }
<a name="l08912"></a>08912             <span class="keywordflow">if</span> (isset($this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>]) AND !empty($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>])) {
<a name="l08913"></a>08913                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BoxColorInfo &lt;&lt;&#39;</span>;
<a name="l08914"></a>08914                 <span class="keywordflow">foreach</span> ($boxes as $box) {
<a name="l08915"></a>08915                     <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box])) {
<a name="l08916"></a>08916                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$box.<span class="stringliteral">&#39; &lt;&lt;&#39;</span>;
<a name="l08917"></a>08917                         <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;C&#39;</span>])) {
<a name="l08918"></a>08918                             $color = $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;C&#39;</span>];
<a name="l08919"></a>08919                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /C [&#39;</span>;
<a name="l08920"></a>08920                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= sprintf(<span class="stringliteral">&#39; %.3F %.3F %.3F&#39;</span>, $color[0]/255, $color[1]/255, $color[2]/255);
<a name="l08921"></a>08921                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; ]&#39;</span>;
<a name="l08922"></a>08922                         }
<a name="l08923"></a>08923                         <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;W&#39;</span>])) {
<a name="l08924"></a>08924                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /W &#39;</span>.($this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;W&#39;</span>] * $this-&gt;k);
<a name="l08925"></a>08925                         }
<a name="l08926"></a>08926                         <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;S&#39;</span>])) {
<a name="l08927"></a>08927                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /S /&#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;S&#39;</span>];
<a name="l08928"></a>08928                         }
<a name="l08929"></a>08929                         <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;D&#39;</span>])) {
<a name="l08930"></a>08930                             $dashes = $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;D&#39;</span>];
<a name="l08931"></a>08931                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /D [&#39;</span>;
<a name="l08932"></a>08932                             <span class="keywordflow">foreach</span> ($dashes as $dash) {
<a name="l08933"></a>08933                                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= sprintf(<span class="stringliteral">&#39; %.3F&#39;</span>, ($dash * $this-&gt;k));
<a name="l08934"></a>08934                             }
<a name="l08935"></a>08935                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; ]&#39;</span>;
<a name="l08936"></a>08936                         }
<a name="l08937"></a>08937                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l08938"></a>08938                     }
<a name="l08939"></a>08939                 }
<a name="l08940"></a>08940                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l08941"></a>08941             }
<a name="l08942"></a>08942             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Contents &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l08943"></a>08943             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Rotate &#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;Rotate&#39;</span>];
<a name="l08944"></a>08944             <span class="keywordflow">if</span> (!$this-&gt;pdfa_mode) {
<a name="l08945"></a>08945                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Group &lt;&lt; /Type /Group /S /Transparency /CS /DeviceRGB &gt;&gt;&#39;</span>;
<a name="l08946"></a>08946             }
<a name="l08947"></a>08947             <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>]) AND !empty($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>])) {
<a name="l08948"></a>08948                 <span class="comment">// page transitions</span>
<a name="l08949"></a>08949                 <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>])) {
<a name="l08950"></a>08950                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Dur &#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>];
<a name="l08951"></a>08951                 }
<a name="l08952"></a>08952                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Trans &lt;&lt;&#39;</span>;
<a name="l08953"></a>08953                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Type /Trans&#39;</span>;
<a name="l08954"></a>08954                 <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>])) {
<a name="l08955"></a>08955                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /S /&#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>];
<a name="l08956"></a>08956                 }
<a name="l08957"></a>08957                 <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>])) {
<a name="l08958"></a>08958                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /D &#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>];
<a name="l08959"></a>08959                 }
<a name="l08960"></a>08960                 <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>])) {
<a name="l08961"></a>08961                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Dm /&#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>];
<a name="l08962"></a>08962                 }
<a name="l08963"></a>08963                 <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>])) {
<a name="l08964"></a>08964                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /M /&#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>];
<a name="l08965"></a>08965                 }
<a name="l08966"></a>08966                 <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>])) {
<a name="l08967"></a>08967                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Di &#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>];
<a name="l08968"></a>08968                 }
<a name="l08969"></a>08969                 <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>])) {
<a name="l08970"></a>08970                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /SS &#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>];
<a name="l08971"></a>08971                 }
<a name="l08972"></a>08972                 <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>])) {
<a name="l08973"></a>08973                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /B &#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>];
<a name="l08974"></a>08974                 }
<a name="l08975"></a>08975                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l08976"></a>08976             }
<a name="l08977"></a>08977             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= $this-&gt;<a class="code" href="classTCPDF.html#a42cfd0a9e84edfcaa1e46d3d7283ef73" title="Get references to page annotations.">_getannotsrefs</a>($n);
<a name="l08978"></a>08978             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PZ &#39;</span>.$this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="stringliteral">&#39;PZ&#39;</span>];
<a name="l08979"></a>08979             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l08980"></a>08980             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l08981"></a>08981             $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l08982"></a>08982             <span class="comment">//Page content</span>
<a name="l08983"></a>08983             $p = ($this-&gt;compress) ? gzcompress($temppage) : $temppage;
<a name="l08984"></a>08984             $this-&gt;<a class="code" href="classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d" title="Begin a new object and return the object number.">_newobj</a>();
<a name="l08985"></a>08985             $p = $this-&gt;<a class="code" href="classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb" title="get raw output stream.">_getrawstream</a>($p);
<a name="l08986"></a>08986             $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<span class="stringliteral">&#39;&lt;&lt;&#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($p).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$p.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);
<a name="l08987"></a>08987             <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l08988"></a>08988                 <span class="comment">// remove temporary files</span>
<a name="l08989"></a>08989                 unlink($this-&gt;pages[$n]);
<a name="l08990"></a>08990             }
<a name="l08991"></a>08991         }
<a name="l08992"></a>08992         <span class="comment">//Pages root</span>
<a name="l08993"></a>08993         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;<a class="code" href="classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1" title="Return the starting object string for the selected object ID.">_getobj</a>(1).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l08994"></a>08994         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt; /Type /Pages /Kids [&#39;</span>;
<a name="l08995"></a>08995         <span class="keywordflow">foreach</span>($this-&gt;page_obj_id as $page_obj) {
<a name="l08996"></a>08996             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.$page_obj.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l08997"></a>08997         }
<a name="l08998"></a>08998         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; ] /Count &#39;</span>.$num_pages.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l08999"></a>08999         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l09000"></a>09000         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l09001"></a>09001     }
<a name="l09002"></a>09002 <span class="comment"></span>
<a name="l09003"></a>09003 <span class="comment">    /**</span>
<a name="l09004"></a>09004 <span class="comment">     * Output references to page annotations</span>
<a name="l09005"></a>09005 <span class="comment">     * @param $n (int) page number</span>
<a name="l09006"></a>09006 <span class="comment">     * @protected</span>
<a name="l09007"></a>09007 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09008"></a>09008 <span class="comment">     * @since 4.7.000 (2008-08-29)</span>
<a name="l09009"></a>09009 <span class="comment">     * @deprecated</span>
<a name="l09010"></a>09010 <span class="comment">     */</span>
<a name="l09011"></a><a class="code" href="classTCPDF.html#a7a19257fcbaa5c79ce4a5aa4319ec8af">09011</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7a19257fcbaa5c79ce4a5aa4319ec8af" title="Output references to page annotations.">_putannotsrefs</a>(<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>) {
<a name="l09012"></a>09012         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>($this-&gt;<a class="code" href="classTCPDF.html#a42cfd0a9e84edfcaa1e46d3d7283ef73" title="Get references to page annotations.">_getannotsrefs</a>(<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>));
<a name="l09013"></a>09013     }
<a name="l09014"></a>09014 <span class="comment"></span>
<a name="l09015"></a>09015 <span class="comment">    /**</span>
<a name="l09016"></a>09016 <span class="comment">     * Get references to page annotations.</span>
<a name="l09017"></a>09017 <span class="comment">     * @param $n (int) page number</span>
<a name="l09018"></a>09018 <span class="comment">     * @return string</span>
<a name="l09019"></a>09019 <span class="comment">     * @protected</span>
<a name="l09020"></a>09020 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09021"></a>09021 <span class="comment">     * @since 5.0.010 (2010-05-17)</span>
<a name="l09022"></a>09022 <span class="comment">     */</span>
<a name="l09023"></a><a class="code" href="classTCPDF.html#a42cfd0a9e84edfcaa1e46d3d7283ef73">09023</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a42cfd0a9e84edfcaa1e46d3d7283ef73" title="Get references to page annotations.">_getannotsrefs</a>(<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>) {
<a name="l09024"></a>09024         <span class="keywordflow">if</span> (!(isset($this-&gt;PageAnnots[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>]) OR ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])))) {
<a name="l09025"></a>09025             <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
<a name="l09026"></a>09026         }
<a name="l09027"></a>09027         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39; /Annots [&#39;</span>;
<a name="l09028"></a>09028         <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$n])) {
<a name="l09029"></a>09029             <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$n] as $key =&gt; $val) {
<a name="l09030"></a>09030                 <span class="keywordflow">if</span> (!in_array($val[<span class="charliteral">&#39;n&#39;</span>], $this-&gt;radio_groups)) {
<a name="l09031"></a>09031                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.$val[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09032"></a>09032                 }
<a name="l09033"></a>09033             }
<a name="l09034"></a>09034             <span class="comment">// add radiobutton groups</span>
<a name="l09035"></a>09035             <span class="keywordflow">if</span> (isset($this-&gt;radiobutton_groups[$n])) {
<a name="l09036"></a>09036                 <span class="keywordflow">foreach</span> ($this-&gt;radiobutton_groups[$n] as $key =&gt; <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l09037"></a>09037                     <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="charliteral">&#39;n&#39;</span>])) {
<a name="l09038"></a>09038                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.$data[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09039"></a>09039                     }
<a name="l09040"></a>09040                 }
<a name="l09041"></a>09041             }
<a name="l09042"></a>09042         }
<a name="l09043"></a>09043         <span class="keywordflow">if</span> ($this-&gt;sign AND ($n == $this-&gt;signature_appearance[<span class="stringliteral">&#39;page&#39;</span>]) AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])) {
<a name="l09044"></a>09044             <span class="comment">// set reference for signature object</span>
<a name="l09045"></a>09045             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;sig_obj_id.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09046"></a>09046         }
<a name="l09047"></a>09047         <span class="keywordflow">if</span> (!empty($this-&gt;empty_signature_appearance)) {
<a name="l09048"></a>09048             <span class="keywordflow">foreach</span> ($this-&gt;empty_signature_appearance as $esa) {
<a name="l09049"></a>09049                 <span class="keywordflow">if</span> ($esa[<span class="stringliteral">&#39;page&#39;</span>] == $n) {
<a name="l09050"></a>09050                     <span class="comment">// set reference for empty signature objects</span>
<a name="l09051"></a>09051                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.$esa[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09052"></a>09052                 }
<a name="l09053"></a>09053             }
<a name="l09054"></a>09054         }
<a name="l09055"></a>09055         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; ]&#39;</span>;
<a name="l09056"></a>09056         <span class="keywordflow">return</span> <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>;
<a name="l09057"></a>09057     }
<a name="l09058"></a>09058 <span class="comment"></span>
<a name="l09059"></a>09059 <span class="comment">    /**</span>
<a name="l09060"></a>09060 <span class="comment">     * Output annotations objects for all pages.</span>
<a name="l09061"></a>09061 <span class="comment">     * !!! THIS METHOD IS NOT YET COMPLETED !!!</span>
<a name="l09062"></a>09062 <span class="comment">     * See section 12.5 of PDF 32000_2008 reference.</span>
<a name="l09063"></a>09063 <span class="comment">     * @protected</span>
<a name="l09064"></a>09064 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09065"></a>09065 <span class="comment">     * @since 4.0.018 (2008-08-06)</span>
<a name="l09066"></a>09066 <span class="comment">     */</span>
<a name="l09067"></a><a class="code" href="classTCPDF.html#a9dabd5e4c0295bd5caef55968375da9e">09067</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9dabd5e4c0295bd5caef55968375da9e" title="Output annotations objects for all pages.">_putannotsobjs</a>() {
<a name="l09068"></a>09068         <span class="comment">// reset object counter</span>
<a name="l09069"></a>09069         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>=1; <a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a> &lt;= $this-&gt;numpages; ++<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>) {
<a name="l09070"></a>09070             <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>])) {
<a name="l09071"></a>09071                 <span class="comment">// set page annotations</span>
<a name="l09072"></a>09072                 <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$n] as $key =&gt; $pl) {
<a name="l09073"></a>09073                     $annot_obj_id = $this-&gt;PageAnnots[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][$key][<span class="charliteral">&#39;n&#39;</span>];
<a name="l09074"></a>09074                     <span class="comment">// create annotation object for grouping radiobuttons</span>
<a name="l09075"></a>09075                     <span class="keywordflow">if</span> (isset($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]]) AND is_array($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]])) {
<a name="l09076"></a>09076                         $radio_button_obj_id = $this-&gt;radiobutton_groups[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][$pl[<span class="stringliteral">&#39;txt&#39;</span>]][<span class="charliteral">&#39;n&#39;</span>];
<a name="l09077"></a>09077                         $annots = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l09078"></a>09078                         $annots .= <span class="stringliteral">&#39; /Type /Annot&#39;</span>;
<a name="l09079"></a>09079                         $annots .= <span class="stringliteral">&#39; /Subtype /Widget&#39;</span>;
<a name="l09080"></a>09080                         $annots .= <span class="stringliteral">&#39; /Rect [0 0 0 0]&#39;</span>;
<a name="l09081"></a>09081                         <span class="keywordflow">if</span> ($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]][<span class="stringliteral">&#39;#readonly#&#39;</span>]) {
<a name="l09082"></a>09082                             <span class="comment">// read only</span>
<a name="l09083"></a>09083                             $annots .= <span class="stringliteral">&#39; /F 68&#39;</span>;
<a name="l09084"></a>09084                             $annots .= <span class="stringliteral">&#39; /Ff 49153&#39;</span>;
<a name="l09085"></a>09085                         } <span class="keywordflow">else</span> {
<a name="l09086"></a>09086                             $annots .= <span class="stringliteral">&#39; /F 4&#39;</span>; <span class="comment">// default print for PDF/A</span>
<a name="l09087"></a>09087                             $annots .= <span class="stringliteral">&#39; /Ff 49152&#39;</span>;
<a name="l09088"></a>09088                         }
<a name="l09089"></a>09089                         $annots .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_datastring($pl[<span class="stringliteral">&#39;txt&#39;</span>], $radio_button_obj_id);
<a name="l09090"></a>09090                         $annots .= <span class="stringliteral">&#39; /FT /Btn&#39;</span>;
<a name="l09091"></a>09091                         $annots .= <span class="stringliteral">&#39; /Kids [&#39;</span>;
<a name="l09092"></a>09092                         <span class="keywordflow">foreach</span> ($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]] as $key =&gt; <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l09093"></a>09093                             <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;kid&#39;</span>])) {
<a name="l09094"></a>09094                                 $annots .= <span class="charliteral">&#39; &#39;</span>.$data[<span class="stringliteral">&#39;kid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09095"></a>09095                                 <span class="keywordflow">if</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;def&#39;</span>] !== <span class="stringliteral">&#39;Off&#39;</span>) {
<a name="l09096"></a>09096                                     $defval = <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;def&#39;</span>];
<a name="l09097"></a>09097                                 }
<a name="l09098"></a>09098                             }
<a name="l09099"></a>09099                         }
<a name="l09100"></a>09100                         $annots .= <span class="stringliteral">&#39; ]&#39;</span>;
<a name="l09101"></a>09101                         <span class="keywordflow">if</span> (isset($defval)) {
<a name="l09102"></a>09102                             $annots .= <span class="stringliteral">&#39; /V /&#39;</span>.$defval;
<a name="l09103"></a>09103                         }
<a name="l09104"></a>09104                         $annots .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l09105"></a>09105                         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>($this-&gt;<a class="code" href="classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1" title="Return the starting object string for the selected object ID.">_getobj</a>($radio_button_obj_id).<span class="stringliteral">&quot;\n&quot;</span>.$annots.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);
<a name="l09106"></a>09106                         $this-&gt;form_obj_id[] = $radio_button_obj_id;
<a name="l09107"></a>09107                         <span class="comment">// store object id to be used on Parent entry of Kids</span>
<a name="l09108"></a>09108                         $this-&gt;radiobutton_groups[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][$pl[<span class="stringliteral">&#39;txt&#39;</span>]] = $radio_button_obj_id;
<a name="l09109"></a>09109                     }
<a name="l09110"></a>09110                     $formfield = <span class="keyword">false</span>;
<a name="l09111"></a>09111                     $pl[<span class="stringliteral">&#39;opt&#39;</span>] = array_change_key_case($pl[<span class="stringliteral">&#39;opt&#39;</span>], CASE_LOWER);
<a name="l09112"></a>09112                     $a = $pl[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k;
<a name="l09113"></a>09113                     $b = $this-&gt;pagedim[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][<span class="charliteral">&#39;h&#39;</span>] - (($pl[<span class="charliteral">&#39;y&#39;</span>] + $pl[<span class="charliteral">&#39;h&#39;</span>]) * $this-&gt;k);
<a name="l09114"></a>09114                     <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = $pl[<span class="charliteral">&#39;w&#39;</span>] * $this-&gt;k;
<a name="l09115"></a>09115                     $d = $pl[<span class="charliteral">&#39;h&#39;</span>] * $this-&gt;k;
<a name="l09116"></a>09116                     $rect = sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F&#39;</span>, $a, $b, $a+<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, $b+$d);
<a name="l09117"></a>09117                     <span class="comment">// create new annotation object</span>
<a name="l09118"></a>09118                     $annots = <span class="stringliteral">&#39;&lt;&lt;/Type /Annot&#39;</span>;
<a name="l09119"></a>09119                     $annots .= <span class="stringliteral">&#39; /Subtype /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subtype&#39;</span>];
<a name="l09120"></a>09120                     $annots .= <span class="stringliteral">&#39; /Rect [&#39;</span>.$rect.<span class="charliteral">&#39;]&#39;</span>;
<a name="l09121"></a>09121                     $ft = array(<span class="stringliteral">&#39;Btn&#39;</span>, <span class="stringliteral">&#39;Tx&#39;</span>, <span class="stringliteral">&#39;Ch&#39;</span>, <span class="stringliteral">&#39;Sig&#39;</span>);
<a name="l09122"></a>09122                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ft&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ft&#39;</span>], $ft)) {
<a name="l09123"></a>09123                         $annots .= <span class="stringliteral">&#39; /FT /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ft&#39;</span>];
<a name="l09124"></a>09124                         $formfield = <span class="keyword">true</span>;
<a name="l09125"></a>09125                     }
<a name="l09126"></a>09126                     $annots .= <span class="stringliteral">&#39; /Contents &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;txt&#39;</span>], $annot_obj_id);
<a name="l09127"></a>09127                     $annots .= <span class="stringliteral">&#39; /P &#39;</span>.$this-&gt;page_obj_id[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09128"></a>09128                     $annots .= <span class="stringliteral">&#39; /NM &#39;</span>.$this-&gt;_datastring(sprintf(<span class="stringliteral">&#39;%04u-%04u&#39;</span>, $n, $key), $annot_obj_id);
<a name="l09129"></a>09129                     $annots .= <span class="stringliteral">&#39; /M &#39;</span>.$this-&gt;_datestring($annot_obj_id);
<a name="l09130"></a>09130                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;f&#39;</span>])) {
<a name="l09131"></a>09131                         $fval = 0;
<a name="l09132"></a>09132                         <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;f&#39;</span>])) {
<a name="l09133"></a>09133                             <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;f&#39;</span>] as <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>) {
<a name="l09134"></a>09134                                 <span class="keywordflow">switch</span> (strtolower($f)) {
<a name="l09135"></a>09135                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;invisible&#39;</span>: {
<a name="l09136"></a>09136                                         $fval += 1 &lt;&lt; 0;
<a name="l09137"></a>09137                                         <span class="keywordflow">break</span>;
<a name="l09138"></a>09138                                     }
<a name="l09139"></a>09139                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;hidden&#39;</span>: {
<a name="l09140"></a>09140                                         $fval += 1 &lt;&lt; 1;
<a name="l09141"></a>09141                                         <span class="keywordflow">break</span>;
<a name="l09142"></a>09142                                     }
<a name="l09143"></a>09143                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;print&#39;</span>: {
<a name="l09144"></a>09144                                         $fval += 1 &lt;&lt; 2;
<a name="l09145"></a>09145                                         <span class="keywordflow">break</span>;
<a name="l09146"></a>09146                                     }
<a name="l09147"></a>09147                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;nozoom&#39;</span>: {
<a name="l09148"></a>09148                                         $fval += 1 &lt;&lt; 3;
<a name="l09149"></a>09149                                         <span class="keywordflow">break</span>;
<a name="l09150"></a>09150                                     }
<a name="l09151"></a>09151                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;norotate&#39;</span>: {
<a name="l09152"></a>09152                                         $fval += 1 &lt;&lt; 4;
<a name="l09153"></a>09153                                         <span class="keywordflow">break</span>;
<a name="l09154"></a>09154                                     }
<a name="l09155"></a>09155                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;noview&#39;</span>: {
<a name="l09156"></a>09156                                         $fval += 1 &lt;&lt; 5;
<a name="l09157"></a>09157                                         <span class="keywordflow">break</span>;
<a name="l09158"></a>09158                                     }
<a name="l09159"></a>09159                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;readonly&#39;</span>: {
<a name="l09160"></a>09160                                         $fval += 1 &lt;&lt; 6;
<a name="l09161"></a>09161                                         <span class="keywordflow">break</span>;
<a name="l09162"></a>09162                                     }
<a name="l09163"></a>09163                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;locked&#39;</span>: {
<a name="l09164"></a>09164                                         $fval += 1 &lt;&lt; 8;
<a name="l09165"></a>09165                                         <span class="keywordflow">break</span>;
<a name="l09166"></a>09166                                     }
<a name="l09167"></a>09167                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;togglenoview&#39;</span>: {
<a name="l09168"></a>09168                                         $fval += 1 &lt;&lt; 9;
<a name="l09169"></a>09169                                         <span class="keywordflow">break</span>;
<a name="l09170"></a>09170                                     }
<a name="l09171"></a>09171                                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;lockedcontents&#39;</span>: {
<a name="l09172"></a>09172                                         $fval += 1 &lt;&lt; 10;
<a name="l09173"></a>09173                                         <span class="keywordflow">break</span>;
<a name="l09174"></a>09174                                     }
<a name="l09175"></a>09175                                     <span class="keywordflow">default</span>: {
<a name="l09176"></a>09176                                         <span class="keywordflow">break</span>;
<a name="l09177"></a>09177                                     }
<a name="l09178"></a>09178                                 }
<a name="l09179"></a>09179                             }
<a name="l09180"></a>09180                         } <span class="keywordflow">else</span> {
<a name="l09181"></a>09181                             $fval = intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;f&#39;</span>]);
<a name="l09182"></a>09182                         }
<a name="l09183"></a>09183                     } <span class="keywordflow">else</span> {
<a name="l09184"></a>09184                         $fval = 4;
<a name="l09185"></a>09185                     }
<a name="l09186"></a>09186                     <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l09187"></a>09187                         <span class="comment">// force print flag for PDF/A mode</span>
<a name="l09188"></a>09188                         $fval |= 4;
<a name="l09189"></a>09189                     }
<a name="l09190"></a>09190                     $annots .= <span class="stringliteral">&#39; /F &#39;</span>.intval($fval);
<a name="l09191"></a>09191                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;as&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;as&#39;</span>])) {
<a name="l09192"></a>09192                         $annots .= <span class="stringliteral">&#39; /AS /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;as&#39;</span>];
<a name="l09193"></a>09193                     }
<a name="l09194"></a>09194                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ap&#39;</span>])) {
<a name="l09195"></a>09195                         <span class="comment">// appearance stream</span>
<a name="l09196"></a>09196                         $annots .= <span class="stringliteral">&#39; /AP &lt;&lt;&#39;</span>;
<a name="l09197"></a>09197                         <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ap&#39;</span>])) {
<a name="l09198"></a>09198                             <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ap&#39;</span>] as $apmode =&gt; $apdef) {
<a name="l09199"></a>09199                                 <span class="comment">// $apmode can be: n = normal; r = rollover; d = down;</span>
<a name="l09200"></a>09200                                 $annots .= <span class="stringliteral">&#39; /&#39;</span>.strtoupper($apmode);
<a name="l09201"></a>09201                                 <span class="keywordflow">if</span> (is_array($apdef)) {
<a name="l09202"></a>09202                                     $annots .= <span class="stringliteral">&#39; &lt;&lt;&#39;</span>;
<a name="l09203"></a>09203                                     <span class="keywordflow">foreach</span> ($apdef as $apstate =&gt; $stream) {
<a name="l09204"></a>09204                                         <span class="comment">// reference to XObject that define the appearance for this mode-state</span>
<a name="l09205"></a>09205                                         $apsobjid = $this-&gt;<a class="code" href="classTCPDF.html#a4235ea24726644eb13d82a2ebe8ee882" title="Put appearance streams XObject used to define annotation&#39;s appearance states.">_putAPXObject</a>(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, $d, $stream);
<a name="l09206"></a>09206                                         $annots .= <span class="stringliteral">&#39; /&#39;</span>.$apstate.<span class="charliteral">&#39; &#39;</span>.$apsobjid.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09207"></a>09207                                     }
<a name="l09208"></a>09208                                     $annots .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l09209"></a>09209                                 } <span class="keywordflow">else</span> {
<a name="l09210"></a>09210                                     <span class="comment">// reference to XObject that define the appearance for this mode</span>
<a name="l09211"></a>09211                                     $apsobjid = $this-&gt;<a class="code" href="classTCPDF.html#a4235ea24726644eb13d82a2ebe8ee882" title="Put appearance streams XObject used to define annotation&#39;s appearance states.">_putAPXObject</a>(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, $d, $apdef);
<a name="l09212"></a>09212                                     $annots .= <span class="charliteral">&#39; &#39;</span>.$apsobjid.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09213"></a>09213                                 }
<a name="l09214"></a>09214                             }
<a name="l09215"></a>09215                         } <span class="keywordflow">else</span> {
<a name="l09216"></a>09216                             $annots .= $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ap&#39;</span>];
<a name="l09217"></a>09217                         }
<a name="l09218"></a>09218                         $annots .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l09219"></a>09219                     }
<a name="l09220"></a>09220                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>]))) {
<a name="l09221"></a>09221                         $annots .= <span class="stringliteral">&#39; /BS &lt;&lt;&#39;</span>;
<a name="l09222"></a>09222                         $annots .= <span class="stringliteral">&#39; /Type /Border&#39;</span>;
<a name="l09223"></a>09223                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;w&#39;</span>])) {
<a name="l09224"></a>09224                             $annots .= <span class="stringliteral">&#39; /W &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;w&#39;</span>]);
<a name="l09225"></a>09225                         }
<a name="l09226"></a>09226                         $bstyles = array(<span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;B&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;U&#39;</span>);
<a name="l09227"></a>09227                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;s&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;s&#39;</span>], $bstyles)) {
<a name="l09228"></a>09228                             $annots .= <span class="stringliteral">&#39; /S /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;s&#39;</span>];
<a name="l09229"></a>09229                         }
<a name="l09230"></a>09230                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;d&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;d&#39;</span>]))) {
<a name="l09231"></a>09231                             $annots .= <span class="stringliteral">&#39; /D [&#39;</span>;
<a name="l09232"></a>09232                             <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;d&#39;</span>] as $cord) {
<a name="l09233"></a>09233                                 $annots .= <span class="charliteral">&#39; &#39;</span>.intval($cord);
<a name="l09234"></a>09234                             }
<a name="l09235"></a>09235                             $annots .= <span class="charliteral">&#39;]&#39;</span>;
<a name="l09236"></a>09236                         }
<a name="l09237"></a>09237                         $annots .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l09238"></a>09238                     } <span class="keywordflow">else</span> {
<a name="l09239"></a>09239                         $annots .= <span class="stringliteral">&#39; /Border [&#39;</span>;
<a name="l09240"></a>09240                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>]) AND (count($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>]) &gt;= 3)) {
<a name="l09241"></a>09241                             $annots .= intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][0]).<span class="charliteral">&#39; &#39;</span>;
<a name="l09242"></a>09242                             $annots .= intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][1]).<span class="charliteral">&#39; &#39;</span>;
<a name="l09243"></a>09243                             $annots .= intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][2]);
<a name="l09244"></a>09244                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][3]) AND is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][3])) {
<a name="l09245"></a>09245                                 $annots .= <span class="stringliteral">&#39; [&#39;</span>;
<a name="l09246"></a>09246                                 <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][3] as $dash) {
<a name="l09247"></a>09247                                     $annots .= intval($dash).<span class="charliteral">&#39; &#39;</span>;
<a name="l09248"></a>09248                                 }
<a name="l09249"></a>09249                                 $annots .= <span class="charliteral">&#39;]&#39;</span>;
<a name="l09250"></a>09250                             }
<a name="l09251"></a>09251                         } <span class="keywordflow">else</span> {
<a name="l09252"></a>09252                             $annots .= <span class="stringliteral">&#39;0 0 0&#39;</span>;
<a name="l09253"></a>09253                         }
<a name="l09254"></a>09254                         $annots .= <span class="charliteral">&#39;]&#39;</span>;
<a name="l09255"></a>09255                     }
<a name="l09256"></a>09256                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>]))) {
<a name="l09257"></a>09257                         $annots .= <span class="stringliteral">&#39; /BE &lt;&lt;&#39;</span>;
<a name="l09258"></a>09258                         $bstyles = array(<span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;C&#39;</span>);
<a name="l09259"></a>09259                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;s&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;s&#39;</span>], $markups)) {
<a name="l09260"></a>09260                             $annots .= <span class="stringliteral">&#39; /S /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;s&#39;</span>];
<a name="l09261"></a>09261                         } <span class="keywordflow">else</span> {
<a name="l09262"></a>09262                             $annots .= <span class="stringliteral">&#39; /S /S&#39;</span>;
<a name="l09263"></a>09263                         }
<a name="l09264"></a>09264                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;i&#39;</span>] &gt;= 0) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;i&#39;</span>] &lt;= 2)) {
<a name="l09265"></a>09265                             $annots .= <span class="stringliteral">&#39; /I &#39;</span>.sprintf(<span class="stringliteral">&#39; %.4F&#39;</span>, $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]);
<a name="l09266"></a>09266                         }
<a name="l09267"></a>09267                         $annots .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l09268"></a>09268                     }
<a name="l09269"></a>09269                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;c&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;c&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;c&#39;</span>])) {
<a name="l09270"></a>09270                         $annots .= <span class="stringliteral">&#39; /C &#39;</span>.$this-&gt;getColorStringFromArray($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;c&#39;</span>]);
<a name="l09271"></a>09271                     }
<a name="l09272"></a>09272                     <span class="comment">//$annots .= &#39; /StructParent &#39;;</span>
<a name="l09273"></a>09273                     <span class="comment">//$annots .= &#39; /OC &#39;;</span>
<a name="l09274"></a>09274                     $markups = array(<span class="stringliteral">&#39;text&#39;</span>, <span class="stringliteral">&#39;freetext&#39;</span>, <span class="stringliteral">&#39;line&#39;</span>, <span class="stringliteral">&#39;square&#39;</span>, <span class="stringliteral">&#39;circle&#39;</span>, <span class="stringliteral">&#39;polygon&#39;</span>, <span class="stringliteral">&#39;polyline&#39;</span>, <span class="stringliteral">&#39;highlight&#39;</span>, <span class="stringliteral">&#39;underline&#39;</span>, <span class="stringliteral">&#39;squiggly&#39;</span>, <span class="stringliteral">&#39;strikeout&#39;</span>, <span class="stringliteral">&#39;stamp&#39;</span>, <span class="stringliteral">&#39;caret&#39;</span>, <span class="stringliteral">&#39;ink&#39;</span>, <span class="stringliteral">&#39;fileattachment&#39;</span>, <span class="stringliteral">&#39;sound&#39;</span>);
<a name="l09275"></a>09275                     <span class="keywordflow">if</span> (in_array(strtolower($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subtype&#39;</span>]), $markups)) {
<a name="l09276"></a>09276                         <span class="comment">// this is a markup type</span>
<a name="l09277"></a>09277                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>])) {
<a name="l09278"></a>09278                             $annots .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>], $annot_obj_id);
<a name="l09279"></a>09279                         }
<a name="l09280"></a>09280                         <span class="comment">//$annots .= &#39; /Popup &#39;;</span>
<a name="l09281"></a>09281                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>])) {
<a name="l09282"></a>09282                             $annots .= <span class="stringliteral">&#39; /CA &#39;</span>.sprintf(<span class="stringliteral">&#39;%.4F&#39;</span>, floatval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>]));
<a name="l09283"></a>09283                         }
<a name="l09284"></a>09284                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>])) {
<a name="l09285"></a>09285                             $annots .= <span class="stringliteral">&#39; /RC &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>], $annot_obj_id);
<a name="l09286"></a>09286                         }
<a name="l09287"></a>09287                         $annots .= <span class="stringliteral">&#39; /CreationDate &#39;</span>.$this-&gt;_datestring($annot_obj_id);
<a name="l09288"></a>09288                         <span class="comment">//$annots .= &#39; /IRT &#39;;</span>
<a name="l09289"></a>09289                         <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subj&#39;</span>])) {
<a name="l09290"></a>09290                             $annots .= <span class="stringliteral">&#39; /Subj &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subj&#39;</span>], $annot_obj_id);
<a name="l09291"></a>09291                         }
<a name="l09292"></a>09292                         <span class="comment">//$annots .= &#39; /RT &#39;;</span>
<a name="l09293"></a>09293                         <span class="comment">//$annots .= &#39; /IT &#39;;</span>
<a name="l09294"></a>09294                         <span class="comment">//$annots .= &#39; /ExData &#39;;</span>
<a name="l09295"></a>09295                     }
<a name="l09296"></a>09296                     $lineendings = array(<span class="stringliteral">&#39;Square&#39;</span>, <span class="stringliteral">&#39;Circle&#39;</span>, <span class="stringliteral">&#39;Diamond&#39;</span>, <span class="stringliteral">&#39;OpenArrow&#39;</span>, <span class="stringliteral">&#39;ClosedArrow&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Butt&#39;</span>, <span class="stringliteral">&#39;ROpenArrow&#39;</span>, <span class="stringliteral">&#39;RClosedArrow&#39;</span>, <span class="stringliteral">&#39;Slash&#39;</span>);
<a name="l09297"></a>09297                     <span class="comment">// Annotation types</span>
<a name="l09298"></a>09298                     <span class="keywordflow">switch</span> (strtolower($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subtype&#39;</span>])) {
<a name="l09299"></a>09299                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>: {
<a name="l09300"></a>09300                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;open&#39;</span>])) {
<a name="l09301"></a>09301                                 $annots .= <span class="stringliteral">&#39; /Open &#39;</span>. (strtolower($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;open&#39;</span>]) == <span class="stringliteral">&#39;true&#39;</span> ? <span class="stringliteral">&#39;true&#39;</span> : <span class="stringliteral">&#39;false&#39;</span>);
<a name="l09302"></a>09302                             }
<a name="l09303"></a>09303                             $iconsapp = array(<span class="stringliteral">&#39;Comment&#39;</span>, <span class="stringliteral">&#39;Help&#39;</span>, <span class="stringliteral">&#39;Insert&#39;</span>, <span class="stringliteral">&#39;Key&#39;</span>, <span class="stringliteral">&#39;NewParagraph&#39;</span>, <span class="stringliteral">&#39;Note&#39;</span>, <span class="stringliteral">&#39;Paragraph&#39;</span>);
<a name="l09304"></a>09304                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>], $iconsapp)) {
<a name="l09305"></a>09305                                 $annots .= <span class="stringliteral">&#39; /Name /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>];
<a name="l09306"></a>09306                             } <span class="keywordflow">else</span> {
<a name="l09307"></a>09307                                 $annots .= <span class="stringliteral">&#39; /Name /Note&#39;</span>;
<a name="l09308"></a>09308                             }
<a name="l09309"></a>09309                             $statemodels = array(<span class="stringliteral">&#39;Marked&#39;</span>, <span class="stringliteral">&#39;Review&#39;</span>);
<a name="l09310"></a>09310                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>], $statemodels)) {
<a name="l09311"></a>09311                                 $annots .= <span class="stringliteral">&#39; /StateModel /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>];
<a name="l09312"></a>09312                             } <span class="keywordflow">else</span> {
<a name="l09313"></a>09313                                 $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>] = <span class="stringliteral">&#39;Marked&#39;</span>;
<a name="l09314"></a>09314                                 $annots .= <span class="stringliteral">&#39; /StateModel /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>];
<a name="l09315"></a>09315                             }
<a name="l09316"></a>09316                             <span class="keywordflow">if</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>] == <span class="stringliteral">&#39;Marked&#39;</span>) {
<a name="l09317"></a>09317                                 $states = array(<span class="stringliteral">&#39;Accepted&#39;</span>, <span class="stringliteral">&#39;Unmarked&#39;</span>);
<a name="l09318"></a>09318                             } <span class="keywordflow">else</span> {
<a name="l09319"></a>09319                                 $states = array(<span class="stringliteral">&#39;Accepted&#39;</span>, <span class="stringliteral">&#39;Rejected&#39;</span>, <span class="stringliteral">&#39;Cancelled&#39;</span>, <span class="stringliteral">&#39;Completed&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>);
<a name="l09320"></a>09320                             }
<a name="l09321"></a>09321                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;state&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;state&#39;</span>], $states)) {
<a name="l09322"></a>09322                                 $annots .= <span class="stringliteral">&#39; /State /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;state&#39;</span>];
<a name="l09323"></a>09323                             } <span class="keywordflow">else</span> {
<a name="l09324"></a>09324                                 <span class="keywordflow">if</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>] == <span class="stringliteral">&#39;Marked&#39;</span>) {
<a name="l09325"></a>09325                                     $annots .= <span class="stringliteral">&#39; /State /Unmarked&#39;</span>;
<a name="l09326"></a>09326                                 } <span class="keywordflow">else</span> {
<a name="l09327"></a>09327                                     $annots .= <span class="stringliteral">&#39; /State /None&#39;</span>;
<a name="l09328"></a>09328                                 }
<a name="l09329"></a>09329                             }
<a name="l09330"></a>09330                             <span class="keywordflow">break</span>;
<a name="l09331"></a>09331                         }
<a name="l09332"></a>09332                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;link&#39;</span>: {
<a name="l09333"></a>09333                             <span class="keywordflow">if</span> (is_string($pl[<span class="stringliteral">&#39;txt&#39;</span>])) {
<a name="l09334"></a>09334                                 <span class="comment">// external URI link</span>
<a name="l09335"></a>09335                                 $annots .= <span class="stringliteral">&#39; /A &lt;&lt;/S /URI /URI &#39;</span>.$this-&gt;_datastring($this-&gt;<a class="code" href="classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320" title="Reverse function for htmlentities.">unhtmlentities</a>($pl[<span class="stringliteral">&#39;txt&#39;</span>]), $annot_obj_id).<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l09336"></a>09336                             } <span class="keywordflow">else</span> {
<a name="l09337"></a>09337                                 <span class="comment">// internal link</span>
<a name="l09338"></a>09338                                 <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> = $this-&gt;links[$pl[<span class="stringliteral">&#39;txt&#39;</span>]];
<a name="l09339"></a>09339                                 <span class="keywordflow">if</span> (isset($this-&gt;page_obj_id[(<a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a>[0])])) {
<a name="l09340"></a>09340                                     $annots .= sprintf(<span class="stringliteral">&#39; /Dest [%u 0 R /XYZ 0 %.2F null]&#39;</span>, $this-&gt;page_obj_id[(<a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a>[0])], ($this-&gt;pagedim[<a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a>[0]][<span class="charliteral">&#39;h&#39;</span>] - (<a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a>[1] * $this-&gt;k)));
<a name="l09341"></a>09341                                 }
<a name="l09342"></a>09342                             }
<a name="l09343"></a>09343                             $hmodes = array(<span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;P&#39;</span>);
<a name="l09344"></a>09344                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>], $hmodes)) {
<a name="l09345"></a>09345                                 $annots .= <span class="stringliteral">&#39; /H /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>];
<a name="l09346"></a>09346                             } <span class="keywordflow">else</span> {
<a name="l09347"></a>09347                                 $annots .= <span class="stringliteral">&#39; /H /I&#39;</span>;
<a name="l09348"></a>09348                             }
<a name="l09349"></a>09349                             <span class="comment">//$annots .= &#39; /PA &#39;;</span>
<a name="l09350"></a>09350                             <span class="comment">//$annots .= &#39; /Quadpoints &#39;;</span>
<a name="l09351"></a>09351                             <span class="keywordflow">break</span>;
<a name="l09352"></a>09352                         }
<a name="l09353"></a>09353                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;freetext&#39;</span>: {
<a name="l09354"></a>09354                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>]) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>])) {
<a name="l09355"></a>09355                                 $annots .= <span class="stringliteral">&#39; /DA (&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>].<span class="charliteral">&#39;)&#39;</span>;
<a name="l09356"></a>09356                             }
<a name="l09357"></a>09357                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>] &gt;= 0) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>] &lt;= 2)) {
<a name="l09358"></a>09358                                 $annots .= <span class="stringliteral">&#39; /Q &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>]);
<a name="l09359"></a>09359                             }
<a name="l09360"></a>09360                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>])) {
<a name="l09361"></a>09361                                 $annots .= <span class="stringliteral">&#39; /RC &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>], $annot_obj_id);
<a name="l09362"></a>09362                             }
<a name="l09363"></a>09363                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ds&#39;</span>])) {
<a name="l09364"></a>09364                                 $annots .= <span class="stringliteral">&#39; /DS &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ds&#39;</span>], $annot_obj_id);
<a name="l09365"></a>09365                             }
<a name="l09366"></a>09366                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;cl&#39;</span>]) AND is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;cl&#39;</span>])) {
<a name="l09367"></a>09367                                 $annots .= <span class="stringliteral">&#39; /CL [&#39;</span>;
<a name="l09368"></a>09368                                 <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;cl&#39;</span>] as $cl) {
<a name="l09369"></a>09369                                     $annots .= sprintf(<span class="stringliteral">&#39;%.4F &#39;</span>, $cl * $this-&gt;k);
<a name="l09370"></a>09370                                 }
<a name="l09371"></a>09371                                 $annots .= <span class="charliteral">&#39;]&#39;</span>;
<a name="l09372"></a>09372                             }
<a name="l09373"></a>09373                             $tfit = array(<span class="stringliteral">&#39;FreeText&#39;</span>, <span class="stringliteral">&#39;FreeTextCallout&#39;</span>, <span class="stringliteral">&#39;FreeTextTypeWriter&#39;</span>);
<a name="l09374"></a>09374                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;it&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;it&#39;</span>], $tfit)) {
<a name="l09375"></a>09375                                 $annots .= <span class="stringliteral">&#39; /IT /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;it&#39;</span>];
<a name="l09376"></a>09376                             }
<a name="l09377"></a>09377                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>]) AND is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>])) {
<a name="l09378"></a>09378                                 <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a> = $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>][0] * $this-&gt;k;
<a name="l09379"></a>09379                                 <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>][1] * $this-&gt;k;
<a name="l09380"></a>09380                                 $t = $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>][2] * $this-&gt;k;
<a name="l09381"></a>09381                                 $b = $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>][3] * $this-&gt;k;
<a name="l09382"></a>09382                                 $annots .= <span class="stringliteral">&#39; /RD [&#39;</span>.sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F&#39;</span>, <a class="code" href="classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f" title="Language templates.">$l</a>, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $t, $b).<span class="charliteral">&#39;]&#39;</span>;
<a name="l09383"></a>09383                             }
<a name="l09384"></a>09384                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;le&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;le&#39;</span>], $lineendings)) {
<a name="l09385"></a>09385                                 $annots .= <span class="stringliteral">&#39; /LE /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;le&#39;</span>];
<a name="l09386"></a>09386                             }
<a name="l09387"></a>09387                             <span class="keywordflow">break</span>;
<a name="l09388"></a>09388                         }
<a name="l09389"></a>09389                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;line&#39;</span>: {
<a name="l09390"></a>09390                             <span class="keywordflow">break</span>;
<a name="l09391"></a>09391                         }
<a name="l09392"></a>09392                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;square&#39;</span>: {
<a name="l09393"></a>09393                             <span class="keywordflow">break</span>;
<a name="l09394"></a>09394                         }
<a name="l09395"></a>09395                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;circle&#39;</span>: {
<a name="l09396"></a>09396                             <span class="keywordflow">break</span>;
<a name="l09397"></a>09397                         }
<a name="l09398"></a>09398                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;polygon&#39;</span>: {
<a name="l09399"></a>09399                             <span class="keywordflow">break</span>;
<a name="l09400"></a>09400                         }
<a name="l09401"></a>09401                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;polyline&#39;</span>: {
<a name="l09402"></a>09402                             <span class="keywordflow">break</span>;
<a name="l09403"></a>09403                         }
<a name="l09404"></a>09404                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;highlight&#39;</span>: {
<a name="l09405"></a>09405                             <span class="keywordflow">break</span>;
<a name="l09406"></a>09406                         }
<a name="l09407"></a>09407                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;underline&#39;</span>: {
<a name="l09408"></a>09408                             <span class="keywordflow">break</span>;
<a name="l09409"></a>09409                         }
<a name="l09410"></a>09410                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;squiggly&#39;</span>: {
<a name="l09411"></a>09411                             <span class="keywordflow">break</span>;
<a name="l09412"></a>09412                         }
<a name="l09413"></a>09413                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;strikeout&#39;</span>: {
<a name="l09414"></a>09414                             <span class="keywordflow">break</span>;
<a name="l09415"></a>09415                         }
<a name="l09416"></a>09416                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;stamp&#39;</span>: {
<a name="l09417"></a>09417                             <span class="keywordflow">break</span>;
<a name="l09418"></a>09418                         }
<a name="l09419"></a>09419                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;caret&#39;</span>: {
<a name="l09420"></a>09420                             <span class="keywordflow">break</span>;
<a name="l09421"></a>09421                         }
<a name="l09422"></a>09422                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;ink&#39;</span>: {
<a name="l09423"></a>09423                             <span class="keywordflow">break</span>;
<a name="l09424"></a>09424                         }
<a name="l09425"></a>09425                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;popup&#39;</span>: {
<a name="l09426"></a>09426                             <span class="keywordflow">break</span>;
<a name="l09427"></a>09427                         }
<a name="l09428"></a>09428                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;fileattachment&#39;</span>: {
<a name="l09429"></a>09429                             <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l09430"></a>09430                                 <span class="comment">// embedded files are not allowed in PDF/A mode</span>
<a name="l09431"></a>09431                                 <span class="keywordflow">break</span>;
<a name="l09432"></a>09432                             }
<a name="l09433"></a>09433                             <span class="keywordflow">if</span> (!isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;fs&#39;</span>])) {
<a name="l09434"></a>09434                                 <span class="keywordflow">break</span>;
<a name="l09435"></a>09435                             }
<a name="l09436"></a>09436                             <a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a> = basename($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;fs&#39;</span>]);
<a name="l09437"></a>09437                             <span class="keywordflow">if</span> (isset($this-&gt;embeddedfiles[<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>][<span class="charliteral">&#39;n&#39;</span>])) {
<a name="l09438"></a>09438                                 $annots .= <span class="stringliteral">&#39; /FS &lt;&lt;/Type /Filespec /F &#39;</span>.$this-&gt;_datastring($filename, $annot_obj_id).<span class="stringliteral">&#39; /EF &lt;&lt;/F &#39;</span>.$this-&gt;embeddedfiles[<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&gt;&gt; &gt;&gt;&#39;</span>;
<a name="l09439"></a>09439                                 $iconsapp = array(<span class="stringliteral">&#39;Graph&#39;</span>, <span class="stringliteral">&#39;Paperclip&#39;</span>, <span class="stringliteral">&#39;PushPin&#39;</span>, <span class="stringliteral">&#39;Tag&#39;</span>);
<a name="l09440"></a>09440                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>], $iconsapp)) {
<a name="l09441"></a>09441                                     $annots .= <span class="stringliteral">&#39; /Name /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>];
<a name="l09442"></a>09442                                 } <span class="keywordflow">else</span> {
<a name="l09443"></a>09443                                     $annots .= <span class="stringliteral">&#39; /Name /PushPin&#39;</span>;
<a name="l09444"></a>09444                                 }
<a name="l09445"></a>09445                             }
<a name="l09446"></a>09446                             <span class="keywordflow">break</span>;
<a name="l09447"></a>09447                         }
<a name="l09448"></a>09448                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;sound&#39;</span>: {
<a name="l09449"></a>09449                             <span class="keywordflow">if</span> (!isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;fs&#39;</span>])) {
<a name="l09450"></a>09450                                 <span class="keywordflow">break</span>;
<a name="l09451"></a>09451                             }
<a name="l09452"></a>09452                             <a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a> = basename($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;fs&#39;</span>]);
<a name="l09453"></a>09453                             <span class="keywordflow">if</span> (isset($this-&gt;embeddedfiles[<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>][<span class="charliteral">&#39;n&#39;</span>])) {
<a name="l09454"></a>09454                                 <span class="comment">// ... TO BE COMPLETED ...</span>
<a name="l09455"></a>09455                                 <span class="comment">// /R /C /B /E /CO /CP</span>
<a name="l09456"></a>09456                                 $annots .= <span class="stringliteral">&#39; /Sound &lt;&lt;/Type /Filespec /F &#39;</span>.$this-&gt;_datastring($filename, $annot_obj_id).<span class="stringliteral">&#39; /EF &lt;&lt;/F &#39;</span>.$this-&gt;embeddedfiles[<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&gt;&gt; &gt;&gt;&#39;</span>;
<a name="l09457"></a>09457                                 $iconsapp = array(<span class="stringliteral">&#39;Speaker&#39;</span>, <span class="stringliteral">&#39;Mic&#39;</span>);
<a name="l09458"></a>09458                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>], $iconsapp)) {
<a name="l09459"></a>09459                                     $annots .= <span class="stringliteral">&#39; /Name /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>];
<a name="l09460"></a>09460                                 } <span class="keywordflow">else</span> {
<a name="l09461"></a>09461                                     $annots .= <span class="stringliteral">&#39; /Name /Speaker&#39;</span>;
<a name="l09462"></a>09462                                 }
<a name="l09463"></a>09463                             }
<a name="l09464"></a>09464                             <span class="keywordflow">break</span>;
<a name="l09465"></a>09465                         }
<a name="l09466"></a>09466                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;movie&#39;</span>: {
<a name="l09467"></a>09467                             <span class="keywordflow">break</span>;
<a name="l09468"></a>09468                         }
<a name="l09469"></a>09469                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;widget&#39;</span>: {
<a name="l09470"></a>09470                             $hmode = array(<span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;T&#39;</span>);
<a name="l09471"></a>09471                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>], $hmode)) {
<a name="l09472"></a>09472                                 $annots .= <span class="stringliteral">&#39; /H /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>];
<a name="l09473"></a>09473                             }
<a name="l09474"></a>09474                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>])) {
<a name="l09475"></a>09475                                 $annots .= <span class="stringliteral">&#39; /MK &lt;&lt;&#39;</span>;
<a name="l09476"></a>09476                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;r&#39;</span>])) {
<a name="l09477"></a>09477                                     $annots .= <span class="stringliteral">&#39; /R &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;r&#39;</span>];
<a name="l09478"></a>09478                                 }
<a name="l09479"></a>09479                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bc&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bc&#39;</span>]))) {
<a name="l09480"></a>09480                                     $annots .= <span class="stringliteral">&#39; /BC &#39;</span>.$this-&gt;getColorStringFromArray($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bc&#39;</span>]);
<a name="l09481"></a>09481                                 }
<a name="l09482"></a>09482                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bg&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bg&#39;</span>]))) {
<a name="l09483"></a>09483                                     $annots .= <span class="stringliteral">&#39; /BG &#39;</span>.$this-&gt;getColorStringFromArray($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bg&#39;</span>]);
<a name="l09484"></a>09484                                 }
<a name="l09485"></a>09485                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>])) {
<a name="l09486"></a>09486                                     $annots .= <span class="stringliteral">&#39; /CA &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>];
<a name="l09487"></a>09487                                 }
<a name="l09488"></a>09488                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>])) {
<a name="l09489"></a>09489                                     $annots .= <span class="stringliteral">&#39; /RC &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>];
<a name="l09490"></a>09490                                 }
<a name="l09491"></a>09491                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ac&#39;</span>])) {
<a name="l09492"></a>09492                                     $annots .= <span class="stringliteral">&#39; /AC &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ac&#39;</span>];
<a name="l09493"></a>09493                                 }
<a name="l09494"></a>09494                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>])) {
<a name="l09495"></a>09495                                     $info = $this-&gt;<a class="code" href="classTCPDF.html#a1a003edf69be144993c85c07a220315c" title="Get image buffer content.">getImageBuffer</a>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]);
<a name="l09496"></a>09496                                     <span class="keywordflow">if</span> ($info !== <span class="keyword">false</span>) {
<a name="l09497"></a>09497                                         $annots .= <span class="stringliteral">&#39; /I &#39;</span>.$info[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09498"></a>09498                                     }
<a name="l09499"></a>09499                                 }
<a name="l09500"></a>09500                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>])) {
<a name="l09501"></a>09501                                     $info = $this-&gt;<a class="code" href="classTCPDF.html#a1a003edf69be144993c85c07a220315c" title="Get image buffer content.">getImageBuffer</a>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>]);
<a name="l09502"></a>09502                                     <span class="keywordflow">if</span> ($info !== <span class="keyword">false</span>) {
<a name="l09503"></a>09503                                         $annots .= <span class="stringliteral">&#39; /RI &#39;</span>.$info[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09504"></a>09504                                     }
<a name="l09505"></a>09505                                 }
<a name="l09506"></a>09506                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>])) {
<a name="l09507"></a>09507                                     $info = $this-&gt;<a class="code" href="classTCPDF.html#a1a003edf69be144993c85c07a220315c" title="Get image buffer content.">getImageBuffer</a>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>]);
<a name="l09508"></a>09508                                     <span class="keywordflow">if</span> ($info !== <span class="keyword">false</span>) {
<a name="l09509"></a>09509                                         $annots .= <span class="stringliteral">&#39; /IX &#39;</span>.$info[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09510"></a>09510                                     }
<a name="l09511"></a>09511                                 }
<a name="l09512"></a>09512                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>])) {
<a name="l09513"></a>09513                                     $annots .= <span class="stringliteral">&#39; /IF &lt;&lt;&#39;</span>;
<a name="l09514"></a>09514                                     $if_sw = array(<span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;B&#39;</span>, <span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;N&#39;</span>);
<a name="l09515"></a>09515                                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>], $if_sw)) {
<a name="l09516"></a>09516                                         $annots .= <span class="stringliteral">&#39; /SW /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>];
<a name="l09517"></a>09517                                     }
<a name="l09518"></a>09518                                     $if_s = array(<span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;P&#39;</span>);
<a name="l09519"></a>09519                                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;s&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;s&#39;</span>], $if_s)) {
<a name="l09520"></a>09520                                         $annots .= <span class="stringliteral">&#39; /S /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;s&#39;</span>];
<a name="l09521"></a>09521                                     }
<a name="l09522"></a>09522                                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>])) {
<a name="l09523"></a>09523                                         $annots .= sprintf(<span class="stringliteral">&#39; /A [%.2F %.2F]&#39;</span>, $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>][0], $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>][1]);
<a name="l09524"></a>09524                                     }
<a name="l09525"></a>09525                                     <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;fb&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;fb&#39;</span>])) {
<a name="l09526"></a>09526                                         $annots .= <span class="stringliteral">&#39; /FB true&#39;</span>;
<a name="l09527"></a>09527                                     }
<a name="l09528"></a>09528                                     $annots .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l09529"></a>09529                                 }
<a name="l09530"></a>09530                                 <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] &gt;= 0) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] &lt;= 6)) {
<a name="l09531"></a>09531                                     $annots .= <span class="stringliteral">&#39; /TP &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>]);
<a name="l09532"></a>09532                                 }
<a name="l09533"></a>09533                                 $annots .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l09534"></a>09534                             } <span class="comment">// end MK</span>
<a name="l09535"></a>09535                             <span class="comment">// --- Entries for field dictionaries ---</span>
<a name="l09536"></a>09536                             <span class="keywordflow">if</span> (isset($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]])) {
<a name="l09537"></a>09537                                 <span class="comment">// set parent</span>
<a name="l09538"></a>09538                                 $annots .= <span class="stringliteral">&#39; /Parent &#39;</span>.$this-&gt;radiobutton_groups[<a class="code" href="classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09" title="Current object number.">$n</a>][$pl[<span class="stringliteral">&#39;txt&#39;</span>]].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l09539"></a>09539                             }
<a name="l09540"></a>09540                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>])) {
<a name="l09541"></a>09541                                 $annots .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_datastring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>], $annot_obj_id);
<a name="l09542"></a>09542                             }
<a name="l09543"></a>09543                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tu&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tu&#39;</span>])) {
<a name="l09544"></a>09544                                 $annots .= <span class="stringliteral">&#39; /TU &#39;</span>.$this-&gt;_datastring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tu&#39;</span>], $annot_obj_id);
<a name="l09545"></a>09545                             }
<a name="l09546"></a>09546                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tm&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tm&#39;</span>])) {
<a name="l09547"></a>09547                                 $annots .= <span class="stringliteral">&#39; /TM &#39;</span>.$this-&gt;_datastring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tm&#39;</span>], $annot_obj_id);
<a name="l09548"></a>09548                             }
<a name="l09549"></a>09549                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ff&#39;</span>])) {
<a name="l09550"></a>09550                                 <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ff&#39;</span>])) {
<a name="l09551"></a>09551                                     <span class="comment">// array of bit settings</span>
<a name="l09552"></a>09552                                     <a class="code" href="tbl__zoom__select_8php.html#acf5d6dd3ee125abb9a2523b30bc47d02">$flag</a> = 0;
<a name="l09553"></a>09553                                     <span class="keywordflow">foreach</span>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ff&#39;</span>] as $val) {
<a name="l09554"></a>09554                                         <a class="code" href="tbl__zoom__select_8php.html#acf5d6dd3ee125abb9a2523b30bc47d02">$flag</a> += 1 &lt;&lt; ($val - 1);
<a name="l09555"></a>09555                                     }
<a name="l09556"></a>09556                                 } <span class="keywordflow">else</span> {
<a name="l09557"></a>09557                                     <a class="code" href="tbl__zoom__select_8php.html#acf5d6dd3ee125abb9a2523b30bc47d02">$flag</a> = intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ff&#39;</span>]);
<a name="l09558"></a>09558                                 }
<a name="l09559"></a>09559                                 $annots .= <span class="stringliteral">&#39; /Ff &#39;</span>.$flag;
<a name="l09560"></a>09560                             }
<a name="l09561"></a>09561                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;maxlen&#39;</span>])) {
<a name="l09562"></a>09562                                 $annots .= <span class="stringliteral">&#39; /MaxLen &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;maxlen&#39;</span>]);
<a name="l09563"></a>09563                             }
<a name="l09564"></a>09564                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;v&#39;</span>])) {
<a name="l09565"></a>09565                                 $annots .= <span class="stringliteral">&#39; /V&#39;</span>;
<a name="l09566"></a>09566                                 <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;v&#39;</span>])) {
<a name="l09567"></a>09567                                     <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;v&#39;</span>] AS $optval) {
<a name="l09568"></a>09568                                         <span class="keywordflow">if</span> (is_float($optval)) {
<a name="l09569"></a>09569                                             $optval = sprintf(<span class="stringliteral">&#39;%.2F&#39;</span>, $optval);
<a name="l09570"></a>09570                                         }
<a name="l09571"></a>09571                                         $annots .= <span class="charliteral">&#39; &#39;</span>.$optval;
<a name="l09572"></a>09572                                     }
<a name="l09573"></a>09573                                 } <span class="keywordflow">else</span> {
<a name="l09574"></a>09574                                     $annots .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;v&#39;</span>], $annot_obj_id);
<a name="l09575"></a>09575                                 }
<a name="l09576"></a>09576                             }
<a name="l09577"></a>09577                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;dv&#39;</span>])) {
<a name="l09578"></a>09578                                 $annots .= <span class="stringliteral">&#39; /DV&#39;</span>;
<a name="l09579"></a>09579                                 <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;dv&#39;</span>])) {
<a name="l09580"></a>09580                                     <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;dv&#39;</span>] AS $optval) {
<a name="l09581"></a>09581                                         <span class="keywordflow">if</span> (is_float($optval)) {
<a name="l09582"></a>09582                                             $optval = sprintf(<span class="stringliteral">&#39;%.2F&#39;</span>, $optval);
<a name="l09583"></a>09583                                         }
<a name="l09584"></a>09584                                         $annots .= <span class="charliteral">&#39; &#39;</span>.$optval;
<a name="l09585"></a>09585                                     }
<a name="l09586"></a>09586                                 } <span class="keywordflow">else</span> {
<a name="l09587"></a>09587                                     $annots .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;dv&#39;</span>], $annot_obj_id);
<a name="l09588"></a>09588                                 }
<a name="l09589"></a>09589                             }
<a name="l09590"></a>09590                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rv&#39;</span>])) {
<a name="l09591"></a>09591                                 $annots .= <span class="stringliteral">&#39; /RV&#39;</span>;
<a name="l09592"></a>09592                                 <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rv&#39;</span>])) {
<a name="l09593"></a>09593                                     <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rv&#39;</span>] AS $optval) {
<a name="l09594"></a>09594                                         <span class="keywordflow">if</span> (is_float($optval)) {
<a name="l09595"></a>09595                                             $optval = sprintf(<span class="stringliteral">&#39;%.2F&#39;</span>, $optval);
<a name="l09596"></a>09596                                         }
<a name="l09597"></a>09597                                         $annots .= <span class="charliteral">&#39; &#39;</span>.$optval;
<a name="l09598"></a>09598                                     }
<a name="l09599"></a>09599                                 } <span class="keywordflow">else</span> {
<a name="l09600"></a>09600                                     $annots .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rv&#39;</span>], $annot_obj_id);
<a name="l09601"></a>09601                                 }
<a name="l09602"></a>09602                             }
<a name="l09603"></a>09603                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;a&#39;</span>]) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;a&#39;</span>])) {
<a name="l09604"></a>09604                                 $annots .= <span class="stringliteral">&#39; /A &lt;&lt; &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;a&#39;</span>].<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l09605"></a>09605                             }
<a name="l09606"></a>09606                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;aa&#39;</span>]) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;aa&#39;</span>])) {
<a name="l09607"></a>09607                                 $annots .= <span class="stringliteral">&#39; /AA &lt;&lt; &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;aa&#39;</span>].<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l09608"></a>09608                             }
<a name="l09609"></a>09609                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>]) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>])) {
<a name="l09610"></a>09610                                 $annots .= <span class="stringliteral">&#39; /DA (&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>].<span class="charliteral">&#39;)&#39;</span>;
<a name="l09611"></a>09611                             }
<a name="l09612"></a>09612                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>] &gt;= 0) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>] &lt;= 2)) {
<a name="l09613"></a>09613                                 $annots .= <span class="stringliteral">&#39; /Q &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>]);
<a name="l09614"></a>09614                             }
<a name="l09615"></a>09615                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;opt&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;opt&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;opt&#39;</span>])) {
<a name="l09616"></a>09616                                 $annots .= <span class="stringliteral">&#39; /Opt [&#39;</span>;
<a name="l09617"></a>09617                                 <span class="keywordflow">foreach</span>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;opt&#39;</span>] AS $copt) {
<a name="l09618"></a>09618                                     <span class="keywordflow">if</span> (is_array($copt)) {
<a name="l09619"></a>09619                                         $annots .= <span class="stringliteral">&#39; [&#39;</span>.$this-&gt;_textstring($copt[0], $annot_obj_id).<span class="charliteral">&#39; &#39;</span>.$this-&gt;<a class="code" href="classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81" title="Format a text string for meta information.">_textstring</a>($copt[1], $annot_obj_id).<span class="charliteral">&#39;]&#39;</span>;
<a name="l09620"></a>09620                                     } <span class="keywordflow">else</span> {
<a name="l09621"></a>09621                                         $annots .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_textstring($copt, $annot_obj_id);
<a name="l09622"></a>09622                                     }
<a name="l09623"></a>09623                                 }
<a name="l09624"></a>09624                                 $annots .= <span class="charliteral">&#39;]&#39;</span>;
<a name="l09625"></a>09625                             }
<a name="l09626"></a>09626                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ti&#39;</span>])) {
<a name="l09627"></a>09627                                 $annots .= <span class="stringliteral">&#39; /TI &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ti&#39;</span>]);
<a name="l09628"></a>09628                             }
<a name="l09629"></a>09629                             <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;i&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;i&#39;</span>])) {
<a name="l09630"></a>09630                                 $annots .= <span class="stringliteral">&#39; /I [&#39;</span>;
<a name="l09631"></a>09631                                 <span class="keywordflow">foreach</span>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;i&#39;</span>] AS $copt) {
<a name="l09632"></a>09632                                     $annots .= intval($copt).<span class="charliteral">&#39; &#39;</span>;
<a name="l09633"></a>09633                                 }
<a name="l09634"></a>09634                                 $annots .= <span class="charliteral">&#39;]&#39;</span>;
<a name="l09635"></a>09635                             }
<a name="l09636"></a>09636                             <span class="keywordflow">break</span>;
<a name="l09637"></a>09637                         }
<a name="l09638"></a>09638                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;screen&#39;</span>: {
<a name="l09639"></a>09639                             <span class="keywordflow">break</span>;
<a name="l09640"></a>09640                         }
<a name="l09641"></a>09641                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;printermark&#39;</span>: {
<a name="l09642"></a>09642                             <span class="keywordflow">break</span>;
<a name="l09643"></a>09643                         }
<a name="l09644"></a>09644                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;trapnet&#39;</span>: {
<a name="l09645"></a>09645                             <span class="keywordflow">break</span>;
<a name="l09646"></a>09646                         }
<a name="l09647"></a>09647                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;watermark&#39;</span>: {
<a name="l09648"></a>09648                             <span class="keywordflow">break</span>;
<a name="l09649"></a>09649                         }
<a name="l09650"></a>09650                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;3d&#39;</span>: {
<a name="l09651"></a>09651                             <span class="keywordflow">break</span>;
<a name="l09652"></a>09652                         }
<a name="l09653"></a>09653                         <span class="keywordflow">default</span>: {
<a name="l09654"></a>09654                             <span class="keywordflow">break</span>;
<a name="l09655"></a>09655                         }
<a name="l09656"></a>09656                     }
<a name="l09657"></a>09657                     $annots .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l09658"></a>09658                     <span class="comment">// create new annotation object</span>
<a name="l09659"></a>09659                     $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>($this-&gt;<a class="code" href="classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1" title="Return the starting object string for the selected object ID.">_getobj</a>($annot_obj_id).<span class="stringliteral">&quot;\n&quot;</span>.$annots.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);
<a name="l09660"></a>09660                     <span class="keywordflow">if</span> ($formfield AND !isset($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]])) {
<a name="l09661"></a>09661                         <span class="comment">// store reference of form object</span>
<a name="l09662"></a>09662                         $this-&gt;form_obj_id[] = $annot_obj_id;
<a name="l09663"></a>09663                     }
<a name="l09664"></a>09664                 }
<a name="l09665"></a>09665             }
<a name="l09666"></a>09666         } <span class="comment">// end for each page</span>
<a name="l09667"></a>09667     }
<a name="l09668"></a>09668 <span class="comment"></span>
<a name="l09669"></a>09669 <span class="comment">    /**</span>
<a name="l09670"></a>09670 <span class="comment">     * Put appearance streams XObject used to define annotation&#39;s appearance states.</span>
<a name="l09671"></a>09671 <span class="comment">     * @param $w (int) annotation width</span>
<a name="l09672"></a>09672 <span class="comment">     * @param $h (int) annotation height</span>
<a name="l09673"></a>09673 <span class="comment">     * @param $stream (string) appearance stream</span>
<a name="l09674"></a>09674 <span class="comment">     * @return int object ID</span>
<a name="l09675"></a>09675 <span class="comment">     * @protected</span>
<a name="l09676"></a>09676 <span class="comment">     * @since 4.8.001 (2009-09-09)</span>
<a name="l09677"></a>09677 <span class="comment">     */</span>
<a name="l09678"></a><a class="code" href="classTCPDF.html#a4235ea24726644eb13d82a2ebe8ee882">09678</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4235ea24726644eb13d82a2ebe8ee882" title="Put appearance streams XObject used to define annotation&#39;s appearance states.">_putAPXObject</a>(<a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>=0, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>=0, $stream=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l09679"></a>09679         $stream = trim($stream);
<a name="l09680"></a>09680         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;<a class="code" href="classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1" title="Return the starting object string for the selected object ID.">_getobj</a>().<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l09681"></a>09681         $this-&gt;xobjects[<span class="stringliteral">&#39;AX&#39;</span>.$this-&gt;n] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n);
<a name="l09682"></a>09682         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l09683"></a>09683         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Type /XObject&#39;</span>;
<a name="l09684"></a>09684         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /Form&#39;</span>;
<a name="l09685"></a>09685         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FormType 1&#39;</span>;
<a name="l09686"></a>09686         <span class="keywordflow">if</span> ($this-&gt;compress) {
<a name="l09687"></a>09687             $stream = gzcompress($stream);
<a name="l09688"></a>09688             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;
<a name="l09689"></a>09689         }
<a name="l09690"></a>09690         $rect = sprintf(<span class="stringliteral">&#39;%.2F %.2F&#39;</span>, <a class="code" href="classTCPDF.html#a7a008584775e8222aa88781cb677c514" title="Current width of page in user unit.">$w</a>, <a class="code" href="classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0" title="Current height of page in user unit.">$h</a>);
<a name="l09691"></a>09691         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BBox [0 0 &#39;</span>.$rect.<span class="charliteral">&#39;]&#39;</span>;
<a name="l09692"></a>09692         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Matrix [1 0 0 1 0 0]&#39;</span>;
<a name="l09693"></a>09693         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Resources 2 0 R&#39;</span>;
<a name="l09694"></a>09694         $stream = $this-&gt;<a class="code" href="classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb" title="get raw output stream.">_getrawstream</a>($stream);
<a name="l09695"></a>09695         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream);
<a name="l09696"></a>09696         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l09697"></a>09697         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l09698"></a>09698         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l09699"></a>09699         $this-&gt;<a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l09700"></a>09700         <span class="keywordflow">return</span> $this-&gt;n;
<a name="l09701"></a>09701     }
<a name="l09702"></a>09702 <span class="comment"></span>
<a name="l09703"></a>09703 <span class="comment">    /**</span>
<a name="l09704"></a>09704 <span class="comment">     * Get ULONG from string (Big Endian 32-bit unsigned integer).</span>
<a name="l09705"></a>09705 <span class="comment">     * @param $str (string) string from where to extract value</span>
<a name="l09706"></a>09706 <span class="comment">     * @param $offset (int) point from where to read the data</span>
<a name="l09707"></a>09707 <span class="comment">     * @return int 32 bit value</span>
<a name="l09708"></a>09708 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09709"></a>09709 <span class="comment">     * @protected</span>
<a name="l09710"></a>09710 <span class="comment">     * @since 5.2.000 (2010-06-02)</span>
<a name="l09711"></a>09711 <span class="comment">     */</span>
<a name="l09712"></a><a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3">09712</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) {
<a name="l09713"></a>09713         $v = unpack(<span class="stringliteral">&#39;Ni&#39;</span>, substr($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, 4));
<a name="l09714"></a>09714         <span class="keywordflow">return</span> $v[<span class="charliteral">&#39;i&#39;</span>];
<a name="l09715"></a>09715     }
<a name="l09716"></a>09716 <span class="comment"></span>
<a name="l09717"></a>09717 <span class="comment">    /**</span>
<a name="l09718"></a>09718 <span class="comment">     * Get USHORT from string (Big Endian 16-bit unsigned integer).</span>
<a name="l09719"></a>09719 <span class="comment">     * @param $str (string) string from where to extract value</span>
<a name="l09720"></a>09720 <span class="comment">     * @param $offset (int) point from where to read the data</span>
<a name="l09721"></a>09721 <span class="comment">     * @return int 16 bit value</span>
<a name="l09722"></a>09722 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09723"></a>09723 <span class="comment">     * @protected</span>
<a name="l09724"></a>09724 <span class="comment">     * @since 5.2.000 (2010-06-02)</span>
<a name="l09725"></a>09725 <span class="comment">     */</span>
<a name="l09726"></a><a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f">09726</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) {
<a name="l09727"></a>09727         $v = unpack(<span class="stringliteral">&#39;ni&#39;</span>, substr($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, 2));
<a name="l09728"></a>09728         <span class="keywordflow">return</span> $v[<span class="charliteral">&#39;i&#39;</span>];
<a name="l09729"></a>09729     }
<a name="l09730"></a>09730 <span class="comment"></span>
<a name="l09731"></a>09731 <span class="comment">    /**</span>
<a name="l09732"></a>09732 <span class="comment">     * Get SHORT from string (Big Endian 16-bit signed integer).</span>
<a name="l09733"></a>09733 <span class="comment">     * @param $str (string) string from where to extract value</span>
<a name="l09734"></a>09734 <span class="comment">     * @param $offset (int) point from where to read the data</span>
<a name="l09735"></a>09735 <span class="comment">     * @return int 16 bit value</span>
<a name="l09736"></a>09736 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09737"></a>09737 <span class="comment">     * @protected</span>
<a name="l09738"></a>09738 <span class="comment">     * @since 5.2.000 (2010-06-02)</span>
<a name="l09739"></a>09739 <span class="comment">     */</span>
<a name="l09740"></a><a class="code" href="classTCPDF.html#aa9c624edd1ea5063cb13468139e12d91">09740</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa9c624edd1ea5063cb13468139e12d91" title="Get SHORT from string (Big Endian 16-bit signed integer).">_getSHORT</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) {
<a name="l09741"></a>09741         $v = unpack(<span class="stringliteral">&#39;si&#39;</span>, substr($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, 2));
<a name="l09742"></a>09742         <span class="keywordflow">return</span> $v[<span class="charliteral">&#39;i&#39;</span>];
<a name="l09743"></a>09743     }
<a name="l09744"></a>09744 <span class="comment"></span>
<a name="l09745"></a>09745 <span class="comment">    /**</span>
<a name="l09746"></a>09746 <span class="comment">     * Get FWORD from string (Big Endian 16-bit signed integer).</span>
<a name="l09747"></a>09747 <span class="comment">     * @param $str (string) string from where to extract value</span>
<a name="l09748"></a>09748 <span class="comment">     * @param $offset (int) point from where to read the data</span>
<a name="l09749"></a>09749 <span class="comment">     * @return int 16 bit value</span>
<a name="l09750"></a>09750 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09751"></a>09751 <span class="comment">     * @protected</span>
<a name="l09752"></a>09752 <span class="comment">     * @since 5.9.123 (2011-09-30)</span>
<a name="l09753"></a>09753 <span class="comment">     */</span>
<a name="l09754"></a><a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568">09754</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) {
<a name="l09755"></a>09755         $v = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l09756"></a>09756         <span class="keywordflow">if</span> ($v &gt; 0x7fff) {
<a name="l09757"></a>09757             $v -= 0x10000;
<a name="l09758"></a>09758         }
<a name="l09759"></a>09759         <span class="keywordflow">return</span> $v;
<a name="l09760"></a>09760     }
<a name="l09761"></a>09761 <span class="comment"></span>
<a name="l09762"></a>09762 <span class="comment">    /**</span>
<a name="l09763"></a>09763 <span class="comment">     * Get UFWORD from string (Big Endian 16-bit unsigned integer).</span>
<a name="l09764"></a>09764 <span class="comment">     * @param $str (string) string from where to extract value</span>
<a name="l09765"></a>09765 <span class="comment">     * @param $offset (int) point from where to read the data</span>
<a name="l09766"></a>09766 <span class="comment">     * @return int 16 bit value</span>
<a name="l09767"></a>09767 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09768"></a>09768 <span class="comment">     * @protected</span>
<a name="l09769"></a>09769 <span class="comment">     * @since 5.9.123 (2011-09-30)</span>
<a name="l09770"></a>09770 <span class="comment">     */</span>
<a name="l09771"></a><a class="code" href="classTCPDF.html#a39b4ff7e526b30437ff704526801809c">09771</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a39b4ff7e526b30437ff704526801809c" title="Get UFWORD from string (Big Endian 16-bit unsigned integer).">_getUFWORD</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) {
<a name="l09772"></a>09772         $v = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l09773"></a>09773         <span class="keywordflow">return</span> $v;
<a name="l09774"></a>09774     }
<a name="l09775"></a>09775 <span class="comment"></span>
<a name="l09776"></a>09776 <span class="comment">    /**</span>
<a name="l09777"></a>09777 <span class="comment">     * Get FIXED from string (32-bit signed fixed-point number (16.16).</span>
<a name="l09778"></a>09778 <span class="comment">     * @param $str (string) string from where to extract value</span>
<a name="l09779"></a>09779 <span class="comment">     * @param $offset (int) point from where to read the data</span>
<a name="l09780"></a>09780 <span class="comment">     * @return int 16 bit value</span>
<a name="l09781"></a>09781 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09782"></a>09782 <span class="comment">     * @protected</span>
<a name="l09783"></a>09783 <span class="comment">     * @since 5.9.123 (2011-09-30)</span>
<a name="l09784"></a>09784 <span class="comment">     */</span>
<a name="l09785"></a><a class="code" href="classTCPDF.html#a0bf637e15b9d3f0e3f090e826fed9224">09785</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0bf637e15b9d3f0e3f090e826fed9224" title="Get FIXED from string (32-bit signed fixed-point number (16.16).">_getFIXED</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) {
<a name="l09786"></a>09786         <span class="comment">// mantissa</span>
<a name="l09787"></a>09787         <a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a> = $this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l09788"></a>09788         <span class="comment">// fraction</span>
<a name="l09789"></a>09789         <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>($str, (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> + 2));
<a name="l09790"></a>09790         $v = floatval(<span class="stringliteral">&#39;&#39;</span>.<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>.<span class="charliteral">&#39;.&#39;</span>.<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>.<span class="stringliteral">&#39;&#39;</span>);
<a name="l09791"></a>09791         <span class="keywordflow">return</span> $v;
<a name="l09792"></a>09792     }
<a name="l09793"></a>09793 <span class="comment"></span>
<a name="l09794"></a>09794 <span class="comment">    /**</span>
<a name="l09795"></a>09795 <span class="comment">     * Get BYTE from string (8-bit unsigned integer).</span>
<a name="l09796"></a>09796 <span class="comment">     * @param $str (string) String from where to extract value.</span>
<a name="l09797"></a>09797 <span class="comment">     * @param $offset (int) Point from where to read the data.</span>
<a name="l09798"></a>09798 <span class="comment">     * @return int 8 bit value</span>
<a name="l09799"></a>09799 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09800"></a>09800 <span class="comment">     * @protected</span>
<a name="l09801"></a>09801 <span class="comment">     * @since 5.2.000 (2010-06-02)</span>
<a name="l09802"></a>09802 <span class="comment">     */</span>
<a name="l09803"></a><a class="code" href="classTCPDF.html#aa5f2d012801e75c7f416ac12c6e5ffa9">09803</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa5f2d012801e75c7f416ac12c6e5ffa9" title="Get BYTE from string (8-bit unsigned integer).">_getBYTE</a>($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) {
<a name="l09804"></a>09804         $v = unpack(<span class="stringliteral">&#39;Ci&#39;</span>, substr($str, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, 1));
<a name="l09805"></a>09805         <span class="keywordflow">return</span> $v[<span class="charliteral">&#39;i&#39;</span>];
<a name="l09806"></a>09806     }<span class="comment"></span>
<a name="l09807"></a>09807 <span class="comment">    /**</span>
<a name="l09808"></a>09808 <span class="comment">     * Update the CIDToGIDMap string with a new value.</span>
<a name="l09809"></a>09809 <span class="comment">     * @param $map (string) CIDToGIDMap.</span>
<a name="l09810"></a>09810 <span class="comment">     * @param $cid (int) CID value.</span>
<a name="l09811"></a>09811 <span class="comment">     * @param $gid (int) GID value.</span>
<a name="l09812"></a>09812 <span class="comment">     * @return (string) CIDToGIDMap.</span>
<a name="l09813"></a>09813 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09814"></a>09814 <span class="comment">     * @protected</span>
<a name="l09815"></a>09815 <span class="comment">     * @since 5.9.123 (2011-09-29)</span>
<a name="l09816"></a>09816 <span class="comment">     */</span>
<a name="l09817"></a><a class="code" href="classTCPDF.html#aaae599d8406ab1a72d98d70fb963eeea">09817</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aaae599d8406ab1a72d98d70fb963eeea" title="Update the CIDToGIDMap string with a new value.">updateCIDtoGIDmap</a>($map, $cid, $gid) {
<a name="l09818"></a>09818         <span class="keywordflow">if</span> (($cid &gt;= 0) AND ($cid &lt;= 0xFFFF) AND ($gid &gt;= 0)) {
<a name="l09819"></a>09819             <span class="keywordflow">if</span> ($gid &gt; 0xFFFF) {
<a name="l09820"></a>09820                 $gid -= 0x10000;
<a name="l09821"></a>09821             }
<a name="l09822"></a>09822             $map[($cid * 2)] = chr($gid &gt;&gt; 8);
<a name="l09823"></a>09823             $map[(($cid * 2) + 1)] = chr($gid &amp; 0xFF);
<a name="l09824"></a>09824         }
<a name="l09825"></a>09825         <span class="keywordflow">return</span> $map;
<a name="l09826"></a>09826     }
<a name="l09827"></a>09827 <span class="comment"></span>
<a name="l09828"></a>09828 <span class="comment">    /**</span>
<a name="l09829"></a>09829 <span class="comment">     * Convert and add the selected TrueType or Type1 font to the fonts folder (that must be writeable).</span>
<a name="l09830"></a>09830 <span class="comment">     * @param $fontfile (string) TrueType or Type1 font file (full path).</span>
<a name="l09831"></a>09831 <span class="comment">     * @param $fonttype (string) Font type. Leave empty for autodetect mode. Valid values are: TrueTypeUnicode, TrueType, Type1, CID0JP = CID-0 Japanese, CID0KR = CID-0 Korean, CID0CS = CID-0 Chinese Simplified, CID0CT = CID-0 Chinese Traditional.</span>
<a name="l09832"></a>09832 <span class="comment">     * @param $enc (string) Name of the encoding table to use. Leave empty for default mode. Omit this parameter for TrueType Unicode and symbolic fonts like Symbol or ZapfDingBats.</span>
<a name="l09833"></a>09833 <span class="comment">     * @param $flags (int) Unsigned 32-bit integer containing flags specifying various characteristics of the font (PDF32000:2008 - 9.8.2 Font Descriptor Flags): +1 for fixed font; +4 for symbol or +32 for non-symbol; +64 for italic. Fixed and Italic mode are generally autodetected so you have to set it to 32 = non-symbolic font (default) or 4 = symbolic font.</span>
<a name="l09834"></a>09834 <span class="comment">     * @param $outpath (string) Output path for generated font files (must be writeable by the web server). Leave empty for default font folder.</span>
<a name="l09835"></a>09835 <span class="comment">     * @return (string) TCPDF font name.</span>
<a name="l09836"></a>09836 <span class="comment">     * @author Nicola Asuni</span>
<a name="l09837"></a>09837 <span class="comment">     * @public</span>
<a name="l09838"></a>09838 <span class="comment">     * @since 5.9.123 (2010-09-30)</span>
<a name="l09839"></a>09839 <span class="comment">     */</span>
<a name="l09840"></a><a class="code" href="classTCPDF.html#a6dbd62a9d9d1bb54eed883ba0005ee6f">09840</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6dbd62a9d9d1bb54eed883ba0005ee6f" title="Convert and add the selected TrueType or Type1 font to the fonts folder (that must be writeable)...">addTTFfont</a>($fontfile, $fonttype=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>=<span class="stringliteral">&#39;&#39;</span>, $flags=32, $outpath=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l09841"></a>09841         <span class="keywordflow">if</span> (!file_exists($fontfile)) {
<a name="l09842"></a>09842             $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Could not find file: &#39;</span>.$fontfile.<span class="stringliteral">&#39;&#39;</span>);
<a name="l09843"></a>09843         }
<a name="l09844"></a>09844         <span class="comment">// font metrics</span>
<a name="l09845"></a>09845         $fmetric = array();
<a name="l09846"></a>09846         <span class="comment">// build new font name for TCPDF compatibility</span>
<a name="l09847"></a>09847         $font_path_parts = pathinfo($fontfile);
<a name="l09848"></a>09848         <span class="keywordflow">if</span> (!isset($font_path_parts[<span class="stringliteral">&#39;filename&#39;</span>])) {
<a name="l09849"></a>09849             $font_path_parts[<span class="stringliteral">&#39;filename&#39;</span>] = substr($font_path_parts[<span class="stringliteral">&#39;basename&#39;</span>], 0, -(strlen($font_path_parts[<span class="stringliteral">&#39;extension&#39;</span>]) + 1));
<a name="l09850"></a>09850         }
<a name="l09851"></a>09851         $font_name = strtolower($font_path_parts[<span class="stringliteral">&#39;filename&#39;</span>]);
<a name="l09852"></a>09852         $font_name = preg_replace(<span class="stringliteral">&#39;/[^a-z0-9_]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $font_name);
<a name="l09853"></a>09853         $search  = array(<span class="stringliteral">&#39;bold&#39;</span>, <span class="stringliteral">&#39;oblique&#39;</span>, <span class="stringliteral">&#39;italic&#39;</span>, <span class="stringliteral">&#39;regular&#39;</span>);
<a name="l09854"></a>09854         $replace = array(<span class="charliteral">&#39;b&#39;</span>, <span class="charliteral">&#39;i&#39;</span>, <span class="charliteral">&#39;i&#39;</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l09855"></a>09855         $font_name = str_replace($search, $replace, $font_name);
<a name="l09856"></a>09856         <span class="keywordflow">if</span> (empty($font_name)) {
<a name="l09857"></a>09857             <span class="comment">// set generic name</span>
<a name="l09858"></a>09858             $font_name = <span class="stringliteral">&#39;tcpdffont&#39;</span>;
<a name="l09859"></a>09859         }
<a name="l09860"></a>09860         <span class="comment">// set output path</span>
<a name="l09861"></a>09861         <span class="keywordflow">if</span> (empty($outpath)) {
<a name="l09862"></a>09862             $outpath = $this-&gt;<a class="code" href="classTCPDF.html#a859c9ff83c417b518afa83c0da7a62b1" title="Return fonts path.">_getfontpath</a>();
<a name="l09863"></a>09863         }
<a name="l09864"></a>09864         <span class="comment">// check if this font already exist</span>
<a name="l09865"></a>09865         <span class="keywordflow">if</span> (file_exists($outpath.$font_name.<span class="stringliteral">&#39;.php&#39;</span>)) {
<a name="l09866"></a>09866             <span class="comment">// this font already exist (delete it from fonts folder to rebuild it)</span>
<a name="l09867"></a>09867             <span class="keywordflow">return</span> $font_name;
<a name="l09868"></a>09868         }
<a name="l09869"></a>09869         $fmetric[<span class="stringliteral">&#39;file&#39;</span>] = $font_name.<span class="stringliteral">&#39;.z&#39;</span>;
<a name="l09870"></a>09870         $fmetric[<span class="stringliteral">&#39;ctg&#39;</span>] = $font_name.<span class="stringliteral">&#39;.ctg.z&#39;</span>;
<a name="l09871"></a>09871         <span class="comment">// get font data</span>
<a name="l09872"></a>09872         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = file_get_contents($fontfile);
<a name="l09873"></a>09873         $fmetric[<span class="stringliteral">&#39;originalsize&#39;</span>] = strlen(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>);
<a name="l09874"></a>09874         <span class="comment">// autodetect font type</span>
<a name="l09875"></a>09875         <span class="keywordflow">if</span> (empty($fonttype)) {
<a name="l09876"></a>09876             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, 0) == 0x10000) {
<a name="l09877"></a>09877                 <span class="comment">// True Type (Unicode or not)</span>
<a name="l09878"></a>09878                 $fonttype = <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>;
<a name="l09879"></a>09879             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, 0, 4) == <span class="stringliteral">&#39;OTTO&#39;</span>) {
<a name="l09880"></a>09880                 <span class="comment">// Open Type (Unicode or not)</span>
<a name="l09881"></a>09881                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Unsupported font format: OpenType with CFF data.&#39;</span>);
<a name="l09882"></a>09882             } <span class="keywordflow">else</span> {
<a name="l09883"></a>09883                 <span class="comment">// Type 1</span>
<a name="l09884"></a>09884                 $fonttype = <span class="stringliteral">&#39;Type1&#39;</span>;
<a name="l09885"></a>09885             }
<a name="l09886"></a>09886         }
<a name="l09887"></a>09887         <span class="comment">// set font type</span>
<a name="l09888"></a>09888         <span class="keywordflow">switch</span> ($fonttype) {
<a name="l09889"></a>09889             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CID0CT&#39;</span>:
<a name="l09890"></a>09890             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CID0CS&#39;</span>:
<a name="l09891"></a>09891             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CID0KR&#39;</span>:
<a name="l09892"></a>09892             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CID0JP&#39;</span>: {
<a name="l09893"></a>09893                 $fmetric[<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;cidfont0&#39;</span>;
<a name="l09894"></a>09894                 <span class="keywordflow">break</span>;
<a name="l09895"></a>09895             }
<a name="l09896"></a>09896             <span class="keywordflow">case</span> <span class="stringliteral">&#39;Type1&#39;</span>: {
<a name="l09897"></a>09897                 $fmetric[<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;Type1&#39;</span>;
<a name="l09898"></a>09898                 <span class="keywordflow">if</span> (empty(<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>) AND (($flags &amp; 4) == 0)) {
<a name="l09899"></a>09899                     <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> = <span class="stringliteral">&#39;cp1252&#39;</span>;
<a name="l09900"></a>09900                 }
<a name="l09901"></a>09901                 <span class="keywordflow">break</span>;
<a name="l09902"></a>09902             }
<a name="l09903"></a>09903             <span class="keywordflow">case</span> <span class="stringliteral">&#39;TrueType&#39;</span>: {
<a name="l09904"></a>09904                 $fmetric[<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;TrueType&#39;</span>;
<a name="l09905"></a>09905                 <span class="keywordflow">break</span>;
<a name="l09906"></a>09906             }
<a name="l09907"></a>09907             <span class="keywordflow">case</span> <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>:
<a name="l09908"></a>09908             <span class="keywordflow">default</span>: {
<a name="l09909"></a>09909                 $fmetric[<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>;
<a name="l09910"></a>09910                 <span class="keywordflow">break</span>;
<a name="l09911"></a>09911             }
<a name="l09912"></a>09912         }
<a name="l09913"></a>09913         <span class="comment">// set encoding maps (if any)</span>
<a name="l09914"></a>09914         $fmetric[<span class="stringliteral">&#39;enc&#39;</span>] = preg_replace(<span class="stringliteral">&#39;/[^A-Za-z0-9_\-]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>);
<a name="l09915"></a>09915         $fmetric[<span class="stringliteral">&#39;diff&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l09916"></a>09916         <span class="keywordflow">if</span> (($fmetric[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;TrueType&#39;</span>) OR ($fmetric[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;Type1&#39;</span>)) {
<a name="l09917"></a>09917             <span class="keywordflow">if</span> (!empty(<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>) AND (<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> != <span class="stringliteral">&#39;cp1252&#39;</span>) AND isset($this-&gt;encmaps-&gt;encmap[<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>])) {
<a name="l09918"></a>09918                 <span class="comment">// build differences from reference encoding</span>
<a name="l09919"></a>09919                 $enc_ref = $this-&gt;encmaps-&gt;encmap[<span class="stringliteral">&#39;cp1252&#39;</span>];
<a name="l09920"></a>09920                 $enc_target = $this-&gt;encmaps-&gt;encmap[<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>];
<a name="l09921"></a>09921                 $last = 0;
<a name="l09922"></a>09922                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 32; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;= 255; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l09923"></a>09923                     <span class="keywordflow">if</span> ($enc_target != $enc_ref[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) {
<a name="l09924"></a>09924                         <span class="keywordflow">if</span> ($i != ($last + 1)) {
<a name="l09925"></a>09925                             $fmetric[<span class="stringliteral">&#39;diff&#39;</span>] .= $i.<span class="charliteral">&#39; &#39;</span>;
<a name="l09926"></a>09926                         }
<a name="l09927"></a>09927                         $last = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l09928"></a>09928                         $fmetric[<span class="stringliteral">&#39;diff&#39;</span>] .= <span class="charliteral">&#39;/&#39;</span>.$enc_target[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>].<span class="charliteral">&#39; &#39;</span>;
<a name="l09929"></a>09929                     }
<a name="l09930"></a>09930                 }
<a name="l09931"></a>09931             }
<a name="l09932"></a>09932         }
<a name="l09933"></a>09933         <span class="comment">// parse the font by type</span>
<a name="l09934"></a>09934         <span class="keywordflow">if</span> ($fmetric[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;Type1&#39;</span>) {
<a name="l09935"></a>09935             <span class="comment">// ---------- TYPE 1 ----------</span>
<a name="l09936"></a>09936             <span class="comment">// read first segment</span>
<a name="l09937"></a>09937             $a = unpack(<span class="stringliteral">&#39;Cmarker/Ctype/Vsize&#39;</span>, substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, 0, 6));
<a name="l09938"></a>09938             <span class="keywordflow">if</span> ($a[<span class="stringliteral">&#39;marker&#39;</span>] != 128) {
<a name="l09939"></a>09939                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Font file is not a valid binary Type1&#39;</span>);
<a name="l09940"></a>09940             }
<a name="l09941"></a>09941             $fmetric[<span class="stringliteral">&#39;size1&#39;</span>] = $a[<span class="stringliteral">&#39;size&#39;</span>];
<a name="l09942"></a>09942             <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, 6, $fmetric[<span class="stringliteral">&#39;size1&#39;</span>]);
<a name="l09943"></a>09943             <span class="comment">// read second segment</span>
<a name="l09944"></a>09944             $a = unpack(<span class="stringliteral">&#39;Cmarker/Ctype/Vsize&#39;</span>, substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, (6 + $fmetric[<span class="stringliteral">&#39;size1&#39;</span>]), 6));
<a name="l09945"></a>09945             <span class="keywordflow">if</span> ($a[<span class="stringliteral">&#39;marker&#39;</span>] != 128) {
<a name="l09946"></a>09946                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;Font file is not a valid binary Type1&#39;</span>);
<a name="l09947"></a>09947             }
<a name="l09948"></a>09948             $fmetric[<span class="stringliteral">&#39;size2&#39;</span>] = $a[<span class="stringliteral">&#39;size&#39;</span>];
<a name="l09949"></a>09949             <a class="code" href="classTCPDF.html#affd380e0adfc726dbc519860de0b175c" title="IBoolean flag indicating whether document is protected.">$encrypted</a> = substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, (12 + $fmetric[<span class="stringliteral">&#39;size1&#39;</span>]), $fmetric[<span class="stringliteral">&#39;size2&#39;</span>]);
<a name="l09950"></a>09950             <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> .= <a class="code" href="classTCPDF.html#affd380e0adfc726dbc519860de0b175c" title="IBoolean flag indicating whether document is protected.">$encrypted</a>;
<a name="l09951"></a>09951             <span class="comment">// store compressed font</span>
<a name="l09952"></a>09952             <a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a> = fopen($outpath.$fmetric[<span class="stringliteral">&#39;file&#39;</span>], <span class="stringliteral">&#39;wb&#39;</span>);
<a name="l09953"></a>09953             fwrite(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>, gzcompress(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>));
<a name="l09954"></a>09954             fclose(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>);
<a name="l09955"></a>09955             <span class="comment">// get font info</span>
<a name="l09956"></a>09956             $fmetric[<span class="stringliteral">&#39;Flags&#39;</span>] = $flags;
<a name="l09957"></a>09957             preg_match (<span class="stringliteral">&#39;#/FullName[\s]*\(([^\)]*)#&#39;</span>, <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $matches);
<a name="l09958"></a>09958             $fmetric[<span class="stringliteral">&#39;name&#39;</span>] = preg_replace(<span class="stringliteral">&#39;/[^a-zA-Z0-9_\-]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $matches[1]);
<a name="l09959"></a>09959             preg_match(<span class="stringliteral">&#39;#/FontBBox[\s]*{([^}]*)#&#39;</span>, <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $matches);
<a name="l09960"></a>09960             $fmetric[<span class="stringliteral">&#39;bbox&#39;</span>] = trim($matches[1]);
<a name="l09961"></a>09961             $bv = explode(<span class="charliteral">&#39; &#39;</span>, $fmetric[<span class="stringliteral">&#39;bbox&#39;</span>]);
<a name="l09962"></a>09962             $fmetric[<span class="stringliteral">&#39;Ascent&#39;</span>] = intval($bv[3]);
<a name="l09963"></a>09963             $fmetric[<span class="stringliteral">&#39;Descent&#39;</span>] = intval($bv[1]);
<a name="l09964"></a>09964             preg_match(<span class="stringliteral">&#39;#/ItalicAngle[\s]*([0-9\+\-]*)#&#39;</span>, <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $matches);
<a name="l09965"></a>09965             $fmetric[<span class="stringliteral">&#39;italicAngle&#39;</span>] = intval($matches[1]);
<a name="l09966"></a>09966             <span class="keywordflow">if</span> ($fmetric[<span class="stringliteral">&#39;italicAngle&#39;</span>] != 0) {
<a name="l09967"></a>09967                 $fmetric[<span class="stringliteral">&#39;Flags&#39;</span>] |= 64;
<a name="l09968"></a>09968             }
<a name="l09969"></a>09969             preg_match(<span class="stringliteral">&#39;#/UnderlinePosition[\s]*([0-9\+\-]*)#&#39;</span>, <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $matches);
<a name="l09970"></a>09970             $fmetric[<span class="stringliteral">&#39;underlinePosition&#39;</span>] = intval($matches[1]);
<a name="l09971"></a>09971             preg_match(<span class="stringliteral">&#39;#/UnderlineThickness[\s]*([0-9\+\-]*)#&#39;</span>, <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $matches);
<a name="l09972"></a>09972             $fmetric[<span class="stringliteral">&#39;underlineThickness&#39;</span>] = intval($matches[1]);
<a name="l09973"></a>09973             preg_match(<span class="stringliteral">&#39;#/isFixedPitch[\s]*([^\s]*)#&#39;</span>, <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $matches);
<a name="l09974"></a>09974             <span class="keywordflow">if</span> ($matches[1] == <span class="stringliteral">&#39;true&#39;</span>) {
<a name="l09975"></a>09975                 $fmetric[<span class="stringliteral">&#39;Flags&#39;</span>] |= 1;
<a name="l09976"></a>09976             }
<a name="l09977"></a>09977             <span class="comment">// get internal map</span>
<a name="l09978"></a>09978             $imap = array();
<a name="l09979"></a>09979             <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;#dup[\s]([0-9]+)[\s]*/([^\s]*)[\s]put#sU&#39;</span>, <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $fmap, PREG_SET_ORDER) &gt; 0) {
<a name="l09980"></a>09980                 <span class="keywordflow">foreach</span> ($fmap as $v) {
<a name="l09981"></a>09981                     $imap[$v[2]] = $v[1];
<a name="l09982"></a>09982                 }
<a name="l09983"></a>09983             }
<a name="l09984"></a>09984             <span class="comment">// decrypt eexec encrypted part</span>
<a name="l09985"></a>09985             <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = 55665; <span class="comment">// eexec encryption constant</span>
<a name="l09986"></a>09986             $c1 = 52845;
<a name="l09987"></a>09987             $c2 = 22719;
<a name="l09988"></a>09988             $elen = strlen(<a class="code" href="classTCPDF.html#affd380e0adfc726dbc519860de0b175c" title="IBoolean flag indicating whether document is protected.">$encrypted</a>);
<a name="l09989"></a>09989             $eplain = <span class="stringliteral">&#39;&#39;</span>;
<a name="l09990"></a>09990             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $elen; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l09991"></a>09991                 $chr = ord(<a class="code" href="classTCPDF.html#affd380e0adfc726dbc519860de0b175c" title="IBoolean flag indicating whether document is protected.">$encrypted</a>[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]);
<a name="l09992"></a>09992                 $eplain .= chr($chr ^ (<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> &gt;&gt; 8));
<a name="l09993"></a>09993                 <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = ((($chr + <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>) * $c1 + $c2) % 65536);
<a name="l09994"></a>09994             }
<a name="l09995"></a>09995             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;#/ForceBold[\s]*([^\s]*)#&#39;</span>, $eplain, $matches) &gt; 0) {
<a name="l09996"></a>09996                 <span class="keywordflow">if</span> ($matches[1] == <span class="stringliteral">&#39;true&#39;</span>) {
<a name="l09997"></a>09997                     $fmetric[<span class="stringliteral">&#39;Flags&#39;</span>] |= 0x40000;
<a name="l09998"></a>09998                 }
<a name="l09999"></a>09999             }
<a name="l10000"></a>10000             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;#/StdVW[\s]*\[([^\]]*)#&#39;</span>, $eplain, $matches) &gt; 0) {
<a name="l10001"></a>10001                 $fmetric[<span class="stringliteral">&#39;StemV&#39;</span>] = intval($matches[1]);
<a name="l10002"></a>10002             } <span class="keywordflow">else</span> {
<a name="l10003"></a>10003                 $fmetric[<span class="stringliteral">&#39;StemV&#39;</span>] = 70;
<a name="l10004"></a>10004             }
<a name="l10005"></a>10005             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;#/StdHW[\s]*\[([^\]]*)#&#39;</span>, $eplain, $matches) &gt; 0) {
<a name="l10006"></a>10006                 $fmetric[<span class="stringliteral">&#39;StemH&#39;</span>] = intval($matches[1]);
<a name="l10007"></a>10007             } <span class="keywordflow">else</span> {
<a name="l10008"></a>10008                 $fmetric[<span class="stringliteral">&#39;StemH&#39;</span>] = 30;
<a name="l10009"></a>10009             }
<a name="l10010"></a>10010             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;#/BlueValues[\s]*\[([^\]]*)#&#39;</span>, $eplain, $matches) &gt; 0) {
<a name="l10011"></a>10011                 $bv = explode(<span class="charliteral">&#39; &#39;</span>, $matches[1]);
<a name="l10012"></a>10012                 <span class="keywordflow">if</span> (count($bv) &gt;= 6) {
<a name="l10013"></a>10013                     $v1 = intval($bv[2]);
<a name="l10014"></a>10014                     $v2 = intval($bv[4]);
<a name="l10015"></a>10015                     <span class="keywordflow">if</span> ($v1 &lt;= $v2) {
<a name="l10016"></a>10016                         $fmetric[<span class="stringliteral">&#39;XHeight&#39;</span>] = $v1;
<a name="l10017"></a>10017                         $fmetric[<span class="stringliteral">&#39;CapHeight&#39;</span>] = $v2;
<a name="l10018"></a>10018                     } <span class="keywordflow">else</span> {
<a name="l10019"></a>10019                         $fmetric[<span class="stringliteral">&#39;XHeight&#39;</span>] = $v2;
<a name="l10020"></a>10020                         $fmetric[<span class="stringliteral">&#39;CapHeight&#39;</span>] = $v1;
<a name="l10021"></a>10021                     }
<a name="l10022"></a>10022                 } <span class="keywordflow">else</span> {
<a name="l10023"></a>10023                     $fmetric[<span class="stringliteral">&#39;XHeight&#39;</span>] = 450;
<a name="l10024"></a>10024                     $fmetric[<span class="stringliteral">&#39;CapHeight&#39;</span>] = 700;
<a name="l10025"></a>10025                 }
<a name="l10026"></a>10026             } <span class="keywordflow">else</span> {
<a name="l10027"></a>10027                 $fmetric[<span class="stringliteral">&#39;XHeight&#39;</span>] = 450;
<a name="l10028"></a>10028                 $fmetric[<span class="stringliteral">&#39;CapHeight&#39;</span>] = 700;
<a name="l10029"></a>10029             }
<a name="l10030"></a>10030             <span class="comment">// get the number of random bytes at the beginning of charstrings</span>
<a name="l10031"></a>10031             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;#/lenIV[\s]*([0-9]*)#&#39;</span>, $eplain, $matches) &gt; 0) {
<a name="l10032"></a>10032                 $lenIV = intval($matches[1]);
<a name="l10033"></a>10033             } <span class="keywordflow">else</span> {
<a name="l10034"></a>10034                 $lenIV = 4;
<a name="l10035"></a>10035             }
<a name="l10036"></a>10036             $fmetric[<span class="stringliteral">&#39;Leading&#39;</span>] = 0;
<a name="l10037"></a>10037             <span class="comment">// get charstring data</span>
<a name="l10038"></a>10038             $eplain = substr($eplain, (strpos($eplain, <span class="stringliteral">&#39;/CharStrings&#39;</span>) + 1));
<a name="l10039"></a>10039             preg_match_all(<span class="stringliteral">&#39;#/([A-Za-z0-9\.]*)[\s][0-9]+[\s]RD[\s](.*)[\s]ND#sU&#39;</span>, $eplain, $matches, PREG_SET_ORDER);
<a name="l10040"></a>10040             <span class="keywordflow">if</span> (!empty(<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>) AND isset($this-&gt;encmaps-&gt;encmap[<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>])) {
<a name="l10041"></a>10041                 $enc_map = $this-&gt;encmaps-&gt;encmap[<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>];
<a name="l10042"></a>10042             } <span class="keywordflow">else</span> {
<a name="l10043"></a>10043                 $enc_map = <span class="keyword">false</span>;
<a name="l10044"></a>10044             }
<a name="l10045"></a>10045             $fmetric[<span class="stringliteral">&#39;cw&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l10046"></a>10046             $fmetric[<span class="stringliteral">&#39;MaxWidth&#39;</span>] = 0;
<a name="l10047"></a>10047             $cwidths = array();
<a name="l10048"></a>10048             <span class="keywordflow">foreach</span> ($matches as <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> =&gt; $v) {
<a name="l10049"></a>10049                 $cid = 0;
<a name="l10050"></a>10050                 <span class="keywordflow">if</span> (isset($imap[$v[1]])) {
<a name="l10051"></a>10051                     $cid = $imap[$v[1]];
<a name="l10052"></a>10052                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($enc_map !== <span class="keyword">false</span>) {
<a name="l10053"></a>10053                     $cid = array_search($v[1], $enc_map);
<a name="l10054"></a>10054                     <span class="keywordflow">if</span> ($cid === <span class="keyword">false</span>) {
<a name="l10055"></a>10055                         $cid = 0;
<a name="l10056"></a>10056                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($cid &gt; 1000) {
<a name="l10057"></a>10057                         $cid -= 1000;
<a name="l10058"></a>10058                     }
<a name="l10059"></a>10059                 }
<a name="l10060"></a>10060                 <span class="comment">// decrypt charstring encrypted part</span>
<a name="l10061"></a>10061                 <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = 4330; <span class="comment">// charstring encryption constant</span>
<a name="l10062"></a>10062                 $c1 = 52845;
<a name="l10063"></a>10063                 $c2 = 22719;
<a name="l10064"></a>10064                 $cd = $v[2];
<a name="l10065"></a>10065                 $clen = strlen($cd);
<a name="l10066"></a>10066                 $ccom = array();
<a name="l10067"></a>10067                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $clen; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10068"></a>10068                     $chr = ord($cd[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]);
<a name="l10069"></a>10069                     $ccom[] = ($chr ^ (<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> &gt;&gt; 8));
<a name="l10070"></a>10070                     <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = ((($chr + <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>) * $c1 + $c2) % 65536);
<a name="l10071"></a>10071                 }
<a name="l10072"></a>10072                 <span class="comment">// decode numbers</span>
<a name="l10073"></a>10073                 $cdec = array();
<a name="l10074"></a>10074                 $ck = 0;
<a name="l10075"></a>10075                 <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = $lenIV;
<a name="l10076"></a>10076                 <span class="keywordflow">while</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $clen) {
<a name="l10077"></a>10077                     <span class="keywordflow">if</span> ($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] &lt; 32) {
<a name="l10078"></a>10078                         $cdec[$ck] = $ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l10079"></a>10079                         <span class="keywordflow">if</span> (($ck &gt; 0) AND ($cdec[$ck] == 13)) {
<a name="l10080"></a>10080                             <span class="comment">// hsbw command: update width</span>
<a name="l10081"></a>10081                             $cwidths[$cid] = $cdec[($ck - 1)];
<a name="l10082"></a>10082                         }
<a name="l10083"></a>10083                         ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l10084"></a>10084                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] &gt;= 32) AND ($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] &lt;= 246)) {
<a name="l10085"></a>10085                         $cdec[$ck] = ($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] - 139);
<a name="l10086"></a>10086                         ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l10087"></a>10087                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] &gt;= 247) AND ($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] &lt;= 250)) {
<a name="l10088"></a>10088                         $cdec[$ck] = ((($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] - 247) * 256) + $ccom[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 1)] + 108);
<a name="l10089"></a>10089                         <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> += 2;
<a name="l10090"></a>10090                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] &gt;= 251) AND ($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] &lt;= 254)) {
<a name="l10091"></a>10091                         $cdec[$ck] = ((-($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] - 251) * 256) - $ccom[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 1)] - 108);
<a name="l10092"></a>10092                         <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> += 2;
<a name="l10093"></a>10093                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($ccom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] == 255) {
<a name="l10094"></a>10094                         $sval = chr($ccom[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 1)]).chr($ccom[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 2)]).chr($ccom[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 3)]).chr($ccom[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 4)]);
<a name="l10095"></a>10095                         $vsval = unpack(<span class="stringliteral">&#39;li&#39;</span>, $sval);
<a name="l10096"></a>10096                         $cdec[$ck] = $vsval[<span class="charliteral">&#39;i&#39;</span>];
<a name="l10097"></a>10097                         <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> += 5;
<a name="l10098"></a>10098                     }
<a name="l10099"></a>10099                     ++$ck;
<a name="l10100"></a>10100                 }
<a name="l10101"></a>10101             } <span class="comment">// end for each matches</span>
<a name="l10102"></a>10102             $fmetric[<span class="stringliteral">&#39;MissingWidth&#39;</span>] = $cwidths[0];
<a name="l10103"></a>10103             $fmetric[<span class="stringliteral">&#39;MaxWidth&#39;</span>] = $fmetric[<span class="stringliteral">&#39;MissingWidth&#39;</span>];
<a name="l10104"></a>10104             $fmetric[<span class="stringliteral">&#39;AvgWidth&#39;</span>] = 0;
<a name="l10105"></a>10105             <span class="comment">// set chars widths</span>
<a name="l10106"></a>10106             <span class="keywordflow">for</span> ($cid = 0; $cid &lt;= 255; ++$cid) {
<a name="l10107"></a>10107                 <span class="keywordflow">if</span> (isset($cwidths[$cid])) {
<a name="l10108"></a>10108                     <span class="keywordflow">if</span> ($cwidths[$cid] &gt; $fmetric[<span class="stringliteral">&#39;MaxWidth&#39;</span>]) {
<a name="l10109"></a>10109                         $fmetric[<span class="stringliteral">&#39;MaxWidth&#39;</span>] = $cwidths[$cid];
<a name="l10110"></a>10110                     }
<a name="l10111"></a>10111                     $fmetric[<span class="stringliteral">&#39;AvgWidth&#39;</span>] += $cwidths[$cid];
<a name="l10112"></a>10112                     $fmetric[<span class="stringliteral">&#39;cw&#39;</span>] .= <span class="charliteral">&#39;,&#39;</span>.$cid.<span class="stringliteral">&#39;=&gt;&#39;</span>.$cwidths[$cid];
<a name="l10113"></a>10113                 } <span class="keywordflow">else</span> {
<a name="l10114"></a>10114                     $fmetric[<span class="stringliteral">&#39;cw&#39;</span>] .= <span class="charliteral">&#39;,&#39;</span>.$cid.<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;MissingWidth&#39;</span>];
<a name="l10115"></a>10115                 }
<a name="l10116"></a>10116             }
<a name="l10117"></a>10117             $fmetric[<span class="stringliteral">&#39;AvgWidth&#39;</span>] = round($fmetric[<span class="stringliteral">&#39;AvgWidth&#39;</span>] / count($cwidths));
<a name="l10118"></a>10118         } <span class="keywordflow">else</span> {
<a name="l10119"></a>10119             <span class="comment">// ---------- TRUE TYPE ----------</span>
<a name="l10120"></a>10120             <span class="keywordflow">if</span> ($fmetric[<span class="stringliteral">&#39;type&#39;</span>] != <span class="stringliteral">&#39;cidfont0&#39;</span>) {
<a name="l10121"></a>10121                 <span class="comment">// store compressed font</span>
<a name="l10122"></a>10122                 <a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a> = fopen($outpath.$fmetric[<span class="stringliteral">&#39;file&#39;</span>], <span class="stringliteral">&#39;wb&#39;</span>);
<a name="l10123"></a>10123                 fwrite(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>, gzcompress(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>));
<a name="l10124"></a>10124                 fclose(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>);
<a name="l10125"></a>10125             }
<a name="l10126"></a>10126             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0; <span class="comment">// offset position of the font data</span>
<a name="l10127"></a>10127             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) != 0x10000) {
<a name="l10128"></a>10128                 <span class="comment">// sfnt version must be 0x00010000 for TrueType version 1.0.</span>
<a name="l10129"></a>10129                 <span class="keywordflow">return</span> <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l10130"></a>10130             }
<a name="l10131"></a>10131             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10132"></a>10132             <span class="comment">// get number of tables</span>
<a name="l10133"></a>10133             $numTables = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10134"></a>10134             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10135"></a>10135             <span class="comment">// skip searchRange, entrySelector and rangeShift</span>
<a name="l10136"></a>10136             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 6;
<a name="l10137"></a>10137             <span class="comment">// tables array</span>
<a name="l10138"></a>10138             <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a> = array();
<a name="l10139"></a>10139             <span class="comment">// ---------- get tables ----------</span>
<a name="l10140"></a>10140             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numTables; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10141"></a>10141                 <span class="comment">// get table info</span>
<a name="l10142"></a>10142                 $tag = substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, 4);
<a name="l10143"></a>10143                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10144"></a>10144                 <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag] = array();
<a name="l10145"></a>10145                 <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;checkSum&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10146"></a>10146                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10147"></a>10147                 <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;offset&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10148"></a>10148                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10149"></a>10149                 <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;length&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10150"></a>10150                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10151"></a>10151             }
<a name="l10152"></a>10152             <span class="comment">// check magicNumber</span>
<a name="l10153"></a>10153             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;head&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + 12;
<a name="l10154"></a>10154             <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) != 0x5F0F3CF5) {
<a name="l10155"></a>10155                 <span class="comment">// magicNumber must be 0x5F0F3CF5</span>
<a name="l10156"></a>10156                 <span class="keywordflow">return</span> <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l10157"></a>10157             }
<a name="l10158"></a>10158             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10159"></a>10159             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2; <span class="comment">// skip flags</span>
<a name="l10160"></a>10160             <span class="comment">// get FUnits</span>
<a name="l10161"></a>10161             $fmetric[<span class="stringliteral">&#39;unitsPerEm&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10162"></a>10162             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10163"></a>10163             <span class="comment">// units ratio constant</span>
<a name="l10164"></a>10164             $urk = (1000 / $fmetric[<span class="stringliteral">&#39;unitsPerEm&#39;</span>]);
<a name="l10165"></a>10165             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 16; <span class="comment">// skip created, modified</span>
<a name="l10166"></a>10166             $xMin = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10167"></a>10167             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10168"></a>10168             $yMin = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10169"></a>10169             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10170"></a>10170             $xMax = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10171"></a>10171             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10172"></a>10172             $yMax = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10173"></a>10173             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10174"></a>10174             $fmetric[<span class="stringliteral">&#39;bbox&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>.$xMin.<span class="charliteral">&#39; &#39;</span>.$yMin.<span class="charliteral">&#39; &#39;</span>.$xMax.<span class="charliteral">&#39; &#39;</span>.$yMax.<span class="stringliteral">&#39;&#39;</span>;
<a name="l10175"></a>10175             $macStyle = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10176"></a>10176             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10177"></a>10177             <span class="comment">// PDF font flags</span>
<a name="l10178"></a>10178             $fmetric[<span class="stringliteral">&#39;Flags&#39;</span>] = $flags;
<a name="l10179"></a>10179             <span class="keywordflow">if</span> (($macStyle &amp; 2) == 2) {
<a name="l10180"></a>10180                 <span class="comment">// italic flag</span>
<a name="l10181"></a>10181                 $fmetric[<span class="stringliteral">&#39;Flags&#39;</span>] |= 64;
<a name="l10182"></a>10182             }
<a name="l10183"></a>10183             <span class="comment">// get offset mode (indexToLocFormat : 0 = short, 1 = long)</span>
<a name="l10184"></a>10184             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;head&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + 50;
<a name="l10185"></a>10185             $short_offset = ($this-&gt;<a class="code" href="classTCPDF.html#aa9c624edd1ea5063cb13468139e12d91" title="Get SHORT from string (Big Endian 16-bit signed integer).">_getSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) == 0);
<a name="l10186"></a>10186             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10187"></a>10187             <span class="comment">// get the offsets to the locations of the glyphs in the font, relative to the beginning of the glyphData table</span>
<a name="l10188"></a>10188             $indexToLoc = array();
<a name="l10189"></a>10189             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10190"></a>10190             <span class="keywordflow">if</span> ($short_offset) {
<a name="l10191"></a>10191                 <span class="comment">// short version</span>
<a name="l10192"></a>10192                 $tot_num_glyphs = (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] / 2); <span class="comment">// numGlyphs + 1</span>
<a name="l10193"></a>10193                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $tot_num_glyphs; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10194"></a>10194                     $indexToLoc[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * 2;
<a name="l10195"></a>10195                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10196"></a>10196                 }
<a name="l10197"></a>10197             } <span class="keywordflow">else</span> {
<a name="l10198"></a>10198                 <span class="comment">// long version</span>
<a name="l10199"></a>10199                 $tot_num_glyphs = (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] / 4); <span class="comment">// numGlyphs + 1</span>
<a name="l10200"></a>10200                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $tot_num_glyphs; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10201"></a>10201                     $indexToLoc[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10202"></a>10202                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10203"></a>10203                 }
<a name="l10204"></a>10204             }
<a name="l10205"></a>10205             <span class="comment">// get glyphs indexes of chars from cmap table</span>
<a name="l10206"></a>10206             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;cmap&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + 2;
<a name="l10207"></a>10207             $numEncodingTables = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10208"></a>10208             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10209"></a>10209             $encodingTables = array();
<a name="l10210"></a>10210             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numEncodingTables; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10211"></a>10211                 $encodingTables[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;platformID&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10212"></a>10212                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10213"></a>10213                 $encodingTables[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;encodingID&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10214"></a>10214                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10215"></a>10215                 $encodingTables[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;offset&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10216"></a>10216                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10217"></a>10217             }
<a name="l10218"></a>10218             <span class="comment">// ---------- get os/2 metrics ----------</span>
<a name="l10219"></a>10219             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;OS/2&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10220"></a>10220             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2; <span class="comment">// skip version</span>
<a name="l10221"></a>10221             <span class="comment">// xAvgCharWidth</span>
<a name="l10222"></a>10222             $fmetric[<span class="stringliteral">&#39;AvgWidth&#39;</span>] = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10223"></a>10223             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10224"></a>10224             <span class="comment">// usWeightClass</span>
<a name="l10225"></a>10225             $usWeightClass = round($this-&gt;<a class="code" href="classTCPDF.html#a39b4ff7e526b30437ff704526801809c" title="Get UFWORD from string (Big Endian 16-bit unsigned integer).">_getUFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10226"></a>10226             <span class="comment">// estimate StemV and StemH (400 = usWeightClass for Normal - Regular font)</span>
<a name="l10227"></a>10227             $fmetric[<span class="stringliteral">&#39;StemV&#39;</span>] = round((70 * $usWeightClass) / 400);
<a name="l10228"></a>10228             $fmetric[<span class="stringliteral">&#39;StemH&#39;</span>] = round((30 * $usWeightClass) / 400);
<a name="l10229"></a>10229             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10230"></a>10230             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2; <span class="comment">// usWidthClass</span>
<a name="l10231"></a>10231             $fsType = $this-&gt;<a class="code" href="classTCPDF.html#aa9c624edd1ea5063cb13468139e12d91" title="Get SHORT from string (Big Endian 16-bit signed integer).">_getSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10232"></a>10232             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10233"></a>10233             <span class="keywordflow">if</span> ($fsType == 2) {
<a name="l10234"></a>10234                 $this-&gt;<a class="code" href="classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91" title="This method is automatically called in case of fatal error; it simply outputs the message and halts t...">Error</a>(<span class="stringliteral">&#39;This Font cannot be modified, embedded or exchanged in any manner without first obtaining permission of the legal owner.&#39;</span>);
<a name="l10235"></a>10235             }
<a name="l10236"></a>10236             <span class="comment">// ---------- get font name ----------</span>
<a name="l10237"></a>10237             $fmetric[<span class="stringliteral">&#39;name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l10238"></a>10238             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;name&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10239"></a>10239             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2; <span class="comment">// skip Format selector (=0).</span>
<a name="l10240"></a>10240             <span class="comment">// Number of NameRecords that follow n.</span>
<a name="l10241"></a>10241             $numNameRecords = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10242"></a>10242             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10243"></a>10243             <span class="comment">// Offset to start of string storage (from start of table).</span>
<a name="l10244"></a>10244             $stringStorageOffset = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10245"></a>10245             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10246"></a>10246             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numNameRecords; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10247"></a>10247                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 6; <span class="comment">// skip Platform ID, Platform-specific encoding ID, Language ID.</span>
<a name="l10248"></a>10248                 <span class="comment">// Name ID.</span>
<a name="l10249"></a>10249                 $nameID = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10250"></a>10250                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10251"></a>10251                 <span class="keywordflow">if</span> ($nameID == 6) {
<a name="l10252"></a>10252                     <span class="comment">// String length (in bytes).</span>
<a name="l10253"></a>10253                     $stringLength = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10254"></a>10254                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10255"></a>10255                     <span class="comment">// String offset from start of storage area (in bytes).</span>
<a name="l10256"></a>10256                     $stringOffset = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10257"></a>10257                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10258"></a>10258                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;name&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + $stringStorageOffset + $stringOffset);
<a name="l10259"></a>10259                     $fmetric[<span class="stringliteral">&#39;name&#39;</span>] = substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, $stringLength);
<a name="l10260"></a>10260                     $fmetric[<span class="stringliteral">&#39;name&#39;</span>] = preg_replace(<span class="stringliteral">&#39;/[^a-zA-Z0-9_\-]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $fmetric[<span class="stringliteral">&#39;name&#39;</span>]);
<a name="l10261"></a>10261                     <span class="keywordflow">break</span>;
<a name="l10262"></a>10262                 } <span class="keywordflow">else</span> {
<a name="l10263"></a>10263                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip String length, String offset</span>
<a name="l10264"></a>10264                 }
<a name="l10265"></a>10265             }
<a name="l10266"></a>10266             <span class="keywordflow">if</span> (empty($fmetric[<span class="stringliteral">&#39;name&#39;</span>])) {
<a name="l10267"></a>10267                 $fmetric[<span class="stringliteral">&#39;name&#39;</span>] = $font_name;
<a name="l10268"></a>10268             }
<a name="l10269"></a>10269             <span class="comment">// ---------- get post data ----------</span>
<a name="l10270"></a>10270             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;post&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10271"></a>10271             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip Format Type</span>
<a name="l10272"></a>10272             $fmetric[<span class="stringliteral">&#39;italicAngle&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a0bf637e15b9d3f0e3f090e826fed9224" title="Get FIXED from string (32-bit signed fixed-point number (16.16).">_getFIXED</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10273"></a>10273             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10274"></a>10274             $fmetric[<span class="stringliteral">&#39;underlinePosition&#39;</span>] = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10275"></a>10275             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10276"></a>10276             $fmetric[<span class="stringliteral">&#39;underlineThickness&#39;</span>] = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10277"></a>10277             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10278"></a>10278             $isFixedPitch = ($this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) == 0) ? <span class="keyword">false</span> : <span class="keyword">true</span>;
<a name="l10279"></a>10279             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10280"></a>10280             <span class="keywordflow">if</span> ($isFixedPitch) {
<a name="l10281"></a>10281                 $fmetric[<span class="stringliteral">&#39;Flags&#39;</span>] |= 1;
<a name="l10282"></a>10282             }
<a name="l10283"></a>10283             <span class="comment">// ---------- get hhea data ----------</span>
<a name="l10284"></a>10284             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;hhea&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10285"></a>10285             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip Table version number</span>
<a name="l10286"></a>10286             <span class="comment">// Ascender</span>
<a name="l10287"></a>10287             $fmetric[<span class="stringliteral">&#39;Ascent&#39;</span>] = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10288"></a>10288             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10289"></a>10289             <span class="comment">// Descender</span>
<a name="l10290"></a>10290             $fmetric[<span class="stringliteral">&#39;Descent&#39;</span>] = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10291"></a>10291             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10292"></a>10292             <span class="comment">// LineGap</span>
<a name="l10293"></a>10293             $fmetric[<span class="stringliteral">&#39;Leading&#39;</span>] = round($this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10294"></a>10294             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10295"></a>10295             <span class="comment">// advanceWidthMax</span>
<a name="l10296"></a>10296             $fmetric[<span class="stringliteral">&#39;MaxWidth&#39;</span>] = round($this-&gt;<a class="code" href="classTCPDF.html#a39b4ff7e526b30437ff704526801809c" title="Get UFWORD from string (Big Endian 16-bit unsigned integer).">_getUFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10297"></a>10297             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10298"></a>10298             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 22; <span class="comment">// skip some values</span>
<a name="l10299"></a>10299             <span class="comment">// get the number of hMetric entries in hmtx table</span>
<a name="l10300"></a>10300             $numberOfHMetrics = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10301"></a>10301             <span class="comment">// ---------- get maxp data ----------</span>
<a name="l10302"></a>10302             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;maxp&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10303"></a>10303             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip Table version number</span>
<a name="l10304"></a>10304             <span class="comment">// get the the number of glyphs in the font.</span>
<a name="l10305"></a>10305             $numGlyphs = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10306"></a>10306             <span class="comment">// ---------- get CIDToGIDMap ----------</span>
<a name="l10307"></a>10307             <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a> = array();
<a name="l10308"></a>10308             <span class="keywordflow">foreach</span> ($encodingTables as $enctable) {
<a name="l10309"></a>10309                 <span class="keywordflow">if</span> (($enctable[<span class="stringliteral">&#39;platformID&#39;</span>] == 3) AND ($enctable[<span class="stringliteral">&#39;encodingID&#39;</span>] == 0)) {
<a name="l10310"></a>10310                     $modesymbol = <span class="keyword">true</span>;
<a name="l10311"></a>10311                 } <span class="keywordflow">else</span> {
<a name="l10312"></a>10312                     $modesymbol = <span class="keyword">false</span>;
<a name="l10313"></a>10313                 }
<a name="l10314"></a>10314                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;cmap&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + $enctable[<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10315"></a>10315                 <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a> = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10316"></a>10316                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10317"></a>10317                 <span class="keywordflow">switch</span> (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>) {
<a name="l10318"></a>10318                     <span class="keywordflow">case</span> 0: { <span class="comment">// Format 0: Byte encoding table</span>
<a name="l10319"></a>10319                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip length and version/language</span>
<a name="l10320"></a>10320                         <span class="keywordflow">for</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = 0; <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt; 256; ++<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l10321"></a>10321                             $g = $this-&gt;<a class="code" href="classTCPDF.html#aa5f2d012801e75c7f416ac12c6e5ffa9" title="Get BYTE from string (8-bit unsigned integer).">_getBYTE</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10322"></a>10322                             <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>] = $g;
<a name="l10323"></a>10323                             ++<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>;
<a name="l10324"></a>10324                         }
<a name="l10325"></a>10325                         <span class="keywordflow">break</span>;
<a name="l10326"></a>10326                     }
<a name="l10327"></a>10327                     <span class="keywordflow">case</span> 2: { <span class="comment">// Format 2: High-byte mapping through table</span>
<a name="l10328"></a>10328                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip length and version/language</span>
<a name="l10329"></a>10329                         $numSubHeaders = 0;
<a name="l10330"></a>10330                         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 256; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10331"></a>10331                             <span class="comment">// Array that maps high bytes to subHeaders: value is subHeader index * 8.</span>
<a name="l10332"></a>10332                             $subHeaderKeys[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = ($this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) / 8);
<a name="l10333"></a>10333                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10334"></a>10334                             <span class="keywordflow">if</span> ($numSubHeaders &lt; $subHeaderKeys[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) {
<a name="l10335"></a>10335                                 $numSubHeaders = $subHeaderKeys[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l10336"></a>10336                             }
<a name="l10337"></a>10337                         }
<a name="l10338"></a>10338                         <span class="comment">// the number of subHeaders is equal to the max of subHeaderKeys + 1</span>
<a name="l10339"></a>10339                         ++$numSubHeaders;
<a name="l10340"></a>10340                         <span class="comment">// read subHeader structures</span>
<a name="l10341"></a>10341                         $subHeaders = array();
<a name="l10342"></a>10342                         $numGlyphIndexArray = 0;
<a name="l10343"></a>10343                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $numSubHeaders; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10344"></a>10344                             $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;firstCode&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10345"></a>10345                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10346"></a>10346                             $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;entryCount&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10347"></a>10347                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10348"></a>10348                             $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;idDelta&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#aa9c624edd1ea5063cb13468139e12d91" title="Get SHORT from string (Big Endian 16-bit signed integer).">_getSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10349"></a>10349                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10350"></a>10350                             $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;idRangeOffset&#39;</span>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10351"></a>10351                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10352"></a>10352                             $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;idRangeOffset&#39;</span>] -= (2 + (($numSubHeaders - <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> - 1) * 8));
<a name="l10353"></a>10353                             $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;idRangeOffset&#39;</span>] /= 2;
<a name="l10354"></a>10354                             $numGlyphIndexArray += $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;entryCount&#39;</span>];
<a name="l10355"></a>10355                         }
<a name="l10356"></a>10356                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $numGlyphIndexArray; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10357"></a>10357                             $glyphIndexArray[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10358"></a>10358                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10359"></a>10359                         }
<a name="l10360"></a>10360                         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 256; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10361"></a>10361                             <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = $subHeaderKeys[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l10362"></a>10362                             <span class="keywordflow">if</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> == 0) {
<a name="l10363"></a>10363                                 <span class="comment">// one byte code</span>
<a name="l10364"></a>10364                                 <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l10365"></a>10365                                 $g = $glyphIndexArray[0];
<a name="l10366"></a>10366                                 <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>] = $g;
<a name="l10367"></a>10367                             } <span class="keywordflow">else</span> {
<a name="l10368"></a>10368                                 <span class="comment">// two bytes code</span>
<a name="l10369"></a>10369                                 $start_byte = $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;firstCode&#39;</span>];
<a name="l10370"></a>10370                                 $end_byte = $start_byte + $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;entryCount&#39;</span>];
<a name="l10371"></a>10371                                 <span class="keywordflow">for</span> ($j = $start_byte; $j &lt; $end_byte; ++$j) {
<a name="l10372"></a>10372                                     <span class="comment">// combine high and low bytes</span>
<a name="l10373"></a>10373                                     <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = ((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;&lt; 8) + $j);
<a name="l10374"></a>10374                                     $idRangeOffset = ($subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;idRangeOffset&#39;</span>] + $j - $subHeaders[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>][<span class="stringliteral">&#39;firstCode&#39;</span>]);
<a name="l10375"></a>10375                                     $g = $glyphIndexArray[$idRangeOffset];
<a name="l10376"></a>10376                                     $g += ($idDelta[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] - 65536);
<a name="l10377"></a>10377                                     <span class="keywordflow">if</span> ($g &lt; 0) {
<a name="l10378"></a>10378                                         $g = 0;
<a name="l10379"></a>10379                                     }
<a name="l10380"></a>10380                                     <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>] = $g;
<a name="l10381"></a>10381                                 }
<a name="l10382"></a>10382                             }
<a name="l10383"></a>10383                         }
<a name="l10384"></a>10384                         <span class="keywordflow">break</span>;
<a name="l10385"></a>10385                     }
<a name="l10386"></a>10386                     <span class="keywordflow">case</span> 4: { <span class="comment">// Format 4: Segment mapping to delta values</span>
<a name="l10387"></a>10387                         $length = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10388"></a>10388                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10389"></a>10389                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2; <span class="comment">// skip version/language</span>
<a name="l10390"></a>10390                         $segCount = ($this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) / 2);
<a name="l10391"></a>10391                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10392"></a>10392                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 6; <span class="comment">// skip searchRange, entrySelector, rangeShift</span>
<a name="l10393"></a>10393                         $endCount = array(); <span class="comment">// array of end character codes for each segment</span>
<a name="l10394"></a>10394                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $segCount; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10395"></a>10395                             $endCount[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10396"></a>10396                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10397"></a>10397                         }
<a name="l10398"></a>10398                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2; <span class="comment">// skip reservedPad</span>
<a name="l10399"></a>10399                         $startCount = array(); <span class="comment">// array of start character codes for each segment</span>
<a name="l10400"></a>10400                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $segCount; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10401"></a>10401                             $startCount[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10402"></a>10402                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10403"></a>10403                         }
<a name="l10404"></a>10404                         $idDelta = array(); <span class="comment">// delta for all character codes in segment</span>
<a name="l10405"></a>10405                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $segCount; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10406"></a>10406                             $idDelta[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10407"></a>10407                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10408"></a>10408                         }
<a name="l10409"></a>10409                         $idRangeOffset = array(); <span class="comment">// Offsets into glyphIdArray or 0</span>
<a name="l10410"></a>10410                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $segCount; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10411"></a>10411                             $idRangeOffset[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10412"></a>10412                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10413"></a>10413                         }
<a name="l10414"></a>10414                         $gidlen = ($length / 2) - 8 - (4 * $segCount);
<a name="l10415"></a>10415                         $glyphIdArray = array(); <span class="comment">// glyph index array</span>
<a name="l10416"></a>10416                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $gidlen; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10417"></a>10417                             $glyphIdArray[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10418"></a>10418                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10419"></a>10419                         }
<a name="l10420"></a>10420                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $segCount; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10421"></a>10421                             <span class="keywordflow">for</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = $startCount[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>]; <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt;= $endCount[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>]; ++<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l10422"></a>10422                                 <span class="keywordflow">if</span> ($idRangeOffset[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] == 0) {
<a name="l10423"></a>10423                                     $g = <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>;
<a name="l10424"></a>10424                                 } <span class="keywordflow">else</span> {
<a name="l10425"></a>10425                                     $gid = (($idRangeOffset[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] / 2) + (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> - $startCount[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>]) - ($segCount - <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>));
<a name="l10426"></a>10426                                     $g = $glyphIdArray[$gid];
<a name="l10427"></a>10427                                 }
<a name="l10428"></a>10428                                 $g += ($idDelta[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] - 65536);
<a name="l10429"></a>10429                                 <span class="keywordflow">if</span> ($g &lt; 0) {
<a name="l10430"></a>10430                                     $g = 0;
<a name="l10431"></a>10431                                 }
<a name="l10432"></a>10432                                 <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>] = $g;
<a name="l10433"></a>10433                             }
<a name="l10434"></a>10434                         }
<a name="l10435"></a>10435                         <span class="keywordflow">break</span>;
<a name="l10436"></a>10436                     }
<a name="l10437"></a>10437                     <span class="keywordflow">case</span> 6: { <span class="comment">// Format 6: Trimmed table mapping</span>
<a name="l10438"></a>10438                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip length and version/language</span>
<a name="l10439"></a>10439                         $firstCode = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10440"></a>10440                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10441"></a>10441                         $entryCount = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10442"></a>10442                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10443"></a>10443                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $entryCount; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10444"></a>10444                             <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> + $firstCode);
<a name="l10445"></a>10445                             $g = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10446"></a>10446                             <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>] = $g;
<a name="l10447"></a>10447                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10448"></a>10448                         }
<a name="l10449"></a>10449                         <span class="keywordflow">break</span>;
<a name="l10450"></a>10450                     }
<a name="l10451"></a>10451                     <span class="keywordflow">case</span> 8: { <span class="comment">// Format 8: Mixed 16-bit and 32-bit coverage</span>
<a name="l10452"></a>10452                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 10; <span class="comment">// skip reserved, length and version/language</span>
<a name="l10453"></a>10453                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; 8192; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10454"></a>10454                             $is32[<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>] = $this-&gt;<a class="code" href="classTCPDF.html#aa5f2d012801e75c7f416ac12c6e5ffa9" title="Get BYTE from string (8-bit unsigned integer).">_getBYTE</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10455"></a>10455                             ++<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>;
<a name="l10456"></a>10456                         }
<a name="l10457"></a>10457                         $nGroups = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10458"></a>10458                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10459"></a>10459                         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $nGroups; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10460"></a>10460                             $startCharCode = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10461"></a>10461                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10462"></a>10462                             $endCharCode = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10463"></a>10463                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10464"></a>10464                             $startGlyphID = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10465"></a>10465                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10466"></a>10466                             <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = $startCharCode; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt;= $endCharCode; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10467"></a>10467                                 $is32idx = floor(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> / 8);
<a name="l10468"></a>10468                                 <span class="keywordflow">if</span> ((isset($is32[$is32idx])) AND (($is32[$is32idx] &amp; (1 &lt;&lt; (7 - (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> % 8)))) == 0)) {
<a name="l10469"></a>10469                                     <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>;
<a name="l10470"></a>10470                                 } <span class="keywordflow">else</span> {
<a name="l10471"></a>10471                                     <span class="comment">// 32 bit format</span>
<a name="l10472"></a>10472                                     <span class="comment">// convert to decimal (http://www.unicode.org/faq//utf_bom.html#utf16-4)</span>
<a name="l10473"></a>10473                                     <span class="comment">//LEAD_OFFSET = (0xD800 - (0x10000 &gt;&gt; 10)) = 55232</span>
<a name="l10474"></a>10474                                     <span class="comment">//SURROGATE_OFFSET = (0x10000 - (0xD800 &lt;&lt; 10) - 0xDC00) = -56613888</span>
<a name="l10475"></a>10475                                     <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = ((55232 + (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &gt;&gt; 10)) &lt;&lt; 10) + (0xDC00 + (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &amp; 0x3FF)) -56613888;
<a name="l10476"></a>10476                                 }
<a name="l10477"></a>10477                                 <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>] = $g;
<a name="l10478"></a>10478                                 ++$startGlyphID;
<a name="l10479"></a>10479                             }
<a name="l10480"></a>10480                         }
<a name="l10481"></a>10481                         <span class="keywordflow">break</span>;
<a name="l10482"></a>10482                     }
<a name="l10483"></a>10483                     <span class="keywordflow">case</span> 10: { <span class="comment">// Format 10: Trimmed array</span>
<a name="l10484"></a>10484                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 10; <span class="comment">// skip reserved, length and version/language</span>
<a name="l10485"></a>10485                         $startCharCode = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10486"></a>10486                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10487"></a>10487                         $numChars = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10488"></a>10488                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10489"></a>10489                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $numChars; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10490"></a>10490                             <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> + $startCharCode);
<a name="l10491"></a>10491                             $g = $this-&gt;<a class="code" href="classTCPDF.html#a7811fe029ec582174ed310d7563a876f" title="Get USHORT from string (Big Endian 16-bit unsigned integer).">_getUSHORT</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10492"></a>10492                             <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>] = $g;
<a name="l10493"></a>10493                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10494"></a>10494                         }
<a name="l10495"></a>10495                         <span class="keywordflow">break</span>;
<a name="l10496"></a>10496                     }
<a name="l10497"></a>10497                     <span class="keywordflow">case</span> 12: { <span class="comment">// Format 12: Segmented coverage</span>
<a name="l10498"></a>10498                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 10; <span class="comment">// skip length and version/language</span>
<a name="l10499"></a>10499                         $nGroups = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10500"></a>10500                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10501"></a>10501                         <span class="keywordflow">for</span> (<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> = 0; <a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a> &lt; $nGroups; ++<a class="code" href="classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff" title="Scale factor (number of points in user unit).">$k</a>) {
<a name="l10502"></a>10502                             $startCharCode = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10503"></a>10503                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10504"></a>10504                             $endCharCode = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10505"></a>10505                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10506"></a>10506                             $startGlyphCode = $this-&gt;<a class="code" href="classTCPDF.html#a22fdab26c7eeb4e1946af5050e4b52d3" title="Get ULONG from string (Big Endian 32-bit unsigned integer).">_getULONG</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10507"></a>10507                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10508"></a>10508                             <span class="keywordflow">for</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = $startCharCode; <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt;= $endCharCode; ++<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l10509"></a>10509                                 <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>] = $startGlyphCode;
<a name="l10510"></a>10510                                 ++$startGlyphCode;
<a name="l10511"></a>10511                             }
<a name="l10512"></a>10512                         }
<a name="l10513"></a>10513                         <span class="keywordflow">break</span>;
<a name="l10514"></a>10514                     }
<a name="l10515"></a>10515                     <span class="keywordflow">case</span> 13: { <span class="comment">// Format 13: Many-to-one range mappings</span>
<a name="l10516"></a>10516                         <span class="comment">// to be implemented ...</span>
<a name="l10517"></a>10517                         <span class="keywordflow">break</span>;
<a name="l10518"></a>10518                     }
<a name="l10519"></a>10519                     <span class="keywordflow">case</span> 14: { <span class="comment">// Format 14: Unicode Variation Sequences</span>
<a name="l10520"></a>10520                         <span class="comment">// to be implemented ...</span>
<a name="l10521"></a>10521                         <span class="keywordflow">break</span>;
<a name="l10522"></a>10522                     }
<a name="l10523"></a>10523                 }
<a name="l10524"></a>10524             }
<a name="l10525"></a>10525             <span class="keywordflow">if</span> (!isset(<a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[0])) {
<a name="l10526"></a>10526                 <a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[0] = 0;
<a name="l10527"></a>10527             }
<a name="l10528"></a>10528             <span class="comment">// get xHeight (height of x)</span>
<a name="l10529"></a>10529             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + $indexToLoc[<a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[120]] + 4);
<a name="l10530"></a>10530             $yMin = $this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10531"></a>10531             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10532"></a>10532             $yMax = $this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10533"></a>10533             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10534"></a>10534             $fmetric[<span class="stringliteral">&#39;XHeight&#39;</span>] = round(($yMax - $yMin) * $urk);
<a name="l10535"></a>10535             <span class="comment">// get CapHeight (height of H)</span>
<a name="l10536"></a>10536             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + $indexToLoc[<a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[72]] + 4);
<a name="l10537"></a>10537             $yMin = $this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10538"></a>10538             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10539"></a>10539             $yMax = $this-&gt;<a class="code" href="classTCPDF.html#a4908bc80a583107b7c8b3f768277e568" title="Get FWORD from string (Big Endian 16-bit signed integer).">_getFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10540"></a>10540             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10541"></a>10541             $fmetric[<span class="stringliteral">&#39;CapHeight&#39;</span>] = round(($yMax - $yMin) * $urk);
<a name="l10542"></a>10542             <span class="comment">// ceate widths array</span>
<a name="l10543"></a>10543             <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> = array();
<a name="l10544"></a>10544             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;hmtx&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10545"></a>10545             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0 ; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numberOfHMetrics; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10546"></a>10546                 <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = round($this-&gt;<a class="code" href="classTCPDF.html#a39b4ff7e526b30437ff704526801809c" title="Get UFWORD from string (Big Endian 16-bit unsigned integer).">_getUFWORD</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * $urk);
<a name="l10547"></a>10547                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip lsb</span>
<a name="l10548"></a>10548             }
<a name="l10549"></a>10549             <span class="keywordflow">if</span> ($numberOfHMetrics &lt; $numGlyphs) {
<a name="l10550"></a>10550                 <span class="comment">// fill missing widths with the last value</span>
<a name="l10551"></a>10551                 <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> = array_pad(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>, $numGlyphs, <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>[($numberOfHMetrics - 1)]);
<a name="l10552"></a>10552             }
<a name="l10553"></a>10553             $fmetric[<span class="stringliteral">&#39;MissingWidth&#39;</span>] = <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>[0];
<a name="l10554"></a>10554             $fmetric[<span class="stringliteral">&#39;cw&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l10555"></a>10555             <span class="keywordflow">for</span> ($cid = 0; $cid &lt;= 65535; ++$cid) {
<a name="l10556"></a>10556                 <span class="keywordflow">if</span> (isset(<a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[$cid]) AND isset(<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>[<a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[$cid]])) {
<a name="l10557"></a>10557                     $fmetric[<span class="stringliteral">&#39;cw&#39;</span>] .= <span class="charliteral">&#39;,&#39;</span>.$cid.<span class="stringliteral">&#39;=&gt;&#39;</span>.<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>[<a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>[$cid]];
<a name="l10558"></a>10558                 }
<a name="l10559"></a>10559             }
<a name="l10560"></a>10560         } <span class="comment">// end of true type</span>
<a name="l10561"></a>10561         <span class="keywordflow">if</span> (($fmetric[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>) AND (count(<a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>) == 256)) {
<a name="l10562"></a>10562             $fmetric[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;TrueType&#39;</span>;
<a name="l10563"></a>10563         }
<a name="l10564"></a>10564         <span class="comment">// ---------- create php font file ----------</span>
<a name="l10565"></a>10565         $pfile = <span class="charliteral">&#39;&lt;&#39;</span>.<span class="charliteral">&#39;?&#39;</span>.<span class="stringliteral">&#39;php&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10566"></a>10566         $pfile .= <span class="stringliteral">&#39;// TCPDF FONT FILE DESCRIPTION&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10567"></a>10567         $pfile .= <span class="stringliteral">&#39;$type=\&#39;&#39;</span>.$fmetric[<span class="stringliteral">&#39;type&#39;</span>].<span class="charliteral">&#39;\&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10568"></a>10568 <span class="stringliteral">        $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>=\<span class="stringliteral">&#39;&#39;</span>.$fmetric[<span class="stringliteral">&#39;name&#39;</span>].<span class="charliteral">&#39;\&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10569"></a>10569 <span class="stringliteral">        $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#a6b5ad2ac55f9df46e8f34e78fbd6f176">$up</a>=<span class="stringliteral">&#39;.$fmetric[&#39;</span>underlinePosition<span class="stringliteral">&#39;].&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10570"></a>10570 <span class="stringliteral">        $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#aadd3f841051043ee58e587e840e8dd0b">$ut</a>=<span class="stringliteral">&#39;.$fmetric[&#39;</span>underlineThickness<span class="stringliteral">&#39;].&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10571"></a>10571 <span class="stringliteral">        if ($fmetric[&#39;</span>MissingWidth<span class="stringliteral">&#39;] &gt; 0) {</span>
<a name="l10572"></a>10572 <span class="stringliteral">            $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a>=<span class="stringliteral">&#39;.$fmetric[&#39;</span>MissingWidth<span class="stringliteral">&#39;].&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10573"></a>10573 <span class="stringliteral">        } else {</span>
<a name="l10574"></a>10574 <span class="stringliteral">            $pfile .= &#39;</span>$dw=<span class="stringliteral">&#39;.$fmetric[&#39;</span>AvgWidth<span class="stringliteral">&#39;].&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10575"></a>10575 <span class="stringliteral">        }</span>
<a name="l10576"></a>10576 <span class="stringliteral">        $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a>=\<span class="stringliteral">&#39;&#39;</span>.$fmetric[<span class="stringliteral">&#39;diff&#39;</span>].<span class="charliteral">&#39;\&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10577"></a>10577 <span class="stringliteral">        if ($fmetric[&#39;</span><a class="code" href="original_2css_2theme__right_8css_8php.html#ae1d92a0cf6d4204d310bc3b8ef7ec56a">type</a><span class="stringliteral">&#39;] == &#39;</span>Type1<span class="stringliteral">&#39;) {</span>
<a name="l10578"></a>10578 <span class="stringliteral">            // Type 1</span>
<a name="l10579"></a>10579 <span class="stringliteral">            $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>=\<span class="stringliteral">&#39;&#39;</span>.$fmetric[<span class="stringliteral">&#39;enc&#39;</span>].<span class="charliteral">&#39;\&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10580"></a>10580 <span class="stringliteral">            $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>=\<span class="stringliteral">&#39;&#39;</span>.$fmetric[<span class="stringliteral">&#39;file&#39;</span>].<span class="charliteral">&#39;\&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10581"></a>10581 <span class="stringliteral">            $pfile .= &#39;</span>$size1=<span class="stringliteral">&#39;.$fmetric[&#39;</span>size1<span class="stringliteral">&#39;].&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10582"></a>10582 <span class="stringliteral">            $pfile .= &#39;</span>$size2=<span class="stringliteral">&#39;.$fmetric[&#39;</span>size2<span class="stringliteral">&#39;].&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10583"></a>10583 <span class="stringliteral">        } else {</span>
<a name="l10584"></a>10584 <span class="stringliteral">            $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#a25e8bdbc8267d6e88bc21fde74a2c0e8">$originalsize</a>=<span class="stringliteral">&#39;.$fmetric[&#39;</span>originalsize<span class="stringliteral">&#39;].&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10585"></a>10585 <span class="stringliteral">            if ($fmetric[&#39;</span><a class="code" href="original_2css_2theme__right_8css_8php.html#ae1d92a0cf6d4204d310bc3b8ef7ec56a">type</a><span class="stringliteral">&#39;] == &#39;</span>cidfont0<span class="stringliteral">&#39;) {</span>
<a name="l10586"></a>10586 <span class="stringliteral">                // CID-0</span>
<a name="l10587"></a>10587 <span class="stringliteral">                switch ($fonttype) {</span>
<a name="l10588"></a>10588 <span class="stringliteral">                    case &#39;</span>CID0JP<span class="stringliteral">&#39;: {</span>
<a name="l10589"></a>10589 <span class="stringliteral">                        $pfile .= &#39;</span><span class="comment">// Japanese&#39;.&quot;\n&quot;;</span>
<a name="l10590"></a>10590                         $pfile .= <span class="stringliteral">&#39;$enc=\&#39;UniJIS-UTF16-H\&#39;;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10591"></a>10591                         $pfile .= <span class="stringliteral">&#39;$cidinfo=array(\&#39;Registry\&#39;=&gt;\&#39;Adobe\&#39;, \&#39;Ordering\&#39;=&gt;\&#39;Japan1\&#39;,\&#39;Supplement\&#39;=&gt;5);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10592"></a>10592                         $pfile .= <span class="stringliteral">&#39;include(dirname(__FILE__).\&#39;/uni2cid_aj16.php\&#39;);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10593"></a>10593                         <span class="keywordflow">break</span>;
<a name="l10594"></a>10594                     }
<a name="l10595"></a>10595                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;CID0KR&#39;</span>: {
<a name="l10596"></a>10596                         $pfile .= <span class="stringliteral">&#39;// Korean&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10597"></a>10597                         $pfile .= <span class="stringliteral">&#39;$enc=\&#39;UniKS-UTF16-H\&#39;;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10598"></a>10598                         $pfile .= <span class="stringliteral">&#39;$cidinfo=array(\&#39;Registry\&#39;=&gt;\&#39;Adobe\&#39;, \&#39;Ordering\&#39;=&gt;\&#39;Korea1\&#39;,\&#39;Supplement\&#39;=&gt;0);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10599"></a>10599                         $pfile .= <span class="stringliteral">&#39;include(dirname(__FILE__).\&#39;/uni2cid_ak12.php\&#39;);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10600"></a>10600                         <span class="keywordflow">break</span>;
<a name="l10601"></a>10601                     }
<a name="l10602"></a>10602                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;CID0CS&#39;</span>: {
<a name="l10603"></a>10603                         $pfile .= <span class="stringliteral">&#39;// Chinese Simplified&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10604"></a>10604                         $pfile .= <span class="stringliteral">&#39;$enc=\&#39;UniGB-UTF16-H\&#39;;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10605"></a>10605                         $pfile .= <span class="stringliteral">&#39;$cidinfo=array(\&#39;Registry\&#39;=&gt;\&#39;Adobe\&#39;, \&#39;Ordering\&#39;=&gt;\&#39;GB1\&#39;,\&#39;Supplement\&#39;=&gt;2);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10606"></a>10606                         $pfile .= <span class="stringliteral">&#39;include(dirname(__FILE__).\&#39;/uni2cid_ag15.php\&#39;);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10607"></a>10607                         <span class="keywordflow">break</span>;
<a name="l10608"></a>10608                     }
<a name="l10609"></a>10609                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;CID0CT&#39;</span>:
<a name="l10610"></a>10610                     <span class="keywordflow">default</span>: {
<a name="l10611"></a>10611                         $pfile .= <span class="stringliteral">&#39;// Chinese Traditional&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10612"></a>10612                         $pfile .= <span class="stringliteral">&#39;$enc=\&#39;UniCNS-UTF16-H\&#39;;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10613"></a>10613                         $pfile .= <span class="stringliteral">&#39;$cidinfo=array(\&#39;Registry\&#39;=&gt;\&#39;Adobe\&#39;, \&#39;Ordering\&#39;=&gt;\&#39;CNS1\&#39;,\&#39;Supplement\&#39;=&gt;0);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10614"></a>10614                         $pfile .= <span class="stringliteral">&#39;include(dirname(__FILE__).\&#39;/uni2cid_aj16.php\&#39;);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10615"></a>10615                         <span class="keywordflow">break</span>;
<a name="l10616"></a>10616                     }
<a name="l10617"></a>10617                 }
<a name="l10618"></a>10618             } <span class="keywordflow">else</span> {
<a name="l10619"></a>10619                 <span class="comment">// TrueType</span>
<a name="l10620"></a>10620                 $pfile .= <span class="stringliteral">&#39;$enc=\&#39;&#39;</span>.$fmetric[<span class="stringliteral">&#39;enc&#39;</span>].<span class="charliteral">&#39;\&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10621"></a>10621 <span class="stringliteral">                $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>=\<span class="stringliteral">&#39;&#39;</span>.$fmetric[<span class="stringliteral">&#39;file&#39;</span>].<span class="charliteral">&#39;\&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10622"></a>10622 <span class="stringliteral">                $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#ab0470e5e698c60fd3a2d7c0d7fefa4e9">$ctg</a>=\<span class="stringliteral">&#39;&#39;</span>.$fmetric[<span class="stringliteral">&#39;ctg&#39;</span>].<span class="charliteral">&#39;\&#39;</span>;<span class="stringliteral">&#39;.&quot;\n&quot;;</span>
<a name="l10623"></a>10623 <span class="stringliteral">                // create CIDToGIDMap</span>
<a name="l10624"></a>10624 <span class="stringliteral">                $cidtogidmap = str_pad(&#39;</span><span class="stringliteral">&#39;, 131072, &quot;\x00&quot;); // (256 * 256 * 2) = 131072</span>
<a name="l10625"></a>10625 <span class="stringliteral">                foreach ($ctg as $cid =&gt; $gid) {</span>
<a name="l10626"></a>10626 <span class="stringliteral">                    $cidtogidmap = $this-&gt;updateCIDtoGIDmap($cidtogidmap, $cid, $ctg[$cid]);</span>
<a name="l10627"></a>10627 <span class="stringliteral">                }</span>
<a name="l10628"></a>10628 <span class="stringliteral">                // store compressed CIDToGIDMap</span>
<a name="l10629"></a>10629 <span class="stringliteral">                $fp = fopen($outpath.$fmetric[&#39;</span>ctg<span class="stringliteral">&#39;], &#39;</span>wb<span class="stringliteral">&#39;);</span>
<a name="l10630"></a>10630 <span class="stringliteral">                fwrite($fp, gzcompress($cidtogidmap));</span>
<a name="l10631"></a>10631 <span class="stringliteral">                fclose($fp);</span>
<a name="l10632"></a>10632 <span class="stringliteral">            }</span>
<a name="l10633"></a>10633 <span class="stringliteral">        }</span>
<a name="l10634"></a>10634 <span class="stringliteral">        $pfile .= &#39;</span><a class="code" href="dejavusans_8php.html#a31059b9e4d0c5af34df20da32232ea9a">$desc</a>=array(<span class="stringliteral">&#39;;</span>
<a name="l10635"></a>10635 <span class="stringliteral">        $pfile .= &#39;</span>\<span class="stringliteral">&#39;Flags\&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;Flags&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10636"></a>10636         $pfile .= <span class="charliteral">&#39;\&#39;</span>FontBBox\<span class="stringliteral">&#39;=&gt;\&#39;[&#39;</span>.$fmetric[<span class="stringliteral">&#39;bbox&#39;</span>].<span class="stringliteral">&#39;]\&#39;,&#39;</span>;
<a name="l10637"></a>10637         $pfile .= <span class="charliteral">&#39;\&#39;</span>ItalicAngle\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;italicAngle&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10638"></a>10638         $pfile .= <span class="charliteral">&#39;\&#39;</span>Ascent\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;Ascent&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10639"></a>10639         $pfile .= <span class="charliteral">&#39;\&#39;</span>Descent\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;Descent&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10640"></a>10640         $pfile .= <span class="charliteral">&#39;\&#39;</span>Leading\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;Leading&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10641"></a>10641         $pfile .= <span class="charliteral">&#39;\&#39;</span>CapHeight\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;CapHeight&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10642"></a>10642         $pfile .= <span class="charliteral">&#39;\&#39;</span>XHeight\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;XHeight&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10643"></a>10643         $pfile .= <span class="charliteral">&#39;\&#39;</span>StemV\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;StemV&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10644"></a>10644         $pfile .= <span class="charliteral">&#39;\&#39;</span>StemH\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;StemH&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10645"></a>10645         $pfile .= <span class="charliteral">&#39;\&#39;</span>AvgWidth\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;AvgWidth&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10646"></a>10646         $pfile .= <span class="charliteral">&#39;\&#39;</span>MaxWidth\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;MaxWidth&#39;</span>].<span class="charliteral">&#39;,&#39;</span>;
<a name="l10647"></a>10647         $pfile .= <span class="charliteral">&#39;\&#39;</span>MissingWidth\<span class="stringliteral">&#39;=&gt;&#39;</span>.$fmetric[<span class="stringliteral">&#39;MissingWidth&#39;</span>].<span class="stringliteral">&#39;&#39;</span>;
<a name="l10648"></a>10648         $pfile .= <span class="stringliteral">&#39;);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10649"></a>10649         $pfile .= <span class="stringliteral">&#39;$cw=array(&#39;</span>.substr($fmetric[<span class="stringliteral">&#39;cw&#39;</span>], 1).<span class="stringliteral">&#39;);&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10650"></a>10650         $pfile .= <span class="stringliteral">&#39;// --- EOF ---&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l10651"></a>10651         <span class="comment">// store file</span>
<a name="l10652"></a>10652         <a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a> = fopen($outpath.$font_name.<span class="stringliteral">&#39;.php&#39;</span>, <span class="charliteral">&#39;w&#39;</span>);
<a name="l10653"></a>10653         fwrite(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>, $pfile);
<a name="l10654"></a>10654         fclose(<a class="code" href="backup-packages_8php.html#a1d2c1369c63343a169bc25d1a0475482">$fp</a>);
<a name="l10655"></a>10655         <span class="comment">// return TCPDF font name</span>
<a name="l10656"></a>10656         <span class="keywordflow">return</span> $font_name;
<a name="l10657"></a>10657     }
<a name="l10658"></a>10658 <span class="comment"></span>
<a name="l10659"></a>10659 <span class="comment">    /**</span>
<a name="l10660"></a>10660 <span class="comment">     * Returns a subset of the TrueType font data without the unused glyphs.</span>
<a name="l10661"></a>10661 <span class="comment">     * @param $font (string) TrueType font data.</span>
<a name="l10662"></a>10662 <span class="comment">     * @param $subsetchars (array) Array of used characters (the glyphs to keep).</span>
<a name="l10663"></a>10663 <span class="comment">     * @return (string) A subset of TrueType font data without the unused glyphs.</span>
<a name="l10664"></a>10664 <span class="comment">     * @author Nicola Asuni</span>
<a name="l10665"></a>10665 <span class="comment">     * @protected</span>
<a name="l10666"></a>10666 <span class="comment">     * @since 5.2.000 (2010-06-02)</span>
<a name="l10667"></a>10667 <span class="comment">     */</span>
<a name="l10668"></a><a class="code" href="classTCPDF.html#af94fa5b364b8372c243917c5f5b06faf">10668</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af94fa5b364b8372c243917c5f5b06faf" title="Returns a subset of the TrueType font data without the unused glyphs.">_getTrueTypeFontSubset</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $subsetchars) {
<a name="l10669"></a>10669         ksort($subsetchars);
<a name="l10670"></a>10670         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0; <span class="comment">// offset position of the font data</span>
<a name="l10671"></a>10671         <span class="keywordflow">if</span> ($this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) != 0x10000) {
<a name="l10672"></a>10672             <span class="comment">// sfnt version must be 0x00010000 for TrueType version 1.0.</span>
<a name="l10673"></a>10673             <span class="keywordflow">return</span> <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l10674"></a>10674         }
<a name="l10675"></a>10675         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10676"></a>10676         <span class="comment">// get number of tables</span>
<a name="l10677"></a>10677         $numTables = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10678"></a>10678         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10679"></a>10679         <span class="comment">// skip searchRange, entrySelector and rangeShift</span>
<a name="l10680"></a>10680         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 6;
<a name="l10681"></a>10681         <span class="comment">// tables array</span>
<a name="l10682"></a>10682         <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a> = array();
<a name="l10683"></a>10683         <span class="comment">// for each table</span>
<a name="l10684"></a>10684         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numTables; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10685"></a>10685             <span class="comment">// get table info</span>
<a name="l10686"></a>10686             $tag = substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, 4);
<a name="l10687"></a>10687             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10688"></a>10688             <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag] = array();
<a name="l10689"></a>10689             <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;checkSum&#39;</span>] = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10690"></a>10690             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10691"></a>10691             <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;offset&#39;</span>] = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10692"></a>10692             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10693"></a>10693             <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;length&#39;</span>] = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10694"></a>10694             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10695"></a>10695         }
<a name="l10696"></a>10696         <span class="comment">// check magicNumber</span>
<a name="l10697"></a>10697         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;head&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + 12;
<a name="l10698"></a>10698         <span class="keywordflow">if</span> ($this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) != 0x5F0F3CF5) {
<a name="l10699"></a>10699             <span class="comment">// magicNumber must be 0x5F0F3CF5</span>
<a name="l10700"></a>10700             <span class="keywordflow">return</span> <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l10701"></a>10701         }
<a name="l10702"></a>10702         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10703"></a>10703         <span class="comment">// get offset mode (indexToLocFormat : 0 = short, 1 = long)</span>
<a name="l10704"></a>10704         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;head&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + 50;
<a name="l10705"></a>10705         $short_offset = ($this-&gt;_getSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) == 0);
<a name="l10706"></a>10706         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10707"></a>10707         <span class="comment">// get the offsets to the locations of the glyphs in the font, relative to the beginning of the glyphData table</span>
<a name="l10708"></a>10708         $indexToLoc = array();
<a name="l10709"></a>10709         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10710"></a>10710         <span class="keywordflow">if</span> ($short_offset) {
<a name="l10711"></a>10711             <span class="comment">// short version</span>
<a name="l10712"></a>10712             $tot_num_glyphs = (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] / 2); <span class="comment">// numGlyphs + 1</span>
<a name="l10713"></a>10713             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $tot_num_glyphs; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10714"></a>10714                 $indexToLoc[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) * 2;
<a name="l10715"></a>10715                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10716"></a>10716             }
<a name="l10717"></a>10717         } <span class="keywordflow">else</span> {
<a name="l10718"></a>10718             <span class="comment">// long version</span>
<a name="l10719"></a>10719             $tot_num_glyphs = (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] / 4); <span class="comment">// numGlyphs + 1</span>
<a name="l10720"></a>10720             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $tot_num_glyphs; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10721"></a>10721                 $indexToLoc[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10722"></a>10722                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10723"></a>10723             }
<a name="l10724"></a>10724         }
<a name="l10725"></a>10725         <span class="comment">// get glyphs indexes of chars from cmap table</span>
<a name="l10726"></a>10726         $subsetglyphs = array(); <span class="comment">// glyph IDs on key</span>
<a name="l10727"></a>10727         $subsetglyphs[0] = <span class="keyword">true</span>; <span class="comment">// character codes that do not correspond to any glyph in the font should be mapped to glyph index 0</span>
<a name="l10728"></a>10728         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;cmap&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + 2;
<a name="l10729"></a>10729         $numEncodingTables = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10730"></a>10730         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10731"></a>10731         $encodingTables = array();
<a name="l10732"></a>10732         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numEncodingTables; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10733"></a>10733             $encodingTables[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;platformID&#39;</span>] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10734"></a>10734             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10735"></a>10735             $encodingTables[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;encodingID&#39;</span>] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10736"></a>10736             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10737"></a>10737             $encodingTables[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;offset&#39;</span>] = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10738"></a>10738             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10739"></a>10739         }
<a name="l10740"></a>10740         <span class="keywordflow">foreach</span> ($encodingTables as $enctable) {
<a name="l10741"></a>10741             <span class="keywordflow">if</span> (($enctable[<span class="stringliteral">&#39;platformID&#39;</span>] == 3) AND ($enctable[<span class="stringliteral">&#39;encodingID&#39;</span>] == 0)) {
<a name="l10742"></a>10742                 $modesymbol = <span class="keyword">true</span>;
<a name="l10743"></a>10743             } <span class="keywordflow">else</span> {
<a name="l10744"></a>10744                 $modesymbol = <span class="keyword">false</span>;
<a name="l10745"></a>10745             }
<a name="l10746"></a>10746             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;cmap&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + $enctable[<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l10747"></a>10747             <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a> = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10748"></a>10748             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10749"></a>10749             <span class="keywordflow">switch</span> (<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>) {
<a name="l10750"></a>10750                 <span class="keywordflow">case</span> 0: { <span class="comment">// Format 0: Byte encoding table</span>
<a name="l10751"></a>10751                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip length and version/language</span>
<a name="l10752"></a>10752                     <span class="keywordflow">for</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = 0; <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt; 256; ++<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l10753"></a>10753                         <span class="keywordflow">if</span> (isset($subsetchars[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>])) {
<a name="l10754"></a>10754                             $g = $this-&gt;_getBYTE(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10755"></a>10755                             $subsetglyphs[$g] = <span class="keyword">true</span>;
<a name="l10756"></a>10756                         }
<a name="l10757"></a>10757                         ++<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>;
<a name="l10758"></a>10758                     }
<a name="l10759"></a>10759                     <span class="keywordflow">break</span>;
<a name="l10760"></a>10760                 }
<a name="l10761"></a>10761                 <span class="keywordflow">case</span> 2: { <span class="comment">// Format 2: High-byte mapping through table</span>
<a name="l10762"></a>10762                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip length and version/language</span>
<a name="l10763"></a>10763                     $numSubHeaders = 0;
<a name="l10764"></a>10764                     <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 256; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10765"></a>10765                         <span class="comment">// Array that maps high bytes to subHeaders: value is subHeader index * 8.</span>
<a name="l10766"></a>10766                         $subHeaderKeys[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = ($this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) / 8);
<a name="l10767"></a>10767                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10768"></a>10768                         <span class="keywordflow">if</span> ($numSubHeaders &lt; $subHeaderKeys[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) {
<a name="l10769"></a>10769                             $numSubHeaders = $subHeaderKeys[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l10770"></a>10770                         }
<a name="l10771"></a>10771                     }
<a name="l10772"></a>10772                     <span class="comment">// the number of subHeaders is equal to the max of subHeaderKeys + 1</span>
<a name="l10773"></a>10773                     ++$numSubHeaders;
<a name="l10774"></a>10774                     <span class="comment">// read subHeader structures</span>
<a name="l10775"></a>10775                     $subHeaders = array();
<a name="l10776"></a>10776                     $numGlyphIndexArray = 0;
<a name="l10777"></a>10777                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $numSubHeaders; ++$k) {
<a name="l10778"></a>10778                         $subHeaders[$k][<span class="stringliteral">&#39;firstCode&#39;</span>] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10779"></a>10779                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10780"></a>10780                         $subHeaders[$k][<span class="stringliteral">&#39;entryCount&#39;</span>] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10781"></a>10781                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10782"></a>10782                         $subHeaders[$k][<span class="stringliteral">&#39;idDelta&#39;</span>] = $this-&gt;_getSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10783"></a>10783                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10784"></a>10784                         $subHeaders[$k][<span class="stringliteral">&#39;idRangeOffset&#39;</span>] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10785"></a>10785                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10786"></a>10786                         $subHeaders[$k][<span class="stringliteral">&#39;idRangeOffset&#39;</span>] -= (2 + (($numSubHeaders - $k - 1) * 8));
<a name="l10787"></a>10787                         $subHeaders[$k][<span class="stringliteral">&#39;idRangeOffset&#39;</span>] /= 2;
<a name="l10788"></a>10788                         $numGlyphIndexArray += $subHeaders[$k][<span class="stringliteral">&#39;entryCount&#39;</span>];
<a name="l10789"></a>10789                     }
<a name="l10790"></a>10790                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $numGlyphIndexArray; ++$k) {
<a name="l10791"></a>10791                         $glyphIndexArray[$k] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10792"></a>10792                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10793"></a>10793                     }
<a name="l10794"></a>10794                     <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 256; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10795"></a>10795                         $k = $subHeaderKeys[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l10796"></a>10796                         <span class="keywordflow">if</span> ($k == 0) {
<a name="l10797"></a>10797                             <span class="comment">// one byte code</span>
<a name="l10798"></a>10798                             <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l10799"></a>10799                             <span class="keywordflow">if</span> (isset($subsetchars[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>])) {
<a name="l10800"></a>10800                                 $g = $glyphIndexArray[0];
<a name="l10801"></a>10801                                 $subsetglyphs[$g] = <span class="keyword">true</span>;
<a name="l10802"></a>10802                             }
<a name="l10803"></a>10803                         } <span class="keywordflow">else</span> {
<a name="l10804"></a>10804                             <span class="comment">// two bytes code</span>
<a name="l10805"></a>10805                             $start_byte = $subHeaders[$k][<span class="stringliteral">&#39;firstCode&#39;</span>];
<a name="l10806"></a>10806                             $end_byte = $start_byte + $subHeaders[$k][<span class="stringliteral">&#39;entryCount&#39;</span>];
<a name="l10807"></a>10807                             <span class="keywordflow">for</span> ($j = $start_byte; $j &lt; $end_byte; ++$j) {
<a name="l10808"></a>10808                                 <span class="comment">// combine high and low bytes</span>
<a name="l10809"></a>10809                                 <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = ((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;&lt; 8) + $j);
<a name="l10810"></a>10810                                 <span class="keywordflow">if</span> (isset($subsetchars[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>])) {
<a name="l10811"></a>10811                                     $idRangeOffset = ($subHeaders[$k][<span class="stringliteral">&#39;idRangeOffset&#39;</span>] + $j - $subHeaders[$k][<span class="stringliteral">&#39;firstCode&#39;</span>]);
<a name="l10812"></a>10812                                     $g = $glyphIndexArray[$idRangeOffset];
<a name="l10813"></a>10813                                     $g += ($idDelta[$k] - 65536);
<a name="l10814"></a>10814                                     <span class="keywordflow">if</span> ($g &lt; 0) {
<a name="l10815"></a>10815                                         $g = 0;
<a name="l10816"></a>10816                                     }
<a name="l10817"></a>10817                                     $subsetglyphs[$g] = <span class="keyword">true</span>;
<a name="l10818"></a>10818                                 }
<a name="l10819"></a>10819                             }
<a name="l10820"></a>10820                         }
<a name="l10821"></a>10821                     }
<a name="l10822"></a>10822                     <span class="keywordflow">break</span>;
<a name="l10823"></a>10823                 }
<a name="l10824"></a>10824                 <span class="keywordflow">case</span> 4: { <span class="comment">// Format 4: Segment mapping to delta values</span>
<a name="l10825"></a>10825                     $length = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10826"></a>10826                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10827"></a>10827                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2; <span class="comment">// skip version/language</span>
<a name="l10828"></a>10828                     $segCount = ($this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) / 2);
<a name="l10829"></a>10829                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10830"></a>10830                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 6; <span class="comment">// skip searchRange, entrySelector, rangeShift</span>
<a name="l10831"></a>10831                     $endCount = array(); <span class="comment">// array of end character codes for each segment</span>
<a name="l10832"></a>10832                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $segCount; ++$k) {
<a name="l10833"></a>10833                         $endCount[$k] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10834"></a>10834                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10835"></a>10835                     }
<a name="l10836"></a>10836                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2; <span class="comment">// skip reservedPad</span>
<a name="l10837"></a>10837                     $startCount = array(); <span class="comment">// array of start character codes for each segment</span>
<a name="l10838"></a>10838                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $segCount; ++$k) {
<a name="l10839"></a>10839                         $startCount[$k] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10840"></a>10840                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10841"></a>10841                     }
<a name="l10842"></a>10842                     $idDelta = array(); <span class="comment">// delta for all character codes in segment</span>
<a name="l10843"></a>10843                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $segCount; ++$k) {
<a name="l10844"></a>10844                         $idDelta[$k] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10845"></a>10845                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10846"></a>10846                     }
<a name="l10847"></a>10847                     $idRangeOffset = array(); <span class="comment">// Offsets into glyphIdArray or 0</span>
<a name="l10848"></a>10848                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $segCount; ++$k) {
<a name="l10849"></a>10849                         $idRangeOffset[$k] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10850"></a>10850                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10851"></a>10851                     }
<a name="l10852"></a>10852                     $gidlen = ($length / 2) - 8 - (4 * $segCount);
<a name="l10853"></a>10853                     $glyphIdArray = array(); <span class="comment">// glyph index array</span>
<a name="l10854"></a>10854                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $gidlen; ++$k) {
<a name="l10855"></a>10855                         $glyphIdArray[$k] = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10856"></a>10856                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10857"></a>10857                     }
<a name="l10858"></a>10858                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $segCount; ++$k) {
<a name="l10859"></a>10859                         <span class="keywordflow">for</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = $startCount[$k]; <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt;= $endCount[$k]; ++<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l10860"></a>10860                             <span class="keywordflow">if</span> (isset($subsetchars[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>])) {
<a name="l10861"></a>10861                                 <span class="keywordflow">if</span> ($idRangeOffset[$k] == 0) {
<a name="l10862"></a>10862                                     $g = <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>;
<a name="l10863"></a>10863                                 } <span class="keywordflow">else</span> {
<a name="l10864"></a>10864                                     $gid = (($idRangeOffset[$k] / 2) + ($c - $startCount[$k]) - ($segCount - $k));
<a name="l10865"></a>10865                                     $g = $glyphIdArray[$gid];
<a name="l10866"></a>10866                                 }
<a name="l10867"></a>10867                                 $g += ($idDelta[$k] - 65536);
<a name="l10868"></a>10868                                 <span class="keywordflow">if</span> ($g &lt; 0) {
<a name="l10869"></a>10869                                     $g = 0;
<a name="l10870"></a>10870                                 }
<a name="l10871"></a>10871                                 $subsetglyphs[$g] = <span class="keyword">true</span>;
<a name="l10872"></a>10872                             }
<a name="l10873"></a>10873                         }
<a name="l10874"></a>10874                     }
<a name="l10875"></a>10875                     <span class="keywordflow">break</span>;
<a name="l10876"></a>10876                 }
<a name="l10877"></a>10877                 <span class="keywordflow">case</span> 6: { <span class="comment">// Format 6: Trimmed table mapping</span>
<a name="l10878"></a>10878                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4; <span class="comment">// skip length and version/language</span>
<a name="l10879"></a>10879                     $firstCode = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10880"></a>10880                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10881"></a>10881                     $entryCount = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10882"></a>10882                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10883"></a>10883                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $entryCount; ++$k) {
<a name="l10884"></a>10884                         <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = ($k + $firstCode);
<a name="l10885"></a>10885                         <span class="keywordflow">if</span> (isset($subsetchars[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>])) {
<a name="l10886"></a>10886                             $g = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10887"></a>10887                             $subsetglyphs[$g] = <span class="keyword">true</span>;
<a name="l10888"></a>10888                         }
<a name="l10889"></a>10889                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10890"></a>10890                     }
<a name="l10891"></a>10891                     <span class="keywordflow">break</span>;
<a name="l10892"></a>10892                 }
<a name="l10893"></a>10893                 <span class="keywordflow">case</span> 8: { <span class="comment">// Format 8: Mixed 16-bit and 32-bit coverage</span>
<a name="l10894"></a>10894                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 10; <span class="comment">// skip reserved, length and version/language</span>
<a name="l10895"></a>10895                     <span class="keywordflow">for</span> ($k = 0; $k &lt; 8192; ++$k) {
<a name="l10896"></a>10896                         $is32[$k] = $this-&gt;_getBYTE(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10897"></a>10897                         ++<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>;
<a name="l10898"></a>10898                     }
<a name="l10899"></a>10899                     $nGroups = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10900"></a>10900                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10901"></a>10901                     <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $nGroups; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l10902"></a>10902                         $startCharCode = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10903"></a>10903                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10904"></a>10904                         $endCharCode = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10905"></a>10905                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10906"></a>10906                         $startGlyphID = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10907"></a>10907                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10908"></a>10908                         <span class="keywordflow">for</span> ($k = $startCharCode; $k &lt;= $endCharCode; ++$k) {
<a name="l10909"></a>10909                             $is32idx = floor(<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> / 8);
<a name="l10910"></a>10910                             <span class="keywordflow">if</span> ((isset($is32[$is32idx])) AND (($is32[$is32idx] &amp; (1 &lt;&lt; (7 - (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> % 8)))) == 0)) {
<a name="l10911"></a>10911                                 <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = $k;
<a name="l10912"></a>10912                             } <span class="keywordflow">else</span> {
<a name="l10913"></a>10913                                 <span class="comment">// 32 bit format</span>
<a name="l10914"></a>10914                                 <span class="comment">// convert to decimal (http://www.unicode.org/faq//utf_bom.html#utf16-4)</span>
<a name="l10915"></a>10915                                 <span class="comment">//LEAD_OFFSET = (0xD800 - (0x10000 &gt;&gt; 10)) = 55232</span>
<a name="l10916"></a>10916                                 <span class="comment">//SURROGATE_OFFSET = (0x10000 - (0xD800 &lt;&lt; 10) - 0xDC00) = -56613888</span>
<a name="l10917"></a>10917                                 <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = ((55232 + ($k &gt;&gt; 10)) &lt;&lt; 10) + (0xDC00 + ($k &amp; 0x3FF)) -56613888;
<a name="l10918"></a>10918                             }
<a name="l10919"></a>10919                             <span class="keywordflow">if</span> (isset($subsetchars[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>])) {
<a name="l10920"></a>10920                                 $subsetglyphs[$startGlyphID] = <span class="keyword">true</span>;
<a name="l10921"></a>10921                             }
<a name="l10922"></a>10922                             ++$startGlyphID;
<a name="l10923"></a>10923                         }
<a name="l10924"></a>10924                     }
<a name="l10925"></a>10925                     <span class="keywordflow">break</span>;
<a name="l10926"></a>10926                 }
<a name="l10927"></a>10927                 <span class="keywordflow">case</span> 10: { <span class="comment">// Format 10: Trimmed array</span>
<a name="l10928"></a>10928                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 10; <span class="comment">// skip reserved, length and version/language</span>
<a name="l10929"></a>10929                     $startCharCode = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10930"></a>10930                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10931"></a>10931                     $numChars = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10932"></a>10932                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10933"></a>10933                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $numChars; ++$k) {
<a name="l10934"></a>10934                         <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = ($k + $startCharCode);
<a name="l10935"></a>10935                         <span class="keywordflow">if</span> (isset($subsetchars[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>])) {
<a name="l10936"></a>10936                             $g = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10937"></a>10937                             $subsetglyphs[$g] = <span class="keyword">true</span>;
<a name="l10938"></a>10938                         }
<a name="l10939"></a>10939                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10940"></a>10940                     }
<a name="l10941"></a>10941                     <span class="keywordflow">break</span>;
<a name="l10942"></a>10942                 }
<a name="l10943"></a>10943                 <span class="keywordflow">case</span> 12: { <span class="comment">// Format 12: Segmented coverage</span>
<a name="l10944"></a>10944                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 10; <span class="comment">// skip length and version/language</span>
<a name="l10945"></a>10945                     $nGroups = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10946"></a>10946                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10947"></a>10947                     <span class="keywordflow">for</span> ($k = 0; $k &lt; $nGroups; ++$k) {
<a name="l10948"></a>10948                         $startCharCode = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10949"></a>10949                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10950"></a>10950                         $endCharCode = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10951"></a>10951                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10952"></a>10952                         $startGlyphCode = $this-&gt;_getULONG(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10953"></a>10953                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10954"></a>10954                         <span class="keywordflow">for</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = $startCharCode; <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt;= $endCharCode; ++<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l10955"></a>10955                             <span class="keywordflow">if</span> (isset($subsetchars[<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>])) {
<a name="l10956"></a>10956                                 $subsetglyphs[$startGlyphCode] = <span class="keyword">true</span>;
<a name="l10957"></a>10957                             }
<a name="l10958"></a>10958                             ++$startGlyphCode;
<a name="l10959"></a>10959                         }
<a name="l10960"></a>10960                     }
<a name="l10961"></a>10961                     <span class="keywordflow">break</span>;
<a name="l10962"></a>10962                 }
<a name="l10963"></a>10963                 <span class="keywordflow">case</span> 13: { <span class="comment">// Format 13: Many-to-one range mappings</span>
<a name="l10964"></a>10964                     <span class="comment">// to be implemented ...</span>
<a name="l10965"></a>10965                     <span class="keywordflow">break</span>;
<a name="l10966"></a>10966                 }
<a name="l10967"></a>10967                 <span class="keywordflow">case</span> 14: { <span class="comment">// Format 14: Unicode Variation Sequences</span>
<a name="l10968"></a>10968                     <span class="comment">// to be implemented ...</span>
<a name="l10969"></a>10969                     <span class="keywordflow">break</span>;
<a name="l10970"></a>10970                 }
<a name="l10971"></a>10971             }
<a name="l10972"></a>10972         }
<a name="l10973"></a>10973         <span class="comment">// include all parts of composite glyphs</span>
<a name="l10974"></a>10974         $new_sga = $subsetglyphs;
<a name="l10975"></a>10975         <span class="keywordflow">while</span> (!empty($new_sga)) {
<a name="l10976"></a>10976             $sga = $new_sga;
<a name="l10977"></a>10977             $new_sga = array();
<a name="l10978"></a>10978             <span class="keywordflow">foreach</span> ($sga as $key =&gt; $val) {
<a name="l10979"></a>10979                 <span class="keywordflow">if</span> (isset($indexToLoc[$key])) {
<a name="l10980"></a>10980                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + $indexToLoc[$key]);
<a name="l10981"></a>10981                     $numberOfContours = $this-&gt;_getSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10982"></a>10982                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10983"></a>10983                     <span class="keywordflow">if</span> ($numberOfContours &lt; 0) { <span class="comment">// composite glyph</span>
<a name="l10984"></a>10984                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 8; <span class="comment">// skip xMin, yMin, xMax, yMax</span>
<a name="l10985"></a>10985                         <span class="keywordflow">do</span> {
<a name="l10986"></a>10986                             $flags = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10987"></a>10987                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10988"></a>10988                             $glyphIndex = $this-&gt;_getUSHORT(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l10989"></a>10989                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10990"></a>10990                             <span class="keywordflow">if</span> (!isset($subsetglyphs[$glyphIndex])) {
<a name="l10991"></a>10991                                 <span class="comment">// add missing glyphs</span>
<a name="l10992"></a>10992                                 $new_sga[$glyphIndex] = <span class="keyword">true</span>;
<a name="l10993"></a>10993                             }
<a name="l10994"></a>10994                             <span class="comment">// skip some bytes by case</span>
<a name="l10995"></a>10995                             <span class="keywordflow">if</span> ($flags &amp; 1) {
<a name="l10996"></a>10996                                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l10997"></a>10997                             } <span class="keywordflow">else</span> {
<a name="l10998"></a>10998                                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l10999"></a>10999                             }
<a name="l11000"></a>11000                             <span class="keywordflow">if</span> ($flags &amp; 8) {
<a name="l11001"></a>11001                                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 2;
<a name="l11002"></a>11002                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($flags &amp; 64) {
<a name="l11003"></a>11003                                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l11004"></a>11004                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($flags &amp; 128) {
<a name="l11005"></a>11005                                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 8;
<a name="l11006"></a>11006                             }
<a name="l11007"></a>11007                         } <span class="keywordflow">while</span> ($flags &amp; 32);
<a name="l11008"></a>11008                     }
<a name="l11009"></a>11009                 }
<a name="l11010"></a>11010             }
<a name="l11011"></a>11011             $subsetglyphs += $new_sga;
<a name="l11012"></a>11012         }
<a name="l11013"></a>11013         <span class="comment">// sort glyphs by key (and remove duplicates)</span>
<a name="l11014"></a>11014         ksort($subsetglyphs);
<a name="l11015"></a>11015         <span class="comment">// build new glyf and loca tables</span>
<a name="l11016"></a>11016         $glyf = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11017"></a>11017         $loca = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11018"></a>11018         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0;
<a name="l11019"></a>11019         $glyf_offset = <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l11020"></a>11020         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $tot_num_glyphs; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l11021"></a>11021             <span class="keywordflow">if</span> (isset($subsetglyphs[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>])) {
<a name="l11022"></a>11022                 $length = ($indexToLoc[($i + 1)] - $indexToLoc[$i]);
<a name="l11023"></a>11023                 $glyf .= substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, ($glyf_offset + $indexToLoc[$i]), $length);
<a name="l11024"></a>11024             } <span class="keywordflow">else</span> {
<a name="l11025"></a>11025                 $length = 0;
<a name="l11026"></a>11026             }
<a name="l11027"></a>11027             <span class="keywordflow">if</span> ($short_offset) {
<a name="l11028"></a>11028                 $loca .= pack(<span class="charliteral">&#39;n&#39;</span>, (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> / 2));
<a name="l11029"></a>11029             } <span class="keywordflow">else</span> {
<a name="l11030"></a>11030                 $loca .= pack(<span class="charliteral">&#39;N&#39;</span>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l11031"></a>11031             }
<a name="l11032"></a>11032             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += $length;
<a name="l11033"></a>11033         }
<a name="l11034"></a>11034         <span class="comment">// array of table names to preserve (loca and glyf tables will be added later)</span>
<a name="l11035"></a>11035         <span class="comment">// the cmap table is not needed and shall not be present, since the mapping from character codes to glyph descriptions is provided separately</span>
<a name="l11036"></a>11036         $table_names = array (<span class="stringliteral">&#39;head&#39;</span>, <span class="stringliteral">&#39;hhea&#39;</span>, <span class="stringliteral">&#39;hmtx&#39;</span>, <span class="stringliteral">&#39;maxp&#39;</span>, <span class="stringliteral">&#39;cvt &#39;</span>, <span class="stringliteral">&#39;fpgm&#39;</span>, <span class="stringliteral">&#39;prep&#39;</span>); <span class="comment">// minimum required table names</span>
<a name="l11037"></a>11037         <span class="comment">// get the tables to preserve</span>
<a name="l11038"></a>11038         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 12;
<a name="l11039"></a>11039         <span class="keywordflow">foreach</span> (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a> as $tag =&gt; $val) {
<a name="l11040"></a>11040             <span class="keywordflow">if</span> (in_array($tag, $table_names)) {
<a name="l11041"></a>11041                 <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;data&#39;</span>] = substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;offset&#39;</span>], <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;length&#39;</span>]);
<a name="l11042"></a>11042                 <span class="keywordflow">if</span> ($tag == <span class="stringliteral">&#39;head&#39;</span>) {
<a name="l11043"></a>11043                     <span class="comment">// set the checkSumAdjustment to 0</span>
<a name="l11044"></a>11044                     <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;data&#39;</span>] = substr(<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;data&#39;</span>], 0, 8).<span class="stringliteral">&quot;\x0\x0\x0\x0&quot;</span>.substr(<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;data&#39;</span>], 12);
<a name="l11045"></a>11045                 }
<a name="l11046"></a>11046                 $pad = 4 - (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;length&#39;</span>] % 4);
<a name="l11047"></a>11047                 <span class="keywordflow">if</span> ($pad != 4) {
<a name="l11048"></a>11048                     <span class="comment">// the length of a table must be a multiple of four bytes</span>
<a name="l11049"></a>11049                     <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;length&#39;</span>] += $pad;
<a name="l11050"></a>11050                     <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;data&#39;</span>] .= str_repeat(<span class="stringliteral">&quot;\x0&quot;</span>, $pad);
<a name="l11051"></a>11051                 }
<a name="l11052"></a>11052                 <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;offset&#39;</span>] = <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>;
<a name="l11053"></a>11053                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag][<span class="stringliteral">&#39;length&#39;</span>];
<a name="l11054"></a>11054                 <span class="comment">// check sum is not changed (so keep the following line commented)</span>
<a name="l11055"></a>11055                 <span class="comment">//$table[$tag][&#39;checkSum&#39;] = $this-&gt;_getTTFtableChecksum($table[$tag][&#39;data&#39;], $table[$tag][&#39;length&#39;]);</span>
<a name="l11056"></a>11056             } <span class="keywordflow">else</span> {
<a name="l11057"></a>11057                 unset(<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[$tag]);
<a name="l11058"></a>11058             }
<a name="l11059"></a>11059         }
<a name="l11060"></a>11060         <span class="comment">// add loca</span>
<a name="l11061"></a>11061         <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;data&#39;</span>] = $loca;
<a name="l11062"></a>11062         <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] = strlen($loca);
<a name="l11063"></a>11063         $pad = 4 - (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] % 4);
<a name="l11064"></a>11064         <span class="keywordflow">if</span> ($pad != 4) {
<a name="l11065"></a>11065             <span class="comment">// the length of a table must be a multiple of four bytes</span>
<a name="l11066"></a>11066             <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] += $pad;
<a name="l11067"></a>11067             <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;data&#39;</span>] .= str_repeat(<span class="stringliteral">&quot;\x0&quot;</span>, $pad);
<a name="l11068"></a>11068         }
<a name="l11069"></a>11069         <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] = <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>;
<a name="l11070"></a>11070         <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;checkSum&#39;</span>] = $this-&gt;_getTTFtableChecksum(<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;data&#39;</span>], <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>]);
<a name="l11071"></a>11071         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;loca&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>];
<a name="l11072"></a>11072         <span class="comment">// add glyf</span>
<a name="l11073"></a>11073         <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;data&#39;</span>] = $glyf;
<a name="l11074"></a>11074         <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] = strlen($glyf);
<a name="l11075"></a>11075         $pad = 4 - (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] % 4);
<a name="l11076"></a>11076         <span class="keywordflow">if</span> ($pad != 4) {
<a name="l11077"></a>11077             <span class="comment">// the length of a table must be a multiple of four bytes</span>
<a name="l11078"></a>11078             <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>] += $pad;
<a name="l11079"></a>11079             <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;data&#39;</span>] .= str_repeat(<span class="stringliteral">&quot;\x0&quot;</span>, $pad);
<a name="l11080"></a>11080         }
<a name="l11081"></a>11081         <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] = <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>;
<a name="l11082"></a>11082         <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;checkSum&#39;</span>] = $this-&gt;_getTTFtableChecksum(<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;data&#39;</span>], <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;glyf&#39;</span>][<span class="stringliteral">&#39;length&#39;</span>]);
<a name="l11083"></a>11083         <span class="comment">// rebuild font</span>
<a name="l11084"></a>11084         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11085"></a>11085         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= pack(<span class="charliteral">&#39;N&#39;</span>, 0x10000); <span class="comment">// sfnt version</span>
<a name="l11086"></a>11086         $numTables = count(<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>);
<a name="l11087"></a>11087         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= pack(<span class="charliteral">&#39;n&#39;</span>, $numTables); <span class="comment">// numTables</span>
<a name="l11088"></a>11088         $entrySelector = floor(log($numTables, 2));
<a name="l11089"></a>11089         $searchRange = pow(2, $entrySelector) * 16;
<a name="l11090"></a>11090         $rangeShift = ($numTables * 16) - $searchRange;
<a name="l11091"></a>11091         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= pack(<span class="charliteral">&#39;n&#39;</span>, $searchRange); <span class="comment">// searchRange</span>
<a name="l11092"></a>11092         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= pack(<span class="charliteral">&#39;n&#39;</span>, $entrySelector); <span class="comment">// entrySelector</span>
<a name="l11093"></a>11093         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= pack(<span class="charliteral">&#39;n&#39;</span>, $rangeShift); <span class="comment">// rangeShift</span>
<a name="l11094"></a>11094         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = ($numTables * 16);
<a name="l11095"></a>11095         <span class="keywordflow">foreach</span> (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a> as $tag =&gt; <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l11096"></a>11096             <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= $tag; <span class="comment">// tag</span>
<a name="l11097"></a>11097             <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= pack(<span class="charliteral">&#39;N&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;checkSum&#39;</span>]); <span class="comment">// checkSum</span>
<a name="l11098"></a>11098             <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= pack(<span class="charliteral">&#39;N&#39;</span>, (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;offset&#39;</span>] + <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>)); <span class="comment">// offset</span>
<a name="l11099"></a>11099             <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= pack(<span class="charliteral">&#39;N&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;length&#39;</span>]); <span class="comment">// length</span>
<a name="l11100"></a>11100         }
<a name="l11101"></a>11101         <span class="keywordflow">foreach</span> (<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a> as <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l11102"></a>11102             <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> .= $data[<span class="stringliteral">&#39;data&#39;</span>];
<a name="l11103"></a>11103         }
<a name="l11104"></a>11104         <span class="comment">// set checkSumAdjustment on head table</span>
<a name="l11105"></a>11105         $checkSumAdjustment = 0xB1B0AFBA - $this-&gt;_getTTFtableChecksum(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, strlen(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>));
<a name="l11106"></a>11106         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, 0, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;head&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + 8).pack(<span class="charliteral">&#39;N&#39;</span>, $checkSumAdjustment).substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>[<span class="stringliteral">&#39;head&#39;</span>][<span class="stringliteral">&#39;offset&#39;</span>] + 12);
<a name="l11107"></a>11107         <span class="keywordflow">return</span> <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l11108"></a>11108     }
<a name="l11109"></a>11109 <span class="comment"></span>
<a name="l11110"></a>11110 <span class="comment">    /**</span>
<a name="l11111"></a>11111 <span class="comment">     * Returs the checksum of a TTF table.</span>
<a name="l11112"></a>11112 <span class="comment">     * @param $table (string) table to check</span>
<a name="l11113"></a>11113 <span class="comment">     * @param $length (int) length of table in bytes</span>
<a name="l11114"></a>11114 <span class="comment">     * @return int checksum</span>
<a name="l11115"></a>11115 <span class="comment">     * @author Nicola Asuni</span>
<a name="l11116"></a>11116 <span class="comment">     * @protected</span>
<a name="l11117"></a>11117 <span class="comment">     * @since 5.2.000 (2010-06-02)</span>
<a name="l11118"></a>11118 <span class="comment">     */</span>
<a name="l11119"></a><a class="code" href="classTCPDF.html#a67db073f4f27b1dcb5e44a24ed9768b8">11119</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a67db073f4f27b1dcb5e44a24ed9768b8" title="Returs the checksum of a TTF table.">_getTTFtableChecksum</a>(<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>, $length) {
<a name="l11120"></a>11120         $sum = 0;
<a name="l11121"></a>11121         $tlen = ($length / 4);
<a name="l11122"></a>11122         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0;
<a name="l11123"></a>11123         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $tlen; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l11124"></a>11124             $v = unpack(<span class="stringliteral">&#39;Ni&#39;</span>, substr(<a class="code" href="pmd__display__field_8php.html#ae8876a14058f368335baccf35af4a22b">$table</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, 4));
<a name="l11125"></a>11125             $sum += $v[<span class="charliteral">&#39;i&#39;</span>];
<a name="l11126"></a>11126             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> += 4;
<a name="l11127"></a>11127         }
<a name="l11128"></a>11128         $sum = unpack(<span class="stringliteral">&#39;Ni&#39;</span>, pack(<span class="charliteral">&#39;N&#39;</span>, $sum));
<a name="l11129"></a>11129         <span class="keywordflow">return</span> $sum[<span class="charliteral">&#39;i&#39;</span>];
<a name="l11130"></a>11130     }
<a name="l11131"></a>11131 <span class="comment"></span>
<a name="l11132"></a>11132 <span class="comment">    /**</span>
<a name="l11133"></a>11133 <span class="comment">     * Outputs font widths</span>
<a name="l11134"></a>11134 <span class="comment">     * @param $font (array) font data</span>
<a name="l11135"></a>11135 <span class="comment">     * @param $cidoffset (int) offset for CID values</span>
<a name="l11136"></a>11136 <span class="comment">     * @return PDF command string for font widths</span>
<a name="l11137"></a>11137 <span class="comment">     * @author Nicola Asuni</span>
<a name="l11138"></a>11138 <span class="comment">     * @protected</span>
<a name="l11139"></a>11139 <span class="comment">     * @since 4.4.000 (2008-12-07)</span>
<a name="l11140"></a>11140 <span class="comment">     */</span>
<a name="l11141"></a><a class="code" href="classTCPDF.html#a9e311115c805fb8a9d37931a83714053">11141</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9e311115c805fb8a9d37931a83714053" title="Outputs font widths.">_putfontwidths</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $cidoffset=0) {
<a name="l11142"></a>11142         ksort(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;cw&#39;</span>]);
<a name="l11143"></a>11143         $rangeid = 0;
<a name="l11144"></a>11144         $range = array();
<a name="l11145"></a>11145         $prevcid = -2;
<a name="l11146"></a>11146         $prevwidth = -1;
<a name="l11147"></a>11147         $interval = <span class="keyword">false</span>;
<a name="l11148"></a>11148         <span class="comment">// for each character</span>
<a name="l11149"></a>11149         <span class="keywordflow">foreach</span> (<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;cw&#39;</span>] as $cid =&gt; $width) {
<a name="l11150"></a>11150             $cid -= $cidoffset;
<a name="l11151"></a>11151             <span class="keywordflow">if</span> (<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;subset&#39;</span>] AND ($cid &gt; 255) AND (!isset(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;subsetchars&#39;</span>][$cid]))) {
<a name="l11152"></a>11152                 <span class="comment">// ignore the unused characters (font subsetting)</span>
<a name="l11153"></a>11153                 <span class="keywordflow">continue</span>;
<a name="l11154"></a>11154             }
<a name="l11155"></a>11155             <span class="keywordflow">if</span> ($width != <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;dw&#39;</span>]) {
<a name="l11156"></a>11156                 <span class="keywordflow">if</span> ($cid == ($prevcid + 1)) {
<a name="l11157"></a>11157                     <span class="comment">// consecutive CID</span>
<a name="l11158"></a>11158                     <span class="keywordflow">if</span> ($width == $prevwidth) {
<a name="l11159"></a>11159                         <span class="keywordflow">if</span> ($width == $range[$rangeid][0]) {
<a name="l11160"></a>11160                             $range[$rangeid][] = $width;
<a name="l11161"></a>11161                         } <span class="keywordflow">else</span> {
<a name="l11162"></a>11162                             array_pop($range[$rangeid]);
<a name="l11163"></a>11163                             <span class="comment">// new range</span>
<a name="l11164"></a>11164                             $rangeid = $prevcid;
<a name="l11165"></a>11165                             $range[$rangeid] = array();
<a name="l11166"></a>11166                             $range[$rangeid][] = $prevwidth;
<a name="l11167"></a>11167                             $range[$rangeid][] = $width;
<a name="l11168"></a>11168                         }
<a name="l11169"></a>11169                         $interval = <span class="keyword">true</span>;
<a name="l11170"></a>11170                         $range[$rangeid][<span class="stringliteral">&#39;interval&#39;</span>] = <span class="keyword">true</span>;
<a name="l11171"></a>11171                     } <span class="keywordflow">else</span> {
<a name="l11172"></a>11172                         <span class="keywordflow">if</span> ($interval) {
<a name="l11173"></a>11173                             <span class="comment">// new range</span>
<a name="l11174"></a>11174                             $rangeid = $cid;
<a name="l11175"></a>11175                             $range[$rangeid] = array();
<a name="l11176"></a>11176                             $range[$rangeid][] = $width;
<a name="l11177"></a>11177                         } <span class="keywordflow">else</span> {
<a name="l11178"></a>11178                             $range[$rangeid][] = $width;
<a name="l11179"></a>11179                         }
<a name="l11180"></a>11180                         $interval = <span class="keyword">false</span>;
<a name="l11181"></a>11181                     }
<a name="l11182"></a>11182                 } <span class="keywordflow">else</span> {
<a name="l11183"></a>11183                     <span class="comment">// new range</span>
<a name="l11184"></a>11184                     $rangeid = $cid;
<a name="l11185"></a>11185                     $range[$rangeid] = array();
<a name="l11186"></a>11186                     $range[$rangeid][] = $width;
<a name="l11187"></a>11187                     $interval = <span class="keyword">false</span>;
<a name="l11188"></a>11188                 }
<a name="l11189"></a>11189                 $prevcid = $cid;
<a name="l11190"></a>11190                 $prevwidth = $width;
<a name="l11191"></a>11191             }
<a name="l11192"></a>11192         }
<a name="l11193"></a>11193         <span class="comment">// optimize ranges</span>
<a name="l11194"></a>11194         $prevk = -1;
<a name="l11195"></a>11195         $nextk = -1;
<a name="l11196"></a>11196         $prevint = <span class="keyword">false</span>;
<a name="l11197"></a>11197         <span class="keywordflow">foreach</span> ($range as $k =&gt; $ws) {
<a name="l11198"></a>11198             $cws = count($ws);
<a name="l11199"></a>11199             <span class="keywordflow">if</span> (($k == $nextk) AND (!$prevint) AND ((!isset($ws[<span class="stringliteral">&#39;interval&#39;</span>])) OR ($cws &lt; 4))) {
<a name="l11200"></a>11200                 <span class="keywordflow">if</span> (isset($range[$k][<span class="stringliteral">&#39;interval&#39;</span>])) {
<a name="l11201"></a>11201                     unset($range[$k][<span class="stringliteral">&#39;interval&#39;</span>]);
<a name="l11202"></a>11202                 }
<a name="l11203"></a>11203                 $range[$prevk] = array_merge($range[$prevk], $range[$k]);
<a name="l11204"></a>11204                 unset($range[$k]);
<a name="l11205"></a>11205             } <span class="keywordflow">else</span> {
<a name="l11206"></a>11206                 $prevk = $k;
<a name="l11207"></a>11207             }
<a name="l11208"></a>11208             $nextk = $k + $cws;
<a name="l11209"></a>11209             <span class="keywordflow">if</span> (isset($ws[<span class="stringliteral">&#39;interval&#39;</span>])) {
<a name="l11210"></a>11210                 <span class="keywordflow">if</span> ($cws &gt; 3) {
<a name="l11211"></a>11211                     $prevint = <span class="keyword">true</span>;
<a name="l11212"></a>11212                 } <span class="keywordflow">else</span> {
<a name="l11213"></a>11213                     $prevint = <span class="keyword">false</span>;
<a name="l11214"></a>11214                 }
<a name="l11215"></a>11215                 unset($range[$k][<span class="stringliteral">&#39;interval&#39;</span>]);
<a name="l11216"></a>11216                 --$nextk;
<a name="l11217"></a>11217             } <span class="keywordflow">else</span> {
<a name="l11218"></a>11218                 $prevint = <span class="keyword">false</span>;
<a name="l11219"></a>11219             }
<a name="l11220"></a>11220         }
<a name="l11221"></a>11221         <span class="comment">// output data</span>
<a name="l11222"></a>11222         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11223"></a>11223         <span class="keywordflow">foreach</span> ($range as $k =&gt; $ws) {
<a name="l11224"></a>11224             <span class="keywordflow">if</span> (count(array_count_values($ws)) == 1) {
<a name="l11225"></a>11225                 <span class="comment">// interval mode is more compact</span>
<a name="l11226"></a>11226                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> .= <span class="charliteral">&#39; &#39;</span>.$k.<span class="charliteral">&#39; &#39;</span>.($k + count($ws) - 1).<span class="charliteral">&#39; &#39;</span>.$ws[0];
<a name="l11227"></a>11227             } <span class="keywordflow">else</span> {
<a name="l11228"></a>11228                 <span class="comment">// range mode</span>
<a name="l11229"></a>11229                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> .= <span class="charliteral">&#39; &#39;</span>.$k.<span class="stringliteral">&#39; [ &#39;</span>.implode(<span class="charliteral">&#39; &#39;</span>, $ws).<span class="stringliteral">&#39; ]&#39;</span>;
<a name="l11230"></a>11230             }
<a name="l11231"></a>11231         }
<a name="l11232"></a>11232         <span class="keywordflow">return</span> <span class="stringliteral">&#39;/W [&#39;</span>.$w.<span class="stringliteral">&#39; ]&#39;</span>;
<a name="l11233"></a>11233     }
<a name="l11234"></a>11234 <span class="comment"></span>
<a name="l11235"></a>11235 <span class="comment">    /**</span>
<a name="l11236"></a>11236 <span class="comment">     * Output fonts.</span>
<a name="l11237"></a>11237 <span class="comment">     * @author Nicola Asuni</span>
<a name="l11238"></a>11238 <span class="comment">     * @protected</span>
<a name="l11239"></a>11239 <span class="comment">     */</span>
<a name="l11240"></a><a class="code" href="classTCPDF.html#a20314c160153895145ce7e8a91e75ffc">11240</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a20314c160153895145ce7e8a91e75ffc" title="Output fonts.">_putfonts</a>() {
<a name="l11241"></a>11241         $nf = $this-&gt;n;
<a name="l11242"></a>11242         <span class="keywordflow">foreach</span> ($this-&gt;diffs as <a class="code" href="dejavusans_8php.html#a054557295caacf1b6e4a2b8809418221">$diff</a>) {
<a name="l11243"></a>11243             <span class="comment">//Encodings</span>
<a name="l11244"></a>11244             $this-&gt;_newobj();
<a name="l11245"></a>11245             $this-&gt;_out(<span class="stringliteral">&#39;&lt;&lt; /Type /Encoding /BaseEncoding /WinAnsiEncoding /Differences [&#39;</span>.$diff.<span class="stringliteral">&#39;] &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);
<a name="l11246"></a>11246         }
<a name="l11247"></a>11247         $mqr = $this-&gt;get_mqr();
<a name="l11248"></a>11248         $this-&gt;set_mqr(<span class="keyword">false</span>);
<a name="l11249"></a>11249         <span class="keywordflow">foreach</span> ($this-&gt;FontFiles as <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> =&gt; $info) {
<a name="l11250"></a>11250             <span class="comment">// search and get font file to embedd</span>
<a name="l11251"></a>11251             $fontdir = $info[<span class="stringliteral">&#39;fontdir&#39;</span>];
<a name="l11252"></a>11252             <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> = strtolower(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l11253"></a>11253             $fontfile = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11254"></a>11254             <span class="comment">// search files on various directories</span>
<a name="l11255"></a>11255             <span class="keywordflow">if</span> (($fontdir !== <span class="keyword">false</span>) AND file_exists($fontdir.$file)) {
<a name="l11256"></a>11256                 $fontfile = $fontdir.$file;
<a name="l11257"></a>11257             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (file_exists($this-&gt;_getfontpath().<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l11258"></a>11258                 $fontfile = $this-&gt;_getfontpath().$file;
<a name="l11259"></a>11259             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (file_exists(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>)) {
<a name="l11260"></a>11260                 $fontfile = <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>;
<a name="l11261"></a>11261             }
<a name="l11262"></a>11262             <span class="keywordflow">if</span> (!$this-&gt;empty_string($fontfile)) {
<a name="l11263"></a>11263                 <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = file_get_contents($fontfile);
<a name="l11264"></a>11264                 $compressed = (substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, -2) == <span class="stringliteral">&#39;.z&#39;</span>);
<a name="l11265"></a>11265                 <span class="keywordflow">if</span> ((!$compressed) AND (isset($info[<span class="stringliteral">&#39;length2&#39;</span>]))) {
<a name="l11266"></a>11266                     $header = (ord(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>{0}) == 128);
<a name="l11267"></a>11267                     <span class="keywordflow">if</span> ($header) {
<a name="l11268"></a>11268                         <span class="comment">// strip first binary header</span>
<a name="l11269"></a>11269                         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, 6);
<a name="l11270"></a>11270                     }
<a name="l11271"></a>11271                     <span class="keywordflow">if</span> ($header AND (ord(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[$info[<span class="stringliteral">&#39;length1&#39;</span>]]) == 128)) {
<a name="l11272"></a>11272                         <span class="comment">// strip second binary header</span>
<a name="l11273"></a>11273                         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, 0, $info[<span class="stringliteral">&#39;length1&#39;</span>]).substr(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, ($info[<span class="stringliteral">&#39;length1&#39;</span>] + 6));
<a name="l11274"></a>11274                     }
<a name="l11275"></a>11275                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($info[<span class="stringliteral">&#39;subset&#39;</span>] AND ((!$compressed) OR ($compressed AND function_exists(<span class="stringliteral">&#39;gzcompress&#39;</span>)))) {
<a name="l11276"></a>11276                     <span class="keywordflow">if</span> ($compressed) {
<a name="l11277"></a>11277                         <span class="comment">// uncompress font</span>
<a name="l11278"></a>11278                         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = gzuncompress(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>);
<a name="l11279"></a>11279                     }
<a name="l11280"></a>11280                     <span class="comment">// merge subset characters</span>
<a name="l11281"></a>11281                     $subsetchars = array(); <span class="comment">// used chars</span>
<a name="l11282"></a>11282                     <span class="keywordflow">foreach</span> ($info[<span class="stringliteral">&#39;fontkeys&#39;</span>] as $fontkey) {
<a name="l11283"></a>11283                         $fontinfo = $this-&gt;getFontBuffer($fontkey);
<a name="l11284"></a>11284                         $subsetchars += $fontinfo[<span class="stringliteral">&#39;subsetchars&#39;</span>];
<a name="l11285"></a>11285                     }
<a name="l11286"></a>11286                     <span class="comment">// rebuild a font subset</span>
<a name="l11287"></a>11287                     <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = $this-&gt;_getTrueTypeFontSubset(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $subsetchars);
<a name="l11288"></a>11288                     <span class="comment">// calculate new font length</span>
<a name="l11289"></a>11289                     $info[<span class="stringliteral">&#39;length1&#39;</span>] = strlen(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>);
<a name="l11290"></a>11290                     <span class="keywordflow">if</span> ($compressed) {
<a name="l11291"></a>11291                         <span class="comment">// recompress font</span>
<a name="l11292"></a>11292                         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = gzcompress(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>);
<a name="l11293"></a>11293                     }
<a name="l11294"></a>11294                 }
<a name="l11295"></a>11295                 $this-&gt;_newobj();
<a name="l11296"></a>11296                 $this-&gt;FontFiles[<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>][<span class="charliteral">&#39;n&#39;</span>] = $this-&gt;n;
<a name="l11297"></a>11297                 $stream = $this-&gt;_getrawstream(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>);
<a name="l11298"></a>11298                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Length &#39;</span>.strlen($stream);
<a name="l11299"></a>11299                 <span class="keywordflow">if</span> ($compressed) {
<a name="l11300"></a>11300                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;
<a name="l11301"></a>11301                 }
<a name="l11302"></a>11302                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length1 &#39;</span>.$info[<span class="stringliteral">&#39;length1&#39;</span>];
<a name="l11303"></a>11303                 <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;length2&#39;</span>])) {
<a name="l11304"></a>11304                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length2 &#39;</span>.$info[<span class="stringliteral">&#39;length2&#39;</span>].<span class="stringliteral">&#39; /Length3 0&#39;</span>;
<a name="l11305"></a>11305                 }
<a name="l11306"></a>11306                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11307"></a>11307                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l11308"></a>11308                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11309"></a>11309                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11310"></a>11310             }
<a name="l11311"></a>11311         }
<a name="l11312"></a>11312         $this-&gt;set_mqr($mqr);
<a name="l11313"></a>11313         <span class="keywordflow">foreach</span> ($this-&gt;fontkeys as $k) {
<a name="l11314"></a>11314             <span class="comment">//Font objects</span>
<a name="l11315"></a>11315             <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = $this-&gt;getFontBuffer($k);
<a name="l11316"></a>11316             <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;type&#39;</span>];
<a name="l11317"></a>11317             <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;name&#39;</span>];
<a name="l11318"></a>11318             <span class="keywordflow">if</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;core&#39;</span>) {
<a name="l11319"></a>11319                 <span class="comment">// standard core font</span>
<a name="l11320"></a>11320                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;_getobj($this-&gt;font_obj_ids[$k]).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l11321"></a>11321                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt;/Type /Font&#39;</span>;
<a name="l11322"></a>11322                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /Type1&#39;</span>;
<a name="l11323"></a>11323                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$name;
<a name="l11324"></a>11324                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Name /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>];
<a name="l11325"></a>11325                 <span class="keywordflow">if</span> ((strtolower(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) != <span class="stringliteral">&#39;symbol&#39;</span>) AND (strtolower(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) != <span class="stringliteral">&#39;zapfdingbats&#39;</span>)) {
<a name="l11326"></a>11326                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Encoding /WinAnsiEncoding&#39;</span>;
<a name="l11327"></a>11327                 }
<a name="l11328"></a>11328                 <span class="keywordflow">if</span> ($k == <span class="stringliteral">&#39;helvetica&#39;</span>) {
<a name="l11329"></a>11329                     <span class="comment">// add default font for annotations</span>
<a name="l11330"></a>11330                     $this-&gt;annotation_fonts[$k] = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="charliteral">&#39;i&#39;</span>];
<a name="l11331"></a>11331                 }
<a name="l11332"></a>11332                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11333"></a>11333                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11334"></a>11334                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11335"></a>11335             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;Type1&#39;</span>) OR (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;TrueType&#39;</span>)) {
<a name="l11336"></a>11336                 <span class="comment">// additional Type1 or TrueType font</span>
<a name="l11337"></a>11337                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;_getobj($this-&gt;font_obj_ids[$k]).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l11338"></a>11338                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt;/Type /Font&#39;</span>;
<a name="l11339"></a>11339                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /&#39;</span>.$type;
<a name="l11340"></a>11340                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$name;
<a name="l11341"></a>11341                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Name /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>];
<a name="l11342"></a>11342                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FirstChar 32 /LastChar 255&#39;</span>;
<a name="l11343"></a>11343                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Widths &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11344"></a>11344                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FontDescriptor &#39;</span>.($this-&gt;n + 2).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11345"></a>11345                 <span class="keywordflow">if</span> (<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;enc&#39;</span>]) {
<a name="l11346"></a>11346                     <span class="keywordflow">if</span> (isset(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;diff&#39;</span>])) {
<a name="l11347"></a>11347                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Encoding &#39;</span>.($nf + <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;diff&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11348"></a>11348                     } <span class="keywordflow">else</span> {
<a name="l11349"></a>11349                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Encoding /WinAnsiEncoding&#39;</span>;
<a name="l11350"></a>11350                     }
<a name="l11351"></a>11351                 }
<a name="l11352"></a>11352                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11353"></a>11353                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11354"></a>11354                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11355"></a>11355                 <span class="comment">// Widths</span>
<a name="l11356"></a>11356                 $this-&gt;_newobj();
<a name="l11357"></a>11357                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = <span class="charliteral">&#39;[&#39;</span>;
<a name="l11358"></a>11358                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 32; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 256; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l11359"></a>11359                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;cw&#39;</span>][<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>].<span class="charliteral">&#39; &#39;</span>;
<a name="l11360"></a>11360                 }
<a name="l11361"></a>11361                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="charliteral">&#39;]&#39;</span>;
<a name="l11362"></a>11362                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11363"></a>11363                 $this-&gt;_out(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l11364"></a>11364                 <span class="comment">//Descriptor</span>
<a name="l11365"></a>11365                 $this-&gt;_newobj();
<a name="l11366"></a>11366                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = <span class="stringliteral">&#39;&lt;&lt;/Type /FontDescriptor /FontName /&#39;</span>.$name;
<a name="l11367"></a>11367                 <span class="keywordflow">foreach</span> (<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;desc&#39;</span>] as $fdk =&gt; $fdv) {
<a name="l11368"></a>11368                     <span class="keywordflow">if</span> (is_float($fdv)) {
<a name="l11369"></a>11369                         $fdv = sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, $fdv);
<a name="l11370"></a>11370                     }
<a name="l11371"></a>11371                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39; /&#39;</span>.$fdk.<span class="charliteral">&#39; &#39;</span>.$fdv.<span class="stringliteral">&#39;&#39;</span>;
<a name="l11372"></a>11372                 }
<a name="l11373"></a>11373                 <span class="keywordflow">if</span> (!$this-&gt;empty_string(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;file&#39;</span>])) {
<a name="l11374"></a>11374                     <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39; /FontFile&#39;</span>.($type == <span class="stringliteral">&#39;Type1&#39;</span> ? <span class="stringliteral">&#39;&#39;</span> : <span class="charliteral">&#39;2&#39;</span>).<span class="charliteral">&#39; &#39;</span>.$this-&gt;FontFiles[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;file&#39;</span>]][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11375"></a>11375                 }
<a name="l11376"></a>11376                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l11377"></a>11377                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11378"></a>11378                 $this-&gt;_out(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l11379"></a>11379             } <span class="keywordflow">else</span> {
<a name="l11380"></a>11380                 <span class="comment">// additional types</span>
<a name="l11381"></a>11381                 $mtd = <span class="stringliteral">&#39;_put&#39;</span>.strtolower(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l11382"></a>11382                 <span class="keywordflow">if</span> (!method_exists($this, $mtd)) {
<a name="l11383"></a>11383                     $this-&gt;Error(<span class="stringliteral">&#39;Unsupported font type: &#39;</span>.<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l11384"></a>11384                 }
<a name="l11385"></a>11385                 $this-&gt;$mtd(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>);
<a name="l11386"></a>11386             }
<a name="l11387"></a>11387         }
<a name="l11388"></a>11388     }
<a name="l11389"></a>11389 <span class="comment"></span>
<a name="l11390"></a>11390 <span class="comment">    /**</span>
<a name="l11391"></a>11391 <span class="comment">     * Adds unicode fonts.&lt;br&gt;</span>
<a name="l11392"></a>11392 <span class="comment">     * Based on PDF Reference 1.3 (section 5)</span>
<a name="l11393"></a>11393 <span class="comment">     * @param $font (array) font data</span>
<a name="l11394"></a>11394 <span class="comment">     * @protected</span>
<a name="l11395"></a>11395 <span class="comment">     * @author Nicola Asuni</span>
<a name="l11396"></a>11396 <span class="comment">     * @since 1.52.0.TC005 (2005-01-05)</span>
<a name="l11397"></a>11397 <span class="comment">     */</span>
<a name="l11398"></a><a class="code" href="classTCPDF.html#ab7edf9bb8be446509d03a9c70eba3ca3">11398</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab7edf9bb8be446509d03a9c70eba3ca3" title="Adds unicode fonts.">_puttruetypeunicode</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>) {
<a name="l11399"></a>11399         $fontname = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11400"></a>11400         <span class="keywordflow">if</span> (<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;subset&#39;</span>]) {
<a name="l11401"></a>11401             <span class="comment">// change name for font subsetting</span>
<a name="l11402"></a>11402             $subtag = sprintf(<span class="stringliteral">&#39;%06u&#39;</span>, <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="charliteral">&#39;i&#39;</span>]);
<a name="l11403"></a>11403             $subtag = strtr($subtag, <span class="stringliteral">&#39;0123456789&#39;</span>, <span class="stringliteral">&#39;ABCDEFGHIJ&#39;</span>);
<a name="l11404"></a>11404             $fontname .= $subtag.<span class="charliteral">&#39;+&#39;</span>;
<a name="l11405"></a>11405         }
<a name="l11406"></a>11406         $fontname .= <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;name&#39;</span>];
<a name="l11407"></a>11407         <span class="comment">// Type0 Font</span>
<a name="l11408"></a>11408         <span class="comment">// A composite font composed of other fonts, organized hierarchically</span>
<a name="l11409"></a>11409         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;_getobj($this-&gt;font_obj_ids[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;fontkey&#39;</span>]]).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l11410"></a>11410         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt; /Type /Font&#39;</span>;
<a name="l11411"></a>11411         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /Type0&#39;</span>;
<a name="l11412"></a>11412         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$fontname;
<a name="l11413"></a>11413         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Name /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>];
<a name="l11414"></a>11414         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Encoding /&#39;</span>.$font[<span class="stringliteral">&#39;enc&#39;</span>];
<a name="l11415"></a>11415         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ToUnicode &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11416"></a>11416         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DescendantFonts [&#39;</span>.($this-&gt;n + 2).<span class="stringliteral">&#39; 0 R]&#39;</span>;
<a name="l11417"></a>11417         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11418"></a>11418         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11419"></a>11419         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11420"></a>11420         <span class="comment">// ToUnicode map for Identity-H</span>
<a name="l11421"></a>11421         $stream = <span class="stringliteral">&quot;/CIDInit /ProcSet findresource begin\n&quot;</span>;
<a name="l11422"></a>11422         $stream .= <span class="stringliteral">&quot;12 dict begin\n&quot;</span>;
<a name="l11423"></a>11423         $stream .= <span class="stringliteral">&quot;begincmap\n&quot;</span>;
<a name="l11424"></a>11424         $stream .= <span class="stringliteral">&quot;/CIDSystemInfo &lt;&lt; /Registry (Adobe) /Ordering (UCS) /Supplement 0 &gt;&gt; def\n&quot;</span>;
<a name="l11425"></a>11425         $stream .= <span class="stringliteral">&quot;/CMapName /Adobe-Identity-UCS def\n&quot;</span>;
<a name="l11426"></a>11426         $stream .= <span class="stringliteral">&quot;/CMapType 2 def\n&quot;</span>;
<a name="l11427"></a>11427         $stream .= <span class="stringliteral">&quot;/WMode 0 def\n&quot;</span>;
<a name="l11428"></a>11428         $stream .= <span class="stringliteral">&quot;1 begincodespacerange\n&quot;</span>;
<a name="l11429"></a>11429         $stream .= <span class="stringliteral">&quot;&lt;0000&gt; &lt;FFFF&gt;\n&quot;</span>;
<a name="l11430"></a>11430         $stream .= <span class="stringliteral">&quot;endcodespacerange\n&quot;</span>;
<a name="l11431"></a>11431         $stream .= <span class="stringliteral">&quot;100 beginbfrange\n&quot;</span>;
<a name="l11432"></a>11432         $stream .= <span class="stringliteral">&quot;&lt;0000&gt; &lt;00ff&gt; &lt;0000&gt;\n&quot;</span>;
<a name="l11433"></a>11433         $stream .= <span class="stringliteral">&quot;&lt;0100&gt; &lt;01ff&gt; &lt;0100&gt;\n&quot;</span>;
<a name="l11434"></a>11434         $stream .= <span class="stringliteral">&quot;&lt;0200&gt; &lt;02ff&gt; &lt;0200&gt;\n&quot;</span>;
<a name="l11435"></a>11435         $stream .= <span class="stringliteral">&quot;&lt;0300&gt; &lt;03ff&gt; &lt;0300&gt;\n&quot;</span>;
<a name="l11436"></a>11436         $stream .= <span class="stringliteral">&quot;&lt;0400&gt; &lt;04ff&gt; &lt;0400&gt;\n&quot;</span>;
<a name="l11437"></a>11437         $stream .= <span class="stringliteral">&quot;&lt;0500&gt; &lt;05ff&gt; &lt;0500&gt;\n&quot;</span>;
<a name="l11438"></a>11438         $stream .= <span class="stringliteral">&quot;&lt;0600&gt; &lt;06ff&gt; &lt;0600&gt;\n&quot;</span>;
<a name="l11439"></a>11439         $stream .= <span class="stringliteral">&quot;&lt;0700&gt; &lt;07ff&gt; &lt;0700&gt;\n&quot;</span>;
<a name="l11440"></a>11440         $stream .= <span class="stringliteral">&quot;&lt;0800&gt; &lt;08ff&gt; &lt;0800&gt;\n&quot;</span>;
<a name="l11441"></a>11441         $stream .= <span class="stringliteral">&quot;&lt;0900&gt; &lt;09ff&gt; &lt;0900&gt;\n&quot;</span>;
<a name="l11442"></a>11442         $stream .= <span class="stringliteral">&quot;&lt;0a00&gt; &lt;0aff&gt; &lt;0a00&gt;\n&quot;</span>;
<a name="l11443"></a>11443         $stream .= <span class="stringliteral">&quot;&lt;0b00&gt; &lt;0bff&gt; &lt;0b00&gt;\n&quot;</span>;
<a name="l11444"></a>11444         $stream .= <span class="stringliteral">&quot;&lt;0c00&gt; &lt;0cff&gt; &lt;0c00&gt;\n&quot;</span>;
<a name="l11445"></a>11445         $stream .= <span class="stringliteral">&quot;&lt;0d00&gt; &lt;0dff&gt; &lt;0d00&gt;\n&quot;</span>;
<a name="l11446"></a>11446         $stream .= <span class="stringliteral">&quot;&lt;0e00&gt; &lt;0eff&gt; &lt;0e00&gt;\n&quot;</span>;
<a name="l11447"></a>11447         $stream .= <span class="stringliteral">&quot;&lt;0f00&gt; &lt;0fff&gt; &lt;0f00&gt;\n&quot;</span>;
<a name="l11448"></a>11448         $stream .= <span class="stringliteral">&quot;&lt;1000&gt; &lt;10ff&gt; &lt;1000&gt;\n&quot;</span>;
<a name="l11449"></a>11449         $stream .= <span class="stringliteral">&quot;&lt;1100&gt; &lt;11ff&gt; &lt;1100&gt;\n&quot;</span>;
<a name="l11450"></a>11450         $stream .= <span class="stringliteral">&quot;&lt;1200&gt; &lt;12ff&gt; &lt;1200&gt;\n&quot;</span>;
<a name="l11451"></a>11451         $stream .= <span class="stringliteral">&quot;&lt;1300&gt; &lt;13ff&gt; &lt;1300&gt;\n&quot;</span>;
<a name="l11452"></a>11452         $stream .= <span class="stringliteral">&quot;&lt;1400&gt; &lt;14ff&gt; &lt;1400&gt;\n&quot;</span>;
<a name="l11453"></a>11453         $stream .= <span class="stringliteral">&quot;&lt;1500&gt; &lt;15ff&gt; &lt;1500&gt;\n&quot;</span>;
<a name="l11454"></a>11454         $stream .= <span class="stringliteral">&quot;&lt;1600&gt; &lt;16ff&gt; &lt;1600&gt;\n&quot;</span>;
<a name="l11455"></a>11455         $stream .= <span class="stringliteral">&quot;&lt;1700&gt; &lt;17ff&gt; &lt;1700&gt;\n&quot;</span>;
<a name="l11456"></a>11456         $stream .= <span class="stringliteral">&quot;&lt;1800&gt; &lt;18ff&gt; &lt;1800&gt;\n&quot;</span>;
<a name="l11457"></a>11457         $stream .= <span class="stringliteral">&quot;&lt;1900&gt; &lt;19ff&gt; &lt;1900&gt;\n&quot;</span>;
<a name="l11458"></a>11458         $stream .= <span class="stringliteral">&quot;&lt;1a00&gt; &lt;1aff&gt; &lt;1a00&gt;\n&quot;</span>;
<a name="l11459"></a>11459         $stream .= <span class="stringliteral">&quot;&lt;1b00&gt; &lt;1bff&gt; &lt;1b00&gt;\n&quot;</span>;
<a name="l11460"></a>11460         $stream .= <span class="stringliteral">&quot;&lt;1c00&gt; &lt;1cff&gt; &lt;1c00&gt;\n&quot;</span>;
<a name="l11461"></a>11461         $stream .= <span class="stringliteral">&quot;&lt;1d00&gt; &lt;1dff&gt; &lt;1d00&gt;\n&quot;</span>;
<a name="l11462"></a>11462         $stream .= <span class="stringliteral">&quot;&lt;1e00&gt; &lt;1eff&gt; &lt;1e00&gt;\n&quot;</span>;
<a name="l11463"></a>11463         $stream .= <span class="stringliteral">&quot;&lt;1f00&gt; &lt;1fff&gt; &lt;1f00&gt;\n&quot;</span>;
<a name="l11464"></a>11464         $stream .= <span class="stringliteral">&quot;&lt;2000&gt; &lt;20ff&gt; &lt;2000&gt;\n&quot;</span>;
<a name="l11465"></a>11465         $stream .= <span class="stringliteral">&quot;&lt;2100&gt; &lt;21ff&gt; &lt;2100&gt;\n&quot;</span>;
<a name="l11466"></a>11466         $stream .= <span class="stringliteral">&quot;&lt;2200&gt; &lt;22ff&gt; &lt;2200&gt;\n&quot;</span>;
<a name="l11467"></a>11467         $stream .= <span class="stringliteral">&quot;&lt;2300&gt; &lt;23ff&gt; &lt;2300&gt;\n&quot;</span>;
<a name="l11468"></a>11468         $stream .= <span class="stringliteral">&quot;&lt;2400&gt; &lt;24ff&gt; &lt;2400&gt;\n&quot;</span>;
<a name="l11469"></a>11469         $stream .= <span class="stringliteral">&quot;&lt;2500&gt; &lt;25ff&gt; &lt;2500&gt;\n&quot;</span>;
<a name="l11470"></a>11470         $stream .= <span class="stringliteral">&quot;&lt;2600&gt; &lt;26ff&gt; &lt;2600&gt;\n&quot;</span>;
<a name="l11471"></a>11471         $stream .= <span class="stringliteral">&quot;&lt;2700&gt; &lt;27ff&gt; &lt;2700&gt;\n&quot;</span>;
<a name="l11472"></a>11472         $stream .= <span class="stringliteral">&quot;&lt;2800&gt; &lt;28ff&gt; &lt;2800&gt;\n&quot;</span>;
<a name="l11473"></a>11473         $stream .= <span class="stringliteral">&quot;&lt;2900&gt; &lt;29ff&gt; &lt;2900&gt;\n&quot;</span>;
<a name="l11474"></a>11474         $stream .= <span class="stringliteral">&quot;&lt;2a00&gt; &lt;2aff&gt; &lt;2a00&gt;\n&quot;</span>;
<a name="l11475"></a>11475         $stream .= <span class="stringliteral">&quot;&lt;2b00&gt; &lt;2bff&gt; &lt;2b00&gt;\n&quot;</span>;
<a name="l11476"></a>11476         $stream .= <span class="stringliteral">&quot;&lt;2c00&gt; &lt;2cff&gt; &lt;2c00&gt;\n&quot;</span>;
<a name="l11477"></a>11477         $stream .= <span class="stringliteral">&quot;&lt;2d00&gt; &lt;2dff&gt; &lt;2d00&gt;\n&quot;</span>;
<a name="l11478"></a>11478         $stream .= <span class="stringliteral">&quot;&lt;2e00&gt; &lt;2eff&gt; &lt;2e00&gt;\n&quot;</span>;
<a name="l11479"></a>11479         $stream .= <span class="stringliteral">&quot;&lt;2f00&gt; &lt;2fff&gt; &lt;2f00&gt;\n&quot;</span>;
<a name="l11480"></a>11480         $stream .= <span class="stringliteral">&quot;&lt;3000&gt; &lt;30ff&gt; &lt;3000&gt;\n&quot;</span>;
<a name="l11481"></a>11481         $stream .= <span class="stringliteral">&quot;&lt;3100&gt; &lt;31ff&gt; &lt;3100&gt;\n&quot;</span>;
<a name="l11482"></a>11482         $stream .= <span class="stringliteral">&quot;&lt;3200&gt; &lt;32ff&gt; &lt;3200&gt;\n&quot;</span>;
<a name="l11483"></a>11483         $stream .= <span class="stringliteral">&quot;&lt;3300&gt; &lt;33ff&gt; &lt;3300&gt;\n&quot;</span>;
<a name="l11484"></a>11484         $stream .= <span class="stringliteral">&quot;&lt;3400&gt; &lt;34ff&gt; &lt;3400&gt;\n&quot;</span>;
<a name="l11485"></a>11485         $stream .= <span class="stringliteral">&quot;&lt;3500&gt; &lt;35ff&gt; &lt;3500&gt;\n&quot;</span>;
<a name="l11486"></a>11486         $stream .= <span class="stringliteral">&quot;&lt;3600&gt; &lt;36ff&gt; &lt;3600&gt;\n&quot;</span>;
<a name="l11487"></a>11487         $stream .= <span class="stringliteral">&quot;&lt;3700&gt; &lt;37ff&gt; &lt;3700&gt;\n&quot;</span>;
<a name="l11488"></a>11488         $stream .= <span class="stringliteral">&quot;&lt;3800&gt; &lt;38ff&gt; &lt;3800&gt;\n&quot;</span>;
<a name="l11489"></a>11489         $stream .= <span class="stringliteral">&quot;&lt;3900&gt; &lt;39ff&gt; &lt;3900&gt;\n&quot;</span>;
<a name="l11490"></a>11490         $stream .= <span class="stringliteral">&quot;&lt;3a00&gt; &lt;3aff&gt; &lt;3a00&gt;\n&quot;</span>;
<a name="l11491"></a>11491         $stream .= <span class="stringliteral">&quot;&lt;3b00&gt; &lt;3bff&gt; &lt;3b00&gt;\n&quot;</span>;
<a name="l11492"></a>11492         $stream .= <span class="stringliteral">&quot;&lt;3c00&gt; &lt;3cff&gt; &lt;3c00&gt;\n&quot;</span>;
<a name="l11493"></a>11493         $stream .= <span class="stringliteral">&quot;&lt;3d00&gt; &lt;3dff&gt; &lt;3d00&gt;\n&quot;</span>;
<a name="l11494"></a>11494         $stream .= <span class="stringliteral">&quot;&lt;3e00&gt; &lt;3eff&gt; &lt;3e00&gt;\n&quot;</span>;
<a name="l11495"></a>11495         $stream .= <span class="stringliteral">&quot;&lt;3f00&gt; &lt;3fff&gt; &lt;3f00&gt;\n&quot;</span>;
<a name="l11496"></a>11496         $stream .= <span class="stringliteral">&quot;&lt;4000&gt; &lt;40ff&gt; &lt;4000&gt;\n&quot;</span>;
<a name="l11497"></a>11497         $stream .= <span class="stringliteral">&quot;&lt;4100&gt; &lt;41ff&gt; &lt;4100&gt;\n&quot;</span>;
<a name="l11498"></a>11498         $stream .= <span class="stringliteral">&quot;&lt;4200&gt; &lt;42ff&gt; &lt;4200&gt;\n&quot;</span>;
<a name="l11499"></a>11499         $stream .= <span class="stringliteral">&quot;&lt;4300&gt; &lt;43ff&gt; &lt;4300&gt;\n&quot;</span>;
<a name="l11500"></a>11500         $stream .= <span class="stringliteral">&quot;&lt;4400&gt; &lt;44ff&gt; &lt;4400&gt;\n&quot;</span>;
<a name="l11501"></a>11501         $stream .= <span class="stringliteral">&quot;&lt;4500&gt; &lt;45ff&gt; &lt;4500&gt;\n&quot;</span>;
<a name="l11502"></a>11502         $stream .= <span class="stringliteral">&quot;&lt;4600&gt; &lt;46ff&gt; &lt;4600&gt;\n&quot;</span>;
<a name="l11503"></a>11503         $stream .= <span class="stringliteral">&quot;&lt;4700&gt; &lt;47ff&gt; &lt;4700&gt;\n&quot;</span>;
<a name="l11504"></a>11504         $stream .= <span class="stringliteral">&quot;&lt;4800&gt; &lt;48ff&gt; &lt;4800&gt;\n&quot;</span>;
<a name="l11505"></a>11505         $stream .= <span class="stringliteral">&quot;&lt;4900&gt; &lt;49ff&gt; &lt;4900&gt;\n&quot;</span>;
<a name="l11506"></a>11506         $stream .= <span class="stringliteral">&quot;&lt;4a00&gt; &lt;4aff&gt; &lt;4a00&gt;\n&quot;</span>;
<a name="l11507"></a>11507         $stream .= <span class="stringliteral">&quot;&lt;4b00&gt; &lt;4bff&gt; &lt;4b00&gt;\n&quot;</span>;
<a name="l11508"></a>11508         $stream .= <span class="stringliteral">&quot;&lt;4c00&gt; &lt;4cff&gt; &lt;4c00&gt;\n&quot;</span>;
<a name="l11509"></a>11509         $stream .= <span class="stringliteral">&quot;&lt;4d00&gt; &lt;4dff&gt; &lt;4d00&gt;\n&quot;</span>;
<a name="l11510"></a>11510         $stream .= <span class="stringliteral">&quot;&lt;4e00&gt; &lt;4eff&gt; &lt;4e00&gt;\n&quot;</span>;
<a name="l11511"></a>11511         $stream .= <span class="stringliteral">&quot;&lt;4f00&gt; &lt;4fff&gt; &lt;4f00&gt;\n&quot;</span>;
<a name="l11512"></a>11512         $stream .= <span class="stringliteral">&quot;&lt;5000&gt; &lt;50ff&gt; &lt;5000&gt;\n&quot;</span>;
<a name="l11513"></a>11513         $stream .= <span class="stringliteral">&quot;&lt;5100&gt; &lt;51ff&gt; &lt;5100&gt;\n&quot;</span>;
<a name="l11514"></a>11514         $stream .= <span class="stringliteral">&quot;&lt;5200&gt; &lt;52ff&gt; &lt;5200&gt;\n&quot;</span>;
<a name="l11515"></a>11515         $stream .= <span class="stringliteral">&quot;&lt;5300&gt; &lt;53ff&gt; &lt;5300&gt;\n&quot;</span>;
<a name="l11516"></a>11516         $stream .= <span class="stringliteral">&quot;&lt;5400&gt; &lt;54ff&gt; &lt;5400&gt;\n&quot;</span>;
<a name="l11517"></a>11517         $stream .= <span class="stringliteral">&quot;&lt;5500&gt; &lt;55ff&gt; &lt;5500&gt;\n&quot;</span>;
<a name="l11518"></a>11518         $stream .= <span class="stringliteral">&quot;&lt;5600&gt; &lt;56ff&gt; &lt;5600&gt;\n&quot;</span>;
<a name="l11519"></a>11519         $stream .= <span class="stringliteral">&quot;&lt;5700&gt; &lt;57ff&gt; &lt;5700&gt;\n&quot;</span>;
<a name="l11520"></a>11520         $stream .= <span class="stringliteral">&quot;&lt;5800&gt; &lt;58ff&gt; &lt;5800&gt;\n&quot;</span>;
<a name="l11521"></a>11521         $stream .= <span class="stringliteral">&quot;&lt;5900&gt; &lt;59ff&gt; &lt;5900&gt;\n&quot;</span>;
<a name="l11522"></a>11522         $stream .= <span class="stringliteral">&quot;&lt;5a00&gt; &lt;5aff&gt; &lt;5a00&gt;\n&quot;</span>;
<a name="l11523"></a>11523         $stream .= <span class="stringliteral">&quot;&lt;5b00&gt; &lt;5bff&gt; &lt;5b00&gt;\n&quot;</span>;
<a name="l11524"></a>11524         $stream .= <span class="stringliteral">&quot;&lt;5c00&gt; &lt;5cff&gt; &lt;5c00&gt;\n&quot;</span>;
<a name="l11525"></a>11525         $stream .= <span class="stringliteral">&quot;&lt;5d00&gt; &lt;5dff&gt; &lt;5d00&gt;\n&quot;</span>;
<a name="l11526"></a>11526         $stream .= <span class="stringliteral">&quot;&lt;5e00&gt; &lt;5eff&gt; &lt;5e00&gt;\n&quot;</span>;
<a name="l11527"></a>11527         $stream .= <span class="stringliteral">&quot;&lt;5f00&gt; &lt;5fff&gt; &lt;5f00&gt;\n&quot;</span>;
<a name="l11528"></a>11528         $stream .= <span class="stringliteral">&quot;&lt;6000&gt; &lt;60ff&gt; &lt;6000&gt;\n&quot;</span>;
<a name="l11529"></a>11529         $stream .= <span class="stringliteral">&quot;&lt;6100&gt; &lt;61ff&gt; &lt;6100&gt;\n&quot;</span>;
<a name="l11530"></a>11530         $stream .= <span class="stringliteral">&quot;&lt;6200&gt; &lt;62ff&gt; &lt;6200&gt;\n&quot;</span>;
<a name="l11531"></a>11531         $stream .= <span class="stringliteral">&quot;&lt;6300&gt; &lt;63ff&gt; &lt;6300&gt;\n&quot;</span>;
<a name="l11532"></a>11532         $stream .= <span class="stringliteral">&quot;endbfrange\n&quot;</span>;
<a name="l11533"></a>11533         $stream .= <span class="stringliteral">&quot;100 beginbfrange\n&quot;</span>;
<a name="l11534"></a>11534         $stream .= <span class="stringliteral">&quot;&lt;6400&gt; &lt;64ff&gt; &lt;6400&gt;\n&quot;</span>;
<a name="l11535"></a>11535         $stream .= <span class="stringliteral">&quot;&lt;6500&gt; &lt;65ff&gt; &lt;6500&gt;\n&quot;</span>;
<a name="l11536"></a>11536         $stream .= <span class="stringliteral">&quot;&lt;6600&gt; &lt;66ff&gt; &lt;6600&gt;\n&quot;</span>;
<a name="l11537"></a>11537         $stream .= <span class="stringliteral">&quot;&lt;6700&gt; &lt;67ff&gt; &lt;6700&gt;\n&quot;</span>;
<a name="l11538"></a>11538         $stream .= <span class="stringliteral">&quot;&lt;6800&gt; &lt;68ff&gt; &lt;6800&gt;\n&quot;</span>;
<a name="l11539"></a>11539         $stream .= <span class="stringliteral">&quot;&lt;6900&gt; &lt;69ff&gt; &lt;6900&gt;\n&quot;</span>;
<a name="l11540"></a>11540         $stream .= <span class="stringliteral">&quot;&lt;6a00&gt; &lt;6aff&gt; &lt;6a00&gt;\n&quot;</span>;
<a name="l11541"></a>11541         $stream .= <span class="stringliteral">&quot;&lt;6b00&gt; &lt;6bff&gt; &lt;6b00&gt;\n&quot;</span>;
<a name="l11542"></a>11542         $stream .= <span class="stringliteral">&quot;&lt;6c00&gt; &lt;6cff&gt; &lt;6c00&gt;\n&quot;</span>;
<a name="l11543"></a>11543         $stream .= <span class="stringliteral">&quot;&lt;6d00&gt; &lt;6dff&gt; &lt;6d00&gt;\n&quot;</span>;
<a name="l11544"></a>11544         $stream .= <span class="stringliteral">&quot;&lt;6e00&gt; &lt;6eff&gt; &lt;6e00&gt;\n&quot;</span>;
<a name="l11545"></a>11545         $stream .= <span class="stringliteral">&quot;&lt;6f00&gt; &lt;6fff&gt; &lt;6f00&gt;\n&quot;</span>;
<a name="l11546"></a>11546         $stream .= <span class="stringliteral">&quot;&lt;7000&gt; &lt;70ff&gt; &lt;7000&gt;\n&quot;</span>;
<a name="l11547"></a>11547         $stream .= <span class="stringliteral">&quot;&lt;7100&gt; &lt;71ff&gt; &lt;7100&gt;\n&quot;</span>;
<a name="l11548"></a>11548         $stream .= <span class="stringliteral">&quot;&lt;7200&gt; &lt;72ff&gt; &lt;7200&gt;\n&quot;</span>;
<a name="l11549"></a>11549         $stream .= <span class="stringliteral">&quot;&lt;7300&gt; &lt;73ff&gt; &lt;7300&gt;\n&quot;</span>;
<a name="l11550"></a>11550         $stream .= <span class="stringliteral">&quot;&lt;7400&gt; &lt;74ff&gt; &lt;7400&gt;\n&quot;</span>;
<a name="l11551"></a>11551         $stream .= <span class="stringliteral">&quot;&lt;7500&gt; &lt;75ff&gt; &lt;7500&gt;\n&quot;</span>;
<a name="l11552"></a>11552         $stream .= <span class="stringliteral">&quot;&lt;7600&gt; &lt;76ff&gt; &lt;7600&gt;\n&quot;</span>;
<a name="l11553"></a>11553         $stream .= <span class="stringliteral">&quot;&lt;7700&gt; &lt;77ff&gt; &lt;7700&gt;\n&quot;</span>;
<a name="l11554"></a>11554         $stream .= <span class="stringliteral">&quot;&lt;7800&gt; &lt;78ff&gt; &lt;7800&gt;\n&quot;</span>;
<a name="l11555"></a>11555         $stream .= <span class="stringliteral">&quot;&lt;7900&gt; &lt;79ff&gt; &lt;7900&gt;\n&quot;</span>;
<a name="l11556"></a>11556         $stream .= <span class="stringliteral">&quot;&lt;7a00&gt; &lt;7aff&gt; &lt;7a00&gt;\n&quot;</span>;
<a name="l11557"></a>11557         $stream .= <span class="stringliteral">&quot;&lt;7b00&gt; &lt;7bff&gt; &lt;7b00&gt;\n&quot;</span>;
<a name="l11558"></a>11558         $stream .= <span class="stringliteral">&quot;&lt;7c00&gt; &lt;7cff&gt; &lt;7c00&gt;\n&quot;</span>;
<a name="l11559"></a>11559         $stream .= <span class="stringliteral">&quot;&lt;7d00&gt; &lt;7dff&gt; &lt;7d00&gt;\n&quot;</span>;
<a name="l11560"></a>11560         $stream .= <span class="stringliteral">&quot;&lt;7e00&gt; &lt;7eff&gt; &lt;7e00&gt;\n&quot;</span>;
<a name="l11561"></a>11561         $stream .= <span class="stringliteral">&quot;&lt;7f00&gt; &lt;7fff&gt; &lt;7f00&gt;\n&quot;</span>;
<a name="l11562"></a>11562         $stream .= <span class="stringliteral">&quot;&lt;8000&gt; &lt;80ff&gt; &lt;8000&gt;\n&quot;</span>;
<a name="l11563"></a>11563         $stream .= <span class="stringliteral">&quot;&lt;8100&gt; &lt;81ff&gt; &lt;8100&gt;\n&quot;</span>;
<a name="l11564"></a>11564         $stream .= <span class="stringliteral">&quot;&lt;8200&gt; &lt;82ff&gt; &lt;8200&gt;\n&quot;</span>;
<a name="l11565"></a>11565         $stream .= <span class="stringliteral">&quot;&lt;8300&gt; &lt;83ff&gt; &lt;8300&gt;\n&quot;</span>;
<a name="l11566"></a>11566         $stream .= <span class="stringliteral">&quot;&lt;8400&gt; &lt;84ff&gt; &lt;8400&gt;\n&quot;</span>;
<a name="l11567"></a>11567         $stream .= <span class="stringliteral">&quot;&lt;8500&gt; &lt;85ff&gt; &lt;8500&gt;\n&quot;</span>;
<a name="l11568"></a>11568         $stream .= <span class="stringliteral">&quot;&lt;8600&gt; &lt;86ff&gt; &lt;8600&gt;\n&quot;</span>;
<a name="l11569"></a>11569         $stream .= <span class="stringliteral">&quot;&lt;8700&gt; &lt;87ff&gt; &lt;8700&gt;\n&quot;</span>;
<a name="l11570"></a>11570         $stream .= <span class="stringliteral">&quot;&lt;8800&gt; &lt;88ff&gt; &lt;8800&gt;\n&quot;</span>;
<a name="l11571"></a>11571         $stream .= <span class="stringliteral">&quot;&lt;8900&gt; &lt;89ff&gt; &lt;8900&gt;\n&quot;</span>;
<a name="l11572"></a>11572         $stream .= <span class="stringliteral">&quot;&lt;8a00&gt; &lt;8aff&gt; &lt;8a00&gt;\n&quot;</span>;
<a name="l11573"></a>11573         $stream .= <span class="stringliteral">&quot;&lt;8b00&gt; &lt;8bff&gt; &lt;8b00&gt;\n&quot;</span>;
<a name="l11574"></a>11574         $stream .= <span class="stringliteral">&quot;&lt;8c00&gt; &lt;8cff&gt; &lt;8c00&gt;\n&quot;</span>;
<a name="l11575"></a>11575         $stream .= <span class="stringliteral">&quot;&lt;8d00&gt; &lt;8dff&gt; &lt;8d00&gt;\n&quot;</span>;
<a name="l11576"></a>11576         $stream .= <span class="stringliteral">&quot;&lt;8e00&gt; &lt;8eff&gt; &lt;8e00&gt;\n&quot;</span>;
<a name="l11577"></a>11577         $stream .= <span class="stringliteral">&quot;&lt;8f00&gt; &lt;8fff&gt; &lt;8f00&gt;\n&quot;</span>;
<a name="l11578"></a>11578         $stream .= <span class="stringliteral">&quot;&lt;9000&gt; &lt;90ff&gt; &lt;9000&gt;\n&quot;</span>;
<a name="l11579"></a>11579         $stream .= <span class="stringliteral">&quot;&lt;9100&gt; &lt;91ff&gt; &lt;9100&gt;\n&quot;</span>;
<a name="l11580"></a>11580         $stream .= <span class="stringliteral">&quot;&lt;9200&gt; &lt;92ff&gt; &lt;9200&gt;\n&quot;</span>;
<a name="l11581"></a>11581         $stream .= <span class="stringliteral">&quot;&lt;9300&gt; &lt;93ff&gt; &lt;9300&gt;\n&quot;</span>;
<a name="l11582"></a>11582         $stream .= <span class="stringliteral">&quot;&lt;9400&gt; &lt;94ff&gt; &lt;9400&gt;\n&quot;</span>;
<a name="l11583"></a>11583         $stream .= <span class="stringliteral">&quot;&lt;9500&gt; &lt;95ff&gt; &lt;9500&gt;\n&quot;</span>;
<a name="l11584"></a>11584         $stream .= <span class="stringliteral">&quot;&lt;9600&gt; &lt;96ff&gt; &lt;9600&gt;\n&quot;</span>;
<a name="l11585"></a>11585         $stream .= <span class="stringliteral">&quot;&lt;9700&gt; &lt;97ff&gt; &lt;9700&gt;\n&quot;</span>;
<a name="l11586"></a>11586         $stream .= <span class="stringliteral">&quot;&lt;9800&gt; &lt;98ff&gt; &lt;9800&gt;\n&quot;</span>;
<a name="l11587"></a>11587         $stream .= <span class="stringliteral">&quot;&lt;9900&gt; &lt;99ff&gt; &lt;9900&gt;\n&quot;</span>;
<a name="l11588"></a>11588         $stream .= <span class="stringliteral">&quot;&lt;9a00&gt; &lt;9aff&gt; &lt;9a00&gt;\n&quot;</span>;
<a name="l11589"></a>11589         $stream .= <span class="stringliteral">&quot;&lt;9b00&gt; &lt;9bff&gt; &lt;9b00&gt;\n&quot;</span>;
<a name="l11590"></a>11590         $stream .= <span class="stringliteral">&quot;&lt;9c00&gt; &lt;9cff&gt; &lt;9c00&gt;\n&quot;</span>;
<a name="l11591"></a>11591         $stream .= <span class="stringliteral">&quot;&lt;9d00&gt; &lt;9dff&gt; &lt;9d00&gt;\n&quot;</span>;
<a name="l11592"></a>11592         $stream .= <span class="stringliteral">&quot;&lt;9e00&gt; &lt;9eff&gt; &lt;9e00&gt;\n&quot;</span>;
<a name="l11593"></a>11593         $stream .= <span class="stringliteral">&quot;&lt;9f00&gt; &lt;9fff&gt; &lt;9f00&gt;\n&quot;</span>;
<a name="l11594"></a>11594         $stream .= <span class="stringliteral">&quot;&lt;a000&gt; &lt;a0ff&gt; &lt;a000&gt;\n&quot;</span>;
<a name="l11595"></a>11595         $stream .= <span class="stringliteral">&quot;&lt;a100&gt; &lt;a1ff&gt; &lt;a100&gt;\n&quot;</span>;
<a name="l11596"></a>11596         $stream .= <span class="stringliteral">&quot;&lt;a200&gt; &lt;a2ff&gt; &lt;a200&gt;\n&quot;</span>;
<a name="l11597"></a>11597         $stream .= <span class="stringliteral">&quot;&lt;a300&gt; &lt;a3ff&gt; &lt;a300&gt;\n&quot;</span>;
<a name="l11598"></a>11598         $stream .= <span class="stringliteral">&quot;&lt;a400&gt; &lt;a4ff&gt; &lt;a400&gt;\n&quot;</span>;
<a name="l11599"></a>11599         $stream .= <span class="stringliteral">&quot;&lt;a500&gt; &lt;a5ff&gt; &lt;a500&gt;\n&quot;</span>;
<a name="l11600"></a>11600         $stream .= <span class="stringliteral">&quot;&lt;a600&gt; &lt;a6ff&gt; &lt;a600&gt;\n&quot;</span>;
<a name="l11601"></a>11601         $stream .= <span class="stringliteral">&quot;&lt;a700&gt; &lt;a7ff&gt; &lt;a700&gt;\n&quot;</span>;
<a name="l11602"></a>11602         $stream .= <span class="stringliteral">&quot;&lt;a800&gt; &lt;a8ff&gt; &lt;a800&gt;\n&quot;</span>;
<a name="l11603"></a>11603         $stream .= <span class="stringliteral">&quot;&lt;a900&gt; &lt;a9ff&gt; &lt;a900&gt;\n&quot;</span>;
<a name="l11604"></a>11604         $stream .= <span class="stringliteral">&quot;&lt;aa00&gt; &lt;aaff&gt; &lt;aa00&gt;\n&quot;</span>;
<a name="l11605"></a>11605         $stream .= <span class="stringliteral">&quot;&lt;ab00&gt; &lt;abff&gt; &lt;ab00&gt;\n&quot;</span>;
<a name="l11606"></a>11606         $stream .= <span class="stringliteral">&quot;&lt;ac00&gt; &lt;acff&gt; &lt;ac00&gt;\n&quot;</span>;
<a name="l11607"></a>11607         $stream .= <span class="stringliteral">&quot;&lt;ad00&gt; &lt;adff&gt; &lt;ad00&gt;\n&quot;</span>;
<a name="l11608"></a>11608         $stream .= <span class="stringliteral">&quot;&lt;ae00&gt; &lt;aeff&gt; &lt;ae00&gt;\n&quot;</span>;
<a name="l11609"></a>11609         $stream .= <span class="stringliteral">&quot;&lt;af00&gt; &lt;afff&gt; &lt;af00&gt;\n&quot;</span>;
<a name="l11610"></a>11610         $stream .= <span class="stringliteral">&quot;&lt;b000&gt; &lt;b0ff&gt; &lt;b000&gt;\n&quot;</span>;
<a name="l11611"></a>11611         $stream .= <span class="stringliteral">&quot;&lt;b100&gt; &lt;b1ff&gt; &lt;b100&gt;\n&quot;</span>;
<a name="l11612"></a>11612         $stream .= <span class="stringliteral">&quot;&lt;b200&gt; &lt;b2ff&gt; &lt;b200&gt;\n&quot;</span>;
<a name="l11613"></a>11613         $stream .= <span class="stringliteral">&quot;&lt;b300&gt; &lt;b3ff&gt; &lt;b300&gt;\n&quot;</span>;
<a name="l11614"></a>11614         $stream .= <span class="stringliteral">&quot;&lt;b400&gt; &lt;b4ff&gt; &lt;b400&gt;\n&quot;</span>;
<a name="l11615"></a>11615         $stream .= <span class="stringliteral">&quot;&lt;b500&gt; &lt;b5ff&gt; &lt;b500&gt;\n&quot;</span>;
<a name="l11616"></a>11616         $stream .= <span class="stringliteral">&quot;&lt;b600&gt; &lt;b6ff&gt; &lt;b600&gt;\n&quot;</span>;
<a name="l11617"></a>11617         $stream .= <span class="stringliteral">&quot;&lt;b700&gt; &lt;b7ff&gt; &lt;b700&gt;\n&quot;</span>;
<a name="l11618"></a>11618         $stream .= <span class="stringliteral">&quot;&lt;b800&gt; &lt;b8ff&gt; &lt;b800&gt;\n&quot;</span>;
<a name="l11619"></a>11619         $stream .= <span class="stringliteral">&quot;&lt;b900&gt; &lt;b9ff&gt; &lt;b900&gt;\n&quot;</span>;
<a name="l11620"></a>11620         $stream .= <span class="stringliteral">&quot;&lt;ba00&gt; &lt;baff&gt; &lt;ba00&gt;\n&quot;</span>;
<a name="l11621"></a>11621         $stream .= <span class="stringliteral">&quot;&lt;bb00&gt; &lt;bbff&gt; &lt;bb00&gt;\n&quot;</span>;
<a name="l11622"></a>11622         $stream .= <span class="stringliteral">&quot;&lt;bc00&gt; &lt;bcff&gt; &lt;bc00&gt;\n&quot;</span>;
<a name="l11623"></a>11623         $stream .= <span class="stringliteral">&quot;&lt;bd00&gt; &lt;bdff&gt; &lt;bd00&gt;\n&quot;</span>;
<a name="l11624"></a>11624         $stream .= <span class="stringliteral">&quot;&lt;be00&gt; &lt;beff&gt; &lt;be00&gt;\n&quot;</span>;
<a name="l11625"></a>11625         $stream .= <span class="stringliteral">&quot;&lt;bf00&gt; &lt;bfff&gt; &lt;bf00&gt;\n&quot;</span>;
<a name="l11626"></a>11626         $stream .= <span class="stringliteral">&quot;&lt;c000&gt; &lt;c0ff&gt; &lt;c000&gt;\n&quot;</span>;
<a name="l11627"></a>11627         $stream .= <span class="stringliteral">&quot;&lt;c100&gt; &lt;c1ff&gt; &lt;c100&gt;\n&quot;</span>;
<a name="l11628"></a>11628         $stream .= <span class="stringliteral">&quot;&lt;c200&gt; &lt;c2ff&gt; &lt;c200&gt;\n&quot;</span>;
<a name="l11629"></a>11629         $stream .= <span class="stringliteral">&quot;&lt;c300&gt; &lt;c3ff&gt; &lt;c300&gt;\n&quot;</span>;
<a name="l11630"></a>11630         $stream .= <span class="stringliteral">&quot;&lt;c400&gt; &lt;c4ff&gt; &lt;c400&gt;\n&quot;</span>;
<a name="l11631"></a>11631         $stream .= <span class="stringliteral">&quot;&lt;c500&gt; &lt;c5ff&gt; &lt;c500&gt;\n&quot;</span>;
<a name="l11632"></a>11632         $stream .= <span class="stringliteral">&quot;&lt;c600&gt; &lt;c6ff&gt; &lt;c600&gt;\n&quot;</span>;
<a name="l11633"></a>11633         $stream .= <span class="stringliteral">&quot;&lt;c700&gt; &lt;c7ff&gt; &lt;c700&gt;\n&quot;</span>;
<a name="l11634"></a>11634         $stream .= <span class="stringliteral">&quot;endbfrange\n&quot;</span>;
<a name="l11635"></a>11635         $stream .= <span class="stringliteral">&quot;56 beginbfrange\n&quot;</span>;
<a name="l11636"></a>11636         $stream .= <span class="stringliteral">&quot;&lt;c800&gt; &lt;c8ff&gt; &lt;c800&gt;\n&quot;</span>;
<a name="l11637"></a>11637         $stream .= <span class="stringliteral">&quot;&lt;c900&gt; &lt;c9ff&gt; &lt;c900&gt;\n&quot;</span>;
<a name="l11638"></a>11638         $stream .= <span class="stringliteral">&quot;&lt;ca00&gt; &lt;caff&gt; &lt;ca00&gt;\n&quot;</span>;
<a name="l11639"></a>11639         $stream .= <span class="stringliteral">&quot;&lt;cb00&gt; &lt;cbff&gt; &lt;cb00&gt;\n&quot;</span>;
<a name="l11640"></a>11640         $stream .= <span class="stringliteral">&quot;&lt;cc00&gt; &lt;ccff&gt; &lt;cc00&gt;\n&quot;</span>;
<a name="l11641"></a>11641         $stream .= <span class="stringliteral">&quot;&lt;cd00&gt; &lt;cdff&gt; &lt;cd00&gt;\n&quot;</span>;
<a name="l11642"></a>11642         $stream .= <span class="stringliteral">&quot;&lt;ce00&gt; &lt;ceff&gt; &lt;ce00&gt;\n&quot;</span>;
<a name="l11643"></a>11643         $stream .= <span class="stringliteral">&quot;&lt;cf00&gt; &lt;cfff&gt; &lt;cf00&gt;\n&quot;</span>;
<a name="l11644"></a>11644         $stream .= <span class="stringliteral">&quot;&lt;d000&gt; &lt;d0ff&gt; &lt;d000&gt;\n&quot;</span>;
<a name="l11645"></a>11645         $stream .= <span class="stringliteral">&quot;&lt;d100&gt; &lt;d1ff&gt; &lt;d100&gt;\n&quot;</span>;
<a name="l11646"></a>11646         $stream .= <span class="stringliteral">&quot;&lt;d200&gt; &lt;d2ff&gt; &lt;d200&gt;\n&quot;</span>;
<a name="l11647"></a>11647         $stream .= <span class="stringliteral">&quot;&lt;d300&gt; &lt;d3ff&gt; &lt;d300&gt;\n&quot;</span>;
<a name="l11648"></a>11648         $stream .= <span class="stringliteral">&quot;&lt;d400&gt; &lt;d4ff&gt; &lt;d400&gt;\n&quot;</span>;
<a name="l11649"></a>11649         $stream .= <span class="stringliteral">&quot;&lt;d500&gt; &lt;d5ff&gt; &lt;d500&gt;\n&quot;</span>;
<a name="l11650"></a>11650         $stream .= <span class="stringliteral">&quot;&lt;d600&gt; &lt;d6ff&gt; &lt;d600&gt;\n&quot;</span>;
<a name="l11651"></a>11651         $stream .= <span class="stringliteral">&quot;&lt;d700&gt; &lt;d7ff&gt; &lt;d700&gt;\n&quot;</span>;
<a name="l11652"></a>11652         $stream .= <span class="stringliteral">&quot;&lt;d800&gt; &lt;d8ff&gt; &lt;d800&gt;\n&quot;</span>;
<a name="l11653"></a>11653         $stream .= <span class="stringliteral">&quot;&lt;d900&gt; &lt;d9ff&gt; &lt;d900&gt;\n&quot;</span>;
<a name="l11654"></a>11654         $stream .= <span class="stringliteral">&quot;&lt;da00&gt; &lt;daff&gt; &lt;da00&gt;\n&quot;</span>;
<a name="l11655"></a>11655         $stream .= <span class="stringliteral">&quot;&lt;db00&gt; &lt;dbff&gt; &lt;db00&gt;\n&quot;</span>;
<a name="l11656"></a>11656         $stream .= <span class="stringliteral">&quot;&lt;dc00&gt; &lt;dcff&gt; &lt;dc00&gt;\n&quot;</span>;
<a name="l11657"></a>11657         $stream .= <span class="stringliteral">&quot;&lt;dd00&gt; &lt;ddff&gt; &lt;dd00&gt;\n&quot;</span>;
<a name="l11658"></a>11658         $stream .= <span class="stringliteral">&quot;&lt;de00&gt; &lt;deff&gt; &lt;de00&gt;\n&quot;</span>;
<a name="l11659"></a>11659         $stream .= <span class="stringliteral">&quot;&lt;df00&gt; &lt;dfff&gt; &lt;df00&gt;\n&quot;</span>;
<a name="l11660"></a>11660         $stream .= <span class="stringliteral">&quot;&lt;e000&gt; &lt;e0ff&gt; &lt;e000&gt;\n&quot;</span>;
<a name="l11661"></a>11661         $stream .= <span class="stringliteral">&quot;&lt;e100&gt; &lt;e1ff&gt; &lt;e100&gt;\n&quot;</span>;
<a name="l11662"></a>11662         $stream .= <span class="stringliteral">&quot;&lt;e200&gt; &lt;e2ff&gt; &lt;e200&gt;\n&quot;</span>;
<a name="l11663"></a>11663         $stream .= <span class="stringliteral">&quot;&lt;e300&gt; &lt;e3ff&gt; &lt;e300&gt;\n&quot;</span>;
<a name="l11664"></a>11664         $stream .= <span class="stringliteral">&quot;&lt;e400&gt; &lt;e4ff&gt; &lt;e400&gt;\n&quot;</span>;
<a name="l11665"></a>11665         $stream .= <span class="stringliteral">&quot;&lt;e500&gt; &lt;e5ff&gt; &lt;e500&gt;\n&quot;</span>;
<a name="l11666"></a>11666         $stream .= <span class="stringliteral">&quot;&lt;e600&gt; &lt;e6ff&gt; &lt;e600&gt;\n&quot;</span>;
<a name="l11667"></a>11667         $stream .= <span class="stringliteral">&quot;&lt;e700&gt; &lt;e7ff&gt; &lt;e700&gt;\n&quot;</span>;
<a name="l11668"></a>11668         $stream .= <span class="stringliteral">&quot;&lt;e800&gt; &lt;e8ff&gt; &lt;e800&gt;\n&quot;</span>;
<a name="l11669"></a>11669         $stream .= <span class="stringliteral">&quot;&lt;e900&gt; &lt;e9ff&gt; &lt;e900&gt;\n&quot;</span>;
<a name="l11670"></a>11670         $stream .= <span class="stringliteral">&quot;&lt;ea00&gt; &lt;eaff&gt; &lt;ea00&gt;\n&quot;</span>;
<a name="l11671"></a>11671         $stream .= <span class="stringliteral">&quot;&lt;eb00&gt; &lt;ebff&gt; &lt;eb00&gt;\n&quot;</span>;
<a name="l11672"></a>11672         $stream .= <span class="stringliteral">&quot;&lt;ec00&gt; &lt;ecff&gt; &lt;ec00&gt;\n&quot;</span>;
<a name="l11673"></a>11673         $stream .= <span class="stringliteral">&quot;&lt;ed00&gt; &lt;edff&gt; &lt;ed00&gt;\n&quot;</span>;
<a name="l11674"></a>11674         $stream .= <span class="stringliteral">&quot;&lt;ee00&gt; &lt;eeff&gt; &lt;ee00&gt;\n&quot;</span>;
<a name="l11675"></a>11675         $stream .= <span class="stringliteral">&quot;&lt;ef00&gt; &lt;efff&gt; &lt;ef00&gt;\n&quot;</span>;
<a name="l11676"></a>11676         $stream .= <span class="stringliteral">&quot;&lt;f000&gt; &lt;f0ff&gt; &lt;f000&gt;\n&quot;</span>;
<a name="l11677"></a>11677         $stream .= <span class="stringliteral">&quot;&lt;f100&gt; &lt;f1ff&gt; &lt;f100&gt;\n&quot;</span>;
<a name="l11678"></a>11678         $stream .= <span class="stringliteral">&quot;&lt;f200&gt; &lt;f2ff&gt; &lt;f200&gt;\n&quot;</span>;
<a name="l11679"></a>11679         $stream .= <span class="stringliteral">&quot;&lt;f300&gt; &lt;f3ff&gt; &lt;f300&gt;\n&quot;</span>;
<a name="l11680"></a>11680         $stream .= <span class="stringliteral">&quot;&lt;f400&gt; &lt;f4ff&gt; &lt;f400&gt;\n&quot;</span>;
<a name="l11681"></a>11681         $stream .= <span class="stringliteral">&quot;&lt;f500&gt; &lt;f5ff&gt; &lt;f500&gt;\n&quot;</span>;
<a name="l11682"></a>11682         $stream .= <span class="stringliteral">&quot;&lt;f600&gt; &lt;f6ff&gt; &lt;f600&gt;\n&quot;</span>;
<a name="l11683"></a>11683         $stream .= <span class="stringliteral">&quot;&lt;f700&gt; &lt;f7ff&gt; &lt;f700&gt;\n&quot;</span>;
<a name="l11684"></a>11684         $stream .= <span class="stringliteral">&quot;&lt;f800&gt; &lt;f8ff&gt; &lt;f800&gt;\n&quot;</span>;
<a name="l11685"></a>11685         $stream .= <span class="stringliteral">&quot;&lt;f900&gt; &lt;f9ff&gt; &lt;f900&gt;\n&quot;</span>;
<a name="l11686"></a>11686         $stream .= <span class="stringliteral">&quot;&lt;fa00&gt; &lt;faff&gt; &lt;fa00&gt;\n&quot;</span>;
<a name="l11687"></a>11687         $stream .= <span class="stringliteral">&quot;&lt;fb00&gt; &lt;fbff&gt; &lt;fb00&gt;\n&quot;</span>;
<a name="l11688"></a>11688         $stream .= <span class="stringliteral">&quot;&lt;fc00&gt; &lt;fcff&gt; &lt;fc00&gt;\n&quot;</span>;
<a name="l11689"></a>11689         $stream .= <span class="stringliteral">&quot;&lt;fd00&gt; &lt;fdff&gt; &lt;fd00&gt;\n&quot;</span>;
<a name="l11690"></a>11690         $stream .= <span class="stringliteral">&quot;&lt;fe00&gt; &lt;feff&gt; &lt;fe00&gt;\n&quot;</span>;
<a name="l11691"></a>11691         $stream .= <span class="stringliteral">&quot;&lt;ff00&gt; &lt;ffff&gt; &lt;ff00&gt;\n&quot;</span>;
<a name="l11692"></a>11692         $stream .= <span class="stringliteral">&quot;endbfrange\n&quot;</span>;
<a name="l11693"></a>11693         $stream .= <span class="stringliteral">&quot;endcmap\n&quot;</span>;
<a name="l11694"></a>11694         $stream .= <span class="stringliteral">&quot;CMapName currentdict /CMap defineresource pop\n&quot;</span>;
<a name="l11695"></a>11695         $stream .= <span class="stringliteral">&quot;end\n&quot;</span>;
<a name="l11696"></a>11696         $stream .= <span class="stringliteral">&quot;end&quot;</span>;
<a name="l11697"></a>11697         <span class="comment">// ToUnicode Object</span>
<a name="l11698"></a>11698         $this-&gt;_newobj();
<a name="l11699"></a>11699         $stream = ($this-&gt;compress) ? gzcompress($stream) : $stream;
<a name="l11700"></a>11700         $filter = ($this-&gt;compress) ? <span class="stringliteral">&#39;/Filter /FlateDecode &#39;</span> : <span class="stringliteral">&#39;&#39;</span>;
<a name="l11701"></a>11701         $stream = $this-&gt;_getrawstream($stream);
<a name="l11702"></a>11702         $this-&gt;_out(<span class="stringliteral">&#39;&lt;&lt;&#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($stream).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);
<a name="l11703"></a>11703         <span class="comment">// CIDFontType2</span>
<a name="l11704"></a>11704         <span class="comment">// A CIDFont whose glyph descriptions are based on TrueType font technology</span>
<a name="l11705"></a>11705         $oid = $this-&gt;_newobj();
<a name="l11706"></a>11706         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /Font&#39;</span>;
<a name="l11707"></a>11707         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /CIDFontType2&#39;</span>;
<a name="l11708"></a>11708         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$fontname;
<a name="l11709"></a>11709         <span class="comment">// A dictionary containing entries that define the character collection of the CIDFont.</span>
<a name="l11710"></a>11710         $cidinfo = <span class="stringliteral">&#39;/Registry &#39;</span>.$this-&gt;_datastring($font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Registry&#39;</span>], $oid);
<a name="l11711"></a>11711         $cidinfo .= <span class="stringliteral">&#39; /Ordering &#39;</span>.$this-&gt;_datastring($font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Ordering&#39;</span>], $oid);
<a name="l11712"></a>11712         $cidinfo .= <span class="stringliteral">&#39; /Supplement &#39;</span>.$font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Supplement&#39;</span>];
<a name="l11713"></a>11713         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CIDSystemInfo &lt;&lt; &#39;</span>.$cidinfo.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11714"></a>11714         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FontDescriptor &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11715"></a>11715         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DW &#39;</span>.$font[<span class="stringliteral">&#39;dw&#39;</span>]; <span class="comment">// default width</span>
<a name="l11716"></a>11716         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.$this-&gt;_putfontwidths($font, 0);
<a name="l11717"></a>11717         <span class="keywordflow">if</span> (isset($font[<span class="stringliteral">&#39;ctg&#39;</span>]) AND (!$this-&gt;empty_string($font[<span class="stringliteral">&#39;ctg&#39;</span>]))) {
<a name="l11718"></a>11718             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;/CIDToGIDMap &#39;</span>.($this-&gt;n + 2).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11719"></a>11719         }
<a name="l11720"></a>11720         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11721"></a>11721         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11722"></a>11722         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11723"></a>11723         <span class="comment">// Font descriptor</span>
<a name="l11724"></a>11724         <span class="comment">// A font descriptor describing the CIDFont default metrics other than its glyph widths</span>
<a name="l11725"></a>11725         $this-&gt;_newobj();
<a name="l11726"></a>11726         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /FontDescriptor&#39;</span>;
<a name="l11727"></a>11727         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FontName /&#39;</span>.$fontname;
<a name="l11728"></a>11728         <span class="keywordflow">foreach</span> ($font[<span class="stringliteral">&#39;desc&#39;</span>] as $key =&gt; $value) {
<a name="l11729"></a>11729             <span class="keywordflow">if</span> (is_float($value)) {
<a name="l11730"></a>11730                 $value = sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, $value);
<a name="l11731"></a>11731             }
<a name="l11732"></a>11732             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$key.<span class="charliteral">&#39; &#39;</span>.$value;
<a name="l11733"></a>11733         }
<a name="l11734"></a>11734         $fontdir = <span class="keyword">false</span>;
<a name="l11735"></a>11735         <span class="keywordflow">if</span> (!$this-&gt;empty_string($font[<span class="stringliteral">&#39;file&#39;</span>])) {
<a name="l11736"></a>11736             <span class="comment">// A stream containing a TrueType font</span>
<a name="l11737"></a>11737             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FontFile2 &#39;</span>.$this-&gt;FontFiles[$font[<span class="stringliteral">&#39;file&#39;</span>]][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11738"></a>11738             $fontdir = $this-&gt;FontFiles[$font[<span class="stringliteral">&#39;file&#39;</span>]][<span class="stringliteral">&#39;fontdir&#39;</span>];
<a name="l11739"></a>11739         }
<a name="l11740"></a>11740         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11741"></a>11741         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11742"></a>11742         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11743"></a>11743         <span class="keywordflow">if</span> (isset($font[<span class="stringliteral">&#39;ctg&#39;</span>]) AND (!$this-&gt;empty_string($font[<span class="stringliteral">&#39;ctg&#39;</span>]))) {
<a name="l11744"></a>11744             $this-&gt;_newobj();
<a name="l11745"></a>11745             <span class="comment">// Embed CIDToGIDMap</span>
<a name="l11746"></a>11746             <span class="comment">// A specification of the mapping from CIDs to glyph indices</span>
<a name="l11747"></a>11747             <span class="comment">// search and get CTG font file to embedd</span>
<a name="l11748"></a>11748             $ctgfile = strtolower($font[<span class="stringliteral">&#39;ctg&#39;</span>]);
<a name="l11749"></a>11749             <span class="comment">// search and get ctg font file to embedd</span>
<a name="l11750"></a>11750             $fontfile = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11751"></a>11751             <span class="comment">// search files on various directories</span>
<a name="l11752"></a>11752             <span class="keywordflow">if</span> (($fontdir !== <span class="keyword">false</span>) AND file_exists($fontdir.$ctgfile)) {
<a name="l11753"></a>11753                 $fontfile = $fontdir.$ctgfile;
<a name="l11754"></a>11754             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (file_exists($this-&gt;_getfontpath().$ctgfile)) {
<a name="l11755"></a>11755                 $fontfile = $this-&gt;_getfontpath().$ctgfile;
<a name="l11756"></a>11756             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (file_exists($ctgfile)) {
<a name="l11757"></a>11757                 $fontfile = $ctgfile;
<a name="l11758"></a>11758             }
<a name="l11759"></a>11759             <span class="keywordflow">if</span> ($this-&gt;empty_string($fontfile)) {
<a name="l11760"></a>11760                 $this-&gt;Error(<span class="stringliteral">&#39;Font file not found: &#39;</span>.$ctgfile);
<a name="l11761"></a>11761             }
<a name="l11762"></a>11762             $stream = $this-&gt;_getrawstream(file_get_contents($fontfile));
<a name="l11763"></a>11763             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Length &#39;</span>.strlen($stream).<span class="stringliteral">&#39;&#39;</span>;
<a name="l11764"></a>11764             <span class="keywordflow">if</span> (substr($fontfile, -2) == <span class="stringliteral">&#39;.z&#39;</span>) { <span class="comment">// check file extension</span>
<a name="l11765"></a>11765                 <span class="comment">// Decompresses data encoded using the public-domain</span>
<a name="l11766"></a>11766                 <span class="comment">// zlib/deflate compression method, reproducing the</span>
<a name="l11767"></a>11767                 <span class="comment">// original text or binary data</span>
<a name="l11768"></a>11768                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;
<a name="l11769"></a>11769             }
<a name="l11770"></a>11770             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11771"></a>11771             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l11772"></a>11772             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11773"></a>11773             $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11774"></a>11774         }
<a name="l11775"></a>11775     }
<a name="l11776"></a>11776 <span class="comment"></span>
<a name="l11777"></a>11777 <span class="comment">    /**</span>
<a name="l11778"></a>11778 <span class="comment">     * Output CID-0 fonts.</span>
<a name="l11779"></a>11779 <span class="comment">     * A Type 0 CIDFont contains glyph descriptions based on the Adobe Type 1 font format</span>
<a name="l11780"></a>11780 <span class="comment">     * @param $font (array) font data</span>
<a name="l11781"></a>11781 <span class="comment">     * @protected</span>
<a name="l11782"></a>11782 <span class="comment">     * @author Andrew Whitehead, Nicola Asuni, Yukihiro Nakadaira</span>
<a name="l11783"></a>11783 <span class="comment">     * @since 3.2.000 (2008-06-23)</span>
<a name="l11784"></a>11784 <span class="comment">     */</span>
<a name="l11785"></a><a class="code" href="classTCPDF.html#a5b0c0782a3d4238495cb23e4e17ed13d">11785</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5b0c0782a3d4238495cb23e4e17ed13d" title="Output CID-0 fonts.">_putcidfont0</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>) {
<a name="l11786"></a>11786         $cidoffset = 0;
<a name="l11787"></a>11787         <span class="keywordflow">if</span> (!isset(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;cw&#39;</span>][1])) {
<a name="l11788"></a>11788             $cidoffset = 31;
<a name="l11789"></a>11789         }
<a name="l11790"></a>11790         <span class="keywordflow">if</span> (isset(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;uni2cid&#39;</span>])) {
<a name="l11791"></a>11791             <span class="comment">// convert unicode to cid.</span>
<a name="l11792"></a>11792             $uni2cid = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;uni2cid&#39;</span>];
<a name="l11793"></a>11793             <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> = array();
<a name="l11794"></a>11794             <span class="keywordflow">foreach</span> (<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;cw&#39;</span>] as $uni =&gt; $width) {
<a name="l11795"></a>11795                 <span class="keywordflow">if</span> (isset($uni2cid[$uni])) {
<a name="l11796"></a>11796                     <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>[($uni2cid[$uni] + $cidoffset)] = $width;
<a name="l11797"></a>11797                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($uni &lt; 256) {
<a name="l11798"></a>11798                     <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>[$uni] = $width;
<a name="l11799"></a>11799                 } <span class="comment">// else unknown character</span>
<a name="l11800"></a>11800             }
<a name="l11801"></a>11801             <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = array_merge(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, array(<span class="stringliteral">&#39;cw&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>));
<a name="l11802"></a>11802         }
<a name="l11803"></a>11803         <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;name&#39;</span>];
<a name="l11804"></a>11804         <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;enc&#39;</span>];
<a name="l11805"></a>11805         <span class="keywordflow">if</span> (<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>) {
<a name="l11806"></a>11806             $longname = <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>.<span class="charliteral">&#39;-&#39;</span>.<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>;
<a name="l11807"></a>11807         } <span class="keywordflow">else</span> {
<a name="l11808"></a>11808             $longname = <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>;
<a name="l11809"></a>11809         }
<a name="l11810"></a>11810         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;_getobj($this-&gt;font_obj_ids[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="stringliteral">&#39;fontkey&#39;</span>]]).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l11811"></a>11811         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt;/Type /Font&#39;</span>;
<a name="l11812"></a>11812         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /Type0&#39;</span>;
<a name="l11813"></a>11813         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$longname;
<a name="l11814"></a>11814         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Name /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>];
<a name="l11815"></a>11815         <span class="keywordflow">if</span> (<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>) {
<a name="l11816"></a>11816             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Encoding /&#39;</span>.$enc;
<a name="l11817"></a>11817         }
<a name="l11818"></a>11818         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DescendantFonts [&#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R]&#39;</span>;
<a name="l11819"></a>11819         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11820"></a>11820         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11821"></a>11821         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11822"></a>11822         $oid = $this-&gt;_newobj();
<a name="l11823"></a>11823         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;/Type /Font&#39;</span>;
<a name="l11824"></a>11824         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /CIDFontType0&#39;</span>;
<a name="l11825"></a>11825         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$name;
<a name="l11826"></a>11826         $cidinfo = <span class="stringliteral">&#39;/Registry &#39;</span>.$this-&gt;_datastring($font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Registry&#39;</span>], $oid);
<a name="l11827"></a>11827         $cidinfo .= <span class="stringliteral">&#39; /Ordering &#39;</span>.$this-&gt;_datastring($font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Ordering&#39;</span>], $oid);
<a name="l11828"></a>11828         $cidinfo .= <span class="stringliteral">&#39; /Supplement &#39;</span>.$font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Supplement&#39;</span>];
<a name="l11829"></a>11829         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CIDSystemInfo &lt;&lt;&#39;</span>.$cidinfo.<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l11830"></a>11830         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FontDescriptor &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11831"></a>11831         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DW &#39;</span>.$font[<span class="stringliteral">&#39;dw&#39;</span>];
<a name="l11832"></a>11832         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.$this-&gt;_putfontwidths($font, $cidoffset);
<a name="l11833"></a>11833         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11834"></a>11834         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11835"></a>11835         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11836"></a>11836         $this-&gt;_newobj();
<a name="l11837"></a>11837         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = <span class="stringliteral">&#39;&lt;&lt;/Type /FontDescriptor /FontName /&#39;</span>.$name;
<a name="l11838"></a>11838         <span class="keywordflow">foreach</span> ($font[<span class="stringliteral">&#39;desc&#39;</span>] as $k =&gt; $v) {
<a name="l11839"></a>11839             <span class="keywordflow">if</span> ($k != <span class="stringliteral">&#39;Style&#39;</span>) {
<a name="l11840"></a>11840                 <span class="keywordflow">if</span> (is_float($v)) {
<a name="l11841"></a>11841                     $v = sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, $v);
<a name="l11842"></a>11842                 }
<a name="l11843"></a>11843                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39; /&#39;</span>.$k.<span class="charliteral">&#39; &#39;</span>.$v.<span class="stringliteral">&#39;&#39;</span>;
<a name="l11844"></a>11844             }
<a name="l11845"></a>11845         }
<a name="l11846"></a>11846         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l11847"></a>11847         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11848"></a>11848         $this-&gt;_out(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l11849"></a>11849     }
<a name="l11850"></a>11850 <span class="comment"></span>
<a name="l11851"></a>11851 <span class="comment">    /**</span>
<a name="l11852"></a>11852 <span class="comment">     * Output images.</span>
<a name="l11853"></a>11853 <span class="comment">     * @protected</span>
<a name="l11854"></a>11854 <span class="comment">     */</span>
<a name="l11855"></a><a class="code" href="classTCPDF.html#a07ca3ed85ede02b10c0c6e55a63c762b">11855</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a07ca3ed85ede02b10c0c6e55a63c762b" title="Output images.">_putimages</a>() {
<a name="l11856"></a>11856         $filter = ($this-&gt;compress) ? <span class="stringliteral">&#39;/Filter /FlateDecode &#39;</span> : <span class="stringliteral">&#39;&#39;</span>;
<a name="l11857"></a>11857         <span class="keywordflow">foreach</span> ($this-&gt;imagekeys as <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>) {
<a name="l11858"></a>11858             $info = $this-&gt;getImageBuffer($file);
<a name="l11859"></a>11859             <span class="comment">// set object for alternate images array</span>
<a name="l11860"></a>11860             <span class="keywordflow">if</span> ((!$this-&gt;pdfa_mode) AND isset($info[<span class="stringliteral">&#39;altimgs&#39;</span>]) AND !empty($info[<span class="stringliteral">&#39;altimgs&#39;</span>])) {
<a name="l11861"></a>11861                 $altoid = $this-&gt;_newobj();
<a name="l11862"></a>11862                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="charliteral">&#39;[&#39;</span>;
<a name="l11863"></a>11863                 <span class="keywordflow">foreach</span> ($info[<span class="stringliteral">&#39;altimgs&#39;</span>] as $altimage) {
<a name="l11864"></a>11864                     <span class="keywordflow">if</span> (isset($this-&gt;xobjects[<span class="charliteral">&#39;I&#39;</span>.$altimage[0]][<span class="charliteral">&#39;n&#39;</span>])) {
<a name="l11865"></a>11865                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &lt;&lt; /Image &#39;</span>.$this-&gt;xobjects[<span class="charliteral">&#39;I&#39;</span>.$altimage[0]][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11866"></a>11866                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DefaultForPrinting&#39;</span>;
<a name="l11867"></a>11867                         <span class="keywordflow">if</span> ($altimage[1] === <span class="keyword">true</span>) {
<a name="l11868"></a>11868                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; true&#39;</span>;
<a name="l11869"></a>11869                         } <span class="keywordflow">else</span> {
<a name="l11870"></a>11870                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; false&#39;</span>;
<a name="l11871"></a>11871                         }
<a name="l11872"></a>11872                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11873"></a>11873                     }
<a name="l11874"></a>11874                 }
<a name="l11875"></a>11875                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; ]&#39;</span>;
<a name="l11876"></a>11876                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11877"></a>11877                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11878"></a>11878             }
<a name="l11879"></a>11879             <span class="comment">// set image object</span>
<a name="l11880"></a>11880             $oid = $this-&gt;_newobj();
<a name="l11881"></a>11881             $this-&gt;xobjects[<span class="charliteral">&#39;I&#39;</span>.$info[<span class="charliteral">&#39;i&#39;</span>]] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $oid);
<a name="l11882"></a>11882             $this-&gt;setImageSubBuffer($file, <span class="charliteral">&#39;n&#39;</span>, $this-&gt;n);
<a name="l11883"></a>11883             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;/Type /XObject&#39;</span>;
<a name="l11884"></a>11884             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /Image&#39;</span>;
<a name="l11885"></a>11885             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Width &#39;</span>.$info[<span class="charliteral">&#39;w&#39;</span>];
<a name="l11886"></a>11886             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Height &#39;</span>.$info[<span class="charliteral">&#39;h&#39;</span>];
<a name="l11887"></a>11887             <span class="keywordflow">if</span> (array_key_exists(<span class="stringliteral">&#39;masked&#39;</span>, $info)) {
<a name="l11888"></a>11888                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /SMask &#39;</span>.($this-&gt;n - 1).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11889"></a>11889             }
<a name="l11890"></a>11890             <span class="comment">// set color space</span>
<a name="l11891"></a>11891             $icc = <span class="keyword">false</span>;
<a name="l11892"></a>11892             <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;icc&#39;</span>]) AND ($info[<span class="stringliteral">&#39;icc&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l11893"></a>11893                 <span class="comment">// ICC Colour Space</span>
<a name="l11894"></a>11894                 $icc = <span class="keyword">true</span>;
<a name="l11895"></a>11895                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ColorSpace [/ICCBased &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R]&#39;</span>;
<a name="l11896"></a>11896             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($info[<span class="stringliteral">&#39;cs&#39;</span>] == <span class="stringliteral">&#39;Indexed&#39;</span>) {
<a name="l11897"></a>11897                 <span class="comment">// Indexed Colour Space</span>
<a name="l11898"></a>11898                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ColorSpace [/Indexed /DeviceRGB &#39;</span>.((strlen($info[<span class="stringliteral">&#39;pal&#39;</span>]) / 3) - 1).<span class="charliteral">&#39; &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R]&#39;</span>;
<a name="l11899"></a>11899             } <span class="keywordflow">else</span> {
<a name="l11900"></a>11900                 <span class="comment">// Device Colour Space</span>
<a name="l11901"></a>11901                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ColorSpace /&#39;</span>.$info[<span class="stringliteral">&#39;cs&#39;</span>];
<a name="l11902"></a>11902             }
<a name="l11903"></a>11903             <span class="keywordflow">if</span> ($info[<span class="stringliteral">&#39;cs&#39;</span>] == <span class="stringliteral">&#39;DeviceCMYK&#39;</span>) {
<a name="l11904"></a>11904                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Decode [1 0 1 0 1 0 1 0]&#39;</span>;
<a name="l11905"></a>11905             }
<a name="l11906"></a>11906             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BitsPerComponent &#39;</span>.$info[<span class="stringliteral">&#39;bpc&#39;</span>];
<a name="l11907"></a>11907             <span class="keywordflow">if</span> (isset($altoid) AND ($altoid &gt; 0)) {
<a name="l11908"></a>11908                 <span class="comment">// reference to alternate images dictionary</span>
<a name="l11909"></a>11909                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Alternates &#39;</span>.$altoid.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11910"></a>11910             }
<a name="l11911"></a>11911             <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;exurl&#39;</span>]) AND !empty($info[<span class="stringliteral">&#39;exurl&#39;</span>])) {
<a name="l11912"></a>11912                 <span class="comment">// external stream</span>
<a name="l11913"></a>11913                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length 0&#39;</span>;
<a name="l11914"></a>11914                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /F &lt;&lt; /FS /URL /F &#39;</span>.$this-&gt;_datastring($info[<span class="stringliteral">&#39;exurl&#39;</span>], $oid).<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11915"></a>11915                 <span class="keywordflow">if</span> (isset($info[<span class="charliteral">&#39;f&#39;</span>])) {
<a name="l11916"></a>11916                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FFilter /&#39;</span>.$info[<span class="charliteral">&#39;f&#39;</span>];
<a name="l11917"></a>11917                 }
<a name="l11918"></a>11918                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11919"></a>11919                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l11920"></a>11920             } <span class="keywordflow">else</span> {
<a name="l11921"></a>11921                 <span class="keywordflow">if</span> (isset($info[<span class="charliteral">&#39;f&#39;</span>])) {
<a name="l11922"></a>11922                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Filter /&#39;</span>.$info[<span class="charliteral">&#39;f&#39;</span>];
<a name="l11923"></a>11923                 }
<a name="l11924"></a>11924                 <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;parms&#39;</span>])) {
<a name="l11925"></a>11925                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.$info[<span class="stringliteral">&#39;parms&#39;</span>];
<a name="l11926"></a>11926                 }
<a name="l11927"></a>11927                 <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;trns&#39;</span>]) AND is_array($info[<span class="stringliteral">&#39;trns&#39;</span>])) {
<a name="l11928"></a>11928                     $trns = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11929"></a>11929                     $count_info = count($info[<span class="stringliteral">&#39;trns&#39;</span>]);
<a name="l11930"></a>11930                     <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $count_info; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l11931"></a>11931                         $trns .= $info[<span class="stringliteral">&#39;trns&#39;</span>][<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>].<span class="charliteral">&#39; &#39;</span>.$info[<span class="stringliteral">&#39;trns&#39;</span>][<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>].<span class="charliteral">&#39; &#39;</span>;
<a name="l11932"></a>11932                     }
<a name="l11933"></a>11933                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Mask [&#39;</span>.$trns.<span class="charliteral">&#39;]&#39;</span>;
<a name="l11934"></a>11934                 }
<a name="l11935"></a>11935                 $stream = $this-&gt;_getrawstream($info[<span class="stringliteral">&#39;data&#39;</span>]);
<a name="l11936"></a>11936                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream).<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11937"></a>11937                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l11938"></a>11938             }
<a name="l11939"></a>11939             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l11940"></a>11940             $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l11941"></a>11941             <span class="keywordflow">if</span> ($icc) {
<a name="l11942"></a>11942                 <span class="comment">// ICC colour profile</span>
<a name="l11943"></a>11943                 $this-&gt;_newobj();
<a name="l11944"></a>11944                 $icc = ($this-&gt;compress) ? gzcompress($info[<span class="stringliteral">&#39;icc&#39;</span>]) : $info[<span class="stringliteral">&#39;icc&#39;</span>];
<a name="l11945"></a>11945                 $icc = $this-&gt;_getrawstream($icc);
<a name="l11946"></a>11946                 $this-&gt;_out(<span class="stringliteral">&#39;&lt;&lt;/N &#39;</span>.$info[<span class="stringliteral">&#39;ch&#39;</span>].<span class="stringliteral">&#39; /Alternate /&#39;</span>.$info[<span class="stringliteral">&#39;cs&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($icc).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$icc.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);
<a name="l11947"></a>11947             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($info[<span class="stringliteral">&#39;cs&#39;</span>] == <span class="stringliteral">&#39;Indexed&#39;</span>) {
<a name="l11948"></a>11948                 <span class="comment">// colour palette</span>
<a name="l11949"></a>11949                 $this-&gt;_newobj();
<a name="l11950"></a>11950                 $pal = ($this-&gt;compress) ? gzcompress($info[<span class="stringliteral">&#39;pal&#39;</span>]) : $info[<span class="stringliteral">&#39;pal&#39;</span>];
<a name="l11951"></a>11951                 $pal = $this-&gt;_getrawstream($pal);
<a name="l11952"></a>11952                 $this-&gt;_out(<span class="stringliteral">&#39;&lt;&lt;&#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($pal).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$pal.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);
<a name="l11953"></a>11953             }
<a name="l11954"></a>11954         }
<a name="l11955"></a>11955     }
<a name="l11956"></a>11956 <span class="comment"></span>
<a name="l11957"></a>11957 <span class="comment">    /**</span>
<a name="l11958"></a>11958 <span class="comment">     * Output Form XObjects Templates.</span>
<a name="l11959"></a>11959 <span class="comment">     * @author Nicola Asuni</span>
<a name="l11960"></a>11960 <span class="comment">     * @since 5.8.017 (2010-08-24)</span>
<a name="l11961"></a>11961 <span class="comment">     * @protected</span>
<a name="l11962"></a>11962 <span class="comment">     * @see startTemplate(), endTemplate(), printTemplate()</span>
<a name="l11963"></a>11963 <span class="comment">     */</span>
<a name="l11964"></a><a class="code" href="classTCPDF.html#ac80fd149e908cb48ea0c796f5bc7961b">11964</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac80fd149e908cb48ea0c796f5bc7961b" title="Output Form XObjects Templates.">_putxobjects</a>() {
<a name="l11965"></a>11965         <span class="keywordflow">foreach</span> ($this-&gt;xobjects as $key =&gt; <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l11966"></a>11966             <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;outdata&#39;</span>])) {
<a name="l11967"></a>11967                 $stream = trim(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;outdata&#39;</span>]);
<a name="l11968"></a>11968                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;_getobj(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="charliteral">&#39;n&#39;</span>]).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l11969"></a>11969                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l11970"></a>11970                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Type /XObject&#39;</span>;
<a name="l11971"></a>11971                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /Form&#39;</span>;
<a name="l11972"></a>11972                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FormType 1&#39;</span>;
<a name="l11973"></a>11973                 <span class="keywordflow">if</span> ($this-&gt;compress) {
<a name="l11974"></a>11974                     $stream = gzcompress($stream);
<a name="l11975"></a>11975                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;
<a name="l11976"></a>11976                 }
<a name="l11977"></a>11977                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= sprintf(<span class="stringliteral">&#39; /BBox [%.2F %.2F %.2F %.2F]&#39;</span>, (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k), (-<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k), ((<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="charliteral">&#39;w&#39;</span>] + <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="charliteral">&#39;x&#39;</span>]) * $this-&gt;k), ((<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="charliteral">&#39;h&#39;</span>] - <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="charliteral">&#39;y&#39;</span>]) * $this-&gt;k));
<a name="l11978"></a>11978                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Matrix [1 0 0 1 0 0]&#39;</span>;
<a name="l11979"></a>11979                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Resources &lt;&lt;&#39;</span>;
<a name="l11980"></a>11980                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ProcSet [/PDF /Text /ImageB /ImageC /ImageI]&#39;</span>;
<a name="l11981"></a>11981                 <span class="keywordflow">if</span> (!$this-&gt;pdfa_mode) {
<a name="l11982"></a>11982                     <span class="comment">// transparency</span>
<a name="l11983"></a>11983                     <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;extgstates&#39;</span>]) AND !empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;extgstates&#39;</span>])) {
<a name="l11984"></a>11984                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ExtGState &lt;&lt;&#39;</span>;
<a name="l11985"></a>11985                         <span class="keywordflow">foreach</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;extgstates&#39;</span>] as $k =&gt; $extgstate) {
<a name="l11986"></a>11986                             <span class="keywordflow">if</span> (isset($this-&gt;extgstates[$k][<span class="stringliteral">&#39;name&#39;</span>])) {
<a name="l11987"></a>11987                                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$this-&gt;extgstates[$k][<span class="stringliteral">&#39;name&#39;</span>];
<a name="l11988"></a>11988                             } <span class="keywordflow">else</span> {
<a name="l11989"></a>11989                                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /GS&#39;</span>.$k;
<a name="l11990"></a>11990                             }
<a name="l11991"></a>11991                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;extgstates[$k][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l11992"></a>11992                         }
<a name="l11993"></a>11993                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l11994"></a>11994                     }
<a name="l11995"></a>11995                     <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;gradients&#39;</span>]) AND !empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;gradients&#39;</span>])) {
<a name="l11996"></a>11996                         $gp = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11997"></a>11997                         $gs = <span class="stringliteral">&#39;&#39;</span>;
<a name="l11998"></a>11998                         <span class="keywordflow">foreach</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;gradients&#39;</span>] as <a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a> =&gt; $grad) {
<a name="l11999"></a>11999                             <span class="comment">// gradient patterns</span>
<a name="l12000"></a>12000                             $gp .= <span class="stringliteral">&#39; /p&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$this-&gt;gradients[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>][<span class="stringliteral">&#39;pattern&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12001"></a>12001                             <span class="comment">// gradient shadings</span>
<a name="l12002"></a>12002                             $gs .= <span class="stringliteral">&#39; /Sh&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$this-&gt;gradients[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>][<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12003"></a>12003                         }
<a name="l12004"></a>12004                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Pattern &lt;&lt;&#39;</span>.$gp.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12005"></a>12005                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Shading &lt;&lt;&#39;</span>.$gs.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12006"></a>12006                     }
<a name="l12007"></a>12007                 }
<a name="l12008"></a>12008                 <span class="comment">// spot colors</span>
<a name="l12009"></a>12009                 <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;spot_colors&#39;</span>]) AND !empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;spot_colors&#39;</span>])) {
<a name="l12010"></a>12010                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ColorSpace &lt;&lt;&#39;</span>;
<a name="l12011"></a>12011                     <span class="keywordflow">foreach</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;spot_colors&#39;</span>] as <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> =&gt; $color) {
<a name="l12012"></a>12012                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CS&#39;</span>.$color[<span class="charliteral">&#39;i&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$this-&gt;spot_colors[<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12013"></a>12013                     }
<a name="l12014"></a>12014                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12015"></a>12015                 }
<a name="l12016"></a>12016                 <span class="comment">// fonts</span>
<a name="l12017"></a>12017                 <span class="keywordflow">if</span> (!empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;fonts&#39;</span>])) {
<a name="l12018"></a>12018                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Font &lt;&lt;&#39;</span>;
<a name="l12019"></a>12019                     <span class="keywordflow">foreach</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;fonts&#39;</span>] as $fontkey =&gt; $fontid) {
<a name="l12020"></a>12020                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /F&#39;</span>.$fontid.<span class="charliteral">&#39; &#39;</span>.$this-&gt;font_obj_ids[$fontkey].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12021"></a>12021                     }
<a name="l12022"></a>12022                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12023"></a>12023                 }
<a name="l12024"></a>12024                 <span class="comment">// images or nested xobjects</span>
<a name="l12025"></a>12025                 <span class="keywordflow">if</span> (!empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;images&#39;</span>]) OR !empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;xobjects&#39;</span>])) {
<a name="l12026"></a>12026                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /XObject &lt;&lt;&#39;</span>;
<a name="l12027"></a>12027                     <span class="keywordflow">foreach</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;images&#39;</span>] as $imgid) {
<a name="l12028"></a>12028                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /I&#39;</span>.$imgid.<span class="charliteral">&#39; &#39;</span>.$this-&gt;xobjects[<span class="charliteral">&#39;I&#39;</span>.$imgid][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12029"></a>12029                     }
<a name="l12030"></a>12030                     <span class="keywordflow">foreach</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;xobjects&#39;</span>] as $sub_id =&gt; $sub_objid) {
<a name="l12031"></a>12031                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$sub_id.<span class="charliteral">&#39; &#39;</span>.$sub_objid[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12032"></a>12032                     }
<a name="l12033"></a>12033                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12034"></a>12034                 }
<a name="l12035"></a>12035                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>; <span class="comment">//end resources</span>
<a name="l12036"></a>12036                 <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;group&#39;</span>]) AND (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;group&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l12037"></a>12037                     <span class="comment">// set transparency group</span>
<a name="l12038"></a>12038                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Group &lt;&lt; /Type /Group /S /Transparency&#39;</span>;
<a name="l12039"></a>12039                     <span class="keywordflow">if</span> (is_array(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;group&#39;</span>])) {
<a name="l12040"></a>12040                         <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;group&#39;</span>][<span class="stringliteral">&#39;CS&#39;</span>]) AND !empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;group&#39;</span>][<span class="stringliteral">&#39;CS&#39;</span>])) {
<a name="l12041"></a>12041                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CS /&#39;</span>.$data[<span class="stringliteral">&#39;group&#39;</span>][<span class="stringliteral">&#39;CS&#39;</span>];
<a name="l12042"></a>12042                         }
<a name="l12043"></a>12043                         <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;group&#39;</span>][<span class="charliteral">&#39;I&#39;</span>])) {
<a name="l12044"></a>12044                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /I /&#39;</span>.($data[<span class="stringliteral">&#39;group&#39;</span>][<span class="charliteral">&#39;I&#39;</span>]===<span class="keyword">true</span>?<span class="stringliteral">&#39;true&#39;</span>:<span class="stringliteral">&#39;false&#39;</span>);
<a name="l12045"></a>12045                         }
<a name="l12046"></a>12046                         <span class="keywordflow">if</span> (isset(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="stringliteral">&#39;group&#39;</span>][<span class="charliteral">&#39;K&#39;</span>])) {
<a name="l12047"></a>12047                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /K /&#39;</span>.($data[<span class="stringliteral">&#39;group&#39;</span>][<span class="charliteral">&#39;K&#39;</span>]===<span class="keyword">true</span>?<span class="stringliteral">&#39;true&#39;</span>:<span class="stringliteral">&#39;false&#39;</span>);
<a name="l12048"></a>12048                         }
<a name="l12049"></a>12049                     }
<a name="l12050"></a>12050                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12051"></a>12051                 }
<a name="l12052"></a>12052                 $stream = $this-&gt;_getrawstream($stream, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[<span class="charliteral">&#39;n&#39;</span>]);
<a name="l12053"></a>12053                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream);
<a name="l12054"></a>12054                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12055"></a>12055                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l12056"></a>12056                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l12057"></a>12057                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l12058"></a>12058             }
<a name="l12059"></a>12059         }
<a name="l12060"></a>12060     }
<a name="l12061"></a>12061 <span class="comment"></span>
<a name="l12062"></a>12062 <span class="comment">    /**</span>
<a name="l12063"></a>12063 <span class="comment">     * Output Spot Colors Resources.</span>
<a name="l12064"></a>12064 <span class="comment">     * @protected</span>
<a name="l12065"></a>12065 <span class="comment">     * @since 4.0.024 (2008-09-12)</span>
<a name="l12066"></a>12066 <span class="comment">     */</span>
<a name="l12067"></a><a class="code" href="classTCPDF.html#a1fe3c9e300219815332728c0f2216856">12067</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1fe3c9e300219815332728c0f2216856" title="Output Spot Colors Resources.">_putspotcolors</a>() {
<a name="l12068"></a>12068         <span class="keywordflow">foreach</span> ($this-&gt;spot_colors as <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> =&gt; $color) {
<a name="l12069"></a>12069             $this-&gt;_newobj();
<a name="l12070"></a>12070             $this-&gt;spot_colors[<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>][<span class="charliteral">&#39;n&#39;</span>] = $this-&gt;n;
<a name="l12071"></a>12071             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;[/Separation /&#39;</span>.str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;#20&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l12072"></a>12072             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DeviceCMYK &lt;&lt;&#39;</span>;
<a name="l12073"></a>12073             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Range [0 1 0 1 0 1 0 1] /C0 [0 0 0 0]&#39;</span>;
<a name="l12074"></a>12074             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;/C1 [%.4F %.4F %.4F %.4F] &#39;</span>, ($color[<span class="charliteral">&#39;C&#39;</span>] / 100), ($color[<span class="charliteral">&#39;M&#39;</span>] / 100), ($color[<span class="charliteral">&#39;Y&#39;</span>] / 100), ($color[<span class="charliteral">&#39;K&#39;</span>] / 100));
<a name="l12075"></a>12075             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FunctionType 2 /Domain [0 1] /N 1&gt;&gt;]&#39;</span>;
<a name="l12076"></a>12076             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l12077"></a>12077             $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l12078"></a>12078         }
<a name="l12079"></a>12079     }
<a name="l12080"></a>12080 <span class="comment"></span>
<a name="l12081"></a>12081 <span class="comment">    /**</span>
<a name="l12082"></a>12082 <span class="comment">     * Return XObjects Dictionary.</span>
<a name="l12083"></a>12083 <span class="comment">     * @return string XObjects dictionary</span>
<a name="l12084"></a>12084 <span class="comment">     * @protected</span>
<a name="l12085"></a>12085 <span class="comment">     * @since 5.8.014 (2010-08-23)</span>
<a name="l12086"></a>12086 <span class="comment">     */</span>
<a name="l12087"></a><a class="code" href="classTCPDF.html#a7355db3de3a948cc20f408c42542962c">12087</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7355db3de3a948cc20f408c42542962c" title="Return XObjects Dictionary.">_getxobjectdict</a>() {
<a name="l12088"></a>12088         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l12089"></a>12089         <span class="keywordflow">foreach</span> ($this-&gt;xobjects as <a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a> =&gt; $objid) {
<a name="l12090"></a>12090             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$objid[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12091"></a>12091         }
<a name="l12092"></a>12092         <span class="keywordflow">return</span> <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>;
<a name="l12093"></a>12093     }
<a name="l12094"></a>12094 <span class="comment"></span>
<a name="l12095"></a>12095 <span class="comment">    /**</span>
<a name="l12096"></a>12096 <span class="comment">     * Output Resources Dictionary.</span>
<a name="l12097"></a>12097 <span class="comment">     * @protected</span>
<a name="l12098"></a>12098 <span class="comment">     */</span>
<a name="l12099"></a><a class="code" href="classTCPDF.html#aef5168b3e7714914541a1632f5eeb01b">12099</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aef5168b3e7714914541a1632f5eeb01b" title="Output Resources Dictionary.">_putresourcedict</a>() {
<a name="l12100"></a>12100         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;_getobj(2).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12101"></a>12101         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt; /ProcSet [/PDF /Text /ImageB /ImageC /ImageI]&#39;</span>;
<a name="l12102"></a>12102         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Font &lt;&lt;&#39;</span>;
<a name="l12103"></a>12103         <span class="keywordflow">foreach</span> ($this-&gt;fontkeys as $fontkey) {
<a name="l12104"></a>12104             <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = $this-&gt;getFontBuffer($fontkey);
<a name="l12105"></a>12105             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>].<span class="charliteral">&#39; &#39;</span>.<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12106"></a>12106         }
<a name="l12107"></a>12107         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12108"></a>12108         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /XObject &lt;&lt;&#39;</span>;
<a name="l12109"></a>12109         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= $this-&gt;_getxobjectdict();
<a name="l12110"></a>12110         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12111"></a>12111         <span class="comment">// layers</span>
<a name="l12112"></a>12112         <span class="keywordflow">if</span> (!empty($this-&gt;pdflayers)) {
<a name="l12113"></a>12113             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Properties &lt;&lt;&#39;</span>;
<a name="l12114"></a>12114             <span class="keywordflow">foreach</span> ($this-&gt;pdflayers as $layer) {
<a name="l12115"></a>12115                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$layer[<span class="stringliteral">&#39;layer&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$layer[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12116"></a>12116             }
<a name="l12117"></a>12117             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12118"></a>12118         }
<a name="l12119"></a>12119         <span class="keywordflow">if</span> (!$this-&gt;pdfa_mode) {
<a name="l12120"></a>12120             <span class="comment">// transparency</span>
<a name="l12121"></a>12121             <span class="keywordflow">if</span> (isset($this-&gt;extgstates) AND !empty($this-&gt;extgstates)) {
<a name="l12122"></a>12122                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ExtGState &lt;&lt;&#39;</span>;
<a name="l12123"></a>12123                 <span class="keywordflow">foreach</span> ($this-&gt;extgstates as $k =&gt; $extgstate) {
<a name="l12124"></a>12124                     <span class="keywordflow">if</span> (isset($extgstate[<span class="stringliteral">&#39;name&#39;</span>])) {
<a name="l12125"></a>12125                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$extgstate[<span class="stringliteral">&#39;name&#39;</span>];
<a name="l12126"></a>12126                     } <span class="keywordflow">else</span> {
<a name="l12127"></a>12127                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /GS&#39;</span>.$k;
<a name="l12128"></a>12128                     }
<a name="l12129"></a>12129                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.$extgstate[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12130"></a>12130                 }
<a name="l12131"></a>12131                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12132"></a>12132             }
<a name="l12133"></a>12133             <span class="keywordflow">if</span> (isset($this-&gt;gradients) AND !empty($this-&gt;gradients)) {
<a name="l12134"></a>12134                 $gp = <span class="stringliteral">&#39;&#39;</span>;
<a name="l12135"></a>12135                 $gs = <span class="stringliteral">&#39;&#39;</span>;
<a name="l12136"></a>12136                 <span class="keywordflow">foreach</span> ($this-&gt;gradients as <a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a> =&gt; $grad) {
<a name="l12137"></a>12137                     <span class="comment">// gradient patterns</span>
<a name="l12138"></a>12138                     $gp .= <span class="stringliteral">&#39; /p&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$grad[<span class="stringliteral">&#39;pattern&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12139"></a>12139                     <span class="comment">// gradient shadings</span>
<a name="l12140"></a>12140                     $gs .= <span class="stringliteral">&#39; /Sh&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$grad[<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12141"></a>12141                 }
<a name="l12142"></a>12142                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Pattern &lt;&lt;&#39;</span>.$gp.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12143"></a>12143                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Shading &lt;&lt;&#39;</span>.$gs.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12144"></a>12144             }
<a name="l12145"></a>12145         }
<a name="l12146"></a>12146         <span class="comment">// spot colors</span>
<a name="l12147"></a>12147         <span class="keywordflow">if</span> (isset($this-&gt;spot_colors) AND !empty($this-&gt;spot_colors)) {
<a name="l12148"></a>12148             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ColorSpace &lt;&lt;&#39;</span>;
<a name="l12149"></a>12149             <span class="keywordflow">foreach</span> ($this-&gt;spot_colors as $color) {
<a name="l12150"></a>12150                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CS&#39;</span>.$color[<span class="charliteral">&#39;i&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$color[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12151"></a>12151             }
<a name="l12152"></a>12152             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12153"></a>12153         }
<a name="l12154"></a>12154         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12155"></a>12155         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l12156"></a>12156         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l12157"></a>12157     }
<a name="l12158"></a>12158 <span class="comment"></span>
<a name="l12159"></a>12159 <span class="comment">    /**</span>
<a name="l12160"></a>12160 <span class="comment">     * Output Resources.</span>
<a name="l12161"></a>12161 <span class="comment">     * @protected</span>
<a name="l12162"></a>12162 <span class="comment">     */</span>
<a name="l12163"></a><a class="code" href="classTCPDF.html#a3f31f18974b7e7626d8fc99dbbe51d90">12163</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3f31f18974b7e7626d8fc99dbbe51d90" title="Output Resources.">_putresources</a>() {
<a name="l12164"></a>12164         $this-&gt;_putextgstates();
<a name="l12165"></a>12165         $this-&gt;_putocg();
<a name="l12166"></a>12166         $this-&gt;_putfonts();
<a name="l12167"></a>12167         $this-&gt;_putimages();
<a name="l12168"></a>12168         $this-&gt;_putspotcolors();
<a name="l12169"></a>12169         $this-&gt;_putshaders();
<a name="l12170"></a>12170         $this-&gt;_putxobjects();
<a name="l12171"></a>12171         $this-&gt;_putresourcedict();
<a name="l12172"></a>12172         $this-&gt;_putdests();
<a name="l12173"></a>12173         $this-&gt;_putbookmarks();
<a name="l12174"></a>12174         $this-&gt;_putEmbeddedFiles();
<a name="l12175"></a>12175         $this-&gt;_putannotsobjs();
<a name="l12176"></a>12176         $this-&gt;_putjavascript();
<a name="l12177"></a>12177         $this-&gt;_putencryption();
<a name="l12178"></a>12178     }
<a name="l12179"></a>12179 <span class="comment"></span>
<a name="l12180"></a>12180 <span class="comment">    /**</span>
<a name="l12181"></a>12181 <span class="comment">     * Adds some Metadata information (Document Information Dictionary)</span>
<a name="l12182"></a>12182 <span class="comment">     * (see Chapter 14.3.3 Document Information Dictionary of PDF32000_2008.pdf Reference)</span>
<a name="l12183"></a>12183 <span class="comment">     * @return int object id</span>
<a name="l12184"></a>12184 <span class="comment">     * @protected</span>
<a name="l12185"></a>12185 <span class="comment">     */</span>
<a name="l12186"></a><a class="code" href="classTCPDF.html#a7381d7ff2d161c30e0ee5156c956c638">12186</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7381d7ff2d161c30e0ee5156c956c638" title="Adds some Metadata information (Document Information Dictionary) (see Chapter 14.3.3 Document Information Dictionary of PDF32000_2008.pdf Reference)">_putinfo</a>() {
<a name="l12187"></a>12187         $oid = $this-&gt;_newobj();
<a name="l12188"></a>12188         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l12189"></a>12189         <span class="comment">// store current isunicode value</span>
<a name="l12190"></a>12190         $prev_isunicode = $this-&gt;isunicode;
<a name="l12191"></a>12191         <span class="keywordflow">if</span> ($this-&gt;docinfounicode) {
<a name="l12192"></a>12192             $this-&gt;isunicode = <span class="keyword">true</span>;
<a name="l12193"></a>12193         }
<a name="l12194"></a>12194         <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;title)) {
<a name="l12195"></a>12195             <span class="comment">// The document&#39;s title.</span>
<a name="l12196"></a>12196             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Title &#39;</span>.$this-&gt;_textstring($this-&gt;title, $oid);
<a name="l12197"></a>12197         }
<a name="l12198"></a>12198         <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;author)) {
<a name="l12199"></a>12199             <span class="comment">// The name of the person who created the document.</span>
<a name="l12200"></a>12200             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Author &#39;</span>.$this-&gt;_textstring($this-&gt;author, $oid);
<a name="l12201"></a>12201         }
<a name="l12202"></a>12202         <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;subject)) {
<a name="l12203"></a>12203             <span class="comment">// The subject of the document.</span>
<a name="l12204"></a>12204             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subject &#39;</span>.$this-&gt;_textstring($this-&gt;subject, $oid);
<a name="l12205"></a>12205         }
<a name="l12206"></a>12206         <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;keywords)) {
<a name="l12207"></a>12207             <span class="comment">// Keywords associated with the document.</span>
<a name="l12208"></a>12208             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Keywords &#39;</span>.$this-&gt;_textstring($this-&gt;keywords.<span class="stringliteral">&#39; TCPDF&#39;</span>, $oid);
<a name="l12209"></a>12209         }
<a name="l12210"></a>12210         <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;creator)) {
<a name="l12211"></a>12211             <span class="comment">// If the document was converted to PDF from another format, the name of the conforming product that created the original document from which it was converted.</span>
<a name="l12212"></a>12212             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Creator &#39;</span>.$this-&gt;_textstring($this-&gt;creator, $oid);
<a name="l12213"></a>12213         }
<a name="l12214"></a>12214         <span class="comment">// restore previous isunicode value</span>
<a name="l12215"></a>12215         $this-&gt;isunicode = $prev_isunicode;
<a name="l12216"></a>12216         <span class="comment">// default producer</span>
<a name="l12217"></a>12217         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Producer &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&quot;\x54\x43\x50\x44\x46\x20&quot;</span>.$this-&gt;tcpdf_version.<span class="stringliteral">&quot;\x20\x28\x68\x74\x74\x70\x3a\x2f\x2f\x77\x77\x77\x2e\x74\x63\x70\x64\x66\x2e\x6f\x72\x67\x29&quot;</span>, $oid);
<a name="l12218"></a>12218         <span class="comment">// The date and time the document was created, in human-readable form</span>
<a name="l12219"></a>12219         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CreationDate &#39;</span>.$this-&gt;_datestring();
<a name="l12220"></a>12220         <span class="comment">// The date and time the document was most recently modified, in human-readable form</span>
<a name="l12221"></a>12221         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ModDate &#39;</span>.$this-&gt;_datestring();
<a name="l12222"></a>12222         <span class="comment">// A name object indicating whether the document has been modified to include trapping information</span>
<a name="l12223"></a>12223         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Trapped /False&#39;</span>;
<a name="l12224"></a>12224         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12225"></a>12225         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l12226"></a>12226         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l12227"></a>12227         <span class="keywordflow">return</span> $oid;
<a name="l12228"></a>12228     }
<a name="l12229"></a>12229 <span class="comment"></span>
<a name="l12230"></a>12230 <span class="comment">    /**</span>
<a name="l12231"></a>12231 <span class="comment">     * Set additional XMP data to be added on the default XMP data just before the end of &quot;x:xmpmeta&quot; tag.</span>
<a name="l12232"></a>12232 <span class="comment">     * IMPORTANT: This data is added as-is without controls, so you have to validate your data before using this method!</span>
<a name="l12233"></a>12233 <span class="comment">     * @param $xmp (string) Custom XMP data.</span>
<a name="l12234"></a>12234 <span class="comment">     * @since 5.9.128 (2011-10-06)</span>
<a name="l12235"></a>12235 <span class="comment">     * @public</span>
<a name="l12236"></a>12236 <span class="comment">     */</span>
<a name="l12237"></a><a class="code" href="classTCPDF.html#a951ded3fd87dba651b96586dc39bf1a8">12237</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a951ded3fd87dba651b96586dc39bf1a8" title="Set additional XMP data to be added on the default XMP data just before the end of &quot;x:xmpmeta&quot; tag...">setExtraXMP</a>($xmp) {
<a name="l12238"></a>12238         $this-&gt;custom_xmp = $xmp;
<a name="l12239"></a>12239     }
<a name="l12240"></a>12240 <span class="comment"></span>
<a name="l12241"></a>12241 <span class="comment">    /**</span>
<a name="l12242"></a>12242 <span class="comment">     * Put XMP data object and return ID.</span>
<a name="l12243"></a>12243 <span class="comment">     * @return (int) The object ID.</span>
<a name="l12244"></a>12244 <span class="comment">     * @since 5.9.121 (2011-09-28)</span>
<a name="l12245"></a>12245 <span class="comment">     * @protected</span>
<a name="l12246"></a>12246 <span class="comment">     */</span>
<a name="l12247"></a><a class="code" href="classTCPDF.html#a570325299ecf78f328faa53e8758a015">12247</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a570325299ecf78f328faa53e8758a015" title="Put XMP data object and return ID.">_putXMP</a>() {
<a name="l12248"></a>12248         $oid = $this-&gt;_newobj();
<a name="l12249"></a>12249         <span class="comment">// store current isunicode value</span>
<a name="l12250"></a>12250         $prev_isunicode = $this-&gt;isunicode;
<a name="l12251"></a>12251         $this-&gt;isunicode = <span class="keyword">true</span>;
<a name="l12252"></a>12252         $prev_encrypted = $this-&gt;encrypted;
<a name="l12253"></a>12253         $this-&gt;encrypted = <span class="keyword">false</span>;
<a name="l12254"></a>12254         <span class="comment">// set XMP data</span>
<a name="l12255"></a>12255         $xmp = <span class="stringliteral">&#39;&lt;?xpacket begin=&quot;&#39;</span>.$this-&gt;unichr(0xfeff).<span class="stringliteral">&#39;&quot; id=&quot;W5M0MpCehiHzreSzNTczkc9d&quot;?&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12256"></a>12256         $xmp .= <span class="stringliteral">&#39;&lt;x:xmpmeta xmlns:x=&quot;adobe:ns:meta/&quot; x:xmptk=&quot;Adobe XMP Core 4.2.1-c043 52.372728, 2009/01/18-15:08:04&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12257"></a>12257         $xmp .= <span class="stringliteral">&quot;\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12258"></a>12258         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12259"></a>12259         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:format&gt;application/pdf&lt;/dc:format&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12260"></a>12260         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:title&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12261"></a>12261         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Alt&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12262"></a>12262         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li xml:lang=&quot;x-default&quot;&gt;&#39;</span>.$this-&gt;_escapeXML($this-&gt;title).<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12263"></a>12263         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Alt&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12264"></a>12264         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/dc:title&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12265"></a>12265         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:creator&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12266"></a>12266         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12267"></a>12267         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li&gt;&#39;</span>.$this-&gt;_escapeXML($this-&gt;author).<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12268"></a>12268         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12269"></a>12269         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/dc:creator&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12270"></a>12270         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12271"></a>12271         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Alt&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12272"></a>12272         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li xml:lang=&quot;x-default&quot;&gt;&#39;</span>.$this-&gt;_escapeXML($this-&gt;subject).<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12273"></a>12273         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Alt&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12274"></a>12274         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/dc:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12275"></a>12275         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:subject&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12276"></a>12276         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Bag&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12277"></a>12277         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li&gt;&#39;</span>.$this-&gt;_escapeXML($this-&gt;keywords).<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12278"></a>12278         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Bag&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12279"></a>12279         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/dc:subject&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12280"></a>12280         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12281"></a>12281         <span class="comment">// convert date format</span>
<a name="l12282"></a>12282         $docdate = substr($this-&gt;doc_date, 0, 4).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;doc_date, 4, 2).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;doc_date, 6, 2);
<a name="l12283"></a>12283         $docdate .= <span class="charliteral">&#39;T&#39;</span>.substr($this-&gt;doc_date, 8, 2).<span class="charliteral">&#39;:&#39;</span>.substr($this-&gt;doc_date, 10, 2).<span class="charliteral">&#39;:&#39;</span>.substr($this-&gt;doc_date, 12, 2);
<a name="l12284"></a>12284         $docdate .= <span class="charliteral">&#39;+&#39;</span>.substr($this-&gt;doc_date, 15, 2).<span class="charliteral">&#39;:&#39;</span>.substr($this-&gt;doc_date, 18, 2);
<a name="l12285"></a>12285         $docdate = $this-&gt;_escapeXML($docdate);
<a name="l12286"></a>12286         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:xmp=&quot;http://ns.adobe.com/xap/1.0/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12287"></a>12287         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmp:CreateDate&gt;&#39;</span>.$docdate.<span class="stringliteral">&#39;&lt;/xmp:CreateDate&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12288"></a>12288         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmp:CreatorTool&gt;&#39;</span>.$this-&gt;creator.<span class="stringliteral">&#39;&lt;/xmp:CreatorTool&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12289"></a>12289         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmp:ModifyDate&gt;&#39;</span>.$docdate.<span class="stringliteral">&#39;&lt;/xmp:ModifyDate&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12290"></a>12290         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmp:MetadataDate&gt;&#39;</span>.$docdate.<span class="stringliteral">&#39;&lt;/xmp:MetadataDate&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12291"></a>12291         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12292"></a>12292         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:pdf=&quot;http://ns.adobe.com/pdf/1.3/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12293"></a>12293         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdf:Keywords&gt;&#39;</span>.$this-&gt;_escapeXML($this-&gt;keywords).<span class="stringliteral">&#39; TCPDF&lt;/pdf:Keywords&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12294"></a>12294         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdf:Producer&gt;&#39;</span>.$this-&gt;_escapeXML(<span class="stringliteral">&quot;\x54\x43\x50\x44\x46\x20&quot;</span>.$this-&gt;tcpdf_version.<span class="stringliteral">&quot;\x20\x28\x68\x74\x74\x70\x3a\x2f\x2f\x77\x77\x77\x2e\x74\x63\x70\x64\x66\x2e\x6f\x72\x67\x29&quot;</span>).<span class="stringliteral">&#39;&lt;/pdf:Producer&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12295"></a>12295         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12296"></a>12296         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:xmpMM=&quot;http://ns.adobe.com/xap/1.0/mm/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12297"></a>12297         $uuid = <span class="stringliteral">&#39;uuid:&#39;</span>.substr($this-&gt;file_id, 0, 8).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;file_id, 8, 4).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;file_id, 12, 4).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;file_id, 16, 4).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;file_id, 20, 12);
<a name="l12298"></a>12298         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmpMM:DocumentID&gt;&#39;</span>.$uuid.<span class="stringliteral">&#39;&lt;/xmpMM:DocumentID&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12299"></a>12299         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmpMM:InstanceID&gt;&#39;</span>.$uuid.<span class="stringliteral">&#39;&lt;/xmpMM:InstanceID&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12300"></a>12300         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12301"></a>12301         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l12302"></a>12302             $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:pdfaid=&quot;http://www.aiim.org/pdfa/ns/id/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12303"></a>12303             $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaid:part&gt;1&lt;/pdfaid:part&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12304"></a>12304             $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaid:conformance&gt;B&lt;/pdfaid:conformance&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12305"></a>12305             $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12306"></a>12306         }
<a name="l12307"></a>12307         <span class="comment">// XMP extension schemas</span>
<a name="l12308"></a>12308         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:pdfaExtension=&quot;http://www.aiim.org/pdfa/ns/extension/&quot; xmlns:pdfaSchema=&quot;http://www.aiim.org/pdfa/ns/schema#&quot; xmlns:pdfaProperty=&quot;http://www.aiim.org/pdfa/ns/property#&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12309"></a>12309         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaExtension:schemas&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12310"></a>12310         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Bag&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12311"></a>12311         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12312"></a>12312         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:namespaceURI&gt;http://ns.adobe.com/pdf/1.3/&lt;/pdfaSchema:namespaceURI&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12313"></a>12313         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:prefix&gt;pdf&lt;/pdfaSchema:prefix&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12314"></a>12314         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:schema&gt;Adobe PDF Schema&lt;/pdfaSchema:schema&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12315"></a>12315         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12316"></a>12316         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12317"></a>12317         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:namespaceURI&gt;http://ns.adobe.com/xap/1.0/mm/&lt;/pdfaSchema:namespaceURI&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12318"></a>12318         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:prefix&gt;xmpMM&lt;/pdfaSchema:prefix&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12319"></a>12319         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:schema&gt;XMP Media Management Schema&lt;/pdfaSchema:schema&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12320"></a>12320         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:property&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12321"></a>12321         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12322"></a>12322         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12323"></a>12323         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:category&gt;internal&lt;/pdfaProperty:category&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12324"></a>12324         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:description&gt;UUID based identifier for specific incarnation of a document&lt;/pdfaProperty:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12325"></a>12325         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:name&gt;InstanceID&lt;/pdfaProperty:name&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12326"></a>12326         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:valueType&gt;URI&lt;/pdfaProperty:valueType&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12327"></a>12327         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12328"></a>12328         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12329"></a>12329         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/pdfaSchema:property&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12330"></a>12330         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12331"></a>12331         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12332"></a>12332         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:namespaceURI&gt;http://www.aiim.org/pdfa/ns/id/&lt;/pdfaSchema:namespaceURI&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12333"></a>12333         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:prefix&gt;pdfaid&lt;/pdfaSchema:prefix&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12334"></a>12334         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:schema&gt;PDF/A ID Schema&lt;/pdfaSchema:schema&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12335"></a>12335         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:property&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12336"></a>12336         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12337"></a>12337         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12338"></a>12338         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:category&gt;internal&lt;/pdfaProperty:category&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12339"></a>12339         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:description&gt;Part of PDF/A standard&lt;/pdfaProperty:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12340"></a>12340         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:name&gt;part&lt;/pdfaProperty:name&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12341"></a>12341         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:valueType&gt;Integer&lt;/pdfaProperty:valueType&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12342"></a>12342         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12343"></a>12343         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12344"></a>12344         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:category&gt;internal&lt;/pdfaProperty:category&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12345"></a>12345         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:description&gt;Amendment of PDF/A standard&lt;/pdfaProperty:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12346"></a>12346         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:name&gt;amd&lt;/pdfaProperty:name&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12347"></a>12347         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:valueType&gt;Text&lt;/pdfaProperty:valueType&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12348"></a>12348         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12349"></a>12349         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12350"></a>12350         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:category&gt;internal&lt;/pdfaProperty:category&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12351"></a>12351         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:description&gt;Conformance level of PDF/A standard&lt;/pdfaProperty:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12352"></a>12352         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:name&gt;conformance&lt;/pdfaProperty:name&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12353"></a>12353         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:valueType&gt;Text&lt;/pdfaProperty:valueType&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12354"></a>12354         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12355"></a>12355         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12356"></a>12356         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/pdfaSchema:property&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12357"></a>12357         $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12358"></a>12358         $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Bag&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12359"></a>12359         $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/pdfaExtension:schemas&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12360"></a>12360         $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12361"></a>12361         $xmp .= <span class="stringliteral">&quot;\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:RDF&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12362"></a>12362         $xmp .= $this-&gt;custom_xmp;
<a name="l12363"></a>12363         $xmp .= <span class="stringliteral">&#39;&lt;/x:xmpmeta&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12364"></a>12364         $xmp .= <span class="stringliteral">&#39;&lt;?xpacket end=&quot;w&quot;?&gt;&#39;</span>;
<a name="l12365"></a>12365         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /Metadata /Subtype /XML /Length &#39;</span>.strlen($xmp).<span class="stringliteral">&#39; &gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$xmp.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l12366"></a>12366         <span class="comment">// restore previous isunicode value</span>
<a name="l12367"></a>12367         $this-&gt;isunicode = $prev_isunicode;
<a name="l12368"></a>12368         $this-&gt;encrypted = $prev_encrypted;
<a name="l12369"></a>12369         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l12370"></a>12370         <span class="keywordflow">return</span> $oid;
<a name="l12371"></a>12371     }
<a name="l12372"></a>12372 <span class="comment"></span>
<a name="l12373"></a>12373 <span class="comment">    /**</span>
<a name="l12374"></a>12374 <span class="comment">     * Output Catalog.</span>
<a name="l12375"></a>12375 <span class="comment">     * @return int object id</span>
<a name="l12376"></a>12376 <span class="comment">     * @protected</span>
<a name="l12377"></a>12377 <span class="comment">     */</span>
<a name="l12378"></a><a class="code" href="classTCPDF.html#a795063487ebbe283e4b5e74f66ee6e23">12378</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a795063487ebbe283e4b5e74f66ee6e23" title="Output Catalog.">_putcatalog</a>() {
<a name="l12379"></a>12379         <span class="comment">// put XMP</span>
<a name="l12380"></a>12380         $xmpobj = $this-&gt;_putXMP();
<a name="l12381"></a>12381         <span class="comment">// if required, add standard sRGB_IEC61966-2.1 blackscaled ICC colour profile</span>
<a name="l12382"></a>12382         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode OR $this-&gt;force_srgb) {
<a name="l12383"></a>12383             $iccobj = $this-&gt;_newobj();
<a name="l12384"></a>12384             $icc = file_get_contents(dirname(__FILE__).<span class="stringliteral">&#39;/sRGB.icc&#39;</span>);
<a name="l12385"></a>12385             $filter = <span class="stringliteral">&#39;&#39;</span>;
<a name="l12386"></a>12386             <span class="keywordflow">if</span> ($this-&gt;compress) {
<a name="l12387"></a>12387                 $filter = <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;
<a name="l12388"></a>12388                 $icc = gzcompress($icc);
<a name="l12389"></a>12389             }
<a name="l12390"></a>12390             $icc = $this-&gt;_getrawstream($icc);
<a name="l12391"></a>12391             $this-&gt;_out(<span class="stringliteral">&#39;&lt;&lt;/N 3 &#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($icc).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$icc.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);
<a name="l12392"></a>12392         }
<a name="l12393"></a>12393         <span class="comment">// start catalog</span>
<a name="l12394"></a>12394         $oid = $this-&gt;_newobj();
<a name="l12395"></a>12395         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /Catalog&#39;</span>;
<a name="l12396"></a>12396         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Version /&#39;</span>.$this-&gt;PDFVersion;
<a name="l12397"></a>12397         <span class="comment">//$out .= &#39; /Extensions &lt;&lt;&gt;&gt;&#39;;</span>
<a name="l12398"></a>12398         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Pages 1 0 R&#39;</span>;
<a name="l12399"></a>12399         <span class="comment">//$out .= &#39; /PageLabels &#39; //...;</span>
<a name="l12400"></a>12400         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Names &lt;&lt;&#39;</span>;
<a name="l12401"></a>12401         <span class="keywordflow">if</span> ((!$this-&gt;pdfa_mode) AND ((!empty($this-&gt;javascript)) OR (!empty($this-&gt;js_objects)))) {
<a name="l12402"></a>12402             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /JavaScript &#39;</span>.($this-&gt;n_js).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12403"></a>12403         }
<a name="l12404"></a>12404         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12405"></a>12405         <span class="keywordflow">if</span> (!empty($this-&gt;dests)) {
<a name="l12406"></a>12406             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Dests &#39;</span>.$this-&gt;n_dests.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12407"></a>12407         }
<a name="l12408"></a>12408         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= $this-&gt;_putviewerpreferences();
<a name="l12409"></a>12409         <span class="keywordflow">if</span> (isset($this-&gt;LayoutMode) AND (!$this-&gt;empty_string($this-&gt;LayoutMode))) {
<a name="l12410"></a>12410             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PageLayout /&#39;</span>.$this-&gt;LayoutMode;
<a name="l12411"></a>12411         }
<a name="l12412"></a>12412         <span class="keywordflow">if</span> (isset($this-&gt;PageMode) AND (!$this-&gt;empty_string($this-&gt;PageMode))) {
<a name="l12413"></a>12413             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PageMode /&#39;</span>.$this-&gt;PageMode;
<a name="l12414"></a>12414         }
<a name="l12415"></a>12415         <span class="keywordflow">if</span> (count($this-&gt;outlines) &gt; 0) {
<a name="l12416"></a>12416             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Outlines &#39;</span>.$this-&gt;OutlineRoot.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12417"></a>12417             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PageMode /UseOutlines&#39;</span>;
<a name="l12418"></a>12418         }
<a name="l12419"></a>12419         <span class="comment">//$out .= &#39; /Threads []&#39;;</span>
<a name="l12420"></a>12420         <span class="keywordflow">if</span> ($this-&gt;ZoomMode == <span class="stringliteral">&#39;fullpage&#39;</span>) {
<a name="l12421"></a>12421             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /OpenAction [&#39;</span>.$this-&gt;page_obj_id[1].<span class="stringliteral">&#39; 0 R /Fit]&#39;</span>;
<a name="l12422"></a>12422         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;ZoomMode == <span class="stringliteral">&#39;fullwidth&#39;</span>) {
<a name="l12423"></a>12423             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /OpenAction [&#39;</span>.$this-&gt;page_obj_id[1].<span class="stringliteral">&#39; 0 R /FitH null]&#39;</span>;
<a name="l12424"></a>12424         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;ZoomMode == <span class="stringliteral">&#39;real&#39;</span>) {
<a name="l12425"></a>12425             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /OpenAction [&#39;</span>.$this-&gt;page_obj_id[1].<span class="stringliteral">&#39; 0 R /XYZ null null 1]&#39;</span>;
<a name="l12426"></a>12426         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (!is_string($this-&gt;ZoomMode)) {
<a name="l12427"></a>12427             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= sprintf(<span class="stringliteral">&#39; /OpenAction [&#39;</span>.$this-&gt;page_obj_id[1].<span class="stringliteral">&#39; 0 R /XYZ null null %.2F]&#39;</span>, ($this-&gt;ZoomMode / 100));
<a name="l12428"></a>12428         }
<a name="l12429"></a>12429         <span class="comment">//$out .= &#39; /AA &lt;&lt;&gt;&gt;&#39;;</span>
<a name="l12430"></a>12430         <span class="comment">//$out .= &#39; /URI &lt;&lt;&gt;&gt;&#39;;</span>
<a name="l12431"></a>12431         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Metadata &#39;</span>.$xmpobj.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12432"></a>12432         <span class="comment">//$out .= &#39; /StructTreeRoot &lt;&lt;&gt;&gt;&#39;;</span>
<a name="l12433"></a>12433         <span class="comment">//$out .= &#39; /MarkInfo &lt;&lt;&gt;&gt;&#39;;</span>
<a name="l12434"></a>12434         <span class="keywordflow">if</span> (isset($this-&gt;l[<span class="stringliteral">&#39;a_meta_language&#39;</span>])) {
<a name="l12435"></a>12435             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Lang &#39;</span>.$this-&gt;_textstring($this-&gt;l[<span class="stringliteral">&#39;a_meta_language&#39;</span>], $oid);
<a name="l12436"></a>12436         }
<a name="l12437"></a>12437         <span class="comment">//$out .= &#39; /SpiderInfo &lt;&lt;&gt;&gt;&#39;;</span>
<a name="l12438"></a>12438         <span class="comment">// set OutputIntent to sRGB IEC61966-2.1 if required</span>
<a name="l12439"></a>12439         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode OR $this-&gt;force_srgb) {
<a name="l12440"></a>12440             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /OutputIntents [&lt;&lt;&#39;</span>;
<a name="l12441"></a>12441             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Type /OutputIntent&#39;</span>;
<a name="l12442"></a>12442             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /S /GTS_PDFA1&#39;</span>;
<a name="l12443"></a>12443             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /OutputCondition &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;sRGB IEC61966-2.1&#39;</span>, $oid);
<a name="l12444"></a>12444             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /OutputConditionIdentifier &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;sRGB IEC61966-2.1&#39;</span>, $oid);
<a name="l12445"></a>12445             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /RegistryName &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;http://www.color.org&#39;</span>, $oid);
<a name="l12446"></a>12446             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Info &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;sRGB IEC61966-2.1&#39;</span>, $oid);
<a name="l12447"></a>12447             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DestOutputProfile &#39;</span>.$iccobj.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12448"></a>12448             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;]&#39;</span>;
<a name="l12449"></a>12449         }
<a name="l12450"></a>12450         <span class="comment">//$out .= &#39; /PieceInfo &lt;&lt;&gt;&gt;&#39;;</span>
<a name="l12451"></a>12451         <span class="keywordflow">if</span> (!empty($this-&gt;pdflayers)) {
<a name="l12452"></a>12452             $lyrobjs = <span class="stringliteral">&#39;&#39;</span>;
<a name="l12453"></a>12453             $lyrobjs_print = <span class="stringliteral">&#39;&#39;</span>;
<a name="l12454"></a>12454             $lyrobjs_view = <span class="stringliteral">&#39;&#39;</span>;
<a name="l12455"></a>12455             <span class="keywordflow">foreach</span> ($this-&gt;pdflayers as $layer) {
<a name="l12456"></a>12456                 $lyrobjs .= <span class="charliteral">&#39; &#39;</span>.$layer[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12457"></a>12457                 <span class="keywordflow">if</span> ($layer[<span class="stringliteral">&#39;print&#39;</span>]) {
<a name="l12458"></a>12458                     $lyrobjs_print .= <span class="charliteral">&#39; &#39;</span>.$layer[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12459"></a>12459                 }
<a name="l12460"></a>12460                 <span class="keywordflow">if</span> ($layer[<span class="stringliteral">&#39;view&#39;</span>]) {
<a name="l12461"></a>12461                     $lyrobjs_view .= <span class="charliteral">&#39; &#39;</span>.$layer[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12462"></a>12462                 }
<a name="l12463"></a>12463             }
<a name="l12464"></a>12464             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /OCProperties &lt;&lt; /OCGs [&#39;</span>.$lyrobjs.<span class="charliteral">&#39;]&#39;</span>;
<a name="l12465"></a>12465             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /D &lt;&lt;&#39;</span>;
<a name="l12466"></a>12466             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Name &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;Layers&#39;</span>, $oid);
<a name="l12467"></a>12467             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Creator &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;TCPDF&#39;</span>, $oid);
<a name="l12468"></a>12468             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BaseState /ON&#39;</span>;
<a name="l12469"></a>12469             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ON [&#39;</span>.$lyrobjs_print.<span class="charliteral">&#39;]&#39;</span>;
<a name="l12470"></a>12470             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /OFF [&#39;</span>.$lyrobjs_view.<span class="charliteral">&#39;]&#39;</span>;
<a name="l12471"></a>12471             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Intent /View&#39;</span>;
<a name="l12472"></a>12472             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /AS [&#39;</span>;
<a name="l12473"></a>12473             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &lt;&lt; /Event /Print /OCGs [&#39;</span>.$lyrobjs.<span class="stringliteral">&#39;] /Category [/Print] &gt;&gt;&#39;</span>;
<a name="l12474"></a>12474             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &lt;&lt; /Event /View /OCGs [&#39;</span>.$lyrobjs.<span class="stringliteral">&#39;] /Category [/View] &gt;&gt;&#39;</span>;
<a name="l12475"></a>12475             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; ]&#39;</span>;
<a name="l12476"></a>12476             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Order [&#39;</span>.$lyrobjs.<span class="charliteral">&#39;]&#39;</span>;
<a name="l12477"></a>12477             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ListMode /AllPages&#39;</span>;
<a name="l12478"></a>12478             <span class="comment">//$out .= &#39; /RBGroups [&#39;..&#39;]&#39;;</span>
<a name="l12479"></a>12479             <span class="comment">//$out .= &#39; /Locked [&#39;..&#39;]&#39;;</span>
<a name="l12480"></a>12480             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12481"></a>12481             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12482"></a>12482         }
<a name="l12483"></a>12483         <span class="comment">// AcroForm</span>
<a name="l12484"></a>12484         <span class="keywordflow">if</span> (!empty($this-&gt;form_obj_id) OR ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>]))) {
<a name="l12485"></a>12485             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /AcroForm &lt;&lt;&#39;</span>;
<a name="l12486"></a>12486             $objrefs = <span class="stringliteral">&#39;&#39;</span>;
<a name="l12487"></a>12487             <span class="keywordflow">if</span> ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])) {
<a name="l12488"></a>12488                 <span class="comment">// set reference for signature object</span>
<a name="l12489"></a>12489                 $objrefs .= $this-&gt;sig_obj_id.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12490"></a>12490             }
<a name="l12491"></a>12491             <span class="keywordflow">if</span> (!empty($this-&gt;empty_signature_appearance)) {
<a name="l12492"></a>12492                 <span class="keywordflow">foreach</span> ($this-&gt;empty_signature_appearance as $esa) {
<a name="l12493"></a>12493                     <span class="comment">// set reference for empty signature objects</span>
<a name="l12494"></a>12494                     $objrefs .= <span class="charliteral">&#39; &#39;</span>.$esa[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12495"></a>12495                 }
<a name="l12496"></a>12496             }
<a name="l12497"></a>12497             <span class="keywordflow">if</span> (!empty($this-&gt;form_obj_id)) {
<a name="l12498"></a>12498                 <span class="keywordflow">foreach</span>($this-&gt;form_obj_id as $objid) {
<a name="l12499"></a>12499                     $objrefs .= <span class="charliteral">&#39; &#39;</span>.$objid.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12500"></a>12500                 }
<a name="l12501"></a>12501             }
<a name="l12502"></a>12502             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Fields [&#39;</span>.$objrefs.<span class="charliteral">&#39;]&#39;</span>;
<a name="l12503"></a>12503             <span class="comment">// It&#39;s better to turn off this value and set the appearance stream for each annotation (/AP) to avoid conflicts with signature fields.</span>
<a name="l12504"></a>12504             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /NeedAppearances false&#39;</span>;
<a name="l12505"></a>12505             <span class="keywordflow">if</span> ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])) {
<a name="l12506"></a>12506                 <span class="keywordflow">if</span> ($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>] &gt; 0) {
<a name="l12507"></a>12507                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /SigFlags 3&#39;</span>;
<a name="l12508"></a>12508                 } <span class="keywordflow">else</span> {
<a name="l12509"></a>12509                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /SigFlags 1&#39;</span>;
<a name="l12510"></a>12510                 }
<a name="l12511"></a>12511             }
<a name="l12512"></a>12512             <span class="comment">//$out .= &#39; /CO &#39;;</span>
<a name="l12513"></a>12513             <span class="keywordflow">if</span> (isset($this-&gt;annotation_fonts) AND !empty($this-&gt;annotation_fonts)) {
<a name="l12514"></a>12514                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DR &lt;&lt;&#39;</span>;
<a name="l12515"></a>12515                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Font &lt;&lt;&#39;</span>;
<a name="l12516"></a>12516                 <span class="keywordflow">foreach</span> ($this-&gt;annotation_fonts as $fontkey =&gt; $fontid) {
<a name="l12517"></a>12517                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /F&#39;</span>.$fontid.<span class="charliteral">&#39; &#39;</span>.$this-&gt;font_obj_ids[$fontkey].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12518"></a>12518                 }
<a name="l12519"></a>12519                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt; &gt;&gt;&#39;</span>;
<a name="l12520"></a>12520             }
<a name="l12521"></a>12521             <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = $this-&gt;getFontBuffer(<span class="stringliteral">&#39;helvetica&#39;</span>);
<a name="l12522"></a>12522             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DA (/F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>].<span class="stringliteral">&#39; 0 Tf 0 g)&#39;</span>;
<a name="l12523"></a>12523             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Q &#39;</span>.(($this-&gt;rtl)?<span class="charliteral">&#39;2&#39;</span>:<span class="charliteral">&#39;0&#39;</span>);
<a name="l12524"></a>12524             <span class="comment">//$out .= &#39; /XFA &#39;;</span>
<a name="l12525"></a>12525             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12526"></a>12526             <span class="comment">// signatures</span>
<a name="l12527"></a>12527             <span class="keywordflow">if</span> ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])) {
<a name="l12528"></a>12528                 <span class="keywordflow">if</span> ($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>] &gt; 0) {
<a name="l12529"></a>12529                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Perms &lt;&lt; /DocMDP &#39;</span>.($this-&gt;sig_obj_id + 1).<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>;
<a name="l12530"></a>12530                 } <span class="keywordflow">else</span> {
<a name="l12531"></a>12531                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Perms &lt;&lt; /UR3 &#39;</span>.($this-&gt;sig_obj_id + 1).<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>;
<a name="l12532"></a>12532                 }
<a name="l12533"></a>12533             }
<a name="l12534"></a>12534         }
<a name="l12535"></a>12535         <span class="comment">//$out .= &#39; /Legal &lt;&lt;&gt;&gt;&#39;;</span>
<a name="l12536"></a>12536         <span class="comment">//$out .= &#39; /Requirements []&#39;;</span>
<a name="l12537"></a>12537         <span class="comment">//$out .= &#39; /Collection &lt;&lt;&gt;&gt;&#39;;</span>
<a name="l12538"></a>12538         <span class="comment">//$out .= &#39; /NeedsRendering true&#39;;</span>
<a name="l12539"></a>12539         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12540"></a>12540         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l12541"></a>12541         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l12542"></a>12542         <span class="keywordflow">return</span> $oid;
<a name="l12543"></a>12543     }
<a name="l12544"></a>12544 <span class="comment"></span>
<a name="l12545"></a>12545 <span class="comment">    /**</span>
<a name="l12546"></a>12546 <span class="comment">     * Output viewer preferences.</span>
<a name="l12547"></a>12547 <span class="comment">     * @return string for viewer preferences</span>
<a name="l12548"></a>12548 <span class="comment">     * @author Nicola asuni</span>
<a name="l12549"></a>12549 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l12550"></a>12550 <span class="comment">     * @protected</span>
<a name="l12551"></a>12551 <span class="comment">     */</span>
<a name="l12552"></a><a class="code" href="classTCPDF.html#a1651570142db46f184f83373fbd72a04">12552</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1651570142db46f184f83373fbd72a04" title="Output viewer preferences.">_putviewerpreferences</a>() {
<a name="l12553"></a>12553         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39; /ViewerPreferences &lt;&lt;&#39;</span>;
<a name="l12554"></a>12554         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l12555"></a>12555             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Direction /R2L&#39;</span>;
<a name="l12556"></a>12556         } <span class="keywordflow">else</span> {
<a name="l12557"></a>12557             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Direction /L2R&#39;</span>;
<a name="l12558"></a>12558         }
<a name="l12559"></a>12559         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;HideToolbar&#39;</span>]) AND ($this-&gt;viewer_preferences[<span class="stringliteral">&#39;HideToolbar&#39;</span>])) {
<a name="l12560"></a>12560             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /HideToolbar true&#39;</span>;
<a name="l12561"></a>12561         }
<a name="l12562"></a>12562         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;HideMenubar&#39;</span>]) AND ($this-&gt;viewer_preferences[<span class="stringliteral">&#39;HideMenubar&#39;</span>])) {
<a name="l12563"></a>12563             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /HideMenubar true&#39;</span>;
<a name="l12564"></a>12564         }
<a name="l12565"></a>12565         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;HideWindowUI&#39;</span>]) AND ($this-&gt;viewer_preferences[<span class="stringliteral">&#39;HideWindowUI&#39;</span>])) {
<a name="l12566"></a>12566             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /HideWindowUI true&#39;</span>;
<a name="l12567"></a>12567         }
<a name="l12568"></a>12568         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;FitWindow&#39;</span>]) AND ($this-&gt;viewer_preferences[<span class="stringliteral">&#39;FitWindow&#39;</span>])) {
<a name="l12569"></a>12569             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FitWindow true&#39;</span>;
<a name="l12570"></a>12570         }
<a name="l12571"></a>12571         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;CenterWindow&#39;</span>]) AND ($this-&gt;viewer_preferences[<span class="stringliteral">&#39;CenterWindow&#39;</span>])) {
<a name="l12572"></a>12572             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CenterWindow true&#39;</span>;
<a name="l12573"></a>12573         }
<a name="l12574"></a>12574         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;DisplayDocTitle&#39;</span>]) AND ($this-&gt;viewer_preferences[<span class="stringliteral">&#39;DisplayDocTitle&#39;</span>])) {
<a name="l12575"></a>12575             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /DisplayDocTitle true&#39;</span>;
<a name="l12576"></a>12576         }
<a name="l12577"></a>12577         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;NonFullScreenPageMode&#39;</span>])) {
<a name="l12578"></a>12578             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /NonFullScreenPageMode /&#39;</span>.$this-&gt;viewer_preferences[<span class="stringliteral">&#39;NonFullScreenPageMode&#39;</span>];
<a name="l12579"></a>12579         }
<a name="l12580"></a>12580         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;ViewArea&#39;</span>])) {
<a name="l12581"></a>12581             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ViewArea /&#39;</span>.$this-&gt;viewer_preferences[<span class="stringliteral">&#39;ViewArea&#39;</span>];
<a name="l12582"></a>12582         }
<a name="l12583"></a>12583         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;ViewClip&#39;</span>])) {
<a name="l12584"></a>12584             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ViewClip /&#39;</span>.$this-&gt;viewer_preferences[<span class="stringliteral">&#39;ViewClip&#39;</span>];
<a name="l12585"></a>12585         }
<a name="l12586"></a>12586         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;PrintArea&#39;</span>])) {
<a name="l12587"></a>12587             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PrintArea /&#39;</span>.$this-&gt;viewer_preferences[<span class="stringliteral">&#39;PrintArea&#39;</span>];
<a name="l12588"></a>12588         }
<a name="l12589"></a>12589         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;PrintClip&#39;</span>])) {
<a name="l12590"></a>12590             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PrintClip /&#39;</span>.$this-&gt;viewer_preferences[<span class="stringliteral">&#39;PrintClip&#39;</span>];
<a name="l12591"></a>12591         }
<a name="l12592"></a>12592         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;PrintScaling&#39;</span>])) {
<a name="l12593"></a>12593             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PrintScaling /&#39;</span>.$this-&gt;viewer_preferences[<span class="stringliteral">&#39;PrintScaling&#39;</span>];
<a name="l12594"></a>12594         }
<a name="l12595"></a>12595         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;Duplex&#39;</span>]) AND (!$this-&gt;empty_string($this-&gt;viewer_preferences[<span class="stringliteral">&#39;Duplex&#39;</span>]))) {
<a name="l12596"></a>12596             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Duplex /&#39;</span>.$this-&gt;viewer_preferences[<span class="stringliteral">&#39;Duplex&#39;</span>];
<a name="l12597"></a>12597         }
<a name="l12598"></a>12598         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;PickTrayByPDFSize&#39;</span>])) {
<a name="l12599"></a>12599             <span class="keywordflow">if</span> ($this-&gt;viewer_preferences[<span class="stringliteral">&#39;PickTrayByPDFSize&#39;</span>]) {
<a name="l12600"></a>12600                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PickTrayByPDFSize true&#39;</span>;
<a name="l12601"></a>12601             } <span class="keywordflow">else</span> {
<a name="l12602"></a>12602                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PickTrayByPDFSize false&#39;</span>;
<a name="l12603"></a>12603             }
<a name="l12604"></a>12604         }
<a name="l12605"></a>12605         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;PrintPageRange&#39;</span>])) {
<a name="l12606"></a>12606             $PrintPageRangeNum = <span class="stringliteral">&#39;&#39;</span>;
<a name="l12607"></a>12607             <span class="keywordflow">foreach</span> ($this-&gt;viewer_preferences[<span class="stringliteral">&#39;PrintPageRange&#39;</span>] as $k =&gt; $v) {
<a name="l12608"></a>12608                 $PrintPageRangeNum .= <span class="charliteral">&#39; &#39;</span>.($v - 1).<span class="stringliteral">&#39;&#39;</span>;
<a name="l12609"></a>12609             }
<a name="l12610"></a>12610             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /PrintPageRange [&#39;</span>.substr($PrintPageRangeNum,1).<span class="charliteral">&#39;]&#39;</span>;
<a name="l12611"></a>12611         }
<a name="l12612"></a>12612         <span class="keywordflow">if</span> (isset($this-&gt;viewer_preferences[<span class="stringliteral">&#39;NumCopies&#39;</span>])) {
<a name="l12613"></a>12613             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /NumCopies &#39;</span>.intval($this-&gt;viewer_preferences[<span class="stringliteral">&#39;NumCopies&#39;</span>]);
<a name="l12614"></a>12614         }
<a name="l12615"></a>12615         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12616"></a>12616         <span class="keywordflow">return</span> <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>;
<a name="l12617"></a>12617     }
<a name="l12618"></a>12618 <span class="comment"></span>
<a name="l12619"></a>12619 <span class="comment">    /**</span>
<a name="l12620"></a>12620 <span class="comment">     * Output PDF File Header (7.5.2).</span>
<a name="l12621"></a>12621 <span class="comment">     * @protected</span>
<a name="l12622"></a>12622 <span class="comment">     */</span>
<a name="l12623"></a><a class="code" href="classTCPDF.html#a9e27c6426fd6cce5613f9ecd2ceecee4">12623</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9e27c6426fd6cce5613f9ecd2ceecee4" title="Output PDF File Header (7.5.2).">_putheader</a>() {
<a name="l12624"></a>12624         $this-&gt;_out(<span class="stringliteral">&#39;%PDF-&#39;</span>.$this-&gt;PDFVersion);
<a name="l12625"></a>12625         $this-&gt;_out(<span class="charliteral">&#39;%&#39;</span>.chr(0xe2).chr(0xe3).chr(0xcf).chr(0xd3));
<a name="l12626"></a>12626     }
<a name="l12627"></a>12627 <span class="comment"></span>
<a name="l12628"></a>12628 <span class="comment">    /**</span>
<a name="l12629"></a>12629 <span class="comment">     * Output end of document (EOF).</span>
<a name="l12630"></a>12630 <span class="comment">     * @protected</span>
<a name="l12631"></a>12631 <span class="comment">     */</span>
<a name="l12632"></a><a class="code" href="classTCPDF.html#a55c3dfafc6dd5b278d0bc7298e829d77">12632</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a55c3dfafc6dd5b278d0bc7298e829d77" title="Output end of document (EOF).">_enddoc</a>() {
<a name="l12633"></a>12633         $this-&gt;state = 1;
<a name="l12634"></a>12634         $this-&gt;_putheader();
<a name="l12635"></a>12635         $this-&gt;_putpages();
<a name="l12636"></a>12636         $this-&gt;_putresources();
<a name="l12637"></a>12637         <span class="comment">// empty signature fields</span>
<a name="l12638"></a>12638         <span class="keywordflow">if</span> (!empty($this-&gt;empty_signature_appearance)) {
<a name="l12639"></a>12639             <span class="keywordflow">foreach</span> ($this-&gt;empty_signature_appearance as $key =&gt; $esa) {
<a name="l12640"></a>12640                 <span class="comment">// widget annotation for empty signature</span>
<a name="l12641"></a>12641                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;_getobj($esa[<span class="stringliteral">&#39;objid&#39;</span>]).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12642"></a>12642                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt; /Type /Annot&#39;</span>;
<a name="l12643"></a>12643                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /Widget&#39;</span>;
<a name="l12644"></a>12644                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Rect [&#39;</span>.$esa[<span class="stringliteral">&#39;rect&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;
<a name="l12645"></a>12645                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /P &#39;</span>.$this-&gt;page_obj_id[($esa[<span class="stringliteral">&#39;page&#39;</span>])].<span class="stringliteral">&#39; 0 R&#39;</span>; <span class="comment">// link to signature appearance page</span>
<a name="l12646"></a>12646                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /F 4&#39;</span>;
<a name="l12647"></a>12647                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FT /Sig&#39;</span>;
<a name="l12648"></a>12648                 $signame = sprintf(<span class="stringliteral">&#39;Signature_%03d&#39;</span>, ($key + 1));
<a name="l12649"></a>12649                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_textstring($signame, $esa[<span class="stringliteral">&#39;objid&#39;</span>]);
<a name="l12650"></a>12650                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Ff 0&#39;</span>;
<a name="l12651"></a>12651                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12652"></a>12652                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l12653"></a>12653                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l12654"></a>12654             }
<a name="l12655"></a>12655         }
<a name="l12656"></a>12656         <span class="comment">// Signature</span>
<a name="l12657"></a>12657         <span class="keywordflow">if</span> ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])) {
<a name="l12658"></a>12658             <span class="comment">// widget annotation for signature</span>
<a name="l12659"></a>12659             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;_getobj($this-&gt;sig_obj_id).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12660"></a>12660             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt; /Type /Annot&#39;</span>;
<a name="l12661"></a>12661             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Subtype /Widget&#39;</span>;
<a name="l12662"></a>12662             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Rect [&#39;</span>.$this-&gt;signature_appearance[<span class="stringliteral">&#39;rect&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;
<a name="l12663"></a>12663             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /P &#39;</span>.$this-&gt;page_obj_id[($this-&gt;signature_appearance[<span class="stringliteral">&#39;page&#39;</span>])].<span class="stringliteral">&#39; 0 R&#39;</span>; <span class="comment">// link to signature appearance page</span>
<a name="l12664"></a>12664             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /F 4&#39;</span>;
<a name="l12665"></a>12665             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FT /Sig&#39;</span>;
<a name="l12666"></a>12666             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;Signature_000&#39;</span>, $this-&gt;sig_obj_id);
<a name="l12667"></a>12667             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Ff 0&#39;</span>;
<a name="l12668"></a>12668             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /V &#39;</span>.($this-&gt;sig_obj_id + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12669"></a>12669             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12670"></a>12670             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l12671"></a>12671             $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l12672"></a>12672             <span class="comment">// signature</span>
<a name="l12673"></a>12673             $this-&gt;_putsignature();
<a name="l12674"></a>12674         }
<a name="l12675"></a>12675         <span class="comment">// Info</span>
<a name="l12676"></a>12676         $objid_info = $this-&gt;_putinfo();
<a name="l12677"></a>12677         <span class="comment">// Catalog</span>
<a name="l12678"></a>12678         $objid_catalog = $this-&gt;_putcatalog();
<a name="l12679"></a>12679         <span class="comment">// Cross-ref</span>
<a name="l12680"></a>12680         $o = $this-&gt;bufferlen;
<a name="l12681"></a>12681         <span class="comment">// XREF section</span>
<a name="l12682"></a>12682         $this-&gt;_out(<span class="stringliteral">&#39;xref&#39;</span>);
<a name="l12683"></a>12683         $this-&gt;_out(<span class="stringliteral">&#39;0 &#39;</span>.($this-&gt;n + 1));
<a name="l12684"></a>12684         $this-&gt;_out(<span class="stringliteral">&#39;0000000000 65535 f &#39;</span>);
<a name="l12685"></a>12685         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;= $this-&gt;n; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l12686"></a>12686             <span class="keywordflow">if</span> (!isset($this-&gt;offsets[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) AND ($i &gt; 1)) {
<a name="l12687"></a>12687                 $this-&gt;offsets[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;offsets[($i - 1)];
<a name="l12688"></a>12688             }
<a name="l12689"></a>12689             $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%010d 00000 n &#39;</span>, $this-&gt;offsets[$i]));
<a name="l12690"></a>12690         }
<a name="l12691"></a>12691         <span class="comment">// TRAILER</span>
<a name="l12692"></a>12692         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;trailer&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l12693"></a>12693         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l12694"></a>12694         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Size &#39;</span>.($this-&gt;n + 1);
<a name="l12695"></a>12695         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Root &#39;</span>.$objid_catalog.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12696"></a>12696         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Info &#39;</span>.$objid_info.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12697"></a>12697         <span class="keywordflow">if</span> ($this-&gt;encrypted) {
<a name="l12698"></a>12698             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Encrypt &#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l12699"></a>12699         }
<a name="l12700"></a>12700         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ID [ &lt;&#39;</span>.$this-&gt;file_id.<span class="stringliteral">&#39;&gt; &lt;&#39;</span>.$this-&gt;file_id.<span class="stringliteral">&#39;&gt; ]&#39;</span>;
<a name="l12701"></a>12701         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l12702"></a>12702         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l12703"></a>12703         $this-&gt;_out(<span class="stringliteral">&#39;startxref&#39;</span>);
<a name="l12704"></a>12704         $this-&gt;_out($o);
<a name="l12705"></a>12705         $this-&gt;_out(<span class="stringliteral">&#39;%%EOF&#39;</span>);
<a name="l12706"></a>12706         $this-&gt;state = 3; <span class="comment">// end-of-doc</span>
<a name="l12707"></a>12707         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l12708"></a>12708             <span class="comment">// remove temporary files used for images</span>
<a name="l12709"></a>12709             <span class="keywordflow">foreach</span> ($this-&gt;imagekeys as $key) {
<a name="l12710"></a>12710                 <span class="comment">// remove temporary files</span>
<a name="l12711"></a>12711                 unlink($this-&gt;images[$key]);
<a name="l12712"></a>12712             }
<a name="l12713"></a>12713             <span class="keywordflow">foreach</span> ($this-&gt;fontkeys as $key) {
<a name="l12714"></a>12714                 <span class="comment">// remove temporary files</span>
<a name="l12715"></a>12715                 unlink($this-&gt;fonts[$key]);
<a name="l12716"></a>12716             }
<a name="l12717"></a>12717         }
<a name="l12718"></a>12718     }
<a name="l12719"></a>12719 <span class="comment"></span>
<a name="l12720"></a>12720 <span class="comment">    /**</span>
<a name="l12721"></a>12721 <span class="comment">     * Initialize a new page.</span>
<a name="l12722"></a>12722 <span class="comment">     * @param $orientation (string) page orientation. Possible values are (case insensitive):&lt;ul&gt;&lt;li&gt;P or PORTRAIT (default)&lt;/li&gt;&lt;li&gt;L or LANDSCAPE&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l12723"></a>12723 <span class="comment">     * @param $format (mixed) The format used for pages. It can be either: one of the string values specified at getPageSizeFromFormat() or an array of parameters specified at setPageFormat().</span>
<a name="l12724"></a>12724 <span class="comment">     * @protected</span>
<a name="l12725"></a>12725 <span class="comment">     * @see getPageSizeFromFormat(), setPageFormat()</span>
<a name="l12726"></a>12726 <span class="comment">     */</span>
<a name="l12727"></a><a class="code" href="classTCPDF.html#aeba2b911ed732e58cb99c0b9b29ed05f">12727</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aeba2b911ed732e58cb99c0b9b29ed05f" title="Initialize a new page.">_beginpage</a>($orientation=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l12728"></a>12728         ++$this-&gt;page;
<a name="l12729"></a>12729         $this-&gt;setPageBuffer($this-&gt;page, <span class="stringliteral">&#39;&#39;</span>);
<a name="l12730"></a>12730         <span class="comment">// initialize array for graphics tranformation positions inside a page buffer</span>
<a name="l12731"></a>12731         $this-&gt;transfmrk[$this-&gt;page] = array();
<a name="l12732"></a>12732         $this-&gt;state = 2;
<a name="l12733"></a>12733         <span class="keywordflow">if</span> ($this-&gt;empty_string($orientation)) {
<a name="l12734"></a>12734             <span class="keywordflow">if</span> (isset($this-&gt;CurOrientation)) {
<a name="l12735"></a>12735                 $orientation = $this-&gt;CurOrientation;
<a name="l12736"></a>12736             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;fwPt &gt; $this-&gt;fhPt) {
<a name="l12737"></a>12737                 <span class="comment">// landscape</span>
<a name="l12738"></a>12738                 $orientation = <span class="charliteral">&#39;L&#39;</span>;
<a name="l12739"></a>12739             } <span class="keywordflow">else</span> {
<a name="l12740"></a>12740                 <span class="comment">// portrait</span>
<a name="l12741"></a>12741                 $orientation = <span class="charliteral">&#39;P&#39;</span>;
<a name="l12742"></a>12742             }
<a name="l12743"></a>12743         }
<a name="l12744"></a>12744         <span class="keywordflow">if</span> ($this-&gt;empty_string(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>)) {
<a name="l12745"></a>12745             $this-&gt;pagedim[$this-&gt;page] = $this-&gt;pagedim[($this-&gt;page - 1)];
<a name="l12746"></a>12746             $this-&gt;setPageOrientation($orientation);
<a name="l12747"></a>12747         } <span class="keywordflow">else</span> {
<a name="l12748"></a>12748             $this-&gt;setPageFormat(<a class="code" href="gis__data__editor_8php.html#a1e6e4ea377a908a5407c435e9054e3a9">$format</a>, $orientation);
<a name="l12749"></a>12749         }
<a name="l12750"></a>12750         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l12751"></a>12751             $this-&gt;x = $this-&gt;w - $this-&gt;rMargin;
<a name="l12752"></a>12752         } <span class="keywordflow">else</span> {
<a name="l12753"></a>12753             $this-&gt;x = $this-&gt;lMargin;
<a name="l12754"></a>12754         }
<a name="l12755"></a>12755         $this-&gt;y = $this-&gt;tMargin;
<a name="l12756"></a>12756         <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$this-&gt;page])) {
<a name="l12757"></a>12757             <span class="comment">// start a new group</span>
<a name="l12758"></a>12758             $this-&gt;currpagegroup = $this-&gt;newpagegroup[$this-&gt;page];
<a name="l12759"></a>12759             $this-&gt;pagegroups[$this-&gt;currpagegroup] = 1;
<a name="l12760"></a>12760         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;currpagegroup) AND ($this-&gt;currpagegroup &gt; 0)) {
<a name="l12761"></a>12761             ++$this-&gt;pagegroups[$this-&gt;currpagegroup];
<a name="l12762"></a>12762         }
<a name="l12763"></a>12763     }
<a name="l12764"></a>12764 <span class="comment"></span>
<a name="l12765"></a>12765 <span class="comment">    /**</span>
<a name="l12766"></a>12766 <span class="comment">     * Mark end of page.</span>
<a name="l12767"></a>12767 <span class="comment">     * @protected</span>
<a name="l12768"></a>12768 <span class="comment">     */</span>
<a name="l12769"></a><a class="code" href="classTCPDF.html#af037a681d72f4eeaecd641680257a16f">12769</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af037a681d72f4eeaecd641680257a16f" title="Mark end of page.">_endpage</a>() {
<a name="l12770"></a>12770         $this-&gt;setVisibility(<span class="stringliteral">&#39;all&#39;</span>);
<a name="l12771"></a>12771         $this-&gt;state = 1;
<a name="l12772"></a>12772     }
<a name="l12773"></a>12773 <span class="comment"></span>
<a name="l12774"></a>12774 <span class="comment">    /**</span>
<a name="l12775"></a>12775 <span class="comment">     * Begin a new object and return the object number.</span>
<a name="l12776"></a>12776 <span class="comment">     * @return int object number</span>
<a name="l12777"></a>12777 <span class="comment">     * @protected</span>
<a name="l12778"></a>12778 <span class="comment">     */</span>
<a name="l12779"></a><a class="code" href="classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">12779</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d" title="Begin a new object and return the object number.">_newobj</a>() {
<a name="l12780"></a>12780         $this-&gt;_out($this-&gt;_getobj());
<a name="l12781"></a>12781         <span class="keywordflow">return</span> $this-&gt;n;
<a name="l12782"></a>12782     }
<a name="l12783"></a>12783 <span class="comment"></span>
<a name="l12784"></a>12784 <span class="comment">    /**</span>
<a name="l12785"></a>12785 <span class="comment">     * Return the starting object string for the selected object ID.</span>
<a name="l12786"></a>12786 <span class="comment">     * @param $objid (int) Object ID (leave empty to get a new ID).</span>
<a name="l12787"></a>12787 <span class="comment">     * @return string the starting object string</span>
<a name="l12788"></a>12788 <span class="comment">     * @protected</span>
<a name="l12789"></a>12789 <span class="comment">     * @since 5.8.009 (2010-08-20)</span>
<a name="l12790"></a>12790 <span class="comment">     */</span>
<a name="l12791"></a><a class="code" href="classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">12791</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1" title="Return the starting object string for the selected object ID.">_getobj</a>($objid=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l12792"></a>12792         <span class="keywordflow">if</span> ($objid === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l12793"></a>12793             ++$this-&gt;n;
<a name="l12794"></a>12794             $objid = $this-&gt;n;
<a name="l12795"></a>12795         }
<a name="l12796"></a>12796         $this-&gt;offsets[$objid] = $this-&gt;bufferlen;
<a name="l12797"></a>12797         <span class="keywordflow">return</span> $objid.<span class="stringliteral">&#39; 0 obj&#39;</span>;
<a name="l12798"></a>12798     }
<a name="l12799"></a>12799 <span class="comment"></span>
<a name="l12800"></a>12800 <span class="comment">    /**</span>
<a name="l12801"></a>12801 <span class="comment">     * Underline text.</span>
<a name="l12802"></a>12802 <span class="comment">     * @param $x (int) X coordinate</span>
<a name="l12803"></a>12803 <span class="comment">     * @param $y (int) Y coordinate</span>
<a name="l12804"></a>12804 <span class="comment">     * @param $txt (string) text to underline</span>
<a name="l12805"></a>12805 <span class="comment">     * @protected</span>
<a name="l12806"></a>12806 <span class="comment">     */</span>
<a name="l12807"></a><a class="code" href="classTCPDF.html#a877cd98eb569f30730b86a09b61825aa">12807</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a877cd98eb569f30730b86a09b61825aa" title="Underline text.">_dounderline</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $txt) {
<a name="l12808"></a>12808         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;GetStringWidth($txt);
<a name="l12809"></a>12809         <span class="keywordflow">return</span> $this-&gt;_dounderlinew(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>);
<a name="l12810"></a>12810     }
<a name="l12811"></a>12811 <span class="comment"></span>
<a name="l12812"></a>12812 <span class="comment">    /**</span>
<a name="l12813"></a>12813 <span class="comment">     * Underline for rectangular text area.</span>
<a name="l12814"></a>12814 <span class="comment">     * @param $x (int) X coordinate</span>
<a name="l12815"></a>12815 <span class="comment">     * @param $y (int) Y coordinate</span>
<a name="l12816"></a>12816 <span class="comment">     * @param $w (int) width to underline</span>
<a name="l12817"></a>12817 <span class="comment">     * @protected</span>
<a name="l12818"></a>12818 <span class="comment">     * @since 4.8.008 (2009-09-29)</span>
<a name="l12819"></a>12819 <span class="comment">     */</span>
<a name="l12820"></a><a class="code" href="classTCPDF.html#a42fd9a6c1fdd354da7e199c730f1c0f7">12820</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a42fd9a6c1fdd354da7e199c730f1c0f7" title="Underline for rectangular text area.">_dounderlinew</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) {
<a name="l12821"></a>12821         $linew = - $this-&gt;CurrentFont[<span class="stringliteral">&#39;ut&#39;</span>] / 1000 * $this-&gt;FontSizePt;
<a name="l12822"></a>12822         <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F re f&#39;</span>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * $this-&gt;k, ((($this-&gt;h - $y) * $this-&gt;k) + $linew), <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $this-&gt;k, $linew);
<a name="l12823"></a>12823     }
<a name="l12824"></a>12824 <span class="comment"></span>
<a name="l12825"></a>12825 <span class="comment">    /**</span>
<a name="l12826"></a>12826 <span class="comment">     * Line through text.</span>
<a name="l12827"></a>12827 <span class="comment">     * @param $x (int) X coordinate</span>
<a name="l12828"></a>12828 <span class="comment">     * @param $y (int) Y coordinate</span>
<a name="l12829"></a>12829 <span class="comment">     * @param $txt (string) text to linethrough</span>
<a name="l12830"></a>12830 <span class="comment">     * @protected</span>
<a name="l12831"></a>12831 <span class="comment">     */</span>
<a name="l12832"></a><a class="code" href="classTCPDF.html#a8a0828e6deefbe232d94e55cdb816fa1">12832</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8a0828e6deefbe232d94e55cdb816fa1" title="Line through text.">_dolinethrough</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $txt) {
<a name="l12833"></a>12833         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;GetStringWidth($txt);
<a name="l12834"></a>12834         <span class="keywordflow">return</span> $this-&gt;_dolinethroughw(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>);
<a name="l12835"></a>12835     }
<a name="l12836"></a>12836 <span class="comment"></span>
<a name="l12837"></a>12837 <span class="comment">    /**</span>
<a name="l12838"></a>12838 <span class="comment">     * Line through for rectangular text area.</span>
<a name="l12839"></a>12839 <span class="comment">     * @param $x (int) X coordinate</span>
<a name="l12840"></a>12840 <span class="comment">     * @param $y (int) Y coordinate</span>
<a name="l12841"></a>12841 <span class="comment">     * @param $w (int) line length (width)</span>
<a name="l12842"></a>12842 <span class="comment">     * @protected</span>
<a name="l12843"></a>12843 <span class="comment">     * @since 4.9.008 (2009-09-29)</span>
<a name="l12844"></a>12844 <span class="comment">     */</span>
<a name="l12845"></a><a class="code" href="classTCPDF.html#af2999e4e50aa693faf0d7c0009dfa43c">12845</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af2999e4e50aa693faf0d7c0009dfa43c" title="Line through for rectangular text area.">_dolinethroughw</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) {
<a name="l12846"></a>12846         $linew = - $this-&gt;CurrentFont[<span class="stringliteral">&#39;ut&#39;</span>] / 1000 * $this-&gt;FontSizePt;
<a name="l12847"></a>12847         <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F re f&#39;</span>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * $this-&gt;k, ((($this-&gt;h - $y) * $this-&gt;k) + $linew + ($this-&gt;FontSizePt / 3)), <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $this-&gt;k, $linew);
<a name="l12848"></a>12848     }
<a name="l12849"></a>12849 <span class="comment"></span>
<a name="l12850"></a>12850 <span class="comment">    /**</span>
<a name="l12851"></a>12851 <span class="comment">     * Overline text.</span>
<a name="l12852"></a>12852 <span class="comment">     * @param $x (int) X coordinate</span>
<a name="l12853"></a>12853 <span class="comment">     * @param $y (int) Y coordinate</span>
<a name="l12854"></a>12854 <span class="comment">     * @param $txt (string) text to overline</span>
<a name="l12855"></a>12855 <span class="comment">     * @protected</span>
<a name="l12856"></a>12856 <span class="comment">     * @since 4.9.015 (2010-04-19)</span>
<a name="l12857"></a>12857 <span class="comment">     */</span>
<a name="l12858"></a><a class="code" href="classTCPDF.html#a803fd6fac1ef9574bdd67dac9583edf7">12858</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a803fd6fac1ef9574bdd67dac9583edf7" title="Overline text.">_dooverline</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $txt) {
<a name="l12859"></a>12859         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;GetStringWidth($txt);
<a name="l12860"></a>12860         <span class="keywordflow">return</span> $this-&gt;_dooverlinew(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>);
<a name="l12861"></a>12861     }
<a name="l12862"></a>12862 <span class="comment"></span>
<a name="l12863"></a>12863 <span class="comment">    /**</span>
<a name="l12864"></a>12864 <span class="comment">     * Overline for rectangular text area.</span>
<a name="l12865"></a>12865 <span class="comment">     * @param $x (int) X coordinate</span>
<a name="l12866"></a>12866 <span class="comment">     * @param $y (int) Y coordinate</span>
<a name="l12867"></a>12867 <span class="comment">     * @param $w (int) width to overline</span>
<a name="l12868"></a>12868 <span class="comment">     * @protected</span>
<a name="l12869"></a>12869 <span class="comment">     * @since 4.9.015 (2010-04-19)</span>
<a name="l12870"></a>12870 <span class="comment">     */</span>
<a name="l12871"></a><a class="code" href="classTCPDF.html#a161ff5500c93e6a3af01b87df1ee7877">12871</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a161ff5500c93e6a3af01b87df1ee7877" title="Overline for rectangular text area.">_dooverlinew</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) {
<a name="l12872"></a>12872         $linew = - $this-&gt;CurrentFont[<span class="stringliteral">&#39;ut&#39;</span>] / 1000 * $this-&gt;FontSizePt;
<a name="l12873"></a>12873         <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F re f&#39;</span>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * $this-&gt;k, (($this-&gt;h - $y + $this-&gt;FontAscent) * $this-&gt;k) - $linew, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $this-&gt;k, $linew);
<a name="l12874"></a>12874 
<a name="l12875"></a>12875     }
<a name="l12876"></a>12876 <span class="comment"></span>
<a name="l12877"></a>12877 <span class="comment">    /**</span>
<a name="l12878"></a>12878 <span class="comment">     * Read a 4-byte (32 bit) integer from file.</span>
<a name="l12879"></a>12879 <span class="comment">     * @param $f (string) file name.</span>
<a name="l12880"></a>12880 <span class="comment">     * @return 4-byte integer</span>
<a name="l12881"></a>12881 <span class="comment">     * @protected</span>
<a name="l12882"></a>12882 <span class="comment">     */</span>
<a name="l12883"></a><a class="code" href="classTCPDF.html#a93c322bd214bd06c217f600de0fb5fba">12883</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a93c322bd214bd06c217f600de0fb5fba" title="Read a 4-byte (32 bit) integer from file.">_freadint</a>(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>) {
<a name="l12884"></a>12884         $a = unpack(<span class="stringliteral">&#39;Ni&#39;</span>, fread(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, 4));
<a name="l12885"></a>12885         <span class="keywordflow">return</span> $a[<span class="charliteral">&#39;i&#39;</span>];
<a name="l12886"></a>12886     }
<a name="l12887"></a>12887 <span class="comment"></span>
<a name="l12888"></a>12888 <span class="comment">    /**</span>
<a name="l12889"></a>12889 <span class="comment">     * Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;</span>
<a name="l12890"></a>12890 <span class="comment">     * @param $s (string) string to escape.</span>
<a name="l12891"></a>12891 <span class="comment">     * @return string escaped string.</span>
<a name="l12892"></a>12892 <span class="comment">     * @protected</span>
<a name="l12893"></a>12893 <span class="comment">     */</span>
<a name="l12894"></a><a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf">12894</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9d85fe0d8460a71cb28cc679faf57ecf" title="Add &quot;\&quot; before &quot;\&quot;, &quot;(&quot; and &quot;)&quot;.">_escape</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>) {
<a name="l12895"></a>12895         <span class="comment">// the chr(13) substitution fixes the Bugs item #1421290.</span>
<a name="l12896"></a>12896         <span class="keywordflow">return</span> strtr(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, array(<span class="charliteral">&#39;)&#39;</span> =&gt; <span class="stringliteral">&#39;\\)&#39;</span>, <span class="charliteral">&#39;(&#39;</span> =&gt; <span class="stringliteral">&#39;\\(&#39;</span>, <span class="charliteral">&#39;\\&#39;</span> =&gt; <span class="stringliteral">&#39;\\\\&#39;</span>, chr(13) =&gt; <span class="charliteral">&#39;\r&#39;</span>));
<a name="l12897"></a>12897     }
<a name="l12898"></a>12898 <span class="comment"></span>
<a name="l12899"></a>12899 <span class="comment">    /**</span>
<a name="l12900"></a>12900 <span class="comment">     * Format a data string for meta information</span>
<a name="l12901"></a>12901 <span class="comment">     * @param $s (string) data string to escape.</span>
<a name="l12902"></a>12902 <span class="comment">     * @param $n (int) object ID</span>
<a name="l12903"></a>12903 <span class="comment">     * @return string escaped string.</span>
<a name="l12904"></a>12904 <span class="comment">     * @protected</span>
<a name="l12905"></a>12905 <span class="comment">     */</span>
<a name="l12906"></a><a class="code" href="classTCPDF.html#ad4357fbfe88ee671132009ca8bb199ef">12906</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad4357fbfe88ee671132009ca8bb199ef" title="Format a data string for meta information.">_datastring</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $n=0) {
<a name="l12907"></a>12907         <span class="keywordflow">if</span> ($n == 0) {
<a name="l12908"></a>12908             $n = $this-&gt;n;
<a name="l12909"></a>12909         }
<a name="l12910"></a>12910         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = $this-&gt;_encrypt_data($n, <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l12911"></a>12911         <span class="keywordflow">return</span> <span class="charliteral">&#39;(&#39;</span>. $this-&gt;_escape(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>).<span class="charliteral">&#39;)&#39;</span>;
<a name="l12912"></a>12912     }
<a name="l12913"></a>12913 <span class="comment"></span>
<a name="l12914"></a>12914 <span class="comment">    /**</span>
<a name="l12915"></a>12915 <span class="comment">     * Returns a formatted date for meta information</span>
<a name="l12916"></a>12916 <span class="comment">     * @param $n (int) object ID</span>
<a name="l12917"></a>12917 <span class="comment">     * @return string escaped date string.</span>
<a name="l12918"></a>12918 <span class="comment">     * @protected</span>
<a name="l12919"></a>12919 <span class="comment">     * @since 4.6.028 (2009-08-25)</span>
<a name="l12920"></a>12920 <span class="comment">     */</span>
<a name="l12921"></a><a class="code" href="classTCPDF.html#a1d3bc3442892050827c61184ad2d1fed">12921</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1d3bc3442892050827c61184ad2d1fed" title="Returns a formatted date for meta information.">_datestring</a>($n=0) {
<a name="l12922"></a>12922         <span class="keywordflow">return</span> $this-&gt;_datastring(<span class="stringliteral">&#39;D:&#39;</span>.$this-&gt;doc_date, $n);
<a name="l12923"></a>12923     }
<a name="l12924"></a>12924 <span class="comment"></span>
<a name="l12925"></a>12925 <span class="comment">    /**</span>
<a name="l12926"></a>12926 <span class="comment">     * Format a text string for meta information</span>
<a name="l12927"></a>12927 <span class="comment">     * @param $s (string) string to escape.</span>
<a name="l12928"></a>12928 <span class="comment">     * @param $n (int) object ID</span>
<a name="l12929"></a>12929 <span class="comment">     * @return string escaped string.</span>
<a name="l12930"></a>12930 <span class="comment">     * @protected</span>
<a name="l12931"></a>12931 <span class="comment">     */</span>
<a name="l12932"></a><a class="code" href="classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81">12932</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81" title="Format a text string for meta information.">_textstring</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $n=0) {
<a name="l12933"></a>12933         <span class="keywordflow">if</span> ($this-&gt;isunicode) {
<a name="l12934"></a>12934             <span class="comment">//Convert string to UTF-16BE</span>
<a name="l12935"></a>12935             <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = $this-&gt;UTF8ToUTF16BE(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, <span class="keyword">true</span>);
<a name="l12936"></a>12936         }
<a name="l12937"></a>12937         <span class="keywordflow">return</span> $this-&gt;_datastring(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $n);
<a name="l12938"></a>12938     }
<a name="l12939"></a>12939 <span class="comment"></span>
<a name="l12940"></a>12940 <span class="comment">    /**</span>
<a name="l12941"></a>12941 <span class="comment">     * THIS METHOD IS DEPRECATED</span>
<a name="l12942"></a>12942 <span class="comment">     * Format a text string</span>
<a name="l12943"></a>12943 <span class="comment">     * @param $s (string) string to escape.</span>
<a name="l12944"></a>12944 <span class="comment">     * @return string escaped string.</span>
<a name="l12945"></a>12945 <span class="comment">     * @protected</span>
<a name="l12946"></a>12946 <span class="comment">     * @deprecated</span>
<a name="l12947"></a>12947 <span class="comment">     */</span>
<a name="l12948"></a><a class="code" href="classTCPDF.html#ae19b61fda7662a88bda031589ae95e32">12948</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae19b61fda7662a88bda031589ae95e32" title="THIS METHOD IS DEPRECATED Format a text string.">_escapetext</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>) {
<a name="l12949"></a>12949         <span class="keywordflow">if</span> ($this-&gt;isunicode) {
<a name="l12950"></a>12950             <span class="keywordflow">if</span> (($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;core&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;TrueType&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;Type1&#39;</span>)) {
<a name="l12951"></a>12951                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = $this-&gt;UTF8ToLatin1(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l12952"></a>12952             } <span class="keywordflow">else</span> {
<a name="l12953"></a>12953                 <span class="comment">//Convert string to UTF-16BE and reverse RTL language</span>
<a name="l12954"></a>12954                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = $this-&gt;utf8StrRev(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, <span class="keyword">false</span>, $this-&gt;tmprtl);
<a name="l12955"></a>12955             }
<a name="l12956"></a>12956         }
<a name="l12957"></a>12957         <span class="keywordflow">return</span> $this-&gt;_escape(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l12958"></a>12958     }
<a name="l12959"></a>12959 <span class="comment"></span>
<a name="l12960"></a>12960 <span class="comment">    /**</span>
<a name="l12961"></a>12961 <span class="comment">    * Escape some special characters (&amp;lt; &amp;gt; &amp;amp;) for XML output.</span>
<a name="l12962"></a>12962 <span class="comment">    * @param $str (string) Input string to convert.</span>
<a name="l12963"></a>12963 <span class="comment">    * @return converted string</span>
<a name="l12964"></a>12964 <span class="comment">    * @since 5.9.121 (2011-09-28)</span>
<a name="l12965"></a>12965 <span class="comment">    * @protected</span>
<a name="l12966"></a>12966 <span class="comment">    */</span>
<a name="l12967"></a><a class="code" href="classTCPDF.html#ad6f87b2fa5352343b1f06f84034d7fec">12967</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad6f87b2fa5352343b1f06f84034d7fec" title="Escape some special characters (&lt; &gt; &amp;) for XML output.">_escapeXML</a>($str) {
<a name="l12968"></a>12968         $replaceTable = array(<span class="stringliteral">&quot;\0&quot;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;&amp;&#39;</span> =&gt; <span class="stringliteral">&#39;&amp;amp;&#39;</span>, <span class="charliteral">&#39;&lt;&#39;</span> =&gt; <span class="stringliteral">&#39;&amp;lt;&#39;</span>, <span class="charliteral">&#39;&gt;&#39;</span> =&gt; <span class="stringliteral">&#39;&amp;gt;&#39;</span>);
<a name="l12969"></a>12969         $str = strtr($str, $replaceTable);
<a name="l12970"></a>12970         <span class="keywordflow">return</span> $str;
<a name="l12971"></a>12971     }
<a name="l12972"></a>12972 <span class="comment"></span>
<a name="l12973"></a>12973 <span class="comment">    /**</span>
<a name="l12974"></a>12974 <span class="comment">     * get raw output stream.</span>
<a name="l12975"></a>12975 <span class="comment">     * @param $s (string) string to output.</span>
<a name="l12976"></a>12976 <span class="comment">     * @param $n (int) object reference for encryption mode</span>
<a name="l12977"></a>12977 <span class="comment">     * @protected</span>
<a name="l12978"></a>12978 <span class="comment">     * @author Nicola Asuni</span>
<a name="l12979"></a>12979 <span class="comment">     * @since 5.5.000 (2010-06-22)</span>
<a name="l12980"></a>12980 <span class="comment">     */</span>
<a name="l12981"></a><a class="code" href="classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">12981</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb" title="get raw output stream.">_getrawstream</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $n=0) {
<a name="l12982"></a>12982         <span class="keywordflow">if</span> ($n &lt;= 0) {
<a name="l12983"></a>12983             <span class="comment">// default to current object</span>
<a name="l12984"></a>12984             $n = $this-&gt;n;
<a name="l12985"></a>12985         }
<a name="l12986"></a>12986         <span class="keywordflow">return</span> $this-&gt;_encrypt_data($n, <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l12987"></a>12987     }
<a name="l12988"></a>12988 <span class="comment"></span>
<a name="l12989"></a>12989 <span class="comment">    /**</span>
<a name="l12990"></a>12990 <span class="comment">     * Format output stream (DEPRECATED).</span>
<a name="l12991"></a>12991 <span class="comment">     * @param $s (string) string to output.</span>
<a name="l12992"></a>12992 <span class="comment">     * @param $n (int) object reference for encryption mode</span>
<a name="l12993"></a>12993 <span class="comment">     * @protected</span>
<a name="l12994"></a>12994 <span class="comment">     * @deprecated</span>
<a name="l12995"></a>12995 <span class="comment">     */</span>
<a name="l12996"></a><a class="code" href="classTCPDF.html#a3c441291e8b83dc4a15794ea92f44415">12996</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3c441291e8b83dc4a15794ea92f44415" title="Format output stream (DEPRECATED).">_getstream</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $n=0) {
<a name="l12997"></a>12997         <span class="keywordflow">return</span> <span class="stringliteral">&#39;stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$this-&gt;_getrawstream(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $n).<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l12998"></a>12998     }
<a name="l12999"></a>12999 <span class="comment"></span>
<a name="l13000"></a>13000 <span class="comment">    /**</span>
<a name="l13001"></a>13001 <span class="comment">     * Output a stream (DEPRECATED).</span>
<a name="l13002"></a>13002 <span class="comment">     * @param $s (string) string to output.</span>
<a name="l13003"></a>13003 <span class="comment">     * @param $n (int) object reference for encryption mode</span>
<a name="l13004"></a>13004 <span class="comment">     * @protected</span>
<a name="l13005"></a>13005 <span class="comment">     * @deprecated</span>
<a name="l13006"></a>13006 <span class="comment">     */</span>
<a name="l13007"></a><a class="code" href="classTCPDF.html#a54cc2d89767ef5425957a0c0a9b34269">13007</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a54cc2d89767ef5425957a0c0a9b34269" title="Output a stream (DEPRECATED).">_putstream</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $n=0) {
<a name="l13008"></a>13008         $this-&gt;_out($this-&gt;_getstream(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, $n));
<a name="l13009"></a>13009     }
<a name="l13010"></a>13010 <span class="comment"></span>
<a name="l13011"></a>13011 <span class="comment">    /**</span>
<a name="l13012"></a>13012 <span class="comment">     * Output a string to the document.</span>
<a name="l13013"></a>13013 <span class="comment">     * @param $s (string) string to output.</span>
<a name="l13014"></a>13014 <span class="comment">     * @protected</span>
<a name="l13015"></a>13015 <span class="comment">     */</span>
<a name="l13016"></a><a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">13016</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac57877b76c37aef3195ad45731715b9e" title="Output a string to the document.">_out</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>) {
<a name="l13017"></a>13017         <span class="keywordflow">if</span> ($this-&gt;state == 2) {
<a name="l13018"></a>13018             <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l13019"></a>13019                 <span class="comment">// we are inside an XObject template</span>
<a name="l13020"></a>13020                 $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] .= <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>.<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l13021"></a>13021             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((!$this-&gt;InFooter) AND isset($this-&gt;footerlen[$this-&gt;page]) AND ($this-&gt;footerlen[$this-&gt;page] &gt; 0)) {
<a name="l13022"></a>13022                 <span class="comment">// puts data before page footer</span>
<a name="l13023"></a>13023                 $pagebuff = $this-&gt;getPageBuffer($this-&gt;page);
<a name="l13024"></a>13024                 <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = substr($pagebuff, 0, -$this-&gt;footerlen[$this-&gt;page]);
<a name="l13025"></a>13025                 $footer = substr($pagebuff, -$this-&gt;footerlen[$this-&gt;page]);
<a name="l13026"></a>13026                 $this-&gt;setPageBuffer($this-&gt;page, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>.$s.<span class="stringliteral">&quot;\n&quot;</span>.$footer);
<a name="l13027"></a>13027                 <span class="comment">// update footer position</span>
<a name="l13028"></a>13028                 $this-&gt;footerpos[$this-&gt;page] += strlen(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>.<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l13029"></a>13029             } <span class="keywordflow">else</span> {
<a name="l13030"></a>13030                 $this-&gt;setPageBuffer($this-&gt;page, <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>.<span class="stringliteral">&quot;\n&quot;</span>, <span class="keyword">true</span>);
<a name="l13031"></a>13031             }
<a name="l13032"></a>13032         } <span class="keywordflow">else</span> {
<a name="l13033"></a>13033             $this-&gt;setBuffer(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>.<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l13034"></a>13034         }
<a name="l13035"></a>13035     }
<a name="l13036"></a>13036 <span class="comment"></span>
<a name="l13037"></a>13037 <span class="comment">    /**</span>
<a name="l13038"></a>13038 <span class="comment">     * Converts UTF-8 strings to codepoints array.&lt;br&gt;</span>
<a name="l13039"></a>13039 <span class="comment">     * Invalid byte sequences will be replaced with 0xFFFD (replacement character)&lt;br&gt;</span>
<a name="l13040"></a>13040 <span class="comment">     * Based on: http://www.faqs.org/rfcs/rfc3629.html</span>
<a name="l13041"></a>13041 <span class="comment">     * &lt;pre&gt;</span>
<a name="l13042"></a>13042 <span class="comment">     *    Char. number range  |        UTF-8 octet sequence</span>
<a name="l13043"></a>13043 <span class="comment">     *       (hexadecimal)    |              (binary)</span>
<a name="l13044"></a>13044 <span class="comment">     *    --------------------+-----------------------------------------------</span>
<a name="l13045"></a>13045 <span class="comment">     *    0000 0000-0000 007F | 0xxxxxxx</span>
<a name="l13046"></a>13046 <span class="comment">     *    0000 0080-0000 07FF | 110xxxxx 10xxxxxx</span>
<a name="l13047"></a>13047 <span class="comment">     *    0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx</span>
<a name="l13048"></a>13048 <span class="comment">     *    0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx</span>
<a name="l13049"></a>13049 <span class="comment">     *    ---------------------------------------------------------------------</span>
<a name="l13050"></a>13050 <span class="comment">     *</span>
<a name="l13051"></a>13051 <span class="comment">     *   ABFN notation:</span>
<a name="l13052"></a>13052 <span class="comment">     *   ---------------------------------------------------------------------</span>
<a name="l13053"></a>13053 <span class="comment">     *   UTF8-octets = *( UTF8-char )</span>
<a name="l13054"></a>13054 <span class="comment">     *   UTF8-char   = UTF8-1 / UTF8-2 / UTF8-3 / UTF8-4</span>
<a name="l13055"></a>13055 <span class="comment">     *   UTF8-1      = %x00-7F</span>
<a name="l13056"></a>13056 <span class="comment">     *   UTF8-2      = %xC2-DF UTF8-tail</span>
<a name="l13057"></a>13057 <span class="comment">     *</span>
<a name="l13058"></a>13058 <span class="comment">     *   UTF8-3      = %xE0 %xA0-BF UTF8-tail / %xE1-EC 2( UTF8-tail ) /</span>
<a name="l13059"></a>13059 <span class="comment">     *                 %xED %x80-9F UTF8-tail / %xEE-EF 2( UTF8-tail )</span>
<a name="l13060"></a>13060 <span class="comment">     *   UTF8-4      = %xF0 %x90-BF 2( UTF8-tail ) / %xF1-F3 3( UTF8-tail ) /</span>
<a name="l13061"></a>13061 <span class="comment">     *                 %xF4 %x80-8F 2( UTF8-tail )</span>
<a name="l13062"></a>13062 <span class="comment">     *   UTF8-tail   = %x80-BF</span>
<a name="l13063"></a>13063 <span class="comment">     *   ---------------------------------------------------------------------</span>
<a name="l13064"></a>13064 <span class="comment">     * &lt;/pre&gt;</span>
<a name="l13065"></a>13065 <span class="comment">     * @param $str (string) string to process.</span>
<a name="l13066"></a>13066 <span class="comment">     * @return array containing codepoints (UTF-8 characters values)</span>
<a name="l13067"></a>13067 <span class="comment">     * @protected</span>
<a name="l13068"></a>13068 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13069"></a>13069 <span class="comment">     * @since 1.53.0.TC005 (2005-01-05)</span>
<a name="l13070"></a>13070 <span class="comment">     */</span>
<a name="l13071"></a><a class="code" href="classTCPDF.html#a35a90a2cd5b8ab143d978128a21de09e">13071</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a35a90a2cd5b8ab143d978128a21de09e" title="Converts UTF-8 strings to codepoints array.">UTF8StringToArray</a>($str) {
<a name="l13072"></a>13072         <span class="comment">// build a unique string key</span>
<a name="l13073"></a>13073         $strkey = md5($str);
<a name="l13074"></a>13074         <span class="keywordflow">if</span> (isset($this-&gt;cache_UTF8StringToArray[$strkey])) {
<a name="l13075"></a>13075             <span class="comment">// return cached value</span>
<a name="l13076"></a>13076             $chrarray = $this-&gt;cache_UTF8StringToArray[$strkey][<span class="charliteral">&#39;s&#39;</span>];
<a name="l13077"></a>13077             <span class="keywordflow">if</span> (!isset($this-&gt;cache_UTF8StringToArray[$strkey][<span class="charliteral">&#39;f&#39;</span>][$this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>]])) {
<a name="l13078"></a>13078                 <span class="keywordflow">if</span> ($this-&gt;isunicode) {
<a name="l13079"></a>13079                     <span class="keywordflow">foreach</span> ($chrarray as $chr) {
<a name="l13080"></a>13080                         <span class="comment">// store this char for font subsetting</span>
<a name="l13081"></a>13081                         $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>][$chr] = <span class="keyword">true</span>;
<a name="l13082"></a>13082                     }
<a name="l13083"></a>13083                     <span class="comment">// update font subsetchars</span>
<a name="l13084"></a>13084                     $this-&gt;setFontSubBuffer($this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>], <span class="stringliteral">&#39;subsetchars&#39;</span>, $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>]);
<a name="l13085"></a>13085                 }
<a name="l13086"></a>13086                 $this-&gt;cache_UTF8StringToArray[$strkey][<span class="charliteral">&#39;f&#39;</span>][$this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>]] = <span class="keyword">true</span>;
<a name="l13087"></a>13087             }
<a name="l13088"></a>13088             <span class="keywordflow">return</span> $chrarray;
<a name="l13089"></a>13089         }
<a name="l13090"></a>13090         <span class="comment">// check cache size</span>
<a name="l13091"></a>13091         <span class="keywordflow">if</span> ($this-&gt;cache_size_UTF8StringToArray &gt;= $this-&gt;cache_maxsize_UTF8StringToArray) {
<a name="l13092"></a>13092             <span class="comment">// remove first element</span>
<a name="l13093"></a>13093             array_shift($this-&gt;cache_UTF8StringToArray);
<a name="l13094"></a>13094         }
<a name="l13095"></a>13095         <span class="comment">// new cache array for selected string</span>
<a name="l13096"></a>13096         $this-&gt;cache_UTF8StringToArray[$strkey] = array(<span class="charliteral">&#39;s&#39;</span> =&gt; array(), <span class="charliteral">&#39;f&#39;</span> =&gt; array());
<a name="l13097"></a>13097         ++$this-&gt;cache_size_UTF8StringToArray;
<a name="l13098"></a>13098         <span class="keywordflow">if</span> (!$this-&gt;isunicode) {
<a name="l13099"></a>13099             <span class="comment">// split string into array of equivalent codes</span>
<a name="l13100"></a>13100             $strarr = array();
<a name="l13101"></a>13101             $strlen = strlen($str);
<a name="l13102"></a>13102             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $strlen; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l13103"></a>13103                 $strarr[] = ord($str[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]);
<a name="l13104"></a>13104             }
<a name="l13105"></a>13105             <span class="comment">// insert new value on cache</span>
<a name="l13106"></a>13106             $this-&gt;cache_UTF8StringToArray[$strkey][<span class="charliteral">&#39;s&#39;</span>] = $strarr;
<a name="l13107"></a>13107             $this-&gt;cache_UTF8StringToArray[$strkey][<span class="charliteral">&#39;f&#39;</span>][$this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>]] = <span class="keyword">true</span>;
<a name="l13108"></a>13108             <span class="keywordflow">return</span> $strarr;
<a name="l13109"></a>13109         }
<a name="l13110"></a>13110         $unichar = -1; <span class="comment">// last unicode char</span>
<a name="l13111"></a>13111         $unicode = array(); <span class="comment">// array containing unicode values</span>
<a name="l13112"></a>13112         $bytes  = array(); <span class="comment">// array containing single character byte sequences</span>
<a name="l13113"></a>13113         $numbytes = 1; <span class="comment">// number of octetc needed to represent the UTF-8 character</span>
<a name="l13114"></a>13114         $str .= <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// force $str to be a string</span>
<a name="l13115"></a>13115         $length = strlen($str);
<a name="l13116"></a>13116         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $length; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l13117"></a>13117             $char = ord($str[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]); <span class="comment">// get one string character at time</span>
<a name="l13118"></a>13118             <span class="keywordflow">if</span> (count($bytes) == 0) { <span class="comment">// get starting octect</span>
<a name="l13119"></a>13119                 <span class="keywordflow">if</span> ($char &lt;= 0x7F) {
<a name="l13120"></a>13120                     $unichar = $char; <span class="comment">// use the character &quot;as is&quot; because is ASCII</span>
<a name="l13121"></a>13121                     $numbytes = 1;
<a name="l13122"></a>13122                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($char &gt;&gt; 0x05) == 0x06) { <span class="comment">// 2 bytes character (0x06 = 110 BIN)</span>
<a name="l13123"></a>13123                     $bytes[] = ($char - 0xC0) &lt;&lt; 0x06;
<a name="l13124"></a>13124                     $numbytes = 2;
<a name="l13125"></a>13125                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($char &gt;&gt; 0x04) == 0x0E) { <span class="comment">// 3 bytes character (0x0E = 1110 BIN)</span>
<a name="l13126"></a>13126                     $bytes[] = ($char - 0xE0) &lt;&lt; 0x0C;
<a name="l13127"></a>13127                     $numbytes = 3;
<a name="l13128"></a>13128                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($char &gt;&gt; 0x03) == 0x1E) { <span class="comment">// 4 bytes character (0x1E = 11110 BIN)</span>
<a name="l13129"></a>13129                     $bytes[] = ($char - 0xF0) &lt;&lt; 0x12;
<a name="l13130"></a>13130                     $numbytes = 4;
<a name="l13131"></a>13131                 } <span class="keywordflow">else</span> {
<a name="l13132"></a>13132                     <span class="comment">// use replacement character for other invalid sequences</span>
<a name="l13133"></a>13133                     $unichar = 0xFFFD;
<a name="l13134"></a>13134                     $bytes = array();
<a name="l13135"></a>13135                     $numbytes = 1;
<a name="l13136"></a>13136                 }
<a name="l13137"></a>13137             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($char &gt;&gt; 0x06) == 0x02) { <span class="comment">// bytes 2, 3 and 4 must start with 0x02 = 10 BIN</span>
<a name="l13138"></a>13138                 $bytes[] = $char - 0x80;
<a name="l13139"></a>13139                 <span class="keywordflow">if</span> (count($bytes) == $numbytes) {
<a name="l13140"></a>13140                     <span class="comment">// compose UTF-8 bytes to a single unicode value</span>
<a name="l13141"></a>13141                     $char = $bytes[0];
<a name="l13142"></a>13142                     <span class="keywordflow">for</span> ($j = 1; $j &lt; $numbytes; ++$j) {
<a name="l13143"></a>13143                         $char += ($bytes[$j] &lt;&lt; (($numbytes - $j - 1) * 0x06));
<a name="l13144"></a>13144                     }
<a name="l13145"></a>13145                     <span class="keywordflow">if</span> ((($char &gt;= 0xD800) AND ($char &lt;= 0xDFFF)) OR ($char &gt;= 0x10FFFF)) {
<a name="l13146"></a>13146                         <span class="comment">/* The definition of UTF-8 prohibits encoding character numbers between</span>
<a name="l13147"></a>13147 <span class="comment">                        U+D800 and U+DFFF, which are reserved for use with the UTF-16</span>
<a name="l13148"></a>13148 <span class="comment">                        encoding form (as surrogate pairs) and do not directly represent</span>
<a name="l13149"></a>13149 <span class="comment">                        characters. */</span>
<a name="l13150"></a>13150                         $unichar = 0xFFFD; <span class="comment">// use replacement character</span>
<a name="l13151"></a>13151                     } <span class="keywordflow">else</span> {
<a name="l13152"></a>13152                         $unichar = $char; <span class="comment">// add char to array</span>
<a name="l13153"></a>13153                     }
<a name="l13154"></a>13154                     <span class="comment">// reset data for next char</span>
<a name="l13155"></a>13155                     $bytes = array();
<a name="l13156"></a>13156                     $numbytes = 1;
<a name="l13157"></a>13157                 }
<a name="l13158"></a>13158             } <span class="keywordflow">else</span> {
<a name="l13159"></a>13159                 <span class="comment">// use replacement character for other invalid sequences</span>
<a name="l13160"></a>13160                 $unichar = 0xFFFD;
<a name="l13161"></a>13161                 $bytes = array();
<a name="l13162"></a>13162                 $numbytes = 1;
<a name="l13163"></a>13163             }
<a name="l13164"></a>13164             <span class="keywordflow">if</span> ($unichar &gt;= 0) {
<a name="l13165"></a>13165                 <span class="comment">// insert unicode value into array</span>
<a name="l13166"></a>13166                 $unicode[] = $unichar;
<a name="l13167"></a>13167                 <span class="comment">// store this char for font subsetting</span>
<a name="l13168"></a>13168                 $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>][$unichar] = <span class="keyword">true</span>;
<a name="l13169"></a>13169                 $unichar = -1;
<a name="l13170"></a>13170             }
<a name="l13171"></a>13171         }
<a name="l13172"></a>13172         <span class="comment">// update font subsetchars</span>
<a name="l13173"></a>13173         $this-&gt;setFontSubBuffer($this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>], <span class="stringliteral">&#39;subsetchars&#39;</span>, $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>]);
<a name="l13174"></a>13174         <span class="comment">// insert new value on cache</span>
<a name="l13175"></a>13175         $this-&gt;cache_UTF8StringToArray[$strkey][<span class="charliteral">&#39;s&#39;</span>] = $unicode;
<a name="l13176"></a>13176         $this-&gt;cache_UTF8StringToArray[$strkey][<span class="charliteral">&#39;f&#39;</span>][$this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>]] = <span class="keyword">true</span>;
<a name="l13177"></a>13177         <span class="keywordflow">return</span> $unicode;
<a name="l13178"></a>13178     }
<a name="l13179"></a>13179 <span class="comment"></span>
<a name="l13180"></a>13180 <span class="comment">    /**</span>
<a name="l13181"></a>13181 <span class="comment">     * Converts UTF-8 strings to UTF16-BE.&lt;br&gt;</span>
<a name="l13182"></a>13182 <span class="comment">     * @param $str (string) string to process.</span>
<a name="l13183"></a>13183 <span class="comment">     * @param $setbom (boolean) if true set the Byte Order Mark (BOM = 0xFEFF)</span>
<a name="l13184"></a>13184 <span class="comment">     * @return string</span>
<a name="l13185"></a>13185 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13186"></a>13186 <span class="comment">     * @since 1.53.0.TC005 (2005-01-05)</span>
<a name="l13187"></a>13187 <span class="comment">     * @see UTF8StringToArray(), arrUTF8ToUTF16BE()</span>
<a name="l13188"></a>13188 <span class="comment">     * @protected</span>
<a name="l13189"></a>13189 <span class="comment">     */</span>
<a name="l13190"></a><a class="code" href="classTCPDF.html#a1b521359e6e473dc61ad966a90a7839e">13190</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1b521359e6e473dc61ad966a90a7839e" title="Converts UTF-8 strings to UTF16-BE.">UTF8ToUTF16BE</a>($str, $setbom=<span class="keyword">false</span>) {
<a name="l13191"></a>13191         <span class="keywordflow">if</span> (!$this-&gt;isunicode) {
<a name="l13192"></a>13192             <span class="keywordflow">return</span> $str; <span class="comment">// string is not in unicode</span>
<a name="l13193"></a>13193         }
<a name="l13194"></a>13194         $unicode = $this-&gt;UTF8StringToArray($str); <span class="comment">// array containing UTF-8 unicode values</span>
<a name="l13195"></a>13195         <span class="keywordflow">return</span> $this-&gt;arrUTF8ToUTF16BE($unicode, $setbom);
<a name="l13196"></a>13196     }
<a name="l13197"></a>13197 <span class="comment"></span>
<a name="l13198"></a>13198 <span class="comment">    /**</span>
<a name="l13199"></a>13199 <span class="comment">     * Converts UTF-8 strings to Latin1 when using the standard 14 core fonts.&lt;br&gt;</span>
<a name="l13200"></a>13200 <span class="comment">     * @param $str (string) string to process.</span>
<a name="l13201"></a>13201 <span class="comment">     * @return string</span>
<a name="l13202"></a>13202 <span class="comment">     * @author Andrew Whitehead, Nicola Asuni</span>
<a name="l13203"></a>13203 <span class="comment">     * @protected</span>
<a name="l13204"></a>13204 <span class="comment">     * @since 3.2.000 (2008-06-23)</span>
<a name="l13205"></a>13205 <span class="comment">     */</span>
<a name="l13206"></a><a class="code" href="classTCPDF.html#a60c04a399d19927e7a3ee249694aaa62">13206</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a60c04a399d19927e7a3ee249694aaa62" title="Converts UTF-8 strings to Latin1 when using the standard 14 core fonts.">UTF8ToLatin1</a>($str) {
<a name="l13207"></a>13207         <span class="keywordflow">if</span> (!$this-&gt;isunicode) {
<a name="l13208"></a>13208             <span class="keywordflow">return</span> $str; <span class="comment">// string is not in unicode</span>
<a name="l13209"></a>13209         }
<a name="l13210"></a>13210         $outstr = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// string to be returned</span>
<a name="l13211"></a>13211         $unicode = $this-&gt;UTF8StringToArray($str); <span class="comment">// array containing UTF-8 unicode values</span>
<a name="l13212"></a>13212         <span class="keywordflow">foreach</span> ($unicode as $char) {
<a name="l13213"></a>13213             <span class="keywordflow">if</span> ($char &lt; 256) {
<a name="l13214"></a>13214                 $outstr .= chr($char);
<a name="l13215"></a>13215             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (array_key_exists($char, $this-&gt;unicode-&gt;uni_utf8tolatin)) {
<a name="l13216"></a>13216                 <span class="comment">// map from UTF-8</span>
<a name="l13217"></a>13217                 $outstr .= chr($this-&gt;unicode-&gt;uni_utf8tolatin[$char]);
<a name="l13218"></a>13218             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($char == 0xFFFD) {
<a name="l13219"></a>13219                 <span class="comment">// skip</span>
<a name="l13220"></a>13220             } <span class="keywordflow">else</span> {
<a name="l13221"></a>13221                 $outstr .= <span class="charliteral">&#39;?&#39;</span>;
<a name="l13222"></a>13222             }
<a name="l13223"></a>13223         }
<a name="l13224"></a>13224         <span class="keywordflow">return</span> $outstr;
<a name="l13225"></a>13225     }
<a name="l13226"></a>13226 <span class="comment"></span>
<a name="l13227"></a>13227 <span class="comment">    /**</span>
<a name="l13228"></a>13228 <span class="comment">     * Converts UTF-8 characters array to array of Latin1 characters&lt;br&gt;</span>
<a name="l13229"></a>13229 <span class="comment">     * @param $unicode (array) array containing UTF-8 unicode values</span>
<a name="l13230"></a>13230 <span class="comment">     * @return array</span>
<a name="l13231"></a>13231 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13232"></a>13232 <span class="comment">     * @protected</span>
<a name="l13233"></a>13233 <span class="comment">     * @since 4.8.023 (2010-01-15)</span>
<a name="l13234"></a>13234 <span class="comment">     */</span>
<a name="l13235"></a><a class="code" href="classTCPDF.html#a49045c2ce294f72c7720decbc96ebbbb">13235</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a49045c2ce294f72c7720decbc96ebbbb" title="Converts UTF-8 characters array to array of Latin1 characters ">UTF8ArrToLatin1</a>($unicode) {
<a name="l13236"></a>13236         <span class="keywordflow">if</span> ((!$this-&gt;isunicode) OR $this-&gt;isUnicodeFont()) {
<a name="l13237"></a>13237             <span class="keywordflow">return</span> $unicode;
<a name="l13238"></a>13238         }
<a name="l13239"></a>13239         $outarr = array(); <span class="comment">// array to be returned</span>
<a name="l13240"></a>13240         <span class="keywordflow">foreach</span> ($unicode as $char) {
<a name="l13241"></a>13241             <span class="keywordflow">if</span> ($char &lt; 256) {
<a name="l13242"></a>13242                 $outarr[] = $char;
<a name="l13243"></a>13243             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (array_key_exists($char, $this-&gt;unicode-&gt;uni_utf8tolatin)) {
<a name="l13244"></a>13244                 <span class="comment">// map from UTF-8</span>
<a name="l13245"></a>13245                 $outarr[] = $this-&gt;unicode-&gt;uni_utf8tolatin[$char];
<a name="l13246"></a>13246             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($char == 0xFFFD) {
<a name="l13247"></a>13247                 <span class="comment">// skip</span>
<a name="l13248"></a>13248             } <span class="keywordflow">else</span> {
<a name="l13249"></a>13249                 $outarr[] = 63; <span class="comment">// &#39;?&#39; character</span>
<a name="l13250"></a>13250             }
<a name="l13251"></a>13251         }
<a name="l13252"></a>13252         <span class="keywordflow">return</span> $outarr;
<a name="l13253"></a>13253     }
<a name="l13254"></a>13254 <span class="comment"></span>
<a name="l13255"></a>13255 <span class="comment">    /**</span>
<a name="l13256"></a>13256 <span class="comment">     * Converts array of UTF-8 characters to UTF16-BE string.&lt;br&gt;</span>
<a name="l13257"></a>13257 <span class="comment">     * Based on: http://www.faqs.org/rfcs/rfc2781.html</span>
<a name="l13258"></a>13258 <span class="comment">     * &lt;pre&gt;</span>
<a name="l13259"></a>13259 <span class="comment">     *   Encoding UTF-16:</span>
<a name="l13260"></a>13260 <span class="comment">     *</span>
<a name="l13261"></a>13261 <span class="comment">     *   Encoding of a single character from an ISO 10646 character value to</span>
<a name="l13262"></a>13262 <span class="comment">     *    UTF-16 proceeds as follows. Let U be the character number, no greater</span>
<a name="l13263"></a>13263 <span class="comment">     *    than 0x10FFFF.</span>
<a name="l13264"></a>13264 <span class="comment">     *</span>
<a name="l13265"></a>13265 <span class="comment">     *    1) If U &lt; 0x10000, encode U as a 16-bit unsigned integer and</span>
<a name="l13266"></a>13266 <span class="comment">     *       terminate.</span>
<a name="l13267"></a>13267 <span class="comment">     *</span>
<a name="l13268"></a>13268 <span class="comment">     *    2) Let U&#39; = U - 0x10000. Because U is less than or equal to 0x10FFFF,</span>
<a name="l13269"></a>13269 <span class="comment">     *       U&#39; must be less than or equal to 0xFFFFF. That is, U&#39; can be</span>
<a name="l13270"></a>13270 <span class="comment">     *       represented in 20 bits.</span>
<a name="l13271"></a>13271 <span class="comment">     *</span>
<a name="l13272"></a>13272 <span class="comment">     *    3) Initialize two 16-bit unsigned integers, W1 and W2, to 0xD800 and</span>
<a name="l13273"></a>13273 <span class="comment">     *       0xDC00, respectively. These integers each have 10 bits free to</span>
<a name="l13274"></a>13274 <span class="comment">     *       encode the character value, for a total of 20 bits.</span>
<a name="l13275"></a>13275 <span class="comment">     *</span>
<a name="l13276"></a>13276 <span class="comment">     *    4) Assign the 10 high-order bits of the 20-bit U&#39; to the 10 low-order</span>
<a name="l13277"></a>13277 <span class="comment">     *       bits of W1 and the 10 low-order bits of U&#39; to the 10 low-order</span>
<a name="l13278"></a>13278 <span class="comment">     *       bits of W2. Terminate.</span>
<a name="l13279"></a>13279 <span class="comment">     *</span>
<a name="l13280"></a>13280 <span class="comment">     *    Graphically, steps 2 through 4 look like:</span>
<a name="l13281"></a>13281 <span class="comment">     *    U&#39; = yyyyyyyyyyxxxxxxxxxx</span>
<a name="l13282"></a>13282 <span class="comment">     *    W1 = 110110yyyyyyyyyy</span>
<a name="l13283"></a>13283 <span class="comment">     *    W2 = 110111xxxxxxxxxx</span>
<a name="l13284"></a>13284 <span class="comment">     * &lt;/pre&gt;</span>
<a name="l13285"></a>13285 <span class="comment">     * @param $unicode (array) array containing UTF-8 unicode values</span>
<a name="l13286"></a>13286 <span class="comment">     * @param $setbom (boolean) if true set the Byte Order Mark (BOM = 0xFEFF)</span>
<a name="l13287"></a>13287 <span class="comment">     * @return string</span>
<a name="l13288"></a>13288 <span class="comment">     * @protected</span>
<a name="l13289"></a>13289 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13290"></a>13290 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l13291"></a>13291 <span class="comment">     * @see UTF8ToUTF16BE()</span>
<a name="l13292"></a>13292 <span class="comment">     */</span>
<a name="l13293"></a><a class="code" href="classTCPDF.html#a8b9c15b8e72db768753c5dc1a96bb2ce">13293</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8b9c15b8e72db768753c5dc1a96bb2ce" title="Converts array of UTF-8 characters to UTF16-BE string.">arrUTF8ToUTF16BE</a>($unicode, $setbom=<span class="keyword">false</span>) {
<a name="l13294"></a>13294         $outstr = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// string to be returned</span>
<a name="l13295"></a>13295         <span class="keywordflow">if</span> ($setbom) {
<a name="l13296"></a>13296             $outstr .= <span class="stringliteral">&quot;\xFE\xFF&quot;</span>; <span class="comment">// Byte Order Mark (BOM)</span>
<a name="l13297"></a>13297         }
<a name="l13298"></a>13298         <span class="keywordflow">foreach</span> ($unicode as $char) {
<a name="l13299"></a>13299             <span class="keywordflow">if</span> ($char == 0x200b) {
<a name="l13300"></a>13300                 <span class="comment">// skip Unicode Character &#39;ZERO WIDTH SPACE&#39; (DEC:8203, U+200B)</span>
<a name="l13301"></a>13301             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($char == 0xFFFD) {
<a name="l13302"></a>13302                 $outstr .= <span class="stringliteral">&quot;\xFF\xFD&quot;</span>; <span class="comment">// replacement character</span>
<a name="l13303"></a>13303             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($char &lt; 0x10000) {
<a name="l13304"></a>13304                 $outstr .= chr($char &gt;&gt; 0x08);
<a name="l13305"></a>13305                 $outstr .= chr($char &amp; 0xFF);
<a name="l13306"></a>13306             } <span class="keywordflow">else</span> {
<a name="l13307"></a>13307                 $char -= 0x10000;
<a name="l13308"></a>13308                 $w1 = 0xD800 | ($char &gt;&gt; 0x0a);
<a name="l13309"></a>13309                 $w2 = 0xDC00 | ($char &amp; 0x3FF);
<a name="l13310"></a>13310                 $outstr .= chr($w1 &gt;&gt; 0x08);
<a name="l13311"></a>13311                 $outstr .= chr($w1 &amp; 0xFF);
<a name="l13312"></a>13312                 $outstr .= chr($w2 &gt;&gt; 0x08);
<a name="l13313"></a>13313                 $outstr .= chr($w2 &amp; 0xFF);
<a name="l13314"></a>13314             }
<a name="l13315"></a>13315         }
<a name="l13316"></a>13316         <span class="keywordflow">return</span> $outstr;
<a name="l13317"></a>13317     }
<a name="l13318"></a>13318     <span class="comment">// ====================================================</span>
<a name="l13319"></a>13319 <span class="comment"></span>
<a name="l13320"></a>13320 <span class="comment">    /**</span>
<a name="l13321"></a>13321 <span class="comment">     * Set header font.</span>
<a name="l13322"></a>13322 <span class="comment">     * @param $font (array) font</span>
<a name="l13323"></a>13323 <span class="comment">     * @public</span>
<a name="l13324"></a>13324 <span class="comment">     * @since 1.1</span>
<a name="l13325"></a>13325 <span class="comment">     */</span>
<a name="l13326"></a><a class="code" href="classTCPDF.html#aee22655aad0ae32a3194298585da16a2">13326</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aee22655aad0ae32a3194298585da16a2" title="Set header font.">setHeaderFont</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>) {
<a name="l13327"></a>13327         $this-&gt;header_font = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l13328"></a>13328     }
<a name="l13329"></a>13329 <span class="comment"></span>
<a name="l13330"></a>13330 <span class="comment">    /**</span>
<a name="l13331"></a>13331 <span class="comment">     * Get header font.</span>
<a name="l13332"></a>13332 <span class="comment">     * @return array()</span>
<a name="l13333"></a>13333 <span class="comment">     * @public</span>
<a name="l13334"></a>13334 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l13335"></a>13335 <span class="comment">     */</span>
<a name="l13336"></a><a class="code" href="classTCPDF.html#a2490e635d8ff11d41b6578bab46acba5">13336</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2490e635d8ff11d41b6578bab46acba5" title="Get header font.">getHeaderFont</a>() {
<a name="l13337"></a>13337         <span class="keywordflow">return</span> $this-&gt;header_font;
<a name="l13338"></a>13338     }
<a name="l13339"></a>13339 <span class="comment"></span>
<a name="l13340"></a>13340 <span class="comment">    /**</span>
<a name="l13341"></a>13341 <span class="comment">     * Set footer font.</span>
<a name="l13342"></a>13342 <span class="comment">     * @param $font (array) font</span>
<a name="l13343"></a>13343 <span class="comment">     * @public</span>
<a name="l13344"></a>13344 <span class="comment">     * @since 1.1</span>
<a name="l13345"></a>13345 <span class="comment">     */</span>
<a name="l13346"></a><a class="code" href="classTCPDF.html#af1b0f1f3ec868528230e8b0293a23a4c">13346</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af1b0f1f3ec868528230e8b0293a23a4c" title="Set footer font.">setFooterFont</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>) {
<a name="l13347"></a>13347         $this-&gt;footer_font = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l13348"></a>13348     }
<a name="l13349"></a>13349 <span class="comment"></span>
<a name="l13350"></a>13350 <span class="comment">    /**</span>
<a name="l13351"></a>13351 <span class="comment">     * Get Footer font.</span>
<a name="l13352"></a>13352 <span class="comment">     * @return array()</span>
<a name="l13353"></a>13353 <span class="comment">     * @public</span>
<a name="l13354"></a>13354 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l13355"></a>13355 <span class="comment">     */</span>
<a name="l13356"></a><a class="code" href="classTCPDF.html#a3ff8e789876c7376f95a614c8e2a8a7d">13356</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3ff8e789876c7376f95a614c8e2a8a7d" title="Get Footer font.">getFooterFont</a>() {
<a name="l13357"></a>13357         <span class="keywordflow">return</span> $this-&gt;footer_font;
<a name="l13358"></a>13358     }
<a name="l13359"></a>13359 <span class="comment"></span>
<a name="l13360"></a>13360 <span class="comment">    /**</span>
<a name="l13361"></a>13361 <span class="comment">     * Set language array.</span>
<a name="l13362"></a>13362 <span class="comment">     * @param $language (array)</span>
<a name="l13363"></a>13363 <span class="comment">     * @public</span>
<a name="l13364"></a>13364 <span class="comment">     * @since 1.1</span>
<a name="l13365"></a>13365 <span class="comment">     */</span>
<a name="l13366"></a><a class="code" href="classTCPDF.html#a2a7cc18749cac51d0efca5d491d9217c">13366</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2a7cc18749cac51d0efca5d491d9217c" title="Set language array.">setLanguageArray</a>($language) {
<a name="l13367"></a>13367         $this-&gt;l = $language;
<a name="l13368"></a>13368         <span class="keywordflow">if</span> (isset($this-&gt;l[<span class="stringliteral">&#39;a_meta_dir&#39;</span>])) {
<a name="l13369"></a>13369             $this-&gt;rtl = $this-&gt;l[<span class="stringliteral">&#39;a_meta_dir&#39;</span>]==<span class="stringliteral">&#39;rtl&#39;</span> ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l13370"></a>13370         } <span class="keywordflow">else</span> {
<a name="l13371"></a>13371             $this-&gt;rtl = <span class="keyword">false</span>;
<a name="l13372"></a>13372         }
<a name="l13373"></a>13373     }
<a name="l13374"></a>13374 <span class="comment"></span>
<a name="l13375"></a>13375 <span class="comment">    /**</span>
<a name="l13376"></a>13376 <span class="comment">     * Returns the PDF data.</span>
<a name="l13377"></a>13377 <span class="comment">     * @public</span>
<a name="l13378"></a>13378 <span class="comment">     */</span>
<a name="l13379"></a><a class="code" href="classTCPDF.html#a1cff8ee966955eb911a71e2535735683">13379</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1cff8ee966955eb911a71e2535735683" title="Returns the PDF data.">getPDFData</a>() {
<a name="l13380"></a>13380         <span class="keywordflow">if</span> ($this-&gt;state &lt; 3) {
<a name="l13381"></a>13381             $this-&gt;Close();
<a name="l13382"></a>13382         }
<a name="l13383"></a>13383         <span class="keywordflow">return</span> $this-&gt;buffer;
<a name="l13384"></a>13384     }
<a name="l13385"></a>13385 <span class="comment"></span>
<a name="l13386"></a>13386 <span class="comment">    /**</span>
<a name="l13387"></a>13387 <span class="comment">     * Output anchor link.</span>
<a name="l13388"></a>13388 <span class="comment">     * @param $url (string) link URL or internal link (i.e.: &amp;lt;a href=&quot;#23,4.5&quot;&amp;gt;link to page 23 at 4.5 Y position&amp;lt;/a&amp;gt;)</span>
<a name="l13389"></a>13389 <span class="comment">     * @param $name (string) link name</span>
<a name="l13390"></a>13390 <span class="comment">     * @param $fill (boolean) Indicates if the cell background must be painted (true) or transparent (false).</span>
<a name="l13391"></a>13391 <span class="comment">     * @param $firstline (boolean) if true prints only the first line and return the remaining string.</span>
<a name="l13392"></a>13392 <span class="comment">     * @param $color (array) array of RGB text color</span>
<a name="l13393"></a>13393 <span class="comment">     * @param $style (string) font style (U, D, B, I)</span>
<a name="l13394"></a>13394 <span class="comment">     * @param $firstblock (boolean) if true the string is the starting of a line.</span>
<a name="l13395"></a>13395 <span class="comment">     * @return the number of cells used or the remaining text if $firstline = true;</span>
<a name="l13396"></a>13396 <span class="comment">     * @public</span>
<a name="l13397"></a>13397 <span class="comment">     */</span>
<a name="l13398"></a><a class="code" href="classTCPDF.html#af26dfbff2e1507f87a2fae64eebe08e1">13398</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af26dfbff2e1507f87a2fae64eebe08e1" title="Output anchor link.">addHtmlLink</a>(<a class="code" href="query_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $fill=<span class="keyword">false</span>, $firstline=<span class="keyword">false</span>, $color=<span class="stringliteral">&#39;&#39;</span>, $style=-1, $firstblock=<span class="keyword">false</span>) {
<a name="l13399"></a>13399         <span class="keywordflow">if</span> (!$this-&gt;empty_string(<a class="code" href="query_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a>) AND (<a class="code" href="query_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a>{0} == <span class="charliteral">&#39;#&#39;</span>)) {
<a name="l13400"></a>13400             <span class="comment">// convert url to internal link</span>
<a name="l13401"></a>13401             $lnkdata = explode(<span class="charliteral">&#39;,&#39;</span>, <a class="code" href="query_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a>);
<a name="l13402"></a>13402             <span class="keywordflow">if</span> (isset($lnkdata[0])) {
<a name="l13403"></a>13403                 <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = intval(substr($lnkdata[0], 1));
<a name="l13404"></a>13404                 <span class="keywordflow">if</span> (empty(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>) OR (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &lt;= 0)) {
<a name="l13405"></a>13405                     <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = $this-&gt;page;
<a name="l13406"></a>13406                 }
<a name="l13407"></a>13407                 <span class="keywordflow">if</span> (isset($lnkdata[1]) AND (strlen($lnkdata[1]) &gt; 0)) {
<a name="l13408"></a>13408                     $lnky = floatval($lnkdata[1]);
<a name="l13409"></a>13409                 } <span class="keywordflow">else</span> {
<a name="l13410"></a>13410                     $lnky = 0;
<a name="l13411"></a>13411                 }
<a name="l13412"></a>13412                 <a class="code" href="query_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a> = $this-&gt;AddLink();
<a name="l13413"></a>13413                 $this-&gt;SetLink(<a class="code" href="query_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a>, $lnky, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>);
<a name="l13414"></a>13414             }
<a name="l13415"></a>13415         }
<a name="l13416"></a>13416         <span class="comment">// store current settings</span>
<a name="l13417"></a>13417         $prevcolor = $this-&gt;fgcolor;
<a name="l13418"></a>13418         $prevstyle = $this-&gt;FontStyle;
<a name="l13419"></a>13419         <span class="keywordflow">if</span> (empty($color)) {
<a name="l13420"></a>13420             $this-&gt;SetTextColorArray($this-&gt;htmlLinkColorArray);
<a name="l13421"></a>13421         } <span class="keywordflow">else</span> {
<a name="l13422"></a>13422             $this-&gt;SetTextColorArray($color);
<a name="l13423"></a>13423         }
<a name="l13424"></a>13424         <span class="keywordflow">if</span> ($style == -1) {
<a name="l13425"></a>13425             $this-&gt;SetFont(<span class="stringliteral">&#39;&#39;</span>, $this-&gt;FontStyle.$this-&gt;htmlLinkFontStyle);
<a name="l13426"></a>13426         } <span class="keywordflow">else</span> {
<a name="l13427"></a>13427             $this-&gt;SetFont(<span class="stringliteral">&#39;&#39;</span>, $this-&gt;FontStyle.$style);
<a name="l13428"></a>13428         }
<a name="l13429"></a>13429         $ret = $this-&gt;Write($this-&gt;lasth, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="query_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a>, $fill, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 0, $firstline, $firstblock, 0);
<a name="l13430"></a>13430         <span class="comment">// restore settings</span>
<a name="l13431"></a>13431         $this-&gt;SetFont(<span class="stringliteral">&#39;&#39;</span>, $prevstyle);
<a name="l13432"></a>13432         $this-&gt;SetTextColorArray($prevcolor);
<a name="l13433"></a>13433         <span class="keywordflow">return</span> $ret;
<a name="l13434"></a>13434     }
<a name="l13435"></a>13435 <span class="comment"></span>
<a name="l13436"></a>13436 <span class="comment">    /**</span>
<a name="l13437"></a>13437 <span class="comment">     * Returns an array (RGB or CMYK) from an html color name, or a six-digit (i.e. #3FE5AA), or three-digit (i.e. #7FF) hexadecimal color, or a javascript color array, or javascript color name.</span>
<a name="l13438"></a>13438 <span class="comment">     * @param $hcolor (string) HTML color.</span>
<a name="l13439"></a>13439 <span class="comment">     * @param $defcol (array) Color to return in case of error.</span>
<a name="l13440"></a>13440 <span class="comment">     * @return array RGB or CMYK color, or false in case of error.</span>
<a name="l13441"></a>13441 <span class="comment">     * @public</span>
<a name="l13442"></a>13442 <span class="comment">     */</span>
<a name="l13443"></a><a class="code" href="classTCPDF.html#af47115f3a2de058ac8e2469c1939473d">13443</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af47115f3a2de058ac8e2469c1939473d" title="Returns an array (RGB or CMYK) from an html color name, or a six-digit (i.e.">convertHTMLColorToDec</a>($hcolor=<span class="stringliteral">&#39;#FFFFFF&#39;</span>, $defcol=array(<span class="charliteral">&#39;R&#39;</span>=&gt;128,<span class="charliteral">&#39;G&#39;</span>=&gt;128,<span class="charliteral">&#39;B&#39;</span>=&gt;128)) {
<a name="l13444"></a>13444         $color = preg_replace(<span class="stringliteral">&#39;/[\s]*/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $hcolor); <span class="comment">// remove extra spaces</span>
<a name="l13445"></a>13445         $color = strtolower($color);
<a name="l13446"></a>13446         <span class="comment">// check for javascript color array syntax</span>
<a name="l13447"></a>13447         <span class="keywordflow">if</span> (strpos($color, <span class="charliteral">&#39;[&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l13448"></a>13448             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\[][\&quot;\&#39;](t|g|rgb|cmyk)[\&quot;\&#39;][\,]?([0-9\.]*)[\,]?([0-9\.]*)[\,]?([0-9\.]*)[\,]?([0-9\.]*)[\]]/&#39;</span>, $color, <a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>) &gt; 0) {
<a name="l13449"></a>13449                 $returncolor = array();
<a name="l13450"></a>13450                 <span class="keywordflow">switch</span> (<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[1]) {
<a name="l13451"></a>13451                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;cmyk&#39;</span>: {
<a name="l13452"></a>13452                         <span class="comment">// RGB</span>
<a name="l13453"></a>13453                         $returncolor[<span class="charliteral">&#39;C&#39;</span>] = max(0, min(100, (floatval(<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[2]) * 100)));
<a name="l13454"></a>13454                         $returncolor[<span class="charliteral">&#39;M&#39;</span>] = max(0, min(100, (floatval(<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[3]) * 100)));
<a name="l13455"></a>13455                         $returncolor[<span class="charliteral">&#39;Y&#39;</span>] = max(0, min(100, (floatval(<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[4]) * 100)));
<a name="l13456"></a>13456                         $returncolor[<span class="charliteral">&#39;K&#39;</span>] = max(0, min(100, (floatval(<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[5]) * 100)));
<a name="l13457"></a>13457                         <span class="keywordflow">break</span>;
<a name="l13458"></a>13458                     }
<a name="l13459"></a>13459                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;rgb&#39;</span>: {
<a name="l13460"></a>13460                         <span class="comment">// RGB</span>
<a name="l13461"></a>13461                         $returncolor[<span class="charliteral">&#39;R&#39;</span>] = max(0, min(255, (floatval(<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[2]) * 255)));
<a name="l13462"></a>13462                         $returncolor[<span class="charliteral">&#39;G&#39;</span>] = max(0, min(255, (floatval(<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[3]) * 255)));
<a name="l13463"></a>13463                         $returncolor[<span class="charliteral">&#39;B&#39;</span>] = max(0, min(255, (floatval(<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[4]) * 255)));
<a name="l13464"></a>13464                         <span class="keywordflow">break</span>;
<a name="l13465"></a>13465                     }
<a name="l13466"></a>13466                     <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>: {
<a name="l13467"></a>13467                         <span class="comment">// grayscale</span>
<a name="l13468"></a>13468                         $returncolor[<span class="charliteral">&#39;G&#39;</span>] = max(0, min(255, (floatval(<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[2]) * 255)));
<a name="l13469"></a>13469                         <span class="keywordflow">break</span>;
<a name="l13470"></a>13470                     }
<a name="l13471"></a>13471                     <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:
<a name="l13472"></a>13472                     <span class="keywordflow">default</span>: {
<a name="l13473"></a>13473                         <span class="comment">// transparent (empty array)</span>
<a name="l13474"></a>13474                         <span class="keywordflow">break</span>;
<a name="l13475"></a>13475                     }
<a name="l13476"></a>13476                 }
<a name="l13477"></a>13477                 <span class="keywordflow">return</span> $returncolor;
<a name="l13478"></a>13478             }
<a name="l13479"></a>13479         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($dotpos = strpos($color, <span class="charliteral">&#39;.&#39;</span>)) !== <span class="keyword">false</span>) {
<a name="l13480"></a>13480             <span class="comment">// remove class parent (i.e.: color.red)</span>
<a name="l13481"></a>13481             $color = substr($color, ($dotpos + 1));
<a name="l13482"></a>13482             <span class="keywordflow">if</span> ($color == <span class="stringliteral">&#39;transparent&#39;</span>) {
<a name="l13483"></a>13483                 <span class="comment">// transparent (empty array)</span>
<a name="l13484"></a>13484                 <span class="keywordflow">return</span> array();
<a name="l13485"></a>13485             }
<a name="l13486"></a>13486         }
<a name="l13487"></a>13487         <span class="keywordflow">if</span> (strlen($color) == 0) {
<a name="l13488"></a>13488             <span class="keywordflow">return</span> $defcol;
<a name="l13489"></a>13489         }
<a name="l13490"></a>13490         <span class="comment">// RGB ARRAY</span>
<a name="l13491"></a>13491         <span class="keywordflow">if</span> (substr($color, 0, 3) == <span class="stringliteral">&#39;rgb&#39;</span>) {
<a name="l13492"></a>13492             $codes = substr($color, 4);
<a name="l13493"></a>13493             $codes = str_replace(<span class="charliteral">&#39;)&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $codes);
<a name="l13494"></a>13494             $returncolor = explode(<span class="charliteral">&#39;,&#39;</span>, $codes);
<a name="l13495"></a>13495             <span class="keywordflow">foreach</span> ($returncolor as $key =&gt; $val) {
<a name="l13496"></a>13496                 <span class="keywordflow">if</span> (strpos($val, <span class="charliteral">&#39;%&#39;</span>) &gt; 0) {
<a name="l13497"></a>13497                     <span class="comment">// percentage</span>
<a name="l13498"></a>13498                     $returncolor[$key] = (255 * intval($val) / 100);
<a name="l13499"></a>13499                 } <span class="keywordflow">else</span> {
<a name="l13500"></a>13500                     $returncolor[$key] = intval($val);
<a name="l13501"></a>13501                 }
<a name="l13502"></a>13502                 <span class="comment">// normalize value</span>
<a name="l13503"></a>13503                 $returncolor[$key] = max(0, min(255, $returncolor[$key]));
<a name="l13504"></a>13504             }
<a name="l13505"></a>13505             <span class="keywordflow">return</span> $returncolor;
<a name="l13506"></a>13506         }
<a name="l13507"></a>13507         <span class="comment">// CMYK ARRAY</span>
<a name="l13508"></a>13508         <span class="keywordflow">if</span> (substr($color, 0, 4) == <span class="stringliteral">&#39;cmyk&#39;</span>) {
<a name="l13509"></a>13509             $codes = substr($color, 5);
<a name="l13510"></a>13510             $codes = str_replace(<span class="charliteral">&#39;)&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $codes);
<a name="l13511"></a>13511             $returncolor = explode(<span class="charliteral">&#39;,&#39;</span>, $codes);
<a name="l13512"></a>13512             <span class="keywordflow">foreach</span> ($returncolor as $key =&gt; $val) {
<a name="l13513"></a>13513                 <span class="keywordflow">if</span> (strpos($val, <span class="charliteral">&#39;%&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l13514"></a>13514                     <span class="comment">// percentage</span>
<a name="l13515"></a>13515                     $returncolor[$key] = (100 * intval($val) / 100);
<a name="l13516"></a>13516                 } <span class="keywordflow">else</span> {
<a name="l13517"></a>13517                     $returncolor[$key] = intval($val);
<a name="l13518"></a>13518                 }
<a name="l13519"></a>13519                 <span class="comment">// normalize value</span>
<a name="l13520"></a>13520                 $returncolor[$key] = max(0, min(100, $returncolor[$key]));
<a name="l13521"></a>13521             }
<a name="l13522"></a>13522             <span class="keywordflow">return</span> $returncolor;
<a name="l13523"></a>13523         }
<a name="l13524"></a>13524         <span class="keywordflow">if</span> ($color{0} != <span class="charliteral">&#39;#&#39;</span>) {
<a name="l13525"></a>13525             <span class="comment">// COLOR NAME</span>
<a name="l13526"></a>13526             <span class="keywordflow">if</span> (isset($this-&gt;webcolor[$color])) {
<a name="l13527"></a>13527                 <span class="comment">// web color</span>
<a name="l13528"></a>13528                 $color_code = $this-&gt;webcolor[$color];
<a name="l13529"></a>13529             } <span class="keywordflow">else</span> {
<a name="l13530"></a>13530                 <span class="comment">// spot color</span>
<a name="l13531"></a>13531                 $returncolor = $this-&gt;getSpotColor($color);
<a name="l13532"></a>13532                 <span class="keywordflow">if</span> ($returncolor === <span class="keyword">false</span>) {
<a name="l13533"></a>13533                     $returncolor = $defcol;
<a name="l13534"></a>13534                 }
<a name="l13535"></a>13535                 <span class="keywordflow">return</span> $returncolor;
<a name="l13536"></a>13536             }
<a name="l13537"></a>13537         } <span class="keywordflow">else</span> {
<a name="l13538"></a>13538             $color_code = substr($color, 1);
<a name="l13539"></a>13539         }
<a name="l13540"></a>13540         <span class="comment">// HEXADECIMAL REPRESENTATION</span>
<a name="l13541"></a>13541         <span class="keywordflow">switch</span> (strlen($color_code)) {
<a name="l13542"></a>13542             <span class="keywordflow">case</span> 3: {
<a name="l13543"></a>13543                 <span class="comment">// 3-digit RGB hexadecimal representation</span>
<a name="l13544"></a>13544                 <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = substr($color_code, 0, 1);
<a name="l13545"></a>13545                 $g = substr($color_code, 1, 1);
<a name="l13546"></a>13546                 $b = substr($color_code, 2, 1);
<a name="l13547"></a>13547                 $returncolor = array();
<a name="l13548"></a>13548                 $returncolor[<span class="charliteral">&#39;R&#39;</span>] = max(0, min(255, hexdec(<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>.$r)));
<a name="l13549"></a>13549                 $returncolor[<span class="charliteral">&#39;G&#39;</span>] = max(0, min(255, hexdec($g.$g)));
<a name="l13550"></a>13550                 $returncolor[<span class="charliteral">&#39;B&#39;</span>] = max(0, min(255, hexdec($b.$b)));
<a name="l13551"></a>13551                 <span class="keywordflow">break</span>;
<a name="l13552"></a>13552             }
<a name="l13553"></a>13553             <span class="keywordflow">case</span> 6: {
<a name="l13554"></a>13554                 <span class="comment">// 6-digit RGB hexadecimal representation</span>
<a name="l13555"></a>13555                 $returncolor = array();
<a name="l13556"></a>13556                 $returncolor[<span class="charliteral">&#39;R&#39;</span>] = max(0, min(255, hexdec(substr($color_code, 0, 2))));
<a name="l13557"></a>13557                 $returncolor[<span class="charliteral">&#39;G&#39;</span>] = max(0, min(255, hexdec(substr($color_code, 2, 2))));
<a name="l13558"></a>13558                 $returncolor[<span class="charliteral">&#39;B&#39;</span>] = max(0, min(255, hexdec(substr($color_code, 4, 2))));
<a name="l13559"></a>13559                 <span class="keywordflow">break</span>;
<a name="l13560"></a>13560             }
<a name="l13561"></a>13561             <span class="keywordflow">case</span> 8: {
<a name="l13562"></a>13562                 <span class="comment">// 8-digit CMYK hexadecimal representation</span>
<a name="l13563"></a>13563                 $returncolor = array();
<a name="l13564"></a>13564                 $returncolor[<span class="charliteral">&#39;C&#39;</span>] = max(0, min(100, round(hexdec(substr($color_code, 0, 2)) / 2.55)));
<a name="l13565"></a>13565                 $returncolor[<span class="charliteral">&#39;M&#39;</span>] = max(0, min(100, round(hexdec(substr($color_code, 2, 2)) / 2.55)));
<a name="l13566"></a>13566                 $returncolor[<span class="charliteral">&#39;Y&#39;</span>] = max(0, min(100, round(hexdec(substr($color_code, 4, 2)) / 2.55)));
<a name="l13567"></a>13567                 $returncolor[<span class="charliteral">&#39;K&#39;</span>] = max(0, min(100, round(hexdec(substr($color_code, 6, 2)) / 2.55)));
<a name="l13568"></a>13568                 <span class="keywordflow">break</span>;
<a name="l13569"></a>13569             }
<a name="l13570"></a>13570             <span class="keywordflow">default</span>: {
<a name="l13571"></a>13571                 $returncolor = $defcol;
<a name="l13572"></a>13572                 <span class="keywordflow">break</span>;
<a name="l13573"></a>13573             }
<a name="l13574"></a>13574         }
<a name="l13575"></a>13575         <span class="keywordflow">return</span> $returncolor;
<a name="l13576"></a>13576     }
<a name="l13577"></a>13577 <span class="comment"></span>
<a name="l13578"></a>13578 <span class="comment">    /**</span>
<a name="l13579"></a>13579 <span class="comment">     * Converts pixels to User&#39;s Units.</span>
<a name="l13580"></a>13580 <span class="comment">     * @param $px (int) pixels</span>
<a name="l13581"></a>13581 <span class="comment">     * @return float value in user&#39;s unit</span>
<a name="l13582"></a>13582 <span class="comment">     * @public</span>
<a name="l13583"></a>13583 <span class="comment">     * @see setImageScale(), getImageScale()</span>
<a name="l13584"></a>13584 <span class="comment">     */</span>
<a name="l13585"></a><a class="code" href="classTCPDF.html#a9a0a09e2334f92e7a54cf1f550c3f921">13585</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9a0a09e2334f92e7a54cf1f550c3f921" title="Converts pixels to User&#39;s Units.">pixelsToUnits</a>($px) {
<a name="l13586"></a>13586         <span class="keywordflow">return</span> ($px / ($this-&gt;imgscale * $this-&gt;k));
<a name="l13587"></a>13587     }
<a name="l13588"></a>13588 <span class="comment"></span>
<a name="l13589"></a>13589 <span class="comment">    /**</span>
<a name="l13590"></a>13590 <span class="comment">     * Reverse function for htmlentities.</span>
<a name="l13591"></a>13591 <span class="comment">     * Convert entities in UTF-8.</span>
<a name="l13592"></a>13592 <span class="comment">     * @param $text_to_convert (string) Text to convert.</span>
<a name="l13593"></a>13593 <span class="comment">     * @return string converted text string</span>
<a name="l13594"></a>13594 <span class="comment">     * @public</span>
<a name="l13595"></a>13595 <span class="comment">     */</span>
<a name="l13596"></a><a class="code" href="classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320">13596</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320" title="Reverse function for htmlentities.">unhtmlentities</a>($text_to_convert) {
<a name="l13597"></a>13597         <span class="keywordflow">return</span> @html_entity_decode($text_to_convert, ENT_QUOTES, $this-&gt;encoding);
<a name="l13598"></a>13598     }
<a name="l13599"></a>13599 
<a name="l13600"></a>13600     <span class="comment">// ENCRYPTION METHODS ----------------------------------</span>
<a name="l13601"></a>13601 <span class="comment"></span>
<a name="l13602"></a>13602 <span class="comment">    /**</span>
<a name="l13603"></a>13603 <span class="comment">     * Returns a string containing random data to be used as a seed for encryption methods.</span>
<a name="l13604"></a>13604 <span class="comment">     * @param $seed (string) starting seed value</span>
<a name="l13605"></a>13605 <span class="comment">     * @return string containing random data</span>
<a name="l13606"></a>13606 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13607"></a>13607 <span class="comment">     * @since 5.9.006 (2010-10-19)</span>
<a name="l13608"></a>13608 <span class="comment">     * @protected</span>
<a name="l13609"></a>13609 <span class="comment">     */</span>
<a name="l13610"></a><a class="code" href="classTCPDF.html#a398d3a1334b3e91e65f6464f4de91a64">13610</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a398d3a1334b3e91e65f6464f4de91a64" title="Returns a string containing random data to be used as a seed for encryption methods.">getRandomSeed</a>($seed=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l13611"></a>13611         $seed .= microtime();
<a name="l13612"></a>13612         <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;openssl_random_pseudo_bytes&#39;</span>) AND (strtoupper(substr(PHP_OS, 0, 3)) !== <span class="stringliteral">&#39;WIN&#39;</span>)) {
<a name="l13613"></a>13613             <span class="comment">// this is not used on windows systems because it is very slow for a know bug</span>
<a name="l13614"></a>13614             $seed .= openssl_random_pseudo_bytes(512);
<a name="l13615"></a>13615         } <span class="keywordflow">else</span> {
<a name="l13616"></a>13616             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 23; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l13617"></a>13617                 $seed .= uniqid(<span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>);
<a name="l13618"></a>13618             }
<a name="l13619"></a>13619         }
<a name="l13620"></a>13620         $seed .= uniqid(<span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>);
<a name="l13621"></a>13621         $seed .= rand();
<a name="l13622"></a>13622         $seed .= getmypid();
<a name="l13623"></a>13623         $seed .= __FILE__;
<a name="l13624"></a>13624         $seed .= $this-&gt;bufferlen;
<a name="l13625"></a>13625         <span class="keywordflow">if</span> (isset($_SERVER[<span class="stringliteral">&#39;REMOTE_ADDR&#39;</span>])) {
<a name="l13626"></a>13626             $seed .= $_SERVER[<span class="stringliteral">&#39;REMOTE_ADDR&#39;</span>];
<a name="l13627"></a>13627         }
<a name="l13628"></a>13628         <span class="keywordflow">if</span> (isset($_SERVER[<span class="stringliteral">&#39;HTTP_USER_AGENT&#39;</span>])) {
<a name="l13629"></a>13629             $seed .= $_SERVER[<span class="stringliteral">&#39;HTTP_USER_AGENT&#39;</span>];
<a name="l13630"></a>13630         }
<a name="l13631"></a>13631         <span class="keywordflow">if</span> (isset($_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT&#39;</span>])) {
<a name="l13632"></a>13632             $seed .= $_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT&#39;</span>];
<a name="l13633"></a>13633         }
<a name="l13634"></a>13634         <span class="keywordflow">if</span> (isset($_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT_ENCODING&#39;</span>])) {
<a name="l13635"></a>13635             $seed .= $_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT_ENCODING&#39;</span>];
<a name="l13636"></a>13636         }
<a name="l13637"></a>13637         <span class="keywordflow">if</span> (isset($_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT_LANGUAGE&#39;</span>])) {
<a name="l13638"></a>13638             $seed .= $_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT_LANGUAGE&#39;</span>];
<a name="l13639"></a>13639         }
<a name="l13640"></a>13640         <span class="keywordflow">if</span> (isset($_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT_CHARSET&#39;</span>])) {
<a name="l13641"></a>13641             $seed .= $_SERVER[<span class="stringliteral">&#39;HTTP_ACCEPT_CHARSET&#39;</span>];
<a name="l13642"></a>13642         }
<a name="l13643"></a>13643         $seed .= rand();
<a name="l13644"></a>13644         $seed .= uniqid(<span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>);
<a name="l13645"></a>13645         $seed .= microtime();
<a name="l13646"></a>13646         <span class="keywordflow">return</span> $seed;
<a name="l13647"></a>13647     }
<a name="l13648"></a>13648 <span class="comment"></span>
<a name="l13649"></a>13649 <span class="comment">    /**</span>
<a name="l13650"></a>13650 <span class="comment">     * Compute encryption key depending on object number where the encrypted data is stored.</span>
<a name="l13651"></a>13651 <span class="comment">     * This is used for all strings and streams without crypt filter specifier.</span>
<a name="l13652"></a>13652 <span class="comment">     * @param $n (int) object number</span>
<a name="l13653"></a>13653 <span class="comment">     * @return int object key</span>
<a name="l13654"></a>13654 <span class="comment">     * @protected</span>
<a name="l13655"></a>13655 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13656"></a>13656 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l13657"></a>13657 <span class="comment">     */</span>
<a name="l13658"></a><a class="code" href="classTCPDF.html#a8637af5bc22147a813797a4fbda3dba2">13658</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8637af5bc22147a813797a4fbda3dba2" title="Compute encryption key depending on object number where the encrypted data is stored.">_objectkey</a>($n) {
<a name="l13659"></a>13659         $objkey = $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>].pack(<span class="stringliteral">&#39;VXxx&#39;</span>, $n);
<a name="l13660"></a>13660         <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 2) { <span class="comment">// AES-128</span>
<a name="l13661"></a>13661             <span class="comment">// AES padding</span>
<a name="l13662"></a>13662             $objkey .= <span class="stringliteral">&quot;\x73\x41\x6C\x54&quot;</span>; <span class="comment">// sAlT</span>
<a name="l13663"></a>13663         }
<a name="l13664"></a>13664         $objkey = substr($this-&gt;_md5_16($objkey), 0, (($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] / 8) + 5));
<a name="l13665"></a>13665         $objkey = substr($objkey, 0, 16);
<a name="l13666"></a>13666         <span class="keywordflow">return</span> $objkey;
<a name="l13667"></a>13667     }
<a name="l13668"></a>13668 <span class="comment"></span>
<a name="l13669"></a>13669 <span class="comment">    /**</span>
<a name="l13670"></a>13670 <span class="comment">     * Encrypt the input string.</span>
<a name="l13671"></a>13671 <span class="comment">     * @param $n (int) object number</span>
<a name="l13672"></a>13672 <span class="comment">     * @param $s (string) data string to encrypt</span>
<a name="l13673"></a>13673 <span class="comment">     * @return encrypted string</span>
<a name="l13674"></a>13674 <span class="comment">     * @protected</span>
<a name="l13675"></a>13675 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13676"></a>13676 <span class="comment">     * @since 5.0.005 (2010-05-11)</span>
<a name="l13677"></a>13677 <span class="comment">     */</span>
<a name="l13678"></a><a class="code" href="classTCPDF.html#aa152b05eedf7152d8163ab4f5083de1c">13678</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa152b05eedf7152d8163ab4f5083de1c" title="Encrypt the input string.">_encrypt_data</a>($n, <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>) {
<a name="l13679"></a>13679         <span class="keywordflow">if</span> (!$this-&gt;encrypted) {
<a name="l13680"></a>13680             <span class="keywordflow">return</span> <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>;
<a name="l13681"></a>13681         }
<a name="l13682"></a>13682         <span class="keywordflow">switch</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>]) {
<a name="l13683"></a>13683             <span class="keywordflow">case</span> 0:   <span class="comment">// RC4-40</span>
<a name="l13684"></a>13684             <span class="keywordflow">case</span> 1: { <span class="comment">// RC4-128</span>
<a name="l13685"></a>13685                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = $this-&gt;_RC4($this-&gt;_objectkey($n), <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l13686"></a>13686                 <span class="keywordflow">break</span>;
<a name="l13687"></a>13687             }
<a name="l13688"></a>13688             <span class="keywordflow">case</span> 2: { <span class="comment">// AES-128</span>
<a name="l13689"></a>13689                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = $this-&gt;_AES($this-&gt;_objectkey($n), <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l13690"></a>13690                 <span class="keywordflow">break</span>;
<a name="l13691"></a>13691             }
<a name="l13692"></a>13692             <span class="keywordflow">case</span> 3: { <span class="comment">// AES-256</span>
<a name="l13693"></a>13693                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = $this-&gt;_AES($this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l13694"></a>13694                 <span class="keywordflow">break</span>;
<a name="l13695"></a>13695             }
<a name="l13696"></a>13696         }
<a name="l13697"></a>13697         <span class="keywordflow">return</span> <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>;
<a name="l13698"></a>13698     }
<a name="l13699"></a>13699 <span class="comment"></span>
<a name="l13700"></a>13700 <span class="comment">    /**</span>
<a name="l13701"></a>13701 <span class="comment">     * Put encryption on PDF document.</span>
<a name="l13702"></a>13702 <span class="comment">     * @protected</span>
<a name="l13703"></a>13703 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13704"></a>13704 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l13705"></a>13705 <span class="comment">     */</span>
<a name="l13706"></a><a class="code" href="classTCPDF.html#ab5ed9ad2bde4d072fbd2facb96599e95">13706</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab5ed9ad2bde4d072fbd2facb96599e95" title="Put encryption on PDF document.">_putencryption</a>() {
<a name="l13707"></a>13707         <span class="keywordflow">if</span> (!$this-&gt;encrypted) {
<a name="l13708"></a>13708             <span class="keywordflow">return</span>;
<a name="l13709"></a>13709         }
<a name="l13710"></a>13710         $this-&gt;encryptdata[<span class="stringliteral">&#39;objid&#39;</span>] = $this-&gt;_newobj();
<a name="l13711"></a>13711         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l13712"></a>13712         <span class="keywordflow">if</span> (!isset($this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>]) OR empty($this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>])) {
<a name="l13713"></a>13713             $this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>] = <span class="stringliteral">&#39;Standard&#39;</span>;
<a name="l13714"></a>13714         }
<a name="l13715"></a>13715         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Filter /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>];
<a name="l13716"></a>13716         <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>])) {
<a name="l13717"></a>13717             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /SubFilter /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>];
<a name="l13718"></a>13718         }
<a name="l13719"></a>13719         <span class="keywordflow">if</span> (!isset($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>]) OR empty($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>])) {
<a name="l13720"></a>13720             $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 1;
<a name="l13721"></a>13721         }
<a name="l13722"></a>13722         <span class="comment">// V is a code specifying the algorithm to be used in encrypting and decrypting the document</span>
<a name="l13723"></a>13723         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /V &#39;</span>.$this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>];
<a name="l13724"></a>13724         <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>])) {
<a name="l13725"></a>13725             <span class="comment">// The length of the encryption key, in bits. The value shall be a multiple of 8, in the range 40 to 256</span>
<a name="l13726"></a>13726             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length &#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>];
<a name="l13727"></a>13727         } <span class="keywordflow">else</span> {
<a name="l13728"></a>13728             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length 40&#39;</span>;
<a name="l13729"></a>13729         }
<a name="l13730"></a>13730         <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] &gt;= 4) {
<a name="l13731"></a>13731             <span class="keywordflow">if</span> (!isset($this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>]) OR empty($this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>])) {
<a name="l13732"></a>13732                 $this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>] = <span class="stringliteral">&#39;Identity&#39;</span>;
<a name="l13733"></a>13733             }
<a name="l13734"></a>13734             <span class="keywordflow">if</span> (!isset($this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>]) OR empty($this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>])) {
<a name="l13735"></a>13735                 <span class="comment">// The name of the crypt filter that shall be used when decrypting all strings in the document.</span>
<a name="l13736"></a>13736                 $this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>] = <span class="stringliteral">&#39;Identity&#39;</span>;
<a name="l13737"></a>13737             }
<a name="l13738"></a>13738             <span class="comment">// A dictionary whose keys shall be crypt filter names and whose values shall be the corresponding crypt filter dictionaries.</span>
<a name="l13739"></a>13739             <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>])) {
<a name="l13740"></a>13740                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CF &lt;&lt;&#39;</span>;
<a name="l13741"></a>13741                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>].<span class="stringliteral">&#39; &lt;&lt;&#39;</span>;
<a name="l13742"></a>13742                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Type /CryptFilter&#39;</span>;
<a name="l13743"></a>13743                 <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>])) {
<a name="l13744"></a>13744                     <span class="comment">// The method used</span>
<a name="l13745"></a>13745                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CFM /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>];
<a name="l13746"></a>13746                     <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {
<a name="l13747"></a>13747                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Recipients [&#39;</span>;
<a name="l13748"></a>13748                         <span class="keywordflow">foreach</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] as $rec) {
<a name="l13749"></a>13749                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &lt;&#39;</span>.$rec.<span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l13750"></a>13750                         }
<a name="l13751"></a>13751                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; ]&#39;</span>;
<a name="l13752"></a>13752                         <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;EncryptMetadata&#39;</span>]) AND (!$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;EncryptMetadata&#39;</span>])) {
<a name="l13753"></a>13753                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /EncryptMetadata false&#39;</span>;
<a name="l13754"></a>13754                         } <span class="keywordflow">else</span> {
<a name="l13755"></a>13755                             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /EncryptMetadata true&#39;</span>;
<a name="l13756"></a>13756                         }
<a name="l13757"></a>13757                     }
<a name="l13758"></a>13758                 } <span class="keywordflow">else</span> {
<a name="l13759"></a>13759                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /CFM /None&#39;</span>;
<a name="l13760"></a>13760                 }
<a name="l13761"></a>13761                 <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;AuthEvent&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;AuthEvent&#39;</span>])) {
<a name="l13762"></a>13762                     <span class="comment">// The event to be used to trigger the authorization that is required to access encryption keys used by this filter.</span>
<a name="l13763"></a>13763                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /AuthEvent /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;AuthEvent&#39;</span>];
<a name="l13764"></a>13764                 } <span class="keywordflow">else</span> {
<a name="l13765"></a>13765                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /AuthEvent /DocOpen&#39;</span>;
<a name="l13766"></a>13766                 }
<a name="l13767"></a>13767                 <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>])) {
<a name="l13768"></a>13768                     <span class="comment">// The bit length of the encryption key.</span>
<a name="l13769"></a>13769                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length &#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>];
<a name="l13770"></a>13770                 }
<a name="l13771"></a>13771                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt; &gt;&gt;&#39;</span>;
<a name="l13772"></a>13772             }
<a name="l13773"></a>13773             <span class="comment">// The name of the crypt filter that shall be used by default when decrypting streams.</span>
<a name="l13774"></a>13774             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /StmF /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>];
<a name="l13775"></a>13775             <span class="comment">// The name of the crypt filter that shall be used when decrypting all strings in the document.</span>
<a name="l13776"></a>13776             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /StrF /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>];
<a name="l13777"></a>13777             <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;EFF&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;EFF&#39;</span>])) {
<a name="l13778"></a>13778                 <span class="comment">// The name of the crypt filter that shall be used when encrypting embedded file streams that do not have their own crypt filter specifier.</span>
<a name="l13779"></a>13779                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /EFF /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;&#39;</span>];
<a name="l13780"></a>13780             }
<a name="l13781"></a>13781         }
<a name="l13782"></a>13782         <span class="comment">// Additional encryption dictionary entries for the standard security handler</span>
<a name="l13783"></a>13783         <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {
<a name="l13784"></a>13784             <span class="keywordflow">if</span> (($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] &lt; 4) AND isset($this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>])) {
<a name="l13785"></a>13785                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Recipients [&#39;</span>;
<a name="l13786"></a>13786                 <span class="keywordflow">foreach</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] as $rec) {
<a name="l13787"></a>13787                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &lt;&#39;</span>.$rec.<span class="charliteral">&#39;&gt;&#39;</span>;
<a name="l13788"></a>13788                 }
<a name="l13789"></a>13789                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; ]&#39;</span>;
<a name="l13790"></a>13790             }
<a name="l13791"></a>13791         } <span class="keywordflow">else</span> {
<a name="l13792"></a>13792             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /R&#39;</span>;
<a name="l13793"></a>13793             <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] == 5) { <span class="comment">// AES-256</span>
<a name="l13794"></a>13794                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; 5&#39;</span>;
<a name="l13795"></a>13795                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /OE (&#39;</span>.$this-&gt;_escape($this-&gt;encryptdata[<span class="stringliteral">&#39;OE&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;
<a name="l13796"></a>13796                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /UE (&#39;</span>.$this-&gt;_escape($this-&gt;encryptdata[<span class="stringliteral">&#39;UE&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;
<a name="l13797"></a>13797                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Perms (&#39;</span>.$this-&gt;_escape($this-&gt;encryptdata[<span class="stringliteral">&#39;perms&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;
<a name="l13798"></a>13798             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] == 4) { <span class="comment">// AES-128</span>
<a name="l13799"></a>13799                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; 4&#39;</span>;
<a name="l13800"></a>13800             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] &lt; 2) { <span class="comment">// RC-40</span>
<a name="l13801"></a>13801                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; 2&#39;</span>;
<a name="l13802"></a>13802             } <span class="keywordflow">else</span> { <span class="comment">// RC-128</span>
<a name="l13803"></a>13803                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; 3&#39;</span>;
<a name="l13804"></a>13804             }
<a name="l13805"></a>13805             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /O (&#39;</span>.$this-&gt;_escape($this-&gt;encryptdata[<span class="charliteral">&#39;O&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;
<a name="l13806"></a>13806             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /U (&#39;</span>.$this-&gt;_escape($this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;
<a name="l13807"></a>13807             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /P &#39;</span>.$this-&gt;encryptdata[<span class="charliteral">&#39;P&#39;</span>];
<a name="l13808"></a>13808             <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;EncryptMetadata&#39;</span>]) AND (!$this-&gt;encryptdata[<span class="stringliteral">&#39;EncryptMetadata&#39;</span>])) {
<a name="l13809"></a>13809                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /EncryptMetadata false&#39;</span>;
<a name="l13810"></a>13810             } <span class="keywordflow">else</span> {
<a name="l13811"></a>13811                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /EncryptMetadata true&#39;</span>;
<a name="l13812"></a>13812             }
<a name="l13813"></a>13813         }
<a name="l13814"></a>13814         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l13815"></a>13815         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l13816"></a>13816         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l13817"></a>13817     }
<a name="l13818"></a>13818 <span class="comment"></span>
<a name="l13819"></a>13819 <span class="comment">    /**</span>
<a name="l13820"></a>13820 <span class="comment">     * Returns the input text encrypted using RC4 algorithm and the specified key.</span>
<a name="l13821"></a>13821 <span class="comment">     * RC4 is the standard encryption algorithm used in PDF format</span>
<a name="l13822"></a>13822 <span class="comment">     * @param $key (string) encryption key</span>
<a name="l13823"></a>13823 <span class="comment">     * @param $text (String) input text to be encrypted</span>
<a name="l13824"></a>13824 <span class="comment">     * @return String encrypted text</span>
<a name="l13825"></a>13825 <span class="comment">     * @protected</span>
<a name="l13826"></a>13826 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l13827"></a>13827 <span class="comment">     * @author Klemen Vodopivec, Nicola Asuni</span>
<a name="l13828"></a>13828 <span class="comment">     */</span>
<a name="l13829"></a><a class="code" href="classTCPDF.html#a7f6cf35e3c138048eea58d3fb1fbb8c7">13829</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7f6cf35e3c138048eea58d3fb1fbb8c7" title="Returns the input text encrypted using RC4 algorithm and the specified key.">_RC4</a>($key, <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>) {
<a name="l13830"></a>13830         <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;mcrypt_decrypt&#39;</span>) AND (<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = @mcrypt_decrypt(MCRYPT_ARCFOUR, $key, <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>, MCRYPT_MODE_STREAM, <span class="stringliteral">&#39;&#39;</span>))) {
<a name="l13831"></a>13831             <span class="comment">// try to use mcrypt function if exist</span>
<a name="l13832"></a>13832             <span class="keywordflow">return</span> <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>;
<a name="l13833"></a>13833         }
<a name="l13834"></a>13834         <span class="keywordflow">if</span> ($this-&gt;last_enc_key != $key) {
<a name="l13835"></a>13835             $k = str_repeat($key, ((256 / strlen($key)) + 1));
<a name="l13836"></a>13836             $rc4 = range(0, 255);
<a name="l13837"></a>13837             $j = 0;
<a name="l13838"></a>13838             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 256; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l13839"></a>13839                 $t = $rc4[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l13840"></a>13840                 $j = ($j + $t + ord($k[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>])) % 256;
<a name="l13841"></a>13841                 $rc4[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $rc4[$j];
<a name="l13842"></a>13842                 $rc4[$j] = $t;
<a name="l13843"></a>13843             }
<a name="l13844"></a>13844             $this-&gt;last_enc_key = $key;
<a name="l13845"></a>13845             $this-&gt;last_enc_key_c = $rc4;
<a name="l13846"></a>13846         } <span class="keywordflow">else</span> {
<a name="l13847"></a>13847             $rc4 = $this-&gt;last_enc_key_c;
<a name="l13848"></a>13848         }
<a name="l13849"></a>13849         <a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a> = strlen(<a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>);
<a name="l13850"></a>13850         $a = 0;
<a name="l13851"></a>13851         $b = 0;
<a name="l13852"></a>13852         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l13853"></a>13853         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; <a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a>; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l13854"></a>13854             $a = ($a + 1) % 256;
<a name="l13855"></a>13855             $t = $rc4[$a];
<a name="l13856"></a>13856             $b = ($b + $t) % 256;
<a name="l13857"></a>13857             $rc4[$a] = $rc4[$b];
<a name="l13858"></a>13858             $rc4[$b] = $t;
<a name="l13859"></a>13859             $k = $rc4[($rc4[$a] + $rc4[$b]) % 256];
<a name="l13860"></a>13860             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= chr(ord(<a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) ^ $k);
<a name="l13861"></a>13861         }
<a name="l13862"></a>13862         <span class="keywordflow">return</span> <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>;
<a name="l13863"></a>13863     }
<a name="l13864"></a>13864 <span class="comment"></span>
<a name="l13865"></a>13865 <span class="comment">    /**</span>
<a name="l13866"></a>13866 <span class="comment">     * Returns the input text exrypted using AES algorithm and the specified key.</span>
<a name="l13867"></a>13867 <span class="comment">     * This method requires mcrypt.</span>
<a name="l13868"></a>13868 <span class="comment">     * @param $key (string) encryption key</span>
<a name="l13869"></a>13869 <span class="comment">     * @param $text (String) input text to be encrypted</span>
<a name="l13870"></a>13870 <span class="comment">     * @return String encrypted text</span>
<a name="l13871"></a>13871 <span class="comment">     * @protected</span>
<a name="l13872"></a>13872 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13873"></a>13873 <span class="comment">     * @since 5.0.005 (2010-05-11)</span>
<a name="l13874"></a>13874 <span class="comment">     */</span>
<a name="l13875"></a><a class="code" href="classTCPDF.html#a632e868215f20f6dad1170ef83dfbf08">13875</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a632e868215f20f6dad1170ef83dfbf08" title="Returns the input text exrypted using AES algorithm and the specified key.">_AES</a>($key, <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>) {
<a name="l13876"></a>13876         <span class="comment">// padding (RFC 2898, PKCS #5: Password-Based Cryptography Specification Version 2.0)</span>
<a name="l13877"></a>13877         $padding = 16 - (strlen(<a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>) % 16);
<a name="l13878"></a>13878         <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a> .= str_repeat(chr($padding), $padding);
<a name="l13879"></a>13879         $iv = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), MCRYPT_RAND);
<a name="l13880"></a>13880         <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a> = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>, MCRYPT_MODE_CBC, $iv);
<a name="l13881"></a>13881         <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a> = $iv.$text;
<a name="l13882"></a>13882         <span class="keywordflow">return</span> <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>;
<a name="l13883"></a>13883     }
<a name="l13884"></a>13884 <span class="comment"></span>
<a name="l13885"></a>13885 <span class="comment">    /**</span>
<a name="l13886"></a>13886 <span class="comment">     * Encrypts a string using MD5 and returns it&#39;s value as a binary string.</span>
<a name="l13887"></a>13887 <span class="comment">     * @param $str (string) input string</span>
<a name="l13888"></a>13888 <span class="comment">     * @return String MD5 encrypted binary string</span>
<a name="l13889"></a>13889 <span class="comment">     * @protected</span>
<a name="l13890"></a>13890 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l13891"></a>13891 <span class="comment">     * @author Klemen Vodopivec</span>
<a name="l13892"></a>13892 <span class="comment">     */</span>
<a name="l13893"></a><a class="code" href="classTCPDF.html#ae53b78b21638fe9bb07006a39a7ad1c0">13893</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae53b78b21638fe9bb07006a39a7ad1c0" title="Encrypts a string using MD5 and returns it&#39;s value as a binary string.">_md5_16</a>($str) {
<a name="l13894"></a>13894         <span class="keywordflow">return</span> pack(<span class="stringliteral">&#39;H*&#39;</span>, md5($str));
<a name="l13895"></a>13895     }
<a name="l13896"></a>13896 <span class="comment"></span>
<a name="l13897"></a>13897 <span class="comment">    /**</span>
<a name="l13898"></a>13898 <span class="comment">     * Compute U value (used for encryption)</span>
<a name="l13899"></a>13899 <span class="comment">     * @return string U value</span>
<a name="l13900"></a>13900 <span class="comment">     * @protected</span>
<a name="l13901"></a>13901 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l13902"></a>13902 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13903"></a>13903 <span class="comment">     */</span>
<a name="l13904"></a><a class="code" href="classTCPDF.html#aa486c0cad639e303d878b1f4b5ef772e">13904</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa486c0cad639e303d878b1f4b5ef772e" title="Compute U value (used for encryption)">_Uvalue</a>() {
<a name="l13905"></a>13905         <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 0) { <span class="comment">// RC4-40</span>
<a name="l13906"></a>13906             <span class="keywordflow">return</span> $this-&gt;_RC4($this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], $this-&gt;enc_padding);
<a name="l13907"></a>13907         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &lt; 3) { <span class="comment">// RC4-128, AES-128</span>
<a name="l13908"></a>13908             $tmp = $this-&gt;_md5_16($this-&gt;enc_padding.$this-&gt;encryptdata[<span class="stringliteral">&#39;fileid&#39;</span>]);
<a name="l13909"></a>13909             <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> = $this-&gt;_RC4($this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], $tmp);
<a name="l13910"></a>13910             <a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a> = strlen($tmp);
<a name="l13911"></a>13911             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;= 19; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l13912"></a>13912                 $ek = <span class="stringliteral">&#39;&#39;</span>;
<a name="l13913"></a>13913                 <span class="keywordflow">for</span> ($j = 0; $j &lt; <a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a>; ++$j) {
<a name="l13914"></a>13914                     $ek .= chr(ord($this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>][$j]) ^ <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>);
<a name="l13915"></a>13915                 }
<a name="l13916"></a>13916                 <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> = $this-&gt;_RC4($ek, <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>);
<a name="l13917"></a>13917             }
<a name="l13918"></a>13918             <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> .= str_repeat(<span class="stringliteral">&quot;\x00&quot;</span>, 16);
<a name="l13919"></a>13919             <span class="keywordflow">return</span> substr(<a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>, 0, 32);
<a name="l13920"></a>13920         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 3) { <span class="comment">// AES-256</span>
<a name="l13921"></a>13921             $seed = $this-&gt;_md5_16($this-&gt;getRandomSeed());
<a name="l13922"></a>13922             <span class="comment">// User Validation Salt</span>
<a name="l13923"></a>13923             $this-&gt;encryptdata[<span class="stringliteral">&#39;UVS&#39;</span>] = substr($seed, 0, 8);
<a name="l13924"></a>13924             <span class="comment">// User Key Salt</span>
<a name="l13925"></a>13925             $this-&gt;encryptdata[<span class="stringliteral">&#39;UKS&#39;</span>] = substr($seed, 8, 16);
<a name="l13926"></a>13926             <span class="keywordflow">return</span> hash(<span class="stringliteral">&#39;sha256&#39;</span>, $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;UVS&#39;</span>], <span class="keyword">true</span>).$this-&gt;encryptdata[<span class="stringliteral">&#39;UVS&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;UKS&#39;</span>];
<a name="l13927"></a>13927         }
<a name="l13928"></a>13928     }
<a name="l13929"></a>13929 <span class="comment"></span>
<a name="l13930"></a>13930 <span class="comment">    /**</span>
<a name="l13931"></a>13931 <span class="comment">     * Compute UE value (used for encryption)</span>
<a name="l13932"></a>13932 <span class="comment">     * @return string UE value</span>
<a name="l13933"></a>13933 <span class="comment">     * @protected</span>
<a name="l13934"></a>13934 <span class="comment">     * @since 5.9.006 (2010-10-19)</span>
<a name="l13935"></a>13935 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13936"></a>13936 <span class="comment">     */</span>
<a name="l13937"></a><a class="code" href="classTCPDF.html#a47524cc909428afea2ee2eb02a72130f">13937</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a47524cc909428afea2ee2eb02a72130f" title="Compute UE value (used for encryption)">_UEvalue</a>() {
<a name="l13938"></a>13938         $hashkey = hash(<span class="stringliteral">&#39;sha256&#39;</span>, $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;UKS&#39;</span>], <span class="keyword">true</span>);
<a name="l13939"></a>13939         $iv = str_repeat(<span class="stringliteral">&quot;\x00&quot;</span>, mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC));
<a name="l13940"></a>13940         <span class="keywordflow">return</span> mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $hashkey, $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], MCRYPT_MODE_CBC, $iv);
<a name="l13941"></a>13941     }
<a name="l13942"></a>13942 <span class="comment"></span>
<a name="l13943"></a>13943 <span class="comment">    /**</span>
<a name="l13944"></a>13944 <span class="comment">     * Compute O value (used for encryption)</span>
<a name="l13945"></a>13945 <span class="comment">     * @return string O value</span>
<a name="l13946"></a>13946 <span class="comment">     * @protected</span>
<a name="l13947"></a>13947 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l13948"></a>13948 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13949"></a>13949 <span class="comment">     */</span>
<a name="l13950"></a><a class="code" href="classTCPDF.html#abe60f253ebfc6088b3248e84ccf0a4fe">13950</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#abe60f253ebfc6088b3248e84ccf0a4fe" title="Compute O value (used for encryption)">_Ovalue</a>() {
<a name="l13951"></a>13951         <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &lt; 3) { <span class="comment">// RC4-40, RC4-128, AES-128</span>
<a name="l13952"></a>13952             $tmp = $this-&gt;_md5_16($this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>]);
<a name="l13953"></a>13953             <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &gt; 0) {
<a name="l13954"></a>13954                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 50; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l13955"></a>13955                     $tmp = $this-&gt;_md5_16($tmp);
<a name="l13956"></a>13956                 }
<a name="l13957"></a>13957             }
<a name="l13958"></a>13958             $owner_key = substr($tmp, 0, ($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] / 8));
<a name="l13959"></a>13959             <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> = $this-&gt;_RC4($owner_key, $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>]);
<a name="l13960"></a>13960             <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &gt; 0) {
<a name="l13961"></a>13961                 <a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a> = strlen($owner_key);
<a name="l13962"></a>13962                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;= 19; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l13963"></a>13963                     $ek = <span class="stringliteral">&#39;&#39;</span>;
<a name="l13964"></a>13964                     <span class="keywordflow">for</span> ($j = 0; $j &lt; <a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a>; ++$j) {
<a name="l13965"></a>13965                         $ek .= chr(ord($owner_key[$j]) ^ <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>);
<a name="l13966"></a>13966                     }
<a name="l13967"></a>13967                     <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a> = $this-&gt;_RC4($ek, <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>);
<a name="l13968"></a>13968                 }
<a name="l13969"></a>13969             }
<a name="l13970"></a>13970             <span class="keywordflow">return</span> <a class="code" href="dejavusans_8php.html#ac35f45ece02c139742f8d3edacae5925">$enc</a>;
<a name="l13971"></a>13971         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 3) { <span class="comment">// AES-256</span>
<a name="l13972"></a>13972             $seed = $this-&gt;_md5_16($this-&gt;getRandomSeed());
<a name="l13973"></a>13973             <span class="comment">// Owner Validation Salt</span>
<a name="l13974"></a>13974             $this-&gt;encryptdata[<span class="stringliteral">&#39;OVS&#39;</span>] = substr($seed, 0, 8);
<a name="l13975"></a>13975             <span class="comment">// Owner Key Salt</span>
<a name="l13976"></a>13976             $this-&gt;encryptdata[<span class="stringliteral">&#39;OKS&#39;</span>] = substr($seed, 8, 16);
<a name="l13977"></a>13977             <span class="keywordflow">return</span> hash(<span class="stringliteral">&#39;sha256&#39;</span>, $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;OVS&#39;</span>].$this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>], <span class="keyword">true</span>).$this-&gt;encryptdata[<span class="stringliteral">&#39;OVS&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;OKS&#39;</span>];
<a name="l13978"></a>13978         }
<a name="l13979"></a>13979     }
<a name="l13980"></a>13980 <span class="comment"></span>
<a name="l13981"></a>13981 <span class="comment">    /**</span>
<a name="l13982"></a>13982 <span class="comment">     * Compute OE value (used for encryption)</span>
<a name="l13983"></a>13983 <span class="comment">     * @return string OE value</span>
<a name="l13984"></a>13984 <span class="comment">     * @protected</span>
<a name="l13985"></a>13985 <span class="comment">     * @since 5.9.006 (2010-10-19)</span>
<a name="l13986"></a>13986 <span class="comment">     * @author Nicola Asuni</span>
<a name="l13987"></a>13987 <span class="comment">     */</span>
<a name="l13988"></a><a class="code" href="classTCPDF.html#a9d325db7b1243a5f1184b3c3365d588d">13988</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9d325db7b1243a5f1184b3c3365d588d" title="Compute OE value (used for encryption)">_OEvalue</a>() {
<a name="l13989"></a>13989         $hashkey = hash(<span class="stringliteral">&#39;sha256&#39;</span>, $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;OKS&#39;</span>].$this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>], <span class="keyword">true</span>);
<a name="l13990"></a>13990         $iv = str_repeat(<span class="stringliteral">&quot;\x00&quot;</span>, mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC));
<a name="l13991"></a>13991         <span class="keywordflow">return</span> mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $hashkey, $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], MCRYPT_MODE_CBC, $iv);
<a name="l13992"></a>13992     }
<a name="l13993"></a>13993 <span class="comment"></span>
<a name="l13994"></a>13994 <span class="comment">    /**</span>
<a name="l13995"></a>13995 <span class="comment">     * Convert password for AES-256 encryption mode</span>
<a name="l13996"></a>13996 <span class="comment">     * @param $password (string) password</span>
<a name="l13997"></a>13997 <span class="comment">     * @return string password</span>
<a name="l13998"></a>13998 <span class="comment">     * @protected</span>
<a name="l13999"></a>13999 <span class="comment">     * @since 5.9.006 (2010-10-19)</span>
<a name="l14000"></a>14000 <span class="comment">     * @author Nicola Asuni</span>
<a name="l14001"></a>14001 <span class="comment">     */</span>
<a name="l14002"></a><a class="code" href="classTCPDF.html#a73ce7a4a68a80ec0efb9317b15819ab4">14002</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a73ce7a4a68a80ec0efb9317b15819ab4" title="Convert password for AES-256 encryption mode.">_fixAES256Password</a>($password) {
<a name="l14003"></a>14003         $psw = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// password to be returned</span>
<a name="l14004"></a>14004         $psw_array = $this-&gt;utf8Bidi($this-&gt;UTF8StringToArray($password), $password, $this-&gt;rtl);
<a name="l14005"></a>14005         <span class="keywordflow">foreach</span> ($psw_array as <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l14006"></a>14006             $psw .= $this-&gt;unichr($c);
<a name="l14007"></a>14007         }
<a name="l14008"></a>14008         <span class="keywordflow">return</span> substr($psw, 0, 127);
<a name="l14009"></a>14009     }
<a name="l14010"></a>14010 <span class="comment"></span>
<a name="l14011"></a>14011 <span class="comment">    /**</span>
<a name="l14012"></a>14012 <span class="comment">     * Compute encryption key</span>
<a name="l14013"></a>14013 <span class="comment">     * @protected</span>
<a name="l14014"></a>14014 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l14015"></a>14015 <span class="comment">     * @author Nicola Asuni</span>
<a name="l14016"></a>14016 <span class="comment">     */</span>
<a name="l14017"></a><a class="code" href="classTCPDF.html#aebcb9fe17da560731acc6c5329366c52">14017</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aebcb9fe17da560731acc6c5329366c52" title="Compute encryption key.">_generateencryptionkey</a>() {
<a name="l14018"></a>14018         $keybytelen = ($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] / 8);
<a name="l14019"></a>14019         <span class="keywordflow">if</span> (!$this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) { <span class="comment">// standard mode</span>
<a name="l14020"></a>14020             <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 3) { <span class="comment">// AES-256</span>
<a name="l14021"></a>14021                 <span class="comment">// generate 256 bit random key</span>
<a name="l14022"></a>14022                 $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>] = substr(hash(<span class="stringliteral">&#39;sha256&#39;</span>, $this-&gt;getRandomSeed(), <span class="keyword">true</span>), 0, $keybytelen);
<a name="l14023"></a>14023                 <span class="comment">// truncate passwords</span>
<a name="l14024"></a>14024                 $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>] = $this-&gt;_fixAES256Password($this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>]);
<a name="l14025"></a>14025                 $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>] = $this-&gt;_fixAES256Password($this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>]);
<a name="l14026"></a>14026                 <span class="comment">// Compute U value</span>
<a name="l14027"></a>14027                 $this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>] = $this-&gt;_Uvalue();
<a name="l14028"></a>14028                 <span class="comment">// Compute UE value</span>
<a name="l14029"></a>14029                 $this-&gt;encryptdata[<span class="stringliteral">&#39;UE&#39;</span>] = $this-&gt;_UEvalue();
<a name="l14030"></a>14030                 <span class="comment">// Compute O value</span>
<a name="l14031"></a>14031                 $this-&gt;encryptdata[<span class="charliteral">&#39;O&#39;</span>] = $this-&gt;_Ovalue();
<a name="l14032"></a>14032                 <span class="comment">// Compute OE value</span>
<a name="l14033"></a>14033                 $this-&gt;encryptdata[<span class="stringliteral">&#39;OE&#39;</span>] = $this-&gt;_OEvalue();
<a name="l14034"></a>14034                 <span class="comment">// Compute P value</span>
<a name="l14035"></a>14035                 $this-&gt;encryptdata[<span class="charliteral">&#39;P&#39;</span>] = $this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>];
<a name="l14036"></a>14036                 <span class="comment">// Computing the encryption dictionary&#39;s Perms (permissions) value</span>
<a name="l14037"></a>14037                 $perms = $this-&gt;getEncPermissionsString($this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>]); <span class="comment">// bytes 0-3</span>
<a name="l14038"></a>14038                 $perms .= chr(255).chr(255).chr(255).chr(255); <span class="comment">// bytes 4-7</span>
<a name="l14039"></a>14039                 <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;EncryptMetadata&#39;</span>]) AND (!$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;EncryptMetadata&#39;</span>])) { <span class="comment">// byte 8</span>
<a name="l14040"></a>14040                     $perms .= <span class="charliteral">&#39;F&#39;</span>;
<a name="l14041"></a>14041                 } <span class="keywordflow">else</span> {
<a name="l14042"></a>14042                     $perms .= <span class="charliteral">&#39;T&#39;</span>;
<a name="l14043"></a>14043                 }
<a name="l14044"></a>14044                 $perms .= <span class="stringliteral">&#39;adb&#39;</span>; <span class="comment">// bytes 9-11</span>
<a name="l14045"></a>14045                 $perms .= <span class="stringliteral">&#39;nick&#39;</span>; <span class="comment">// bytes 12-15</span>
<a name="l14046"></a>14046                 $iv = str_repeat(<span class="stringliteral">&quot;\x00&quot;</span>, mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_ECB));
<a name="l14047"></a>14047                 $this-&gt;encryptdata[<span class="stringliteral">&#39;perms&#39;</span>] = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], $perms, MCRYPT_MODE_ECB, $iv);
<a name="l14048"></a>14048             } <span class="keywordflow">else</span> { <span class="comment">// RC4-40, RC4-128, AES-128</span>
<a name="l14049"></a>14049                 <span class="comment">// Pad passwords</span>
<a name="l14050"></a>14050                 $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>] = substr($this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>].$this-&gt;enc_padding, 0, 32);
<a name="l14051"></a>14051                 $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>] = substr($this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>].$this-&gt;enc_padding, 0, 32);
<a name="l14052"></a>14052                 <span class="comment">// Compute O value</span>
<a name="l14053"></a>14053                 $this-&gt;encryptdata[<span class="charliteral">&#39;O&#39;</span>] = $this-&gt;_Ovalue();
<a name="l14054"></a>14054                 <span class="comment">// get default permissions (reverse byte order)</span>
<a name="l14055"></a>14055                 $permissions = $this-&gt;getEncPermissionsString($this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>]);
<a name="l14056"></a>14056                 <span class="comment">// Compute encryption key</span>
<a name="l14057"></a>14057                 $tmp = $this-&gt;_md5_16($this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>].$this-&gt;encryptdata[<span class="charliteral">&#39;O&#39;</span>].$permissions.$this-&gt;encryptdata[<span class="stringliteral">&#39;fileid&#39;</span>]);
<a name="l14058"></a>14058                 <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &gt; 0) {
<a name="l14059"></a>14059                     <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 50; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l14060"></a>14060                         $tmp = $this-&gt;_md5_16(substr($tmp, 0, $keybytelen));
<a name="l14061"></a>14061                     }
<a name="l14062"></a>14062                 }
<a name="l14063"></a>14063                 $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>] = substr($tmp, 0, $keybytelen);
<a name="l14064"></a>14064                 <span class="comment">// Compute U value</span>
<a name="l14065"></a>14065                 $this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>] = $this-&gt;_Uvalue();
<a name="l14066"></a>14066                 <span class="comment">// Compute P value</span>
<a name="l14067"></a>14067                 $this-&gt;encryptdata[<span class="charliteral">&#39;P&#39;</span>] = $this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>];
<a name="l14068"></a>14068             }
<a name="l14069"></a>14069         } <span class="keywordflow">else</span> { <span class="comment">// Public-Key mode</span>
<a name="l14070"></a>14070             <span class="comment">// random 20-byte seed</span>
<a name="l14071"></a>14071             $seed = sha1($this-&gt;getRandomSeed(), <span class="keyword">true</span>);
<a name="l14072"></a>14072             $recipient_bytes = <span class="stringliteral">&#39;&#39;</span>;
<a name="l14073"></a>14073             <span class="keywordflow">foreach</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkeys&#39;</span>] as $pubkey) {
<a name="l14074"></a>14074                 <span class="comment">// for each public certificate</span>
<a name="l14075"></a>14075                 <span class="keywordflow">if</span> (isset($pubkey[<span class="charliteral">&#39;p&#39;</span>])) {
<a name="l14076"></a>14076                     $pkprotection = $this-&gt;getUserPermissionCode($pubkey[<span class="charliteral">&#39;p&#39;</span>], $this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>]);
<a name="l14077"></a>14077                 } <span class="keywordflow">else</span> {
<a name="l14078"></a>14078                     $pkprotection = $this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>];
<a name="l14079"></a>14079                 }
<a name="l14080"></a>14080                 <span class="comment">// get default permissions (reverse byte order)</span>
<a name="l14081"></a>14081                 $pkpermissions = $this-&gt;getEncPermissionsString($pkprotection);
<a name="l14082"></a>14082                 <span class="comment">// envelope data</span>
<a name="l14083"></a>14083                 $envelope = $seed.$pkpermissions;
<a name="l14084"></a>14084                 <span class="comment">// write the envelope data to a temporary file</span>
<a name="l14085"></a>14085                 $tempkeyfile = tempnam(K_PATH_CACHE, <span class="stringliteral">&#39;tmpkey_&#39;</span>);
<a name="l14086"></a>14086                 <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = fopen($tempkeyfile, <span class="stringliteral">&#39;wb&#39;</span>);
<a name="l14087"></a>14087                 <span class="keywordflow">if</span> (!<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>) {
<a name="l14088"></a>14088                     $this-&gt;Error(<span class="stringliteral">&#39;Unable to create temporary key file: &#39;</span>.$tempkeyfile);
<a name="l14089"></a>14089                 }
<a name="l14090"></a>14090                 $envelope_length = strlen($envelope);
<a name="l14091"></a>14091                 fwrite(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, $envelope, $envelope_length);
<a name="l14092"></a>14092                 fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l14093"></a>14093                 $tempencfile = tempnam(K_PATH_CACHE, <span class="stringliteral">&#39;tmpenc_&#39;</span>);
<a name="l14094"></a>14094                 <span class="keywordflow">if</span> (!openssl_pkcs7_encrypt($tempkeyfile, $tempencfile, $pubkey[<span class="charliteral">&#39;c&#39;</span>], array(), PKCS7_BINARY | PKCS7_DETACHED)) {
<a name="l14095"></a>14095                     $this-&gt;Error(<span class="stringliteral">&#39;Unable to encrypt the file: &#39;</span>.$tempkeyfile);
<a name="l14096"></a>14096                 }
<a name="l14097"></a>14097                 unlink($tempkeyfile);
<a name="l14098"></a>14098                 <span class="comment">// read encryption signature</span>
<a name="l14099"></a>14099                 $signature = file_get_contents($tempencfile, <span class="keyword">false</span>, null, $envelope_length);
<a name="l14100"></a>14100                 unlink($tempencfile);
<a name="l14101"></a>14101                 <span class="comment">// extract signature</span>
<a name="l14102"></a>14102                 $signature = substr($signature, strpos($signature, <span class="stringliteral">&#39;Content-Disposition&#39;</span>));
<a name="l14103"></a>14103                 $tmparr = explode(<span class="stringliteral">&quot;\n\n&quot;</span>, $signature);
<a name="l14104"></a>14104                 $signature = trim($tmparr[1]);
<a name="l14105"></a>14105                 unset($tmparr);
<a name="l14106"></a>14106                 <span class="comment">// decode signature</span>
<a name="l14107"></a>14107                 $signature = base64_decode($signature);
<a name="l14108"></a>14108                 <span class="comment">// convert signature to hex</span>
<a name="l14109"></a>14109                 $hexsignature = current(unpack(<span class="stringliteral">&#39;H*&#39;</span>, $signature));
<a name="l14110"></a>14110                 <span class="comment">// store signature on recipients array</span>
<a name="l14111"></a>14111                 $this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>][] = $hexsignature;
<a name="l14112"></a>14112                 <span class="comment">// The bytes of each item in the Recipients array of PKCS#7 objects in the order in which they appear in the array</span>
<a name="l14113"></a>14113                 $recipient_bytes .= $signature;
<a name="l14114"></a>14114             }
<a name="l14115"></a>14115             <span class="comment">// calculate encryption key</span>
<a name="l14116"></a>14116             <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 3) { <span class="comment">// AES-256</span>
<a name="l14117"></a>14117                 $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>] = substr(hash(<span class="stringliteral">&#39;sha256&#39;</span>, $seed.$recipient_bytes, <span class="keyword">true</span>), 0, $keybytelen);
<a name="l14118"></a>14118             } <span class="keywordflow">else</span> { <span class="comment">// RC4-40, RC4-128, AES-128</span>
<a name="l14119"></a>14119                 $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>] = substr(sha1($seed.$recipient_bytes, <span class="keyword">true</span>), 0, $keybytelen);
<a name="l14120"></a>14120             }
<a name="l14121"></a>14121         }
<a name="l14122"></a>14122     }
<a name="l14123"></a>14123 <span class="comment"></span>
<a name="l14124"></a>14124 <span class="comment">    /**</span>
<a name="l14125"></a>14125 <span class="comment">     * Return the premission code used on encryption (P value).</span>
<a name="l14126"></a>14126 <span class="comment">     * @param $permissions (Array) the set of permissions (specify the ones you want to block).</span>
<a name="l14127"></a>14127 <span class="comment">     * @param $mode (int) encryption strength: 0 = RC4 40 bit; 1 = RC4 128 bit; 2 = AES 128 bit; 3 = AES 256 bit.</span>
<a name="l14128"></a>14128 <span class="comment">     * @protected</span>
<a name="l14129"></a>14129 <span class="comment">     * @since 5.0.005 (2010-05-12)</span>
<a name="l14130"></a>14130 <span class="comment">     * @author Nicola Asuni</span>
<a name="l14131"></a>14131 <span class="comment">     */</span>
<a name="l14132"></a><a class="code" href="classTCPDF.html#a7c1ceb4b32780e1dc7d681b82e04e93d">14132</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7c1ceb4b32780e1dc7d681b82e04e93d" title="Return the premission code used on encryption (P value).">getUserPermissionCode</a>($permissions, <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>=0) {
<a name="l14133"></a>14133         <a class="code" href="db__qbe_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a> = array(
<a name="l14134"></a>14134             <span class="stringliteral">&#39;owner&#39;</span> =&gt; 2, <span class="comment">// bit 2 -- inverted logic: cleared by default</span>
<a name="l14135"></a>14135             <span class="stringliteral">&#39;print&#39;</span> =&gt; 4, <span class="comment">// bit 3</span>
<a name="l14136"></a>14136             <span class="stringliteral">&#39;modify&#39;</span> =&gt; 8, <span class="comment">// bit 4</span>
<a name="l14137"></a>14137             <span class="stringliteral">&#39;copy&#39;</span> =&gt; 16, <span class="comment">// bit 5</span>
<a name="l14138"></a>14138             <span class="stringliteral">&#39;annot-forms&#39;</span> =&gt; 32, <span class="comment">// bit 6</span>
<a name="l14139"></a>14139             <span class="stringliteral">&#39;fill-forms&#39;</span> =&gt; 256, <span class="comment">// bit 9</span>
<a name="l14140"></a>14140             <span class="stringliteral">&#39;extract&#39;</span> =&gt; 512, <span class="comment">// bit 10</span>
<a name="l14141"></a>14141             <span class="stringliteral">&#39;assemble&#39;</span> =&gt; 1024,<span class="comment">// bit 11</span>
<a name="l14142"></a>14142             <span class="stringliteral">&#39;print-high&#39;</span> =&gt; 2048 <span class="comment">// bit 12</span>
<a name="l14143"></a>14143             );
<a name="l14144"></a>14144         $protection = 2147422012; <span class="comment">// 32 bit: (01111111 11111111 00001111 00111100)</span>
<a name="l14145"></a>14145         <span class="keywordflow">foreach</span> ($permissions as $permission) {
<a name="l14146"></a>14146             <span class="keywordflow">if</span> (!isset(<a class="code" href="db__qbe_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>[$permission])) {
<a name="l14147"></a>14147                 $this-&gt;Error(<span class="stringliteral">&#39;Incorrect permission: &#39;</span>.$permission);
<a name="l14148"></a>14148             }
<a name="l14149"></a>14149             <span class="keywordflow">if</span> ((<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> &gt; 0) OR (<a class="code" href="db__qbe_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>[$permission] &lt;= 32)) {
<a name="l14150"></a>14150                 <span class="comment">// set only valid permissions</span>
<a name="l14151"></a>14151                 <span class="keywordflow">if</span> (<a class="code" href="db__qbe_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>[$permission] == 2) {
<a name="l14152"></a>14152                     <span class="comment">// the logic for bit 2 is inverted (cleared by default)</span>
<a name="l14153"></a>14153                     $protection += <a class="code" href="db__qbe_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>[$permission];
<a name="l14154"></a>14154                 } <span class="keywordflow">else</span> {
<a name="l14155"></a>14155                     $protection -= <a class="code" href="db__qbe_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>[$permission];
<a name="l14156"></a>14156                 }
<a name="l14157"></a>14157             }
<a name="l14158"></a>14158         }
<a name="l14159"></a>14159         <span class="keywordflow">return</span> $protection;
<a name="l14160"></a>14160     }
<a name="l14161"></a>14161 <span class="comment"></span>
<a name="l14162"></a>14162 <span class="comment">    /**</span>
<a name="l14163"></a>14163 <span class="comment">     * Set document protection</span>
<a name="l14164"></a>14164 <span class="comment">     * Remark: the protection against modification is for people who have the full Acrobat product.</span>
<a name="l14165"></a>14165 <span class="comment">     * If you don&#39;t set any password, the document will open as usual. If you set a user password, the PDF viewer will ask for it before displaying the document. The master password, if different from the user one, can be used to get full access.</span>
<a name="l14166"></a>14166 <span class="comment">     * Note: protecting a document requires to encrypt it, which increases the processing time a lot. This can cause a PHP time-out in some cases, especially if the document contains images or fonts.</span>
<a name="l14167"></a>14167 <span class="comment">     * @param $permissions (Array) the set of permissions (specify the ones you want to block):&lt;ul&gt;&lt;li&gt;print : Print the document;&lt;/li&gt;&lt;li&gt;modify : Modify the contents of the document by operations other than those controlled by &#39;fill-forms&#39;, &#39;extract&#39; and &#39;assemble&#39;;&lt;/li&gt;&lt;li&gt;copy : Copy or otherwise extract text and graphics from the document;&lt;/li&gt;&lt;li&gt;annot-forms : Add or modify text annotations, fill in interactive form fields, and, if &#39;modify&#39; is also set, create or modify interactive form fields (including signature fields);&lt;/li&gt;&lt;li&gt;fill-forms : Fill in existing interactive form fields (including signature fields), even if &#39;annot-forms&#39; is not specified;&lt;/li&gt;&lt;li&gt;extract : Extract text and graphics (in support of accessibility to users with disabilities or for other purposes);&lt;/li&gt;&lt;li&gt;assemble : Assemble the document (insert, rotate, or delete pages and create bookmarks or thumbnail images), even if &#39;modify&#39; is not set;&lt;/li&gt;&lt;li&gt;print-high : Print the document to a representation from which a faithful digital copy of the PDF content could be generated. When this is not set, printing is limited to a low-level representation of the appearance, possibly of degraded quality.&lt;/li&gt;&lt;li&gt;owner : (inverted logic - only for public-key) when set permits change of encryption and enables all other permissions.&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l14168"></a>14168 <span class="comment">     * @param $user_pass (String) user password. Empty by default.</span>
<a name="l14169"></a>14169 <span class="comment">     * @param $owner_pass (String) owner password. If not specified, a random value is used.</span>
<a name="l14170"></a>14170 <span class="comment">     * @param $mode (int) encryption strength: 0 = RC4 40 bit; 1 = RC4 128 bit; 2 = AES 128 bit; 3 = AES 256 bit.</span>
<a name="l14171"></a>14171 <span class="comment">     * @param $pubkeys (String) array of recipients containing public-key certificates (&#39;c&#39;) and permissions (&#39;p&#39;). For example: array(array(&#39;c&#39; =&gt; &#39;file://../tcpdf.crt&#39;, &#39;p&#39; =&gt; array(&#39;print&#39;)))</span>
<a name="l14172"></a>14172 <span class="comment">     * @public</span>
<a name="l14173"></a>14173 <span class="comment">     * @since 2.0.000 (2008-01-02)</span>
<a name="l14174"></a>14174 <span class="comment">     * @author Nicola Asuni</span>
<a name="l14175"></a>14175 <span class="comment">     */</span>
<a name="l14176"></a><a class="code" href="classTCPDF.html#a7ea250b2b4e3d7e55e657d52732a3b1d">14176</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7ea250b2b4e3d7e55e657d52732a3b1d" title="Set document protection Remark: the protection against modification is for people who have the full A...">SetProtection</a>($permissions=array(<span class="stringliteral">&#39;print&#39;</span>, <span class="stringliteral">&#39;modify&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>, <span class="stringliteral">&#39;annot-forms&#39;</span>, <span class="stringliteral">&#39;fill-forms&#39;</span>, <span class="stringliteral">&#39;extract&#39;</span>, <span class="stringliteral">&#39;assemble&#39;</span>, <span class="stringliteral">&#39;print-high&#39;</span>), $user_pass=<span class="stringliteral">&#39;&#39;</span>, $owner_pass=null, <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>=0, $pubkeys=null) {
<a name="l14177"></a>14177         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l14178"></a>14178             <span class="comment">// encryption is not allowed in PDF/A mode</span>
<a name="l14179"></a>14179             <span class="keywordflow">return</span>;
<a name="l14180"></a>14180         }
<a name="l14181"></a>14181         $this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>] = $this-&gt;getUserPermissionCode($permissions, <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>);
<a name="l14182"></a>14182         <span class="keywordflow">if</span> (($pubkeys !== null) AND (is_array($pubkeys))) {
<a name="l14183"></a>14183             <span class="comment">// public-key mode</span>
<a name="l14184"></a>14184             $this-&gt;encryptdata[<span class="stringliteral">&#39;pubkeys&#39;</span>] = $pubkeys;
<a name="l14185"></a>14185             <span class="keywordflow">if</span> (<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> == 0) {
<a name="l14186"></a>14186                 <span class="comment">// public-Key Security requires at least 128 bit</span>
<a name="l14187"></a>14187                 <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> = 1;
<a name="l14188"></a>14188             }
<a name="l14189"></a>14189             <span class="keywordflow">if</span> (!function_exists(<span class="stringliteral">&#39;openssl_pkcs7_encrypt&#39;</span>)) {
<a name="l14190"></a>14190                 $this-&gt;Error(<span class="stringliteral">&#39;Public-Key Security requires openssl library.&#39;</span>);
<a name="l14191"></a>14191             }
<a name="l14192"></a>14192             <span class="comment">// Set Public-Key filter (availabe are: Entrust.PPKEF, Adobe.PPKLite, Adobe.PubSec)</span>
<a name="l14193"></a>14193             $this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>] = <span class="keyword">true</span>;
<a name="l14194"></a>14194             $this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>] = <span class="stringliteral">&#39;Adobe.PubSec&#39;</span>;
<a name="l14195"></a>14195             $this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>] = <span class="stringliteral">&#39;DefaultCryptFilter&#39;</span>;
<a name="l14196"></a>14196             $this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>] = <span class="stringliteral">&#39;DefaultCryptFilter&#39;</span>;
<a name="l14197"></a>14197         } <span class="keywordflow">else</span> {
<a name="l14198"></a>14198             <span class="comment">// standard mode (password mode)</span>
<a name="l14199"></a>14199             $this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>] = <span class="keyword">false</span>;
<a name="l14200"></a>14200             $this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>] = <span class="stringliteral">&#39;Standard&#39;</span>;
<a name="l14201"></a>14201             $this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>] = <span class="stringliteral">&#39;StdCF&#39;</span>;
<a name="l14202"></a>14202             $this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>] = <span class="stringliteral">&#39;StdCF&#39;</span>;
<a name="l14203"></a>14203         }
<a name="l14204"></a>14204         <span class="keywordflow">if</span> (<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> &gt; 1) { <span class="comment">// AES</span>
<a name="l14205"></a>14205             <span class="keywordflow">if</span> (!extension_loaded(<span class="stringliteral">&#39;mcrypt&#39;</span>)) {
<a name="l14206"></a>14206                 $this-&gt;Error(<span class="stringliteral">&#39;AES encryption requires mcrypt library (http://www.php.net/manual/en/mcrypt.requirements.php).&#39;</span>);
<a name="l14207"></a>14207             }
<a name="l14208"></a>14208             <span class="keywordflow">if</span> (mcrypt_get_cipher_name(MCRYPT_RIJNDAEL_128) === <span class="keyword">false</span>) {
<a name="l14209"></a>14209                 $this-&gt;Error(<span class="stringliteral">&#39;AES encryption requires MCRYPT_RIJNDAEL_128 cypher.&#39;</span>);
<a name="l14210"></a>14210             }
<a name="l14211"></a>14211             <span class="keywordflow">if</span> ((<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> == 3) AND !function_exists(<span class="stringliteral">&#39;hash&#39;</span>)) {
<a name="l14212"></a>14212                 <span class="comment">// the Hash extension requires no external libraries and is enabled by default as of PHP 5.1.2.</span>
<a name="l14213"></a>14213                 $this-&gt;Error(<span class="stringliteral">&#39;AES 256 encryption requires HASH Message Digest Framework (http://www.php.net/manual/en/book.hash.php).&#39;</span>);
<a name="l14214"></a>14214             }
<a name="l14215"></a>14215         }
<a name="l14216"></a>14216         <span class="keywordflow">if</span> ($owner_pass === null) {
<a name="l14217"></a>14217             $owner_pass = md5($this-&gt;getRandomSeed());
<a name="l14218"></a>14218         }
<a name="l14219"></a>14219         $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>] = $user_pass;
<a name="l14220"></a>14220         $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>] = $owner_pass;
<a name="l14221"></a>14221         $this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] = <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>;
<a name="l14222"></a>14222         <span class="keywordflow">switch</span> (<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>) {
<a name="l14223"></a>14223             <span class="keywordflow">case</span> 0: { <span class="comment">// RC4 40 bit</span>
<a name="l14224"></a>14224                 $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 1;
<a name="l14225"></a>14225                 $this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] = 40;
<a name="l14226"></a>14226                 $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>] = <span class="stringliteral">&#39;V2&#39;</span>;
<a name="l14227"></a>14227                 <span class="keywordflow">break</span>;
<a name="l14228"></a>14228             }
<a name="l14229"></a>14229             <span class="keywordflow">case</span> 1: { <span class="comment">// RC4 128 bit</span>
<a name="l14230"></a>14230                 $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 2;
<a name="l14231"></a>14231                 $this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] = 128;
<a name="l14232"></a>14232                 $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>] = <span class="stringliteral">&#39;V2&#39;</span>;
<a name="l14233"></a>14233                 <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {
<a name="l14234"></a>14234                     $this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>] = <span class="stringliteral">&#39;adbe.pkcs7.s4&#39;</span>;
<a name="l14235"></a>14235                     $this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] = array();
<a name="l14236"></a>14236                 }
<a name="l14237"></a>14237                 <span class="keywordflow">break</span>;
<a name="l14238"></a>14238             }
<a name="l14239"></a>14239             <span class="keywordflow">case</span> 2: { <span class="comment">// AES 128 bit</span>
<a name="l14240"></a>14240                 $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 4;
<a name="l14241"></a>14241                 $this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] = 128;
<a name="l14242"></a>14242                 $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>] = <span class="stringliteral">&#39;AESV2&#39;</span>;
<a name="l14243"></a>14243                 $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>] = 128;
<a name="l14244"></a>14244                 <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {
<a name="l14245"></a>14245                     $this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>] = <span class="stringliteral">&#39;adbe.pkcs7.s5&#39;</span>;
<a name="l14246"></a>14246                     $this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] = array();
<a name="l14247"></a>14247                 }
<a name="l14248"></a>14248                 <span class="keywordflow">break</span>;
<a name="l14249"></a>14249             }
<a name="l14250"></a>14250             <span class="keywordflow">case</span> 3: { <span class="comment">// AES 256 bit</span>
<a name="l14251"></a>14251                 $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 5;
<a name="l14252"></a>14252                 $this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] = 256;
<a name="l14253"></a>14253                 $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>] = <span class="stringliteral">&#39;AESV3&#39;</span>;
<a name="l14254"></a>14254                 $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>] = 256;
<a name="l14255"></a>14255                 <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {
<a name="l14256"></a>14256                     $this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>] = <span class="stringliteral">&#39;adbe.pkcs7.s5&#39;</span>;
<a name="l14257"></a>14257                     $this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] = array();
<a name="l14258"></a>14258                 }
<a name="l14259"></a>14259                 <span class="keywordflow">break</span>;
<a name="l14260"></a>14260             }
<a name="l14261"></a>14261         }
<a name="l14262"></a>14262         $this-&gt;encrypted = <span class="keyword">true</span>;
<a name="l14263"></a>14263         $this-&gt;encryptdata[<span class="stringliteral">&#39;fileid&#39;</span>] = $this-&gt;convertHexStringToString($this-&gt;file_id);
<a name="l14264"></a>14264         $this-&gt;_generateencryptionkey();
<a name="l14265"></a>14265     }
<a name="l14266"></a>14266 <span class="comment"></span>
<a name="l14267"></a>14267 <span class="comment">    /**</span>
<a name="l14268"></a>14268 <span class="comment">     * Convert hexadecimal string to string</span>
<a name="l14269"></a>14269 <span class="comment">     * @param $bs (string) byte-string to convert</span>
<a name="l14270"></a>14270 <span class="comment">     * @return String</span>
<a name="l14271"></a>14271 <span class="comment">     * @protected</span>
<a name="l14272"></a>14272 <span class="comment">     * @since 5.0.005 (2010-05-12)</span>
<a name="l14273"></a>14273 <span class="comment">     * @author Nicola Asuni</span>
<a name="l14274"></a>14274 <span class="comment">     */</span>
<a name="l14275"></a><a class="code" href="classTCPDF.html#a030f8fc6c59d0192dcefd383c86e4266">14275</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a030f8fc6c59d0192dcefd383c86e4266" title="Convert hexadecimal string to string.">convertHexStringToString</a>($bs) {
<a name="l14276"></a>14276         $string = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// string to be returned</span>
<a name="l14277"></a>14277         $bslength = strlen($bs);
<a name="l14278"></a>14278         <span class="keywordflow">if</span> (($bslength % 2) != 0) {
<a name="l14279"></a>14279             <span class="comment">// padding</span>
<a name="l14280"></a>14280             $bs .= <span class="charliteral">&#39;0&#39;</span>;
<a name="l14281"></a>14281             ++$bslength;
<a name="l14282"></a>14282         }
<a name="l14283"></a>14283         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $bslength; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> += 2) {
<a name="l14284"></a>14284             $string .= chr(hexdec($bs[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>].$bs[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 1)]));
<a name="l14285"></a>14285         }
<a name="l14286"></a>14286         <span class="keywordflow">return</span> $string;
<a name="l14287"></a>14287     }
<a name="l14288"></a>14288 <span class="comment"></span>
<a name="l14289"></a>14289 <span class="comment">    /**</span>
<a name="l14290"></a>14290 <span class="comment">     * Convert string to hexadecimal string (byte string)</span>
<a name="l14291"></a>14291 <span class="comment">     * @param $s (string) string to convert</span>
<a name="l14292"></a>14292 <span class="comment">     * @return byte string</span>
<a name="l14293"></a>14293 <span class="comment">     * @protected</span>
<a name="l14294"></a>14294 <span class="comment">     * @since 5.0.010 (2010-05-17)</span>
<a name="l14295"></a>14295 <span class="comment">     * @author Nicola Asuni</span>
<a name="l14296"></a>14296 <span class="comment">     */</span>
<a name="l14297"></a><a class="code" href="classTCPDF.html#ab827093dadf700ed5a4aa826f59e2e67">14297</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab827093dadf700ed5a4aa826f59e2e67" title="Convert string to hexadecimal string (byte string)">convertStringToHexString</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>) {
<a name="l14298"></a>14298         $bs = <span class="stringliteral">&#39;&#39;</span>;
<a name="l14299"></a>14299         $chars = preg_split(<span class="stringliteral">&#39;//&#39;</span>, <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, -1, PREG_SPLIT_NO_EMPTY);
<a name="l14300"></a>14300         <span class="keywordflow">foreach</span> ($chars as <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l14301"></a>14301             $bs .= sprintf(<span class="stringliteral">&#39;%02s&#39;</span>, dechex(ord($c)));
<a name="l14302"></a>14302         }
<a name="l14303"></a>14303         <span class="keywordflow">return</span> $bs;
<a name="l14304"></a>14304     }
<a name="l14305"></a>14305 <span class="comment"></span>
<a name="l14306"></a>14306 <span class="comment">    /**</span>
<a name="l14307"></a>14307 <span class="comment">     * Convert encryption P value to a string of bytes, low-order byte first.</span>
<a name="l14308"></a>14308 <span class="comment">     * @param $protection (string) 32bit encryption permission value (P value)</span>
<a name="l14309"></a>14309 <span class="comment">     * @return String</span>
<a name="l14310"></a>14310 <span class="comment">     * @protected</span>
<a name="l14311"></a>14311 <span class="comment">     * @since 5.0.005 (2010-05-12)</span>
<a name="l14312"></a>14312 <span class="comment">     * @author Nicola Asuni</span>
<a name="l14313"></a>14313 <span class="comment">     */</span>
<a name="l14314"></a><a class="code" href="classTCPDF.html#ad8b1932246bea2f9527d62b026005bed">14314</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad8b1932246bea2f9527d62b026005bed" title="Convert encryption P value to a string of bytes, low-order byte first.">getEncPermissionsString</a>($protection) {
<a name="l14315"></a>14315         $binprot = sprintf(<span class="stringliteral">&#39;%032b&#39;</span>, $protection);
<a name="l14316"></a>14316         $str = chr(bindec(substr($binprot, 24, 8)));
<a name="l14317"></a>14317         $str .= chr(bindec(substr($binprot, 16, 8)));
<a name="l14318"></a>14318         $str .= chr(bindec(substr($binprot, 8, 8)));
<a name="l14319"></a>14319         $str .= chr(bindec(substr($binprot, 0, 8)));
<a name="l14320"></a>14320         <span class="keywordflow">return</span> $str;
<a name="l14321"></a>14321     }
<a name="l14322"></a>14322 
<a name="l14323"></a>14323     <span class="comment">// END OF ENCRYPTION FUNCTIONS -------------------------</span>
<a name="l14324"></a>14324 
<a name="l14325"></a>14325     <span class="comment">// START TRANSFORMATIONS SECTION -----------------------</span>
<a name="l14326"></a>14326 <span class="comment"></span>
<a name="l14327"></a>14327 <span class="comment">    /**</span>
<a name="l14328"></a>14328 <span class="comment">     * Starts a 2D tranformation saving current graphic state.</span>
<a name="l14329"></a>14329 <span class="comment">     * This function must be called before scaling, mirroring, translation, rotation and skewing.</span>
<a name="l14330"></a>14330 <span class="comment">     * Use StartTransform() before, and StopTransform() after the transformations to restore the normal behavior.</span>
<a name="l14331"></a>14331 <span class="comment">     * @public</span>
<a name="l14332"></a>14332 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14333"></a>14333 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14334"></a>14334 <span class="comment">     */</span>
<a name="l14335"></a><a class="code" href="classTCPDF.html#aa07b31137128fee6f4d505cb1e7052ec">14335</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa07b31137128fee6f4d505cb1e7052ec" title="Starts a 2D tranformation saving current graphic state.">StartTransform</a>() {
<a name="l14336"></a>14336         $this-&gt;_out(<span class="charliteral">&#39;q&#39;</span>);
<a name="l14337"></a>14337         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l14338"></a>14338             <span class="comment">// we are inside an XObject template</span>
<a name="l14339"></a>14339             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][] = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);
<a name="l14340"></a>14340         } <span class="keywordflow">else</span> {
<a name="l14341"></a>14341             $this-&gt;transfmrk[$this-&gt;page][] = $this-&gt;pagelen[$this-&gt;page];
<a name="l14342"></a>14342         }
<a name="l14343"></a>14343         ++$this-&gt;transfmatrix_key;
<a name="l14344"></a>14344         $this-&gt;transfmatrix[$this-&gt;transfmatrix_key] = array();
<a name="l14345"></a>14345     }
<a name="l14346"></a>14346 <span class="comment"></span>
<a name="l14347"></a>14347 <span class="comment">    /**</span>
<a name="l14348"></a>14348 <span class="comment">     * Stops a 2D tranformation restoring previous graphic state.</span>
<a name="l14349"></a>14349 <span class="comment">     * This function must be called after scaling, mirroring, translation, rotation and skewing.</span>
<a name="l14350"></a>14350 <span class="comment">     * Use StartTransform() before, and StopTransform() after the transformations to restore the normal behavior.</span>
<a name="l14351"></a>14351 <span class="comment">     * @public</span>
<a name="l14352"></a>14352 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14353"></a>14353 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14354"></a>14354 <span class="comment">     */</span>
<a name="l14355"></a><a class="code" href="classTCPDF.html#a26529ccdd9f9ec9d0ea0c40980776760">14355</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a26529ccdd9f9ec9d0ea0c40980776760" title="Stops a 2D tranformation restoring previous graphic state.">StopTransform</a>() {
<a name="l14356"></a>14356         $this-&gt;_out(<span class="charliteral">&#39;Q&#39;</span>);
<a name="l14357"></a>14357         <span class="keywordflow">if</span> (isset($this-&gt;transfmatrix[$this-&gt;transfmatrix_key])) {
<a name="l14358"></a>14358             array_pop($this-&gt;transfmatrix[$this-&gt;transfmatrix_key]);
<a name="l14359"></a>14359             --$this-&gt;transfmatrix_key;
<a name="l14360"></a>14360         }
<a name="l14361"></a>14361         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l14362"></a>14362             <span class="comment">// we are inside an XObject template</span>
<a name="l14363"></a>14363             array_pop($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);
<a name="l14364"></a>14364         } <span class="keywordflow">else</span> {
<a name="l14365"></a>14365             array_pop($this-&gt;transfmrk[$this-&gt;page]);
<a name="l14366"></a>14366         }
<a name="l14367"></a>14367     }<span class="comment"></span>
<a name="l14368"></a>14368 <span class="comment">    /**</span>
<a name="l14369"></a>14369 <span class="comment">     * Horizontal Scaling.</span>
<a name="l14370"></a>14370 <span class="comment">     * @param $s_x (float) scaling factor for width as percent. 0 is not allowed.</span>
<a name="l14371"></a>14371 <span class="comment">     * @param $x (int) abscissa of the scaling center. Default is current x position</span>
<a name="l14372"></a>14372 <span class="comment">     * @param $y (int) ordinate of the scaling center. Default is current y position</span>
<a name="l14373"></a>14373 <span class="comment">     * @public</span>
<a name="l14374"></a>14374 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14375"></a>14375 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14376"></a>14376 <span class="comment">     */</span>
<a name="l14377"></a><a class="code" href="classTCPDF.html#ad80a884a2336e06f2f8ed9b8c31d11c9">14377</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad80a884a2336e06f2f8ed9b8c31d11c9" title="Horizontal Scaling.">ScaleX</a>($s_x, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14378"></a>14378         $this-&gt;Scale($s_x, 100, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l14379"></a>14379     }
<a name="l14380"></a>14380 <span class="comment"></span>
<a name="l14381"></a>14381 <span class="comment">    /**</span>
<a name="l14382"></a>14382 <span class="comment">     * Vertical Scaling.</span>
<a name="l14383"></a>14383 <span class="comment">     * @param $s_y (float) scaling factor for height as percent. 0 is not allowed.</span>
<a name="l14384"></a>14384 <span class="comment">     * @param $x (int) abscissa of the scaling center. Default is current x position</span>
<a name="l14385"></a>14385 <span class="comment">     * @param $y (int) ordinate of the scaling center. Default is current y position</span>
<a name="l14386"></a>14386 <span class="comment">     * @public</span>
<a name="l14387"></a>14387 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14388"></a>14388 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14389"></a>14389 <span class="comment">     */</span>
<a name="l14390"></a><a class="code" href="classTCPDF.html#a21df9dfbc3a918515ba028dd26063956">14390</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a21df9dfbc3a918515ba028dd26063956" title="Vertical Scaling.">ScaleY</a>($s_y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14391"></a>14391         $this-&gt;Scale(100, $s_y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l14392"></a>14392     }
<a name="l14393"></a>14393 <span class="comment"></span>
<a name="l14394"></a>14394 <span class="comment">    /**</span>
<a name="l14395"></a>14395 <span class="comment">     * Vertical and horizontal proportional Scaling.</span>
<a name="l14396"></a>14396 <span class="comment">     * @param $s (float) scaling factor for width and height as percent. 0 is not allowed.</span>
<a name="l14397"></a>14397 <span class="comment">     * @param $x (int) abscissa of the scaling center. Default is current x position</span>
<a name="l14398"></a>14398 <span class="comment">     * @param $y (int) ordinate of the scaling center. Default is current y position</span>
<a name="l14399"></a>14399 <span class="comment">     * @public</span>
<a name="l14400"></a>14400 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14401"></a>14401 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14402"></a>14402 <span class="comment">     */</span>
<a name="l14403"></a><a class="code" href="classTCPDF.html#a765be81c830574535ed8cb33f0ad2065">14403</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a765be81c830574535ed8cb33f0ad2065" title="Vertical and horizontal proportional Scaling.">ScaleXY</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14404"></a>14404         $this-&gt;Scale(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l14405"></a>14405     }
<a name="l14406"></a>14406 <span class="comment"></span>
<a name="l14407"></a>14407 <span class="comment">    /**</span>
<a name="l14408"></a>14408 <span class="comment">     * Vertical and horizontal non-proportional Scaling.</span>
<a name="l14409"></a>14409 <span class="comment">     * @param $s_x (float) scaling factor for width as percent. 0 is not allowed.</span>
<a name="l14410"></a>14410 <span class="comment">     * @param $s_y (float) scaling factor for height as percent. 0 is not allowed.</span>
<a name="l14411"></a>14411 <span class="comment">     * @param $x (int) abscissa of the scaling center. Default is current x position</span>
<a name="l14412"></a>14412 <span class="comment">     * @param $y (int) ordinate of the scaling center. Default is current y position</span>
<a name="l14413"></a>14413 <span class="comment">     * @public</span>
<a name="l14414"></a>14414 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14415"></a>14415 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14416"></a>14416 <span class="comment">     */</span>
<a name="l14417"></a><a class="code" href="classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">14417</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020" title="Vertical and horizontal non-proportional Scaling.">Scale</a>($s_x, $s_y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14418"></a>14418         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l14419"></a>14419             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l14420"></a>14420         }
<a name="l14421"></a>14421         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l14422"></a>14422             $y = $this-&gt;y;
<a name="l14423"></a>14423         }
<a name="l14424"></a>14424         <span class="keywordflow">if</span> (($s_x == 0) OR ($s_y == 0)) {
<a name="l14425"></a>14425             $this-&gt;Error(<span class="stringliteral">&#39;Please do not use values equal to zero for scaling&#39;</span>);
<a name="l14426"></a>14426         }
<a name="l14427"></a>14427         $y = ($this-&gt;h - $y) * $this-&gt;k;
<a name="l14428"></a>14428         <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> *= $this-&gt;k;
<a name="l14429"></a>14429         <span class="comment">//calculate elements of transformation matrix</span>
<a name="l14430"></a>14430         $s_x /= 100;
<a name="l14431"></a>14431         $s_y /= 100;
<a name="l14432"></a>14432         $tm = array();
<a name="l14433"></a>14433         $tm[0] = $s_x;
<a name="l14434"></a>14434         $tm[1] = 0;
<a name="l14435"></a>14435         $tm[2] = 0;
<a name="l14436"></a>14436         $tm[3] = $s_y;
<a name="l14437"></a>14437         $tm[4] = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * (1 - $s_x);
<a name="l14438"></a>14438         $tm[5] = $y * (1 - $s_y);
<a name="l14439"></a>14439         <span class="comment">//scale the coordinate system</span>
<a name="l14440"></a>14440         $this-&gt;Transform($tm);
<a name="l14441"></a>14441     }
<a name="l14442"></a>14442 <span class="comment"></span>
<a name="l14443"></a>14443 <span class="comment">    /**</span>
<a name="l14444"></a>14444 <span class="comment">     * Horizontal Mirroring.</span>
<a name="l14445"></a>14445 <span class="comment">     * @param $x (int) abscissa of the point. Default is current x position</span>
<a name="l14446"></a>14446 <span class="comment">     * @public</span>
<a name="l14447"></a>14447 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14448"></a>14448 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14449"></a>14449 <span class="comment">     */</span>
<a name="l14450"></a><a class="code" href="classTCPDF.html#a4b01dfbc5e4e8453f3fce47026a264f2">14450</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4b01dfbc5e4e8453f3fce47026a264f2" title="Horizontal Mirroring.">MirrorH</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14451"></a>14451         $this-&gt;Scale(-100, 100, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>);
<a name="l14452"></a>14452     }
<a name="l14453"></a>14453 <span class="comment"></span>
<a name="l14454"></a>14454 <span class="comment">    /**</span>
<a name="l14455"></a>14455 <span class="comment">     * Verical Mirroring.</span>
<a name="l14456"></a>14456 <span class="comment">     * @param $y (int) ordinate of the point. Default is current y position</span>
<a name="l14457"></a>14457 <span class="comment">     * @public</span>
<a name="l14458"></a>14458 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14459"></a>14459 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14460"></a>14460 <span class="comment">     */</span>
<a name="l14461"></a><a class="code" href="classTCPDF.html#a06342f489c3f60c456c95a825217629b">14461</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a06342f489c3f60c456c95a825217629b" title="Verical Mirroring.">MirrorV</a>($y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14462"></a>14462         $this-&gt;Scale(100, -100, <span class="stringliteral">&#39;&#39;</span>, $y);
<a name="l14463"></a>14463     }
<a name="l14464"></a>14464 <span class="comment"></span>
<a name="l14465"></a>14465 <span class="comment">    /**</span>
<a name="l14466"></a>14466 <span class="comment">     * Point reflection mirroring.</span>
<a name="l14467"></a>14467 <span class="comment">     * @param $x (int) abscissa of the point. Default is current x position</span>
<a name="l14468"></a>14468 <span class="comment">     * @param $y (int) ordinate of the point. Default is current y position</span>
<a name="l14469"></a>14469 <span class="comment">     * @public</span>
<a name="l14470"></a>14470 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14471"></a>14471 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14472"></a>14472 <span class="comment">     */</span>
<a name="l14473"></a><a class="code" href="classTCPDF.html#aa41b8f844cab4dccdfa5f34cb667c46a">14473</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa41b8f844cab4dccdfa5f34cb667c46a" title="Point reflection mirroring.">MirrorP</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>,$y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14474"></a>14474         $this-&gt;Scale(-100, -100, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l14475"></a>14475     }
<a name="l14476"></a>14476 <span class="comment"></span>
<a name="l14477"></a>14477 <span class="comment">    /**</span>
<a name="l14478"></a>14478 <span class="comment">     * Reflection against a straight line through point (x, y) with the gradient angle (angle).</span>
<a name="l14479"></a>14479 <span class="comment">     * @param $angle (float) gradient angle of the straight line. Default is 0 (horizontal line).</span>
<a name="l14480"></a>14480 <span class="comment">     * @param $x (int) abscissa of the point. Default is current x position</span>
<a name="l14481"></a>14481 <span class="comment">     * @param $y (int) ordinate of the point. Default is current y position</span>
<a name="l14482"></a>14482 <span class="comment">     * @public</span>
<a name="l14483"></a>14483 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14484"></a>14484 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14485"></a>14485 <span class="comment">     */</span>
<a name="l14486"></a><a class="code" href="classTCPDF.html#ad19f623e09f67dd7fbd433196f804ec1">14486</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad19f623e09f67dd7fbd433196f804ec1" title="Reflection against a straight line through point (x, y) with the gradient angle (angle).">MirrorL</a>($angle=0, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>,$y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14487"></a>14487         $this-&gt;Scale(-100, 100, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l14488"></a>14488         $this-&gt;Rotate(-2*($angle-90), <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l14489"></a>14489     }
<a name="l14490"></a>14490 <span class="comment"></span>
<a name="l14491"></a>14491 <span class="comment">    /**</span>
<a name="l14492"></a>14492 <span class="comment">     * Translate graphic object horizontally.</span>
<a name="l14493"></a>14493 <span class="comment">     * @param $t_x (int) movement to the right (or left for RTL)</span>
<a name="l14494"></a>14494 <span class="comment">     * @public</span>
<a name="l14495"></a>14495 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14496"></a>14496 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14497"></a>14497 <span class="comment">     */</span>
<a name="l14498"></a><a class="code" href="classTCPDF.html#a215c81355915eff7d0c1586013591b75">14498</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a215c81355915eff7d0c1586013591b75" title="Translate graphic object horizontally.">TranslateX</a>($t_x) {
<a name="l14499"></a>14499         $this-&gt;Translate($t_x, 0);
<a name="l14500"></a>14500     }
<a name="l14501"></a>14501 <span class="comment"></span>
<a name="l14502"></a>14502 <span class="comment">    /**</span>
<a name="l14503"></a>14503 <span class="comment">     * Translate graphic object vertically.</span>
<a name="l14504"></a>14504 <span class="comment">     * @param $t_y (int) movement to the bottom</span>
<a name="l14505"></a>14505 <span class="comment">     * @public</span>
<a name="l14506"></a>14506 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14507"></a>14507 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14508"></a>14508 <span class="comment">     */</span>
<a name="l14509"></a><a class="code" href="classTCPDF.html#aa853a06ba07b77833755b83194f1fb1e">14509</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa853a06ba07b77833755b83194f1fb1e" title="Translate graphic object vertically.">TranslateY</a>($t_y) {
<a name="l14510"></a>14510         $this-&gt;Translate(0, $t_y);
<a name="l14511"></a>14511     }
<a name="l14512"></a>14512 <span class="comment"></span>
<a name="l14513"></a>14513 <span class="comment">    /**</span>
<a name="l14514"></a>14514 <span class="comment">     * Translate graphic object horizontally and vertically.</span>
<a name="l14515"></a>14515 <span class="comment">     * @param $t_x (int) movement to the right</span>
<a name="l14516"></a>14516 <span class="comment">     * @param $t_y (int) movement to the bottom</span>
<a name="l14517"></a>14517 <span class="comment">     * @public</span>
<a name="l14518"></a>14518 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14519"></a>14519 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14520"></a>14520 <span class="comment">     */</span>
<a name="l14521"></a><a class="code" href="classTCPDF.html#a458fb5ffaa345608b1346a38fdbbb096">14521</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a458fb5ffaa345608b1346a38fdbbb096" title="Translate graphic object horizontally and vertically.">Translate</a>($t_x, $t_y) {
<a name="l14522"></a>14522         <span class="comment">//calculate elements of transformation matrix</span>
<a name="l14523"></a>14523         $tm = array();
<a name="l14524"></a>14524         $tm[0] = 1;
<a name="l14525"></a>14525         $tm[1] = 0;
<a name="l14526"></a>14526         $tm[2] = 0;
<a name="l14527"></a>14527         $tm[3] = 1;
<a name="l14528"></a>14528         $tm[4] = $t_x * $this-&gt;k;
<a name="l14529"></a>14529         $tm[5] = -$t_y * $this-&gt;k;
<a name="l14530"></a>14530         <span class="comment">//translate the coordinate system</span>
<a name="l14531"></a>14531         $this-&gt;Transform($tm);
<a name="l14532"></a>14532     }
<a name="l14533"></a>14533 <span class="comment"></span>
<a name="l14534"></a>14534 <span class="comment">    /**</span>
<a name="l14535"></a>14535 <span class="comment">     * Rotate object.</span>
<a name="l14536"></a>14536 <span class="comment">     * @param $angle (float) angle in degrees for counter-clockwise rotation</span>
<a name="l14537"></a>14537 <span class="comment">     * @param $x (int) abscissa of the rotation center. Default is current x position</span>
<a name="l14538"></a>14538 <span class="comment">     * @param $y (int) ordinate of the rotation center. Default is current y position</span>
<a name="l14539"></a>14539 <span class="comment">     * @public</span>
<a name="l14540"></a>14540 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14541"></a>14541 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14542"></a>14542 <span class="comment">     */</span>
<a name="l14543"></a><a class="code" href="classTCPDF.html#aef1e19d18b0a82b1c45b53d3f17ae2b5">14543</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aef1e19d18b0a82b1c45b53d3f17ae2b5" title="Rotate object.">Rotate</a>($angle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14544"></a>14544         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l14545"></a>14545             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l14546"></a>14546         }
<a name="l14547"></a>14547         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l14548"></a>14548             $y = $this-&gt;y;
<a name="l14549"></a>14549         }
<a name="l14550"></a>14550         $y = ($this-&gt;h - $y) * $this-&gt;k;
<a name="l14551"></a>14551         <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> *= $this-&gt;k;
<a name="l14552"></a>14552         <span class="comment">//calculate elements of transformation matrix</span>
<a name="l14553"></a>14553         $tm = array();
<a name="l14554"></a>14554         $tm[0] = cos(deg2rad($angle));
<a name="l14555"></a>14555         $tm[1] = sin(deg2rad($angle));
<a name="l14556"></a>14556         $tm[2] = -$tm[1];
<a name="l14557"></a>14557         $tm[3] = $tm[0];
<a name="l14558"></a>14558         $tm[4] = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + ($tm[1] * $y) - ($tm[0] * <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>);
<a name="l14559"></a>14559         $tm[5] = $y - ($tm[0] * $y) - ($tm[1] * $x);
<a name="l14560"></a>14560         <span class="comment">//rotate the coordinate system around ($x,$y)</span>
<a name="l14561"></a>14561         $this-&gt;Transform($tm);
<a name="l14562"></a>14562     }
<a name="l14563"></a>14563 <span class="comment"></span>
<a name="l14564"></a>14564 <span class="comment">    /**</span>
<a name="l14565"></a>14565 <span class="comment">     * Skew horizontally.</span>
<a name="l14566"></a>14566 <span class="comment">     * @param $angle_x (float) angle in degrees between -90 (skew to the left) and 90 (skew to the right)</span>
<a name="l14567"></a>14567 <span class="comment">     * @param $x (int) abscissa of the skewing center. default is current x position</span>
<a name="l14568"></a>14568 <span class="comment">     * @param $y (int) ordinate of the skewing center. default is current y position</span>
<a name="l14569"></a>14569 <span class="comment">     * @public</span>
<a name="l14570"></a>14570 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14571"></a>14571 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14572"></a>14572 <span class="comment">     */</span>
<a name="l14573"></a><a class="code" href="classTCPDF.html#abb40c80af416b4d177860872f5b27758">14573</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#abb40c80af416b4d177860872f5b27758" title="Skew horizontally.">SkewX</a>($angle_x, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14574"></a>14574         $this-&gt;Skew($angle_x, 0, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l14575"></a>14575     }
<a name="l14576"></a>14576 <span class="comment"></span>
<a name="l14577"></a>14577 <span class="comment">    /**</span>
<a name="l14578"></a>14578 <span class="comment">     * Skew vertically.</span>
<a name="l14579"></a>14579 <span class="comment">     * @param $angle_y (float) angle in degrees between -90 (skew to the bottom) and 90 (skew to the top)</span>
<a name="l14580"></a>14580 <span class="comment">     * @param $x (int) abscissa of the skewing center. default is current x position</span>
<a name="l14581"></a>14581 <span class="comment">     * @param $y (int) ordinate of the skewing center. default is current y position</span>
<a name="l14582"></a>14582 <span class="comment">     * @public</span>
<a name="l14583"></a>14583 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14584"></a>14584 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14585"></a>14585 <span class="comment">     */</span>
<a name="l14586"></a><a class="code" href="classTCPDF.html#a6563f6f3fb785efb230ee37719cf76f9">14586</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6563f6f3fb785efb230ee37719cf76f9" title="Skew vertically.">SkewY</a>($angle_y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14587"></a>14587         $this-&gt;Skew(0, $angle_y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l14588"></a>14588     }
<a name="l14589"></a>14589 <span class="comment"></span>
<a name="l14590"></a>14590 <span class="comment">    /**</span>
<a name="l14591"></a>14591 <span class="comment">     * Skew.</span>
<a name="l14592"></a>14592 <span class="comment">     * @param $angle_x (float) angle in degrees between -90 (skew to the left) and 90 (skew to the right)</span>
<a name="l14593"></a>14593 <span class="comment">     * @param $angle_y (float) angle in degrees between -90 (skew to the bottom) and 90 (skew to the top)</span>
<a name="l14594"></a>14594 <span class="comment">     * @param $x (int) abscissa of the skewing center. default is current x position</span>
<a name="l14595"></a>14595 <span class="comment">     * @param $y (int) ordinate of the skewing center. default is current y position</span>
<a name="l14596"></a>14596 <span class="comment">     * @public</span>
<a name="l14597"></a>14597 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14598"></a>14598 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14599"></a>14599 <span class="comment">     */</span>
<a name="l14600"></a><a class="code" href="classTCPDF.html#a979b6d066b2a0a5cc1496907bc9841e6">14600</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a979b6d066b2a0a5cc1496907bc9841e6" title="Skew.">Skew</a>($angle_x, $angle_y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l14601"></a>14601         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l14602"></a>14602             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l14603"></a>14603         }
<a name="l14604"></a>14604         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l14605"></a>14605             $y = $this-&gt;y;
<a name="l14606"></a>14606         }
<a name="l14607"></a>14607         <span class="keywordflow">if</span> (($angle_x &lt;= -90) OR ($angle_x &gt;= 90) OR ($angle_y &lt;= -90) OR ($angle_y &gt;= 90)) {
<a name="l14608"></a>14608             $this-&gt;Error(<span class="stringliteral">&#39;Please use values between -90 and +90 degrees for Skewing.&#39;</span>);
<a name="l14609"></a>14609         }
<a name="l14610"></a>14610         <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> *= $this-&gt;k;
<a name="l14611"></a>14611         $y = ($this-&gt;h - $y) * $this-&gt;k;
<a name="l14612"></a>14612         <span class="comment">//calculate elements of transformation matrix</span>
<a name="l14613"></a>14613         $tm = array();
<a name="l14614"></a>14614         $tm[0] = 1;
<a name="l14615"></a>14615         $tm[1] = tan(deg2rad($angle_y));
<a name="l14616"></a>14616         $tm[2] = tan(deg2rad($angle_x));
<a name="l14617"></a>14617         $tm[3] = 1;
<a name="l14618"></a>14618         $tm[4] = -$tm[2] * $y;
<a name="l14619"></a>14619         $tm[5] = -$tm[1] * <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l14620"></a>14620         <span class="comment">//skew the coordinate system</span>
<a name="l14621"></a>14621         $this-&gt;Transform($tm);
<a name="l14622"></a>14622     }
<a name="l14623"></a>14623 <span class="comment"></span>
<a name="l14624"></a>14624 <span class="comment">    /**</span>
<a name="l14625"></a>14625 <span class="comment">     * Apply graphic transformations.</span>
<a name="l14626"></a>14626 <span class="comment">     * @param $tm (array) transformation matrix</span>
<a name="l14627"></a>14627 <span class="comment">     * @protected</span>
<a name="l14628"></a>14628 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14629"></a>14629 <span class="comment">     * @see StartTransform(), StopTransform()</span>
<a name="l14630"></a>14630 <span class="comment">     */</span>
<a name="l14631"></a><a class="code" href="classTCPDF.html#a647e9da3d08df82049ad403508fe247b">14631</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a647e9da3d08df82049ad403508fe247b" title="Apply graphic transformations.">Transform</a>($tm) {
<a name="l14632"></a>14632         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F %.3F %.3F %.3F cm&#39;</span>, $tm[0], $tm[1], $tm[2], $tm[3], $tm[4], $tm[5]));
<a name="l14633"></a>14633         <span class="comment">// add tranformation matrix</span>
<a name="l14634"></a>14634         $this-&gt;transfmatrix[$this-&gt;transfmatrix_key][] = array(<span class="charliteral">&#39;a&#39;</span> =&gt; $tm[0], <span class="charliteral">&#39;b&#39;</span> =&gt; $tm[1], <span class="charliteral">&#39;c&#39;</span> =&gt; $tm[2], <span class="charliteral">&#39;d&#39;</span> =&gt; $tm[3], <span class="charliteral">&#39;e&#39;</span> =&gt; $tm[4], <span class="charliteral">&#39;f&#39;</span> =&gt; $tm[5]);
<a name="l14635"></a>14635         <span class="comment">// update transformation mark</span>
<a name="l14636"></a>14636         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l14637"></a>14637             <span class="comment">// we are inside an XObject template</span>
<a name="l14638"></a>14638             <span class="keywordflow">if</span> (end($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]) !== <span class="keyword">false</span>) {
<a name="l14639"></a>14639                 $key = key($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);
<a name="l14640"></a>14640                 $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][$key] = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);
<a name="l14641"></a>14641             }
<a name="l14642"></a>14642         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (end($this-&gt;transfmrk[$this-&gt;page]) !== <span class="keyword">false</span>) {
<a name="l14643"></a>14643             $key = key($this-&gt;transfmrk[$this-&gt;page]);
<a name="l14644"></a>14644             $this-&gt;transfmrk[$this-&gt;page][$key] = $this-&gt;pagelen[$this-&gt;page];
<a name="l14645"></a>14645         }
<a name="l14646"></a>14646     }
<a name="l14647"></a>14647 
<a name="l14648"></a>14648     <span class="comment">// END TRANSFORMATIONS SECTION -------------------------</span>
<a name="l14649"></a>14649 
<a name="l14650"></a>14650     <span class="comment">// START GRAPHIC FUNCTIONS SECTION ---------------------</span>
<a name="l14651"></a>14651     <span class="comment">// The following section is based on the code provided by David Hernandez Sanz</span>
<a name="l14652"></a>14652 <span class="comment"></span>
<a name="l14653"></a>14653 <span class="comment">    /**</span>
<a name="l14654"></a>14654 <span class="comment">     * Defines the line width. By default, the value equals 0.2 mm. The method can be called before the first page is created and the value is retained from page to page.</span>
<a name="l14655"></a>14655 <span class="comment">     * @param $width (float) The width.</span>
<a name="l14656"></a>14656 <span class="comment">     * @public</span>
<a name="l14657"></a>14657 <span class="comment">     * @since 1.0</span>
<a name="l14658"></a>14658 <span class="comment">     * @see Line(), Rect(), Cell(), MultiCell()</span>
<a name="l14659"></a>14659 <span class="comment">     */</span>
<a name="l14660"></a><a class="code" href="classTCPDF.html#a0ef34c0ce76bd8e4671da42b3588d9b6">14660</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0ef34c0ce76bd8e4671da42b3588d9b6" title="Defines the line width.">SetLineWidth</a>($width) {
<a name="l14661"></a>14661         <span class="comment">//Set line width</span>
<a name="l14662"></a>14662         $this-&gt;LineWidth = $width;
<a name="l14663"></a>14663         $this-&gt;linestyleWidth = sprintf(<span class="stringliteral">&#39;%.2F w&#39;</span>, ($width * $this-&gt;k));
<a name="l14664"></a>14664         <span class="keywordflow">if</span> ($this-&gt;page &gt; 0) {
<a name="l14665"></a>14665             $this-&gt;_out($this-&gt;linestyleWidth);
<a name="l14666"></a>14666         }
<a name="l14667"></a>14667     }
<a name="l14668"></a>14668 <span class="comment"></span>
<a name="l14669"></a>14669 <span class="comment">    /**</span>
<a name="l14670"></a>14670 <span class="comment">     * Returns the current the line width.</span>
<a name="l14671"></a>14671 <span class="comment">     * @return int Line width</span>
<a name="l14672"></a>14672 <span class="comment">     * @public</span>
<a name="l14673"></a>14673 <span class="comment">     * @since 2.1.000 (2008-01-07)</span>
<a name="l14674"></a>14674 <span class="comment">     * @see Line(), SetLineWidth()</span>
<a name="l14675"></a>14675 <span class="comment">     */</span>
<a name="l14676"></a><a class="code" href="classTCPDF.html#a9dd28e7bb04ba8f881492d06f501bce5">14676</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9dd28e7bb04ba8f881492d06f501bce5" title="Returns the current the line width.">GetLineWidth</a>() {
<a name="l14677"></a>14677         <span class="keywordflow">return</span> $this-&gt;LineWidth;
<a name="l14678"></a>14678     }
<a name="l14679"></a>14679 <span class="comment"></span>
<a name="l14680"></a>14680 <span class="comment">    /**</span>
<a name="l14681"></a>14681 <span class="comment">     * Set line style.</span>
<a name="l14682"></a>14682 <span class="comment">     * @param $style (array) Line style. Array with keys among the following:</span>
<a name="l14683"></a>14683 <span class="comment">     * &lt;ul&gt;</span>
<a name="l14684"></a>14684 <span class="comment">     *   &lt;li&gt;width (float): Width of the line in user units.&lt;/li&gt;</span>
<a name="l14685"></a>14685 <span class="comment">     *   &lt;li&gt;cap (string): Type of cap to put on the line. Possible values are:</span>
<a name="l14686"></a>14686 <span class="comment">     * butt, round, square. The difference between &quot;square&quot; and &quot;butt&quot; is that</span>
<a name="l14687"></a>14687 <span class="comment">     * &quot;square&quot; projects a flat end past the end of the line.&lt;/li&gt;</span>
<a name="l14688"></a>14688 <span class="comment">     *   &lt;li&gt;join (string): Type of join. Possible values are: miter, round,</span>
<a name="l14689"></a>14689 <span class="comment">     * bevel.&lt;/li&gt;</span>
<a name="l14690"></a>14690 <span class="comment">     *   &lt;li&gt;dash (mixed): Dash pattern. Is 0 (without dash) or string with</span>
<a name="l14691"></a>14691 <span class="comment">     * series of length values, which are the lengths of the on and off dashes.</span>
<a name="l14692"></a>14692 <span class="comment">     * For example: &quot;2&quot; represents 2 on, 2 off, 2 on, 2 off, ...; &quot;2,1&quot; is 2 on,</span>
<a name="l14693"></a>14693 <span class="comment">     * 1 off, 2 on, 1 off, ...&lt;/li&gt;</span>
<a name="l14694"></a>14694 <span class="comment">     *   &lt;li&gt;phase (integer): Modifier on the dash pattern which is used to shift</span>
<a name="l14695"></a>14695 <span class="comment">     * the point at which the pattern starts.&lt;/li&gt;</span>
<a name="l14696"></a>14696 <span class="comment">     *   &lt;li&gt;color (array): Draw color. Format: array(GREY) or array(R,G,B) or array(C,M,Y,K).&lt;/li&gt;</span>
<a name="l14697"></a>14697 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l14698"></a>14698 <span class="comment">     * @param $ret (boolean) if true do not send the command.</span>
<a name="l14699"></a>14699 <span class="comment">     * @return string the PDF command</span>
<a name="l14700"></a>14700 <span class="comment">     * @public</span>
<a name="l14701"></a>14701 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l14702"></a>14702 <span class="comment">     */</span>
<a name="l14703"></a><a class="code" href="classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">14703</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148" title="Set line style.">SetLineStyle</a>($style, $ret=<span class="keyword">false</span>) {
<a name="l14704"></a>14704         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// string to be returned</span>
<a name="l14705"></a>14705         <span class="keywordflow">if</span> (!is_array($style)) {
<a name="l14706"></a>14706             <span class="keywordflow">return</span>;
<a name="l14707"></a>14707         }
<a name="l14708"></a>14708         <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;width&#39;</span>])) {
<a name="l14709"></a>14709             $this-&gt;LineWidth = $style[<span class="stringliteral">&#39;width&#39;</span>];
<a name="l14710"></a>14710             $this-&gt;linestyleWidth = sprintf(<span class="stringliteral">&#39;%.2F w&#39;</span>, ($style[<span class="stringliteral">&#39;width&#39;</span>] * $this-&gt;k));
<a name="l14711"></a>14711             <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= $this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>;
<a name="l14712"></a>14712         }
<a name="l14713"></a>14713         <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;cap&#39;</span>])) {
<a name="l14714"></a>14714             $ca = array(<span class="stringliteral">&#39;butt&#39;</span> =&gt; 0, <span class="stringliteral">&#39;round&#39;</span>=&gt; 1, <span class="stringliteral">&#39;square&#39;</span> =&gt; 2);
<a name="l14715"></a>14715             <span class="keywordflow">if</span> (isset($ca[$style[<span class="stringliteral">&#39;cap&#39;</span>]])) {
<a name="l14716"></a>14716                 $this-&gt;linestyleCap = $ca[$style[<span class="stringliteral">&#39;cap&#39;</span>]].<span class="stringliteral">&#39; J&#39;</span>;
<a name="l14717"></a>14717                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= $this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>;
<a name="l14718"></a>14718             }
<a name="l14719"></a>14719         }
<a name="l14720"></a>14720         <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;join&#39;</span>])) {
<a name="l14721"></a>14721             $ja = array(<span class="stringliteral">&#39;miter&#39;</span> =&gt; 0, <span class="stringliteral">&#39;round&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bevel&#39;</span> =&gt; 2);
<a name="l14722"></a>14722             <span class="keywordflow">if</span> (isset($ja[$style[<span class="stringliteral">&#39;join&#39;</span>]])) {
<a name="l14723"></a>14723                 $this-&gt;linestyleJoin = $ja[$style[<span class="stringliteral">&#39;join&#39;</span>]].<span class="stringliteral">&#39; j&#39;</span>;
<a name="l14724"></a>14724                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= $this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>;
<a name="l14725"></a>14725             }
<a name="l14726"></a>14726         }
<a name="l14727"></a>14727         <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;dash&#39;</span>])) {
<a name="l14728"></a>14728             $dash_string = <span class="stringliteral">&#39;&#39;</span>;
<a name="l14729"></a>14729             <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;dash&#39;</span>]) {
<a name="l14730"></a>14730                 <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^.+,/&#39;</span>, $style[<span class="stringliteral">&#39;dash&#39;</span>]) &gt; 0) {
<a name="l14731"></a>14731                     <a class="code" href="docsql_8php.html#aa9d9497a56b9edbe1cafc34dbf44c21b" title="We need relations enabled and we work only on database.">$tab</a> = explode(<span class="charliteral">&#39;,&#39;</span>, $style[<span class="stringliteral">&#39;dash&#39;</span>]);
<a name="l14732"></a>14732                 } <span class="keywordflow">else</span> {
<a name="l14733"></a>14733                     <a class="code" href="docsql_8php.html#aa9d9497a56b9edbe1cafc34dbf44c21b" title="We need relations enabled and we work only on database.">$tab</a> = array($style[<span class="stringliteral">&#39;dash&#39;</span>]);
<a name="l14734"></a>14734                 }
<a name="l14735"></a>14735                 $dash_string = <span class="stringliteral">&#39;&#39;</span>;
<a name="l14736"></a>14736                 <span class="keywordflow">foreach</span> (<a class="code" href="docsql_8php.html#aa9d9497a56b9edbe1cafc34dbf44c21b" title="We need relations enabled and we work only on database.">$tab</a> as <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> =&gt; $v) {
<a name="l14737"></a>14737                     <span class="keywordflow">if</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l14738"></a>14738                         $dash_string .= <span class="charliteral">&#39; &#39;</span>;
<a name="l14739"></a>14739                     }
<a name="l14740"></a>14740                     $dash_string .= sprintf(<span class="stringliteral">&#39;%.2F&#39;</span>, $v);
<a name="l14741"></a>14741                 }
<a name="l14742"></a>14742             }
<a name="l14743"></a>14743             <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;phase&#39;</span>]) OR !$style[<span class="stringliteral">&#39;dash&#39;</span>]) {
<a name="l14744"></a>14744                 $style[<span class="stringliteral">&#39;phase&#39;</span>] = 0;
<a name="l14745"></a>14745             }
<a name="l14746"></a>14746             $this-&gt;linestyleDash = sprintf(<span class="stringliteral">&#39;[%s] %.2F d&#39;</span>, $dash_string, $style[<span class="stringliteral">&#39;phase&#39;</span>]);
<a name="l14747"></a>14747             <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= $this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>;
<a name="l14748"></a>14748         }
<a name="l14749"></a>14749         <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;color&#39;</span>])) {
<a name="l14750"></a>14750             <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= $this-&gt;SetDrawColorArray($style[<span class="stringliteral">&#39;color&#39;</span>], <span class="keyword">true</span>).<span class="charliteral">&#39; &#39;</span>;
<a name="l14751"></a>14751         }
<a name="l14752"></a>14752         <span class="keywordflow">if</span> (!$ret) {
<a name="l14753"></a>14753             $this-&gt;_out(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l14754"></a>14754         }
<a name="l14755"></a>14755         <span class="keywordflow">return</span> <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>;
<a name="l14756"></a>14756     }
<a name="l14757"></a>14757 <span class="comment"></span>
<a name="l14758"></a>14758 <span class="comment">    /**</span>
<a name="l14759"></a>14759 <span class="comment">     * Begin a new subpath by moving the current point to coordinates (x, y), omitting any connecting line segment.</span>
<a name="l14760"></a>14760 <span class="comment">     * @param $x (float) Abscissa of point.</span>
<a name="l14761"></a>14761 <span class="comment">     * @param $y (float) Ordinate of point.</span>
<a name="l14762"></a>14762 <span class="comment">     * @protected</span>
<a name="l14763"></a>14763 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l14764"></a>14764 <span class="comment">     */</span>
<a name="l14765"></a><a class="code" href="classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">14765</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469" title="Begin a new subpath by moving the current point to coordinates (x, y), omitting any connecting line s...">_outPoint</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) {
<a name="l14766"></a>14766         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.2F %.2F m&#39;</span>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * $this-&gt;k, ($this-&gt;h - $y) * $this-&gt;k));
<a name="l14767"></a>14767     }
<a name="l14768"></a>14768 <span class="comment"></span>
<a name="l14769"></a>14769 <span class="comment">    /**</span>
<a name="l14770"></a>14770 <span class="comment">     * Append a straight line segment from the current point to the point (x, y).</span>
<a name="l14771"></a>14771 <span class="comment">     * The new current point shall be (x, y).</span>
<a name="l14772"></a>14772 <span class="comment">     * @param $x (float) Abscissa of end point.</span>
<a name="l14773"></a>14773 <span class="comment">     * @param $y (float) Ordinate of end point.</span>
<a name="l14774"></a>14774 <span class="comment">     * @protected</span>
<a name="l14775"></a>14775 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l14776"></a>14776 <span class="comment">     */</span>
<a name="l14777"></a><a class="code" href="classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">14777</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af5e5357f5db0128c824f0a22cab63719" title="Append a straight line segment from the current point to the point (x, y).">_outLine</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) {
<a name="l14778"></a>14778         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.2F %.2F l&#39;</span>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * $this-&gt;k, ($this-&gt;h - $y) * $this-&gt;k));
<a name="l14779"></a>14779     }
<a name="l14780"></a>14780 <span class="comment"></span>
<a name="l14781"></a>14781 <span class="comment">    /**</span>
<a name="l14782"></a>14782 <span class="comment">     * Append a rectangle to the current path as a complete subpath, with lower-left corner (x, y) and dimensions widthand height in user space.</span>
<a name="l14783"></a>14783 <span class="comment">     * @param $x (float) Abscissa of upper-left corner.</span>
<a name="l14784"></a>14784 <span class="comment">     * @param $y (float) Ordinate of upper-left corner.</span>
<a name="l14785"></a>14785 <span class="comment">     * @param $w (float) Width.</span>
<a name="l14786"></a>14786 <span class="comment">     * @param $h (float) Height.</span>
<a name="l14787"></a>14787 <span class="comment">     * @param $op (string) options</span>
<a name="l14788"></a>14788 <span class="comment">     * @protected</span>
<a name="l14789"></a>14789 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l14790"></a>14790 <span class="comment">     */</span>
<a name="l14791"></a><a class="code" href="classTCPDF.html#aacc2ee9f1c08cda7c71f2a203ed9d6c2">14791</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aacc2ee9f1c08cda7c71f2a203ed9d6c2" title="Append a rectangle to the current path as a complete subpath, with lower-left corner (x...">_outRect</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $op) {
<a name="l14792"></a>14792         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F re %s&#39;</span>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * $this-&gt;k, ($this-&gt;h - $y) * $this-&gt;k, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $this-&gt;k, -<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> * $this-&gt;k, $op));
<a name="l14793"></a>14793     }
<a name="l14794"></a>14794 <span class="comment"></span>
<a name="l14795"></a>14795 <span class="comment">    /**</span>
<a name="l14796"></a>14796 <span class="comment">     * Append a cubic Bézier curve to the current path. The curve shall extend from the current point to the point (x3, y3), using (x1, y1) and (x2, y2) as the Bézier control points.</span>
<a name="l14797"></a>14797 <span class="comment">     * The new current point shall be (x3, y3).</span>
<a name="l14798"></a>14798 <span class="comment">     * @param $x1 (float) Abscissa of control point 1.</span>
<a name="l14799"></a>14799 <span class="comment">     * @param $y1 (float) Ordinate of control point 1.</span>
<a name="l14800"></a>14800 <span class="comment">     * @param $x2 (float) Abscissa of control point 2.</span>
<a name="l14801"></a>14801 <span class="comment">     * @param $y2 (float) Ordinate of control point 2.</span>
<a name="l14802"></a>14802 <span class="comment">     * @param $x3 (float) Abscissa of end point.</span>
<a name="l14803"></a>14803 <span class="comment">     * @param $y3 (float) Ordinate of end point.</span>
<a name="l14804"></a>14804 <span class="comment">     * @protected</span>
<a name="l14805"></a>14805 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l14806"></a>14806 <span class="comment">     */</span>
<a name="l14807"></a><a class="code" href="classTCPDF.html#a90efde54832587803c17467bfff03038">14807</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a90efde54832587803c17467bfff03038" title="Append a cubic Bézier curve to the current path.">_outCurve</a>($x1, $y1, $x2, $y2, $x3, $y3) {
<a name="l14808"></a>14808         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F %.2F %.2F c&#39;</span>, $x1 * $this-&gt;k, ($this-&gt;h - $y1) * $this-&gt;k, $x2 * $this-&gt;k, ($this-&gt;h - $y2) * $this-&gt;k, $x3 * $this-&gt;k, ($this-&gt;h - $y3) * $this-&gt;k));
<a name="l14809"></a>14809     }
<a name="l14810"></a>14810 <span class="comment"></span>
<a name="l14811"></a>14811 <span class="comment">    /**</span>
<a name="l14812"></a>14812 <span class="comment">     * Append a cubic Bézier curve to the current path. The curve shall extend from the current point to the point (x3, y3), using the current point and (x2, y2) as the Bézier control points.</span>
<a name="l14813"></a>14813 <span class="comment">     * The new current point shall be (x3, y3).</span>
<a name="l14814"></a>14814 <span class="comment">     * @param $x2 (float) Abscissa of control point 2.</span>
<a name="l14815"></a>14815 <span class="comment">     * @param $y2 (float) Ordinate of control point 2.</span>
<a name="l14816"></a>14816 <span class="comment">     * @param $x3 (float) Abscissa of end point.</span>
<a name="l14817"></a>14817 <span class="comment">     * @param $y3 (float) Ordinate of end point.</span>
<a name="l14818"></a>14818 <span class="comment">     * @protected</span>
<a name="l14819"></a>14819 <span class="comment">     * @since 4.9.019 (2010-04-26)</span>
<a name="l14820"></a>14820 <span class="comment">     */</span>
<a name="l14821"></a><a class="code" href="classTCPDF.html#a5f1c38efd67c4e1d70a40f13a7b286bb">14821</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5f1c38efd67c4e1d70a40f13a7b286bb" title="Append a cubic Bézier curve to the current path.">_outCurveV</a>($x2, $y2, $x3, $y3) {
<a name="l14822"></a>14822         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F v&#39;</span>, $x2 * $this-&gt;k, ($this-&gt;h - $y2) * $this-&gt;k, $x3 * $this-&gt;k, ($this-&gt;h - $y3) * $this-&gt;k));
<a name="l14823"></a>14823     }
<a name="l14824"></a>14824 <span class="comment"></span>
<a name="l14825"></a>14825 <span class="comment">    /**</span>
<a name="l14826"></a>14826 <span class="comment">     * Append a cubic Bézier curve to the current path. The curve shall extend from the current point to the point (x3, y3), using (x1, y1) and (x3, y3) as the Bézier control points.</span>
<a name="l14827"></a>14827 <span class="comment">     * The new current point shall be (x3, y3).</span>
<a name="l14828"></a>14828 <span class="comment">     * @param $x1 (float) Abscissa of control point 1.</span>
<a name="l14829"></a>14829 <span class="comment">     * @param $y1 (float) Ordinate of control point 1.</span>
<a name="l14830"></a>14830 <span class="comment">     * @param $x3 (float) Abscissa of end point.</span>
<a name="l14831"></a>14831 <span class="comment">     * @param $y3 (float) Ordinate of end point.</span>
<a name="l14832"></a>14832 <span class="comment">     * @protected</span>
<a name="l14833"></a>14833 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l14834"></a>14834 <span class="comment">     */</span>
<a name="l14835"></a><a class="code" href="classTCPDF.html#afc90d19ade9358676bbde3633db5d808">14835</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#afc90d19ade9358676bbde3633db5d808" title="Append a cubic Bézier curve to the current path.">_outCurveY</a>($x1, $y1, $x3, $y3) {
<a name="l14836"></a>14836         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F y&#39;</span>, $x1 * $this-&gt;k, ($this-&gt;h - $y1) * $this-&gt;k, $x3 * $this-&gt;k, ($this-&gt;h - $y3) * $this-&gt;k));
<a name="l14837"></a>14837     }
<a name="l14838"></a>14838 <span class="comment"></span>
<a name="l14839"></a>14839 <span class="comment">    /**</span>
<a name="l14840"></a>14840 <span class="comment">     * Draws a line between two points.</span>
<a name="l14841"></a>14841 <span class="comment">     * @param $x1 (float) Abscissa of first point.</span>
<a name="l14842"></a>14842 <span class="comment">     * @param $y1 (float) Ordinate of first point.</span>
<a name="l14843"></a>14843 <span class="comment">     * @param $x2 (float) Abscissa of second point.</span>
<a name="l14844"></a>14844 <span class="comment">     * @param $y2 (float) Ordinate of second point.</span>
<a name="l14845"></a>14845 <span class="comment">     * @param $style (array) Line style. Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l14846"></a>14846 <span class="comment">     * @public</span>
<a name="l14847"></a>14847 <span class="comment">     * @since 1.0</span>
<a name="l14848"></a>14848 <span class="comment">     * @see SetLineWidth(), SetDrawColor(), SetLineStyle()</span>
<a name="l14849"></a>14849 <span class="comment">     */</span>
<a name="l14850"></a><a class="code" href="classTCPDF.html#a89c0fac95da962719ba92b057df9c201">14850</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a89c0fac95da962719ba92b057df9c201" title="Draws a line between two points.">Line</a>($x1, $y1, $x2, $y2, $style=array()) {
<a name="l14851"></a>14851         <span class="keywordflow">if</span> (is_array($style)) {
<a name="l14852"></a>14852             $this-&gt;SetLineStyle($style);
<a name="l14853"></a>14853         }
<a name="l14854"></a>14854         $this-&gt;_outPoint($x1, $y1);
<a name="l14855"></a>14855         $this-&gt;_outLine($x2, $y2);
<a name="l14856"></a>14856         $this-&gt;_out(<span class="charliteral">&#39;S&#39;</span>);
<a name="l14857"></a>14857     }
<a name="l14858"></a>14858 <span class="comment"></span>
<a name="l14859"></a>14859 <span class="comment">    /**</span>
<a name="l14860"></a>14860 <span class="comment">     * Draws a rectangle.</span>
<a name="l14861"></a>14861 <span class="comment">     * @param $x (float) Abscissa of upper-left corner.</span>
<a name="l14862"></a>14862 <span class="comment">     * @param $y (float) Ordinate of upper-left corner.</span>
<a name="l14863"></a>14863 <span class="comment">     * @param $w (float) Width.</span>
<a name="l14864"></a>14864 <span class="comment">     * @param $h (float) Height.</span>
<a name="l14865"></a>14865 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l14866"></a>14866 <span class="comment">     * @param $border_style (array) Border style of rectangle. Array with keys among the following:</span>
<a name="l14867"></a>14867 <span class="comment">     * &lt;ul&gt;</span>
<a name="l14868"></a>14868 <span class="comment">     *   &lt;li&gt;all: Line style of all borders. Array like for SetLineStyle().&lt;/li&gt;</span>
<a name="l14869"></a>14869 <span class="comment">     *   &lt;li&gt;L, T, R, B or combinations: Line style of left, top, right or bottom border. Array like for SetLineStyle().&lt;/li&gt;</span>
<a name="l14870"></a>14870 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l14871"></a>14871 <span class="comment">     * If a key is not present or is null, not draws the border. Default value: default line style (empty array).</span>
<a name="l14872"></a>14872 <span class="comment">     * @param $border_style (array) Border style of rectangle. Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l14873"></a>14873 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(GREY) or array(R,G,B) or array(C,M,Y,K). Default value: default color (empty array).</span>
<a name="l14874"></a>14874 <span class="comment">     * @public</span>
<a name="l14875"></a>14875 <span class="comment">     * @since 1.0</span>
<a name="l14876"></a>14876 <span class="comment">     * @see SetLineStyle()</span>
<a name="l14877"></a>14877 <span class="comment">     */</span>
<a name="l14878"></a><a class="code" href="classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">14878</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c" title="Draws a rectangle.">Rect</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $style=<span class="stringliteral">&#39;&#39;</span>, $border_style=array(), $fill_color=array()) {
<a name="l14879"></a>14879         <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND !empty($fill_color)) {
<a name="l14880"></a>14880             $this-&gt;SetFillColorArray($fill_color);
<a name="l14881"></a>14881         }
<a name="l14882"></a>14882         $op = $this-&gt;getPathPaintOperator($style);
<a name="l14883"></a>14883         <span class="keywordflow">if</span> ((!$border_style) OR (isset($border_style[<span class="stringliteral">&#39;all&#39;</span>]))) {
<a name="l14884"></a>14884             <span class="keywordflow">if</span> (isset($border_style[<span class="stringliteral">&#39;all&#39;</span>]) AND $border_style[<span class="stringliteral">&#39;all&#39;</span>]) {
<a name="l14885"></a>14885                 $this-&gt;SetLineStyle($border_style[<span class="stringliteral">&#39;all&#39;</span>]);
<a name="l14886"></a>14886                 $border_style = array();
<a name="l14887"></a>14887             }
<a name="l14888"></a>14888         }
<a name="l14889"></a>14889         $this-&gt;_outRect(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $op);
<a name="l14890"></a>14890         <span class="keywordflow">if</span> ($border_style) {
<a name="l14891"></a>14891             $border_style2 = array();
<a name="l14892"></a>14892             <span class="keywordflow">foreach</span> ($border_style as <a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a> =&gt; $value) {
<a name="l14893"></a>14893                 $length = strlen(<a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>);
<a name="l14894"></a>14894                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $length; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l14895"></a>14895                     $border_style2[<a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]] = $value;
<a name="l14896"></a>14896                 }
<a name="l14897"></a>14897             }
<a name="l14898"></a>14898             $border_style = $border_style2;
<a name="l14899"></a>14899             <span class="keywordflow">if</span> (isset($border_style[<span class="charliteral">&#39;L&#39;</span>]) AND $border_style[<span class="charliteral">&#39;L&#39;</span>]) {
<a name="l14900"></a>14900                 $this-&gt;Line(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $border_style[<span class="charliteral">&#39;L&#39;</span>]);
<a name="l14901"></a>14901             }
<a name="l14902"></a>14902             <span class="keywordflow">if</span> (isset($border_style[<span class="charliteral">&#39;T&#39;</span>]) AND $border_style[<span class="charliteral">&#39;T&#39;</span>]) {
<a name="l14903"></a>14903                 $this-&gt;Line(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $y, $border_style[<span class="charliteral">&#39;T&#39;</span>]);
<a name="l14904"></a>14904             }
<a name="l14905"></a>14905             <span class="keywordflow">if</span> (isset($border_style[<span class="charliteral">&#39;R&#39;</span>]) AND $border_style[<span class="charliteral">&#39;R&#39;</span>]) {
<a name="l14906"></a>14906                 $this-&gt;Line(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $border_style[<span class="charliteral">&#39;R&#39;</span>]);
<a name="l14907"></a>14907             }
<a name="l14908"></a>14908             <span class="keywordflow">if</span> (isset($border_style[<span class="charliteral">&#39;B&#39;</span>]) AND $border_style[<span class="charliteral">&#39;B&#39;</span>]) {
<a name="l14909"></a>14909                 $this-&gt;Line(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $border_style[<span class="charliteral">&#39;B&#39;</span>]);
<a name="l14910"></a>14910             }
<a name="l14911"></a>14911         }
<a name="l14912"></a>14912     }
<a name="l14913"></a>14913 <span class="comment"></span>
<a name="l14914"></a>14914 <span class="comment">    /**</span>
<a name="l14915"></a>14915 <span class="comment">     * Draws a Bezier curve.</span>
<a name="l14916"></a>14916 <span class="comment">     * The Bezier curve is a tangent to the line between the control points at</span>
<a name="l14917"></a>14917 <span class="comment">     * either end of the curve.</span>
<a name="l14918"></a>14918 <span class="comment">     * @param $x0 (float) Abscissa of start point.</span>
<a name="l14919"></a>14919 <span class="comment">     * @param $y0 (float) Ordinate of start point.</span>
<a name="l14920"></a>14920 <span class="comment">     * @param $x1 (float) Abscissa of control point 1.</span>
<a name="l14921"></a>14921 <span class="comment">     * @param $y1 (float) Ordinate of control point 1.</span>
<a name="l14922"></a>14922 <span class="comment">     * @param $x2 (float) Abscissa of control point 2.</span>
<a name="l14923"></a>14923 <span class="comment">     * @param $y2 (float) Ordinate of control point 2.</span>
<a name="l14924"></a>14924 <span class="comment">     * @param $x3 (float) Abscissa of end point.</span>
<a name="l14925"></a>14925 <span class="comment">     * @param $y3 (float) Ordinate of end point.</span>
<a name="l14926"></a>14926 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l14927"></a>14927 <span class="comment">     * @param $line_style (array) Line style of curve. Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l14928"></a>14928 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(GREY) or array(R,G,B) or array(C,M,Y,K). Default value: default color (empty array).</span>
<a name="l14929"></a>14929 <span class="comment">     * @public</span>
<a name="l14930"></a>14930 <span class="comment">     * @see SetLineStyle()</span>
<a name="l14931"></a>14931 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l14932"></a>14932 <span class="comment">     */</span>
<a name="l14933"></a><a class="code" href="classTCPDF.html#a23895bb8d9fae071308f9d307ea638fd">14933</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a23895bb8d9fae071308f9d307ea638fd" title="Draws a Bezier curve.">Curve</a>($x0, $y0, $x1, $y1, $x2, $y2, $x3, $y3, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array()) {
<a name="l14934"></a>14934         <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {
<a name="l14935"></a>14935             $this-&gt;SetFillColorArray($fill_color);
<a name="l14936"></a>14936         }
<a name="l14937"></a>14937         $op = $this-&gt;getPathPaintOperator($style);
<a name="l14938"></a>14938         <span class="keywordflow">if</span> ($line_style) {
<a name="l14939"></a>14939             $this-&gt;SetLineStyle($line_style);
<a name="l14940"></a>14940         }
<a name="l14941"></a>14941         $this-&gt;_outPoint($x0, $y0);
<a name="l14942"></a>14942         $this-&gt;_outCurve($x1, $y1, $x2, $y2, $x3, $y3);
<a name="l14943"></a>14943         $this-&gt;_out($op);
<a name="l14944"></a>14944     }
<a name="l14945"></a>14945 <span class="comment"></span>
<a name="l14946"></a>14946 <span class="comment">    /**</span>
<a name="l14947"></a>14947 <span class="comment">     * Draws a poly-Bezier curve.</span>
<a name="l14948"></a>14948 <span class="comment">     * Each Bezier curve segment is a tangent to the line between the control points at</span>
<a name="l14949"></a>14949 <span class="comment">     * either end of the curve.</span>
<a name="l14950"></a>14950 <span class="comment">     * @param $x0 (float) Abscissa of start point.</span>
<a name="l14951"></a>14951 <span class="comment">     * @param $y0 (float) Ordinate of start point.</span>
<a name="l14952"></a>14952 <span class="comment">     * @param $segments (float) An array of bezier descriptions. Format: array(x1, y1, x2, y2, x3, y3).</span>
<a name="l14953"></a>14953 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l14954"></a>14954 <span class="comment">     * @param $line_style (array) Line style of curve. Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l14955"></a>14955 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(GREY) or array(R,G,B) or array(C,M,Y,K). Default value: default color (empty array).</span>
<a name="l14956"></a>14956 <span class="comment">     * @public</span>
<a name="l14957"></a>14957 <span class="comment">     * @see SetLineStyle()</span>
<a name="l14958"></a>14958 <span class="comment">     * @since 3.0008 (2008-05-12)</span>
<a name="l14959"></a>14959 <span class="comment">     */</span>
<a name="l14960"></a><a class="code" href="classTCPDF.html#aaf0b4fbcfc6c68a0a0877b39667184ef">14960</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aaf0b4fbcfc6c68a0a0877b39667184ef" title="Draws a poly-Bezier curve.">Polycurve</a>($x0, $y0, $segments, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array()) {
<a name="l14961"></a>14961         <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {
<a name="l14962"></a>14962             $this-&gt;SetFillColorArray($fill_color);
<a name="l14963"></a>14963         }
<a name="l14964"></a>14964         $op = $this-&gt;getPathPaintOperator($style);
<a name="l14965"></a>14965         <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {
<a name="l14966"></a>14966             $line_style = array();
<a name="l14967"></a>14967         }
<a name="l14968"></a>14968         <span class="keywordflow">if</span> ($line_style) {
<a name="l14969"></a>14969             $this-&gt;SetLineStyle($line_style);
<a name="l14970"></a>14970         }
<a name="l14971"></a>14971         $this-&gt;_outPoint($x0, $y0);
<a name="l14972"></a>14972         <span class="keywordflow">foreach</span> ($segments as $segment) {
<a name="l14973"></a>14973             list($x1, $y1, $x2, $y2, $x3, $y3) = $segment;
<a name="l14974"></a>14974             $this-&gt;_outCurve($x1, $y1, $x2, $y2, $x3, $y3);
<a name="l14975"></a>14975         }
<a name="l14976"></a>14976         $this-&gt;_out($op);
<a name="l14977"></a>14977     }
<a name="l14978"></a>14978 <span class="comment"></span>
<a name="l14979"></a>14979 <span class="comment">    /**</span>
<a name="l14980"></a>14980 <span class="comment">     * Draws an ellipse.</span>
<a name="l14981"></a>14981 <span class="comment">     * An ellipse is formed from n Bezier curves.</span>
<a name="l14982"></a>14982 <span class="comment">     * @param $x0 (float) Abscissa of center point.</span>
<a name="l14983"></a>14983 <span class="comment">     * @param $y0 (float) Ordinate of center point.</span>
<a name="l14984"></a>14984 <span class="comment">     * @param $rx (float) Horizontal radius.</span>
<a name="l14985"></a>14985 <span class="comment">     * @param $ry (float) Vertical radius (if ry = 0 then is a circle, see Circle()). Default value: 0.</span>
<a name="l14986"></a>14986 <span class="comment">     * @param $angle: (float) Angle oriented (anti-clockwise). Default value: 0.</span>
<a name="l14987"></a>14987 <span class="comment">     * @param $astart: (float) Angle start of draw line. Default value: 0.</span>
<a name="l14988"></a>14988 <span class="comment">     * @param $afinish: (float) Angle finish of draw line. Default value: 360.</span>
<a name="l14989"></a>14989 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l14990"></a>14990 <span class="comment">     * @param $line_style (array) Line style of ellipse. Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l14991"></a>14991 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(GREY) or array(R,G,B) or array(C,M,Y,K). Default value: default color (empty array).</span>
<a name="l14992"></a>14992 <span class="comment">     * @param $nc (integer) Number of curves used to draw a 90 degrees portion of ellipse.</span>
<a name="l14993"></a>14993 <span class="comment">     * @author Nicola Asuni</span>
<a name="l14994"></a>14994 <span class="comment">     * @public</span>
<a name="l14995"></a>14995 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l14996"></a>14996 <span class="comment">     */</span>
<a name="l14997"></a><a class="code" href="classTCPDF.html#ab45f86866ef0d753a8fca04dddd63d68">14997</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab45f86866ef0d753a8fca04dddd63d68" title="Draws an ellipse.">Ellipse</a>($x0, $y0, $rx, $ry=<span class="stringliteral">&#39;&#39;</span>, $angle=0, $astart=0, $afinish=360, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $nc=2) {
<a name="l14998"></a>14998         <span class="keywordflow">if</span> ($this-&gt;empty_string($ry) OR ($ry == 0)) {
<a name="l14999"></a>14999             $ry = $rx;
<a name="l15000"></a>15000         }
<a name="l15001"></a>15001         <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {
<a name="l15002"></a>15002             $this-&gt;SetFillColorArray($fill_color);
<a name="l15003"></a>15003         }
<a name="l15004"></a>15004         $op = $this-&gt;getPathPaintOperator($style);
<a name="l15005"></a>15005         <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {
<a name="l15006"></a>15006             $line_style = array();
<a name="l15007"></a>15007         }
<a name="l15008"></a>15008         <span class="keywordflow">if</span> ($line_style) {
<a name="l15009"></a>15009             $this-&gt;SetLineStyle($line_style);
<a name="l15010"></a>15010         }
<a name="l15011"></a>15011         $this-&gt;_outellipticalarc($x0, $y0, $rx, $ry, $angle, $astart, $afinish, <span class="keyword">false</span>, $nc, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);
<a name="l15012"></a>15012         $this-&gt;_out($op);
<a name="l15013"></a>15013     }
<a name="l15014"></a>15014 <span class="comment"></span>
<a name="l15015"></a>15015 <span class="comment">    /**</span>
<a name="l15016"></a>15016 <span class="comment">     * Append an elliptical arc to the current path.</span>
<a name="l15017"></a>15017 <span class="comment">     * An ellipse is formed from n Bezier curves.</span>
<a name="l15018"></a>15018 <span class="comment">     * @param $xc (float) Abscissa of center point.</span>
<a name="l15019"></a>15019 <span class="comment">     * @param $yc (float) Ordinate of center point.</span>
<a name="l15020"></a>15020 <span class="comment">     * @param $rx (float) Horizontal radius.</span>
<a name="l15021"></a>15021 <span class="comment">     * @param $ry (float) Vertical radius (if ry = 0 then is a circle, see Circle()). Default value: 0.</span>
<a name="l15022"></a>15022 <span class="comment">     * @param $xang: (float) Angle between the X-axis and the major axis of the ellipse. Default value: 0.</span>
<a name="l15023"></a>15023 <span class="comment">     * @param $angs: (float) Angle start of draw line. Default value: 0.</span>
<a name="l15024"></a>15024 <span class="comment">     * @param $angf: (float) Angle finish of draw line. Default value: 360.</span>
<a name="l15025"></a>15025 <span class="comment">     * @param $pie (boolean) if true do not mark the border point (used to draw pie sectors).</span>
<a name="l15026"></a>15026 <span class="comment">     * @param $nc (integer) Number of curves used to draw a 90 degrees portion of ellipse.</span>
<a name="l15027"></a>15027 <span class="comment">     * @param $startpoint (boolean) if true output a starting point.</span>
<a name="l15028"></a>15028 <span class="comment">     * @param $ccw (boolean) if true draws in counter-clockwise.</span>
<a name="l15029"></a>15029 <span class="comment">     * @param $svg (boolean) if true the angles are in svg mode (already calculated).</span>
<a name="l15030"></a>15030 <span class="comment">     * @return array bounding box coordinates (x min, y min, x max, y max)</span>
<a name="l15031"></a>15031 <span class="comment">     * @author Nicola Asuni</span>
<a name="l15032"></a>15032 <span class="comment">     * @protected</span>
<a name="l15033"></a>15033 <span class="comment">     * @since 4.9.019 (2010-04-26)</span>
<a name="l15034"></a>15034 <span class="comment">     */</span>
<a name="l15035"></a><a class="code" href="classTCPDF.html#aa36b100b48a17cd6c35de87431a3d54c">15035</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa36b100b48a17cd6c35de87431a3d54c" title="Append an elliptical arc to the current path.">_outellipticalarc</a>($xc, $yc, $rx, $ry, $xang=0, $angs=0, $angf=360, $pie=<span class="keyword">false</span>, $nc=2, $startpoint=<span class="keyword">true</span>, $ccw=<span class="keyword">true</span>, $svg=<span class="keyword">false</span>) {
<a name="l15036"></a>15036         $k = $this-&gt;k;
<a name="l15037"></a>15037         <span class="keywordflow">if</span> ($nc &lt; 2) {
<a name="l15038"></a>15038             $nc = 2;
<a name="l15039"></a>15039         }
<a name="l15040"></a>15040         $xmin = 2147483647;
<a name="l15041"></a>15041         $ymin = 2147483647;
<a name="l15042"></a>15042         $xmax = 0;
<a name="l15043"></a>15043         $ymax = 0;
<a name="l15044"></a>15044         <span class="keywordflow">if</span> ($pie) {
<a name="l15045"></a>15045             <span class="comment">// center of the arc</span>
<a name="l15046"></a>15046             $this-&gt;_outPoint($xc, $yc);
<a name="l15047"></a>15047         }
<a name="l15048"></a>15048         $xang = deg2rad((<span class="keywordtype">float</span>) $xang);
<a name="l15049"></a>15049         $angs = deg2rad((<span class="keywordtype">float</span>) $angs);
<a name="l15050"></a>15050         $angf = deg2rad((<span class="keywordtype">float</span>) $angf);
<a name="l15051"></a>15051         <span class="keywordflow">if</span> ($svg) {
<a name="l15052"></a>15052             $as = $angs;
<a name="l15053"></a>15053             $af = $angf;
<a name="l15054"></a>15054         } <span class="keywordflow">else</span> {
<a name="l15055"></a>15055             $as = atan2((sin($angs) / $ry), (cos($angs) / $rx));
<a name="l15056"></a>15056             $af = atan2((sin($angf) / $ry), (cos($angf) / $rx));
<a name="l15057"></a>15057         }
<a name="l15058"></a>15058         <span class="keywordflow">if</span> ($as &lt; 0) {
<a name="l15059"></a>15059             $as += (2 * M_PI);
<a name="l15060"></a>15060         }
<a name="l15061"></a>15061         <span class="keywordflow">if</span> ($af &lt; 0) {
<a name="l15062"></a>15062             $af += (2 * M_PI);
<a name="l15063"></a>15063         }
<a name="l15064"></a>15064         <span class="keywordflow">if</span> ($ccw AND ($as &gt; $af)) {
<a name="l15065"></a>15065             <span class="comment">// reverse rotation</span>
<a name="l15066"></a>15066             $as -= (2 * M_PI);
<a name="l15067"></a>15067         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (!$ccw AND ($as &lt; $af)) {
<a name="l15068"></a>15068             <span class="comment">// reverse rotation</span>
<a name="l15069"></a>15069             $af -= (2 * M_PI);
<a name="l15070"></a>15070         }
<a name="l15071"></a>15071         $total_angle = ($af - $as);
<a name="l15072"></a>15072         <span class="keywordflow">if</span> ($nc &lt; 2) {
<a name="l15073"></a>15073             $nc = 2;
<a name="l15074"></a>15074         }
<a name="l15075"></a>15075         <span class="comment">// total arcs to draw</span>
<a name="l15076"></a>15076         $nc *= (2 * abs($total_angle) / M_PI);
<a name="l15077"></a>15077         $nc = round($nc) + 1;
<a name="l15078"></a>15078         <span class="comment">// angle of each arc</span>
<a name="l15079"></a>15079         $arcang = ($total_angle / $nc);
<a name="l15080"></a>15080         <span class="comment">// center point in PDF coordinates</span>
<a name="l15081"></a>15081         $x0 = $xc;
<a name="l15082"></a>15082         $y0 = ($this-&gt;h - $yc);
<a name="l15083"></a>15083         <span class="comment">// starting angle</span>
<a name="l15084"></a>15084         $ang = $as;
<a name="l15085"></a>15085         $alpha = sin($arcang) * ((sqrt(4 + (3 * pow(tan(($arcang) / 2), 2))) - 1) / 3);
<a name="l15086"></a>15086         $cos_xang = cos($xang);
<a name="l15087"></a>15087         $sin_xang = sin($xang);
<a name="l15088"></a>15088         $cos_ang = cos($ang);
<a name="l15089"></a>15089         $sin_ang = sin($ang);
<a name="l15090"></a>15090         <span class="comment">// first arc point</span>
<a name="l15091"></a>15091         $px1 = $x0 + ($rx * $cos_xang * $cos_ang) - ($ry * $sin_xang * $sin_ang);
<a name="l15092"></a>15092         $py1 = $y0 + ($rx * $sin_xang * $cos_ang) + ($ry * $cos_xang * $sin_ang);
<a name="l15093"></a>15093         <span class="comment">// first Bezier control point</span>
<a name="l15094"></a>15094         $qx1 = ($alpha * ((-$rx * $cos_xang * $sin_ang) - ($ry * $sin_xang * $cos_ang)));
<a name="l15095"></a>15095         $qy1 = ($alpha * ((-$rx * $sin_xang * $sin_ang) + ($ry * $cos_xang * $cos_ang)));
<a name="l15096"></a>15096         <span class="keywordflow">if</span> ($pie) {
<a name="l15097"></a>15097             <span class="comment">// line from center to arc starting point</span>
<a name="l15098"></a>15098             $this-&gt;_outLine($px1, $this-&gt;h - $py1);
<a name="l15099"></a>15099         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($startpoint) {
<a name="l15100"></a>15100             <span class="comment">// arc starting point</span>
<a name="l15101"></a>15101             $this-&gt;_outPoint($px1, $this-&gt;h - $py1);
<a name="l15102"></a>15102         }
<a name="l15103"></a>15103         <span class="comment">// draw arcs</span>
<a name="l15104"></a>15104         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;= $nc; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15105"></a>15105             <span class="comment">// starting angle</span>
<a name="l15106"></a>15106             $ang = $as + (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> * $arcang);
<a name="l15107"></a>15107             <span class="keywordflow">if</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> == $nc) {
<a name="l15108"></a>15108                 $ang = $af;
<a name="l15109"></a>15109             }
<a name="l15110"></a>15110             $cos_ang = cos($ang);
<a name="l15111"></a>15111             $sin_ang = sin($ang);
<a name="l15112"></a>15112             <span class="comment">// second arc point</span>
<a name="l15113"></a>15113             $px2 = $x0 + ($rx * $cos_xang * $cos_ang) - ($ry * $sin_xang * $sin_ang);
<a name="l15114"></a>15114             $py2 = $y0 + ($rx * $sin_xang * $cos_ang) + ($ry * $cos_xang * $sin_ang);
<a name="l15115"></a>15115             <span class="comment">// second Bezier control point</span>
<a name="l15116"></a>15116             $qx2 = ($alpha * ((-$rx * $cos_xang * $sin_ang) - ($ry * $sin_xang * $cos_ang)));
<a name="l15117"></a>15117             $qy2 = ($alpha * ((-$rx * $sin_xang * $sin_ang) + ($ry * $cos_xang * $cos_ang)));
<a name="l15118"></a>15118             <span class="comment">// draw arc</span>
<a name="l15119"></a>15119             $cx1 = ($px1 + $qx1);
<a name="l15120"></a>15120             $cy1 = ($this-&gt;h - ($py1 + $qy1));
<a name="l15121"></a>15121             $cx2 = ($px2 - $qx2);
<a name="l15122"></a>15122             $cy2 = ($this-&gt;h - ($py2 - $qy2));
<a name="l15123"></a>15123             $cx3 = $px2;
<a name="l15124"></a>15124             $cy3 = ($this-&gt;h - $py2);
<a name="l15125"></a>15125             $this-&gt;_outCurve($cx1, $cy1, $cx2, $cy2, $cx3, $cy3);
<a name="l15126"></a>15126             <span class="comment">// get bounding box coordinates</span>
<a name="l15127"></a>15127             $xmin = min($xmin, $cx1, $cx2, $cx3);
<a name="l15128"></a>15128             $ymin = min($ymin, $cy1, $cy2, $cy3);
<a name="l15129"></a>15129             $xmax = max($xmax, $cx1, $cx2, $cx3);
<a name="l15130"></a>15130             $ymax = max($ymax, $cy1, $cy2, $cy3);
<a name="l15131"></a>15131             <span class="comment">// move to next point</span>
<a name="l15132"></a>15132             $px1 = $px2;
<a name="l15133"></a>15133             $py1 = $py2;
<a name="l15134"></a>15134             $qx1 = $qx2;
<a name="l15135"></a>15135             $qy1 = $qy2;
<a name="l15136"></a>15136         }
<a name="l15137"></a>15137         <span class="keywordflow">if</span> ($pie) {
<a name="l15138"></a>15138             $this-&gt;_outLine($xc, $yc);
<a name="l15139"></a>15139             <span class="comment">// get bounding box coordinates</span>
<a name="l15140"></a>15140             $xmin = min($xmin, $xc);
<a name="l15141"></a>15141             $ymin = min($ymin, $yc);
<a name="l15142"></a>15142             $xmax = max($xmax, $xc);
<a name="l15143"></a>15143             $ymax = max($ymax, $yc);
<a name="l15144"></a>15144         }
<a name="l15145"></a>15145         <span class="keywordflow">return</span> array($xmin, $ymin, $xmax, $ymax);
<a name="l15146"></a>15146     }
<a name="l15147"></a>15147 <span class="comment"></span>
<a name="l15148"></a>15148 <span class="comment">    /**</span>
<a name="l15149"></a>15149 <span class="comment">     * Draws a circle.</span>
<a name="l15150"></a>15150 <span class="comment">     * A circle is formed from n Bezier curves.</span>
<a name="l15151"></a>15151 <span class="comment">     * @param $x0 (float) Abscissa of center point.</span>
<a name="l15152"></a>15152 <span class="comment">     * @param $y0 (float) Ordinate of center point.</span>
<a name="l15153"></a>15153 <span class="comment">     * @param $r (float) Radius.</span>
<a name="l15154"></a>15154 <span class="comment">     * @param $angstr: (float) Angle start of draw line. Default value: 0.</span>
<a name="l15155"></a>15155 <span class="comment">     * @param $angend: (float) Angle finish of draw line. Default value: 360.</span>
<a name="l15156"></a>15156 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l15157"></a>15157 <span class="comment">     * @param $line_style (array) Line style of circle. Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l15158"></a>15158 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(red, green, blue). Default value: default color (empty array).</span>
<a name="l15159"></a>15159 <span class="comment">     * @param $nc (integer) Number of curves used to draw a 90 degrees portion of circle.</span>
<a name="l15160"></a>15160 <span class="comment">     * @public</span>
<a name="l15161"></a>15161 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l15162"></a>15162 <span class="comment">     */</span>
<a name="l15163"></a><a class="code" href="classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593">15163</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593" title="Draws a circle.">Circle</a>($x0, $y0, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $angstr=0, $angend=360, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $nc=2) {
<a name="l15164"></a>15164         $this-&gt;Ellipse($x0, $y0, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, 0, $angstr, $angend, $style, $line_style, $fill_color, $nc);
<a name="l15165"></a>15165     }
<a name="l15166"></a>15166 <span class="comment"></span>
<a name="l15167"></a>15167 <span class="comment">    /**</span>
<a name="l15168"></a>15168 <span class="comment">     * Draws a polygonal line</span>
<a name="l15169"></a>15169 <span class="comment">     * @param $p (array) Points 0 to ($np - 1). Array with values (x0, y0, x1, y1,..., x(np-1), y(np - 1))</span>
<a name="l15170"></a>15170 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l15171"></a>15171 <span class="comment">     * @param $line_style (array) Line style of polygon. Array with keys among the following:</span>
<a name="l15172"></a>15172 <span class="comment">     * &lt;ul&gt;</span>
<a name="l15173"></a>15173 <span class="comment">     *   &lt;li&gt;all: Line style of all lines. Array like for SetLineStyle().&lt;/li&gt;</span>
<a name="l15174"></a>15174 <span class="comment">     *   &lt;li&gt;0 to ($np - 1): Line style of each line. Array like for SetLineStyle().&lt;/li&gt;</span>
<a name="l15175"></a>15175 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l15176"></a>15176 <span class="comment">     * If a key is not present or is null, not draws the line. Default value is default line style (empty array).</span>
<a name="l15177"></a>15177 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(GREY) or array(R,G,B) or array(C,M,Y,K). Default value: default color (empty array).</span>
<a name="l15178"></a>15178 <span class="comment">     * @since 4.8.003 (2009-09-15)</span>
<a name="l15179"></a>15179 <span class="comment">     * @public</span>
<a name="l15180"></a>15180 <span class="comment">     */</span>
<a name="l15181"></a><a class="code" href="classTCPDF.html#a4afa2740651c35051628d9a9a1d1edb8">15181</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4afa2740651c35051628d9a9a1d1edb8" title="Draws a polygonal line.">PolyLine</a>($p, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array()) {
<a name="l15182"></a>15182         $this-&gt;Polygon($p, $style, $line_style, $fill_color, <span class="keyword">false</span>);
<a name="l15183"></a>15183     }
<a name="l15184"></a>15184 <span class="comment"></span>
<a name="l15185"></a>15185 <span class="comment">    /**</span>
<a name="l15186"></a>15186 <span class="comment">     * Draws a polygon.</span>
<a name="l15187"></a>15187 <span class="comment">     * @param $p (array) Points 0 to ($np - 1). Array with values (x0, y0, x1, y1,..., x(np-1), y(np - 1))</span>
<a name="l15188"></a>15188 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l15189"></a>15189 <span class="comment">     * @param $line_style (array) Line style of polygon. Array with keys among the following:</span>
<a name="l15190"></a>15190 <span class="comment">     * &lt;ul&gt;</span>
<a name="l15191"></a>15191 <span class="comment">     *   &lt;li&gt;all: Line style of all lines. Array like for SetLineStyle().&lt;/li&gt;</span>
<a name="l15192"></a>15192 <span class="comment">     *   &lt;li&gt;0 to ($np - 1): Line style of each line. Array like for SetLineStyle().&lt;/li&gt;</span>
<a name="l15193"></a>15193 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l15194"></a>15194 <span class="comment">     * If a key is not present or is null, not draws the line. Default value is default line style (empty array).</span>
<a name="l15195"></a>15195 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(GREY) or array(R,G,B) or array(C,M,Y,K). Default value: default color (empty array).</span>
<a name="l15196"></a>15196 <span class="comment">     * @param $closed (boolean) if true the polygon is closes, otherwise will remain open</span>
<a name="l15197"></a>15197 <span class="comment">     * @public</span>
<a name="l15198"></a>15198 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l15199"></a>15199 <span class="comment">     */</span>
<a name="l15200"></a><a class="code" href="classTCPDF.html#a2aa8a59e174cfa8f61eb1a33489ce16b">15200</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2aa8a59e174cfa8f61eb1a33489ce16b" title="Draws a polygon.">Polygon</a>($p, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $closed=<span class="keyword">true</span>) {
<a name="l15201"></a>15201         $nc = count($p); <span class="comment">// number of coordinates</span>
<a name="l15202"></a>15202         $np = $nc / 2; <span class="comment">// number of points</span>
<a name="l15203"></a>15203         <span class="keywordflow">if</span> ($closed) {
<a name="l15204"></a>15204             <span class="comment">// close polygon by adding the first 2 points at the end (one line)</span>
<a name="l15205"></a>15205             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; 4; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15206"></a>15206                 $p[$nc + <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $p[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l15207"></a>15207             }
<a name="l15208"></a>15208             <span class="comment">// copy style for the last added line</span>
<a name="l15209"></a>15209             <span class="keywordflow">if</span> (isset($line_style[0])) {
<a name="l15210"></a>15210                 $line_style[$np] = $line_style[0];
<a name="l15211"></a>15211             }
<a name="l15212"></a>15212             $nc += 4;
<a name="l15213"></a>15213         }
<a name="l15214"></a>15214         <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {
<a name="l15215"></a>15215             $this-&gt;SetFillColorArray($fill_color);
<a name="l15216"></a>15216         }
<a name="l15217"></a>15217         $op = $this-&gt;getPathPaintOperator($style);
<a name="l15218"></a>15218         <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {
<a name="l15219"></a>15219             $line_style = array();
<a name="l15220"></a>15220         }
<a name="l15221"></a>15221         $draw = <span class="keyword">true</span>;
<a name="l15222"></a>15222         <span class="keywordflow">if</span> ($line_style) {
<a name="l15223"></a>15223             <span class="keywordflow">if</span> (isset($line_style[<span class="stringliteral">&#39;all&#39;</span>])) {
<a name="l15224"></a>15224                 $this-&gt;SetLineStyle($line_style[<span class="stringliteral">&#39;all&#39;</span>]);
<a name="l15225"></a>15225             } <span class="keywordflow">else</span> {
<a name="l15226"></a>15226                 $draw = <span class="keyword">false</span>;
<a name="l15227"></a>15227                 <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;B&#39;</span>) {
<a name="l15228"></a>15228                     <span class="comment">// draw fill</span>
<a name="l15229"></a>15229                     $op = <span class="charliteral">&#39;f&#39;</span>;
<a name="l15230"></a>15230                     $this-&gt;_outPoint($p[0], $p[1]);
<a name="l15231"></a>15231                     <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 2; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $nc; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 2) {
<a name="l15232"></a>15232                         $this-&gt;_outLine($p[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>], $p[$i + 1]);
<a name="l15233"></a>15233                     }
<a name="l15234"></a>15234                     $this-&gt;_out($op);
<a name="l15235"></a>15235                 }
<a name="l15236"></a>15236                 <span class="comment">// draw outline</span>
<a name="l15237"></a>15237                 $this-&gt;_outPoint($p[0], $p[1]);
<a name="l15238"></a>15238                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 2; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $nc; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 2) {
<a name="l15239"></a>15239                     $line_num = (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> / 2) - 1;
<a name="l15240"></a>15240                     <span class="keywordflow">if</span> (isset($line_style[$line_num])) {
<a name="l15241"></a>15241                         <span class="keywordflow">if</span> ($line_style[$line_num] != 0) {
<a name="l15242"></a>15242                             <span class="keywordflow">if</span> (is_array($line_style[$line_num])) {
<a name="l15243"></a>15243                                 $this-&gt;_out(<span class="charliteral">&#39;S&#39;</span>);
<a name="l15244"></a>15244                                 $this-&gt;SetLineStyle($line_style[$line_num]);
<a name="l15245"></a>15245                                 $this-&gt;_outPoint($p[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> - 2], $p[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> - 1]);
<a name="l15246"></a>15246                                 $this-&gt;_outLine($p[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>], $p[$i + 1]);
<a name="l15247"></a>15247                                 $this-&gt;_out(<span class="charliteral">&#39;S&#39;</span>);
<a name="l15248"></a>15248                                 $this-&gt;_outPoint($p[$i], $p[$i + 1]);
<a name="l15249"></a>15249                             } <span class="keywordflow">else</span> {
<a name="l15250"></a>15250                                 $this-&gt;_outLine($p[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>], $p[$i + 1]);
<a name="l15251"></a>15251                             }
<a name="l15252"></a>15252                         }
<a name="l15253"></a>15253                     } <span class="keywordflow">else</span> {
<a name="l15254"></a>15254                         $this-&gt;_outLine($p[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>], $p[$i + 1]);
<a name="l15255"></a>15255                     }
<a name="l15256"></a>15256                 }
<a name="l15257"></a>15257                 $this-&gt;_out($op);
<a name="l15258"></a>15258             }
<a name="l15259"></a>15259         }
<a name="l15260"></a>15260         <span class="keywordflow">if</span> ($draw) {
<a name="l15261"></a>15261             $this-&gt;_outPoint($p[0], $p[1]);
<a name="l15262"></a>15262             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 2; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $nc; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 2) {
<a name="l15263"></a>15263                 $this-&gt;_outLine($p[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>], $p[$i + 1]);
<a name="l15264"></a>15264             }
<a name="l15265"></a>15265             $this-&gt;_out($op);
<a name="l15266"></a>15266         }
<a name="l15267"></a>15267     }
<a name="l15268"></a>15268 <span class="comment"></span>
<a name="l15269"></a>15269 <span class="comment">    /**</span>
<a name="l15270"></a>15270 <span class="comment">     * Draws a regular polygon.</span>
<a name="l15271"></a>15271 <span class="comment">     * @param $x0 (float) Abscissa of center point.</span>
<a name="l15272"></a>15272 <span class="comment">     * @param $y0 (float) Ordinate of center point.</span>
<a name="l15273"></a>15273 <span class="comment">     * @param $r: (float) Radius of inscribed circle.</span>
<a name="l15274"></a>15274 <span class="comment">     * @param $ns (integer) Number of sides.</span>
<a name="l15275"></a>15275 <span class="comment">     * @param $angle (float) Angle oriented (anti-clockwise). Default value: 0.</span>
<a name="l15276"></a>15276 <span class="comment">     * @param $draw_circle (boolean) Draw inscribed circle or not. Default value: false.</span>
<a name="l15277"></a>15277 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l15278"></a>15278 <span class="comment">     * @param $line_style (array) Line style of polygon sides. Array with keys among the following:</span>
<a name="l15279"></a>15279 <span class="comment">     * &lt;ul&gt;</span>
<a name="l15280"></a>15280 <span class="comment">     *   &lt;li&gt;all: Line style of all sides. Array like for SetLineStyle().&lt;/li&gt;</span>
<a name="l15281"></a>15281 <span class="comment">     *   &lt;li&gt;0 to ($ns - 1): Line style of each side. Array like for SetLineStyle().&lt;/li&gt;</span>
<a name="l15282"></a>15282 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l15283"></a>15283 <span class="comment">     * If a key is not present or is null, not draws the side. Default value is default line style (empty array).</span>
<a name="l15284"></a>15284 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(red, green, blue). Default value: default color (empty array).</span>
<a name="l15285"></a>15285 <span class="comment">     * @param $circle_style (string) Style of rendering of inscribed circle (if draws). Possible values are:</span>
<a name="l15286"></a>15286 <span class="comment">     * &lt;ul&gt;</span>
<a name="l15287"></a>15287 <span class="comment">     *   &lt;li&gt;D or empty string: Draw (default).&lt;/li&gt;</span>
<a name="l15288"></a>15288 <span class="comment">     *   &lt;li&gt;F: Fill.&lt;/li&gt;</span>
<a name="l15289"></a>15289 <span class="comment">     *   &lt;li&gt;DF or FD: Draw and fill.&lt;/li&gt;</span>
<a name="l15290"></a>15290 <span class="comment">     *   &lt;li&gt;CNZ: Clipping mode (using the even-odd rule to determine which regions lie inside the clipping path).&lt;/li&gt;</span>
<a name="l15291"></a>15291 <span class="comment">     *   &lt;li&gt;CEO: Clipping mode (using the nonzero winding number rule to determine which regions lie inside the clipping path).&lt;/li&gt;</span>
<a name="l15292"></a>15292 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l15293"></a>15293 <span class="comment">     * @param $circle_outLine_style (array) Line style of inscribed circle (if draws). Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l15294"></a>15294 <span class="comment">     * @param $circle_fill_color (array) Fill color of inscribed circle (if draws). Format: array(red, green, blue). Default value: default color (empty array).</span>
<a name="l15295"></a>15295 <span class="comment">     * @public</span>
<a name="l15296"></a>15296 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l15297"></a>15297 <span class="comment">     */</span>
<a name="l15298"></a><a class="code" href="classTCPDF.html#add34ab0872e65557749d744941fd435d">15298</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#add34ab0872e65557749d744941fd435d" title="Draws a regular polygon.">RegularPolygon</a>($x0, $y0, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $ns, $angle=0, $draw_circle=<span class="keyword">false</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $circle_style=<span class="stringliteral">&#39;&#39;</span>, $circle_outLine_style=array(), $circle_fill_color=array()) {
<a name="l15299"></a>15299         <span class="keywordflow">if</span> (3 &gt; $ns) {
<a name="l15300"></a>15300             $ns = 3;
<a name="l15301"></a>15301         }
<a name="l15302"></a>15302         <span class="keywordflow">if</span> ($draw_circle) {
<a name="l15303"></a>15303             $this-&gt;Circle($x0, $y0, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, 0, 360, $circle_style, $circle_outLine_style, $circle_fill_color);
<a name="l15304"></a>15304         }
<a name="l15305"></a>15305         $p = array();
<a name="l15306"></a>15306         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $ns; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15307"></a>15307             $a = $angle + (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> * 360 / $ns);
<a name="l15308"></a>15308             $a_rad = deg2rad((<span class="keywordtype">float</span>) $a);
<a name="l15309"></a>15309             $p[] = $x0 + (<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> * sin($a_rad));
<a name="l15310"></a>15310             $p[] = $y0 + (<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> * cos($a_rad));
<a name="l15311"></a>15311         }
<a name="l15312"></a>15312         $this-&gt;Polygon($p, $style, $line_style, $fill_color);
<a name="l15313"></a>15313     }
<a name="l15314"></a>15314 <span class="comment"></span>
<a name="l15315"></a>15315 <span class="comment">    /**</span>
<a name="l15316"></a>15316 <span class="comment">     * Draws a star polygon</span>
<a name="l15317"></a>15317 <span class="comment">     * @param $x0 (float) Abscissa of center point.</span>
<a name="l15318"></a>15318 <span class="comment">     * @param $y0 (float) Ordinate of center point.</span>
<a name="l15319"></a>15319 <span class="comment">     * @param $r (float) Radius of inscribed circle.</span>
<a name="l15320"></a>15320 <span class="comment">     * @param $nv (integer) Number of vertices.</span>
<a name="l15321"></a>15321 <span class="comment">     * @param $ng (integer) Number of gap (if ($ng % $nv = 1) then is a regular polygon).</span>
<a name="l15322"></a>15322 <span class="comment">     * @param $angle: (float) Angle oriented (anti-clockwise). Default value: 0.</span>
<a name="l15323"></a>15323 <span class="comment">     * @param $draw_circle: (boolean) Draw inscribed circle or not. Default value is false.</span>
<a name="l15324"></a>15324 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l15325"></a>15325 <span class="comment">     * @param $line_style (array) Line style of polygon sides. Array with keys among the following:</span>
<a name="l15326"></a>15326 <span class="comment">     * &lt;ul&gt;</span>
<a name="l15327"></a>15327 <span class="comment">     *   &lt;li&gt;all: Line style of all sides. Array like for</span>
<a name="l15328"></a>15328 <span class="comment">     * SetLineStyle().&lt;/li&gt;</span>
<a name="l15329"></a>15329 <span class="comment">     *   &lt;li&gt;0 to (n - 1): Line style of each side. Array like for SetLineStyle().&lt;/li&gt;</span>
<a name="l15330"></a>15330 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l15331"></a>15331 <span class="comment">     * If a key is not present or is null, not draws the side. Default value is default line style (empty array).</span>
<a name="l15332"></a>15332 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(red, green, blue). Default value: default color (empty array).</span>
<a name="l15333"></a>15333 <span class="comment">     * @param $circle_style (string) Style of rendering of inscribed circle (if draws). Possible values are:</span>
<a name="l15334"></a>15334 <span class="comment">     * &lt;ul&gt;</span>
<a name="l15335"></a>15335 <span class="comment">     *   &lt;li&gt;D or empty string: Draw (default).&lt;/li&gt;</span>
<a name="l15336"></a>15336 <span class="comment">     *   &lt;li&gt;F: Fill.&lt;/li&gt;</span>
<a name="l15337"></a>15337 <span class="comment">     *   &lt;li&gt;DF or FD: Draw and fill.&lt;/li&gt;</span>
<a name="l15338"></a>15338 <span class="comment">     *   &lt;li&gt;CNZ: Clipping mode (using the even-odd rule to determine which regions lie inside the clipping path).&lt;/li&gt;</span>
<a name="l15339"></a>15339 <span class="comment">     *   &lt;li&gt;CEO: Clipping mode (using the nonzero winding number rule to determine which regions lie inside the clipping path).&lt;/li&gt;</span>
<a name="l15340"></a>15340 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l15341"></a>15341 <span class="comment">     * @param $circle_outLine_style (array) Line style of inscribed circle (if draws). Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l15342"></a>15342 <span class="comment">     * @param $circle_fill_color (array) Fill color of inscribed circle (if draws). Format: array(red, green, blue). Default value: default color (empty array).</span>
<a name="l15343"></a>15343 <span class="comment">     * @public</span>
<a name="l15344"></a>15344 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l15345"></a>15345 <span class="comment">     */</span>
<a name="l15346"></a><a class="code" href="classTCPDF.html#aa57e6af79ccaf81eeeeb97d5eae93ecf">15346</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa57e6af79ccaf81eeeeb97d5eae93ecf" title="Draws a star polygon.">StarPolygon</a>($x0, $y0, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $nv, $ng, $angle=0, $draw_circle=<span class="keyword">false</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $circle_style=<span class="stringliteral">&#39;&#39;</span>, $circle_outLine_style=array(), $circle_fill_color=array()) {
<a name="l15347"></a>15347         <span class="keywordflow">if</span> ($nv &lt; 2) {
<a name="l15348"></a>15348             $nv = 2;
<a name="l15349"></a>15349         }
<a name="l15350"></a>15350         <span class="keywordflow">if</span> ($draw_circle) {
<a name="l15351"></a>15351             $this-&gt;Circle($x0, $y0, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, 0, 360, $circle_style, $circle_outLine_style, $circle_fill_color);
<a name="l15352"></a>15352         }
<a name="l15353"></a>15353         $p2 = array();
<a name="l15354"></a>15354         $visited = array();
<a name="l15355"></a>15355         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $nv; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15356"></a>15356             $a = $angle + (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> * 360 / $nv);
<a name="l15357"></a>15357             $a_rad = deg2rad((<span class="keywordtype">float</span>) $a);
<a name="l15358"></a>15358             $p2[] = $x0 + (<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> * sin($a_rad));
<a name="l15359"></a>15359             $p2[] = $y0 + (<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> * cos($a_rad));
<a name="l15360"></a>15360             $visited[] = <span class="keyword">false</span>;
<a name="l15361"></a>15361         }
<a name="l15362"></a>15362         $p = array();
<a name="l15363"></a>15363         <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0;
<a name="l15364"></a>15364         <span class="keywordflow">do</span> {
<a name="l15365"></a>15365             $p[] = $p2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> * 2];
<a name="l15366"></a>15366             $p[] = $p2[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> * 2) + 1];
<a name="l15367"></a>15367             $visited[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = <span class="keyword">true</span>;
<a name="l15368"></a>15368             <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> += $ng;
<a name="l15369"></a>15369             <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> %= $nv;
<a name="l15370"></a>15370         } <span class="keywordflow">while</span> (!$visited[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]);
<a name="l15371"></a>15371         $this-&gt;Polygon($p, $style, $line_style, $fill_color);
<a name="l15372"></a>15372     }
<a name="l15373"></a>15373 <span class="comment"></span>
<a name="l15374"></a>15374 <span class="comment">    /**</span>
<a name="l15375"></a>15375 <span class="comment">     * Draws a rounded rectangle.</span>
<a name="l15376"></a>15376 <span class="comment">     * @param $x (float) Abscissa of upper-left corner.</span>
<a name="l15377"></a>15377 <span class="comment">     * @param $y (float) Ordinate of upper-left corner.</span>
<a name="l15378"></a>15378 <span class="comment">     * @param $w (float) Width.</span>
<a name="l15379"></a>15379 <span class="comment">     * @param $h (float) Height.</span>
<a name="l15380"></a>15380 <span class="comment">     * @param $r (float) the radius of the circle used to round off the corners of the rectangle.</span>
<a name="l15381"></a>15381 <span class="comment">     * @param $round_corner (string) Draws rounded corner or not. String with a 0 (not rounded i-corner) or 1 (rounded i-corner) in i-position. Positions are, in order and begin to 0: top left, top right, bottom right and bottom left. Default value: all rounded corner (&quot;1111&quot;).</span>
<a name="l15382"></a>15382 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l15383"></a>15383 <span class="comment">     * @param $border_style (array) Border style of rectangle. Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l15384"></a>15384 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(GREY) or array(R,G,B) or array(C,M,Y,K). Default value: default color (empty array).</span>
<a name="l15385"></a>15385 <span class="comment">     * @public</span>
<a name="l15386"></a>15386 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l15387"></a>15387 <span class="comment">     */</span>
<a name="l15388"></a><a class="code" href="classTCPDF.html#a5fa62d7764cd7f3ff96fb902bf2ad7c5">15388</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5fa62d7764cd7f3ff96fb902bf2ad7c5" title="Draws a rounded rectangle.">RoundedRect</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $round_corner=<span class="stringliteral">&#39;1111&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $border_style=array(), $fill_color=array()) {
<a name="l15389"></a>15389         $this-&gt;RoundedRectXY(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $round_corner, $style, $border_style, $fill_color);
<a name="l15390"></a>15390     }
<a name="l15391"></a>15391 <span class="comment"></span>
<a name="l15392"></a>15392 <span class="comment">    /**</span>
<a name="l15393"></a>15393 <span class="comment">     * Draws a rounded rectangle.</span>
<a name="l15394"></a>15394 <span class="comment">     * @param $x (float) Abscissa of upper-left corner.</span>
<a name="l15395"></a>15395 <span class="comment">     * @param $y (float) Ordinate of upper-left corner.</span>
<a name="l15396"></a>15396 <span class="comment">     * @param $w (float) Width.</span>
<a name="l15397"></a>15397 <span class="comment">     * @param $h (float) Height.</span>
<a name="l15398"></a>15398 <span class="comment">     * @param $rx (float) the x-axis radius of the ellipse used to round off the corners of the rectangle.</span>
<a name="l15399"></a>15399 <span class="comment">     * @param $ry (float) the y-axis radius of the ellipse used to round off the corners of the rectangle.</span>
<a name="l15400"></a>15400 <span class="comment">     * @param $round_corner (string) Draws rounded corner or not. String with a 0 (not rounded i-corner) or 1 (rounded i-corner) in i-position. Positions are, in order and begin to 0: top left, top right, bottom right and bottom left. Default value: all rounded corner (&quot;1111&quot;).</span>
<a name="l15401"></a>15401 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l15402"></a>15402 <span class="comment">     * @param $border_style (array) Border style of rectangle. Array like for SetLineStyle(). Default value: default line style (empty array).</span>
<a name="l15403"></a>15403 <span class="comment">     * @param $fill_color (array) Fill color. Format: array(GREY) or array(R,G,B) or array(C,M,Y,K). Default value: default color (empty array).</span>
<a name="l15404"></a>15404 <span class="comment">     * @public</span>
<a name="l15405"></a>15405 <span class="comment">     * @since 4.9.019 (2010-04-22)</span>
<a name="l15406"></a>15406 <span class="comment">     */</span>
<a name="l15407"></a><a class="code" href="classTCPDF.html#aae395cced777e52fac95cbbba28af98a">15407</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aae395cced777e52fac95cbbba28af98a" title="Draws a rounded rectangle.">RoundedRectXY</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $rx, $ry, $round_corner=<span class="stringliteral">&#39;1111&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $border_style=array(), $fill_color=array()) {
<a name="l15408"></a>15408         <span class="keywordflow">if</span> (($round_corner == <span class="stringliteral">&#39;0000&#39;</span>) OR (($rx == $ry) AND ($rx == 0))) {
<a name="l15409"></a>15409             <span class="comment">// Not rounded</span>
<a name="l15410"></a>15410             $this-&gt;Rect(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $style, $border_style, $fill_color);
<a name="l15411"></a>15411             <span class="keywordflow">return</span>;
<a name="l15412"></a>15412         }
<a name="l15413"></a>15413         <span class="comment">// Rounded</span>
<a name="l15414"></a>15414         <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {
<a name="l15415"></a>15415             $this-&gt;SetFillColorArray($fill_color);
<a name="l15416"></a>15416         }
<a name="l15417"></a>15417         $op = $this-&gt;getPathPaintOperator($style);
<a name="l15418"></a>15418         <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {
<a name="l15419"></a>15419             $border_style = array();
<a name="l15420"></a>15420         }
<a name="l15421"></a>15421         <span class="keywordflow">if</span> ($border_style) {
<a name="l15422"></a>15422             $this-&gt;SetLineStyle($border_style);
<a name="l15423"></a>15423         }
<a name="l15424"></a>15424         $MyArc = 4 / 3 * (sqrt(2) - 1);
<a name="l15425"></a>15425         $this-&gt;_outPoint(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + $rx, $y);
<a name="l15426"></a>15426         $xc = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> - $rx;
<a name="l15427"></a>15427         $yc = $y + $ry;
<a name="l15428"></a>15428         $this-&gt;_outLine($xc, $y);
<a name="l15429"></a>15429         <span class="keywordflow">if</span> ($round_corner[0]) {
<a name="l15430"></a>15430             $this-&gt;_outCurve($xc + ($rx * $MyArc), $yc - $ry, $xc + $rx, $yc - ($ry * $MyArc), $xc + $rx, $yc);
<a name="l15431"></a>15431         } <span class="keywordflow">else</span> {
<a name="l15432"></a>15432             $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $y);
<a name="l15433"></a>15433         }
<a name="l15434"></a>15434         $xc = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> - $rx;
<a name="l15435"></a>15435         $yc = $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> - $ry;
<a name="l15436"></a>15436         $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $yc);
<a name="l15437"></a>15437         <span class="keywordflow">if</span> ($round_corner[1]) {
<a name="l15438"></a>15438             $this-&gt;_outCurve($xc + $rx, $yc + ($ry * $MyArc), $xc + ($rx * $MyArc), $yc + $ry, $xc, $yc + $ry);
<a name="l15439"></a>15439         } <span class="keywordflow">else</span> {
<a name="l15440"></a>15440             $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l15441"></a>15441         }
<a name="l15442"></a>15442         $xc = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + $rx;
<a name="l15443"></a>15443         $yc = $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> - $ry;
<a name="l15444"></a>15444         $this-&gt;_outLine($xc, $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l15445"></a>15445         <span class="keywordflow">if</span> ($round_corner[2]) {
<a name="l15446"></a>15446             $this-&gt;_outCurve($xc - ($rx * $MyArc), $yc + $ry, $xc - $rx, $yc + ($ry * $MyArc), $xc - $rx, $yc);
<a name="l15447"></a>15447         } <span class="keywordflow">else</span> {
<a name="l15448"></a>15448             $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l15449"></a>15449         }
<a name="l15450"></a>15450         $xc = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + $rx;
<a name="l15451"></a>15451         $yc = $y + $ry;
<a name="l15452"></a>15452         $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $yc);
<a name="l15453"></a>15453         <span class="keywordflow">if</span> ($round_corner[3]) {
<a name="l15454"></a>15454             $this-&gt;_outCurve($xc - $rx, $yc - ($ry * $MyArc), $xc - ($rx * $MyArc), $yc - $ry, $xc, $yc - $ry);
<a name="l15455"></a>15455         } <span class="keywordflow">else</span> {
<a name="l15456"></a>15456             $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l15457"></a>15457             $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + $rx, $y);
<a name="l15458"></a>15458         }
<a name="l15459"></a>15459         $this-&gt;_out($op);
<a name="l15460"></a>15460     }
<a name="l15461"></a>15461 <span class="comment"></span>
<a name="l15462"></a>15462 <span class="comment">    /**</span>
<a name="l15463"></a>15463 <span class="comment">     * Draws a grahic arrow.</span>
<a name="l15464"></a>15464 <span class="comment">     * @param $x0 (float) Abscissa of first point.</span>
<a name="l15465"></a>15465 <span class="comment">     * @param $y0 (float) Ordinate of first point.</span>
<a name="l15466"></a>15466 <span class="comment">     * @param $x1 (float) Abscissa of second point.</span>
<a name="l15467"></a>15467 <span class="comment">     * @param $y1 (float) Ordinate of second point.</span>
<a name="l15468"></a>15468 <span class="comment">     * @param $head_style (int) (0 = draw only arrowhead arms, 1 = draw closed arrowhead, but no fill, 2 = closed and filled arrowhead, 3 = filled arrowhead)</span>
<a name="l15469"></a>15469 <span class="comment">     * @param $arm_size (float) length of arrowhead arms</span>
<a name="l15470"></a>15470 <span class="comment">     * @param $arm_angle (int) angle between an arm and the shaft</span>
<a name="l15471"></a>15471 <span class="comment">     * @author Piotr Galecki, Nicola Asuni, Andy Meier</span>
<a name="l15472"></a>15472 <span class="comment">     * @since 4.6.018 (2009-07-10)</span>
<a name="l15473"></a>15473 <span class="comment">     */</span>
<a name="l15474"></a><a class="code" href="classTCPDF.html#ada0489b022bfd41ff1fa7a3fd666831a">15474</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ada0489b022bfd41ff1fa7a3fd666831a" title="Draws a grahic arrow.">Arrow</a>($x0, $y0, $x1, $y1, $head_style=0, $arm_size=5, $arm_angle=15) {
<a name="l15475"></a>15475         <span class="comment">// getting arrow direction angle</span>
<a name="l15476"></a>15476         <span class="comment">// 0 deg angle is when both arms go along X axis. angle grows clockwise.</span>
<a name="l15477"></a>15477         $dir_angle = atan2(($y0 - $y1), ($x0 - $x1));
<a name="l15478"></a>15478         <span class="keywordflow">if</span> ($dir_angle &lt; 0) {
<a name="l15479"></a>15479             $dir_angle += (2 * M_PI);
<a name="l15480"></a>15480         }
<a name="l15481"></a>15481         $arm_angle = deg2rad($arm_angle);
<a name="l15482"></a>15482         $sx1 = $x1;
<a name="l15483"></a>15483         $sy1 = $y1;
<a name="l15484"></a>15484         <span class="keywordflow">if</span> ($head_style &gt; 0) {
<a name="l15485"></a>15485             <span class="comment">// calculate the stopping point for the arrow shaft</span>
<a name="l15486"></a>15486             $sx1 = $x1 + (($arm_size - $this-&gt;LineWidth) * cos($dir_angle));
<a name="l15487"></a>15487             $sy1 = $y1 + (($arm_size - $this-&gt;LineWidth) * sin($dir_angle));
<a name="l15488"></a>15488         }
<a name="l15489"></a>15489         <span class="comment">// main arrow line / shaft</span>
<a name="l15490"></a>15490         $this-&gt;Line($x0, $y0, $sx1, $sy1);
<a name="l15491"></a>15491         <span class="comment">// left arrowhead arm tip</span>
<a name="l15492"></a>15492         $x2L = $x1 + ($arm_size * cos($dir_angle + $arm_angle));
<a name="l15493"></a>15493         $y2L = $y1 + ($arm_size * sin($dir_angle + $arm_angle));
<a name="l15494"></a>15494         <span class="comment">// right arrowhead arm tip</span>
<a name="l15495"></a>15495         $x2R = $x1 + ($arm_size * cos($dir_angle - $arm_angle));
<a name="l15496"></a>15496         $y2R = $y1 + ($arm_size * sin($dir_angle - $arm_angle));
<a name="l15497"></a>15497         <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a> = <span class="charliteral">&#39;D&#39;</span>;
<a name="l15498"></a>15498         $style = array();
<a name="l15499"></a>15499         <span class="keywordflow">switch</span> ($head_style) {
<a name="l15500"></a>15500             <span class="keywordflow">case</span> 0: {
<a name="l15501"></a>15501                 <span class="comment">// draw only arrowhead arms</span>
<a name="l15502"></a>15502                 $mode = <span class="charliteral">&#39;D&#39;</span>;
<a name="l15503"></a>15503                 $style = array(1, 1, 0);
<a name="l15504"></a>15504                 <span class="keywordflow">break</span>;
<a name="l15505"></a>15505             }
<a name="l15506"></a>15506             <span class="keywordflow">case</span> 1: {
<a name="l15507"></a>15507                 <span class="comment">// draw closed arrowhead, but no fill</span>
<a name="l15508"></a>15508                 $mode = <span class="charliteral">&#39;D&#39;</span>;
<a name="l15509"></a>15509                 <span class="keywordflow">break</span>;
<a name="l15510"></a>15510             }
<a name="l15511"></a>15511             <span class="keywordflow">case</span> 2: {
<a name="l15512"></a>15512                 <span class="comment">// closed and filled arrowhead</span>
<a name="l15513"></a>15513                 $mode = <span class="stringliteral">&#39;DF&#39;</span>;
<a name="l15514"></a>15514                 <span class="keywordflow">break</span>;
<a name="l15515"></a>15515             }
<a name="l15516"></a>15516             <span class="keywordflow">case</span> 3: {
<a name="l15517"></a>15517                 <span class="comment">// filled arrowhead</span>
<a name="l15518"></a>15518                 $mode = <span class="charliteral">&#39;F&#39;</span>;
<a name="l15519"></a>15519                 <span class="keywordflow">break</span>;
<a name="l15520"></a>15520             }
<a name="l15521"></a>15521         }
<a name="l15522"></a>15522         $this-&gt;Polygon(array($x2L, $y2L, $x1, $y1, $x2R, $y2R), $mode, $style, array());
<a name="l15523"></a>15523     }
<a name="l15524"></a>15524 
<a name="l15525"></a>15525     <span class="comment">// END GRAPHIC FUNCTIONS SECTION -----------------------</span>
<a name="l15526"></a>15526 
<a name="l15527"></a>15527     <span class="comment">// BIDIRECTIONAL TEXT SECTION --------------------------</span>
<a name="l15528"></a>15528 <span class="comment"></span>
<a name="l15529"></a>15529 <span class="comment">    /**</span>
<a name="l15530"></a>15530 <span class="comment">     * Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).</span>
<a name="l15531"></a>15531 <span class="comment">     * @param $str (string) string to manipulate.</span>
<a name="l15532"></a>15532 <span class="comment">     * @param $setbom (bool) if true set the Byte Order Mark (BOM = 0xFEFF)</span>
<a name="l15533"></a>15533 <span class="comment">     * @param $forcertl (bool) if true forces RTL text direction</span>
<a name="l15534"></a>15534 <span class="comment">     * @return string</span>
<a name="l15535"></a>15535 <span class="comment">     * @protected</span>
<a name="l15536"></a>15536 <span class="comment">     * @author Nicola Asuni</span>
<a name="l15537"></a>15537 <span class="comment">     * @since 2.1.000 (2008-01-08)</span>
<a name="l15538"></a>15538 <span class="comment">     */</span>
<a name="l15539"></a><a class="code" href="classTCPDF.html#a49060c1c6d0b49446e2cc1dd39f5734e">15539</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a49060c1c6d0b49446e2cc1dd39f5734e" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8StrRev</a>($str, $setbom=<span class="keyword">false</span>, $forcertl=<span class="keyword">false</span>) {
<a name="l15540"></a>15540         <span class="keywordflow">return</span> $this-&gt;utf8StrArrRev($this-&gt;UTF8StringToArray($str), $str, $setbom, $forcertl);
<a name="l15541"></a>15541     }
<a name="l15542"></a>15542 <span class="comment"></span>
<a name="l15543"></a>15543 <span class="comment">    /**</span>
<a name="l15544"></a>15544 <span class="comment">     * Reverse the RLT substrings array using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).</span>
<a name="l15545"></a>15545 <span class="comment">     * @param $arr (array) array of unicode values.</span>
<a name="l15546"></a>15546 <span class="comment">     * @param $str (string) string to manipulate (or empty value).</span>
<a name="l15547"></a>15547 <span class="comment">     * @param $setbom (bool) if true set the Byte Order Mark (BOM = 0xFEFF)</span>
<a name="l15548"></a>15548 <span class="comment">     * @param $forcertl (bool) if true forces RTL text direction</span>
<a name="l15549"></a>15549 <span class="comment">     * @return string</span>
<a name="l15550"></a>15550 <span class="comment">     * @protected</span>
<a name="l15551"></a>15551 <span class="comment">     * @author Nicola Asuni</span>
<a name="l15552"></a>15552 <span class="comment">     * @since 4.9.000 (2010-03-27)</span>
<a name="l15553"></a>15553 <span class="comment">     */</span>
<a name="l15554"></a><a class="code" href="classTCPDF.html#a087760c9a1aa906ead7a822fd63832c3">15554</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a087760c9a1aa906ead7a822fd63832c3" title="Reverse the RLT substrings array using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8StrArrRev</a>($arr, $str=<span class="stringliteral">&#39;&#39;</span>, $setbom=<span class="keyword">false</span>, $forcertl=<span class="keyword">false</span>) {
<a name="l15555"></a>15555         <span class="keywordflow">return</span> $this-&gt;arrUTF8ToUTF16BE($this-&gt;utf8Bidi($arr, $str, $forcertl), $setbom);
<a name="l15556"></a>15556     }
<a name="l15557"></a>15557 <span class="comment"></span>
<a name="l15558"></a>15558 <span class="comment">    /**</span>
<a name="l15559"></a>15559 <span class="comment">     * Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).</span>
<a name="l15560"></a>15560 <span class="comment">     * @param $ta (array) array of characters composing the string.</span>
<a name="l15561"></a>15561 <span class="comment">     * @param $str (string) string to process</span>
<a name="l15562"></a>15562 <span class="comment">     * @param $forcertl (bool) if &#39;R&#39; forces RTL, if &#39;L&#39; forces LTR</span>
<a name="l15563"></a>15563 <span class="comment">     * @return array of unicode chars</span>
<a name="l15564"></a>15564 <span class="comment">     * @author Nicola Asuni</span>
<a name="l15565"></a>15565 <span class="comment">     * @protected</span>
<a name="l15566"></a>15566 <span class="comment">     * @since 2.4.000 (2008-03-06)</span>
<a name="l15567"></a>15567 <span class="comment">     */</span>
<a name="l15568"></a><a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185">15568</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aeae5a9f2fd6630b5ce96435592e82185" title="Reverse the RLT substrings using the Bidirectional Algorithm (http://unicode.org/reports/tr9/).">utf8Bidi</a>($ta, $str=<span class="stringliteral">&#39;&#39;</span>, $forcertl=<span class="keyword">false</span>) {
<a name="l15569"></a>15569         <span class="comment">// paragraph embedding level</span>
<a name="l15570"></a>15570         $pel = 0;
<a name="l15571"></a>15571         <span class="comment">// max level</span>
<a name="l15572"></a>15572         $maxlevel = 0;
<a name="l15573"></a>15573         <span class="keywordflow">if</span> ($this-&gt;empty_string($str)) {
<a name="l15574"></a>15574             <span class="comment">// create string from array</span>
<a name="l15575"></a>15575             $str = $this-&gt;UTF8ArrSubString($ta);
<a name="l15576"></a>15576         }
<a name="l15577"></a>15577         <span class="comment">// check if string contains arabic text</span>
<a name="l15578"></a>15578         <span class="keywordflow">if</span> (preg_match($this-&gt;unicode-&gt;uni_RE_PATTERN_ARABIC, $str)) {
<a name="l15579"></a>15579             $arabic = <span class="keyword">true</span>;
<a name="l15580"></a>15580         } <span class="keywordflow">else</span> {
<a name="l15581"></a>15581             $arabic = <span class="keyword">false</span>;
<a name="l15582"></a>15582         }
<a name="l15583"></a>15583         <span class="comment">// check if string contains RTL text</span>
<a name="l15584"></a>15584         <span class="keywordflow">if</span> (!($forcertl OR $arabic OR preg_match($this-&gt;unicode-&gt;uni_RE_PATTERN_RTL, $str))) {
<a name="l15585"></a>15585             <span class="keywordflow">return</span> $ta;
<a name="l15586"></a>15586         }
<a name="l15587"></a>15587 
<a name="l15588"></a>15588         <span class="comment">// get number of chars</span>
<a name="l15589"></a>15589         $numchars = count($ta);
<a name="l15590"></a>15590 
<a name="l15591"></a>15591         <span class="keywordflow">if</span> ($forcertl == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l15592"></a>15592             $pel = 1;
<a name="l15593"></a>15593         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($forcertl == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l15594"></a>15594             $pel = 0;
<a name="l15595"></a>15595         } <span class="keywordflow">else</span> {
<a name="l15596"></a>15596             <span class="comment">// P2. In each paragraph, find the first character of type L, AL, or R.</span>
<a name="l15597"></a>15597             <span class="comment">// P3. If a character is found in P2 and it is of type AL or R, then set the paragraph embedding level to one; otherwise, set it to zero.</span>
<a name="l15598"></a>15598             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15599"></a>15599                 <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = $this-&gt;unicode-&gt;uni_type[$ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]];
<a name="l15600"></a>15600                 <span class="keywordflow">if</span> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l15601"></a>15601                     $pel = 0;
<a name="l15602"></a>15602                     <span class="keywordflow">break</span>;
<a name="l15603"></a>15603                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;AL&#39;</span>) OR (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="charliteral">&#39;R&#39;</span>)) {
<a name="l15604"></a>15604                     $pel = 1;
<a name="l15605"></a>15605                     <span class="keywordflow">break</span>;
<a name="l15606"></a>15606                 }
<a name="l15607"></a>15607             }
<a name="l15608"></a>15608         }
<a name="l15609"></a>15609 
<a name="l15610"></a>15610         <span class="comment">// Current Embedding Level</span>
<a name="l15611"></a>15611         $cel = $pel;
<a name="l15612"></a>15612         <span class="comment">// directional override status</span>
<a name="l15613"></a>15613         $dos = <span class="charliteral">&#39;N&#39;</span>;
<a name="l15614"></a>15614         $remember = array();
<a name="l15615"></a>15615         <span class="comment">// start-of-level-run</span>
<a name="l15616"></a>15616         $sor = $pel % 2 ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;L&#39;</span>;
<a name="l15617"></a>15617         $eor = $sor;
<a name="l15618"></a>15618 
<a name="l15619"></a>15619         <span class="comment">// Array of characters data</span>
<a name="l15620"></a>15620         $chardata = Array();
<a name="l15621"></a>15621 
<a name="l15622"></a>15622         <span class="comment">// X1. Begin by setting the current embedding level to the paragraph embedding level. Set the directional override status to neutral. Process each character iteratively, applying rules X2 through X9. Only embedding levels from 0 to 61 are valid in this phase.</span>
<a name="l15623"></a>15623         <span class="comment">// In the resolution of levels in rules I1 and I2, the maximum embedding level of 62 can be reached.</span>
<a name="l15624"></a>15624         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15625"></a>15625             <span class="keywordflow">if</span> ($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] == $this-&gt;unicode-&gt;uni_RLE) {
<a name="l15626"></a>15626                 <span class="comment">// X2. With each RLE, compute the least greater odd embedding level.</span>
<a name="l15627"></a>15627                 <span class="comment">//  a. If this new level would be valid, then this embedding code is valid. Remember (push) the current embedding level and override status. Reset the current level to this new level, and reset the override status to neutral.</span>
<a name="l15628"></a>15628                 <span class="comment">//  b. If the new level would not be valid, then this code is invalid. Do not change the current level or override status.</span>
<a name="l15629"></a>15629                 $next_level = $cel + ($cel % 2) + 1;
<a name="l15630"></a>15630                 <span class="keywordflow">if</span> ($next_level &lt; 62) {
<a name="l15631"></a>15631                     $remember[] = array(<span class="stringliteral">&#39;num&#39;</span> =&gt; $this-&gt;unicode-&gt;uni_RLE, <span class="stringliteral">&#39;cel&#39;</span> =&gt; $cel, <span class="stringliteral">&#39;dos&#39;</span> =&gt; $dos);
<a name="l15632"></a>15632                     $cel = $next_level;
<a name="l15633"></a>15633                     $dos = <span class="charliteral">&#39;N&#39;</span>;
<a name="l15634"></a>15634                     $sor = $eor;
<a name="l15635"></a>15635                     $eor = $cel % 2 ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;L&#39;</span>;
<a name="l15636"></a>15636                 }
<a name="l15637"></a>15637             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] == $this-&gt;unicode-&gt;uni_LRE) {
<a name="l15638"></a>15638                 <span class="comment">// X3. With each LRE, compute the least greater even embedding level.</span>
<a name="l15639"></a>15639                 <span class="comment">//  a. If this new level would be valid, then this embedding code is valid. Remember (push) the current embedding level and override status. Reset the current level to this new level, and reset the override status to neutral.</span>
<a name="l15640"></a>15640                 <span class="comment">//  b. If the new level would not be valid, then this code is invalid. Do not change the current level or override status.</span>
<a name="l15641"></a>15641                 $next_level = $cel + 2 - ($cel % 2);
<a name="l15642"></a>15642                 <span class="keywordflow">if</span> ( $next_level &lt; 62 ) {
<a name="l15643"></a>15643                     $remember[] = array(<span class="stringliteral">&#39;num&#39;</span> =&gt; $this-&gt;unicode-&gt;uni_LRE, <span class="stringliteral">&#39;cel&#39;</span> =&gt; $cel, <span class="stringliteral">&#39;dos&#39;</span> =&gt; $dos);
<a name="l15644"></a>15644                     $cel = $next_level;
<a name="l15645"></a>15645                     $dos = <span class="charliteral">&#39;N&#39;</span>;
<a name="l15646"></a>15646                     $sor = $eor;
<a name="l15647"></a>15647                     $eor = $cel % 2 ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;L&#39;</span>;
<a name="l15648"></a>15648                 }
<a name="l15649"></a>15649             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] == $this-&gt;unicode-&gt;uni_RLO) {
<a name="l15650"></a>15650                 <span class="comment">// X4. With each RLO, compute the least greater odd embedding level.</span>
<a name="l15651"></a>15651                 <span class="comment">//  a. If this new level would be valid, then this embedding code is valid. Remember (push) the current embedding level and override status. Reset the current level to this new level, and reset the override status to right-to-left.</span>
<a name="l15652"></a>15652                 <span class="comment">//  b. If the new level would not be valid, then this code is invalid. Do not change the current level or override status.</span>
<a name="l15653"></a>15653                 $next_level = $cel + ($cel % 2) + 1;
<a name="l15654"></a>15654                 <span class="keywordflow">if</span> ($next_level &lt; 62) {
<a name="l15655"></a>15655                     $remember[] = array(<span class="stringliteral">&#39;num&#39;</span> =&gt; $this-&gt;unicode-&gt;uni_RLO, <span class="stringliteral">&#39;cel&#39;</span> =&gt; $cel, <span class="stringliteral">&#39;dos&#39;</span> =&gt; $dos);
<a name="l15656"></a>15656                     $cel = $next_level;
<a name="l15657"></a>15657                     $dos = <span class="charliteral">&#39;R&#39;</span>;
<a name="l15658"></a>15658                     $sor = $eor;
<a name="l15659"></a>15659                     $eor = $cel % 2 ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;L&#39;</span>;
<a name="l15660"></a>15660                 }
<a name="l15661"></a>15661             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] == $this-&gt;unicode-&gt;uni_LRO) {
<a name="l15662"></a>15662                 <span class="comment">// X5. With each LRO, compute the least greater even embedding level.</span>
<a name="l15663"></a>15663                 <span class="comment">//  a. If this new level would be valid, then this embedding code is valid. Remember (push) the current embedding level and override status. Reset the current level to this new level, and reset the override status to left-to-right.</span>
<a name="l15664"></a>15664                 <span class="comment">//  b. If the new level would not be valid, then this code is invalid. Do not change the current level or override status.</span>
<a name="l15665"></a>15665                 $next_level = $cel + 2 - ($cel % 2);
<a name="l15666"></a>15666                 <span class="keywordflow">if</span> ( $next_level &lt; 62 ) {
<a name="l15667"></a>15667                     $remember[] = array(<span class="stringliteral">&#39;num&#39;</span> =&gt; $this-&gt;unicode-&gt;uni_LRO, <span class="stringliteral">&#39;cel&#39;</span> =&gt; $cel, <span class="stringliteral">&#39;dos&#39;</span> =&gt; $dos);
<a name="l15668"></a>15668                     $cel = $next_level;
<a name="l15669"></a>15669                     $dos = <span class="charliteral">&#39;L&#39;</span>;
<a name="l15670"></a>15670                     $sor = $eor;
<a name="l15671"></a>15671                     $eor = $cel % 2 ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;L&#39;</span>;
<a name="l15672"></a>15672                 }
<a name="l15673"></a>15673             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] == $this-&gt;unicode-&gt;uni_PDF) {
<a name="l15674"></a>15674                 <span class="comment">// X7. With each PDF, determine the matching embedding or override code. If there was a valid matching code, restore (pop) the last remembered (pushed) embedding level and directional override.</span>
<a name="l15675"></a>15675                 <span class="keywordflow">if</span> (count($remember)) {
<a name="l15676"></a>15676                     $last = count($remember ) - 1;
<a name="l15677"></a>15677                     <span class="keywordflow">if</span> (($remember[$last][<span class="stringliteral">&#39;num&#39;</span>] == $this-&gt;unicode-&gt;uni_RLE) OR
<a name="l15678"></a>15678                         ($remember[$last][<span class="stringliteral">&#39;num&#39;</span>] == $this-&gt;unicode-&gt;uni_LRE) OR
<a name="l15679"></a>15679                         ($remember[$last][<span class="stringliteral">&#39;num&#39;</span>] == $this-&gt;unicode-&gt;uni_RLO) OR
<a name="l15680"></a>15680                         ($remember[$last][<span class="stringliteral">&#39;num&#39;</span>] == $this-&gt;unicode-&gt;uni_LRO)) {
<a name="l15681"></a>15681                         $match = array_pop($remember);
<a name="l15682"></a>15682                         $cel = $match[<span class="stringliteral">&#39;cel&#39;</span>];
<a name="l15683"></a>15683                         $dos = $match[<span class="stringliteral">&#39;dos&#39;</span>];
<a name="l15684"></a>15684                         $sor = $eor;
<a name="l15685"></a>15685                         $eor = ($cel &gt; $match[<span class="stringliteral">&#39;cel&#39;</span>] ? $cel : $match[<span class="stringliteral">&#39;cel&#39;</span>]) % 2 ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;L&#39;</span>;
<a name="l15686"></a>15686                     }
<a name="l15687"></a>15687                 }
<a name="l15688"></a>15688             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] != $this-&gt;unicode-&gt;uni_RLE) AND
<a name="l15689"></a>15689                              ($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] != $this-&gt;unicode-&gt;uni_LRE) AND
<a name="l15690"></a>15690                              ($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] != $this-&gt;unicode-&gt;uni_RLO) AND
<a name="l15691"></a>15691                              ($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] != $this-&gt;unicode-&gt;uni_LRO) AND
<a name="l15692"></a>15692                              ($ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] != $this-&gt;unicode-&gt;uni_PDF)) {
<a name="l15693"></a>15693                 <span class="comment">// X6. For all types besides RLE, LRE, RLO, LRO, and PDF:</span>
<a name="l15694"></a>15694                 <span class="comment">//  a. Set the level of the current character to the current embedding level.</span>
<a name="l15695"></a>15695                 <span class="comment">//  b. Whenever the directional override status is not neutral, reset the current character type to the directional override status.</span>
<a name="l15696"></a>15696                 <span class="keywordflow">if</span> ($dos != <span class="charliteral">&#39;N&#39;</span>) {
<a name="l15697"></a>15697                     $chardir = $dos;
<a name="l15698"></a>15698                 } <span class="keywordflow">else</span> {
<a name="l15699"></a>15699                     <span class="keywordflow">if</span> (isset($this-&gt;unicode-&gt;uni_type[$ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]])) {
<a name="l15700"></a>15700                         $chardir = $this-&gt;unicode-&gt;uni_type[$ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]];
<a name="l15701"></a>15701                     } <span class="keywordflow">else</span> {
<a name="l15702"></a>15702                         $chardir = <span class="charliteral">&#39;L&#39;</span>;
<a name="l15703"></a>15703                     }
<a name="l15704"></a>15704                 }
<a name="l15705"></a>15705                 <span class="comment">// stores string characters and other information</span>
<a name="l15706"></a>15706                 $chardata[] = array(<span class="stringliteral">&#39;char&#39;</span> =&gt; $ta[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>], <span class="stringliteral">&#39;level&#39;</span> =&gt; $cel, <span class="stringliteral">&#39;type&#39;</span> =&gt; $chardir, <span class="stringliteral">&#39;sor&#39;</span> =&gt; $sor, <span class="stringliteral">&#39;eor&#39;</span> =&gt; $eor);
<a name="l15707"></a>15707             }
<a name="l15708"></a>15708         } <span class="comment">// end for each char</span>
<a name="l15709"></a>15709 
<a name="l15710"></a>15710         <span class="comment">// X8. All explicit directional embeddings and overrides are completely terminated at the end of each paragraph. Paragraph separators are not included in the embedding.</span>
<a name="l15711"></a>15711         <span class="comment">// X9. Remove all RLE, LRE, RLO, LRO, PDF, and BN codes.</span>
<a name="l15712"></a>15712         <span class="comment">// X10. The remaining rules are applied to each run of characters at the same level. For each run, determine the start-of-level-run (sor) and end-of-level-run (eor) type, either L or R. This depends on the higher of the two levels on either side of the boundary (at the start or end of the paragraph, the level of the &#39;other&#39; run is the base embedding level). If the higher level is odd, the type is R; otherwise, it is L.</span>
<a name="l15713"></a>15713 
<a name="l15714"></a>15714         <span class="comment">// 3.3.3 Resolving Weak Types</span>
<a name="l15715"></a>15715         <span class="comment">// Weak types are now resolved one level run at a time. At level run boundaries where the type of the character on the other side of the boundary is required, the type assigned to sor or eor is used.</span>
<a name="l15716"></a>15716         <span class="comment">// Nonspacing marks are now resolved based on the previous characters.</span>
<a name="l15717"></a>15717         $numchars = count($chardata);
<a name="l15718"></a>15718 
<a name="l15719"></a>15719         <span class="comment">// W1. Examine each nonspacing mark (NSM) in the level run, and change the type of the NSM to the type of the previous character. If the NSM is at the start of the level run, it will get the type of sor.</span>
<a name="l15720"></a>15720         $prevlevel = -1; <span class="comment">// track level changes</span>
<a name="l15721"></a>15721         $levcount = 0; <span class="comment">// counts consecutive chars at the same level</span>
<a name="l15722"></a>15722         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15723"></a>15723             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;NSM&#39;</span>) {
<a name="l15724"></a>15724                 <span class="keywordflow">if</span> ($levcount) {
<a name="l15725"></a>15725                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;sor&#39;</span>];
<a name="l15726"></a>15726                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; 0) {
<a name="l15727"></a>15727                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = $chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>];
<a name="l15728"></a>15728                 }
<a name="l15729"></a>15729             }
<a name="l15730"></a>15730             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] != $prevlevel) {
<a name="l15731"></a>15731                 $levcount = 0;
<a name="l15732"></a>15732             } <span class="keywordflow">else</span> {
<a name="l15733"></a>15733                 ++$levcount;
<a name="l15734"></a>15734             }
<a name="l15735"></a>15735             $prevlevel = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>];
<a name="l15736"></a>15736         }
<a name="l15737"></a>15737 
<a name="l15738"></a>15738         <span class="comment">// W2. Search backward from each instance of a European number until the first strong type (R, L, AL, or sor) is found. If an AL is found, change the type of the European number to Arabic number.</span>
<a name="l15739"></a>15739         $prevlevel = -1;
<a name="l15740"></a>15740         $levcount = 0;
<a name="l15741"></a>15741         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15742"></a>15742             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) {
<a name="l15743"></a>15743                 <span class="keywordflow">for</span> ($j=$levcount; $j &gt;= 0; $j--) {
<a name="l15744"></a>15744                     <span class="keywordflow">if</span> ($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AL&#39;</span>) {
<a name="l15745"></a>15745                         $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;AN&#39;</span>;
<a name="l15746"></a>15746                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) OR ($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>)) {
<a name="l15747"></a>15747                         <span class="keywordflow">break</span>;
<a name="l15748"></a>15748                     }
<a name="l15749"></a>15749                 }
<a name="l15750"></a>15750             }
<a name="l15751"></a>15751             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] != $prevlevel) {
<a name="l15752"></a>15752                 $levcount = 0;
<a name="l15753"></a>15753             } <span class="keywordflow">else</span> {
<a name="l15754"></a>15754                 ++$levcount;
<a name="l15755"></a>15755             }
<a name="l15756"></a>15756             $prevlevel = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>];
<a name="l15757"></a>15757         }
<a name="l15758"></a>15758 
<a name="l15759"></a>15759         <span class="comment">// W3. Change all ALs to R.</span>
<a name="l15760"></a>15760         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15761"></a>15761             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AL&#39;</span>) {
<a name="l15762"></a>15762                 $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="charliteral">&#39;R&#39;</span>;
<a name="l15763"></a>15763             }
<a name="l15764"></a>15764         }
<a name="l15765"></a>15765 
<a name="l15766"></a>15766         <span class="comment">// W4. A single European separator between two European numbers changes to a European number. A single common separator between two numbers of the same type changes to that type.</span>
<a name="l15767"></a>15767         $prevlevel = -1;
<a name="l15768"></a>15768         $levcount = 0;
<a name="l15769"></a>15769         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15770"></a>15770             <span class="keywordflow">if</span> (($levcount &gt; 0) AND ((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1) &lt; $numchars) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;level&#39;</span>] == $prevlevel)) {
<a name="l15771"></a>15771                 <span class="keywordflow">if</span> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;ES&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>)) {
<a name="l15772"></a>15772                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;EN&#39;</span>;
<a name="l15773"></a>15773                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;CS&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>)) {
<a name="l15774"></a>15774                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;EN&#39;</span>;
<a name="l15775"></a>15775                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;CS&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>)) {
<a name="l15776"></a>15776                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;AN&#39;</span>;
<a name="l15777"></a>15777                 }
<a name="l15778"></a>15778             }
<a name="l15779"></a>15779             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] != $prevlevel) {
<a name="l15780"></a>15780                 $levcount = 0;
<a name="l15781"></a>15781             } <span class="keywordflow">else</span> {
<a name="l15782"></a>15782                 ++$levcount;
<a name="l15783"></a>15783             }
<a name="l15784"></a>15784             $prevlevel = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>];
<a name="l15785"></a>15785         }
<a name="l15786"></a>15786 
<a name="l15787"></a>15787         <span class="comment">// W5. A sequence of European terminators adjacent to European numbers changes to all European numbers.</span>
<a name="l15788"></a>15788         $prevlevel = -1;
<a name="l15789"></a>15789         $levcount = 0;
<a name="l15790"></a>15790         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15791"></a>15791             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;ET&#39;</span>) {
<a name="l15792"></a>15792                 <span class="keywordflow">if</span> (($levcount &gt; 0) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>)) {
<a name="l15793"></a>15793                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;EN&#39;</span>;
<a name="l15794"></a>15794                 } <span class="keywordflow">else</span> {
<a name="l15795"></a>15795                     $j = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1;
<a name="l15796"></a>15796                     <span class="keywordflow">while</span> (($j &lt; $numchars) AND ($chardata[$j][<span class="stringliteral">&#39;level&#39;</span>] == $prevlevel)) {
<a name="l15797"></a>15797                         <span class="keywordflow">if</span> ($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) {
<a name="l15798"></a>15798                             $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;EN&#39;</span>;
<a name="l15799"></a>15799                             <span class="keywordflow">break</span>;
<a name="l15800"></a>15800                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] != <span class="stringliteral">&#39;ET&#39;</span>) {
<a name="l15801"></a>15801                             <span class="keywordflow">break</span>;
<a name="l15802"></a>15802                         }
<a name="l15803"></a>15803                         ++$j;
<a name="l15804"></a>15804                     }
<a name="l15805"></a>15805                 }
<a name="l15806"></a>15806             }
<a name="l15807"></a>15807             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] != $prevlevel) {
<a name="l15808"></a>15808                 $levcount = 0;
<a name="l15809"></a>15809             } <span class="keywordflow">else</span> {
<a name="l15810"></a>15810                 ++$levcount;
<a name="l15811"></a>15811             }
<a name="l15812"></a>15812             $prevlevel = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>];
<a name="l15813"></a>15813         }
<a name="l15814"></a>15814 
<a name="l15815"></a>15815         <span class="comment">// W6. Otherwise, separators and terminators change to Other Neutral.</span>
<a name="l15816"></a>15816         $prevlevel = -1;
<a name="l15817"></a>15817         $levcount = 0;
<a name="l15818"></a>15818         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15819"></a>15819             <span class="keywordflow">if</span> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;ET&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;ES&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;CS&#39;</span>)) {
<a name="l15820"></a>15820                 $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;ON&#39;</span>;
<a name="l15821"></a>15821             }
<a name="l15822"></a>15822             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] != $prevlevel) {
<a name="l15823"></a>15823                 $levcount = 0;
<a name="l15824"></a>15824             } <span class="keywordflow">else</span> {
<a name="l15825"></a>15825                 ++$levcount;
<a name="l15826"></a>15826             }
<a name="l15827"></a>15827             $prevlevel = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>];
<a name="l15828"></a>15828         }
<a name="l15829"></a>15829 
<a name="l15830"></a>15830         <span class="comment">//W7. Search backward from each instance of a European number until the first strong type (R, L, or sor) is found. If an L is found, then change the type of the European number to L.</span>
<a name="l15831"></a>15831         $prevlevel = -1;
<a name="l15832"></a>15832         $levcount = 0;
<a name="l15833"></a>15833         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15834"></a>15834             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) {
<a name="l15835"></a>15835                 <span class="keywordflow">for</span> ($j=$levcount; $j &gt;= 0; $j--) {
<a name="l15836"></a>15836                     <span class="keywordflow">if</span> ($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l15837"></a>15837                         $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="charliteral">&#39;L&#39;</span>;
<a name="l15838"></a>15838                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l15839"></a>15839                         <span class="keywordflow">break</span>;
<a name="l15840"></a>15840                     }
<a name="l15841"></a>15841                 }
<a name="l15842"></a>15842             }
<a name="l15843"></a>15843             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] != $prevlevel) {
<a name="l15844"></a>15844                 $levcount = 0;
<a name="l15845"></a>15845             } <span class="keywordflow">else</span> {
<a name="l15846"></a>15846                 ++$levcount;
<a name="l15847"></a>15847             }
<a name="l15848"></a>15848             $prevlevel = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>];
<a name="l15849"></a>15849         }
<a name="l15850"></a>15850 
<a name="l15851"></a>15851         <span class="comment">// N1. A sequence of neutrals takes the direction of the surrounding strong text if the text on both sides has the same direction. European and Arabic numbers act as if they were R in terms of their influence on neutrals. Start-of-level-run (sor) and end-of-level-run (eor) are used at level run boundaries.</span>
<a name="l15852"></a>15852         $prevlevel = -1;
<a name="l15853"></a>15853         $levcount = 0;
<a name="l15854"></a>15854         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15855"></a>15855             <span class="keywordflow">if</span> (($levcount &gt; 0) AND ((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1) &lt; $numchars) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;level&#39;</span>] == $prevlevel)) {
<a name="l15856"></a>15856                 <span class="keywordflow">if</span> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>)) {
<a name="l15857"></a>15857                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="charliteral">&#39;L&#39;</span>;
<a name="l15858"></a>15858                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) AND
<a name="l15859"></a>15859                  (($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) OR ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) OR ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>)) AND
<a name="l15860"></a>15860                  (($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) OR ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) OR ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>))) {
<a name="l15861"></a>15861                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="charliteral">&#39;R&#39;</span>;
<a name="l15862"></a>15862                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) {
<a name="l15863"></a>15863                     <span class="comment">// N2. Any remaining neutrals take the embedding direction</span>
<a name="l15864"></a>15864                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;sor&#39;</span>];
<a name="l15865"></a>15865                 }
<a name="l15866"></a>15866             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($levcount == 0) AND ((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1) &lt; $numchars) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;level&#39;</span>] == $prevlevel)) {
<a name="l15867"></a>15867                 <span class="comment">// first char</span>
<a name="l15868"></a>15868                 <span class="keywordflow">if</span> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) AND ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;sor&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>)) {
<a name="l15869"></a>15869                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="charliteral">&#39;L&#39;</span>;
<a name="l15870"></a>15870                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) AND
<a name="l15871"></a>15871                  (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;sor&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;sor&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;sor&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>)) AND
<a name="l15872"></a>15872                  (($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) OR ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) OR ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>))) {
<a name="l15873"></a>15873                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="charliteral">&#39;R&#39;</span>;
<a name="l15874"></a>15874                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) {
<a name="l15875"></a>15875                     <span class="comment">// N2. Any remaining neutrals take the embedding direction</span>
<a name="l15876"></a>15876                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;sor&#39;</span>];
<a name="l15877"></a>15877                 }
<a name="l15878"></a>15878             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($levcount &gt; 0) AND (((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1) == $numchars) OR ((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1) &lt; $numchars) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)][<span class="stringliteral">&#39;level&#39;</span>] != $prevlevel))) {
<a name="l15879"></a>15879                 <span class="comment">//last char</span>
<a name="l15880"></a>15880                 <span class="keywordflow">if</span> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) AND ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) AND ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;eor&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>)) {
<a name="l15881"></a>15881                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="charliteral">&#39;L&#39;</span>;
<a name="l15882"></a>15882                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) AND
<a name="l15883"></a>15883                  (($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) OR ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) OR ($chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>)) AND
<a name="l15884"></a>15884                  (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;eor&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;eor&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;eor&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>))) {
<a name="l15885"></a>15885                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = <span class="charliteral">&#39;R&#39;</span>;
<a name="l15886"></a>15886                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) {
<a name="l15887"></a>15887                     <span class="comment">// N2. Any remaining neutrals take the embedding direction</span>
<a name="l15888"></a>15888                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;sor&#39;</span>];
<a name="l15889"></a>15889                 }
<a name="l15890"></a>15890             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;N&#39;</span>) {
<a name="l15891"></a>15891                 <span class="comment">// N2. Any remaining neutrals take the embedding direction</span>
<a name="l15892"></a>15892                 $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;sor&#39;</span>];
<a name="l15893"></a>15893             }
<a name="l15894"></a>15894             <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] != $prevlevel) {
<a name="l15895"></a>15895                 $levcount = 0;
<a name="l15896"></a>15896             } <span class="keywordflow">else</span> {
<a name="l15897"></a>15897                 ++$levcount;
<a name="l15898"></a>15898             }
<a name="l15899"></a>15899             $prevlevel = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>];
<a name="l15900"></a>15900         }
<a name="l15901"></a>15901 
<a name="l15902"></a>15902         <span class="comment">// I1. For all characters with an even (left-to-right) embedding direction, those of type R go up one level and those of type AN or EN go up two levels.</span>
<a name="l15903"></a>15903         <span class="comment">// I2. For all characters with an odd (right-to-left) embedding direction, those of type L, EN or AN go up one level.</span>
<a name="l15904"></a>15904         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15905"></a>15905             $odd = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] % 2;
<a name="l15906"></a>15906             <span class="keywordflow">if</span> ($odd) {
<a name="l15907"></a>15907                 <span class="keywordflow">if</span> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>)) {
<a name="l15908"></a>15908                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] += 1;
<a name="l15909"></a>15909                 }
<a name="l15910"></a>15910             } <span class="keywordflow">else</span> {
<a name="l15911"></a>15911                 <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l15912"></a>15912                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] += 1;
<a name="l15913"></a>15913                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;AN&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;EN&#39;</span>)) {
<a name="l15914"></a>15914                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] += 2;
<a name="l15915"></a>15915                 }
<a name="l15916"></a>15916             }
<a name="l15917"></a>15917             $maxlevel = max($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>],$maxlevel);
<a name="l15918"></a>15918         }
<a name="l15919"></a>15919 
<a name="l15920"></a>15920         <span class="comment">// L1. On each line, reset the embedding level of the following characters to the paragraph embedding level:</span>
<a name="l15921"></a>15921         <span class="comment">//  1. Segment separators,</span>
<a name="l15922"></a>15922         <span class="comment">//  2. Paragraph separators,</span>
<a name="l15923"></a>15923         <span class="comment">//  3. Any sequence of whitespace characters preceding a segment separator or paragraph separator, and</span>
<a name="l15924"></a>15924         <span class="comment">//  4. Any sequence of white space characters at the end of the line.</span>
<a name="l15925"></a>15925         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15926"></a>15926             <span class="keywordflow">if</span> (($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;B&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;S&#39;</span>)) {
<a name="l15927"></a>15927                 $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] = $pel;
<a name="l15928"></a>15928             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;WS&#39;</span>) {
<a name="l15929"></a>15929                 $j = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1;
<a name="l15930"></a>15930                 <span class="keywordflow">while</span> ($j &lt; $numchars) {
<a name="l15931"></a>15931                     <span class="keywordflow">if</span> ((($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;B&#39;</span>) OR ($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] == <span class="charliteral">&#39;S&#39;</span>)) OR
<a name="l15932"></a>15932                         (($j == ($numchars-1)) AND ($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;WS&#39;</span>))) {
<a name="l15933"></a>15933                         $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] = $pel;
<a name="l15934"></a>15934                         <span class="keywordflow">break</span>;
<a name="l15935"></a>15935                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($chardata[$j][<span class="stringliteral">&#39;type&#39;</span>] != <span class="stringliteral">&#39;WS&#39;</span>) {
<a name="l15936"></a>15936                         <span class="keywordflow">break</span>;
<a name="l15937"></a>15937                     }
<a name="l15938"></a>15938                     ++$j;
<a name="l15939"></a>15939                 }
<a name="l15940"></a>15940             }
<a name="l15941"></a>15941         }
<a name="l15942"></a>15942 
<a name="l15943"></a>15943         <span class="comment">// Arabic Shaping</span>
<a name="l15944"></a>15944         <span class="comment">// Cursively connected scripts, such as Arabic or Syriac, require the selection of positional character shapes that depend on adjacent characters. Shaping is logically applied after the Bidirectional Algorithm is used and is limited to characters within the same directional run.</span>
<a name="l15945"></a>15945         <span class="keywordflow">if</span> ($arabic) {
<a name="l15946"></a>15946             $endedletter = array(1569,1570,1571,1572,1573,1575,1577,1583,1584,1585,1586,1608,1688);
<a name="l15947"></a>15947             $alfletter = array(1570,1571,1573,1575);
<a name="l15948"></a>15948             $chardata2 = $chardata;
<a name="l15949"></a>15949             $laaletter = <span class="keyword">false</span>;
<a name="l15950"></a>15950             $charAL = array();
<a name="l15951"></a>15951             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = 0;
<a name="l15952"></a>15952             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15953"></a>15953                 <span class="keywordflow">if</span> (($this-&gt;unicode-&gt;uni_type[$chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;AL&#39;</span>) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] == 32) OR ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] == 8204)) {
<a name="l15954"></a>15954                     $charAL[<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>] = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l15955"></a>15955                     $charAL[<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>][<span class="charliteral">&#39;i&#39;</span>] = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l15956"></a>15956                     $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="charliteral">&#39;x&#39;</span>] = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l15957"></a>15957                     ++<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l15958"></a>15958                 }
<a name="l15959"></a>15959             }
<a name="l15960"></a>15960             $numAL = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l15961"></a>15961             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l15962"></a>15962                 $thischar = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l15963"></a>15963                 <span class="keywordflow">if</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; 0) {
<a name="l15964"></a>15964                     $prevchar = $chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1)];
<a name="l15965"></a>15965                 } <span class="keywordflow">else</span> {
<a name="l15966"></a>15966                     $prevchar = <span class="keyword">false</span>;
<a name="l15967"></a>15967                 }
<a name="l15968"></a>15968                 <span class="keywordflow">if</span> ((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1) &lt; $numchars) {
<a name="l15969"></a>15969                     $nextchar = $chardata[(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1)];
<a name="l15970"></a>15970                 } <span class="keywordflow">else</span> {
<a name="l15971"></a>15971                     $nextchar = <span class="keyword">false</span>;
<a name="l15972"></a>15972                 }
<a name="l15973"></a>15973                 <span class="keywordflow">if</span> ($this-&gt;unicode-&gt;uni_type[$thischar[<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;AL&#39;</span>) {
<a name="l15974"></a>15974                     <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $thischar[<span class="charliteral">&#39;x&#39;</span>];
<a name="l15975"></a>15975                     <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> &gt; 0) {
<a name="l15976"></a>15976                         $prevchar = $charAL[(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>-1)];
<a name="l15977"></a>15977                     } <span class="keywordflow">else</span> {
<a name="l15978"></a>15978                         $prevchar = <span class="keyword">false</span>;
<a name="l15979"></a>15979                     }
<a name="l15980"></a>15980                     <span class="keywordflow">if</span> ((<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>+1) &lt; $numAL) {
<a name="l15981"></a>15981                         $nextchar = $charAL[(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>+1)];
<a name="l15982"></a>15982                     } <span class="keywordflow">else</span> {
<a name="l15983"></a>15983                         $nextchar = <span class="keyword">false</span>;
<a name="l15984"></a>15984                     }
<a name="l15985"></a>15985                     <span class="comment">// if laa letter</span>
<a name="l15986"></a>15986                     <span class="keywordflow">if</span> (($prevchar !== <span class="keyword">false</span>) AND ($prevchar[<span class="stringliteral">&#39;char&#39;</span>] == 1604) AND (in_array($thischar[<span class="stringliteral">&#39;char&#39;</span>], $alfletter))) {
<a name="l15987"></a>15987                         $arabicarr = $this-&gt;unicode-&gt;uni_laa_array;
<a name="l15988"></a>15988                         $laaletter = <span class="keyword">true</span>;
<a name="l15989"></a>15989                         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> &gt; 1) {
<a name="l15990"></a>15990                             $prevchar = $charAL[(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>-2)];
<a name="l15991"></a>15991                         } <span class="keywordflow">else</span> {
<a name="l15992"></a>15992                             $prevchar = <span class="keyword">false</span>;
<a name="l15993"></a>15993                         }
<a name="l15994"></a>15994                     } <span class="keywordflow">else</span> {
<a name="l15995"></a>15995                         $arabicarr = $this-&gt;unicode-&gt;uni_arabicsubst;
<a name="l15996"></a>15996                         $laaletter = <span class="keyword">false</span>;
<a name="l15997"></a>15997                     }
<a name="l15998"></a>15998                     <span class="keywordflow">if</span> (($prevchar !== <span class="keyword">false</span>) AND ($nextchar !== <span class="keyword">false</span>) AND
<a name="l15999"></a>15999                         (($this-&gt;unicode-&gt;uni_type[$prevchar[<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;AL&#39;</span>) OR ($this-&gt;unicode-&gt;uni_type[$prevchar[<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;NSM&#39;</span>)) AND
<a name="l16000"></a>16000                         (($this-&gt;unicode-&gt;uni_type[$nextchar[<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;AL&#39;</span>) OR ($this-&gt;unicode-&gt;uni_type[$nextchar[<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;NSM&#39;</span>)) AND
<a name="l16001"></a>16001                         ($prevchar[<span class="stringliteral">&#39;type&#39;</span>] == $thischar[<span class="stringliteral">&#39;type&#39;</span>]) AND
<a name="l16002"></a>16002                         ($nextchar[<span class="stringliteral">&#39;type&#39;</span>] == $thischar[<span class="stringliteral">&#39;type&#39;</span>]) AND
<a name="l16003"></a>16003                         ($nextchar[<span class="stringliteral">&#39;char&#39;</span>] != 1567)) {
<a name="l16004"></a>16004                         <span class="keywordflow">if</span> (in_array($prevchar[<span class="stringliteral">&#39;char&#39;</span>], $endedletter)) {
<a name="l16005"></a>16005                             <span class="keywordflow">if</span> (isset($arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][2])) {
<a name="l16006"></a>16006                                 <span class="comment">// initial</span>
<a name="l16007"></a>16007                                 $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] = $arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][2];
<a name="l16008"></a>16008                             }
<a name="l16009"></a>16009                         } <span class="keywordflow">else</span> {
<a name="l16010"></a>16010                             <span class="keywordflow">if</span> (isset($arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][3])) {
<a name="l16011"></a>16011                                 <span class="comment">// medial</span>
<a name="l16012"></a>16012                                 $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] = $arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][3];
<a name="l16013"></a>16013                             }
<a name="l16014"></a>16014                         }
<a name="l16015"></a>16015                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($nextchar !== <span class="keyword">false</span>) AND
<a name="l16016"></a>16016                         (($this-&gt;unicode-&gt;uni_type[$nextchar[<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;AL&#39;</span>) OR ($this-&gt;unicode-&gt;uni_type[$nextchar[<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;NSM&#39;</span>)) AND
<a name="l16017"></a>16017                         ($nextchar[<span class="stringliteral">&#39;type&#39;</span>] == $thischar[<span class="stringliteral">&#39;type&#39;</span>]) AND
<a name="l16018"></a>16018                         ($nextchar[<span class="stringliteral">&#39;char&#39;</span>] != 1567)) {
<a name="l16019"></a>16019                         <span class="keywordflow">if</span> (isset($arabicarr[$chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>]][2])) {
<a name="l16020"></a>16020                             <span class="comment">// initial</span>
<a name="l16021"></a>16021                             $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] = $arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][2];
<a name="l16022"></a>16022                         }
<a name="l16023"></a>16023                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((($prevchar !== <span class="keyword">false</span>) AND
<a name="l16024"></a>16024                         (($this-&gt;unicode-&gt;uni_type[$prevchar[<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;AL&#39;</span>) OR ($this-&gt;unicode-&gt;uni_type[$prevchar[<span class="stringliteral">&#39;char&#39;</span>]] == <span class="stringliteral">&#39;NSM&#39;</span>)) AND
<a name="l16025"></a>16025                         ($prevchar[<span class="stringliteral">&#39;type&#39;</span>] == $thischar[<span class="stringliteral">&#39;type&#39;</span>])) OR
<a name="l16026"></a>16026                         (($nextchar !== <span class="keyword">false</span>) AND ($nextchar[<span class="stringliteral">&#39;char&#39;</span>] == 1567))) {
<a name="l16027"></a>16027                         <span class="comment">// final</span>
<a name="l16028"></a>16028                         <span class="keywordflow">if</span> ((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; 1) AND ($thischar[<span class="stringliteral">&#39;char&#39;</span>] == 1607) AND
<a name="l16029"></a>16029                             ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1][<span class="stringliteral">&#39;char&#39;</span>] == 1604) AND
<a name="l16030"></a>16030                             ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-2][<span class="stringliteral">&#39;char&#39;</span>] == 1604)) {
<a name="l16031"></a>16031                             <span class="comment">//Allah Word</span>
<a name="l16032"></a>16032                             <span class="comment">// mark characters to delete with false</span>
<a name="l16033"></a>16033                             $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-2][<span class="stringliteral">&#39;char&#39;</span>] = <span class="keyword">false</span>;
<a name="l16034"></a>16034                             $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>-1][<span class="stringliteral">&#39;char&#39;</span>] = <span class="keyword">false</span>;
<a name="l16035"></a>16035                             $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] = 65010;
<a name="l16036"></a>16036                         } <span class="keywordflow">else</span> {
<a name="l16037"></a>16037                             <span class="keywordflow">if</span> (($prevchar !== <span class="keyword">false</span>) AND in_array($prevchar[<span class="stringliteral">&#39;char&#39;</span>], $endedletter)) {
<a name="l16038"></a>16038                                 <span class="keywordflow">if</span> (isset($arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][0])) {
<a name="l16039"></a>16039                                     <span class="comment">// isolated</span>
<a name="l16040"></a>16040                                     $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] = $arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][0];
<a name="l16041"></a>16041                                 }
<a name="l16042"></a>16042                             } <span class="keywordflow">else</span> {
<a name="l16043"></a>16043                                 <span class="keywordflow">if</span> (isset($arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][1])) {
<a name="l16044"></a>16044                                     <span class="comment">// final</span>
<a name="l16045"></a>16045                                     $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] = $arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][1];
<a name="l16046"></a>16046                                 }
<a name="l16047"></a>16047                             }
<a name="l16048"></a>16048                         }
<a name="l16049"></a>16049                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][0])) {
<a name="l16050"></a>16050                         <span class="comment">// isolated</span>
<a name="l16051"></a>16051                         $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] = $arabicarr[$thischar[<span class="stringliteral">&#39;char&#39;</span>]][0];
<a name="l16052"></a>16052                     }
<a name="l16053"></a>16053                     <span class="comment">// if laa letter</span>
<a name="l16054"></a>16054                     <span class="keywordflow">if</span> ($laaletter) {
<a name="l16055"></a>16055                         <span class="comment">// mark characters to delete with false</span>
<a name="l16056"></a>16056                         $chardata2[($charAL[(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>-1)][<span class="charliteral">&#39;i&#39;</span>])][<span class="stringliteral">&#39;char&#39;</span>] = <span class="keyword">false</span>;
<a name="l16057"></a>16057                     }
<a name="l16058"></a>16058                 } <span class="comment">// end if AL (Arabic Letter)</span>
<a name="l16059"></a>16059             } <span class="comment">// end for each char</span>
<a name="l16060"></a>16060             <span class="comment">/*</span>
<a name="l16061"></a>16061 <span class="comment">             * Combining characters that can occur with Arabic Shadda (0651 HEX, 1617 DEC) are replaced.</span>
<a name="l16062"></a>16062 <span class="comment">             * Putting the combining mark and shadda in the same glyph allows us to avoid the two marks overlapping each other in an illegible manner.</span>
<a name="l16063"></a>16063 <span class="comment">             */</span>
<a name="l16064"></a>16064             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; ($numchars-1); ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l16065"></a>16065                 <span class="keywordflow">if</span> (($chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] == 1617) AND (isset($this-&gt;unicode-&gt;uni_diacritics[($chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1][<span class="stringliteral">&#39;char&#39;</span>])]))) {
<a name="l16066"></a>16066                     <span class="comment">// check if the subtitution font is defined on current font</span>
<a name="l16067"></a>16067                     <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][($this-&gt;unicode-&gt;uni_diacritics[($chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1][<span class="stringliteral">&#39;char&#39;</span>])])])) {
<a name="l16068"></a>16068                         $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] = <span class="keyword">false</span>;
<a name="l16069"></a>16069                         $chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1][<span class="stringliteral">&#39;char&#39;</span>] = $this-&gt;unicode-&gt;uni_diacritics[($chardata2[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>+1][<span class="stringliteral">&#39;char&#39;</span>])];
<a name="l16070"></a>16070                     }
<a name="l16071"></a>16071                 }
<a name="l16072"></a>16072             }
<a name="l16073"></a>16073             <span class="comment">// remove marked characters</span>
<a name="l16074"></a>16074             <span class="keywordflow">foreach</span> ($chardata2 as $key =&gt; $value) {
<a name="l16075"></a>16075                 <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;char&#39;</span>] === <span class="keyword">false</span>) {
<a name="l16076"></a>16076                     unset($chardata2[$key]);
<a name="l16077"></a>16077                 }
<a name="l16078"></a>16078             }
<a name="l16079"></a>16079             $chardata = array_values($chardata2);
<a name="l16080"></a>16080             $numchars = count($chardata);
<a name="l16081"></a>16081             unset($chardata2);
<a name="l16082"></a>16082             unset($arabicarr);
<a name="l16083"></a>16083             unset($laaletter);
<a name="l16084"></a>16084             unset($charAL);
<a name="l16085"></a>16085         }
<a name="l16086"></a>16086 
<a name="l16087"></a>16087         <span class="comment">// L2. From the highest level found in the text to the lowest odd level on each line, including intermediate levels not actually present in the text, reverse any contiguous sequence of characters that are at that level or higher.</span>
<a name="l16088"></a>16088         <span class="keywordflow">for</span> ($j=$maxlevel; $j &gt; 0; $j--) {
<a name="l16089"></a>16089             $ordarray = Array();
<a name="l16090"></a>16090             $revarr = Array();
<a name="l16091"></a>16091             $onlevel = <span class="keyword">false</span>;
<a name="l16092"></a>16092             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l16093"></a>16093                 <span class="keywordflow">if</span> ($chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;level&#39;</span>] &gt;= $j) {
<a name="l16094"></a>16094                     $onlevel = <span class="keyword">true</span>;
<a name="l16095"></a>16095                     <span class="keywordflow">if</span> (isset($this-&gt;unicode-&gt;uni_mirror[$chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>]])) {
<a name="l16096"></a>16096                         <span class="comment">// L4. A character is depicted by a mirrored glyph if and only if (a) the resolved directionality of that character is R, and (b) the Bidi_Mirrored property value of that character is true.</span>
<a name="l16097"></a>16097                         $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>] = $this-&gt;unicode-&gt;uni_mirror[$chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>]];
<a name="l16098"></a>16098                     }
<a name="l16099"></a>16099                     $revarr[] = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l16100"></a>16100                 } <span class="keywordflow">else</span> {
<a name="l16101"></a>16101                     <span class="keywordflow">if</span> ($onlevel) {
<a name="l16102"></a>16102                         $revarr = array_reverse($revarr);
<a name="l16103"></a>16103                         $ordarray = array_merge($ordarray, $revarr);
<a name="l16104"></a>16104                         $revarr = Array();
<a name="l16105"></a>16105                         $onlevel = <span class="keyword">false</span>;
<a name="l16106"></a>16106                     }
<a name="l16107"></a>16107                     $ordarray[] = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l16108"></a>16108                 }
<a name="l16109"></a>16109             }
<a name="l16110"></a>16110             <span class="keywordflow">if</span> ($onlevel) {
<a name="l16111"></a>16111                 $revarr = array_reverse($revarr);
<a name="l16112"></a>16112                 $ordarray = array_merge($ordarray, $revarr);
<a name="l16113"></a>16113             }
<a name="l16114"></a>16114             $chardata = $ordarray;
<a name="l16115"></a>16115         }
<a name="l16116"></a>16116 
<a name="l16117"></a>16117         $ordarray = array();
<a name="l16118"></a>16118         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numchars; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l16119"></a>16119             $ordarray[] = $chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>];
<a name="l16120"></a>16120             <span class="comment">// store char values for subsetting</span>
<a name="l16121"></a>16121             $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>][$chardata[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;char&#39;</span>]] = <span class="keyword">true</span>;
<a name="l16122"></a>16122         }
<a name="l16123"></a>16123         <span class="comment">// update font subsetchars</span>
<a name="l16124"></a>16124         $this-&gt;setFontSubBuffer($this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>], <span class="stringliteral">&#39;subsetchars&#39;</span>, $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>]);
<a name="l16125"></a>16125         <span class="keywordflow">return</span> $ordarray;
<a name="l16126"></a>16126     }
<a name="l16127"></a>16127 
<a name="l16128"></a>16128     <span class="comment">// END OF BIDIRECTIONAL TEXT SECTION -------------------</span>
<a name="l16129"></a>16129 <span class="comment"></span>
<a name="l16130"></a>16130 <span class="comment">    /**</span>
<a name="l16131"></a>16131 <span class="comment">     * Encode a name object.</span>
<a name="l16132"></a>16132 <span class="comment">     * @param $name (string) Name object to encode.</span>
<a name="l16133"></a>16133 <span class="comment">     * @return (string) Encoded name object.</span>
<a name="l16134"></a>16134 <span class="comment">     * @protected</span>
<a name="l16135"></a>16135 <span class="comment">     * @author Nicola Asuni</span>
<a name="l16136"></a>16136 <span class="comment">     * @since 5.9.097 (2011-06-23)</span>
<a name="l16137"></a>16137 <span class="comment">     */</span>
<a name="l16138"></a><a class="code" href="classTCPDF.html#a9f3f66a28c4d0619bd15d0e7714aea4c">16138</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9f3f66a28c4d0619bd15d0e7714aea4c" title="Encode a name object.">encodeNameObject</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) {
<a name="l16139"></a>16139         $escname = <span class="stringliteral">&#39;&#39;</span>;
<a name="l16140"></a>16140         $length = strlen(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l16141"></a>16141         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $length; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l16142"></a>16142             $chr = <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l16143"></a>16143             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[0-9a-zA-Z]/&#39;</span>, $chr) == 1) {
<a name="l16144"></a>16144                 $escname .= $chr;
<a name="l16145"></a>16145             } <span class="keywordflow">else</span> {
<a name="l16146"></a>16146                 $escname .= sprintf(<span class="stringliteral">&#39;#%02X&#39;</span>, ord($chr));
<a name="l16147"></a>16147             }
<a name="l16148"></a>16148         }
<a name="l16149"></a>16149         <span class="keywordflow">return</span> $escname;
<a name="l16150"></a>16150     }
<a name="l16151"></a>16151 <span class="comment"></span>
<a name="l16152"></a>16152 <span class="comment">    /**</span>
<a name="l16153"></a>16153 <span class="comment">     * Add a Named Destination.</span>
<a name="l16154"></a>16154 <span class="comment">     * NOTE: destination names are unique, so only last entry will be saved.</span>
<a name="l16155"></a>16155 <span class="comment">     * @param $name (string) Destination name.</span>
<a name="l16156"></a>16156 <span class="comment">     * @param $y (float) Y position in user units of the destiantion on the selected page (default = -1 = current position; 0 = page start;).</span>
<a name="l16157"></a>16157 <span class="comment">     * @param $page (int) Target page number (leave empty for current page).</span>
<a name="l16158"></a>16158 <span class="comment">     * @return (string) Stripped named destination identifier or false in case of error.</span>
<a name="l16159"></a>16159 <span class="comment">     * @public</span>
<a name="l16160"></a>16160 <span class="comment">     * @author Christian Deligant, Nicola Asuni</span>
<a name="l16161"></a>16161 <span class="comment">     * @since 5.9.097 (2011-06-23)</span>
<a name="l16162"></a>16162 <span class="comment">     */</span>
<a name="l16163"></a><a class="code" href="classTCPDF.html#a9a50dc7b54929444110f1837d389f793">16163</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9a50dc7b54929444110f1837d389f793" title="Add a Named Destination.">setDestination</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $y=-1, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l16164"></a>16164         <span class="comment">// remove unsupported characters</span>
<a name="l16165"></a>16165         <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = $this-&gt;encodeNameObject(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l16166"></a>16166         <span class="keywordflow">if</span> ($this-&gt;empty_string(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>)) {
<a name="l16167"></a>16167             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l16168"></a>16168         }
<a name="l16169"></a>16169         <span class="keywordflow">if</span> ($y == -1) {
<a name="l16170"></a>16170             $y = $this-&gt;GetY();
<a name="l16171"></a>16171         }
<a name="l16172"></a>16172         <span class="keywordflow">if</span> (empty(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l16173"></a>16173             <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = $this-&gt;PageNo();
<a name="l16174"></a>16174             <span class="keywordflow">if</span> (empty(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l16175"></a>16175                 <span class="keywordflow">return</span>;
<a name="l16176"></a>16176             }
<a name="l16177"></a>16177         }
<a name="l16178"></a>16178         $this-&gt;dests[<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>] = array(<span class="charliteral">&#39;y&#39;</span> =&gt; $y, <span class="charliteral">&#39;p&#39;</span> =&gt; <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>);
<a name="l16179"></a>16179         <span class="keywordflow">return</span> <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>;
<a name="l16180"></a>16180     }
<a name="l16181"></a>16181 <span class="comment"></span>
<a name="l16182"></a>16182 <span class="comment">    /**</span>
<a name="l16183"></a>16183 <span class="comment">     * Return the Named Destination array.</span>
<a name="l16184"></a>16184 <span class="comment">     * @return (array) Named Destination array.</span>
<a name="l16185"></a>16185 <span class="comment">     * @public</span>
<a name="l16186"></a>16186 <span class="comment">     * @author Nicola Asuni</span>
<a name="l16187"></a>16187 <span class="comment">     * @since 5.9.097 (2011-06-23)</span>
<a name="l16188"></a>16188 <span class="comment">     */</span>
<a name="l16189"></a><a class="code" href="classTCPDF.html#a4a6a1902a07dbb6a98f107ae2b9574ce">16189</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4a6a1902a07dbb6a98f107ae2b9574ce" title="Return the Named Destination array.">getDestination</a>() {
<a name="l16190"></a>16190         <span class="keywordflow">return</span> $this-&gt;dests;
<a name="l16191"></a>16191     }
<a name="l16192"></a>16192 <span class="comment"></span>
<a name="l16193"></a>16193 <span class="comment">    /**</span>
<a name="l16194"></a>16194 <span class="comment">     * Create a javascript PDF string.</span>
<a name="l16195"></a>16195 <span class="comment">     * @protected</span>
<a name="l16196"></a>16196 <span class="comment">     * @author Johannes Güntert, Nicola Asuni</span>
<a name="l16197"></a>16197 <span class="comment">     * @since 5.9.098 (2011-06-23)</span>
<a name="l16198"></a>16198 <span class="comment">     */</span>
<a name="l16199"></a><a class="code" href="classTCPDF.html#abc3ef1743fa889f0190b61d80490a770">16199</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#abc3ef1743fa889f0190b61d80490a770" title="Create a javascript PDF string.">_putdests</a>() {
<a name="l16200"></a>16200         <span class="keywordflow">if</span> (empty($this-&gt;dests)) {
<a name="l16201"></a>16201             <span class="keywordflow">return</span>;
<a name="l16202"></a>16202         }
<a name="l16203"></a>16203         $this-&gt;n_dests = $this-&gt;_newobj();
<a name="l16204"></a>16204         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39; &lt;&lt;&#39;</span>;
<a name="l16205"></a>16205         <span class="keywordflow">foreach</span>($this-&gt;dests as <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> =&gt; $o) {
<a name="l16206"></a>16206             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$name.<span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;[%u 0 R /XYZ 0 %.2F null]&#39;</span>, $this-&gt;page_obj_id[($o[<span class="charliteral">&#39;p&#39;</span>])], ($this-&gt;pagedim[$o[<span class="charliteral">&#39;p&#39;</span>]][<span class="charliteral">&#39;h&#39;</span>] - ($o[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k)));
<a name="l16207"></a>16207         }
<a name="l16208"></a>16208         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l16209"></a>16209         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l16210"></a>16210         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l16211"></a>16211     }
<a name="l16212"></a>16212 <span class="comment"></span>
<a name="l16213"></a>16213 <span class="comment">    /**</span>
<a name="l16214"></a>16214 <span class="comment">     * Adds a bookmark - alias for Bookmark().</span>
<a name="l16215"></a>16215 <span class="comment">     * @param $txt (string) Bookmark description.</span>
<a name="l16216"></a>16216 <span class="comment">     * @param $level (int) Bookmark level (minimum value is 0).</span>
<a name="l16217"></a>16217 <span class="comment">     * @param $y (float) Y position in user units of the bookmark on the selected page (default = -1 = current position; 0 = page start;).</span>
<a name="l16218"></a>16218 <span class="comment">     * @param $page (int) Target page number (leave empty for current page).</span>
<a name="l16219"></a>16219 <span class="comment">     * @param $style (string) Font style: B = Bold, I = Italic, BI = Bold + Italic.</span>
<a name="l16220"></a>16220 <span class="comment">     * @param $color (array) RGB color array (values from 0 to 255).</span>
<a name="l16221"></a>16221 <span class="comment">     * @public</span>
<a name="l16222"></a>16222 <span class="comment">     */</span>
<a name="l16223"></a><a class="code" href="classTCPDF.html#a92be29b85515132a2d9c88b86e084d98">16223</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a92be29b85515132a2d9c88b86e084d98" title="Adds a bookmark - alias for Bookmark().">setBookmark</a>($txt, $level=0, $y=-1, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $color=array(0,0,0)) {
<a name="l16224"></a>16224         $this-&gt;Bookmark($txt, $level, $y, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>, $style, $color);
<a name="l16225"></a>16225     }
<a name="l16226"></a>16226 <span class="comment"></span>
<a name="l16227"></a>16227 <span class="comment">    /**</span>
<a name="l16228"></a>16228 <span class="comment">     * Adds a bookmark.</span>
<a name="l16229"></a>16229 <span class="comment">     * @param $txt (string) Bookmark description.</span>
<a name="l16230"></a>16230 <span class="comment">     * @param $level (int) Bookmark level (minimum value is 0).</span>
<a name="l16231"></a>16231 <span class="comment">     * @param $y (float) Y position in user units of the bookmark on the selected page (default = -1 = current position; 0 = page start;).</span>
<a name="l16232"></a>16232 <span class="comment">     * @param $page (int) Target page number (leave empty for current page).</span>
<a name="l16233"></a>16233 <span class="comment">     * @param $style (string) Font style: B = Bold, I = Italic, BI = Bold + Italic.</span>
<a name="l16234"></a>16234 <span class="comment">     * @param $color (array) RGB color array (values from 0 to 255).</span>
<a name="l16235"></a>16235 <span class="comment">     * @public</span>
<a name="l16236"></a>16236 <span class="comment">     * @author Olivier Plathey, Nicola Asuni</span>
<a name="l16237"></a>16237 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l16238"></a>16238 <span class="comment">     */</span>
<a name="l16239"></a><a class="code" href="classTCPDF.html#a7178fade5374927babb27850c27f750c">16239</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7178fade5374927babb27850c27f750c" title="Adds a bookmark.">Bookmark</a>($txt, $level=0, $y=-1, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $color=array(0,0,0)) {
<a name="l16240"></a>16240         <span class="keywordflow">if</span> ($level &lt; 0) {
<a name="l16241"></a>16241             $level = 0;
<a name="l16242"></a>16242         }
<a name="l16243"></a>16243         <span class="keywordflow">if</span> (isset($this-&gt;outlines[0])) {
<a name="l16244"></a>16244             $lastoutline = end($this-&gt;outlines);
<a name="l16245"></a>16245             $maxlevel = $lastoutline[<span class="charliteral">&#39;l&#39;</span>] + 1;
<a name="l16246"></a>16246         } <span class="keywordflow">else</span> {
<a name="l16247"></a>16247             $maxlevel = 0;
<a name="l16248"></a>16248         }
<a name="l16249"></a>16249         <span class="keywordflow">if</span> ($level &gt; $maxlevel) {
<a name="l16250"></a>16250             $level = $maxlevel;
<a name="l16251"></a>16251         }
<a name="l16252"></a>16252         <span class="keywordflow">if</span> ($y == -1) {
<a name="l16253"></a>16253             $y = $this-&gt;GetY();
<a name="l16254"></a>16254         }
<a name="l16255"></a>16255         <span class="keywordflow">if</span> (empty(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l16256"></a>16256             <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = $this-&gt;PageNo();
<a name="l16257"></a>16257             <span class="keywordflow">if</span> (empty(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l16258"></a>16258                 <span class="keywordflow">return</span>;
<a name="l16259"></a>16259             }
<a name="l16260"></a>16260         }
<a name="l16261"></a>16261         $this-&gt;outlines[] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $txt, <span class="charliteral">&#39;l&#39;</span> =&gt; $level, <span class="charliteral">&#39;y&#39;</span> =&gt; $y, <span class="charliteral">&#39;p&#39;</span> =&gt; <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>, <span class="charliteral">&#39;s&#39;</span> =&gt; strtoupper($style), <span class="charliteral">&#39;c&#39;</span> =&gt; $color);
<a name="l16262"></a>16262     }
<a name="l16263"></a>16263 <span class="comment"></span>
<a name="l16264"></a>16264 <span class="comment">    /**</span>
<a name="l16265"></a>16265 <span class="comment">     * Sort bookmarks for page and key.</span>
<a name="l16266"></a>16266 <span class="comment">     * @protected</span>
<a name="l16267"></a>16267 <span class="comment">     * @since 5.9.119 (2011-09-19)</span>
<a name="l16268"></a>16268 <span class="comment">     */</span>
<a name="l16269"></a><a class="code" href="classTCPDF.html#a40e972ed81a794c72ef784a5ba23bf72">16269</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a40e972ed81a794c72ef784a5ba23bf72" title="Sort bookmarks for page and key.">sortBookmarks</a>() {
<a name="l16270"></a>16270         <span class="comment">// get sorting columns</span>
<a name="l16271"></a>16271         $outline_p = array();
<a name="l16272"></a>16272         $outline_y = array();
<a name="l16273"></a>16273         <span class="keywordflow">foreach</span> ($this-&gt;outlines as $key =&gt; <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>) {
<a name="l16274"></a>16274             $outline_p[$key] = <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>[<span class="charliteral">&#39;p&#39;</span>];
<a name="l16275"></a>16275             $outline_k[$key] = $key;
<a name="l16276"></a>16276         }
<a name="l16277"></a>16277         <span class="comment">// sort outlines by page and original position</span>
<a name="l16278"></a>16278         array_multisort($outline_p, SORT_NUMERIC, SORT_ASC, $outline_k, SORT_NUMERIC, SORT_ASC, $this-&gt;outlines);
<a name="l16279"></a>16279     }
<a name="l16280"></a>16280 <span class="comment"></span>
<a name="l16281"></a>16281 <span class="comment">    /**</span>
<a name="l16282"></a>16282 <span class="comment">     * Create a bookmark PDF string.</span>
<a name="l16283"></a>16283 <span class="comment">     * @protected</span>
<a name="l16284"></a>16284 <span class="comment">     * @author Olivier Plathey, Nicola Asuni</span>
<a name="l16285"></a>16285 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l16286"></a>16286 <span class="comment">     */</span>
<a name="l16287"></a><a class="code" href="classTCPDF.html#a42a44895af6f9c61714d178ec0260267">16287</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a42a44895af6f9c61714d178ec0260267" title="Create a bookmark PDF string.">_putbookmarks</a>() {
<a name="l16288"></a>16288         $nb = count($this-&gt;outlines);
<a name="l16289"></a>16289         <span class="keywordflow">if</span> ($nb == 0) {
<a name="l16290"></a>16290             <span class="keywordflow">return</span>;
<a name="l16291"></a>16291         }
<a name="l16292"></a>16292         <span class="comment">// sort bookmarks</span>
<a name="l16293"></a>16293         $this-&gt;sortBookmarks();
<a name="l16294"></a>16294         $lru = array();
<a name="l16295"></a>16295         $level = 0;
<a name="l16296"></a>16296         <span class="keywordflow">foreach</span> ($this-&gt;outlines as <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> =&gt; $o) {
<a name="l16297"></a>16297             <span class="keywordflow">if</span> ($o[<span class="charliteral">&#39;l&#39;</span>] &gt; 0) {
<a name="l16298"></a>16298                 $parent = $lru[($o[<span class="charliteral">&#39;l&#39;</span>] - 1)];
<a name="l16299"></a>16299                 <span class="comment">//Set parent and last pointers</span>
<a name="l16300"></a>16300                 $this-&gt;outlines[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;parent&#39;</span>] = $parent;
<a name="l16301"></a>16301                 $this-&gt;outlines[$parent][<span class="stringliteral">&#39;last&#39;</span>] = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l16302"></a>16302                 <span class="keywordflow">if</span> ($o[<span class="charliteral">&#39;l&#39;</span>] &gt; $level) {
<a name="l16303"></a>16303                     <span class="comment">//Level increasing: set first pointer</span>
<a name="l16304"></a>16304                     $this-&gt;outlines[$parent][<span class="stringliteral">&#39;first&#39;</span>] = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l16305"></a>16305                 }
<a name="l16306"></a>16306             } <span class="keywordflow">else</span> {
<a name="l16307"></a>16307                 $this-&gt;outlines[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;parent&#39;</span>] = $nb;
<a name="l16308"></a>16308             }
<a name="l16309"></a>16309             <span class="keywordflow">if</span> (($o[<span class="charliteral">&#39;l&#39;</span>] &lt;= $level) AND (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; 0)) {
<a name="l16310"></a>16310                 <span class="comment">//Set prev and next pointers</span>
<a name="l16311"></a>16311                 $prev = $lru[$o[<span class="charliteral">&#39;l&#39;</span>]];
<a name="l16312"></a>16312                 $this-&gt;outlines[$prev][<span class="stringliteral">&#39;next&#39;</span>] = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l16313"></a>16313                 $this-&gt;outlines[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;prev&#39;</span>] = $prev;
<a name="l16314"></a>16314             }
<a name="l16315"></a>16315             $lru[$o[<span class="charliteral">&#39;l&#39;</span>]] = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l16316"></a>16316             $level = $o[<span class="charliteral">&#39;l&#39;</span>];
<a name="l16317"></a>16317         }
<a name="l16318"></a>16318         <span class="comment">//Outline items</span>
<a name="l16319"></a>16319         $n = $this-&gt;n + 1;
<a name="l16320"></a>16320         $nltags = <span class="stringliteral">&#39;/&lt;br[\s]?\/&gt;|&lt;\/(blockquote|dd|dl|div|dt|h1|h2|h3|h4|h5|h6|hr|li|ol|p|pre|ul|tcpdf|table|tr|td)&gt;/si&#39;</span>;
<a name="l16321"></a>16321         <span class="keywordflow">foreach</span> ($this-&gt;outlines as <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> =&gt; $o) {
<a name="l16322"></a>16322             $oid = $this-&gt;_newobj();
<a name="l16323"></a>16323             <span class="comment">// covert HTML title to string</span>
<a name="l16324"></a>16324             <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a> = preg_replace($nltags, <span class="stringliteral">&quot;\n&quot;</span>, $o[<span class="charliteral">&#39;t&#39;</span>]);
<a name="l16325"></a>16325             <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a> = preg_replace(<span class="stringliteral">&quot;/[\r]+/si&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a>);
<a name="l16326"></a>16326             <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a> = preg_replace(<span class="stringliteral">&quot;/[\n]+/si&quot;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a>);
<a name="l16327"></a>16327             <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a> = strip_tags(<a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a>);
<a name="l16328"></a>16328             <a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a> = $this-&gt;stringTrim(<a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a>);
<a name="l16329"></a>16329             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;/Title &#39;</span>.$this-&gt;_textstring(<a class="code" href="adm_8php.html#ada57e7bb7c152edad18fe2f166188691">$title</a>, $oid);
<a name="l16330"></a>16330             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Parent &#39;</span>.($n + $o[<span class="stringliteral">&#39;parent&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l16331"></a>16331             <span class="keywordflow">if</span> (isset($o[<span class="stringliteral">&#39;prev&#39;</span>])) {
<a name="l16332"></a>16332                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Prev &#39;</span>.($n + $o[<span class="stringliteral">&#39;prev&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l16333"></a>16333             }
<a name="l16334"></a>16334             <span class="keywordflow">if</span> (isset($o[<span class="stringliteral">&#39;next&#39;</span>])) {
<a name="l16335"></a>16335                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Next &#39;</span>.($n + $o[<span class="stringliteral">&#39;next&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l16336"></a>16336             }
<a name="l16337"></a>16337             <span class="keywordflow">if</span> (isset($o[<span class="stringliteral">&#39;first&#39;</span>])) {
<a name="l16338"></a>16338                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /First &#39;</span>.($n + $o[<span class="stringliteral">&#39;first&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l16339"></a>16339             }
<a name="l16340"></a>16340             <span class="keywordflow">if</span> (isset($o[<span class="stringliteral">&#39;last&#39;</span>])) {
<a name="l16341"></a>16341                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Last &#39;</span>.($n + $o[<span class="stringliteral">&#39;last&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l16342"></a>16342             }
<a name="l16343"></a>16343             <span class="keywordflow">if</span> (isset($this-&gt;page_obj_id[($o[<span class="charliteral">&#39;p&#39;</span>])])) {
<a name="l16344"></a>16344                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;/Dest [%u 0 R /XYZ 0 %.2F null]&#39;</span>, $this-&gt;page_obj_id[($o[<span class="charliteral">&#39;p&#39;</span>])], ($this-&gt;pagedim[$o[<span class="charliteral">&#39;p&#39;</span>]][<span class="charliteral">&#39;h&#39;</span>] - ($o[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k)));
<a name="l16345"></a>16345             }
<a name="l16346"></a>16346             <span class="comment">// set font style</span>
<a name="l16347"></a>16347             $style = 0;
<a name="l16348"></a>16348             <span class="keywordflow">if</span> (!empty($o[<span class="charliteral">&#39;s&#39;</span>])) {
<a name="l16349"></a>16349                 <span class="comment">// bold</span>
<a name="l16350"></a>16350                 <span class="keywordflow">if</span> (strpos($o[<span class="charliteral">&#39;s&#39;</span>], <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l16351"></a>16351                     $style |= 2;
<a name="l16352"></a>16352                 }
<a name="l16353"></a>16353                 <span class="comment">// oblique</span>
<a name="l16354"></a>16354                 <span class="keywordflow">if</span> (strpos($o[<span class="charliteral">&#39;s&#39;</span>], <span class="charliteral">&#39;I&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l16355"></a>16355                     $style |= 1;
<a name="l16356"></a>16356                 }
<a name="l16357"></a>16357             }
<a name="l16358"></a>16358             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= sprintf(<span class="stringliteral">&#39; /F %d&#39;</span>, $style);
<a name="l16359"></a>16359             <span class="comment">// set bookmark color</span>
<a name="l16360"></a>16360             <span class="keywordflow">if</span> (isset($o[<span class="charliteral">&#39;c&#39;</span>]) AND is_array($o[<span class="charliteral">&#39;c&#39;</span>]) AND (count($o[<span class="charliteral">&#39;c&#39;</span>]) == 3)) {
<a name="l16361"></a>16361                 $color = array_values($o[<span class="charliteral">&#39;c&#39;</span>]);
<a name="l16362"></a>16362                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= sprintf(<span class="stringliteral">&#39; /C [%.3F %.3F %.3F]&#39;</span>, ($color[0] / 255), ($color[1] / 255), ($color[2] / 255));
<a name="l16363"></a>16363             } <span class="keywordflow">else</span> {
<a name="l16364"></a>16364                 <span class="comment">// black</span>
<a name="l16365"></a>16365                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /C [0.0 0.0 0.0]&#39;</span>;
<a name="l16366"></a>16366             }
<a name="l16367"></a>16367             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Count 0&#39;</span>; <span class="comment">// normally closed item</span>
<a name="l16368"></a>16368             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l16369"></a>16369             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l16370"></a>16370             $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l16371"></a>16371         }
<a name="l16372"></a>16372         <span class="comment">//Outline root</span>
<a name="l16373"></a>16373         $this-&gt;OutlineRoot = $this-&gt;_newobj();
<a name="l16374"></a>16374         $this-&gt;_out(<span class="stringliteral">&#39;&lt;&lt; /Type /Outlines /First &#39;</span>.$n.<span class="stringliteral">&#39; 0 R /Last &#39;</span>.($n + $lru[0]).<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);
<a name="l16375"></a>16375     }
<a name="l16376"></a>16376 
<a name="l16377"></a>16377     <span class="comment">// --- JAVASCRIPT ------------------------------------------------------</span>
<a name="l16378"></a>16378 <span class="comment"></span>
<a name="l16379"></a>16379 <span class="comment">    /**</span>
<a name="l16380"></a>16380 <span class="comment">     * Adds a javascript</span>
<a name="l16381"></a>16381 <span class="comment">     * @param $script (string) Javascript code</span>
<a name="l16382"></a>16382 <span class="comment">     * @public</span>
<a name="l16383"></a>16383 <span class="comment">     * @author Johannes Güntert, Nicola Asuni</span>
<a name="l16384"></a>16384 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l16385"></a>16385 <span class="comment">     */</span>
<a name="l16386"></a><a class="code" href="classTCPDF.html#a057c8815533ff886e4b23a9780e31f78">16386</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a057c8815533ff886e4b23a9780e31f78" title="Adds a javascript.">IncludeJS</a>($script) {
<a name="l16387"></a>16387         $this-&gt;javascript .= $script;
<a name="l16388"></a>16388     }
<a name="l16389"></a>16389 <span class="comment"></span>
<a name="l16390"></a>16390 <span class="comment">    /**</span>
<a name="l16391"></a>16391 <span class="comment">     * Adds a javascript object and return object ID</span>
<a name="l16392"></a>16392 <span class="comment">     * @param $script (string) Javascript code</span>
<a name="l16393"></a>16393 <span class="comment">     * @param $onload (boolean) if true executes this object when opening the document</span>
<a name="l16394"></a>16394 <span class="comment">     * @return int internal object ID</span>
<a name="l16395"></a>16395 <span class="comment">     * @public</span>
<a name="l16396"></a>16396 <span class="comment">     * @author Nicola Asuni</span>
<a name="l16397"></a>16397 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l16398"></a>16398 <span class="comment">     */</span>
<a name="l16399"></a><a class="code" href="classTCPDF.html#ac9c37f99a7bbc56109a019f4d5fab568">16399</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac9c37f99a7bbc56109a019f4d5fab568" title="Adds a javascript object and return object ID.">addJavascriptObject</a>($script, $onload=<span class="keyword">false</span>) {
<a name="l16400"></a>16400         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l16401"></a>16401             <span class="comment">// javascript is not allowed in PDF/A mode</span>
<a name="l16402"></a>16402             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l16403"></a>16403         }
<a name="l16404"></a>16404         ++$this-&gt;n;
<a name="l16405"></a>16405         $this-&gt;js_objects[$this-&gt;n] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n, <span class="stringliteral">&#39;js&#39;</span> =&gt; $script, <span class="stringliteral">&#39;onload&#39;</span> =&gt; $onload);
<a name="l16406"></a>16406         <span class="keywordflow">return</span> $this-&gt;n;
<a name="l16407"></a>16407     }
<a name="l16408"></a>16408 <span class="comment"></span>
<a name="l16409"></a>16409 <span class="comment">    /**</span>
<a name="l16410"></a>16410 <span class="comment">     * Create a javascript PDF string.</span>
<a name="l16411"></a>16411 <span class="comment">     * @protected</span>
<a name="l16412"></a>16412 <span class="comment">     * @author Johannes Güntert, Nicola Asuni</span>
<a name="l16413"></a>16413 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l16414"></a>16414 <span class="comment">     */</span>
<a name="l16415"></a><a class="code" href="classTCPDF.html#a3ddff5ab94a793cf535b06de3e773826">16415</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3ddff5ab94a793cf535b06de3e773826" title="Create a javascript PDF string.">_putjavascript</a>() {
<a name="l16416"></a>16416         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode OR (empty($this-&gt;javascript) AND empty($this-&gt;js_objects))) {
<a name="l16417"></a>16417             <span class="keywordflow">return</span>;
<a name="l16418"></a>16418         }
<a name="l16419"></a>16419         <span class="keywordflow">if</span> (strpos($this-&gt;javascript, <span class="stringliteral">&#39;this.addField&#39;</span>) &gt; 0) {
<a name="l16420"></a>16420             <span class="keywordflow">if</span> (!$this-&gt;ur[<span class="stringliteral">&#39;enabled&#39;</span>]) {
<a name="l16421"></a>16421                 <span class="comment">//$this-&gt;setUserRights();</span>
<a name="l16422"></a>16422             }
<a name="l16423"></a>16423             <span class="comment">// the following two lines are used to avoid form fields duplication after saving</span>
<a name="l16424"></a>16424             <span class="comment">// The addField method only works when releasing user rights (UR3)</span>
<a name="l16425"></a>16425             $jsa = sprintf(<span class="stringliteral">&quot;ftcpdfdocsaved=this.addField(&#39;%s&#39;,&#39;%s&#39;,%d,[%.2F,%.2F,%.2F,%.2F]);&quot;</span>, <span class="stringliteral">&#39;tcpdfdocsaved&#39;</span>, <span class="stringliteral">&#39;text&#39;</span>, 0, 0, 1, 0, 1);
<a name="l16426"></a>16426             $jsb = <span class="stringliteral">&quot;getField(&#39;tcpdfdocsaved&#39;).value=&#39;saved&#39;;&quot;</span>;
<a name="l16427"></a>16427             $this-&gt;javascript = $jsa.<span class="stringliteral">&quot;\n&quot;</span>.$this-&gt;javascript.<span class="stringliteral">&quot;\n&quot;</span>.$jsb;
<a name="l16428"></a>16428         }
<a name="l16429"></a>16429         $this-&gt;n_js = $this-&gt;_newobj();
<a name="l16430"></a>16430         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39; &lt;&lt; /Names [&#39;</span>;
<a name="l16431"></a>16431         <span class="keywordflow">if</span> (!empty($this-&gt;javascript)) {
<a name="l16432"></a>16432             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; (EmbeddedJS) &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l16433"></a>16433         }
<a name="l16434"></a>16434         <span class="keywordflow">if</span> (!empty($this-&gt;js_objects)) {
<a name="l16435"></a>16435             <span class="keywordflow">foreach</span> ($this-&gt;js_objects as $key =&gt; $val) {
<a name="l16436"></a>16436                 <span class="keywordflow">if</span> ($val[<span class="stringliteral">&#39;onload&#39;</span>]) {
<a name="l16437"></a>16437                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; (JS&#39;</span>.$key.<span class="stringliteral">&#39;) &#39;</span>.$key.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l16438"></a>16438                 }
<a name="l16439"></a>16439             }
<a name="l16440"></a>16440         }
<a name="l16441"></a>16441         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; ] &gt;&gt;&#39;</span>;
<a name="l16442"></a>16442         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l16443"></a>16443         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l16444"></a>16444         <span class="comment">// default Javascript object</span>
<a name="l16445"></a>16445         <span class="keywordflow">if</span> (!empty($this-&gt;javascript)) {
<a name="l16446"></a>16446             $obj_id = $this-&gt;_newobj();
<a name="l16447"></a>16447             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /S /JavaScript&#39;</span>;
<a name="l16448"></a>16448             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /JS &#39;</span>.$this-&gt;_textstring($this-&gt;javascript, $obj_id);
<a name="l16449"></a>16449             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l16450"></a>16450             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l16451"></a>16451             $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l16452"></a>16452         }
<a name="l16453"></a>16453         <span class="comment">// additional Javascript objects</span>
<a name="l16454"></a>16454         <span class="keywordflow">if</span> (!empty($this-&gt;js_objects)) {
<a name="l16455"></a>16455             <span class="keywordflow">foreach</span> ($this-&gt;js_objects as $key =&gt; $val) {
<a name="l16456"></a>16456                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = $this-&gt;_getobj($key).<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39; &lt;&lt; /S /JavaScript /JS &#39;</span>.$this-&gt;_textstring($val[<span class="stringliteral">&#39;js&#39;</span>], $key).<span class="stringliteral">&#39; &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l16457"></a>16457                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l16458"></a>16458             }
<a name="l16459"></a>16459         }
<a name="l16460"></a>16460     }
<a name="l16461"></a>16461 <span class="comment"></span>
<a name="l16462"></a>16462 <span class="comment">    /**</span>
<a name="l16463"></a>16463 <span class="comment">     * Convert color to javascript color.</span>
<a name="l16464"></a>16464 <span class="comment">     * @param $color (string) color name or &quot;#RRGGBB&quot;</span>
<a name="l16465"></a>16465 <span class="comment">     * @protected</span>
<a name="l16466"></a>16466 <span class="comment">     * @author Denis Van Nuffelen, Nicola Asuni</span>
<a name="l16467"></a>16467 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l16468"></a>16468 <span class="comment">     */</span>
<a name="l16469"></a><a class="code" href="classTCPDF.html#ab4e1a604558c0f86ddc21cd3d8312590">16469</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab4e1a604558c0f86ddc21cd3d8312590" title="Convert color to javascript color.">_JScolor</a>($color) {
<a name="l16470"></a>16470         <span class="keyword">static</span> $aColors = array(<span class="stringliteral">&#39;transparent&#39;</span>, <span class="stringliteral">&#39;black&#39;</span>, <span class="stringliteral">&#39;white&#39;</span>, <span class="stringliteral">&#39;red&#39;</span>, <span class="stringliteral">&#39;green&#39;</span>, <span class="stringliteral">&#39;blue&#39;</span>, <span class="stringliteral">&#39;cyan&#39;</span>, <span class="stringliteral">&#39;magenta&#39;</span>, <span class="stringliteral">&#39;yellow&#39;</span>, <span class="stringliteral">&#39;dkGray&#39;</span>, <span class="stringliteral">&#39;gray&#39;</span>, <span class="stringliteral">&#39;ltGray&#39;</span>);
<a name="l16471"></a>16471         <span class="keywordflow">if</span> (substr($color,0,1) == <span class="charliteral">&#39;#&#39;</span>) {
<a name="l16472"></a>16472             <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&quot;[&#39;RGB&#39;,%.3F,%.3F,%.3F]&quot;</span>, hexdec(substr($color,1,2))/255, hexdec(substr($color,3,2))/255, hexdec(substr($color,5,2))/255);
<a name="l16473"></a>16473         }
<a name="l16474"></a>16474         <span class="keywordflow">if</span> (!in_array($color,$aColors)) {
<a name="l16475"></a>16475             $this-&gt;Error(<span class="stringliteral">&#39;Invalid color: &#39;</span>.$color);
<a name="l16476"></a>16476         }
<a name="l16477"></a>16477         <span class="keywordflow">return</span> <span class="stringliteral">&#39;color.&#39;</span>.$color;
<a name="l16478"></a>16478     }
<a name="l16479"></a>16479 <span class="comment"></span>
<a name="l16480"></a>16480 <span class="comment">    /**</span>
<a name="l16481"></a>16481 <span class="comment">     * Adds a javascript form field.</span>
<a name="l16482"></a>16482 <span class="comment">     * @param $type (string) field type</span>
<a name="l16483"></a>16483 <span class="comment">     * @param $name (string) field name</span>
<a name="l16484"></a>16484 <span class="comment">     * @param $x (int) horizontal position</span>
<a name="l16485"></a>16485 <span class="comment">     * @param $y (int) vertical position</span>
<a name="l16486"></a>16486 <span class="comment">     * @param $w (int) width</span>
<a name="l16487"></a>16487 <span class="comment">     * @param $h (int) height</span>
<a name="l16488"></a>16488 <span class="comment">     * @param $prop (array) javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l16489"></a>16489 <span class="comment">     * @protected</span>
<a name="l16490"></a>16490 <span class="comment">     * @author Denis Van Nuffelen, Nicola Asuni</span>
<a name="l16491"></a>16491 <span class="comment">     * @since 2.1.002 (2008-02-12)</span>
<a name="l16492"></a>16492 <span class="comment">     */</span>
<a name="l16493"></a><a class="code" href="classTCPDF.html#a1fc76cf135e8b98b3f654461d8345a57">16493</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1fc76cf135e8b98b3f654461d8345a57" title="Adds a javascript form field.">_addfield</a>(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $prop) {
<a name="l16494"></a>16494         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l16495"></a>16495             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l16496"></a>16496         }
<a name="l16497"></a>16497         <span class="comment">// the followind avoid fields duplication after saving the document</span>
<a name="l16498"></a>16498         $this-&gt;javascript .= <span class="stringliteral">&quot;if (getField(&#39;tcpdfdocsaved&#39;).value != &#39;saved&#39;) {&quot;</span>;
<a name="l16499"></a>16499         $k = $this-&gt;k;
<a name="l16500"></a>16500         $this-&gt;javascript .= sprintf(<span class="stringliteral">&quot;f&quot;</span>.<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>.<span class="stringliteral">&quot;=this.addField(&#39;%s&#39;,&#39;%s&#39;,%u,[%.2F,%.2F,%.2F,%.2F]);&quot;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $this-&gt;PageNo()-1, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>*$k, ($this-&gt;h-$y)*$k+1, (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>+<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>)*$k, ($this-&gt;h-$y-<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>)*$k+1).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l16501"></a>16501         $this-&gt;javascript .= <span class="charliteral">&#39;f&#39;</span>.$name.<span class="stringliteral">&#39;.textSize=&#39;</span>.$this-&gt;FontSizePt.<span class="stringliteral">&quot;;\n&quot;</span>;
<a name="l16502"></a>16502         <span class="keywordflow">while</span> (list($key, $val) = each($prop)) {
<a name="l16503"></a>16503             <span class="keywordflow">if</span> (strcmp(substr($key, -5), <span class="stringliteral">&#39;Color&#39;</span>) == 0) {
<a name="l16504"></a>16504                 $val = $this-&gt;_JScolor($val);
<a name="l16505"></a>16505             } <span class="keywordflow">else</span> {
<a name="l16506"></a>16506                 $val = <span class="stringliteral">&quot;&#39;&quot;</span>.$val.<span class="stringliteral">&quot;&#39;&quot;</span>;
<a name="l16507"></a>16507             }
<a name="l16508"></a>16508             $this-&gt;javascript .= <span class="charliteral">&#39;f&#39;</span>.$name.<span class="charliteral">&#39;.&#39;</span>.$key.<span class="charliteral">&#39;=&#39;</span>.$val.<span class="stringliteral">&quot;;\n&quot;</span>;
<a name="l16509"></a>16509         }
<a name="l16510"></a>16510         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l16511"></a>16511             $this-&gt;x -= <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l16512"></a>16512         } <span class="keywordflow">else</span> {
<a name="l16513"></a>16513             $this-&gt;x += <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l16514"></a>16514         }
<a name="l16515"></a>16515         $this-&gt;javascript .= <span class="charliteral">&#39;}&#39;</span>;
<a name="l16516"></a>16516     }
<a name="l16517"></a>16517 
<a name="l16518"></a>16518     <span class="comment">// --- FORM FIELDS -----------------------------------------------------</span>
<a name="l16519"></a>16519 <span class="comment"></span>
<a name="l16520"></a>16520 <span class="comment">    /**</span>
<a name="l16521"></a>16521 <span class="comment">     * Convert JavaScript form fields properties array to Annotation Properties array.</span>
<a name="l16522"></a>16522 <span class="comment">     * @param $prop (array) javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l16523"></a>16523 <span class="comment">     * @return array of annotation properties</span>
<a name="l16524"></a>16524 <span class="comment">     * @protected</span>
<a name="l16525"></a>16525 <span class="comment">     * @author Nicola Asuni</span>
<a name="l16526"></a>16526 <span class="comment">     * @since 4.8.000 (2009-09-06)</span>
<a name="l16527"></a>16527 <span class="comment">     */</span>
<a name="l16528"></a><a class="code" href="classTCPDF.html#aeae43fbc0638901974f8241a90c86341">16528</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aeae43fbc0638901974f8241a90c86341" title="Convert JavaScript form fields properties array to Annotation Properties array.">getAnnotOptFromJSProp</a>($prop) {
<a name="l16529"></a>16529         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;aopt&#39;</span>]) AND is_array($prop[<span class="stringliteral">&#39;aopt&#39;</span>])) {
<a name="l16530"></a>16530             <span class="comment">// the annotation options area lready defined</span>
<a name="l16531"></a>16531             <span class="keywordflow">return</span> $prop[<span class="stringliteral">&#39;aopt&#39;</span>];
<a name="l16532"></a>16532         }
<a name="l16533"></a>16533         $opt = array(); <span class="comment">// value to be returned</span>
<a name="l16534"></a>16534         <span class="comment">// alignment: Controls how the text is laid out within the text field.</span>
<a name="l16535"></a>16535         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;alignment&#39;</span>])) {
<a name="l16536"></a>16536             <span class="keywordflow">switch</span> ($prop[<span class="stringliteral">&#39;alignment&#39;</span>]) {
<a name="l16537"></a>16537                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;left&#39;</span>: {
<a name="l16538"></a>16538                     $opt[<span class="charliteral">&#39;q&#39;</span>] = 0;
<a name="l16539"></a>16539                     <span class="keywordflow">break</span>;
<a name="l16540"></a>16540                 }
<a name="l16541"></a>16541                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;center&#39;</span>: {
<a name="l16542"></a>16542                     $opt[<span class="charliteral">&#39;q&#39;</span>] = 1;
<a name="l16543"></a>16543                     <span class="keywordflow">break</span>;
<a name="l16544"></a>16544                 }
<a name="l16545"></a>16545                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;right&#39;</span>: {
<a name="l16546"></a>16546                     $opt[<span class="charliteral">&#39;q&#39;</span>] = 2;
<a name="l16547"></a>16547                     <span class="keywordflow">break</span>;
<a name="l16548"></a>16548                 }
<a name="l16549"></a>16549                 <span class="keywordflow">default</span>: {
<a name="l16550"></a>16550                     $opt[<span class="charliteral">&#39;q&#39;</span>] = ($this-&gt;rtl)?2:0;
<a name="l16551"></a>16551                     <span class="keywordflow">break</span>;
<a name="l16552"></a>16552                 }
<a name="l16553"></a>16553             }
<a name="l16554"></a>16554         }
<a name="l16555"></a>16555         <span class="comment">// lineWidth: Specifies the thickness of the border when stroking the perimeter of a field&#39;s rectangle.</span>
<a name="l16556"></a>16556         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;lineWidth&#39;</span>])) {
<a name="l16557"></a>16557             $linewidth = intval($prop[<span class="stringliteral">&#39;lineWidth&#39;</span>]);
<a name="l16558"></a>16558         } <span class="keywordflow">else</span> {
<a name="l16559"></a>16559             $linewidth = 1;
<a name="l16560"></a>16560         }
<a name="l16561"></a>16561         <span class="comment">// borderStyle: The border style for a field.</span>
<a name="l16562"></a>16562         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;borderStyle&#39;</span>])) {
<a name="l16563"></a>16563             <span class="keywordflow">switch</span> ($prop[<span class="stringliteral">&#39;borderStyle&#39;</span>]) {
<a name="l16564"></a>16564                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;border.d&#39;</span>:
<a name="l16565"></a>16565                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;dashed&#39;</span>: {
<a name="l16566"></a>16566                     $opt[<span class="stringliteral">&#39;border&#39;</span>] = array(0, 0, $linewidth, array(3, 2));
<a name="l16567"></a>16567                     $opt[<span class="stringliteral">&#39;bs&#39;</span>] = array(<span class="charliteral">&#39;w&#39;</span>=&gt;$linewidth, <span class="charliteral">&#39;s&#39;</span>=&gt;<span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;d&#39;</span>=&gt;array(3, 2));
<a name="l16568"></a>16568                     <span class="keywordflow">break</span>;
<a name="l16569"></a>16569                 }
<a name="l16570"></a>16570                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;border.b&#39;</span>:
<a name="l16571"></a>16571                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;beveled&#39;</span>: {
<a name="l16572"></a>16572                     $opt[<span class="stringliteral">&#39;border&#39;</span>] = array(0, 0, $linewidth);
<a name="l16573"></a>16573                     $opt[<span class="stringliteral">&#39;bs&#39;</span>] = array(<span class="charliteral">&#39;w&#39;</span>=&gt;$linewidth, <span class="charliteral">&#39;s&#39;</span>=&gt;<span class="charliteral">&#39;B&#39;</span>);
<a name="l16574"></a>16574                     <span class="keywordflow">break</span>;
<a name="l16575"></a>16575                 }
<a name="l16576"></a>16576                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;border.i&#39;</span>:
<a name="l16577"></a>16577                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;inset&#39;</span>: {
<a name="l16578"></a>16578                     $opt[<span class="stringliteral">&#39;border&#39;</span>] = array(0, 0, $linewidth);
<a name="l16579"></a>16579                     $opt[<span class="stringliteral">&#39;bs&#39;</span>] = array(<span class="charliteral">&#39;w&#39;</span>=&gt;$linewidth, <span class="charliteral">&#39;s&#39;</span>=&gt;<span class="charliteral">&#39;I&#39;</span>);
<a name="l16580"></a>16580                     <span class="keywordflow">break</span>;
<a name="l16581"></a>16581                 }
<a name="l16582"></a>16582                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;border.u&#39;</span>:
<a name="l16583"></a>16583                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;underline&#39;</span>: {
<a name="l16584"></a>16584                     $opt[<span class="stringliteral">&#39;border&#39;</span>] = array(0, 0, $linewidth);
<a name="l16585"></a>16585                     $opt[<span class="stringliteral">&#39;bs&#39;</span>] = array(<span class="charliteral">&#39;w&#39;</span>=&gt;$linewidth, <span class="charliteral">&#39;s&#39;</span>=&gt;<span class="charliteral">&#39;U&#39;</span>);
<a name="l16586"></a>16586                     <span class="keywordflow">break</span>;
<a name="l16587"></a>16587                 }
<a name="l16588"></a>16588                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;border.s&#39;</span>:
<a name="l16589"></a>16589                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;solid&#39;</span>: {
<a name="l16590"></a>16590                     $opt[<span class="stringliteral">&#39;border&#39;</span>] = array(0, 0, $linewidth);
<a name="l16591"></a>16591                     $opt[<span class="stringliteral">&#39;bs&#39;</span>] = array(<span class="charliteral">&#39;w&#39;</span>=&gt;$linewidth, <span class="charliteral">&#39;s&#39;</span>=&gt;<span class="charliteral">&#39;S&#39;</span>);
<a name="l16592"></a>16592                     <span class="keywordflow">break</span>;
<a name="l16593"></a>16593                 }
<a name="l16594"></a>16594                 <span class="keywordflow">default</span>: {
<a name="l16595"></a>16595                     <span class="keywordflow">break</span>;
<a name="l16596"></a>16596                 }
<a name="l16597"></a>16597             }
<a name="l16598"></a>16598         }
<a name="l16599"></a>16599         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;border&#39;</span>]) AND is_array($prop[<span class="stringliteral">&#39;border&#39;</span>])) {
<a name="l16600"></a>16600             $opt[<span class="stringliteral">&#39;border&#39;</span>] = $prop[<span class="stringliteral">&#39;border&#39;</span>];
<a name="l16601"></a>16601         }
<a name="l16602"></a>16602         <span class="keywordflow">if</span> (!isset($opt[<span class="stringliteral">&#39;mk&#39;</span>])) {
<a name="l16603"></a>16603             $opt[<span class="stringliteral">&#39;mk&#39;</span>] = array();
<a name="l16604"></a>16604         }
<a name="l16605"></a>16605         <span class="keywordflow">if</span> (!isset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>])) {
<a name="l16606"></a>16606             $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>] = array();
<a name="l16607"></a>16607         }
<a name="l16608"></a>16608         $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>] = array(0.5, 0.5);
<a name="l16609"></a>16609         <span class="comment">// buttonAlignX: Controls how space is distributed from the left of the button face with respect to the icon.</span>
<a name="l16610"></a>16610         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;buttonAlignX&#39;</span>])) {
<a name="l16611"></a>16611             $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>][0] = $prop[<span class="stringliteral">&#39;buttonAlignX&#39;</span>];
<a name="l16612"></a>16612         }
<a name="l16613"></a>16613         <span class="comment">// buttonAlignY: Controls how unused space is distributed from the bottom of the button face with respect to the icon.</span>
<a name="l16614"></a>16614         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;buttonAlignY&#39;</span>])) {
<a name="l16615"></a>16615             $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>][1] = $prop[<span class="stringliteral">&#39;buttonAlignY&#39;</span>];
<a name="l16616"></a>16616         }
<a name="l16617"></a>16617         <span class="comment">// buttonFitBounds: If true, the extent to which the icon may be scaled is set to the bounds of the button field.</span>
<a name="l16618"></a>16618         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;buttonFitBounds&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;buttonFitBounds&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16619"></a>16619             $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;fb&#39;</span>] = <span class="keyword">true</span>;
<a name="l16620"></a>16620         }
<a name="l16621"></a>16621         <span class="comment">// buttonScaleHow: Controls how the icon is scaled (if necessary) to fit inside the button face.</span>
<a name="l16622"></a>16622         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;buttonScaleHow&#39;</span>])) {
<a name="l16623"></a>16623             <span class="keywordflow">switch</span> ($prop[<span class="stringliteral">&#39;buttonScaleHow&#39;</span>]) {
<a name="l16624"></a>16624                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;scaleHow.proportional&#39;</span>: {
<a name="l16625"></a>16625                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;s&#39;</span>] = <span class="charliteral">&#39;P&#39;</span>;
<a name="l16626"></a>16626                     <span class="keywordflow">break</span>;
<a name="l16627"></a>16627                 }
<a name="l16628"></a>16628                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;scaleHow.anamorphic&#39;</span>: {
<a name="l16629"></a>16629                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;s&#39;</span>] = <span class="charliteral">&#39;A&#39;</span>;
<a name="l16630"></a>16630                     <span class="keywordflow">break</span>;
<a name="l16631"></a>16631                 }
<a name="l16632"></a>16632             }
<a name="l16633"></a>16633         }
<a name="l16634"></a>16634         <span class="comment">// buttonScaleWhen: Controls when an icon is scaled to fit inside the button face.</span>
<a name="l16635"></a>16635         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;buttonScaleWhen&#39;</span>])) {
<a name="l16636"></a>16636             <span class="keywordflow">switch</span> ($prop[<span class="stringliteral">&#39;buttonScaleWhen&#39;</span>]) {
<a name="l16637"></a>16637                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;scaleWhen.always&#39;</span>: {
<a name="l16638"></a>16638                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>] = <span class="charliteral">&#39;A&#39;</span>;
<a name="l16639"></a>16639                     <span class="keywordflow">break</span>;
<a name="l16640"></a>16640                 }
<a name="l16641"></a>16641                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;scaleWhen.never&#39;</span>: {
<a name="l16642"></a>16642                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>] = <span class="charliteral">&#39;N&#39;</span>;
<a name="l16643"></a>16643                     <span class="keywordflow">break</span>;
<a name="l16644"></a>16644                 }
<a name="l16645"></a>16645                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;scaleWhen.tooBig&#39;</span>: {
<a name="l16646"></a>16646                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>] = <span class="charliteral">&#39;B&#39;</span>;
<a name="l16647"></a>16647                     <span class="keywordflow">break</span>;
<a name="l16648"></a>16648                 }
<a name="l16649"></a>16649                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;scaleWhen.tooSmall&#39;</span>: {
<a name="l16650"></a>16650                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>] = <span class="charliteral">&#39;S&#39;</span>;
<a name="l16651"></a>16651                     <span class="keywordflow">break</span>;
<a name="l16652"></a>16652                 }
<a name="l16653"></a>16653             }
<a name="l16654"></a>16654         }
<a name="l16655"></a>16655         <span class="comment">// buttonPosition: Controls how the text and the icon of the button are positioned with respect to each other within the button face.</span>
<a name="l16656"></a>16656         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;buttonPosition&#39;</span>])) {
<a name="l16657"></a>16657             <span class="keywordflow">switch</span> ($prop[<span class="stringliteral">&#39;buttonPosition&#39;</span>]) {
<a name="l16658"></a>16658                 <span class="keywordflow">case</span> 0:
<a name="l16659"></a>16659                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;position.textOnly&#39;</span>: {
<a name="l16660"></a>16660                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] = 0;
<a name="l16661"></a>16661                     <span class="keywordflow">break</span>;
<a name="l16662"></a>16662                 }
<a name="l16663"></a>16663                 <span class="keywordflow">case</span> 1:
<a name="l16664"></a>16664                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;position.iconOnly&#39;</span>: {
<a name="l16665"></a>16665                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] = 1;
<a name="l16666"></a>16666                     <span class="keywordflow">break</span>;
<a name="l16667"></a>16667                 }
<a name="l16668"></a>16668                 <span class="keywordflow">case</span> 2:
<a name="l16669"></a>16669                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;position.iconTextV&#39;</span>: {
<a name="l16670"></a>16670                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] = 2;
<a name="l16671"></a>16671                     <span class="keywordflow">break</span>;
<a name="l16672"></a>16672                 }
<a name="l16673"></a>16673                 <span class="keywordflow">case</span> 3:
<a name="l16674"></a>16674                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;position.textIconV&#39;</span>: {
<a name="l16675"></a>16675                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] = 3;
<a name="l16676"></a>16676                     <span class="keywordflow">break</span>;
<a name="l16677"></a>16677                 }
<a name="l16678"></a>16678                 <span class="keywordflow">case</span> 4:
<a name="l16679"></a>16679                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;position.iconTextH&#39;</span>: {
<a name="l16680"></a>16680                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] = 4;
<a name="l16681"></a>16681                     <span class="keywordflow">break</span>;
<a name="l16682"></a>16682                 }
<a name="l16683"></a>16683                 <span class="keywordflow">case</span> 5:
<a name="l16684"></a>16684                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;position.textIconH&#39;</span>: {
<a name="l16685"></a>16685                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] = 5;
<a name="l16686"></a>16686                     <span class="keywordflow">break</span>;
<a name="l16687"></a>16687                 }
<a name="l16688"></a>16688                 <span class="keywordflow">case</span> 6:
<a name="l16689"></a>16689                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;position.overlay&#39;</span>: {
<a name="l16690"></a>16690                     $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] = 6;
<a name="l16691"></a>16691                     <span class="keywordflow">break</span>;
<a name="l16692"></a>16692                 }
<a name="l16693"></a>16693             }
<a name="l16694"></a>16694         }
<a name="l16695"></a>16695         <span class="comment">// fillColor: Specifies the background color for a field.</span>
<a name="l16696"></a>16696         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;fillColor&#39;</span>])) {
<a name="l16697"></a>16697             <span class="keywordflow">if</span> (is_array($prop[<span class="stringliteral">&#39;fillColor&#39;</span>])) {
<a name="l16698"></a>16698                 $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bg&#39;</span>] = $prop[<span class="stringliteral">&#39;fillColor&#39;</span>];
<a name="l16699"></a>16699             } <span class="keywordflow">else</span> {
<a name="l16700"></a>16700                 $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bg&#39;</span>] = $this-&gt;convertHTMLColorToDec($prop[<span class="stringliteral">&#39;fillColor&#39;</span>]);
<a name="l16701"></a>16701             }
<a name="l16702"></a>16702         }
<a name="l16703"></a>16703         <span class="comment">// strokeColor: Specifies the stroke color for a field that is used to stroke the rectangle of the field with a line as large as the line width.</span>
<a name="l16704"></a>16704         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;strokeColor&#39;</span>])) {
<a name="l16705"></a>16705             <span class="keywordflow">if</span> (is_array($prop[<span class="stringliteral">&#39;strokeColor&#39;</span>])) {
<a name="l16706"></a>16706                 $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bc&#39;</span>] = $prop[<span class="stringliteral">&#39;strokeColor&#39;</span>];
<a name="l16707"></a>16707             } <span class="keywordflow">else</span> {
<a name="l16708"></a>16708                 $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bc&#39;</span>] = $this-&gt;convertHTMLColorToDec($prop[<span class="stringliteral">&#39;strokeColor&#39;</span>]);
<a name="l16709"></a>16709             }
<a name="l16710"></a>16710         }
<a name="l16711"></a>16711         <span class="comment">// rotation: The rotation of a widget in counterclockwise increments.</span>
<a name="l16712"></a>16712         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;rotation&#39;</span>])) {
<a name="l16713"></a>16713             $opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;r&#39;</span>] = $prop[<span class="stringliteral">&#39;rotation&#39;</span>];
<a name="l16714"></a>16714         }
<a name="l16715"></a>16715         <span class="comment">// charLimit: Limits the number of characters that a user can type into a text field.</span>
<a name="l16716"></a>16716         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;charLimit&#39;</span>])) {
<a name="l16717"></a>16717             $opt[<span class="stringliteral">&#39;maxlen&#39;</span>] = intval($prop[<span class="stringliteral">&#39;charLimit&#39;</span>]);
<a name="l16718"></a>16718         }
<a name="l16719"></a>16719         <span class="keywordflow">if</span> (!isset($ff)) {
<a name="l16720"></a>16720             $ff = 0; <span class="comment">// default value</span>
<a name="l16721"></a>16721         }
<a name="l16722"></a>16722         <span class="comment">// readonly: The read-only characteristic of a field. If a field is read-only, the user can see the field but cannot change it.</span>
<a name="l16723"></a>16723         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;readonly&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;readonly&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16724"></a>16724             $ff += 1 &lt;&lt; 0;
<a name="l16725"></a>16725         }
<a name="l16726"></a>16726         <span class="comment">// required: Specifies whether a field requires a value.</span>
<a name="l16727"></a>16727         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;required&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;required&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16728"></a>16728             $ff += 1 &lt;&lt; 1;
<a name="l16729"></a>16729         }
<a name="l16730"></a>16730         <span class="comment">// multiline: Controls how text is wrapped within the field.</span>
<a name="l16731"></a>16731         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;multiline&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;multiline&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16732"></a>16732             $ff += 1 &lt;&lt; 12;
<a name="l16733"></a>16733         }
<a name="l16734"></a>16734         <span class="comment">// password: Specifies whether the field should display asterisks when data is entered in the field.</span>
<a name="l16735"></a>16735         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;password&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;password&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16736"></a>16736             $ff += 1 &lt;&lt; 13;
<a name="l16737"></a>16737         }
<a name="l16738"></a>16738         <span class="comment">// NoToggleToOff: If set, exactly one radio button shall be selected at all times; selecting the currently selected button has no effect.</span>
<a name="l16739"></a>16739         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;NoToggleToOff&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;NoToggleToOff&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16740"></a>16740             $ff += 1 &lt;&lt; 14;
<a name="l16741"></a>16741         }
<a name="l16742"></a>16742         <span class="comment">// Radio: If set, the field is a set of radio buttons.</span>
<a name="l16743"></a>16743         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;Radio&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;Radio&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16744"></a>16744             $ff += 1 &lt;&lt; 15;
<a name="l16745"></a>16745         }
<a name="l16746"></a>16746         <span class="comment">// Pushbutton: If set, the field is a pushbutton that does not retain a permanent value.</span>
<a name="l16747"></a>16747         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;Pushbutton&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;Pushbutton&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16748"></a>16748             $ff += 1 &lt;&lt; 16;
<a name="l16749"></a>16749         }
<a name="l16750"></a>16750         <span class="comment">// Combo: If set, the field is a combo box; if clear, the field is a list box.</span>
<a name="l16751"></a>16751         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;Combo&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;Combo&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16752"></a>16752             $ff += 1 &lt;&lt; 17;
<a name="l16753"></a>16753         }
<a name="l16754"></a>16754         <span class="comment">// editable: Controls whether a combo box is editable.</span>
<a name="l16755"></a>16755         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;editable&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;editable&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16756"></a>16756             $ff += 1 &lt;&lt; 18;
<a name="l16757"></a>16757         }
<a name="l16758"></a>16758         <span class="comment">// Sort: If set, the field&#39;s option items shall be sorted alphabetically.</span>
<a name="l16759"></a>16759         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;Sort&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;Sort&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16760"></a>16760             $ff += 1 &lt;&lt; 19;
<a name="l16761"></a>16761         }
<a name="l16762"></a>16762         <span class="comment">// fileSelect: If true, sets the file-select flag in the Options tab of the text field (Field is Used for File Selection).</span>
<a name="l16763"></a>16763         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;fileSelect&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;fileSelect&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16764"></a>16764             $ff += 1 &lt;&lt; 20;
<a name="l16765"></a>16765         }
<a name="l16766"></a>16766         <span class="comment">// multipleSelection: If true, indicates that a list box allows a multiple selection of items.</span>
<a name="l16767"></a>16767         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;multipleSelection&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;multipleSelection&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16768"></a>16768             $ff += 1 &lt;&lt; 21;
<a name="l16769"></a>16769         }
<a name="l16770"></a>16770         <span class="comment">// doNotSpellCheck: If true, spell checking is not performed on this editable text field.</span>
<a name="l16771"></a>16771         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;doNotSpellCheck&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;doNotSpellCheck&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16772"></a>16772             $ff += 1 &lt;&lt; 22;
<a name="l16773"></a>16773         }
<a name="l16774"></a>16774         <span class="comment">// doNotScroll: If true, the text field does not scroll and the user, therefore, is limited by the rectangular region designed for the field.</span>
<a name="l16775"></a>16775         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;doNotScroll&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;doNotScroll&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16776"></a>16776             $ff += 1 &lt;&lt; 23;
<a name="l16777"></a>16777         }
<a name="l16778"></a>16778         <span class="comment">// comb: If set to true, the field background is drawn as series of boxes (one for each character in the value of the field) and each character of the content is drawn within those boxes. The number of boxes drawn is determined from the charLimit property. It applies only to text fields. The setter will also raise if any of the following field properties are also set multiline, password, and fileSelect. A side-effect of setting this property is that the doNotScroll property is also set.</span>
<a name="l16779"></a>16779         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;comb&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;comb&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16780"></a>16780             $ff += 1 &lt;&lt; 24;
<a name="l16781"></a>16781         }
<a name="l16782"></a>16782         <span class="comment">// radiosInUnison: If false, even if a group of radio buttons have the same name and export value, they behave in a mutually exclusive fashion, like HTML radio buttons.</span>
<a name="l16783"></a>16783         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;radiosInUnison&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;radiosInUnison&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16784"></a>16784             $ff += 1 &lt;&lt; 25;
<a name="l16785"></a>16785         }
<a name="l16786"></a>16786         <span class="comment">// richText: If true, the field allows rich text formatting.</span>
<a name="l16787"></a>16787         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;richText&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;richText&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16788"></a>16788             $ff += 1 &lt;&lt; 25;
<a name="l16789"></a>16789         }
<a name="l16790"></a>16790         <span class="comment">// commitOnSelChange: Controls whether a field value is committed after a selection change.</span>
<a name="l16791"></a>16791         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;commitOnSelChange&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;commitOnSelChange&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16792"></a>16792             $ff += 1 &lt;&lt; 26;
<a name="l16793"></a>16793         }
<a name="l16794"></a>16794         $opt[<span class="stringliteral">&#39;ff&#39;</span>] = $ff;
<a name="l16795"></a>16795         <span class="comment">// defaultValue: The default value of a field - that is, the value that the field is set to when the form is reset.</span>
<a name="l16796"></a>16796         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;defaultValue&#39;</span>])) {
<a name="l16797"></a>16797             $opt[<span class="stringliteral">&#39;dv&#39;</span>] = $prop[<span class="stringliteral">&#39;defaultValue&#39;</span>];
<a name="l16798"></a>16798         }
<a name="l16799"></a>16799         <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = 4; <span class="comment">// default value for annotation flags</span>
<a name="l16800"></a>16800         <span class="comment">// readonly: The read-only characteristic of a field. If a field is read-only, the user can see the field but cannot change it.</span>
<a name="l16801"></a>16801         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;readonly&#39;</span>]) AND ($prop[<span class="stringliteral">&#39;readonly&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l16802"></a>16802             <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> += 1 &lt;&lt; 6;
<a name="l16803"></a>16803         }
<a name="l16804"></a>16804         <span class="comment">// display: Controls whether the field is hidden or visible on screen and in print.</span>
<a name="l16805"></a>16805         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;display&#39;</span>])) {
<a name="l16806"></a>16806             <span class="keywordflow">if</span> ($prop[<span class="stringliteral">&#39;display&#39;</span>] == <span class="stringliteral">&#39;display.visible&#39;</span>) {
<a name="l16807"></a>16807                 <span class="comment">//</span>
<a name="l16808"></a>16808             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($prop[<span class="stringliteral">&#39;display&#39;</span>] == <span class="stringliteral">&#39;display.hidden&#39;</span>) {
<a name="l16809"></a>16809                 <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> += 1 &lt;&lt; 1;
<a name="l16810"></a>16810             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($prop[<span class="stringliteral">&#39;display&#39;</span>] == <span class="stringliteral">&#39;display.noPrint&#39;</span>) {
<a name="l16811"></a>16811                 <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> -= 1 &lt;&lt; 2;
<a name="l16812"></a>16812             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($prop[<span class="stringliteral">&#39;display&#39;</span>] == <span class="stringliteral">&#39;display.noView&#39;</span>) {
<a name="l16813"></a>16813                 <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> += 1 &lt;&lt; 5;
<a name="l16814"></a>16814             }
<a name="l16815"></a>16815         }
<a name="l16816"></a>16816         $opt[<span class="charliteral">&#39;f&#39;</span>] = <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>;
<a name="l16817"></a>16817         <span class="comment">// currentValueIndices: Reads and writes single or multiple values of a list box or combo box.</span>
<a name="l16818"></a>16818         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;currentValueIndices&#39;</span>]) AND is_array($prop[<span class="stringliteral">&#39;currentValueIndices&#39;</span>])) {
<a name="l16819"></a>16819             $opt[<span class="charliteral">&#39;i&#39;</span>] = $prop[<span class="stringliteral">&#39;currentValueIndices&#39;</span>];
<a name="l16820"></a>16820         }
<a name="l16821"></a>16821         <span class="comment">// value: The value of the field data that the user has entered.</span>
<a name="l16822"></a>16822         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;value&#39;</span>])) {
<a name="l16823"></a>16823             <span class="keywordflow">if</span> (is_array($prop[<span class="stringliteral">&#39;value&#39;</span>])) {
<a name="l16824"></a>16824                 $opt[<span class="stringliteral">&#39;opt&#39;</span>] = array();
<a name="l16825"></a>16825                 <span class="keywordflow">foreach</span> ($prop[<span class="stringliteral">&#39;value&#39;</span>] AS $key =&gt; $optval) {
<a name="l16826"></a>16826                     <span class="comment">// exportValues: An array of strings representing the export values for the field.</span>
<a name="l16827"></a>16827                     <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;exportValues&#39;</span>][$key])) {
<a name="l16828"></a>16828                         $opt[<span class="stringliteral">&#39;opt&#39;</span>][$key] = array($prop[<span class="stringliteral">&#39;exportValues&#39;</span>][$key], $prop[<span class="stringliteral">&#39;value&#39;</span>][$key]);
<a name="l16829"></a>16829                     } <span class="keywordflow">else</span> {
<a name="l16830"></a>16830                         $opt[<span class="stringliteral">&#39;opt&#39;</span>][$key] = $prop[<span class="stringliteral">&#39;value&#39;</span>][$key];
<a name="l16831"></a>16831                     }
<a name="l16832"></a>16832                 }
<a name="l16833"></a>16833             } <span class="keywordflow">else</span> {
<a name="l16834"></a>16834                 $opt[<span class="charliteral">&#39;v&#39;</span>] = $prop[<span class="stringliteral">&#39;value&#39;</span>];
<a name="l16835"></a>16835             }
<a name="l16836"></a>16836         }
<a name="l16837"></a>16837         <span class="comment">// richValue: This property specifies the text contents and formatting of a rich text field.</span>
<a name="l16838"></a>16838         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;richValue&#39;</span>])) {
<a name="l16839"></a>16839             $opt[<span class="stringliteral">&#39;rv&#39;</span>] = $prop[<span class="stringliteral">&#39;richValue&#39;</span>];
<a name="l16840"></a>16840         }
<a name="l16841"></a>16841         <span class="comment">// submitName: If nonempty, used during form submission instead of name. Only applicable if submitting in HTML format (that is, URL-encoded).</span>
<a name="l16842"></a>16842         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;submitName&#39;</span>])) {
<a name="l16843"></a>16843             $opt[<span class="stringliteral">&#39;tm&#39;</span>] = $prop[<span class="stringliteral">&#39;submitName&#39;</span>];
<a name="l16844"></a>16844         }
<a name="l16845"></a>16845         <span class="comment">// name: Fully qualified field name.</span>
<a name="l16846"></a>16846         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;name&#39;</span>])) {
<a name="l16847"></a>16847             $opt[<span class="charliteral">&#39;t&#39;</span>] = $prop[<span class="stringliteral">&#39;name&#39;</span>];
<a name="l16848"></a>16848         }
<a name="l16849"></a>16849         <span class="comment">// userName: The user name (short description string) of the field.</span>
<a name="l16850"></a>16850         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;userName&#39;</span>])) {
<a name="l16851"></a>16851             $opt[<span class="stringliteral">&#39;tu&#39;</span>] = $prop[<span class="stringliteral">&#39;userName&#39;</span>];
<a name="l16852"></a>16852         }
<a name="l16853"></a>16853         <span class="comment">// highlight: Defines how a button reacts when a user clicks it.</span>
<a name="l16854"></a>16854         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;highlight&#39;</span>])) {
<a name="l16855"></a>16855             <span class="keywordflow">switch</span> ($prop[<span class="stringliteral">&#39;highlight&#39;</span>]) {
<a name="l16856"></a>16856                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;none&#39;</span>:
<a name="l16857"></a>16857                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;highlight.n&#39;</span>: {
<a name="l16858"></a>16858                     $opt[<span class="charliteral">&#39;h&#39;</span>] = <span class="charliteral">&#39;N&#39;</span>;
<a name="l16859"></a>16859                     <span class="keywordflow">break</span>;
<a name="l16860"></a>16860                 }
<a name="l16861"></a>16861                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;invert&#39;</span>:
<a name="l16862"></a>16862                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;highlight.i&#39;</span>: {
<a name="l16863"></a>16863                     $opt[<span class="charliteral">&#39;h&#39;</span>] = <span class="charliteral">&#39;i&#39;</span>;
<a name="l16864"></a>16864                     <span class="keywordflow">break</span>;
<a name="l16865"></a>16865                 }
<a name="l16866"></a>16866                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;push&#39;</span>:
<a name="l16867"></a>16867                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;highlight.p&#39;</span>: {
<a name="l16868"></a>16868                     $opt[<span class="charliteral">&#39;h&#39;</span>] = <span class="charliteral">&#39;P&#39;</span>;
<a name="l16869"></a>16869                     <span class="keywordflow">break</span>;
<a name="l16870"></a>16870                 }
<a name="l16871"></a>16871                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;outline&#39;</span>:
<a name="l16872"></a>16872                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;highlight.o&#39;</span>: {
<a name="l16873"></a>16873                     $opt[<span class="charliteral">&#39;h&#39;</span>] = <span class="charliteral">&#39;O&#39;</span>;
<a name="l16874"></a>16874                     <span class="keywordflow">break</span>;
<a name="l16875"></a>16875                 }
<a name="l16876"></a>16876             }
<a name="l16877"></a>16877         }
<a name="l16878"></a>16878         <span class="comment">// Unsupported options:</span>
<a name="l16879"></a>16879         <span class="comment">// - calcOrderIndex: Changes the calculation order of fields in the document.</span>
<a name="l16880"></a>16880         <span class="comment">// - delay: Delays the redrawing of a field&#39;s appearance.</span>
<a name="l16881"></a>16881         <span class="comment">// - defaultStyle: This property defines the default style attributes for the form field.</span>
<a name="l16882"></a>16882         <span class="comment">// - style: Allows the user to set the glyph style of a check box or radio button.</span>
<a name="l16883"></a>16883         <span class="comment">// - textColor, textFont, textSize</span>
<a name="l16884"></a>16884         <span class="keywordflow">return</span> $opt;
<a name="l16885"></a>16885     }
<a name="l16886"></a>16886 <span class="comment"></span>
<a name="l16887"></a>16887 <span class="comment">    /**</span>
<a name="l16888"></a>16888 <span class="comment">     * Set default properties for form fields.</span>
<a name="l16889"></a>16889 <span class="comment">     * @param $prop (array) javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l16890"></a>16890 <span class="comment">     * @public</span>
<a name="l16891"></a>16891 <span class="comment">     * @author Nicola Asuni</span>
<a name="l16892"></a>16892 <span class="comment">     * @since 4.8.000 (2009-09-06)</span>
<a name="l16893"></a>16893 <span class="comment">     */</span>
<a name="l16894"></a><a class="code" href="classTCPDF.html#a1611451af253619217095e279f52fa52">16894</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1611451af253619217095e279f52fa52" title="Set default properties for form fields.">setFormDefaultProp</a>($prop=array()) {
<a name="l16895"></a>16895         $this-&gt;default_form_prop = $prop;
<a name="l16896"></a>16896     }
<a name="l16897"></a>16897 <span class="comment"></span>
<a name="l16898"></a>16898 <span class="comment">    /**</span>
<a name="l16899"></a>16899 <span class="comment">     * Return the default properties for form fields.</span>
<a name="l16900"></a>16900 <span class="comment">     * @return array $prop javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l16901"></a>16901 <span class="comment">     * @public</span>
<a name="l16902"></a>16902 <span class="comment">     * @author Nicola Asuni</span>
<a name="l16903"></a>16903 <span class="comment">     * @since 4.8.000 (2009-09-06)</span>
<a name="l16904"></a>16904 <span class="comment">     */</span>
<a name="l16905"></a><a class="code" href="classTCPDF.html#aca1da710f70d3b0e756be97adf23418c">16905</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aca1da710f70d3b0e756be97adf23418c" title="Return the default properties for form fields.">getFormDefaultProp</a>() {
<a name="l16906"></a>16906         <span class="keywordflow">return</span> $this-&gt;default_form_prop;
<a name="l16907"></a>16907     }
<a name="l16908"></a>16908 <span class="comment"></span>
<a name="l16909"></a>16909 <span class="comment">    /**</span>
<a name="l16910"></a>16910 <span class="comment">     * Creates a text field</span>
<a name="l16911"></a>16911 <span class="comment">     * @param $name (string) field name</span>
<a name="l16912"></a>16912 <span class="comment">     * @param $w (float) Width of the rectangle</span>
<a name="l16913"></a>16913 <span class="comment">     * @param $h (float) Height of the rectangle</span>
<a name="l16914"></a>16914 <span class="comment">     * @param $prop (array) javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l16915"></a>16915 <span class="comment">     * @param $opt (array) annotation parameters. Possible values are described on official PDF32000_2008 reference.</span>
<a name="l16916"></a>16916 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner of the rectangle</span>
<a name="l16917"></a>16917 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner of the rectangle</span>
<a name="l16918"></a>16918 <span class="comment">     * @param $js (boolean) if true put the field using JavaScript (requires Acrobat Writer to be rendered).</span>
<a name="l16919"></a>16919 <span class="comment">     * @public</span>
<a name="l16920"></a>16920 <span class="comment">     * @author Nicola Asuni</span>
<a name="l16921"></a>16921 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l16922"></a>16922 <span class="comment">     */</span>
<a name="l16923"></a><a class="code" href="classTCPDF.html#a71d382a4356e7fb3f9fa72e53642c09c">16923</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a71d382a4356e7fb3f9fa72e53642c09c" title="Creates a text field.">TextField</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $prop=array(), $opt=array(), <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, $js=<span class="keyword">false</span>) {
<a name="l16924"></a>16924         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l16925"></a>16925             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l16926"></a>16926         }
<a name="l16927"></a>16927         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l16928"></a>16928             $y = $this-&gt;y;
<a name="l16929"></a>16929         }
<a name="l16930"></a>16930         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l16931"></a>16931         list(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;checkPageRegions(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l16932"></a>16932         <span class="keywordflow">if</span> ($js) {
<a name="l16933"></a>16933             $this-&gt;_addfield(<span class="stringliteral">&#39;text&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $prop);
<a name="l16934"></a>16934             <span class="keywordflow">return</span>;
<a name="l16935"></a>16935         }
<a name="l16936"></a>16936         <span class="comment">// get default style</span>
<a name="l16937"></a>16937         $prop = array_merge($this-&gt;getFormDefaultProp(), $prop);
<a name="l16938"></a>16938         <span class="comment">// get annotation data</span>
<a name="l16939"></a>16939         $popt = $this-&gt;getAnnotOptFromJSProp($prop);
<a name="l16940"></a>16940         <span class="comment">// set default appearance stream</span>
<a name="l16941"></a>16941         $this-&gt;annotation_fonts[$this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>]] = $this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>];
<a name="l16942"></a>16942         $fontstyle = sprintf(<span class="stringliteral">&#39;/F%d %.2F Tf %s&#39;</span>, $this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt, $this-&gt;TextColor);
<a name="l16943"></a>16943         $popt[<span class="stringliteral">&#39;da&#39;</span>] = $fontstyle;
<a name="l16944"></a>16944         <span class="comment">// build appearance stream</span>
<a name="l16945"></a>16945         $popt[<span class="stringliteral">&#39;ap&#39;</span>] = array();
<a name="l16946"></a>16946         $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] = <span class="stringliteral">&#39;/Tx BMC q &#39;</span>.$fontstyle.<span class="charliteral">&#39; &#39;</span>;
<a name="l16947"></a>16947         <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l16948"></a>16948         <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;value&#39;</span>]) AND !empty($prop[<span class="stringliteral">&#39;value&#39;</span>])) {
<a name="l16949"></a>16949             <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a> = $prop[<span class="stringliteral">&#39;value&#39;</span>];
<a name="l16950"></a>16950         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($opt[<span class="charliteral">&#39;v&#39;</span>]) AND !empty($opt[<span class="charliteral">&#39;v&#39;</span>])) {
<a name="l16951"></a>16951             <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a> = $opt[<span class="charliteral">&#39;v&#39;</span>];
<a name="l16952"></a>16952         }
<a name="l16953"></a>16953         $tmpid = $this-&gt;startTemplate(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="keyword">false</span>);
<a name="l16954"></a>16954         $this-&gt;MultiCell(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 0, 0, 0, <span class="keyword">true</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>, 0, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>);
<a name="l16955"></a>16955         $this-&gt;endTemplate();
<a name="l16956"></a>16956         --$this-&gt;n;
<a name="l16957"></a>16957         $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] .= $this-&gt;xobjects[$tmpid][<span class="stringliteral">&#39;outdata&#39;</span>];
<a name="l16958"></a>16958         unset($this-&gt;xobjects[$tmpid]);
<a name="l16959"></a>16959         $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] .= <span class="stringliteral">&#39;Q EMC&#39;</span>;
<a name="l16960"></a>16960         <span class="comment">// merge options</span>
<a name="l16961"></a>16961         $opt = array_merge($popt, $opt);
<a name="l16962"></a>16962         <span class="comment">// remove some conflicting options</span>
<a name="l16963"></a>16963         unset($opt[<span class="stringliteral">&#39;bs&#39;</span>]);
<a name="l16964"></a>16964         <span class="comment">// set remaining annotation data</span>
<a name="l16965"></a>16965         $opt[<span class="stringliteral">&#39;Subtype&#39;</span>] = <span class="stringliteral">&#39;Widget&#39;</span>;
<a name="l16966"></a>16966         $opt[<span class="stringliteral">&#39;ft&#39;</span>] = <span class="stringliteral">&#39;Tx&#39;</span>;
<a name="l16967"></a>16967         $opt[<span class="charliteral">&#39;t&#39;</span>] = <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>;
<a name="l16968"></a>16968         <span class="comment">// Additional annotation&#39;s parameters (check _putannotsobj() method):</span>
<a name="l16969"></a>16969         <span class="comment">//$opt[&#39;f&#39;]</span>
<a name="l16970"></a>16970         <span class="comment">//$opt[&#39;as&#39;]</span>
<a name="l16971"></a>16971         <span class="comment">//$opt[&#39;bs&#39;]</span>
<a name="l16972"></a>16972         <span class="comment">//$opt[&#39;be&#39;]</span>
<a name="l16973"></a>16973         <span class="comment">//$opt[&#39;c&#39;]</span>
<a name="l16974"></a>16974         <span class="comment">//$opt[&#39;border&#39;]</span>
<a name="l16975"></a>16975         <span class="comment">//$opt[&#39;h&#39;]</span>
<a name="l16976"></a>16976         <span class="comment">//$opt[&#39;mk&#39;];</span>
<a name="l16977"></a>16977         <span class="comment">//$opt[&#39;mk&#39;][&#39;r&#39;]</span>
<a name="l16978"></a>16978         <span class="comment">//$opt[&#39;mk&#39;][&#39;bc&#39;];</span>
<a name="l16979"></a>16979         <span class="comment">//$opt[&#39;mk&#39;][&#39;bg&#39;];</span>
<a name="l16980"></a>16980         unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>]);
<a name="l16981"></a>16981         unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>]);
<a name="l16982"></a>16982         unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ac&#39;</span>]);
<a name="l16983"></a>16983         unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]);
<a name="l16984"></a>16984         unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>]);
<a name="l16985"></a>16985         unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>]);
<a name="l16986"></a>16986         unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>]);
<a name="l16987"></a>16987         <span class="comment">//$opt[&#39;mk&#39;][&#39;if&#39;][&#39;sw&#39;];</span>
<a name="l16988"></a>16988         <span class="comment">//$opt[&#39;mk&#39;][&#39;if&#39;][&#39;s&#39;];</span>
<a name="l16989"></a>16989         <span class="comment">//$opt[&#39;mk&#39;][&#39;if&#39;][&#39;a&#39;];</span>
<a name="l16990"></a>16990         <span class="comment">//$opt[&#39;mk&#39;][&#39;if&#39;][&#39;fb&#39;];</span>
<a name="l16991"></a>16991         unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>]);
<a name="l16992"></a>16992         <span class="comment">//$opt[&#39;tu&#39;]</span>
<a name="l16993"></a>16993         <span class="comment">//$opt[&#39;tm&#39;]</span>
<a name="l16994"></a>16994         <span class="comment">//$opt[&#39;ff&#39;]</span>
<a name="l16995"></a>16995         <span class="comment">//$opt[&#39;v&#39;]</span>
<a name="l16996"></a>16996         <span class="comment">//$opt[&#39;dv&#39;]</span>
<a name="l16997"></a>16997         <span class="comment">//$opt[&#39;a&#39;]</span>
<a name="l16998"></a>16998         <span class="comment">//$opt[&#39;aa&#39;]</span>
<a name="l16999"></a>16999         <span class="comment">//$opt[&#39;q&#39;]</span>
<a name="l17000"></a>17000         $this-&gt;Annotation(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $opt, 0);
<a name="l17001"></a>17001         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l17002"></a>17002             $this-&gt;x -= <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l17003"></a>17003         } <span class="keywordflow">else</span> {
<a name="l17004"></a>17004             $this-&gt;x += <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l17005"></a>17005         }
<a name="l17006"></a>17006     }
<a name="l17007"></a>17007 <span class="comment"></span>
<a name="l17008"></a>17008 <span class="comment">    /**</span>
<a name="l17009"></a>17009 <span class="comment">     * Creates a RadioButton field.</span>
<a name="l17010"></a>17010 <span class="comment">     * @param $name (string) Field name.</span>
<a name="l17011"></a>17011 <span class="comment">     * @param $w (int) Width or the radio button.</span>
<a name="l17012"></a>17012 <span class="comment">     * @param $prop (array) Javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l17013"></a>17013 <span class="comment">     * @param $opt (array) Annotation parameters. Possible values are described on official PDF32000_2008 reference.</span>
<a name="l17014"></a>17014 <span class="comment">     * @param $onvalue (string) Value to be returned if selected.</span>
<a name="l17015"></a>17015 <span class="comment">     * @param $checked (boolean) Define the initial state.</span>
<a name="l17016"></a>17016 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner of the rectangle</span>
<a name="l17017"></a>17017 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner of the rectangle</span>
<a name="l17018"></a>17018 <span class="comment">     * @param $js (boolean) If true put the field using JavaScript (requires Acrobat Writer to be rendered).</span>
<a name="l17019"></a>17019 <span class="comment">     * @public</span>
<a name="l17020"></a>17020 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17021"></a>17021 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l17022"></a>17022 <span class="comment">     */</span>
<a name="l17023"></a><a class="code" href="classTCPDF.html#a8a1af14cce3111886a7ec8024a02bbbc">17023</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8a1af14cce3111886a7ec8024a02bbbc" title="Creates a RadioButton field.">RadioButton</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $prop=array(), $opt=array(), $onvalue=<span class="stringliteral">&#39;On&#39;</span>, <a class="code" href="db__structure_8php.html#aae831eeaf71994cc7e31c1412a29f6fd">$checked</a>=<span class="keyword">false</span>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, $js=<span class="keyword">false</span>) {
<a name="l17024"></a>17024         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l17025"></a>17025             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l17026"></a>17026         }
<a name="l17027"></a>17027         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l17028"></a>17028             $y = $this-&gt;y;
<a name="l17029"></a>17029         }
<a name="l17030"></a>17030         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l17031"></a>17031         list(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;checkPageRegions(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l17032"></a>17032         <span class="keywordflow">if</span> ($js) {
<a name="l17033"></a>17033             $this-&gt;_addfield(<span class="stringliteral">&#39;radiobutton&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $prop);
<a name="l17034"></a>17034             <span class="keywordflow">return</span>;
<a name="l17035"></a>17035         }
<a name="l17036"></a>17036         <span class="keywordflow">if</span> ($this-&gt;empty_string($onvalue)) {
<a name="l17037"></a>17037             $onvalue = <span class="stringliteral">&#39;On&#39;</span>;
<a name="l17038"></a>17038         }
<a name="l17039"></a>17039         <span class="keywordflow">if</span> (<a class="code" href="db__structure_8php.html#aae831eeaf71994cc7e31c1412a29f6fd">$checked</a>) {
<a name="l17040"></a>17040             $defval = $onvalue;
<a name="l17041"></a>17041         } <span class="keywordflow">else</span> {
<a name="l17042"></a>17042             $defval = <span class="stringliteral">&#39;Off&#39;</span>;
<a name="l17043"></a>17043         }
<a name="l17044"></a>17044         <span class="comment">// set font</span>
<a name="l17045"></a>17045         <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a> = <span class="stringliteral">&#39;zapfdingbats&#39;</span>;
<a name="l17046"></a>17046         $this-&gt;AddFont(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>);
<a name="l17047"></a>17047         $tmpfont = $this-&gt;getFontBuffer(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>);
<a name="l17048"></a>17048         <span class="comment">// set data for parent group</span>
<a name="l17049"></a>17049         <span class="keywordflow">if</span> (!isset($this-&gt;radiobutton_groups[$this-&gt;page])) {
<a name="l17050"></a>17050             $this-&gt;radiobutton_groups[$this-&gt;page] = array();
<a name="l17051"></a>17051         }
<a name="l17052"></a>17052         <span class="keywordflow">if</span> (!isset($this-&gt;radiobutton_groups[$this-&gt;page][<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>])) {
<a name="l17053"></a>17053             $this-&gt;radiobutton_groups[$this-&gt;page][<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>] = array();
<a name="l17054"></a>17054             ++$this-&gt;n;
<a name="l17055"></a>17055             $this-&gt;radiobutton_groups[$this-&gt;page][<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>][<span class="charliteral">&#39;n&#39;</span>] = $this-&gt;n;
<a name="l17056"></a>17056             $this-&gt;radio_groups[] = $this-&gt;n;
<a name="l17057"></a>17057         }
<a name="l17058"></a>17058         $kid = ($this-&gt;n + 1);
<a name="l17059"></a>17059         <span class="comment">// save object ID to be added on Kids entry on parent object</span>
<a name="l17060"></a>17060         $this-&gt;radiobutton_groups[$this-&gt;page][<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>][] = array(<span class="stringliteral">&#39;kid&#39;</span> =&gt; $kid, <span class="stringliteral">&#39;def&#39;</span> =&gt; $defval);
<a name="l17061"></a>17061         <span class="comment">// get default style</span>
<a name="l17062"></a>17062         $prop = array_merge($this-&gt;getFormDefaultProp(), $prop);
<a name="l17063"></a>17063         $prop[<span class="stringliteral">&#39;NoToggleToOff&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l17064"></a>17064         $prop[<span class="stringliteral">&#39;Radio&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l17065"></a>17065         $prop[<span class="stringliteral">&#39;borderStyle&#39;</span>] = <span class="stringliteral">&#39;inset&#39;</span>;
<a name="l17066"></a>17066         <span class="comment">// get annotation data</span>
<a name="l17067"></a>17067         $popt = $this-&gt;getAnnotOptFromJSProp($prop);
<a name="l17068"></a>17068         <span class="comment">// set additional default options</span>
<a name="l17069"></a>17069         $this-&gt;annotation_fonts[$tmpfont[<span class="stringliteral">&#39;fontkey&#39;</span>]] = $tmpfont[<span class="charliteral">&#39;i&#39;</span>];
<a name="l17070"></a>17070         $fontstyle = sprintf(<span class="stringliteral">&#39;/F%d %.2F Tf %s&#39;</span>, $tmpfont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt, $this-&gt;TextColor);
<a name="l17071"></a>17071         $popt[<span class="stringliteral">&#39;da&#39;</span>] = $fontstyle;
<a name="l17072"></a>17072         <span class="comment">// build appearance stream</span>
<a name="l17073"></a>17073         $popt[<span class="stringliteral">&#39;ap&#39;</span>] = array();
<a name="l17074"></a>17074         $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] = array();
<a name="l17075"></a>17075         $fy = ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> - ((($tmpfont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] - $tmpfont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>]) * $this-&gt;FontSizePt / 1000) / $this-&gt;k)) * $this-&gt;k);
<a name="l17076"></a>17076         $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>][$onvalue] = sprintf(<span class="stringliteral">&#39;q %s BT /F%d %.2F Tf %.2F %.2F Td (&#39;</span>.chr(108).<span class="stringliteral">&#39;) Tj ET Q&#39;</span>, $this-&gt;TextColor, $tmpfont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt, 0, $fy);
<a name="l17077"></a>17077         $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>][<span class="stringliteral">&#39;Off&#39;</span>] = sprintf(<span class="stringliteral">&#39;q %s BT /F%d %.2F Tf %.2F %.2F Td (&#39;</span>.chr(109).<span class="stringliteral">&#39;) Tj ET Q&#39;</span>, $this-&gt;TextColor, $tmpfont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt, 0, $fy);
<a name="l17078"></a>17078         <span class="keywordflow">if</span> (!isset($popt[<span class="stringliteral">&#39;mk&#39;</span>])) {
<a name="l17079"></a>17079             $popt[<span class="stringliteral">&#39;mk&#39;</span>] = array();
<a name="l17080"></a>17080         }
<a name="l17081"></a>17081         $popt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>] = <span class="stringliteral">&#39;(l)&#39;</span>;
<a name="l17082"></a>17082         <span class="comment">// merge options</span>
<a name="l17083"></a>17083         $opt = array_merge($popt, $opt);
<a name="l17084"></a>17084         <span class="comment">// set remaining annotation data</span>
<a name="l17085"></a>17085         $opt[<span class="stringliteral">&#39;Subtype&#39;</span>] = <span class="stringliteral">&#39;Widget&#39;</span>;
<a name="l17086"></a>17086         $opt[<span class="stringliteral">&#39;ft&#39;</span>] = <span class="stringliteral">&#39;Btn&#39;</span>;
<a name="l17087"></a>17087         <span class="keywordflow">if</span> (<a class="code" href="db__structure_8php.html#aae831eeaf71994cc7e31c1412a29f6fd">$checked</a>) {
<a name="l17088"></a>17088             $opt[<span class="charliteral">&#39;v&#39;</span>] = array(<span class="charliteral">&#39;/&#39;</span>.$onvalue);
<a name="l17089"></a>17089             $opt[<span class="stringliteral">&#39;as&#39;</span>] = $onvalue;
<a name="l17090"></a>17090         } <span class="keywordflow">else</span> {
<a name="l17091"></a>17091             $opt[<span class="stringliteral">&#39;as&#39;</span>] = <span class="stringliteral">&#39;Off&#39;</span>;
<a name="l17092"></a>17092         }
<a name="l17093"></a>17093         <span class="comment">// store readonly flag</span>
<a name="l17094"></a>17094         <span class="keywordflow">if</span> (!isset($this-&gt;radiobutton_groups[$this-&gt;page][$name][<span class="stringliteral">&#39;#readonly#&#39;</span>])) {
<a name="l17095"></a>17095             $this-&gt;radiobutton_groups[$this-&gt;page][<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>][<span class="stringliteral">&#39;#readonly#&#39;</span>] = <span class="keyword">false</span>;
<a name="l17096"></a>17096         }
<a name="l17097"></a>17097         $this-&gt;radiobutton_groups[$this-&gt;page][<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>][<span class="stringliteral">&#39;#readonly#&#39;</span>] |= ($opt[<span class="charliteral">&#39;f&#39;</span>] &amp; 64);
<a name="l17098"></a>17098         $this-&gt;Annotation(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $name, $opt, 0);
<a name="l17099"></a>17099         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l17100"></a>17100             $this-&gt;x -= <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l17101"></a>17101         } <span class="keywordflow">else</span> {
<a name="l17102"></a>17102             $this-&gt;x += <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l17103"></a>17103         }
<a name="l17104"></a>17104     }
<a name="l17105"></a>17105 <span class="comment"></span>
<a name="l17106"></a>17106 <span class="comment">    /**</span>
<a name="l17107"></a>17107 <span class="comment">     * Creates a List-box field</span>
<a name="l17108"></a>17108 <span class="comment">     * @param $name (string) field name</span>
<a name="l17109"></a>17109 <span class="comment">     * @param $w (int) width</span>
<a name="l17110"></a>17110 <span class="comment">     * @param $h (int) height</span>
<a name="l17111"></a>17111 <span class="comment">     * @param $values (array) array containing the list of values.</span>
<a name="l17112"></a>17112 <span class="comment">     * @param $prop (array) javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l17113"></a>17113 <span class="comment">     * @param $opt (array) annotation parameters. Possible values are described on official PDF32000_2008 reference.</span>
<a name="l17114"></a>17114 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner of the rectangle</span>
<a name="l17115"></a>17115 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner of the rectangle</span>
<a name="l17116"></a>17116 <span class="comment">     * @param $js (boolean) if true put the field using JavaScript (requires Acrobat Writer to be rendered).</span>
<a name="l17117"></a>17117 <span class="comment">     * @public</span>
<a name="l17118"></a>17118 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17119"></a>17119 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l17120"></a>17120 <span class="comment">     */</span>
<a name="l17121"></a><a class="code" href="classTCPDF.html#a72e9f4b59b7aa0dfd4f96c011d460e56">17121</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a72e9f4b59b7aa0dfd4f96c011d460e56" title="Creates a List-box field.">ListBox</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="enum__editor_8php.html#affc45c6ace2eeb3f300b054dbf9592b6">$values</a>, $prop=array(), $opt=array(), <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, $js=<span class="keyword">false</span>) {
<a name="l17122"></a>17122         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l17123"></a>17123             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l17124"></a>17124         }
<a name="l17125"></a>17125         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l17126"></a>17126             $y = $this-&gt;y;
<a name="l17127"></a>17127         }
<a name="l17128"></a>17128         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l17129"></a>17129         list(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;checkPageRegions(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l17130"></a>17130         <span class="keywordflow">if</span> ($js) {
<a name="l17131"></a>17131             $this-&gt;_addfield(<span class="stringliteral">&#39;listbox&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $prop);
<a name="l17132"></a>17132             <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l17133"></a>17133             <span class="keywordflow">foreach</span> (<a class="code" href="enum__editor_8php.html#affc45c6ace2eeb3f300b054dbf9592b6">$values</a> as $value) {
<a name="l17134"></a>17134                 <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= <span class="charliteral">&#39;\&#39;&#39;</span>.addslashes($value).<span class="charliteral">&#39;\&#39;</span>,<span class="stringliteral">&#39;;</span>
<a name="l17135"></a>17135 <span class="stringliteral">            }</span>
<a name="l17136"></a>17136 <span class="stringliteral">            $this-&gt;javascript .= &#39;</span>f<span class="stringliteral">&#39;.$name.&#39;</span>.setItems([<span class="stringliteral">&#39;.substr($s, 0, -1).&quot;]);\n&quot;;</span>
<a name="l17137"></a>17137 <span class="stringliteral">            return;</span>
<a name="l17138"></a>17138 <span class="stringliteral">        }</span>
<a name="l17139"></a>17139 <span class="stringliteral">        // get default style</span>
<a name="l17140"></a>17140 <span class="stringliteral">        $prop = array_merge($this-&gt;getFormDefaultProp(), $prop);</span>
<a name="l17141"></a>17141 <span class="stringliteral">        // get annotation data</span>
<a name="l17142"></a>17142 <span class="stringliteral">        $popt = $this-&gt;getAnnotOptFromJSProp($prop);</span>
<a name="l17143"></a>17143 <span class="stringliteral">        // set additional default values</span>
<a name="l17144"></a>17144 <span class="stringliteral">        $this-&gt;annotation_fonts[$this-&gt;CurrentFont[&#39;</span>fontkey<span class="stringliteral">&#39;]] = $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;];</span>
<a name="l17145"></a>17145 <span class="stringliteral">        $fontstyle = sprintf(&#39;</span>/F%d %.2F Tf %s<span class="stringliteral">&#39;, $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;], $this-&gt;FontSizePt, $this-&gt;TextColor);</span>
<a name="l17146"></a>17146 <span class="stringliteral">        $popt[&#39;</span>da<span class="stringliteral">&#39;] = $fontstyle;</span>
<a name="l17147"></a>17147 <span class="stringliteral">        // build appearance stream</span>
<a name="l17148"></a>17148 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;] = array();</span>
<a name="l17149"></a>17149 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] = &#39;</span>/Tx BMC q <span class="stringliteral">&#39;.$fontstyle.&#39;</span> <span class="stringliteral">&#39;;</span>
<a name="l17150"></a>17150 <span class="stringliteral">        $text = &#39;</span><span class="stringliteral">&#39;;</span>
<a name="l17151"></a>17151 <span class="stringliteral">        foreach($values as $item) {</span>
<a name="l17152"></a>17152 <span class="stringliteral">            $text .= $item.&quot;\n&quot;;</span>
<a name="l17153"></a>17153 <span class="stringliteral">        }</span>
<a name="l17154"></a>17154 <span class="stringliteral">        $tmpid = $this-&gt;startTemplate($w, $h, false);</span>
<a name="l17155"></a>17155 <span class="stringliteral">        $this-&gt;MultiCell($w, $h, $text, 0, &#39;</span><span class="stringliteral">&#39;, false, 0, 0, 0, true, 0, false, true, 0, &#39;</span>T<span class="stringliteral">&#39;, false);</span>
<a name="l17156"></a>17156 <span class="stringliteral">        $this-&gt;endTemplate();</span>
<a name="l17157"></a>17157 <span class="stringliteral">        --$this-&gt;n;</span>
<a name="l17158"></a>17158 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= $this-&gt;xobjects[$tmpid][&#39;</span>outdata<span class="stringliteral">&#39;];</span>
<a name="l17159"></a>17159 <span class="stringliteral">        unset($this-&gt;xobjects[$tmpid]);</span>
<a name="l17160"></a>17160 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= &#39;</span>Q EMC<span class="stringliteral">&#39;;</span>
<a name="l17161"></a>17161 <span class="stringliteral">        // merge options</span>
<a name="l17162"></a>17162 <span class="stringliteral">        $opt = array_merge($popt, $opt);</span>
<a name="l17163"></a>17163 <span class="stringliteral">        // set remaining annotation data</span>
<a name="l17164"></a>17164 <span class="stringliteral">        $opt[&#39;</span>Subtype<span class="stringliteral">&#39;] = &#39;</span>Widget<span class="stringliteral">&#39;;</span>
<a name="l17165"></a>17165 <span class="stringliteral">        $opt[&#39;</span>ft<span class="stringliteral">&#39;] = &#39;</span>Ch<span class="stringliteral">&#39;;</span>
<a name="l17166"></a>17166 <span class="stringliteral">        $opt[&#39;</span>t<span class="stringliteral">&#39;] = $name;</span>
<a name="l17167"></a>17167 <span class="stringliteral">        $opt[&#39;</span>opt<span class="stringliteral">&#39;] = $values;</span>
<a name="l17168"></a>17168 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ca<span class="stringliteral">&#39;]);</span>
<a name="l17169"></a>17169 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>rc<span class="stringliteral">&#39;]);</span>
<a name="l17170"></a>17170 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ac<span class="stringliteral">&#39;]);</span>
<a name="l17171"></a>17171 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>i<span class="stringliteral">&#39;]);</span>
<a name="l17172"></a>17172 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ri<span class="stringliteral">&#39;]);</span>
<a name="l17173"></a>17173 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ix<span class="stringliteral">&#39;]);</span>
<a name="l17174"></a>17174 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span><span class="keywordflow">if</span><span class="stringliteral">&#39;]);</span>
<a name="l17175"></a>17175 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>tp<span class="stringliteral">&#39;]);</span>
<a name="l17176"></a>17176 <span class="stringliteral">        $this-&gt;Annotation($x, $y, $w, $h, $name, $opt, 0);</span>
<a name="l17177"></a>17177 <span class="stringliteral">        if ($this-&gt;rtl) {</span>
<a name="l17178"></a>17178 <span class="stringliteral">            $this-&gt;x -= $w;</span>
<a name="l17179"></a>17179 <span class="stringliteral">        } else {</span>
<a name="l17180"></a>17180 <span class="stringliteral">            $this-&gt;x += $w;</span>
<a name="l17181"></a>17181 <span class="stringliteral">        }</span>
<a name="l17182"></a>17182 <span class="stringliteral">    }</span>
<a name="l17183"></a>17183 <span class="stringliteral"></span><span class="comment"></span>
<a name="l17184"></a>17184 <span class="comment">    /**</span>
<a name="l17185"></a>17185 <span class="comment">     * Creates a Combo-box field</span>
<a name="l17186"></a>17186 <span class="comment">     * @param $name (string) field name</span>
<a name="l17187"></a>17187 <span class="comment">     * @param $w (int) width</span>
<a name="l17188"></a>17188 <span class="comment">     * @param $h (int) height</span>
<a name="l17189"></a>17189 <span class="comment">     * @param $values (array) array containing the list of values.</span>
<a name="l17190"></a>17190 <span class="comment">     * @param $prop (array) javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l17191"></a>17191 <span class="comment">     * @param $opt (array) annotation parameters. Possible values are described on official PDF32000_2008 reference.</span>
<a name="l17192"></a>17192 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner of the rectangle</span>
<a name="l17193"></a>17193 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner of the rectangle</span>
<a name="l17194"></a>17194 <span class="comment">     * @param $js (boolean) if true put the field using JavaScript (requires Acrobat Writer to be rendered).</span>
<a name="l17195"></a>17195 <span class="comment">     * @public</span>
<a name="l17196"></a>17196 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17197"></a>17197 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l17198"></a>17198 <span class="comment">     */</span>
<a name="l17199"></a><a class="code" href="classTCPDF.html#af4e1e050349376d6a3174ab31bdde29f">17199</a>     public function ComboBox($name, $w, $h, $values, $prop=array(), $opt=array(), $x=&#39;<span class="stringliteral">&#39;, $y=&#39;</span><span class="stringliteral">&#39;, $js=false) {</span>
<a name="l17200"></a>17200 <span class="stringliteral">        if ($x === &#39;</span><span class="stringliteral">&#39;) {</span>
<a name="l17201"></a>17201 <span class="stringliteral">            $x = $this-&gt;x;</span>
<a name="l17202"></a>17202 <span class="stringliteral">        }</span>
<a name="l17203"></a>17203 <span class="stringliteral">        if ($y === &#39;</span><span class="stringliteral">&#39;) {</span>
<a name="l17204"></a>17204 <span class="stringliteral">            $y = $this-&gt;y;</span>
<a name="l17205"></a>17205 <span class="stringliteral">        }</span>
<a name="l17206"></a>17206 <span class="stringliteral">        // check page for no-write regions and adapt page margins if necessary</span>
<a name="l17207"></a>17207 <span class="stringliteral">        list($x, $y) = $this-&gt;checkPageRegions($h, $x, $y);</span>
<a name="l17208"></a>17208 <span class="stringliteral">        if ($js) {</span>
<a name="l17209"></a>17209 <span class="stringliteral">            $this-&gt;_addfield(&#39;</span>combobox<span class="stringliteral">&#39;, $name, $x, $y, $w, $h, $prop);</span>
<a name="l17210"></a>17210 <span class="stringliteral">            $s = &#39;</span><span class="stringliteral">&#39;;</span>
<a name="l17211"></a>17211 <span class="stringliteral">            foreach ($values as $value) {</span>
<a name="l17212"></a>17212 <span class="stringliteral">                $s .= &quot;&#39;</span><span class="stringliteral">&quot;.addslashes($value).&quot;</span><span class="stringliteral">&#39;,&quot;;</span>
<a name="l17213"></a>17213 <span class="stringliteral">            }</span>
<a name="l17214"></a>17214 <span class="stringliteral">            $this-&gt;javascript .= &#39;</span>f<span class="stringliteral">&#39;.$name.&#39;</span>.setItems([<span class="stringliteral">&#39;.substr($s, 0, -1).&quot;]);\n&quot;;</span>
<a name="l17215"></a>17215 <span class="stringliteral">            return;</span>
<a name="l17216"></a>17216 <span class="stringliteral">        }</span>
<a name="l17217"></a>17217 <span class="stringliteral">        // get default style</span>
<a name="l17218"></a>17218 <span class="stringliteral">        $prop = array_merge($this-&gt;getFormDefaultProp(), $prop);</span>
<a name="l17219"></a>17219 <span class="stringliteral">        $prop[&#39;</span>Combo<span class="stringliteral">&#39;] = true;</span>
<a name="l17220"></a>17220 <span class="stringliteral">        // get annotation data</span>
<a name="l17221"></a>17221 <span class="stringliteral">        $popt = $this-&gt;getAnnotOptFromJSProp($prop);</span>
<a name="l17222"></a>17222 <span class="stringliteral">        // set additional default options</span>
<a name="l17223"></a>17223 <span class="stringliteral">        $this-&gt;annotation_fonts[$this-&gt;CurrentFont[&#39;</span>fontkey<span class="stringliteral">&#39;]] = $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;];</span>
<a name="l17224"></a>17224 <span class="stringliteral">        $fontstyle = sprintf(&#39;</span>/F%d %.2F Tf %s<span class="stringliteral">&#39;, $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;], $this-&gt;FontSizePt, $this-&gt;TextColor);</span>
<a name="l17225"></a>17225 <span class="stringliteral">        $popt[&#39;</span>da<span class="stringliteral">&#39;] = $fontstyle;</span>
<a name="l17226"></a>17226 <span class="stringliteral">        // build appearance stream</span>
<a name="l17227"></a>17227 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;] = array();</span>
<a name="l17228"></a>17228 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] = &#39;</span>/Tx BMC q <span class="stringliteral">&#39;.$fontstyle.&#39;</span> <span class="stringliteral">&#39;;</span>
<a name="l17229"></a>17229 <span class="stringliteral">        $text = &#39;</span><span class="stringliteral">&#39;;</span>
<a name="l17230"></a>17230 <span class="stringliteral">        foreach($values as $item) {</span>
<a name="l17231"></a>17231 <span class="stringliteral">            $text .= $item[1].&quot;\n&quot;;</span>
<a name="l17232"></a>17232 <span class="stringliteral">        }</span>
<a name="l17233"></a>17233 <span class="stringliteral">        $tmpid = $this-&gt;startTemplate($w, $h, false);</span>
<a name="l17234"></a>17234 <span class="stringliteral">        $this-&gt;MultiCell($w, $h, $text, 0, &#39;</span><span class="stringliteral">&#39;, false, 0, 0, 0, true, 0, false, true, 0, &#39;</span>T<span class="stringliteral">&#39;, false);</span>
<a name="l17235"></a>17235 <span class="stringliteral">        $this-&gt;endTemplate();</span>
<a name="l17236"></a>17236 <span class="stringliteral">        --$this-&gt;n;</span>
<a name="l17237"></a>17237 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= $this-&gt;xobjects[$tmpid][&#39;</span>outdata<span class="stringliteral">&#39;];</span>
<a name="l17238"></a>17238 <span class="stringliteral">        unset($this-&gt;xobjects[$tmpid]);</span>
<a name="l17239"></a>17239 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= &#39;</span>Q EMC<span class="stringliteral">&#39;;</span>
<a name="l17240"></a>17240 <span class="stringliteral">        // merge options</span>
<a name="l17241"></a>17241 <span class="stringliteral">        $opt = array_merge($popt, $opt);</span>
<a name="l17242"></a>17242 <span class="stringliteral">        // set remaining annotation data</span>
<a name="l17243"></a>17243 <span class="stringliteral">        $opt[&#39;</span>Subtype<span class="stringliteral">&#39;] = &#39;</span>Widget<span class="stringliteral">&#39;;</span>
<a name="l17244"></a>17244 <span class="stringliteral">        $opt[&#39;</span>ft<span class="stringliteral">&#39;] = &#39;</span>Ch<span class="stringliteral">&#39;;</span>
<a name="l17245"></a>17245 <span class="stringliteral">        $opt[&#39;</span>t<span class="stringliteral">&#39;] = $name;</span>
<a name="l17246"></a>17246 <span class="stringliteral">        $opt[&#39;</span>opt<span class="stringliteral">&#39;] = $values;</span>
<a name="l17247"></a>17247 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ca<span class="stringliteral">&#39;]);</span>
<a name="l17248"></a>17248 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>rc<span class="stringliteral">&#39;]);</span>
<a name="l17249"></a>17249 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ac<span class="stringliteral">&#39;]);</span>
<a name="l17250"></a>17250 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>i<span class="stringliteral">&#39;]);</span>
<a name="l17251"></a>17251 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ri<span class="stringliteral">&#39;]);</span>
<a name="l17252"></a>17252 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ix<span class="stringliteral">&#39;]);</span>
<a name="l17253"></a>17253 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span><span class="keywordflow">if</span><span class="stringliteral">&#39;]);</span>
<a name="l17254"></a>17254 <span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>tp<span class="stringliteral">&#39;]);</span>
<a name="l17255"></a>17255 <span class="stringliteral">        $this-&gt;Annotation($x, $y, $w, $h, $name, $opt, 0);</span>
<a name="l17256"></a>17256 <span class="stringliteral">        if ($this-&gt;rtl) {</span>
<a name="l17257"></a>17257 <span class="stringliteral">            $this-&gt;x -= $w;</span>
<a name="l17258"></a>17258 <span class="stringliteral">        } else {</span>
<a name="l17259"></a>17259 <span class="stringliteral">            $this-&gt;x += $w;</span>
<a name="l17260"></a>17260 <span class="stringliteral">        }</span>
<a name="l17261"></a>17261 <span class="stringliteral">    }</span>
<a name="l17262"></a>17262 <span class="stringliteral"></span><span class="comment"></span>
<a name="l17263"></a>17263 <span class="comment">    /**</span>
<a name="l17264"></a>17264 <span class="comment">     * Creates a CheckBox field</span>
<a name="l17265"></a>17265 <span class="comment">     * @param $name (string) field name</span>
<a name="l17266"></a>17266 <span class="comment">     * @param $w (int) width</span>
<a name="l17267"></a>17267 <span class="comment">     * @param $checked (boolean) define the initial state.</span>
<a name="l17268"></a>17268 <span class="comment">     * @param $prop (array) javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l17269"></a>17269 <span class="comment">     * @param $opt (array) annotation parameters. Possible values are described on official PDF32000_2008 reference.</span>
<a name="l17270"></a>17270 <span class="comment">     * @param $onvalue (string) value to be returned if selected.</span>
<a name="l17271"></a>17271 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner of the rectangle</span>
<a name="l17272"></a>17272 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner of the rectangle</span>
<a name="l17273"></a>17273 <span class="comment">     * @param $js (boolean) if true put the field using JavaScript (requires Acrobat Writer to be rendered).</span>
<a name="l17274"></a>17274 <span class="comment">     * @public</span>
<a name="l17275"></a>17275 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17276"></a>17276 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l17277"></a>17277 <span class="comment">     */</span>
<a name="l17278"></a><a class="code" href="classTCPDF.html#a9237608d2579943f4bb2428617bfb73c">17278</a>     public function CheckBox($name, $w, $checked=false, $prop=array(), $opt=array(), $onvalue=&#39;Yes<span class="stringliteral">&#39;, $x=&#39;</span><span class="stringliteral">&#39;, $y=&#39;</span><span class="stringliteral">&#39;, $js=false) {</span>
<a name="l17279"></a>17279 <span class="stringliteral">        if ($x === &#39;</span><span class="stringliteral">&#39;) {</span>
<a name="l17280"></a>17280 <span class="stringliteral">            $x = $this-&gt;x;</span>
<a name="l17281"></a>17281 <span class="stringliteral">        }</span>
<a name="l17282"></a>17282 <span class="stringliteral">        if ($y === &#39;</span><span class="stringliteral">&#39;) {</span>
<a name="l17283"></a>17283 <span class="stringliteral">            $y = $this-&gt;y;</span>
<a name="l17284"></a>17284 <span class="stringliteral">        }</span>
<a name="l17285"></a>17285 <span class="stringliteral">        // check page for no-write regions and adapt page margins if necessary</span>
<a name="l17286"></a>17286 <span class="stringliteral">        list($x, $y) = $this-&gt;checkPageRegions($w, $x, $y);</span>
<a name="l17287"></a>17287 <span class="stringliteral">        if ($js) {</span>
<a name="l17288"></a>17288 <span class="stringliteral">            $this-&gt;_addfield(&#39;</span>checkbox<span class="stringliteral">&#39;, $name, $x, $y, $w, $w, $prop);</span>
<a name="l17289"></a>17289 <span class="stringliteral">            return;</span>
<a name="l17290"></a>17290 <span class="stringliteral">        }</span>
<a name="l17291"></a>17291 <span class="stringliteral">        if (!isset($prop[&#39;</span>value<span class="stringliteral">&#39;])) {</span>
<a name="l17292"></a>17292 <span class="stringliteral">            $prop[&#39;</span>value<span class="stringliteral">&#39;] = array(&#39;</span>Yes<span class="stringliteral">&#39;);</span>
<a name="l17293"></a>17293 <span class="stringliteral">        }</span>
<a name="l17294"></a>17294 <span class="stringliteral">        // get default style</span>
<a name="l17295"></a>17295 <span class="stringliteral">        $prop = array_merge($this-&gt;getFormDefaultProp(), $prop);</span>
<a name="l17296"></a>17296 <span class="stringliteral">        $prop[&#39;</span>borderStyle<span class="stringliteral">&#39;] = &#39;</span><a class="code" href="pmahomme_2css_2theme__right_8css_8php.html#ad269b6cab04504eb163d00cd6f23d115">inset</a><span class="stringliteral">&#39;;</span>
<a name="l17297"></a>17297 <span class="stringliteral">        // get annotation data</span>
<a name="l17298"></a>17298 <span class="stringliteral">        $popt = $this-&gt;getAnnotOptFromJSProp($prop);</span>
<a name="l17299"></a>17299 <span class="stringliteral">        // set additional default options</span>
<a name="l17300"></a>17300 <span class="stringliteral">        $font = &#39;</span>zapfdingbats<span class="stringliteral">&#39;;</span>
<a name="l17301"></a>17301 <span class="stringliteral">        $this-&gt;AddFont($font);</span>
<a name="l17302"></a>17302 <span class="stringliteral">        $tmpfont = $this-&gt;getFontBuffer($font);</span>
<a name="l17303"></a>17303 <span class="stringliteral">        $this-&gt;annotation_fonts[$tmpfont[&#39;</span>fontkey<span class="stringliteral">&#39;]] = $tmpfont[&#39;</span>i<span class="stringliteral">&#39;];</span>
<a name="l17304"></a>17304 <span class="stringliteral">        $fontstyle = sprintf(&#39;</span>/F%d %.2F Tf %s<span class="stringliteral">&#39;, $tmpfont[&#39;</span>i<span class="stringliteral">&#39;], $this-&gt;FontSizePt, $this-&gt;TextColor);</span>
<a name="l17305"></a>17305 <span class="stringliteral">        $popt[&#39;</span>da<span class="stringliteral">&#39;] = $fontstyle;</span>
<a name="l17306"></a>17306 <span class="stringliteral">        // build appearance stream</span>
<a name="l17307"></a>17307 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;] = array();</span>
<a name="l17308"></a>17308 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] = array();</span>
<a name="l17309"></a>17309 <span class="stringliteral">        $fy = ((($tmpfont[&#39;</span>desc<span class="stringliteral">&#39;][&#39;</span>Ascent<span class="stringliteral">&#39;] + $tmpfont[&#39;</span>desc<span class="stringliteral">&#39;][&#39;</span>Descent<span class="stringliteral">&#39;]) * $this-&gt;FontSizePt) / (1000 * $this-&gt;k));</span>
<a name="l17310"></a>17310 <span class="stringliteral">        $fy = (($w - ((($tmpfont[&#39;</span>desc<span class="stringliteral">&#39;][&#39;</span>Ascent<span class="stringliteral">&#39;] - $tmpfont[&#39;</span>desc<span class="stringliteral">&#39;][&#39;</span>Descent<span class="stringliteral">&#39;]) * $this-&gt;FontSizePt / 1000) / $this-&gt;k)) * $this-&gt;k);</span>
<a name="l17311"></a>17311 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;][&#39;</span>Yes<span class="stringliteral">&#39;] = sprintf(&#39;</span>q %s BT /F%d %.2F Tf %.2F %.2F Td (<span class="stringliteral">&#39;.chr(110).&#39;</span>) Tj ET Q<span class="stringliteral">&#39;, $this-&gt;TextColor, $tmpfont[&#39;</span>i<span class="stringliteral">&#39;], $this-&gt;FontSizePt, 0, $fy);</span>
<a name="l17312"></a>17312 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;][&#39;</span>Off<span class="stringliteral">&#39;] = sprintf(&#39;</span>q %s BT /F%d %.2F Tf %.2F %.2F Td (<span class="stringliteral">&#39;.chr(111).&#39;</span>) Tj ET Q<span class="stringliteral">&#39;, $this-&gt;TextColor, $tmpfont[&#39;</span>i<span class="stringliteral">&#39;], $this-&gt;FontSizePt, 0, $fy);</span>
<a name="l17313"></a>17313 <span class="stringliteral">        // merge options</span>
<a name="l17314"></a>17314 <span class="stringliteral">        $opt = array_merge($popt, $opt);</span>
<a name="l17315"></a>17315 <span class="stringliteral">        // set remaining annotation data</span>
<a name="l17316"></a>17316 <span class="stringliteral">        $opt[&#39;</span>Subtype<span class="stringliteral">&#39;] = &#39;</span>Widget<span class="stringliteral">&#39;;</span>
<a name="l17317"></a>17317 <span class="stringliteral">        $opt[&#39;</span>ft<span class="stringliteral">&#39;] = &#39;</span>Btn<span class="stringliteral">&#39;;</span>
<a name="l17318"></a>17318 <span class="stringliteral">        $opt[&#39;</span>t<span class="stringliteral">&#39;] = $name;</span>
<a name="l17319"></a>17319 <span class="stringliteral">        if ($this-&gt;empty_string($onvalue)) {</span>
<a name="l17320"></a>17320 <span class="stringliteral">            $onvalue = &#39;</span>Yes<span class="stringliteral">&#39;;</span>
<a name="l17321"></a>17321 <span class="stringliteral">        }</span>
<a name="l17322"></a>17322 <span class="stringliteral">        $opt[&#39;</span>opt<span class="stringliteral">&#39;] = array($onvalue);</span>
<a name="l17323"></a>17323 <span class="stringliteral">        if ($checked) {</span>
<a name="l17324"></a>17324 <span class="stringliteral">            $opt[&#39;</span>v<span class="stringliteral">&#39;] = array(&#39;</span>/Yes<span class="stringliteral">&#39;);</span>
<a name="l17325"></a>17325 <span class="stringliteral">            $opt[&#39;</span>as<span class="stringliteral">&#39;] = &#39;</span>Yes<span class="stringliteral">&#39;;</span>
<a name="l17326"></a>17326 <span class="stringliteral">        } else {</span>
<a name="l17327"></a>17327 <span class="stringliteral">            $opt[&#39;</span>v<span class="stringliteral">&#39;] = array(&#39;</span>/Off<span class="stringliteral">&#39;);</span>
<a name="l17328"></a>17328 <span class="stringliteral">            $opt[&#39;</span>as<span class="stringliteral">&#39;] = &#39;</span>Off<span class="stringliteral">&#39;;</span>
<a name="l17329"></a>17329 <span class="stringliteral">        }</span>
<a name="l17330"></a>17330 <span class="stringliteral">        $this-&gt;Annotation($x, $y, $w, $w, $name, $opt, 0);</span>
<a name="l17331"></a>17331 <span class="stringliteral">        if ($this-&gt;rtl) {</span>
<a name="l17332"></a>17332 <span class="stringliteral">            $this-&gt;x -= $w;</span>
<a name="l17333"></a>17333 <span class="stringliteral">        } else {</span>
<a name="l17334"></a>17334 <span class="stringliteral">            $this-&gt;x += $w;</span>
<a name="l17335"></a>17335 <span class="stringliteral">        }</span>
<a name="l17336"></a>17336 <span class="stringliteral">    }</span>
<a name="l17337"></a>17337 <span class="stringliteral"></span><span class="comment"></span>
<a name="l17338"></a>17338 <span class="comment">    /**</span>
<a name="l17339"></a>17339 <span class="comment">     * Creates a button field</span>
<a name="l17340"></a>17340 <span class="comment">     * @param $name (string) field name</span>
<a name="l17341"></a>17341 <span class="comment">     * @param $w (int) width</span>
<a name="l17342"></a>17342 <span class="comment">     * @param $h (int) height</span>
<a name="l17343"></a>17343 <span class="comment">     * @param $caption (string) caption.</span>
<a name="l17344"></a>17344 <span class="comment">     * @param $action (mixed) action triggered by pressing the button. Use a string to specify a javascript action. Use an array to specify a form action options as on section 12.7.5 of PDF32000_2008.</span>
<a name="l17345"></a>17345 <span class="comment">     * @param $prop (array) javascript field properties. Possible values are described on official Javascript for Acrobat API reference.</span>
<a name="l17346"></a>17346 <span class="comment">     * @param $opt (array) annotation parameters. Possible values are described on official PDF32000_2008 reference.</span>
<a name="l17347"></a>17347 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner of the rectangle</span>
<a name="l17348"></a>17348 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner of the rectangle</span>
<a name="l17349"></a>17349 <span class="comment">     * @param $js (boolean) if true put the field using JavaScript (requires Acrobat Writer to be rendered).</span>
<a name="l17350"></a>17350 <span class="comment">     * @public</span>
<a name="l17351"></a>17351 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17352"></a>17352 <span class="comment">     * @since 4.8.000 (2009-09-07)</span>
<a name="l17353"></a>17353 <span class="comment">     */</span>
<a name="l17354"></a><a class="code" href="classTCPDF.html#a93f18d686b7db10133a76317bfbb0d59">17354</a>     public function Button($name, $w, $h, $caption, $action, $prop=array(), $opt=array(), $x=&#39;<span class="stringliteral">&#39;, $y=&#39;</span><span class="stringliteral">&#39;, $js=false) {</span>
<a name="l17355"></a>17355 <span class="stringliteral">        if ($x === &#39;</span><span class="stringliteral">&#39;) {</span>
<a name="l17356"></a>17356 <span class="stringliteral">            $x = $this-&gt;x;</span>
<a name="l17357"></a>17357 <span class="stringliteral">        }</span>
<a name="l17358"></a>17358 <span class="stringliteral">        if ($y === &#39;</span><span class="stringliteral">&#39;) {</span>
<a name="l17359"></a>17359 <span class="stringliteral">            $y = $this-&gt;y;</span>
<a name="l17360"></a>17360 <span class="stringliteral">        }</span>
<a name="l17361"></a>17361 <span class="stringliteral">        // check page for no-write regions and adapt page margins if necessary</span>
<a name="l17362"></a>17362 <span class="stringliteral">        list($x, $y) = $this-&gt;checkPageRegions($h, $x, $y);</span>
<a name="l17363"></a>17363 <span class="stringliteral">        if ($js) {</span>
<a name="l17364"></a>17364 <span class="stringliteral">            $this-&gt;_addfield(&#39;</span>button<span class="stringliteral">&#39;, $name, $this-&gt;x, $this-&gt;y, $w, $h, $prop);</span>
<a name="l17365"></a>17365 <span class="stringliteral">            $this-&gt;javascript .= &#39;</span>f<span class="stringliteral">&#39;.$name.&quot;.buttonSetCaption(&#39;</span><span class="stringliteral">&quot;.addslashes($caption).&quot;</span><span class="stringliteral">&#39;);\n&quot;;</span>
<a name="l17366"></a>17366 <span class="stringliteral">            $this-&gt;javascript .= &#39;</span>f<span class="stringliteral">&#39;.$name.&quot;.setAction(&#39;</span>MouseUp<span class="charliteral">&#39;,&#39;</span><span class="stringliteral">&quot;.addslashes($action).&quot;</span><span class="stringliteral">&#39;);\n&quot;;</span>
<a name="l17367"></a>17367 <span class="stringliteral">            $this-&gt;javascript .= &#39;</span>f<span class="stringliteral">&#39;.$name.&quot;.highlight=&#39;</span>push<span class="stringliteral">&#39;;\n&quot;;</span>
<a name="l17368"></a>17368 <span class="stringliteral">            $this-&gt;javascript .= &#39;</span>f<span class="stringliteral">&#39;.$name.&quot;.print=false;\n&quot;;</span>
<a name="l17369"></a>17369 <span class="stringliteral">            return;</span>
<a name="l17370"></a>17370 <span class="stringliteral">        }</span>
<a name="l17371"></a>17371 <span class="stringliteral">        // get default style</span>
<a name="l17372"></a>17372 <span class="stringliteral">        $prop = array_merge($this-&gt;getFormDefaultProp(), $prop);</span>
<a name="l17373"></a>17373 <span class="stringliteral">        $prop[&#39;</span>Pushbutton<span class="stringliteral">&#39;] = &#39;</span><span class="keyword">true</span><span class="stringliteral">&#39;;</span>
<a name="l17374"></a>17374 <span class="stringliteral">        $prop[&#39;</span>highlight<span class="stringliteral">&#39;] = &#39;</span>push<span class="stringliteral">&#39;;</span>
<a name="l17375"></a>17375 <span class="stringliteral">        $prop[&#39;</span>display<span class="stringliteral">&#39;] = &#39;</span>display.noPrint<span class="stringliteral">&#39;;</span>
<a name="l17376"></a>17376 <span class="stringliteral">        // get annotation data</span>
<a name="l17377"></a>17377 <span class="stringliteral">        $popt = $this-&gt;getAnnotOptFromJSProp($prop);</span>
<a name="l17378"></a>17378 <span class="stringliteral">        $this-&gt;annotation_fonts[$this-&gt;CurrentFont[&#39;</span>fontkey<span class="stringliteral">&#39;]] = $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;];</span>
<a name="l17379"></a>17379 <span class="stringliteral">        $fontstyle = sprintf(&#39;</span>/F%d %.2F Tf %s<span class="stringliteral">&#39;, $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;], $this-&gt;FontSizePt, $this-&gt;TextColor);</span>
<a name="l17380"></a>17380 <span class="stringliteral">        $popt[&#39;</span>da<span class="stringliteral">&#39;] = $fontstyle;</span>
<a name="l17381"></a>17381 <span class="stringliteral">        // build appearance stream</span>
<a name="l17382"></a>17382 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;] = array();</span>
<a name="l17383"></a>17383 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] = &#39;</span>/Tx BMC q <span class="stringliteral">&#39;.$fontstyle.&#39;</span> <span class="stringliteral">&#39;;</span>
<a name="l17384"></a>17384 <span class="stringliteral">        $tmpid = $this-&gt;startTemplate($w, $h, false);</span>
<a name="l17385"></a>17385 <span class="stringliteral">        $bw = (2 / $this-&gt;k); // border width</span>
<a name="l17386"></a>17386 <span class="stringliteral">        $border = array(</span>
<a name="l17387"></a>17387 <span class="stringliteral">            &#39;</span>L<span class="stringliteral">&#39; =&gt; array(&#39;</span><a class="code" href="pmahomme_2css_2theme__left_8css_8php.html#a8eba97439dc06bd5160020dd878c1070">width</a><span class="stringliteral">&#39; =&gt; $bw, &#39;</span>cap<span class="stringliteral">&#39; =&gt; &#39;</span>square<span class="stringliteral">&#39;, &#39;</span>join<span class="stringliteral">&#39; =&gt; &#39;</span>miter<span class="stringliteral">&#39;, &#39;</span>dash<span class="stringliteral">&#39; =&gt; 0, &#39;</span><a class="code" href="original_2css_2theme__left_8css_8php.html#ac04e2a463631b69c8f70784275a056d6">color</a><span class="stringliteral">&#39; =&gt; array(231)),</span>
<a name="l17388"></a>17388 <span class="stringliteral">            &#39;</span>R<span class="stringliteral">&#39; =&gt; array(&#39;</span><a class="code" href="pmahomme_2css_2theme__left_8css_8php.html#a8eba97439dc06bd5160020dd878c1070">width</a><span class="stringliteral">&#39; =&gt; $bw, &#39;</span>cap<span class="stringliteral">&#39; =&gt; &#39;</span>square<span class="stringliteral">&#39;, &#39;</span>join<span class="stringliteral">&#39; =&gt; &#39;</span>miter<span class="stringliteral">&#39;, &#39;</span>dash<span class="stringliteral">&#39; =&gt; 0, &#39;</span><a class="code" href="original_2css_2theme__left_8css_8php.html#ac04e2a463631b69c8f70784275a056d6">color</a><span class="stringliteral">&#39; =&gt; array(51)),</span>
<a name="l17389"></a>17389 <span class="stringliteral">            &#39;</span>T<span class="stringliteral">&#39; =&gt; array(&#39;</span><a class="code" href="pmahomme_2css_2theme__left_8css_8php.html#a8eba97439dc06bd5160020dd878c1070">width</a><span class="stringliteral">&#39; =&gt; $bw, &#39;</span>cap<span class="stringliteral">&#39; =&gt; &#39;</span>square<span class="stringliteral">&#39;, &#39;</span>join<span class="stringliteral">&#39; =&gt; &#39;</span>miter<span class="stringliteral">&#39;, &#39;</span>dash<span class="stringliteral">&#39; =&gt; 0, &#39;</span><a class="code" href="original_2css_2theme__left_8css_8php.html#ac04e2a463631b69c8f70784275a056d6">color</a><span class="stringliteral">&#39; =&gt; array(231)),</span>
<a name="l17390"></a>17390 <span class="stringliteral">            &#39;</span>B<span class="stringliteral">&#39; =&gt; array(&#39;</span><a class="code" href="pmahomme_2css_2theme__left_8css_8php.html#a8eba97439dc06bd5160020dd878c1070">width</a><span class="stringliteral">&#39; =&gt; $bw, &#39;</span>cap<span class="stringliteral">&#39; =&gt; &#39;</span>square<span class="stringliteral">&#39;, &#39;</span>join<span class="stringliteral">&#39; =&gt; &#39;</span>miter<span class="stringliteral">&#39;, &#39;</span>dash<span class="stringliteral">&#39; =&gt; 0, &#39;</span><a class="code" href="original_2css_2theme__left_8css_8php.html#ac04e2a463631b69c8f70784275a056d6">color</a><span class="stringliteral">&#39; =&gt; array(51)));</span>
<a name="l17391"></a>17391 <span class="stringliteral">        $this-&gt;SetFillColor(204);</span>
<a name="l17392"></a>17392 <span class="stringliteral">        $this-&gt;Cell($w, $h, $caption, $border, 0, &#39;</span>C<span class="stringliteral">&#39;, true, &#39;</span><span class="stringliteral">&#39;, 1, false, &#39;</span>T<span class="stringliteral">&#39;, &#39;</span><a class="code" href="import_8lib_8php.html#aad05f78187c942f9dd521605fa81f1ba">M</a><span class="stringliteral">&#39;);</span>
<a name="l17393"></a>17393 <span class="stringliteral">        $this-&gt;endTemplate();</span>
<a name="l17394"></a>17394 <span class="stringliteral">        --$this-&gt;n;</span>
<a name="l17395"></a>17395 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= $this-&gt;xobjects[$tmpid][&#39;</span>outdata<span class="stringliteral">&#39;];</span>
<a name="l17396"></a>17396 <span class="stringliteral">        unset($this-&gt;xobjects[$tmpid]);</span>
<a name="l17397"></a>17397 <span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= &#39;</span>Q EMC<span class="stringliteral">&#39;;</span>
<a name="l17398"></a>17398 <span class="stringliteral">        // set additional default options</span>
<a name="l17399"></a>17399 <span class="stringliteral">        if (!isset($popt[&#39;</span>mk<span class="stringliteral">&#39;])) {</span>
<a name="l17400"></a>17400 <span class="stringliteral">            $popt[&#39;</span>mk<span class="stringliteral">&#39;] = array();</span>
<a name="l17401"></a>17401 <span class="stringliteral">        }</span>
<a name="l17402"></a>17402 <span class="stringliteral">        $ann_obj_id = ($this-&gt;n + 1);</span>
<a name="l17403"></a>17403 <span class="stringliteral">        if (!empty($action) AND !is_array($action)) {</span>
<a name="l17404"></a>17404 <span class="stringliteral">            $ann_obj_id = ($this-&gt;n + 2);</span>
<a name="l17405"></a>17405 <span class="stringliteral">        }</span>
<a name="l17406"></a>17406 <span class="stringliteral">        $popt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ca<span class="stringliteral">&#39;] = $this-&gt;_textstring($caption, $ann_obj_id);</span>
<a name="l17407"></a>17407 <span class="stringliteral">        $popt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>rc<span class="stringliteral">&#39;] = $this-&gt;_textstring($caption, $ann_obj_id);</span>
<a name="l17408"></a>17408 <span class="stringliteral">        $popt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ac<span class="stringliteral">&#39;] = $this-&gt;_textstring($caption, $ann_obj_id);</span>
<a name="l17409"></a>17409 <span class="stringliteral">        // merge options</span>
<a name="l17410"></a>17410 <span class="stringliteral">        $opt = array_merge($popt, $opt);</span>
<a name="l17411"></a>17411 <span class="stringliteral">        // set remaining annotation data</span>
<a name="l17412"></a>17412 <span class="stringliteral">        $opt[&#39;</span>Subtype<span class="stringliteral">&#39;] = &#39;</span>Widget<span class="stringliteral">&#39;;</span>
<a name="l17413"></a>17413 <span class="stringliteral">        $opt[&#39;</span>ft<span class="stringliteral">&#39;] = &#39;</span>Btn<span class="stringliteral">&#39;;</span>
<a name="l17414"></a>17414 <span class="stringliteral">        $opt[&#39;</span>t<span class="stringliteral">&#39;] = $caption;</span>
<a name="l17415"></a>17415 <span class="stringliteral">        $opt[&#39;</span>v<span class="stringliteral">&#39;] = $name;</span>
<a name="l17416"></a>17416 <span class="stringliteral">        if (!empty($action)) {</span>
<a name="l17417"></a>17417 <span class="stringliteral">            if (is_array($action)) {</span>
<a name="l17418"></a>17418 <span class="stringliteral">                // form action options as on section 12.7.5 of PDF32000_2008.</span>
<a name="l17419"></a>17419 <span class="stringliteral">                $opt[&#39;</span>aa<span class="stringliteral">&#39;] = &#39;</span>/<a class="code" href="import_8lib_8php.html#a350bfcb1e3cfb28ddff48ce525d4f139">D</a> &lt;&lt;<span class="stringliteral">&#39;;</span>
<a name="l17420"></a>17420 <span class="stringliteral">                $bmode = array(&#39;</span>SubmitForm<span class="stringliteral">&#39;, &#39;</span>ResetForm<span class="stringliteral">&#39;, &#39;</span>ImportData<span class="stringliteral">&#39;);</span>
<a name="l17421"></a>17421 <span class="stringliteral">                foreach ($action AS $key =&gt; $val) {</span>
<a name="l17422"></a>17422 <span class="stringliteral">                    if (($key == &#39;</span>S<span class="stringliteral">&#39;) AND in_array($val, $bmode)) {</span>
<a name="l17423"></a>17423 <span class="stringliteral">                        $opt[&#39;</span>aa<span class="stringliteral">&#39;] .= &#39;</span> /S /<span class="stringliteral">&#39;.$val;</span>
<a name="l17424"></a>17424 <span class="stringliteral">                    } elseif (($key == &#39;</span>F<span class="stringliteral">&#39;) AND (!empty($val))) {</span>
<a name="l17425"></a>17425 <span class="stringliteral">                        $opt[&#39;</span>aa<span class="stringliteral">&#39;] .= &#39;</span> /F <span class="stringliteral">&#39;.$this-&gt;_datastring($val, $ann_obj_id);</span>
<a name="l17426"></a>17426 <span class="stringliteral">                    } elseif (($key == &#39;</span>Fields<span class="stringliteral">&#39;) AND is_array($val) AND !empty($val)) {</span>
<a name="l17427"></a>17427 <span class="stringliteral">                        $opt[&#39;</span>aa<span class="stringliteral">&#39;] .= &#39;</span> /Fields [<span class="stringliteral">&#39;;</span>
<a name="l17428"></a>17428 <span class="stringliteral">                        foreach ($val AS $field) {</span>
<a name="l17429"></a>17429 <span class="stringliteral">                            $opt[&#39;</span>aa<span class="stringliteral">&#39;] .= &#39;</span> <span class="stringliteral">&#39;.$this-&gt;_textstring($field, $ann_obj_id);</span>
<a name="l17430"></a>17430 <span class="stringliteral">                        }</span>
<a name="l17431"></a>17431 <span class="stringliteral">                        $opt[&#39;</span>aa<span class="stringliteral">&#39;] .= &#39;</span>]<span class="stringliteral">&#39;;</span>
<a name="l17432"></a>17432 <span class="stringliteral">                    } elseif (($key == &#39;</span>Flags<span class="stringliteral">&#39;)) {</span>
<a name="l17433"></a>17433 <span class="stringliteral">                        $ff = 0;</span>
<a name="l17434"></a>17434 <span class="stringliteral">                        if (is_array($val)) {</span>
<a name="l17435"></a>17435 <span class="stringliteral">                            foreach ($val AS $flag) {</span>
<a name="l17436"></a>17436 <span class="stringliteral">                                switch ($flag) {</span>
<a name="l17437"></a>17437 <span class="stringliteral">                                    case &#39;</span>Include/Exclude<span class="stringliteral">&#39;: {</span>
<a name="l17438"></a>17438 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 0;</span>
<a name="l17439"></a>17439 <span class="stringliteral">                                        break;</span>
<a name="l17440"></a>17440 <span class="stringliteral">                                    }</span>
<a name="l17441"></a>17441 <span class="stringliteral">                                    case &#39;</span>IncludeNoValueFields<span class="stringliteral">&#39;: {</span>
<a name="l17442"></a>17442 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 1;</span>
<a name="l17443"></a>17443 <span class="stringliteral">                                        break;</span>
<a name="l17444"></a>17444 <span class="stringliteral">                                    }</span>
<a name="l17445"></a>17445 <span class="stringliteral">                                    case &#39;</span>ExportFormat<span class="stringliteral">&#39;: {</span>
<a name="l17446"></a>17446 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 2;</span>
<a name="l17447"></a>17447 <span class="stringliteral">                                        break;</span>
<a name="l17448"></a>17448 <span class="stringliteral">                                    }</span>
<a name="l17449"></a>17449 <span class="stringliteral">                                    case &#39;</span>GetMethod<span class="stringliteral">&#39;: {</span>
<a name="l17450"></a>17450 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 3;</span>
<a name="l17451"></a>17451 <span class="stringliteral">                                        break;</span>
<a name="l17452"></a>17452 <span class="stringliteral">                                    }</span>
<a name="l17453"></a>17453 <span class="stringliteral">                                    case &#39;</span>SubmitCoordinates<span class="stringliteral">&#39;: {</span>
<a name="l17454"></a>17454 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 4;</span>
<a name="l17455"></a>17455 <span class="stringliteral">                                        break;</span>
<a name="l17456"></a>17456 <span class="stringliteral">                                    }</span>
<a name="l17457"></a>17457 <span class="stringliteral">                                    case &#39;</span>XFDF<span class="stringliteral">&#39;: {</span>
<a name="l17458"></a>17458 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 5;</span>
<a name="l17459"></a>17459 <span class="stringliteral">                                        break;</span>
<a name="l17460"></a>17460 <span class="stringliteral">                                    }</span>
<a name="l17461"></a>17461 <span class="stringliteral">                                    case &#39;</span>IncludeAppendSaves<span class="stringliteral">&#39;: {</span>
<a name="l17462"></a>17462 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 6;</span>
<a name="l17463"></a>17463 <span class="stringliteral">                                        break;</span>
<a name="l17464"></a>17464 <span class="stringliteral">                                    }</span>
<a name="l17465"></a>17465 <span class="stringliteral">                                    case &#39;</span>IncludeAnnotations<span class="stringliteral">&#39;: {</span>
<a name="l17466"></a>17466 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 7;</span>
<a name="l17467"></a>17467 <span class="stringliteral">                                        break;</span>
<a name="l17468"></a>17468 <span class="stringliteral">                                    }</span>
<a name="l17469"></a>17469 <span class="stringliteral">                                    case &#39;</span>SubmitPDF<span class="stringliteral">&#39;: {</span>
<a name="l17470"></a>17470 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 8;</span>
<a name="l17471"></a>17471 <span class="stringliteral">                                        break;</span>
<a name="l17472"></a>17472 <span class="stringliteral">                                    }</span>
<a name="l17473"></a>17473 <span class="stringliteral">                                    case &#39;</span>CanonicalFormat<span class="stringliteral">&#39;: {</span>
<a name="l17474"></a>17474 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 9;</span>
<a name="l17475"></a>17475 <span class="stringliteral">                                        break;</span>
<a name="l17476"></a>17476 <span class="stringliteral">                                    }</span>
<a name="l17477"></a>17477 <span class="stringliteral">                                    case &#39;</span>ExclNonUserAnnots<span class="stringliteral">&#39;: {</span>
<a name="l17478"></a>17478 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 10;</span>
<a name="l17479"></a>17479 <span class="stringliteral">                                        break;</span>
<a name="l17480"></a>17480 <span class="stringliteral">                                    }</span>
<a name="l17481"></a>17481 <span class="stringliteral">                                    case &#39;</span>ExclFKey<span class="stringliteral">&#39;: {</span>
<a name="l17482"></a>17482 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 11;</span>
<a name="l17483"></a>17483 <span class="stringliteral">                                        break;</span>
<a name="l17484"></a>17484 <span class="stringliteral">                                    }</span>
<a name="l17485"></a>17485 <span class="stringliteral">                                    case &#39;</span>EmbedForm<span class="stringliteral">&#39;: {</span>
<a name="l17486"></a>17486 <span class="stringliteral">                                        $ff += 1 &lt;&lt; 13;</span>
<a name="l17487"></a>17487 <span class="stringliteral">                                        break;</span>
<a name="l17488"></a>17488 <span class="stringliteral">                                    }</span>
<a name="l17489"></a>17489 <span class="stringliteral">                                }</span>
<a name="l17490"></a>17490 <span class="stringliteral">                            }</span>
<a name="l17491"></a>17491 <span class="stringliteral">                        } else {</span>
<a name="l17492"></a>17492 <span class="stringliteral">                            $ff = intval($val);</span>
<a name="l17493"></a>17493 <span class="stringliteral">                        }</span>
<a name="l17494"></a>17494 <span class="stringliteral">                        $opt[&#39;</span>aa<span class="stringliteral">&#39;] .= &#39;</span> /Flags <span class="stringliteral">&#39;.$ff;</span>
<a name="l17495"></a>17495 <span class="stringliteral">                    }</span>
<a name="l17496"></a>17496 <span class="stringliteral">                }</span>
<a name="l17497"></a>17497 <span class="stringliteral">                $opt[&#39;</span>aa<span class="stringliteral">&#39;] .= &#39;</span> &gt;&gt;<span class="stringliteral">&#39;;</span>
<a name="l17498"></a>17498 <span class="stringliteral">            } else {</span>
<a name="l17499"></a>17499 <span class="stringliteral">                // Javascript action or raw action command</span>
<a name="l17500"></a>17500 <span class="stringliteral">                $js_obj_id = $this-&gt;addJavascriptObject($action);</span>
<a name="l17501"></a>17501 <span class="stringliteral">                $opt[&#39;</span>aa<span class="stringliteral">&#39;] = &#39;</span>/<a class="code" href="import_8lib_8php.html#a350bfcb1e3cfb28ddff48ce525d4f139">D</a> <span class="stringliteral">&#39;.$js_obj_id.&#39;</span> 0 R<span class="stringliteral">&#39;;</span>
<a name="l17502"></a>17502 <span class="stringliteral">            }</span>
<a name="l17503"></a>17503 <span class="stringliteral">        }</span>
<a name="l17504"></a>17504 <span class="stringliteral">        $this-&gt;Annotation($x, $y, $w, $h, $name, $opt, 0);</span>
<a name="l17505"></a>17505 <span class="stringliteral">        if ($this-&gt;rtl) {</span>
<a name="l17506"></a>17506 <span class="stringliteral">            $this-&gt;x -= $w;</span>
<a name="l17507"></a>17507 <span class="stringliteral">        } else {</span>
<a name="l17508"></a>17508 <span class="stringliteral">            $this-&gt;x += $w;</span>
<a name="l17509"></a>17509 <span class="stringliteral">        }</span>
<a name="l17510"></a>17510 <span class="stringliteral">    }</span>
<a name="l17511"></a>17511 <span class="stringliteral"></span>
<a name="l17512"></a>17512 <span class="stringliteral">    // --- END FORMS FIELDS ------------------------------------------------</span>
<a name="l17513"></a>17513 <span class="stringliteral"></span><span class="comment"></span>
<a name="l17514"></a>17514 <span class="comment">    /**</span>
<a name="l17515"></a>17515 <span class="comment">     * Add certification signature (DocMDP or UR3)</span>
<a name="l17516"></a>17516 <span class="comment">     * You can set only one signature type</span>
<a name="l17517"></a>17517 <span class="comment">     * @protected</span>
<a name="l17518"></a>17518 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17519"></a>17519 <span class="comment">     * @since 4.6.008 (2009-05-07)</span>
<a name="l17520"></a>17520 <span class="comment">     */</span>
<a name="l17521"></a><a class="code" href="classTCPDF.html#a0ade674cd5fe2d8901c056e689b6ab52">17521</a>     protected function _putsignature() {
<a name="l17522"></a>17522         if ((!$this-&gt;sign) OR (!isset($this-&gt;signature_data[&#39;cert_type<span class="stringliteral">&#39;]))) {</span>
<a name="l17523"></a>17523 <span class="stringliteral">            return;</span>
<a name="l17524"></a>17524 <span class="stringliteral">        }</span>
<a name="l17525"></a>17525 <span class="stringliteral">        $sigobjid = ($this-&gt;sig_obj_id + 1);</span>
<a name="l17526"></a>17526 <span class="stringliteral">        $out = $this-&gt;_getobj($sigobjid).&quot;\n&quot;;</span>
<a name="l17527"></a>17527 <span class="stringliteral">        $out .= &#39;</span>&lt;&lt; /Type /Sig<span class="stringliteral">&#39;;</span>
<a name="l17528"></a>17528 <span class="stringliteral">        $out .= &#39;</span> /Filter /Adobe.PPKLite<span class="stringliteral">&#39;;</span>
<a name="l17529"></a>17529 <span class="stringliteral">        $out .= &#39;</span> /SubFilter /adbe.pkcs7.detached<span class="stringliteral">&#39;;</span>
<a name="l17530"></a>17530 <span class="stringliteral">        $out .= &#39;</span> <span class="stringliteral">&#39;.$this-&gt;byterange_string;</span>
<a name="l17531"></a>17531 <span class="stringliteral">        $out .= &#39;</span> /Contents&lt;<span class="stringliteral">&#39;.str_repeat(&#39;</span>0<span class="stringliteral">&#39;, $this-&gt;signature_max_length).&#39;</span>&gt;<span class="stringliteral">&#39;;</span>
<a name="l17532"></a>17532 <span class="stringliteral">        $out .= &#39;</span> /Reference [<span class="stringliteral">&#39;; // array of signature reference dictionaries</span>
<a name="l17533"></a>17533 <span class="stringliteral">        $out .= &#39;</span> &lt;&lt; /Type /SigRef<span class="stringliteral">&#39;;</span>
<a name="l17534"></a>17534 <span class="stringliteral">        if ($this-&gt;signature_data[&#39;</span>cert_type<span class="stringliteral">&#39;] &gt; 0) {</span>
<a name="l17535"></a>17535 <span class="stringliteral">            $out .= &#39;</span> /TransformMethod /DocMDP<span class="stringliteral">&#39;;</span>
<a name="l17536"></a>17536 <span class="stringliteral">            $out .= &#39;</span> /TransformParams &lt;&lt;<span class="stringliteral">&#39;;</span>
<a name="l17537"></a>17537 <span class="stringliteral">            $out .= &#39;</span> /Type /TransformParams<span class="stringliteral">&#39;;</span>
<a name="l17538"></a>17538 <span class="stringliteral">            $out .= &#39;</span> /P <span class="stringliteral">&#39;.$this-&gt;signature_data[&#39;</span>cert_type<span class="stringliteral">&#39;];</span>
<a name="l17539"></a>17539 <span class="stringliteral">            $out .= &#39;</span> /V /1.2<span class="stringliteral">&#39;;</span>
<a name="l17540"></a>17540 <span class="stringliteral">        } else {</span>
<a name="l17541"></a>17541 <span class="stringliteral">            $out .= &#39;</span> /TransformMethod /UR3<span class="stringliteral">&#39;;</span>
<a name="l17542"></a>17542 <span class="stringliteral">            $out .= &#39;</span> /TransformParams &lt;&lt;<span class="stringliteral">&#39;;</span>
<a name="l17543"></a>17543 <span class="stringliteral">            $out .= &#39;</span> /Type /TransformParams<span class="stringliteral">&#39;;</span>
<a name="l17544"></a>17544 <span class="stringliteral">            $out .= &#39;</span> /V /2.2<span class="stringliteral">&#39;;</span>
<a name="l17545"></a>17545 <span class="stringliteral">            if (!$this-&gt;empty_string($this-&gt;ur[&#39;</span>document<span class="stringliteral">&#39;])) {</span>
<a name="l17546"></a>17546 <span class="stringliteral">                $out .= &#39;</span> /Document[<span class="stringliteral">&#39;.$this-&gt;ur[&#39;</span>document<span class="stringliteral">&#39;].&#39;</span>]<span class="stringliteral">&#39;;</span>
<a name="l17547"></a>17547 <span class="stringliteral">            }</span>
<a name="l17548"></a>17548 <span class="stringliteral">            if (!$this-&gt;empty_string($this-&gt;ur[&#39;</span>form<span class="stringliteral">&#39;])) {</span>
<a name="l17549"></a>17549 <span class="stringliteral">                $out .= &#39;</span> /<a class="code" href="classForm.html">Form</a>[<span class="stringliteral">&#39;.$this-&gt;ur[&#39;</span>form<span class="stringliteral">&#39;].&#39;</span>]<span class="stringliteral">&#39;;</span>
<a name="l17550"></a>17550 <span class="stringliteral">            }</span>
<a name="l17551"></a>17551 <span class="stringliteral">            if (!$this-&gt;empty_string($this-&gt;ur[&#39;</span>signature<span class="stringliteral">&#39;])) {</span>
<a name="l17552"></a>17552 <span class="stringliteral">                $out .= &#39;</span> /Signature[<span class="stringliteral">&#39;.$this-&gt;ur[&#39;</span>signature<span class="stringliteral">&#39;].&#39;</span>]<span class="stringliteral">&#39;;</span>
<a name="l17553"></a>17553 <span class="stringliteral">            }</span>
<a name="l17554"></a>17554 <span class="stringliteral">            if (!$this-&gt;empty_string($this-&gt;ur[&#39;</span>annots<span class="stringliteral">&#39;])) {</span>
<a name="l17555"></a>17555 <span class="stringliteral">                $out .= &#39;</span> /Annots[<span class="stringliteral">&#39;.$this-&gt;ur[&#39;</span>annots<span class="stringliteral">&#39;].&#39;</span>]<span class="stringliteral">&#39;;</span>
<a name="l17556"></a>17556 <span class="stringliteral">            }</span>
<a name="l17557"></a>17557 <span class="stringliteral">            if (!$this-&gt;empty_string($this-&gt;ur[&#39;</span>ef<span class="stringliteral">&#39;])) {</span>
<a name="l17558"></a>17558 <span class="stringliteral">                $out .= &#39;</span> /EF[<span class="stringliteral">&#39;.$this-&gt;ur[&#39;</span>ef<span class="stringliteral">&#39;].&#39;</span>]<span class="stringliteral">&#39;;</span>
<a name="l17559"></a>17559 <span class="stringliteral">            }</span>
<a name="l17560"></a>17560 <span class="stringliteral">            if (!$this-&gt;empty_string($this-&gt;ur[&#39;</span>formex<span class="stringliteral">&#39;])) {</span>
<a name="l17561"></a>17561 <span class="stringliteral">                $out .= &#39;</span> /FormEX[<span class="stringliteral">&#39;.$this-&gt;ur[&#39;</span>formex<span class="stringliteral">&#39;].&#39;</span>]<span class="stringliteral">&#39;;</span>
<a name="l17562"></a>17562 <span class="stringliteral">            }</span>
<a name="l17563"></a>17563 <span class="stringliteral">        }</span>
<a name="l17564"></a>17564 <span class="stringliteral">        $out .= &#39;</span> &gt;&gt;<span class="stringliteral">&#39;; // close TransformParams</span>
<a name="l17565"></a>17565 <span class="stringliteral">        // optional digest data (values must be calculated and replaced later)</span>
<a name="l17566"></a>17566 <span class="stringliteral">        //$out .= &#39;</span> /Data ********** 0 R<span class="stringliteral">&#39;;</span>
<a name="l17567"></a>17567 <span class="stringliteral">        //$out .= &#39;</span> /DigestMethod/MD5<span class="stringliteral">&#39;;</span>
<a name="l17568"></a>17568 <span class="stringliteral">        //$out .= &#39;</span> /DigestLocation[********** 34]<span class="stringliteral">&#39;;</span>
<a name="l17569"></a>17569 <span class="stringliteral">        //$out .= &#39;</span> /DigestValue&lt;********************************&gt;<span class="stringliteral">&#39;;</span>
<a name="l17570"></a>17570 <span class="stringliteral">        $out .= &#39;</span> &gt;&gt;<span class="stringliteral">&#39;;</span>
<a name="l17571"></a>17571 <span class="stringliteral">        $out .= &#39;</span> ]<span class="stringliteral">&#39;; // end of reference</span>
<a name="l17572"></a>17572 <span class="stringliteral">        if (isset($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>Name<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>Name<span class="stringliteral">&#39;])) {</span>
<a name="l17573"></a>17573 <span class="stringliteral">            $out .= &#39;</span> /Name <span class="stringliteral">&#39;.$this-&gt;_textstring($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>Name<span class="stringliteral">&#39;], $sigobjid);</span>
<a name="l17574"></a>17574 <span class="stringliteral">        }</span>
<a name="l17575"></a>17575 <span class="stringliteral">        if (isset($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>Location<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>Location<span class="stringliteral">&#39;])) {</span>
<a name="l17576"></a>17576 <span class="stringliteral">            $out .= &#39;</span> /Location <span class="stringliteral">&#39;.$this-&gt;_textstring($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>Location<span class="stringliteral">&#39;], $sigobjid);</span>
<a name="l17577"></a>17577 <span class="stringliteral">        }</span>
<a name="l17578"></a>17578 <span class="stringliteral">        if (isset($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>Reason<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>Reason<span class="stringliteral">&#39;])) {</span>
<a name="l17579"></a>17579 <span class="stringliteral">            $out .= &#39;</span> /Reason <span class="stringliteral">&#39;.$this-&gt;_textstring($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>Reason<span class="stringliteral">&#39;], $sigobjid);</span>
<a name="l17580"></a>17580 <span class="stringliteral">        }</span>
<a name="l17581"></a>17581 <span class="stringliteral">        if (isset($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>ContactInfo<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>ContactInfo<span class="stringliteral">&#39;])) {</span>
<a name="l17582"></a>17582 <span class="stringliteral">            $out .= &#39;</span> /ContactInfo <span class="stringliteral">&#39;.$this-&gt;_textstring($this-&gt;signature_data[&#39;</span>info<span class="stringliteral">&#39;][&#39;</span>ContactInfo<span class="stringliteral">&#39;], $sigobjid);</span>
<a name="l17583"></a>17583 <span class="stringliteral">        }</span>
<a name="l17584"></a>17584 <span class="stringliteral">        $out .= &#39;</span> /<a class="code" href="import_8lib_8php.html#aad05f78187c942f9dd521605fa81f1ba">M</a> <span class="stringliteral">&#39;.$this-&gt;_datestring($sigobjid);</span>
<a name="l17585"></a>17585 <span class="stringliteral">        $out .= &#39;</span> &gt;&gt;<span class="stringliteral">&#39;;</span>
<a name="l17586"></a>17586 <span class="stringliteral">        $out .= &quot;\n&quot;.&#39;</span>endobj<span class="stringliteral">&#39;;</span>
<a name="l17587"></a>17587 <span class="stringliteral">        $this-&gt;_out($out);</span>
<a name="l17588"></a>17588 <span class="stringliteral">    }</span>
<a name="l17589"></a>17589 <span class="stringliteral"></span><span class="comment"></span>
<a name="l17590"></a>17590 <span class="comment">    /**</span>
<a name="l17591"></a>17591 <span class="comment">     * Set User&#39;s Rights for PDF Reader</span>
<a name="l17592"></a>17592 <span class="comment">     * WARNING: This is experimental and currently do not work.</span>
<a name="l17593"></a>17593 <span class="comment">     * Check the PDF Reference 8.7.1 Transform Methods,</span>
<a name="l17594"></a>17594 <span class="comment">     * Table 8.105 Entries in the UR transform parameters dictionary</span>
<a name="l17595"></a>17595 <span class="comment">     * @param $enable (boolean) if true enable user&#39;s rights on PDF reader</span>
<a name="l17596"></a>17596 <span class="comment">     * @param $document (string) Names specifying additional document-wide usage rights for the document. The only defined value is &quot;/FullSave&quot;, which permits a user to save the document along with modified form and/or annotation data.</span>
<a name="l17597"></a>17597 <span class="comment">     * @param $annots (string) Names specifying additional annotation-related usage rights for the document. Valid names in PDF 1.5 and later are /Create/Delete/Modify/Copy/Import/Export, which permit the user to perform the named operation on annotations.</span>
<a name="l17598"></a>17598 <span class="comment">     * @param $form (string) Names specifying additional form-field-related usage rights for the document. Valid names are: /Add/Delete/FillIn/Import/Export/SubmitStandalone/SpawnTemplate</span>
<a name="l17599"></a>17599 <span class="comment">     * @param $signature (string) Names specifying additional signature-related usage rights for the document. The only defined value is /Modify, which permits a user to apply a digital signature to an existing signature form field or clear a signed signature form field.</span>
<a name="l17600"></a>17600 <span class="comment">     * @param $ef (string) Names specifying additional usage rights for named embedded files in the document. Valid names are /Create/Delete/Modify/Import, which permit the user to perform the named operation on named embedded files</span>
<a name="l17601"></a>17601 <span class="comment">     Names specifying additional embedded-files-related usage rights for the document.</span>
<a name="l17602"></a>17602 <span class="comment">     * @param $formex (string) Names specifying additional form-field-related usage rights. The only valid name is BarcodePlaintext, which permits text form field data to be encoded as a plaintext two-dimensional barcode.</span>
<a name="l17603"></a>17603 <span class="comment">     * @public</span>
<a name="l17604"></a>17604 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17605"></a>17605 <span class="comment">     * @since 2.9.000 (2008-03-26)</span>
<a name="l17606"></a>17606 <span class="comment">     */</span>
<a name="l17607"></a><a class="code" href="classTCPDF.html#a1d40e45dc074815d0fdaf55af9e22d81">17607</a>     public function setUserRights(
<a name="l17608"></a>17608             $enable=true,
<a name="l17609"></a>17609             $document=&#39;/FullSave<span class="stringliteral">&#39;,</span>
<a name="l17610"></a>17610 <span class="stringliteral">            $annots=&#39;</span>/Create/Delete/Modify/Copy/Import/Export<span class="stringliteral">&#39;,</span>
<a name="l17611"></a>17611 <span class="stringliteral">            $form=&#39;</span>/Add/Delete/FillIn/Import/Export/SubmitStandalone/SpawnTemplate<span class="stringliteral">&#39;,</span>
<a name="l17612"></a>17612 <span class="stringliteral">            $signature=&#39;</span>/Modify<span class="stringliteral">&#39;,</span>
<a name="l17613"></a>17613 <span class="stringliteral">            $ef=&#39;</span>/Create/Delete/Modify/Import<span class="stringliteral">&#39;,</span>
<a name="l17614"></a>17614 <span class="stringliteral">            $formex=&#39;</span><span class="stringliteral">&#39;) {</span>
<a name="l17615"></a>17615 <span class="stringliteral">        $this-&gt;ur[&#39;</span>enabled<span class="stringliteral">&#39;] = $enable;</span>
<a name="l17616"></a>17616 <span class="stringliteral">        $this-&gt;ur[&#39;</span>document<span class="stringliteral">&#39;] = $document;</span>
<a name="l17617"></a>17617 <span class="stringliteral">        $this-&gt;ur[&#39;</span>annots<span class="stringliteral">&#39;] = $annots;</span>
<a name="l17618"></a>17618 <span class="stringliteral">        $this-&gt;ur[&#39;</span>form<span class="stringliteral">&#39;] = $form;</span>
<a name="l17619"></a>17619 <span class="stringliteral">        $this-&gt;ur[&#39;</span>signature<span class="stringliteral">&#39;] = $signature;</span>
<a name="l17620"></a>17620 <span class="stringliteral">        $this-&gt;ur[&#39;</span>ef<span class="stringliteral">&#39;] = $ef;</span>
<a name="l17621"></a>17621 <span class="stringliteral">        $this-&gt;ur[&#39;</span>formex<span class="stringliteral">&#39;] = $formex;</span>
<a name="l17622"></a>17622 <span class="stringliteral">        if (!$this-&gt;sign) {</span>
<a name="l17623"></a>17623 <span class="stringliteral">            $this-&gt;setSignature(&#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, 0, array());</span>
<a name="l17624"></a>17624 <span class="stringliteral">        }</span>
<a name="l17625"></a>17625 <span class="stringliteral">    }</span>
<a name="l17626"></a>17626 <span class="stringliteral"></span><span class="comment"></span>
<a name="l17627"></a>17627 <span class="comment">    /**</span>
<a name="l17628"></a>17628 <span class="comment">     * Enable document signature (requires the OpenSSL Library).</span>
<a name="l17629"></a>17629 <span class="comment">     * The digital signature improve document authenticity and integrity and allows o enable extra features on Acrobat Reader.</span>
<a name="l17630"></a>17630 <span class="comment">     * To create self-signed signature: openssl req -x509 -nodes -days 365000 -newkey rsa:1024 -keyout tcpdf.crt -out tcpdf.crt</span>
<a name="l17631"></a>17631 <span class="comment">     * To export crt to p12: openssl pkcs12 -export -in tcpdf.crt -out tcpdf.p12</span>
<a name="l17632"></a>17632 <span class="comment">     * To convert pfx certificate to pem: openssl pkcs12 -in tcpdf.pfx -out tcpdf.crt -nodes</span>
<a name="l17633"></a>17633 <span class="comment">     * @param $signing_cert (mixed) signing certificate (string or filename prefixed with &#39;file://&#39;)</span>
<a name="l17634"></a>17634 <span class="comment">     * @param $private_key (mixed) private key (string or filename prefixed with &#39;file://&#39;)</span>
<a name="l17635"></a>17635 <span class="comment">     * @param $private_key_password (string) password</span>
<a name="l17636"></a>17636 <span class="comment">     * @param $extracerts (string) specifies the name of a file containing a bunch of extra certificates to include in the signature which can for example be used to help the recipient to verify the certificate that you used.</span>
<a name="l17637"></a>17637 <span class="comment">     * @param $cert_type (int) The access permissions granted for this document. Valid values shall be: 1 = No changes to the document shall be permitted; any change to the document shall invalidate the signature; 2 = Permitted changes shall be filling in forms, instantiating page templates, and signing; other changes shall invalidate the signature; 3 = Permitted changes shall be the same as for 2, as well as annotation creation, deletion, and modification; other changes shall invalidate the signature.</span>
<a name="l17638"></a>17638 <span class="comment">     * @param $info (array) array of option information: Name, Location, Reason, ContactInfo.</span>
<a name="l17639"></a>17639 <span class="comment">     * @public</span>
<a name="l17640"></a>17640 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17641"></a>17641 <span class="comment">     * @since 4.6.005 (2009-04-24)</span>
<a name="l17642"></a>17642 <span class="comment">     */</span>
<a name="l17643"></a><a class="code" href="classTCPDF.html#a16ca73a301730e6e4dd368628bceeb75">17643</a>     public function setSignature($signing_cert=&#39;<span class="stringliteral">&#39;, $private_key=&#39;</span><span class="stringliteral">&#39;, $private_key_password=&#39;</span><span class="stringliteral">&#39;, $extracerts=&#39;</span><span class="stringliteral">&#39;, $cert_type=2, $info=array()) {</span>
<a name="l17644"></a>17644 <span class="stringliteral">        // to create self-signed signature: openssl req -x509 -nodes -days 365000 -newkey rsa:1024 -keyout tcpdf.crt -out tcpdf.crt</span>
<a name="l17645"></a>17645 <span class="stringliteral">        // to export crt to p12: openssl pkcs12 -export -in tcpdf.crt -out tcpdf.p12</span>
<a name="l17646"></a>17646 <span class="stringliteral">        // to convert pfx certificate to pem: openssl</span>
<a name="l17647"></a>17647 <span class="stringliteral">        //     OpenSSL&gt; pkcs12 -in &lt;cert.pfx&gt; -out &lt;cert.crt&gt; -nodes</span>
<a name="l17648"></a>17648 <span class="stringliteral">        $this-&gt;sign = true;</span>
<a name="l17649"></a>17649 <span class="stringliteral">        ++$this-&gt;n;</span>
<a name="l17650"></a>17650 <span class="stringliteral">        $this-&gt;sig_obj_id = $this-&gt;n; // signature widget</span>
<a name="l17651"></a>17651 <span class="stringliteral">        ++$this-&gt;n; // signature object ($this-&gt;sig_obj_id + 1)</span>
<a name="l17652"></a>17652 <span class="stringliteral">        $this-&gt;signature_data = array();</span>
<a name="l17653"></a>17653 <span class="stringliteral">        if (strlen($signing_cert) == 0) {</span>
<a name="l17654"></a>17654 <span class="stringliteral">            $signing_cert = &#39;</span>file:<span class="comment">//&#39;.dirname(__FILE__).&#39;/tcpdf.crt&#39;;</span>
<a name="l17655"></a>17655             $private_key_password = <span class="stringliteral">&#39;tcpdfdemo&#39;</span>;
<a name="l17656"></a>17656         }
<a name="l17657"></a>17657         <span class="keywordflow">if</span> (strlen($private_key) == 0) {
<a name="l17658"></a>17658             $private_key = $signing_cert;
<a name="l17659"></a>17659         }
<a name="l17660"></a>17660         $this-&gt;signature_data[<span class="stringliteral">&#39;signcert&#39;</span>] = $signing_cert;
<a name="l17661"></a>17661         $this-&gt;signature_data[<span class="stringliteral">&#39;privkey&#39;</span>] = $private_key;
<a name="l17662"></a>17662         $this-&gt;signature_data[<span class="stringliteral">&#39;password&#39;</span>] = $private_key_password;
<a name="l17663"></a>17663         $this-&gt;signature_data[<span class="stringliteral">&#39;extracerts&#39;</span>] = $extracerts;
<a name="l17664"></a>17664         $this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>] = $cert_type;
<a name="l17665"></a>17665         $this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>] = $info;
<a name="l17666"></a>17666     }
<a name="l17667"></a>17667 <span class="comment"></span>
<a name="l17668"></a>17668 <span class="comment">    /**</span>
<a name="l17669"></a>17669 <span class="comment">     * Set the digital signature appearance (a cliccable rectangle area to get signature properties)</span>
<a name="l17670"></a>17670 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner.</span>
<a name="l17671"></a>17671 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner.</span>
<a name="l17672"></a>17672 <span class="comment">     * @param $w (float) Width of the signature area.</span>
<a name="l17673"></a>17673 <span class="comment">     * @param $h (float) Height of the signature area.</span>
<a name="l17674"></a>17674 <span class="comment">     * @param $page (int) option page number (if &lt; 0 the current page is used).</span>
<a name="l17675"></a>17675 <span class="comment">     * @public</span>
<a name="l17676"></a>17676 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17677"></a>17677 <span class="comment">     * @since 5.3.011 (2010-06-17)</span>
<a name="l17678"></a>17678 <span class="comment">     */</span>
<a name="l17679"></a><a class="code" href="classTCPDF.html#a80da1867c0112a1e42da5d84f1374720">17679</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a80da1867c0112a1e42da5d84f1374720" title="Set the digital signature appearance (a cliccable rectangle area to get signature properties)...">setSignatureAppearance</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=0, $y=0, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=0, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=0, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=-1) {
<a name="l17680"></a>17680         $this-&gt;signature_appearance = $this-&gt;getSignatureAppearanceArray(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>);
<a name="l17681"></a>17681     }
<a name="l17682"></a>17682 <span class="comment"></span>
<a name="l17683"></a>17683 <span class="comment">    /**</span>
<a name="l17684"></a>17684 <span class="comment">     * Add an empty digital signature appearance (a cliccable rectangle area to get signature properties)</span>
<a name="l17685"></a>17685 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner.</span>
<a name="l17686"></a>17686 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner.</span>
<a name="l17687"></a>17687 <span class="comment">     * @param $w (float) Width of the signature area.</span>
<a name="l17688"></a>17688 <span class="comment">     * @param $h (float) Height of the signature area.</span>
<a name="l17689"></a>17689 <span class="comment">     * @param $page (int) option page number (if &lt; 0 the current page is used).</span>
<a name="l17690"></a>17690 <span class="comment">     * @public</span>
<a name="l17691"></a>17691 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17692"></a>17692 <span class="comment">     * @since 5.9.101 (2011-07-06)</span>
<a name="l17693"></a>17693 <span class="comment">     */</span>
<a name="l17694"></a><a class="code" href="classTCPDF.html#ab7663020a6666cf7b6f424600c62e777">17694</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab7663020a6666cf7b6f424600c62e777" title="Add an empty digital signature appearance (a cliccable rectangle area to get signature properties)...">addEmptySignatureAppearance</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=0, $y=0, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=0, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=0, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=-1) {
<a name="l17695"></a>17695         ++$this-&gt;n;
<a name="l17696"></a>17696         $this-&gt;empty_signature_appearance[] = array(<span class="stringliteral">&#39;objid&#39;</span> =&gt; $this-&gt;n) + $this-&gt;getSignatureAppearanceArray(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>);
<a name="l17697"></a>17697     }
<a name="l17698"></a>17698 <span class="comment"></span>
<a name="l17699"></a>17699 <span class="comment">    /**</span>
<a name="l17700"></a>17700 <span class="comment">     * Get the array that defines the signature appearance (page and rectangle coordinates).</span>
<a name="l17701"></a>17701 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner.</span>
<a name="l17702"></a>17702 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner.</span>
<a name="l17703"></a>17703 <span class="comment">     * @param $w (float) Width of the signature area.</span>
<a name="l17704"></a>17704 <span class="comment">     * @param $h (float) Height of the signature area.</span>
<a name="l17705"></a>17705 <span class="comment">     * @param $page (int) option page number (if &lt; 0 the current page is used).</span>
<a name="l17706"></a>17706 <span class="comment">     * @return (array) Array defining page and rectangle coordinates of signature appearance.</span>
<a name="l17707"></a>17707 <span class="comment">     * @protected</span>
<a name="l17708"></a>17708 <span class="comment">     * @author Nicola Asuni</span>
<a name="l17709"></a>17709 <span class="comment">     * @since 5.9.101 (2011-07-06)</span>
<a name="l17710"></a>17710 <span class="comment">     */</span>
<a name="l17711"></a><a class="code" href="classTCPDF.html#a239b3a597d12a8c8563e415472265ff7">17711</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a239b3a597d12a8c8563e415472265ff7" title="Get the array that defines the signature appearance (page and rectangle coordinates).">getSignatureAppearanceArray</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=0, $y=0, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=0, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=0, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=-1) {
<a name="l17712"></a>17712         $sigapp = array();
<a name="l17713"></a>17713         <span class="keywordflow">if</span> ((<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &lt; 1) OR (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &gt; $this-&gt;numpages)) {
<a name="l17714"></a>17714             $sigapp[<span class="stringliteral">&#39;page&#39;</span>] = $this-&gt;page;
<a name="l17715"></a>17715         } <span class="keywordflow">else</span> {
<a name="l17716"></a>17716             $sigapp[<span class="stringliteral">&#39;page&#39;</span>] = intval(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>);
<a name="l17717"></a>17717         }
<a name="l17718"></a>17718         $a = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * $this-&gt;k;
<a name="l17719"></a>17719         $b = $this-&gt;pagedim[($sigapp[<span class="stringliteral">&#39;page&#39;</span>])][<span class="charliteral">&#39;h&#39;</span>] - (($y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>) * $this-&gt;k);
<a name="l17720"></a>17720         <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $this-&gt;k;
<a name="l17721"></a>17721         $d = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> * $this-&gt;k;
<a name="l17722"></a>17722         $sigapp[<span class="stringliteral">&#39;rect&#39;</span>] = sprintf(<span class="stringliteral">&#39;%.2F %.2F %.2F %.2F&#39;</span>, $a, $b, ($a + $c), ($b + $d));
<a name="l17723"></a>17723         <span class="keywordflow">return</span> $sigapp;
<a name="l17724"></a>17724     }
<a name="l17725"></a>17725 <span class="comment"></span>
<a name="l17726"></a>17726 <span class="comment">    /**</span>
<a name="l17727"></a>17727 <span class="comment">     * Create a new page group.</span>
<a name="l17728"></a>17728 <span class="comment">     * NOTE: call this function before calling AddPage()</span>
<a name="l17729"></a>17729 <span class="comment">     * @param $page (int) starting group page (leave empty for next page).</span>
<a name="l17730"></a>17730 <span class="comment">     * @public</span>
<a name="l17731"></a>17731 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l17732"></a>17732 <span class="comment">     */</span>
<a name="l17733"></a><a class="code" href="classTCPDF.html#a2ed08174efade970d4b641f77ab2b0d5">17733</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2ed08174efade970d4b641f77ab2b0d5" title="Create a new page group.">startPageGroup</a>(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l17734"></a>17734         <span class="keywordflow">if</span> (empty(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l17735"></a>17735             <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = $this-&gt;page + 1;
<a name="l17736"></a>17736         }
<a name="l17737"></a>17737         $this-&gt;newpagegroup[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>] = <span class="keyword">sizeof</span>($this-&gt;newpagegroup) + 1;
<a name="l17738"></a>17738     }
<a name="l17739"></a>17739 <span class="comment"></span>
<a name="l17740"></a>17740 <span class="comment">    /**</span>
<a name="l17741"></a>17741 <span class="comment">     * This method is DEPRECATED and doesn&#39;t have any effect.</span>
<a name="l17742"></a>17742 <span class="comment">     * Please remove any reference to this method.</span>
<a name="l17743"></a>17743 <span class="comment">     * @param $s (string) Empty parameter.</span>
<a name="l17744"></a>17744 <span class="comment">     * @deprecated deprecated since version 5.9.089 (2011-06-13)</span>
<a name="l17745"></a>17745 <span class="comment">     * @public</span>
<a name="l17746"></a>17746 <span class="comment">     */</span>
<a name="l17747"></a><a class="code" href="classTCPDF.html#a2d3f61ba5b793628d1cb64edf89d0ee6">17747</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2d3f61ba5b793628d1cb64edf89d0ee6" title="This method is DEPRECATED and doesn&#39;t have any effect.">AliasNbPages</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>=<span class="stringliteral">&#39;&#39;</span>) {}
<a name="l17748"></a>17748 <span class="comment"></span>
<a name="l17749"></a>17749 <span class="comment">    /**</span>
<a name="l17750"></a>17750 <span class="comment">     * This method is DEPRECATED and doesn&#39;t have any effect.</span>
<a name="l17751"></a>17751 <span class="comment">     * Please remove any reference to this method.</span>
<a name="l17752"></a>17752 <span class="comment">     * @param $s (string) Empty parameter.</span>
<a name="l17753"></a>17753 <span class="comment">     * @deprecated deprecated since version 5.9.089 (2011-06-13)</span>
<a name="l17754"></a>17754 <span class="comment">     * @public</span>
<a name="l17755"></a>17755 <span class="comment">     */</span>
<a name="l17756"></a><a class="code" href="classTCPDF.html#ab03abb77c0405ef877f4de9559407c77">17756</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab03abb77c0405ef877f4de9559407c77" title="This method is DEPRECATED and doesn&#39;t have any effect.">AliasNumPage</a>(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>=<span class="stringliteral">&#39;&#39;</span>) {}
<a name="l17757"></a>17757 <span class="comment"></span>
<a name="l17758"></a>17758 <span class="comment">    /**</span>
<a name="l17759"></a>17759 <span class="comment">     * Set the starting page number.</span>
<a name="l17760"></a>17760 <span class="comment">     * @param $num (int) Starting page number.</span>
<a name="l17761"></a>17761 <span class="comment">     * @since 5.9.093 (2011-06-16)</span>
<a name="l17762"></a>17762 <span class="comment">     * @public</span>
<a name="l17763"></a>17763 <span class="comment">     */</span>
<a name="l17764"></a><a class="code" href="classTCPDF.html#a295eb20ff68b8f2a04b33e4dadd66dc4">17764</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a295eb20ff68b8f2a04b33e4dadd66dc4" title="Set the starting page number.">setStartingPageNumber</a>($num=1) {
<a name="l17765"></a>17765         $this-&gt;starting_page_number = max(0, intval($num));
<a name="l17766"></a>17766     }
<a name="l17767"></a>17767 <span class="comment"></span>
<a name="l17768"></a>17768 <span class="comment">    /**</span>
<a name="l17769"></a>17769 <span class="comment">     * Returns the string alias used right align page numbers.</span>
<a name="l17770"></a>17770 <span class="comment">     * If the current font is unicode type, the returned string wil contain an additional open curly brace.</span>
<a name="l17771"></a>17771 <span class="comment">     * @return string</span>
<a name="l17772"></a>17772 <span class="comment">     * @since 5.9.099 (2011-06-27)</span>
<a name="l17773"></a>17773 <span class="comment">     * @public</span>
<a name="l17774"></a>17774 <span class="comment">     */</span>
<a name="l17775"></a><a class="code" href="classTCPDF.html#ad089fa332b723086484ae0497ae90590">17775</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad089fa332b723086484ae0497ae90590" title="Returns the string alias used right align page numbers.">getAliasRightShift</a>() {
<a name="l17776"></a>17776         <span class="comment">// calculate aproximatively the ratio between widths of aliases and replacements.</span>
<a name="l17777"></a>17777         $ref = <span class="charliteral">&#39;{&#39;</span>.$this-&gt;alias_right_shift.<span class="stringliteral">&#39;}{&#39;</span>.$this-&gt;alias_tot_pages.<span class="stringliteral">&#39;}{&#39;</span>.$this-&gt;alias_num_page.<span class="charliteral">&#39;}&#39;</span>;
<a name="l17778"></a>17778         $rep = str_repeat(<span class="charliteral">&#39; &#39;</span>, $this-&gt;GetNumChars($ref));
<a name="l17779"></a>17779         $wdiff = max(1, ($this-&gt;GetStringWidth($ref) / $this-&gt;GetStringWidth($rep)));
<a name="l17780"></a>17780         $sdiff = sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, $wdiff);
<a name="l17781"></a>17781         $alias = $this-&gt;alias_right_shift.$sdiff.<span class="charliteral">&#39;}&#39;</span>;
<a name="l17782"></a>17782         <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l17783"></a>17783             $alias = <span class="charliteral">&#39;{&#39;</span>.$alias;
<a name="l17784"></a>17784         }
<a name="l17785"></a>17785         <span class="keywordflow">return</span> $alias;
<a name="l17786"></a>17786     }
<a name="l17787"></a>17787 <span class="comment"></span>
<a name="l17788"></a>17788 <span class="comment">    /**</span>
<a name="l17789"></a>17789 <span class="comment">     * Returns the string alias used for the total number of pages.</span>
<a name="l17790"></a>17790 <span class="comment">     * If the current font is unicode type, the returned string is surrounded by additional curly braces.</span>
<a name="l17791"></a>17791 <span class="comment">     * This alias will be replaced by the total number of pages in the document.</span>
<a name="l17792"></a>17792 <span class="comment">     * @return string</span>
<a name="l17793"></a>17793 <span class="comment">     * @since 4.0.018 (2008-08-08)</span>
<a name="l17794"></a>17794 <span class="comment">     * @public</span>
<a name="l17795"></a>17795 <span class="comment">     */</span>
<a name="l17796"></a><a class="code" href="classTCPDF.html#a3a6255516dcf07089fe29f13b3ef67bf">17796</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3a6255516dcf07089fe29f13b3ef67bf" title="Returns the string alias used for the total number of pages.">getAliasNbPages</a>() {
<a name="l17797"></a>17797         <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l17798"></a>17798             <span class="keywordflow">return</span> <span class="charliteral">&#39;{&#39;</span>.$this-&gt;alias_tot_pages.<span class="charliteral">&#39;}&#39;</span>;
<a name="l17799"></a>17799         }
<a name="l17800"></a>17800         <span class="keywordflow">return</span> $this-&gt;alias_tot_pages;
<a name="l17801"></a>17801     }
<a name="l17802"></a>17802 <span class="comment"></span>
<a name="l17803"></a>17803 <span class="comment">    /**</span>
<a name="l17804"></a>17804 <span class="comment">     * Returns the string alias used for the page number.</span>
<a name="l17805"></a>17805 <span class="comment">     * If the current font is unicode type, the returned string is surrounded by additional curly braces.</span>
<a name="l17806"></a>17806 <span class="comment">     * This alias will be replaced by the page number.</span>
<a name="l17807"></a>17807 <span class="comment">     * @return string</span>
<a name="l17808"></a>17808 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l17809"></a>17809 <span class="comment">     * @public</span>
<a name="l17810"></a>17810 <span class="comment">     */</span>
<a name="l17811"></a><a class="code" href="classTCPDF.html#ae11c5f52caa0df8609ec22c30cd54055">17811</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae11c5f52caa0df8609ec22c30cd54055" title="Returns the string alias used for the page number.">getAliasNumPage</a>() {
<a name="l17812"></a>17812         <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l17813"></a>17813             <span class="keywordflow">return</span> <span class="charliteral">&#39;{&#39;</span>.$this-&gt;alias_num_page.<span class="charliteral">&#39;}&#39;</span>;
<a name="l17814"></a>17814         }
<a name="l17815"></a>17815         <span class="keywordflow">return</span> $this-&gt;alias_num_page;
<a name="l17816"></a>17816     }
<a name="l17817"></a>17817 <span class="comment"></span>
<a name="l17818"></a>17818 <span class="comment">    /**</span>
<a name="l17819"></a>17819 <span class="comment">     * Return the alias for the total number of pages in the current page group.</span>
<a name="l17820"></a>17820 <span class="comment">     * If the current font is unicode type, the returned string is surrounded by additional curly braces.</span>
<a name="l17821"></a>17821 <span class="comment">     * This alias will be replaced by the total number of pages in this group.</span>
<a name="l17822"></a>17822 <span class="comment">     * @return alias of the current page group</span>
<a name="l17823"></a>17823 <span class="comment">     * @public</span>
<a name="l17824"></a>17824 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l17825"></a>17825 <span class="comment">     */</span>
<a name="l17826"></a><a class="code" href="classTCPDF.html#af73382321461f24798a639c2f433a67f">17826</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af73382321461f24798a639c2f433a67f" title="Return the alias for the total number of pages in the current page group.">getPageGroupAlias</a>() {
<a name="l17827"></a>17827         <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l17828"></a>17828             <span class="keywordflow">return</span> <span class="charliteral">&#39;{&#39;</span>.$this-&gt;alias_group_tot_pages.<span class="charliteral">&#39;}&#39;</span>;
<a name="l17829"></a>17829         }
<a name="l17830"></a>17830         <span class="keywordflow">return</span> $this-&gt;alias_group_tot_pages;
<a name="l17831"></a>17831     }
<a name="l17832"></a>17832 <span class="comment"></span>
<a name="l17833"></a>17833 <span class="comment">    /**</span>
<a name="l17834"></a>17834 <span class="comment">     * Return the alias for the page number on the current page group.</span>
<a name="l17835"></a>17835 <span class="comment">     * If the current font is unicode type, the returned string is surrounded by additional curly braces.</span>
<a name="l17836"></a>17836 <span class="comment">     * This alias will be replaced by the page number (relative to the belonging group).</span>
<a name="l17837"></a>17837 <span class="comment">     * @return alias of the current page group</span>
<a name="l17838"></a>17838 <span class="comment">     * @public</span>
<a name="l17839"></a>17839 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l17840"></a>17840 <span class="comment">     */</span>
<a name="l17841"></a><a class="code" href="classTCPDF.html#a015d1f6a5d39877206bf2b12163eddcc">17841</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a015d1f6a5d39877206bf2b12163eddcc" title="Return the alias for the page number on the current page group.">getPageNumGroupAlias</a>() {
<a name="l17842"></a>17842         <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l17843"></a>17843             <span class="keywordflow">return</span> <span class="charliteral">&#39;{&#39;</span>.$this-&gt;alias_group_num_page.<span class="charliteral">&#39;}&#39;</span>;
<a name="l17844"></a>17844         }
<a name="l17845"></a>17845         <span class="keywordflow">return</span> $this-&gt;alias_group_num_page;
<a name="l17846"></a>17846     }
<a name="l17847"></a>17847 <span class="comment"></span>
<a name="l17848"></a>17848 <span class="comment">    /**</span>
<a name="l17849"></a>17849 <span class="comment">     * Return the current page in the group.</span>
<a name="l17850"></a>17850 <span class="comment">     * @return current page in the group</span>
<a name="l17851"></a>17851 <span class="comment">     * @public</span>
<a name="l17852"></a>17852 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l17853"></a>17853 <span class="comment">     */</span>
<a name="l17854"></a><a class="code" href="classTCPDF.html#abb054390914b3cb23d207f4c36f0395c">17854</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#abb054390914b3cb23d207f4c36f0395c" title="Return the current page in the group.">getGroupPageNo</a>() {
<a name="l17855"></a>17855         <span class="keywordflow">return</span> $this-&gt;pagegroups[$this-&gt;currpagegroup];
<a name="l17856"></a>17856     }
<a name="l17857"></a>17857 <span class="comment"></span>
<a name="l17858"></a>17858 <span class="comment">    /**</span>
<a name="l17859"></a>17859 <span class="comment">     * Returns the current group page number formatted as a string.</span>
<a name="l17860"></a>17860 <span class="comment">     * @public</span>
<a name="l17861"></a>17861 <span class="comment">     * @since 4.3.003 (2008-11-18)</span>
<a name="l17862"></a>17862 <span class="comment">     * @see PaneNo(), formatPageNumber()</span>
<a name="l17863"></a>17863 <span class="comment">     */</span>
<a name="l17864"></a><a class="code" href="classTCPDF.html#ac92bf6e625a271c53f17bf23c508613e">17864</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac92bf6e625a271c53f17bf23c508613e" title="Returns the current group page number formatted as a string.">getGroupPageNoFormatted</a>() {
<a name="l17865"></a>17865         <span class="keywordflow">return</span> $this-&gt;formatPageNumber($this-&gt;getGroupPageNo());
<a name="l17866"></a>17866     }
<a name="l17867"></a>17867 <span class="comment"></span>
<a name="l17868"></a>17868 <span class="comment">    /**</span>
<a name="l17869"></a>17869 <span class="comment">     * Format the page numbers.</span>
<a name="l17870"></a>17870 <span class="comment">     * This method can be overriden for custom formats.</span>
<a name="l17871"></a>17871 <span class="comment">     * @param $num (int) page number</span>
<a name="l17872"></a>17872 <span class="comment">     * @protected</span>
<a name="l17873"></a>17873 <span class="comment">     * @since 4.2.005 (2008-11-06)</span>
<a name="l17874"></a>17874 <span class="comment">     */</span>
<a name="l17875"></a><a class="code" href="classTCPDF.html#a0ab6ba21b10fcfba6422950b88d6ff8d">17875</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0ab6ba21b10fcfba6422950b88d6ff8d" title="Format the page numbers.">formatPageNumber</a>($num) {
<a name="l17876"></a>17876         <span class="keywordflow">return</span> number_format((<span class="keywordtype">float</span>)$num, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;.&#39;</span>);
<a name="l17877"></a>17877     }
<a name="l17878"></a>17878 <span class="comment"></span>
<a name="l17879"></a>17879 <span class="comment">    /**</span>
<a name="l17880"></a>17880 <span class="comment">     * Format the page numbers on the Table Of Content.</span>
<a name="l17881"></a>17881 <span class="comment">     * This method can be overriden for custom formats.</span>
<a name="l17882"></a>17882 <span class="comment">     * @param $num (int) page number</span>
<a name="l17883"></a>17883 <span class="comment">     * @protected</span>
<a name="l17884"></a>17884 <span class="comment">     * @since 4.5.001 (2009-01-04)</span>
<a name="l17885"></a>17885 <span class="comment">     * @see addTOC(), addHTMLTOC()</span>
<a name="l17886"></a>17886 <span class="comment">     */</span>
<a name="l17887"></a><a class="code" href="classTCPDF.html#ac8ded6855d075eb20fca855726a211e5">17887</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac8ded6855d075eb20fca855726a211e5" title="Format the page numbers on the Table Of Content.">formatTOCPageNumber</a>($num) {
<a name="l17888"></a>17888         <span class="keywordflow">return</span> number_format((<span class="keywordtype">float</span>)$num, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;.&#39;</span>);
<a name="l17889"></a>17889     }
<a name="l17890"></a>17890 <span class="comment"></span>
<a name="l17891"></a>17891 <span class="comment">    /**</span>
<a name="l17892"></a>17892 <span class="comment">     * Returns the current page number formatted as a string.</span>
<a name="l17893"></a>17893 <span class="comment">     * @public</span>
<a name="l17894"></a>17894 <span class="comment">     * @since 4.2.005 (2008-11-06)</span>
<a name="l17895"></a>17895 <span class="comment">     * @see PaneNo(), formatPageNumber()</span>
<a name="l17896"></a>17896 <span class="comment">     */</span>
<a name="l17897"></a><a class="code" href="classTCPDF.html#a43d7a316bc0f19d6540f238ebebe62d5">17897</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a43d7a316bc0f19d6540f238ebebe62d5" title="Returns the current page number formatted as a string.">PageNoFormatted</a>() {
<a name="l17898"></a>17898         <span class="keywordflow">return</span> $this-&gt;formatPageNumber($this-&gt;PageNo());
<a name="l17899"></a>17899     }
<a name="l17900"></a>17900 <span class="comment"></span>
<a name="l17901"></a>17901 <span class="comment">    /**</span>
<a name="l17902"></a>17902 <span class="comment">     * Put pdf layers.</span>
<a name="l17903"></a>17903 <span class="comment">     * @protected</span>
<a name="l17904"></a>17904 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l17905"></a>17905 <span class="comment">     */</span>
<a name="l17906"></a><a class="code" href="classTCPDF.html#a1de30d6f895d9fb9722f4440d9ae82d7">17906</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1de30d6f895d9fb9722f4440d9ae82d7" title="Put pdf layers.">_putocg</a>() {
<a name="l17907"></a>17907         <span class="keywordflow">if</span> (empty($this-&gt;pdflayers)) {
<a name="l17908"></a>17908             <span class="keywordflow">return</span>;
<a name="l17909"></a>17909         }
<a name="l17910"></a>17910         <span class="keywordflow">foreach</span> ($this-&gt;pdflayers as $key =&gt; $layer) {
<a name="l17911"></a>17911              $this-&gt;pdflayers[$key][<span class="stringliteral">&#39;objid&#39;</span>] = $this-&gt;_newobj();
<a name="l17912"></a>17912              <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /OCG&#39;</span>;
<a name="l17913"></a>17913              <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Name &#39;</span>.$this-&gt;_textstring($layer[<span class="stringliteral">&#39;name&#39;</span>], $this-&gt;pdflayers[$key][<span class="stringliteral">&#39;objid&#39;</span>]);
<a name="l17914"></a>17914              <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Usage &lt;&lt;&#39;</span>;
<a name="l17915"></a>17915              <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Print &lt;&lt;/PrintState /&#39;</span>.($layer[<span class="stringliteral">&#39;print&#39;</span>]?<span class="stringliteral">&#39;ON&#39;</span>:<span class="stringliteral">&#39;OFF&#39;</span>).<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l17916"></a>17916              <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /View &lt;&lt;/ViewState /&#39;</span>.($layer[<span class="stringliteral">&#39;view&#39;</span>]?<span class="stringliteral">&#39;ON&#39;</span>:<span class="stringliteral">&#39;OFF&#39;</span>).<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;
<a name="l17917"></a>17917              <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt; &gt;&gt;&#39;</span>;
<a name="l17918"></a>17918              <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l17919"></a>17919              $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l17920"></a>17920         }
<a name="l17921"></a>17921     }
<a name="l17922"></a>17922 <span class="comment"></span>
<a name="l17923"></a>17923 <span class="comment">    /**</span>
<a name="l17924"></a>17924 <span class="comment">     * Start a new pdf layer.</span>
<a name="l17925"></a>17925 <span class="comment">     * @param $name (string) Layer name (only a-z letters and numbers). Leave empty for automatic name.</span>
<a name="l17926"></a>17926 <span class="comment">     * @param $print (boolean) Set to true to print this layer.</span>
<a name="l17927"></a>17927 <span class="comment">     * @param $view (boolean) Set to true to view this layer.</span>
<a name="l17928"></a>17928 <span class="comment">     * @public</span>
<a name="l17929"></a>17929 <span class="comment">     * @since 5.9.102 (2011-07-13)</span>
<a name="l17930"></a>17930 <span class="comment">     */</span>
<a name="l17931"></a><a class="code" href="classTCPDF.html#a5516b2555473c1b5a9b3613f9d00da70">17931</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5516b2555473c1b5a9b3613f9d00da70" title="Start a new pdf layer.">startLayer</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>=<span class="stringliteral">&#39;&#39;</span>, $print=<span class="keyword">true</span>, <a class="code" href="view__create_8php.html#a2c2fb2ab30570b3e5562cd69d2d58ef4">$view</a>=<span class="keyword">true</span>) {
<a name="l17932"></a>17932         $layer = sprintf(<span class="stringliteral">&#39;LYR%03d&#39;</span>, (count($this-&gt;pdflayers) + 1));
<a name="l17933"></a>17933         <span class="keywordflow">if</span> (empty(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>)) {
<a name="l17934"></a>17934             <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = $layer;
<a name="l17935"></a>17935         } <span class="keywordflow">else</span> {
<a name="l17936"></a>17936             <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = preg_replace(<span class="stringliteral">&#39;/[^a-zA-Z0-9_\-]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>);
<a name="l17937"></a>17937         }
<a name="l17938"></a>17938         $this-&gt;pdflayers[] = array(<span class="stringliteral">&#39;layer&#39;</span> =&gt; $layer, <span class="stringliteral">&#39;name&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <span class="stringliteral">&#39;print&#39;</span> =&gt; $print, <span class="stringliteral">&#39;view&#39;</span> =&gt; <a class="code" href="view__create_8php.html#a2c2fb2ab30570b3e5562cd69d2d58ef4">$view</a>);
<a name="l17939"></a>17939         $this-&gt;openMarkedContent = <span class="keyword">true</span>;
<a name="l17940"></a>17940         $this-&gt;_out(<span class="stringliteral">&#39;/OC /&#39;</span>.$layer.<span class="stringliteral">&#39; BDC&#39;</span>);
<a name="l17941"></a>17941     }
<a name="l17942"></a>17942 <span class="comment"></span>
<a name="l17943"></a>17943 <span class="comment">    /**</span>
<a name="l17944"></a>17944 <span class="comment">     * End the current PDF layer.</span>
<a name="l17945"></a>17945 <span class="comment">     * @public</span>
<a name="l17946"></a>17946 <span class="comment">     * @since 5.9.102 (2011-07-13)</span>
<a name="l17947"></a>17947 <span class="comment">     */</span>
<a name="l17948"></a><a class="code" href="classTCPDF.html#a996258e3c16a3bb8de1f5c1ff8b8c9d8">17948</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a996258e3c16a3bb8de1f5c1ff8b8c9d8" title="End the current PDF layer.">endLayer</a>() {
<a name="l17949"></a>17949         <span class="keywordflow">if</span> ($this-&gt;openMarkedContent) {
<a name="l17950"></a>17950             <span class="comment">// close existing open marked-content layer</span>
<a name="l17951"></a>17951             $this-&gt;_out(<span class="stringliteral">&#39;EMC&#39;</span>);
<a name="l17952"></a>17952             $this-&gt;openMarkedContent = <span class="keyword">false</span>;
<a name="l17953"></a>17953         }
<a name="l17954"></a>17954     }
<a name="l17955"></a>17955 <span class="comment"></span>
<a name="l17956"></a>17956 <span class="comment">    /**</span>
<a name="l17957"></a>17957 <span class="comment">     * Set the visibility of the successive elements.</span>
<a name="l17958"></a>17958 <span class="comment">     * This can be useful, for instance, to put a background</span>
<a name="l17959"></a>17959 <span class="comment">     * image or color that will show on screen but won&#39;t print.</span>
<a name="l17960"></a>17960 <span class="comment">     * @param $v (string) visibility mode. Legal values are: all, print, screen or view.</span>
<a name="l17961"></a>17961 <span class="comment">     * @public</span>
<a name="l17962"></a>17962 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l17963"></a>17963 <span class="comment">     */</span>
<a name="l17964"></a><a class="code" href="classTCPDF.html#ab0f6ca38653854c80ef47a1909685030">17964</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab0f6ca38653854c80ef47a1909685030" title="Set the visibility of the successive elements.">setVisibility</a>($v) {
<a name="l17965"></a>17965         $this-&gt;endLayer();
<a name="l17966"></a>17966         <span class="keywordflow">switch</span>($v) {
<a name="l17967"></a>17967             <span class="keywordflow">case</span> <span class="stringliteral">&#39;print&#39;</span>: {
<a name="l17968"></a>17968                 $this-&gt;startLayer(<span class="stringliteral">&#39;Print&#39;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);
<a name="l17969"></a>17969                 <span class="keywordflow">break</span>;
<a name="l17970"></a>17970             }
<a name="l17971"></a>17971             <span class="keywordflow">case</span> <span class="stringliteral">&#39;view&#39;</span>:
<a name="l17972"></a>17972             <span class="keywordflow">case</span> <span class="stringliteral">&#39;screen&#39;</span>: {
<a name="l17973"></a>17973                 $this-&gt;startLayer(<span class="stringliteral">&#39;View&#39;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);
<a name="l17974"></a>17974                 <span class="keywordflow">break</span>;
<a name="l17975"></a>17975             }
<a name="l17976"></a>17976             <span class="keywordflow">case</span> <span class="stringliteral">&#39;all&#39;</span>: {
<a name="l17977"></a>17977                 $this-&gt;_out(<span class="stringliteral">&#39;&#39;</span>);
<a name="l17978"></a>17978                 <span class="keywordflow">break</span>;
<a name="l17979"></a>17979             }
<a name="l17980"></a>17980             <span class="keywordflow">default</span>: {
<a name="l17981"></a>17981                 $this-&gt;Error(<span class="stringliteral">&#39;Incorrect visibility: &#39;</span>.$v);
<a name="l17982"></a>17982                 <span class="keywordflow">break</span>;
<a name="l17983"></a>17983             }
<a name="l17984"></a>17984         }
<a name="l17985"></a>17985     }
<a name="l17986"></a>17986 <span class="comment"></span>
<a name="l17987"></a>17987 <span class="comment">    /**</span>
<a name="l17988"></a>17988 <span class="comment">     * Add transparency parameters to the current extgstate</span>
<a name="l17989"></a>17989 <span class="comment">     * @param $parms (array) parameters</span>
<a name="l17990"></a>17990 <span class="comment">     * @return the number of extgstates</span>
<a name="l17991"></a>17991 <span class="comment">     * @protected</span>
<a name="l17992"></a>17992 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l17993"></a>17993 <span class="comment">     */</span>
<a name="l17994"></a><a class="code" href="classTCPDF.html#a4e9c60bd295bc60a66d7c6492072d1ef">17994</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4e9c60bd295bc60a66d7c6492072d1ef" title="Add transparency parameters to the current extgstate.">addExtGState</a>($parms) {
<a name="l17995"></a>17995         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l17996"></a>17996             <span class="comment">// transparencies are not allowed in PDF/A mode</span>
<a name="l17997"></a>17997             <span class="keywordflow">return</span>;
<a name="l17998"></a>17998         }
<a name="l17999"></a>17999         <span class="comment">// check if this ExtGState already exist</span>
<a name="l18000"></a>18000         <span class="keywordflow">foreach</span> ($this-&gt;extgstates as <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> =&gt; $ext) {
<a name="l18001"></a>18001             <span class="keywordflow">if</span> ($ext[<span class="stringliteral">&#39;parms&#39;</span>] == $parms) {
<a name="l18002"></a>18002                 <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l18003"></a>18003                     <span class="comment">// we are inside an XObject template</span>
<a name="l18004"></a>18004                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;extgstates&#39;</span>][<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $ext;
<a name="l18005"></a>18005                 }
<a name="l18006"></a>18006                 <span class="comment">// return reference to existing ExtGState</span>
<a name="l18007"></a>18007                 <span class="keywordflow">return</span> <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l18008"></a>18008             }
<a name="l18009"></a>18009         }
<a name="l18010"></a>18010         $n = (count($this-&gt;extgstates) + 1);
<a name="l18011"></a>18011         $this-&gt;extgstates[$n] = array(<span class="stringliteral">&#39;parms&#39;</span> =&gt; $parms);
<a name="l18012"></a>18012         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l18013"></a>18013             <span class="comment">// we are inside an XObject template</span>
<a name="l18014"></a>18014             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;extgstates&#39;</span>][$n] = $this-&gt;extgstates[$n];
<a name="l18015"></a>18015         }
<a name="l18016"></a>18016         <span class="keywordflow">return</span> $n;
<a name="l18017"></a>18017     }
<a name="l18018"></a>18018 <span class="comment"></span>
<a name="l18019"></a>18019 <span class="comment">    /**</span>
<a name="l18020"></a>18020 <span class="comment">     * Add an extgstate</span>
<a name="l18021"></a>18021 <span class="comment">     * @param $gs (array) extgstate</span>
<a name="l18022"></a>18022 <span class="comment">     * @protected</span>
<a name="l18023"></a>18023 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l18024"></a>18024 <span class="comment">     */</span>
<a name="l18025"></a><a class="code" href="classTCPDF.html#adfc2d921b91adad5a68441245ddb2180">18025</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#adfc2d921b91adad5a68441245ddb2180" title="Add an extgstate.">setExtGState</a>($gs) {
<a name="l18026"></a>18026         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l18027"></a>18027             <span class="comment">// transparency is not allowed in PDF/A mode</span>
<a name="l18028"></a>18028             <span class="keywordflow">return</span>;
<a name="l18029"></a>18029         }
<a name="l18030"></a>18030         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;/GS%d gs&#39;</span>, $gs));
<a name="l18031"></a>18031     }
<a name="l18032"></a>18032 <span class="comment"></span>
<a name="l18033"></a>18033 <span class="comment">    /**</span>
<a name="l18034"></a>18034 <span class="comment">     * Put extgstates for object transparency</span>
<a name="l18035"></a>18035 <span class="comment">     * @protected</span>
<a name="l18036"></a>18036 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l18037"></a>18037 <span class="comment">     */</span>
<a name="l18038"></a><a class="code" href="classTCPDF.html#a5bbbb689c42b3173b755c08cf9c0b58d">18038</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5bbbb689c42b3173b755c08cf9c0b58d" title="Put extgstates for object transparency.">_putextgstates</a>() {
<a name="l18039"></a>18039         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l18040"></a>18040             <span class="comment">// transparencies are not allowed in PDF/A mode</span>
<a name="l18041"></a>18041             <span class="keywordflow">return</span>;
<a name="l18042"></a>18042         }
<a name="l18043"></a>18043         <span class="keywordflow">foreach</span> ($this-&gt;extgstates as <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> =&gt; $ext) {
<a name="l18044"></a>18044             $this-&gt;extgstates[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="charliteral">&#39;n&#39;</span>] = $this-&gt;_newobj();
<a name="l18045"></a>18045             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /ExtGState&#39;</span>;
<a name="l18046"></a>18046             <span class="keywordflow">foreach</span> ($ext[<span class="stringliteral">&#39;parms&#39;</span>] as $k =&gt; $v) {
<a name="l18047"></a>18047                 <span class="keywordflow">if</span> (is_float($v)) {
<a name="l18048"></a>18048                     $v = sprintf(<span class="stringliteral">&#39;%.2F&#39;</span>, $v);
<a name="l18049"></a>18049                 }
<a name="l18050"></a>18050                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /&#39;</span>.$k.<span class="charliteral">&#39; &#39;</span>.$v;
<a name="l18051"></a>18051             }
<a name="l18052"></a>18052             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18053"></a>18053             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18054"></a>18054             $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18055"></a>18055         }
<a name="l18056"></a>18056     }
<a name="l18057"></a>18057 <span class="comment"></span>
<a name="l18058"></a>18058 <span class="comment">    /**</span>
<a name="l18059"></a>18059 <span class="comment">     * Set alpha for stroking (CA) and non-stroking (ca) operations.</span>
<a name="l18060"></a>18060 <span class="comment">     * @param $alpha (float) real value from 0 (transparent) to 1 (opaque)</span>
<a name="l18061"></a>18061 <span class="comment">     * @param $bm (string) blend mode, one of the following: Normal, Multiply, Screen, Overlay, Darken, Lighten, ColorDodge, ColorBurn, HardLight, SoftLight, Difference, Exclusion, Hue, Saturation, Color, Luminosity</span>
<a name="l18062"></a>18062 <span class="comment">     * @public</span>
<a name="l18063"></a>18063 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l18064"></a>18064 <span class="comment">     */</span>
<a name="l18065"></a><a class="code" href="classTCPDF.html#a70b698e5d006a0974431902c5d8f697a">18065</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a70b698e5d006a0974431902c5d8f697a" title="Set alpha for stroking (CA) and non-stroking (ca) operations.">setAlpha</a>($alpha, $bm=<span class="stringliteral">&#39;Normal&#39;</span>) {
<a name="l18066"></a>18066         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l18067"></a>18067             <span class="comment">// transparency is not allowed in PDF/A mode</span>
<a name="l18068"></a>18068             <span class="keywordflow">return</span>;
<a name="l18069"></a>18069         }
<a name="l18070"></a>18070         $gs = $this-&gt;addExtGState(array(<span class="stringliteral">&#39;ca&#39;</span> =&gt; $alpha, <span class="stringliteral">&#39;CA&#39;</span> =&gt; $alpha, <span class="stringliteral">&#39;BM&#39;</span> =&gt; <span class="charliteral">&#39;/&#39;</span>.$bm, <span class="stringliteral">&#39;AIS&#39;</span> =&gt; <span class="stringliteral">&#39;false&#39;</span>));
<a name="l18071"></a>18071         $this-&gt;setExtGState($gs);
<a name="l18072"></a>18072     }
<a name="l18073"></a>18073 <span class="comment"></span>
<a name="l18074"></a>18074 <span class="comment">    /**</span>
<a name="l18075"></a>18075 <span class="comment">     * Set the default JPEG compression quality (1-100)</span>
<a name="l18076"></a>18076 <span class="comment">     * @param $quality (int) JPEG quality, integer between 1 and 100</span>
<a name="l18077"></a>18077 <span class="comment">     * @public</span>
<a name="l18078"></a>18078 <span class="comment">     * @since 3.0.000 (2008-03-27)</span>
<a name="l18079"></a>18079 <span class="comment">     */</span>
<a name="l18080"></a><a class="code" href="classTCPDF.html#a06a80145927b40683b26d9013ec8d3c6">18080</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a06a80145927b40683b26d9013ec8d3c6" title="Set the default JPEG compression quality (1-100)">setJPEGQuality</a>($quality) {
<a name="l18081"></a>18081         <span class="keywordflow">if</span> (($quality &lt; 1) OR ($quality &gt; 100)) {
<a name="l18082"></a>18082             $quality = 75;
<a name="l18083"></a>18083         }
<a name="l18084"></a>18084         $this-&gt;jpeg_quality = intval($quality);
<a name="l18085"></a>18085     }
<a name="l18086"></a>18086 <span class="comment"></span>
<a name="l18087"></a>18087 <span class="comment">    /**</span>
<a name="l18088"></a>18088 <span class="comment">     * Set the default number of columns in a row for HTML tables.</span>
<a name="l18089"></a>18089 <span class="comment">     * @param $cols (int) number of columns</span>
<a name="l18090"></a>18090 <span class="comment">     * @public</span>
<a name="l18091"></a>18091 <span class="comment">     * @since 3.0.014 (2008-06-04)</span>
<a name="l18092"></a>18092 <span class="comment">     */</span>
<a name="l18093"></a><a class="code" href="classTCPDF.html#a77e62aa96deef4fed708e97c11cbac05">18093</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a77e62aa96deef4fed708e97c11cbac05" title="Set the default number of columns in a row for HTML tables.">setDefaultTableColumns</a>($cols=4) {
<a name="l18094"></a>18094         $this-&gt;default_table_columns = intval($cols);
<a name="l18095"></a>18095     }
<a name="l18096"></a>18096 <span class="comment"></span>
<a name="l18097"></a>18097 <span class="comment">    /**</span>
<a name="l18098"></a>18098 <span class="comment">     * Set the height of the cell (line height) respect the font height.</span>
<a name="l18099"></a>18099 <span class="comment">     * @param $h (int) cell proportion respect font height (typical value = 1.25).</span>
<a name="l18100"></a>18100 <span class="comment">     * @public</span>
<a name="l18101"></a>18101 <span class="comment">     * @since 3.0.014 (2008-06-04)</span>
<a name="l18102"></a>18102 <span class="comment">     */</span>
<a name="l18103"></a><a class="code" href="classTCPDF.html#a90ad3198737e6fead5791fa317a8a1f0">18103</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a90ad3198737e6fead5791fa317a8a1f0" title="Set the height of the cell (line height) respect the font height.">setCellHeightRatio</a>(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>) {
<a name="l18104"></a>18104         $this-&gt;cell_height_ratio = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l18105"></a>18105     }
<a name="l18106"></a>18106 <span class="comment"></span>
<a name="l18107"></a>18107 <span class="comment">    /**</span>
<a name="l18108"></a>18108 <span class="comment">     * return the height of cell repect font height.</span>
<a name="l18109"></a>18109 <span class="comment">     * @public</span>
<a name="l18110"></a>18110 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l18111"></a>18111 <span class="comment">     */</span>
<a name="l18112"></a><a class="code" href="classTCPDF.html#a6e29d82b9a9e318c703370ec474499ad">18112</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6e29d82b9a9e318c703370ec474499ad" title="return the height of cell repect font height.">getCellHeightRatio</a>() {
<a name="l18113"></a>18113         <span class="keywordflow">return</span> $this-&gt;cell_height_ratio;
<a name="l18114"></a>18114     }
<a name="l18115"></a>18115 <span class="comment"></span>
<a name="l18116"></a>18116 <span class="comment">    /**</span>
<a name="l18117"></a>18117 <span class="comment">     * Set the PDF version (check PDF reference for valid values).</span>
<a name="l18118"></a>18118 <span class="comment">     * @param $version (string) PDF document version.</span>
<a name="l18119"></a>18119 <span class="comment">     * @public</span>
<a name="l18120"></a>18120 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18121"></a>18121 <span class="comment">     */</span>
<a name="l18122"></a><a class="code" href="classTCPDF.html#a2803ddf7b83704355bcf1225f06cfcbb">18122</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2803ddf7b83704355bcf1225f06cfcbb" title="Set the PDF version (check PDF reference for valid values).">setPDFVersion</a>($version=<span class="stringliteral">&#39;1.7&#39;</span>) {
<a name="l18123"></a>18123         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l18124"></a>18124             <span class="comment">// PDF/A mode</span>
<a name="l18125"></a>18125             $this-&gt;PDFVersion = <span class="stringliteral">&#39;1.4&#39;</span>;
<a name="l18126"></a>18126         } <span class="keywordflow">else</span> {
<a name="l18127"></a>18127             $this-&gt;PDFVersion = $version;
<a name="l18128"></a>18128         }
<a name="l18129"></a>18129     }
<a name="l18130"></a>18130 <span class="comment"></span>
<a name="l18131"></a>18131 <span class="comment">    /**</span>
<a name="l18132"></a>18132 <span class="comment">     * Set the viewer preferences dictionary controlling the way the document is to be presented on the screen or in print.</span>
<a name="l18133"></a>18133 <span class="comment">     * (see Section 8.1 of PDF reference, &quot;Viewer Preferences&quot;).</span>
<a name="l18134"></a>18134 <span class="comment">     * &lt;ul&gt;&lt;li&gt;HideToolbar boolean (Optional) A flag specifying whether to hide the viewer application&#39;s tool bars when the document is active. Default value: false.&lt;/li&gt;&lt;li&gt;HideMenubar boolean (Optional) A flag specifying whether to hide the viewer application&#39;s menu bar when the document is active. Default value: false.&lt;/li&gt;&lt;li&gt;HideWindowUI boolean (Optional) A flag specifying whether to hide user interface elements in the document&#39;s window (such as scroll bars and navigation controls), leaving only the document&#39;s contents displayed. Default value: false.&lt;/li&gt;&lt;li&gt;FitWindow boolean (Optional) A flag specifying whether to resize the document&#39;s window to fit the size of the first displayed page. Default value: false.&lt;/li&gt;&lt;li&gt;CenterWindow boolean (Optional) A flag specifying whether to position the document&#39;s window in the center of the screen. Default value: false.&lt;/li&gt;&lt;li&gt;DisplayDocTitle boolean (Optional; PDF 1.4) A flag specifying whether the window&#39;s title bar should display the document title taken from the Title entry of the document information dictionary (see Section 10.2.1, &quot;Document Information Dictionary&quot;). If false, the title bar should instead display the name of the PDF file containing the document. Default value: false.&lt;/li&gt;&lt;li&gt;NonFullScreenPageMode name (Optional) The document&#39;s page mode, specifying how to display the document on exiting full-screen mode:&lt;ul&gt;&lt;li&gt;UseNone Neither document outline nor thumbnail images visible&lt;/li&gt;&lt;li&gt;UseOutlines Document outline visible&lt;/li&gt;&lt;li&gt;UseThumbs Thumbnail images visible&lt;/li&gt;&lt;li&gt;UseOC Optional content group panel visible&lt;/li&gt;&lt;/ul&gt;This entry is meaningful only if the value of the PageMode entry in the catalog dictionary (see Section 3.6.1, &quot;Document Catalog&quot;) is FullScreen; it is ignored otherwise. Default value: UseNone.&lt;/li&gt;&lt;li&gt;ViewArea name (Optional; PDF 1.4) The name of the page boundary representing the area of a page to be displayed when viewing the document on the screen. Valid values are (see Section 10.10.1, &quot;Page Boundaries&quot;).:&lt;ul&gt;&lt;li&gt;MediaBox&lt;/li&gt;&lt;li&gt;CropBox (default)&lt;/li&gt;&lt;li&gt;BleedBox&lt;/li&gt;&lt;li&gt;TrimBox&lt;/li&gt;&lt;li&gt;ArtBox&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;ViewClip name (Optional; PDF 1.4) The name of the page boundary to which the contents of a page are to be clipped when viewing the document on the screen. Valid values are (see Section 10.10.1, &quot;Page Boundaries&quot;).:&lt;ul&gt;&lt;li&gt;MediaBox&lt;/li&gt;&lt;li&gt;CropBox (default)&lt;/li&gt;&lt;li&gt;BleedBox&lt;/li&gt;&lt;li&gt;TrimBox&lt;/li&gt;&lt;li&gt;ArtBox&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;PrintArea name (Optional; PDF 1.4) The name of the page boundary representing the area of a page to be rendered when printing the document. Valid values are (see Section 10.10.1, &quot;Page Boundaries&quot;).:&lt;ul&gt;&lt;li&gt;MediaBox&lt;/li&gt;&lt;li&gt;CropBox (default)&lt;/li&gt;&lt;li&gt;BleedBox&lt;/li&gt;&lt;li&gt;TrimBox&lt;/li&gt;&lt;li&gt;ArtBox&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;PrintClip name (Optional; PDF 1.4) The name of the page boundary to which the contents of a page are to be clipped when printing the document. Valid values are (see Section 10.10.1, &quot;Page Boundaries&quot;).:&lt;ul&gt;&lt;li&gt;MediaBox&lt;/li&gt;&lt;li&gt;CropBox (default)&lt;/li&gt;&lt;li&gt;BleedBox&lt;/li&gt;&lt;li&gt;TrimBox&lt;/li&gt;&lt;li&gt;ArtBox&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;PrintScaling name (Optional; PDF 1.6) The page scaling option to be selected when a print dialog is displayed for this document. Valid values are: &lt;ul&gt;&lt;li&gt;None, which indicates that the print dialog should reflect no page scaling&lt;/li&gt;&lt;li&gt;AppDefault (default), which indicates that applications should use the current print scaling&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;Duplex name (Optional; PDF 1.7) The paper handling option to use when printing the file from the print dialog. The following values are valid:&lt;ul&gt;&lt;li&gt;Simplex - Print single-sided&lt;/li&gt;&lt;li&gt;DuplexFlipShortEdge - Duplex and flip on the short edge of the sheet&lt;/li&gt;&lt;li&gt;DuplexFlipLongEdge - Duplex and flip on the long edge of the sheet&lt;/li&gt;&lt;/ul&gt;Default value: none&lt;/li&gt;&lt;li&gt;PickTrayByPDFSize boolean (Optional; PDF 1.7) A flag specifying whether the PDF page size is used to select the input paper tray. This setting influences only the preset values used to populate the print dialog presented by a PDF viewer application. If PickTrayByPDFSize is true, the check box in the print dialog associated with input paper tray is checked. Note: This setting has no effect on Mac OS systems, which do not provide the ability to pick the input tray by size.&lt;/li&gt;&lt;li&gt;PrintPageRange array (Optional; PDF 1.7) The page numbers used to initialize the print dialog box when the file is printed. The first page of the PDF file is denoted by 1. Each pair consists of the first and last pages in the sub-range. An odd number of integers causes this entry to be ignored. Negative numbers cause the entire array to be ignored. Default value: as defined by PDF viewer application&lt;/li&gt;&lt;li&gt;NumCopies integer (Optional; PDF 1.7) The number of copies to be printed when the print dialog is opened for this file. Supported values are the integers 2 through 5. Values outside this range are ignored. Default value: as defined by PDF viewer application, but typically 1&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l18135"></a>18135 <span class="comment">     * @param $preferences (array) array of options.</span>
<a name="l18136"></a>18136 <span class="comment">     * @author Nicola Asuni</span>
<a name="l18137"></a>18137 <span class="comment">     * @public</span>
<a name="l18138"></a>18138 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18139"></a>18139 <span class="comment">     */</span>
<a name="l18140"></a><a class="code" href="classTCPDF.html#ad09b32089f8e68c9d8424a2777627c21">18140</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad09b32089f8e68c9d8424a2777627c21" title="Set the viewer preferences dictionary controlling the way the document is to be presented on the scre...">setViewerPreferences</a>($preferences) {
<a name="l18141"></a>18141         $this-&gt;viewer_preferences = $preferences;
<a name="l18142"></a>18142     }
<a name="l18143"></a>18143 <span class="comment"></span>
<a name="l18144"></a>18144 <span class="comment">    /**</span>
<a name="l18145"></a>18145 <span class="comment">     * Paints color transition registration bars</span>
<a name="l18146"></a>18146 <span class="comment">     * @param $x (float) abscissa of the top left corner of the rectangle.</span>
<a name="l18147"></a>18147 <span class="comment">     * @param $y (float) ordinate of the top left corner of the rectangle.</span>
<a name="l18148"></a>18148 <span class="comment">     * @param $w (float) width of the rectangle.</span>
<a name="l18149"></a>18149 <span class="comment">     * @param $h (float) height of the rectangle.</span>
<a name="l18150"></a>18150 <span class="comment">     * @param $transition (boolean) if true prints tcolor transitions to white.</span>
<a name="l18151"></a>18151 <span class="comment">     * @param $vertical (boolean) if true prints bar vertically.</span>
<a name="l18152"></a>18152 <span class="comment">     * @param $colors (string) colors to print, one letter per color separated by comma (for example &#39;A,W,R,G,B,C,M,Y,K&#39;): A=black, W=white, R=red, G=green, B=blue, C=cyan, M=magenta, Y=yellow, K=black.</span>
<a name="l18153"></a>18153 <span class="comment">     * @author Nicola Asuni</span>
<a name="l18154"></a>18154 <span class="comment">     * @since 4.9.000 (2010-03-26)</span>
<a name="l18155"></a>18155 <span class="comment">     * @public</span>
<a name="l18156"></a>18156 <span class="comment">     */</span>
<a name="l18157"></a><a class="code" href="classTCPDF.html#a1d91b56a9679cf395342ad0b6c2a4191">18157</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1d91b56a9679cf395342ad0b6c2a4191" title="Paints color transition registration bars.">colorRegistrationBar</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $transition=<span class="keyword">true</span>, $vertical=<span class="keyword">false</span>, $colors=<span class="stringliteral">&#39;A,R,G,B,C,M,Y,K&#39;</span>) {
<a name="l18158"></a>18158         $bars = explode(<span class="charliteral">&#39;,&#39;</span>, $colors);
<a name="l18159"></a>18159         $numbars = count($bars); <span class="comment">// number of bars to print</span>
<a name="l18160"></a>18160         <span class="comment">// set bar measures</span>
<a name="l18161"></a>18161         <span class="keywordflow">if</span> ($vertical) {
<a name="l18162"></a>18162             $coords = array(0, 0, 0, 1);
<a name="l18163"></a>18163             $wb = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> / $numbars; <span class="comment">// bar width</span>
<a name="l18164"></a>18164             $hb = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>; <span class="comment">// bar height</span>
<a name="l18165"></a>18165             $xd = $wb; <span class="comment">// delta x</span>
<a name="l18166"></a>18166             $yd = 0; <span class="comment">// delta y</span>
<a name="l18167"></a>18167         } <span class="keywordflow">else</span> {
<a name="l18168"></a>18168             $coords = array(1, 0, 0, 0);
<a name="l18169"></a>18169             $wb = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>; <span class="comment">// bar width</span>
<a name="l18170"></a>18170             $hb = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> / $numbars; <span class="comment">// bar height</span>
<a name="l18171"></a>18171             $xd = 0; <span class="comment">// delta x</span>
<a name="l18172"></a>18172             $yd = $hb; <span class="comment">// delta y</span>
<a name="l18173"></a>18173         }
<a name="l18174"></a>18174         $xb = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l18175"></a>18175         $yb = $y;
<a name="l18176"></a>18176         <span class="keywordflow">foreach</span> ($bars as <a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>) {
<a name="l18177"></a>18177             <span class="keywordflow">switch</span> ($col) {
<a name="l18178"></a>18178                 <span class="comment">// set transition colors</span>
<a name="l18179"></a>18179                 <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: { <span class="comment">// BLACK</span>
<a name="l18180"></a>18180                     $col_a = array(255);
<a name="l18181"></a>18181                     $col_b = array(0);
<a name="l18182"></a>18182                     <span class="keywordflow">break</span>;
<a name="l18183"></a>18183                 }
<a name="l18184"></a>18184                 <span class="keywordflow">case</span> <span class="charliteral">&#39;W&#39;</span>: { <span class="comment">// WHITE</span>
<a name="l18185"></a>18185                     $col_a = array(0);
<a name="l18186"></a>18186                     $col_b = array(255);
<a name="l18187"></a>18187                     <span class="keywordflow">break</span>;
<a name="l18188"></a>18188                 }
<a name="l18189"></a>18189                 <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: { <span class="comment">// R</span>
<a name="l18190"></a>18190                     $col_a = array(255,255,255);
<a name="l18191"></a>18191                     $col_b = array(255,0,0);
<a name="l18192"></a>18192                     <span class="keywordflow">break</span>;
<a name="l18193"></a>18193                 }
<a name="l18194"></a>18194                 <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>: { <span class="comment">// G</span>
<a name="l18195"></a>18195                     $col_a = array(255,255,255);
<a name="l18196"></a>18196                     $col_b = array(0,255,0);
<a name="l18197"></a>18197                     <span class="keywordflow">break</span>;
<a name="l18198"></a>18198                 }
<a name="l18199"></a>18199                 <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: { <span class="comment">// B</span>
<a name="l18200"></a>18200                     $col_a = array(255,255,255);
<a name="l18201"></a>18201                     $col_b = array(0,0,255);
<a name="l18202"></a>18202                     <span class="keywordflow">break</span>;
<a name="l18203"></a>18203                 }
<a name="l18204"></a>18204                 <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: { <span class="comment">// C</span>
<a name="l18205"></a>18205                     $col_a = array(0,0,0,0);
<a name="l18206"></a>18206                     $col_b = array(100,0,0,0);
<a name="l18207"></a>18207                     <span class="keywordflow">break</span>;
<a name="l18208"></a>18208                 }
<a name="l18209"></a>18209                 <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: { <span class="comment">// M</span>
<a name="l18210"></a>18210                     $col_a = array(0,0,0,0);
<a name="l18211"></a>18211                     $col_b = array(0,100,0,0);
<a name="l18212"></a>18212                     <span class="keywordflow">break</span>;
<a name="l18213"></a>18213                 }
<a name="l18214"></a>18214                 <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>: { <span class="comment">// Y</span>
<a name="l18215"></a>18215                     $col_a = array(0,0,0,0);
<a name="l18216"></a>18216                     $col_b = array(0,0,100,0);
<a name="l18217"></a>18217                     <span class="keywordflow">break</span>;
<a name="l18218"></a>18218                 }
<a name="l18219"></a>18219                 <span class="keywordflow">case</span> <span class="charliteral">&#39;K&#39;</span>: { <span class="comment">// K</span>
<a name="l18220"></a>18220                     $col_a = array(0,0,0,0);
<a name="l18221"></a>18221                     $col_b = array(0,0,0,100);
<a name="l18222"></a>18222                     <span class="keywordflow">break</span>;
<a name="l18223"></a>18223                 }
<a name="l18224"></a>18224                 <span class="keywordflow">default</span>: { <span class="comment">// GRAY</span>
<a name="l18225"></a>18225                     $col_a = array(255);
<a name="l18226"></a>18226                     $col_b = array(0);
<a name="l18227"></a>18227                     <span class="keywordflow">break</span>;
<a name="l18228"></a>18228                 }
<a name="l18229"></a>18229             }
<a name="l18230"></a>18230             <span class="keywordflow">if</span> ($transition) {
<a name="l18231"></a>18231                 <span class="comment">// color gradient</span>
<a name="l18232"></a>18232                 $this-&gt;LinearGradient($xb, $yb, $wb, $hb, $col_a, $col_b, $coords);
<a name="l18233"></a>18233             } <span class="keywordflow">else</span> {
<a name="l18234"></a>18234                 <span class="comment">// color rectangle</span>
<a name="l18235"></a>18235                 $this-&gt;SetFillColorArray($col_b);
<a name="l18236"></a>18236                 $this-&gt;Rect($xb, $yb, $wb, $hb, <span class="charliteral">&#39;F&#39;</span>, array());
<a name="l18237"></a>18237             }
<a name="l18238"></a>18238             $xb += $xd;
<a name="l18239"></a>18239             $yb += $yd;
<a name="l18240"></a>18240         }
<a name="l18241"></a>18241     }
<a name="l18242"></a>18242 <span class="comment"></span>
<a name="l18243"></a>18243 <span class="comment">    /**</span>
<a name="l18244"></a>18244 <span class="comment">     * Paints crop marks.</span>
<a name="l18245"></a>18245 <span class="comment">     * @param $x (float) abscissa of the crop mark center.</span>
<a name="l18246"></a>18246 <span class="comment">     * @param $y (float) ordinate of the crop mark center.</span>
<a name="l18247"></a>18247 <span class="comment">     * @param $w (float) width of the crop mark.</span>
<a name="l18248"></a>18248 <span class="comment">     * @param $h (float) height of the crop mark.</span>
<a name="l18249"></a>18249 <span class="comment">     * @param $type (string) type of crop mark, one symbol per type separated by comma: T = TOP, F = BOTTOM, L = LEFT, R = RIGHT, TL = A = TOP-LEFT, TR = B = TOP-RIGHT, BL = C = BOTTOM-LEFT, BR = D = BOTTOM-RIGHT.</span>
<a name="l18250"></a>18250 <span class="comment">     * @param $color (array) crop mark color (default black).</span>
<a name="l18251"></a>18251 <span class="comment">     * @author Nicola Asuni</span>
<a name="l18252"></a>18252 <span class="comment">     * @since 4.9.000 (2010-03-26)</span>
<a name="l18253"></a>18253 <span class="comment">     * @public</span>
<a name="l18254"></a>18254 <span class="comment">     */</span>
<a name="l18255"></a><a class="code" href="classTCPDF.html#a1ea84b5dd5a8bdf23a00b51c3eacd167">18255</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1ea84b5dd5a8bdf23a00b51c3eacd167" title="Paints crop marks.">cropMark</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>=<span class="stringliteral">&#39;T,R,B,L&#39;</span>, $color=array(0,0,0)) {
<a name="l18256"></a>18256         $this-&gt;SetLineStyle(array(<span class="stringliteral">&#39;width&#39;</span> =&gt; (0.5 / $this-&gt;k), <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; $color));
<a name="l18257"></a>18257         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = strtoupper(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18258"></a>18258         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = preg_replace(<span class="stringliteral">&#39;/[^A-Z\-\,]*/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18259"></a>18259         <span class="comment">// split type in single components</span>
<a name="l18260"></a>18260         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;,&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18261"></a>18261         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="stringliteral">&#39;TL&#39;</span>, <span class="stringliteral">&#39;T,L&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18262"></a>18262         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="stringliteral">&#39;TR&#39;</span>, <span class="stringliteral">&#39;T,R&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18263"></a>18263         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="stringliteral">&#39;BL&#39;</span>, <span class="stringliteral">&#39;F,L&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18264"></a>18264         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="stringliteral">&#39;BR&#39;</span>, <span class="stringliteral">&#39;F,R&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18265"></a>18265         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="charliteral">&#39;A&#39;</span>, <span class="stringliteral">&#39;T,L&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18266"></a>18266         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="charliteral">&#39;B&#39;</span>, <span class="stringliteral">&#39;T,R&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18267"></a>18267         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="stringliteral">&#39;T,RO&#39;</span>, <span class="stringliteral">&#39;BO&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18268"></a>18268         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="charliteral">&#39;C&#39;</span>, <span class="stringliteral">&#39;F,L&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18269"></a>18269         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = str_replace(<span class="charliteral">&#39;D&#39;</span>, <span class="stringliteral">&#39;F,R&#39;</span>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l18270"></a>18270         $crops = explode(<span class="charliteral">&#39;,&#39;</span>, strtoupper(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>));
<a name="l18271"></a>18271         <span class="comment">// remove duplicates</span>
<a name="l18272"></a>18272         $crops = array_unique($crops);
<a name="l18273"></a>18273         <a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a> = (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> / 4); <span class="comment">// horizontal space to leave before the intersection point</span>
<a name="l18274"></a>18274         $dh = (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> / 4); <span class="comment">// vertical space to leave before the intersection point</span>
<a name="l18275"></a>18275         <span class="keywordflow">foreach</span> ($crops as $crop) {
<a name="l18276"></a>18276             <span class="keywordflow">switch</span> ($crop) {
<a name="l18277"></a>18277                 <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:
<a name="l18278"></a>18278                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;TOP&#39;</span>: {
<a name="l18279"></a>18279                     $x1 = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l18280"></a>18280                     $y1 = ($y - <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l18281"></a>18281                     $x2 = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l18282"></a>18282                     $y2 = ($y - $dh);
<a name="l18283"></a>18283                     <span class="keywordflow">break</span>;
<a name="l18284"></a>18284                 }
<a name="l18285"></a>18285                 <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>:
<a name="l18286"></a>18286                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;BOTTOM&#39;</span>: {
<a name="l18287"></a>18287                     $x1 = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l18288"></a>18288                     $y1 = ($y + $dh);
<a name="l18289"></a>18289                     $x2 = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l18290"></a>18290                     $y2 = ($y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l18291"></a>18291                     <span class="keywordflow">break</span>;
<a name="l18292"></a>18292                 }
<a name="l18293"></a>18293                 <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:
<a name="l18294"></a>18294                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;LEFT&#39;</span>: {
<a name="l18295"></a>18295                     $x1 = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>);
<a name="l18296"></a>18296                     $y1 = $y;
<a name="l18297"></a>18297                     $x2 = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - <a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a>);
<a name="l18298"></a>18298                     $y2 = $y;
<a name="l18299"></a>18299                     <span class="keywordflow">break</span>;
<a name="l18300"></a>18300                 }
<a name="l18301"></a>18301                 <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:
<a name="l18302"></a>18302                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;RIGHT&#39;</span>: {
<a name="l18303"></a>18303                     $x1 = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="dejavusans_8php.html#a86fe633d0fbced908132976178dc90d0">$dw</a>);
<a name="l18304"></a>18304                     $y1 = $y;
<a name="l18305"></a>18305                     $x2 = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>);
<a name="l18306"></a>18306                     $y2 = $y;
<a name="l18307"></a>18307                     <span class="keywordflow">break</span>;
<a name="l18308"></a>18308                 }
<a name="l18309"></a>18309             }
<a name="l18310"></a>18310             $this-&gt;Line($x1, $y1, $x2, $y2);
<a name="l18311"></a>18311         }
<a name="l18312"></a>18312     }
<a name="l18313"></a>18313 <span class="comment"></span>
<a name="l18314"></a>18314 <span class="comment">    /**</span>
<a name="l18315"></a>18315 <span class="comment">     * Paints a registration mark</span>
<a name="l18316"></a>18316 <span class="comment">     * @param $x (float) abscissa of the registration mark center.</span>
<a name="l18317"></a>18317 <span class="comment">     * @param $y (float) ordinate of the registration mark center.</span>
<a name="l18318"></a>18318 <span class="comment">     * @param $r (float) radius of the crop mark.</span>
<a name="l18319"></a>18319 <span class="comment">     * @param $double (boolean) if true print two concentric crop marks.</span>
<a name="l18320"></a>18320 <span class="comment">     * @param $cola (array) crop mark color (default black).</span>
<a name="l18321"></a>18321 <span class="comment">     * @param $colb (array) second crop mark color.</span>
<a name="l18322"></a>18322 <span class="comment">     * @author Nicola Asuni</span>
<a name="l18323"></a>18323 <span class="comment">     * @since 4.9.000 (2010-03-26)</span>
<a name="l18324"></a>18324 <span class="comment">     * @public</span>
<a name="l18325"></a>18325 <span class="comment">     */</span>
<a name="l18326"></a><a class="code" href="classTCPDF.html#a6f29209ac9000ff4f8b9d9afb1736607">18326</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6f29209ac9000ff4f8b9d9afb1736607" title="Paints a registration mark.">registrationMark</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $double=<span class="keyword">false</span>, $cola=array(0,0,0), $colb=array(255,255,255)) {
<a name="l18327"></a>18327         $line_style = array(<span class="stringliteral">&#39;width&#39;</span> =&gt; (0.5 / $this-&gt;k), <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; $cola);
<a name="l18328"></a>18328         $this-&gt;SetFillColorArray($cola);
<a name="l18329"></a>18329         $this-&gt;PieSector(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, 90, 180, <span class="charliteral">&#39;F&#39;</span>);
<a name="l18330"></a>18330         $this-&gt;PieSector(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, 270, 360, <span class="charliteral">&#39;F&#39;</span>);
<a name="l18331"></a>18331         $this-&gt;Circle(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, 0, 360, <span class="charliteral">&#39;C&#39;</span>, $line_style, array(), 8);
<a name="l18332"></a>18332         <span class="keywordflow">if</span> ($double) {
<a name="l18333"></a>18333             $r2 = <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> * 0.5;
<a name="l18334"></a>18334             $this-&gt;SetFillColorArray($colb);
<a name="l18335"></a>18335             $this-&gt;PieSector(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $r2, 90, 180, <span class="charliteral">&#39;F&#39;</span>);
<a name="l18336"></a>18336             $this-&gt;PieSector(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $r2, 270, 360, <span class="charliteral">&#39;F&#39;</span>);
<a name="l18337"></a>18337             $this-&gt;SetFillColorArray($cola);
<a name="l18338"></a>18338             $this-&gt;PieSector(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $r2, 0, 90, <span class="charliteral">&#39;F&#39;</span>);
<a name="l18339"></a>18339             $this-&gt;PieSector(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $r2, 180, 270, <span class="charliteral">&#39;F&#39;</span>);
<a name="l18340"></a>18340             $this-&gt;Circle(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $r2, 0, 360, <span class="charliteral">&#39;C&#39;</span>, $line_style, array(), 8);
<a name="l18341"></a>18341         }
<a name="l18342"></a>18342     }
<a name="l18343"></a>18343 <span class="comment"></span>
<a name="l18344"></a>18344 <span class="comment">    /**</span>
<a name="l18345"></a>18345 <span class="comment">     * Paints a linear colour gradient.</span>
<a name="l18346"></a>18346 <span class="comment">     * @param $x (float) abscissa of the top left corner of the rectangle.</span>
<a name="l18347"></a>18347 <span class="comment">     * @param $y (float) ordinate of the top left corner of the rectangle.</span>
<a name="l18348"></a>18348 <span class="comment">     * @param $w (float) width of the rectangle.</span>
<a name="l18349"></a>18349 <span class="comment">     * @param $h (float) height of the rectangle.</span>
<a name="l18350"></a>18350 <span class="comment">     * @param $col1 (array) first color (Grayscale, RGB or CMYK components).</span>
<a name="l18351"></a>18351 <span class="comment">     * @param $col2 (array) second color (Grayscale, RGB or CMYK components).</span>
<a name="l18352"></a>18352 <span class="comment">     * @param $coords (array) array of the form (x1, y1, x2, y2) which defines the gradient vector (see linear_gradient_coords.jpg). The default value is from left to right (x1=0, y1=0, x2=1, y2=0).</span>
<a name="l18353"></a>18353 <span class="comment">     * @author Andreas Würmser, Nicola Asuni</span>
<a name="l18354"></a>18354 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18355"></a>18355 <span class="comment">     * @public</span>
<a name="l18356"></a>18356 <span class="comment">     */</span>
<a name="l18357"></a><a class="code" href="classTCPDF.html#a16a896313dd8736178a90d367edb6f61">18357</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a16a896313dd8736178a90d367edb6f61" title="Paints a linear colour gradient.">LinearGradient</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $col1=array(), $col2=array(), $coords=array(0,0,1,0)) {
<a name="l18358"></a>18358         $this-&gt;Clip(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l18359"></a>18359         $this-&gt;Gradient(2, $coords, array(array(<span class="stringliteral">&#39;color&#39;</span> =&gt; $col1, <span class="stringliteral">&#39;offset&#39;</span> =&gt; 0, <span class="stringliteral">&#39;exponent&#39;</span> =&gt; 1), array(<span class="stringliteral">&#39;color&#39;</span> =&gt; $col2, <span class="stringliteral">&#39;offset&#39;</span> =&gt; 1, <span class="stringliteral">&#39;exponent&#39;</span> =&gt; 1)), array(), <span class="keyword">false</span>);
<a name="l18360"></a>18360     }
<a name="l18361"></a>18361 <span class="comment"></span>
<a name="l18362"></a>18362 <span class="comment">    /**</span>
<a name="l18363"></a>18363 <span class="comment">     * Paints a radial colour gradient.</span>
<a name="l18364"></a>18364 <span class="comment">     * @param $x (float) abscissa of the top left corner of the rectangle.</span>
<a name="l18365"></a>18365 <span class="comment">     * @param $y (float) ordinate of the top left corner of the rectangle.</span>
<a name="l18366"></a>18366 <span class="comment">     * @param $w (float) width of the rectangle.</span>
<a name="l18367"></a>18367 <span class="comment">     * @param $h (float) height of the rectangle.</span>
<a name="l18368"></a>18368 <span class="comment">     * @param $col1 (array) first color (Grayscale, RGB or CMYK components).</span>
<a name="l18369"></a>18369 <span class="comment">     * @param $col2 (array) second color (Grayscale, RGB or CMYK components).</span>
<a name="l18370"></a>18370 <span class="comment">     * @param $coords (array) array of the form (fx, fy, cx, cy, r) where (fx, fy) is the starting point of the gradient with color1, (cx, cy) is the center of the circle with color2, and r is the radius of the circle (see radial_gradient_coords.jpg). (fx, fy) should be inside the circle, otherwise some areas will not be defined.</span>
<a name="l18371"></a>18371 <span class="comment">     * @author Andreas Würmser, Nicola Asuni</span>
<a name="l18372"></a>18372 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18373"></a>18373 <span class="comment">     * @public</span>
<a name="l18374"></a>18374 <span class="comment">     */</span>
<a name="l18375"></a><a class="code" href="classTCPDF.html#aae83f746192e3b8d28bedefe664b6c6d">18375</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aae83f746192e3b8d28bedefe664b6c6d" title="Paints a radial colour gradient.">RadialGradient</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $col1=array(), $col2=array(), $coords=array(0.5,0.5,0.5,0.5,1)) {
<a name="l18376"></a>18376         $this-&gt;Clip(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l18377"></a>18377         $this-&gt;Gradient(3, $coords, array(array(<span class="stringliteral">&#39;color&#39;</span> =&gt; $col1, <span class="stringliteral">&#39;offset&#39;</span> =&gt; 0, <span class="stringliteral">&#39;exponent&#39;</span> =&gt; 1), array(<span class="stringliteral">&#39;color&#39;</span> =&gt; $col2, <span class="stringliteral">&#39;offset&#39;</span> =&gt; 1, <span class="stringliteral">&#39;exponent&#39;</span> =&gt; 1)), array(), <span class="keyword">false</span>);
<a name="l18378"></a>18378     }
<a name="l18379"></a>18379 <span class="comment"></span>
<a name="l18380"></a>18380 <span class="comment">    /**</span>
<a name="l18381"></a>18381 <span class="comment">     * Paints a coons patch mesh.</span>
<a name="l18382"></a>18382 <span class="comment">     * @param $x (float) abscissa of the top left corner of the rectangle.</span>
<a name="l18383"></a>18383 <span class="comment">     * @param $y (float) ordinate of the top left corner of the rectangle.</span>
<a name="l18384"></a>18384 <span class="comment">     * @param $w (float) width of the rectangle.</span>
<a name="l18385"></a>18385 <span class="comment">     * @param $h (float) height of the rectangle.</span>
<a name="l18386"></a>18386 <span class="comment">     * @param $col1 (array) first color (lower left corner) (RGB components).</span>
<a name="l18387"></a>18387 <span class="comment">     * @param $col2 (array) second color (lower right corner) (RGB components).</span>
<a name="l18388"></a>18388 <span class="comment">     * @param $col3 (array) third color (upper right corner) (RGB components).</span>
<a name="l18389"></a>18389 <span class="comment">     * @param $col4 (array) fourth color (upper left corner) (RGB components).</span>
<a name="l18390"></a>18390 <span class="comment">     * @param $coords (array) &lt;ul&gt;&lt;li&gt;for one patch mesh: array(float x1, float y1, .... float x12, float y12): 12 pairs of coordinates (normally from 0 to 1) which specify the Bezier control points that define the patch. First pair is the lower left edge point, next is its right control point (control point 2). Then the other points are defined in the order: control point 1, edge point, control point 2 going counter-clockwise around the patch. Last (x12, y12) is the first edge point&#39;s left control point (control point 1).&lt;/li&gt;&lt;li&gt;for two or more patch meshes: array[number of patches]: arrays with the following keys for each patch: f: where to put that patch (0 = first patch, 1, 2, 3 = right, top and left of precedent patch - I didn&#39;t figure this out completely - just try and error ;-) points: 12 pairs of coordinates of the Bezier control points as above for the first patch, 8 pairs of coordinates for the following patches, ignoring the coordinates already defined by the precedent patch (I also didn&#39;t figure out the order of these - also: try and see what&#39;s happening) colors: must be 4 colors for the first patch, 2 colors for the following patches&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l18391"></a>18391 <span class="comment">     * @param $coords_min (array) minimum value used by the coordinates. If a coordinate&#39;s value is smaller than this it will be cut to coords_min. default: 0</span>
<a name="l18392"></a>18392 <span class="comment">     * @param $coords_max (array) maximum value used by the coordinates. If a coordinate&#39;s value is greater than this it will be cut to coords_max. default: 1</span>
<a name="l18393"></a>18393 <span class="comment">     * @param $antialias (boolean) A flag indicating whether to filter the shading function to prevent aliasing artifacts.</span>
<a name="l18394"></a>18394 <span class="comment">     * @author Andreas Würmser, Nicola Asuni</span>
<a name="l18395"></a>18395 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18396"></a>18396 <span class="comment">     * @public</span>
<a name="l18397"></a>18397 <span class="comment">     */</span>
<a name="l18398"></a><a class="code" href="classTCPDF.html#afb4db924e2500df58789320694169785">18398</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#afb4db924e2500df58789320694169785" title="Paints a coons patch mesh.">CoonsPatchMesh</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $col1=array(), $col2=array(), $col3=array(), $col4=array(), $coords=array(0.00,0.0,0.33,0.00,0.67,0.00,1.00,0.00,1.00,0.33,1.00,0.67,1.00,1.00,0.67,1.00,0.33,1.00,0.00,1.00,0.00,0.67,0.00,0.33), $coords_min=0, $coords_max=1, $antialias=<span class="keyword">false</span>) {
<a name="l18399"></a>18399         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l18400"></a>18400             <span class="keywordflow">return</span>;
<a name="l18401"></a>18401         }
<a name="l18402"></a>18402         $this-&gt;Clip(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l18403"></a>18403         $n = count($this-&gt;gradients) + 1;
<a name="l18404"></a>18404         $this-&gt;gradients[$n] = array();
<a name="l18405"></a>18405         $this-&gt;gradients[$n][<span class="stringliteral">&#39;type&#39;</span>] = 6; <span class="comment">//coons patch mesh</span>
<a name="l18406"></a>18406         $this-&gt;gradients[$n][<span class="stringliteral">&#39;coords&#39;</span>] = array();
<a name="l18407"></a>18407         $this-&gt;gradients[$n][<span class="stringliteral">&#39;antialias&#39;</span>] = $antialias;
<a name="l18408"></a>18408         $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>] = array();
<a name="l18409"></a>18409         $this-&gt;gradients[$n][<span class="stringliteral">&#39;transparency&#39;</span>] = <span class="keyword">false</span>;
<a name="l18410"></a>18410         <span class="comment">//check the coords array if it is the simple array or the multi patch array</span>
<a name="l18411"></a>18411         <span class="keywordflow">if</span> (!isset($coords[0][<span class="charliteral">&#39;f&#39;</span>])) {
<a name="l18412"></a>18412             <span class="comment">//simple array -&gt; convert to multi patch array</span>
<a name="l18413"></a>18413             <span class="keywordflow">if</span> (!isset($col1[1])) {
<a name="l18414"></a>18414                 $col1[1] = $col1[2] = $col1[0];
<a name="l18415"></a>18415             }
<a name="l18416"></a>18416             <span class="keywordflow">if</span> (!isset($col2[1])) {
<a name="l18417"></a>18417                 $col2[1] = $col2[2] = $col2[0];
<a name="l18418"></a>18418             }
<a name="l18419"></a>18419             <span class="keywordflow">if</span> (!isset($col3[1])) {
<a name="l18420"></a>18420                 $col3[1] = $col3[2] = $col3[0];
<a name="l18421"></a>18421             }
<a name="l18422"></a>18422             <span class="keywordflow">if</span> (!isset($col4[1])) {
<a name="l18423"></a>18423                 $col4[1] = $col4[2] = $col4[0];
<a name="l18424"></a>18424             }
<a name="l18425"></a>18425             $patch_array[0][<span class="charliteral">&#39;f&#39;</span>] = 0;
<a name="l18426"></a>18426             $patch_array[0][<span class="stringliteral">&#39;points&#39;</span>] = $coords;
<a name="l18427"></a>18427             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][0][<span class="charliteral">&#39;r&#39;</span>] = $col1[0];
<a name="l18428"></a>18428             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][0][<span class="charliteral">&#39;g&#39;</span>] = $col1[1];
<a name="l18429"></a>18429             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][0][<span class="charliteral">&#39;b&#39;</span>] = $col1[2];
<a name="l18430"></a>18430             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][1][<span class="charliteral">&#39;r&#39;</span>] = $col2[0];
<a name="l18431"></a>18431             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][1][<span class="charliteral">&#39;g&#39;</span>] = $col2[1];
<a name="l18432"></a>18432             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][1][<span class="charliteral">&#39;b&#39;</span>] = $col2[2];
<a name="l18433"></a>18433             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][2][<span class="charliteral">&#39;r&#39;</span>] = $col3[0];
<a name="l18434"></a>18434             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][2][<span class="charliteral">&#39;g&#39;</span>] = $col3[1];
<a name="l18435"></a>18435             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][2][<span class="charliteral">&#39;b&#39;</span>] = $col3[2];
<a name="l18436"></a>18436             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][3][<span class="charliteral">&#39;r&#39;</span>] = $col4[0];
<a name="l18437"></a>18437             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][3][<span class="charliteral">&#39;g&#39;</span>] = $col4[1];
<a name="l18438"></a>18438             $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][3][<span class="charliteral">&#39;b&#39;</span>] = $col4[2];
<a name="l18439"></a>18439         } <span class="keywordflow">else</span> {
<a name="l18440"></a>18440             <span class="comment">//multi patch array</span>
<a name="l18441"></a>18441             $patch_array = $coords;
<a name="l18442"></a>18442         }
<a name="l18443"></a>18443         $bpcd = 65535; <span class="comment">//16 bits per coordinate</span>
<a name="l18444"></a>18444         <span class="comment">//build the data stream</span>
<a name="l18445"></a>18445         $this-&gt;gradients[$n][<span class="stringliteral">&#39;stream&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l18446"></a>18446         $count_patch = count($patch_array);
<a name="l18447"></a>18447         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $count_patch; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l18448"></a>18448             $this-&gt;gradients[$n][<span class="stringliteral">&#39;stream&#39;</span>] .= chr($patch_array[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="charliteral">&#39;f&#39;</span>]); <span class="comment">//start with the edge flag as 8 bit</span>
<a name="l18449"></a>18449             $count_points = count($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>]);
<a name="l18450"></a>18450             <span class="keywordflow">for</span> ($j=0; $j &lt; $count_points; ++$j) {
<a name="l18451"></a>18451                 <span class="comment">//each point as 16 bit</span>
<a name="l18452"></a>18452                 $patch_array[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;points&#39;</span>][$j] = (($patch_array[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;points&#39;</span>][$j] - $coords_min) / ($coords_max - $coords_min)) * $bpcd;
<a name="l18453"></a>18453                 <span class="keywordflow">if</span> ($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] &lt; 0) {
<a name="l18454"></a>18454                     $patch_array[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;points&#39;</span>][$j] = 0;
<a name="l18455"></a>18455                 }
<a name="l18456"></a>18456                 <span class="keywordflow">if</span> ($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] &gt; $bpcd) {
<a name="l18457"></a>18457                     $patch_array[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;points&#39;</span>][$j] = $bpcd;
<a name="l18458"></a>18458                 }
<a name="l18459"></a>18459                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;stream&#39;</span>] .= chr(floor($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] / 256));
<a name="l18460"></a>18460                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;stream&#39;</span>] .= chr(floor($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] % 256));
<a name="l18461"></a>18461             }
<a name="l18462"></a>18462             $count_cols = count($patch_array[$i][<span class="stringliteral">&#39;colors&#39;</span>]);
<a name="l18463"></a>18463             <span class="keywordflow">for</span> ($j=0; $j &lt; $count_cols; ++$j) {
<a name="l18464"></a>18464                 <span class="comment">//each color component as 8 bit</span>
<a name="l18465"></a>18465                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;stream&#39;</span>] .= chr($patch_array[$i][<span class="stringliteral">&#39;colors&#39;</span>][$j][<span class="charliteral">&#39;r&#39;</span>]);
<a name="l18466"></a>18466                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;stream&#39;</span>] .= chr($patch_array[$i][<span class="stringliteral">&#39;colors&#39;</span>][$j][<span class="charliteral">&#39;g&#39;</span>]);
<a name="l18467"></a>18467                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;stream&#39;</span>] .= chr($patch_array[$i][<span class="stringliteral">&#39;colors&#39;</span>][$j][<span class="charliteral">&#39;b&#39;</span>]);
<a name="l18468"></a>18468             }
<a name="l18469"></a>18469         }
<a name="l18470"></a>18470         <span class="comment">//paint the gradient</span>
<a name="l18471"></a>18471         $this-&gt;_out(<span class="stringliteral">&#39;/Sh&#39;</span>.$n.<span class="stringliteral">&#39; sh&#39;</span>);
<a name="l18472"></a>18472         <span class="comment">//restore previous Graphic State</span>
<a name="l18473"></a>18473         $this-&gt;_out(<span class="charliteral">&#39;Q&#39;</span>);
<a name="l18474"></a>18474         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l18475"></a>18475             <span class="comment">// we are inside an XObject template</span>
<a name="l18476"></a>18476             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;gradients&#39;</span>][$n] = $this-&gt;gradients[$n];
<a name="l18477"></a>18477         }
<a name="l18478"></a>18478     }
<a name="l18479"></a>18479 <span class="comment"></span>
<a name="l18480"></a>18480 <span class="comment">    /**</span>
<a name="l18481"></a>18481 <span class="comment">     * Set a rectangular clipping area.</span>
<a name="l18482"></a>18482 <span class="comment">     * @param $x (float) abscissa of the top left corner of the rectangle (or top right corner for RTL mode).</span>
<a name="l18483"></a>18483 <span class="comment">     * @param $y (float) ordinate of the top left corner of the rectangle.</span>
<a name="l18484"></a>18484 <span class="comment">     * @param $w (float) width of the rectangle.</span>
<a name="l18485"></a>18485 <span class="comment">     * @param $h (float) height of the rectangle.</span>
<a name="l18486"></a>18486 <span class="comment">     * @author Andreas Würmser, Nicola Asuni</span>
<a name="l18487"></a>18487 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18488"></a>18488 <span class="comment">     * @protected</span>
<a name="l18489"></a>18489 <span class="comment">     */</span>
<a name="l18490"></a><a class="code" href="classTCPDF.html#af353ab2d04ac6b69733765f7ea35ebcc">18490</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af353ab2d04ac6b69733765f7ea35ebcc" title="Set a rectangular clipping area.">Clip</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>) {
<a name="l18491"></a>18491         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l18492"></a>18492             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;w - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l18493"></a>18493         }
<a name="l18494"></a>18494         <span class="comment">//save current Graphic State</span>
<a name="l18495"></a>18495         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> = <span class="charliteral">&#39;q&#39;</span>;
<a name="l18496"></a>18496         <span class="comment">//set clipping area</span>
<a name="l18497"></a>18497         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39; %.2F %.2F %.2F %.2F re W n&#39;</span>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>*$this-&gt;k, ($this-&gt;h-$y)*$this-&gt;k, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>*$this-&gt;k, -<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>*$this-&gt;k);
<a name="l18498"></a>18498         <span class="comment">//set up transformation matrix for gradient</span>
<a name="l18499"></a>18499         <a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a> .= sprintf(<span class="stringliteral">&#39; %.3F 0 0 %.3F %.3F %.3F cm&#39;</span>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>*$this-&gt;k, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>*$this-&gt;k, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>*$this-&gt;k, ($this-&gt;h-($y+<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>))*$this-&gt;k);
<a name="l18500"></a>18500         $this-&gt;_out(<a class="code" href="sp_8php.html#a50b05cf2e02ef0b67fcad97106dd7634">$s</a>);
<a name="l18501"></a>18501     }
<a name="l18502"></a>18502 <span class="comment"></span>
<a name="l18503"></a>18503 <span class="comment">    /**</span>
<a name="l18504"></a>18504 <span class="comment">     * Output gradient.</span>
<a name="l18505"></a>18505 <span class="comment">     * @param $type (int) type of gradient (1 Function-based shading; 2 Axial shading; 3 Radial shading; 4 Free-form Gouraud-shaded triangle mesh; 5 Lattice-form Gouraud-shaded triangle mesh; 6 Coons patch mesh; 7 Tensor-product patch mesh). (Not all types are currently supported)</span>
<a name="l18506"></a>18506 <span class="comment">     * @param $coords (array) array of coordinates.</span>
<a name="l18507"></a>18507 <span class="comment">     * @param $stops (array) array gradient color components: color = array of GRAY, RGB or CMYK color components; offset = (0 to 1) represents a location along the gradient vector; exponent = exponent of the exponential interpolation function (default = 1).</span>
<a name="l18508"></a>18508 <span class="comment">     * @param $background (array) An array of colour components appropriate to the colour space, specifying a single background colour value.</span>
<a name="l18509"></a>18509 <span class="comment">     * @param $antialias (boolean) A flag indicating whether to filter the shading function to prevent aliasing artifacts.</span>
<a name="l18510"></a>18510 <span class="comment">     * @author Nicola Asuni</span>
<a name="l18511"></a>18511 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18512"></a>18512 <span class="comment">     * @public</span>
<a name="l18513"></a>18513 <span class="comment">     */</span>
<a name="l18514"></a><a class="code" href="classTCPDF.html#ab4f165583b4f50a0a0bbf81eb346e4bb">18514</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab4f165583b4f50a0a0bbf81eb346e4bb" title="Output gradient.">Gradient</a>(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $coords, $stops, $background=array(), $antialias=<span class="keyword">false</span>) {
<a name="l18515"></a>18515         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l18516"></a>18516             <span class="keywordflow">return</span>;
<a name="l18517"></a>18517         }
<a name="l18518"></a>18518         $n = count($this-&gt;gradients) + 1;
<a name="l18519"></a>18519         $this-&gt;gradients[$n] = array();
<a name="l18520"></a>18520         $this-&gt;gradients[$n][<span class="stringliteral">&#39;type&#39;</span>] = <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>;
<a name="l18521"></a>18521         $this-&gt;gradients[$n][<span class="stringliteral">&#39;coords&#39;</span>] = $coords;
<a name="l18522"></a>18522         $this-&gt;gradients[$n][<span class="stringliteral">&#39;antialias&#39;</span>] = $antialias;
<a name="l18523"></a>18523         $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>] = array();
<a name="l18524"></a>18524         $this-&gt;gradients[$n][<span class="stringliteral">&#39;transparency&#39;</span>] = <span class="keyword">false</span>;
<a name="l18525"></a>18525         <span class="comment">// color space</span>
<a name="l18526"></a>18526         $numcolspace = count($stops[0][<span class="stringliteral">&#39;color&#39;</span>]);
<a name="l18527"></a>18527         $bcolor = array_values($background);
<a name="l18528"></a>18528         <span class="keywordflow">switch</span>($numcolspace) {
<a name="l18529"></a>18529             <span class="keywordflow">case</span> 4: { <span class="comment">// CMYK</span>
<a name="l18530"></a>18530                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;colspace&#39;</span>] = <span class="stringliteral">&#39;DeviceCMYK&#39;</span>;
<a name="l18531"></a>18531                 <span class="keywordflow">if</span> (!empty($background)) {
<a name="l18532"></a>18532                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;background&#39;</span>] = sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F %.3F&#39;</span>, $bcolor[0]/100, $bcolor[1]/100, $bcolor[2]/100, $bcolor[3]/100);
<a name="l18533"></a>18533                 }
<a name="l18534"></a>18534                 <span class="keywordflow">break</span>;
<a name="l18535"></a>18535             }
<a name="l18536"></a>18536             <span class="keywordflow">case</span> 3: { <span class="comment">// RGB</span>
<a name="l18537"></a>18537                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;colspace&#39;</span>] = <span class="stringliteral">&#39;DeviceRGB&#39;</span>;
<a name="l18538"></a>18538                 <span class="keywordflow">if</span> (!empty($background)) {
<a name="l18539"></a>18539                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;background&#39;</span>] = sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F&#39;</span>, $bcolor[0]/255, $bcolor[1]/255, $bcolor[2]/255);
<a name="l18540"></a>18540                 }
<a name="l18541"></a>18541                 <span class="keywordflow">break</span>;
<a name="l18542"></a>18542             }
<a name="l18543"></a>18543             <span class="keywordflow">case</span> 1: { <span class="comment">// Gray scale</span>
<a name="l18544"></a>18544                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;colspace&#39;</span>] = <span class="stringliteral">&#39;DeviceGray&#39;</span>;
<a name="l18545"></a>18545                 <span class="keywordflow">if</span> (!empty($background)) {
<a name="l18546"></a>18546                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;background&#39;</span>] = sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, $bcolor[0]/255);
<a name="l18547"></a>18547                 }
<a name="l18548"></a>18548                 <span class="keywordflow">break</span>;
<a name="l18549"></a>18549             }
<a name="l18550"></a>18550         }
<a name="l18551"></a>18551         $num_stops = count($stops);
<a name="l18552"></a>18552         $last_stop_id = $num_stops - 1;
<a name="l18553"></a>18553         <span class="keywordflow">foreach</span> ($stops as $key =&gt; $stop) {
<a name="l18554"></a>18554             $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key] = array();
<a name="l18555"></a>18555             <span class="comment">// offset represents a location along the gradient vector</span>
<a name="l18556"></a>18556             <span class="keywordflow">if</span> (isset($stop[<span class="stringliteral">&#39;offset&#39;</span>])) {
<a name="l18557"></a>18557                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;offset&#39;</span>] = $stop[<span class="stringliteral">&#39;offset&#39;</span>];
<a name="l18558"></a>18558             } <span class="keywordflow">else</span> {
<a name="l18559"></a>18559                 <span class="keywordflow">if</span> ($key == 0) {
<a name="l18560"></a>18560                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;offset&#39;</span>] = 0;
<a name="l18561"></a>18561                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($key == $last_stop_id) {
<a name="l18562"></a>18562                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;offset&#39;</span>] = 1;
<a name="l18563"></a>18563                 } <span class="keywordflow">else</span> {
<a name="l18564"></a>18564                     $offsetstep = (1 - $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][($key - 1)][<span class="stringliteral">&#39;offset&#39;</span>]) / ($num_stops - $key);
<a name="l18565"></a>18565                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;offset&#39;</span>] = $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][($key - 1)][<span class="stringliteral">&#39;offset&#39;</span>] + $offsetstep;
<a name="l18566"></a>18566                 }
<a name="l18567"></a>18567             }
<a name="l18568"></a>18568             <span class="keywordflow">if</span> (isset($stop[<span class="stringliteral">&#39;opacity&#39;</span>])) {
<a name="l18569"></a>18569                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;opacity&#39;</span>] = $stop[<span class="stringliteral">&#39;opacity&#39;</span>];
<a name="l18570"></a>18570                 <span class="keywordflow">if</span> ((!$this-&gt;pdfa_mode) AND ($stop[<span class="stringliteral">&#39;opacity&#39;</span>] &lt; 1)) {
<a name="l18571"></a>18571                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;transparency&#39;</span>] = <span class="keyword">true</span>;
<a name="l18572"></a>18572                 }
<a name="l18573"></a>18573             } <span class="keywordflow">else</span> {
<a name="l18574"></a>18574                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;opacity&#39;</span>] = 1;
<a name="l18575"></a>18575             }
<a name="l18576"></a>18576             <span class="comment">// exponent for the exponential interpolation function</span>
<a name="l18577"></a>18577             <span class="keywordflow">if</span> (isset($stop[<span class="stringliteral">&#39;exponent&#39;</span>])) {
<a name="l18578"></a>18578                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;exponent&#39;</span>] = $stop[<span class="stringliteral">&#39;exponent&#39;</span>];
<a name="l18579"></a>18579             } <span class="keywordflow">else</span> {
<a name="l18580"></a>18580                 $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;exponent&#39;</span>] = 1;
<a name="l18581"></a>18581             }
<a name="l18582"></a>18582             <span class="comment">// set colors</span>
<a name="l18583"></a>18583             $color = array_values($stop[<span class="stringliteral">&#39;color&#39;</span>]);
<a name="l18584"></a>18584             <span class="keywordflow">switch</span>($numcolspace) {
<a name="l18585"></a>18585                 <span class="keywordflow">case</span> 4: { <span class="comment">// CMYK</span>
<a name="l18586"></a>18586                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;color&#39;</span>] = sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F %.3F&#39;</span>, $color[0]/100, $color[1]/100, $color[2]/100, $color[3]/100);
<a name="l18587"></a>18587                     <span class="keywordflow">break</span>;
<a name="l18588"></a>18588                 }
<a name="l18589"></a>18589                 <span class="keywordflow">case</span> 3: { <span class="comment">// RGB</span>
<a name="l18590"></a>18590                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;color&#39;</span>] = sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F&#39;</span>, $color[0]/255, $color[1]/255, $color[2]/255);
<a name="l18591"></a>18591                     <span class="keywordflow">break</span>;
<a name="l18592"></a>18592                 }
<a name="l18593"></a>18593                 <span class="keywordflow">case</span> 1: { <span class="comment">// Gray scale</span>
<a name="l18594"></a>18594                     $this-&gt;gradients[$n][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;color&#39;</span>] = sprintf(<span class="stringliteral">&#39;%.3F&#39;</span>, $color[0]/255);
<a name="l18595"></a>18595                     <span class="keywordflow">break</span>;
<a name="l18596"></a>18596                 }
<a name="l18597"></a>18597             }
<a name="l18598"></a>18598         }
<a name="l18599"></a>18599         <span class="keywordflow">if</span> ($this-&gt;gradients[$n][<span class="stringliteral">&#39;transparency&#39;</span>]) {
<a name="l18600"></a>18600             <span class="comment">// paint luminosity gradient</span>
<a name="l18601"></a>18601             $this-&gt;_out(<span class="stringliteral">&#39;/TGS&#39;</span>.$n.<span class="stringliteral">&#39; gs&#39;</span>);
<a name="l18602"></a>18602         }
<a name="l18603"></a>18603         <span class="comment">//paint the gradient</span>
<a name="l18604"></a>18604         $this-&gt;_out(<span class="stringliteral">&#39;/Sh&#39;</span>.$n.<span class="stringliteral">&#39; sh&#39;</span>);
<a name="l18605"></a>18605         <span class="comment">//restore previous Graphic State</span>
<a name="l18606"></a>18606         $this-&gt;_out(<span class="charliteral">&#39;Q&#39;</span>);
<a name="l18607"></a>18607         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l18608"></a>18608             <span class="comment">// we are inside an XObject template</span>
<a name="l18609"></a>18609             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;gradients&#39;</span>][$n] = $this-&gt;gradients[$n];
<a name="l18610"></a>18610         }
<a name="l18611"></a>18611     }
<a name="l18612"></a>18612 <span class="comment"></span>
<a name="l18613"></a>18613 <span class="comment">    /**</span>
<a name="l18614"></a>18614 <span class="comment">     * Output gradient shaders.</span>
<a name="l18615"></a>18615 <span class="comment">     * @author Nicola Asuni</span>
<a name="l18616"></a>18616 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18617"></a>18617 <span class="comment">     * @protected</span>
<a name="l18618"></a>18618 <span class="comment">     */</span>
<a name="l18619"></a><a class="code" href="classTCPDF.html#ac4f7fe7f2836e624fb0317f75a74236b">18619</a>     <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac4f7fe7f2836e624fb0317f75a74236b" title="Output gradient shaders.">_putshaders</a>() {
<a name="l18620"></a>18620         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l18621"></a>18621             <span class="keywordflow">return</span>;
<a name="l18622"></a>18622         }
<a name="l18623"></a>18623         $idt = count($this-&gt;gradients); <span class="comment">//index for transparency gradients</span>
<a name="l18624"></a>18624         <span class="keywordflow">foreach</span> ($this-&gt;gradients as <a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a> =&gt; $grad) {
<a name="l18625"></a>18625             <span class="keywordflow">if</span> (($grad[<span class="stringliteral">&#39;type&#39;</span>] == 2) OR ($grad[<span class="stringliteral">&#39;type&#39;</span>] == 3)) {
<a name="l18626"></a>18626                 $fc = $this-&gt;_newobj();
<a name="l18627"></a>18627                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l18628"></a>18628                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FunctionType 3&#39;</span>;
<a name="l18629"></a>18629                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;
<a name="l18630"></a>18630                 $functions = <span class="stringliteral">&#39;&#39;</span>;
<a name="l18631"></a>18631                 $bounds = <span class="stringliteral">&#39;&#39;</span>;
<a name="l18632"></a>18632                 $encode = <span class="stringliteral">&#39;&#39;</span>;
<a name="l18633"></a>18633                 <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1;
<a name="l18634"></a>18634                 $num_cols = count($grad[<span class="stringliteral">&#39;colors&#39;</span>]);
<a name="l18635"></a>18635                 $lastcols = $num_cols - 1;
<a name="l18636"></a>18636                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $num_cols; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l18637"></a>18637                     $functions .= ($fc + <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>).<span class="stringliteral">&#39; 0 R &#39;</span>;
<a name="l18638"></a>18638                     <span class="keywordflow">if</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $lastcols) {
<a name="l18639"></a>18639                         $bounds .= sprintf(<span class="stringliteral">&#39;%.3F &#39;</span>, $grad[<span class="stringliteral">&#39;colors&#39;</span>][<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;offset&#39;</span>]);
<a name="l18640"></a>18640                     }
<a name="l18641"></a>18641                     $encode .= <span class="stringliteral">&#39;0 1 &#39;</span>;
<a name="l18642"></a>18642                 }
<a name="l18643"></a>18643                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Functions [&#39;</span>.trim($functions).<span class="charliteral">&#39;]&#39;</span>;
<a name="l18644"></a>18644                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Bounds [&#39;</span>.trim($bounds).<span class="charliteral">&#39;]&#39;</span>;
<a name="l18645"></a>18645                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Encode [&#39;</span>.trim($encode).<span class="charliteral">&#39;]&#39;</span>;
<a name="l18646"></a>18646                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18647"></a>18647                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18648"></a>18648                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18649"></a>18649                 <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $num_cols; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l18650"></a>18650                     $this-&gt;_newobj();
<a name="l18651"></a>18651                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l18652"></a>18652                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FunctionType 2&#39;</span>;
<a name="l18653"></a>18653                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;
<a name="l18654"></a>18654                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /C0 [&#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> - 1)][<span class="stringliteral">&#39;color&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;
<a name="l18655"></a>18655                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /C1 [&#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;color&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;
<a name="l18656"></a>18656                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /N &#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;exponent&#39;</span>];
<a name="l18657"></a>18657                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18658"></a>18658                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18659"></a>18659                     $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18660"></a>18660                 }
<a name="l18661"></a>18661                 <span class="comment">// set transparency fuctions</span>
<a name="l18662"></a>18662                 <span class="keywordflow">if</span> ($grad[<span class="stringliteral">&#39;transparency&#39;</span>]) {
<a name="l18663"></a>18663                     $ft = $this-&gt;_newobj();
<a name="l18664"></a>18664                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l18665"></a>18665                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FunctionType 3&#39;</span>;
<a name="l18666"></a>18666                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;
<a name="l18667"></a>18667                     $functions = <span class="stringliteral">&#39;&#39;</span>;
<a name="l18668"></a>18668                     <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1;
<a name="l18669"></a>18669                     $num_cols = count($grad[<span class="stringliteral">&#39;colors&#39;</span>]);
<a name="l18670"></a>18670                     <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $num_cols; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l18671"></a>18671                         $functions .= ($ft + <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>).<span class="stringliteral">&#39; 0 R &#39;</span>;
<a name="l18672"></a>18672                     }
<a name="l18673"></a>18673                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Functions [&#39;</span>.trim($functions).<span class="charliteral">&#39;]&#39;</span>;
<a name="l18674"></a>18674                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Bounds [&#39;</span>.trim($bounds).<span class="charliteral">&#39;]&#39;</span>;
<a name="l18675"></a>18675                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Encode [&#39;</span>.trim($encode).<span class="charliteral">&#39;]&#39;</span>;
<a name="l18676"></a>18676                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18677"></a>18677                     <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18678"></a>18678                     $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18679"></a>18679                     <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 1; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $num_cols; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l18680"></a>18680                         $this-&gt;_newobj();
<a name="l18681"></a>18681                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;
<a name="l18682"></a>18682                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /FunctionType 2&#39;</span>;
<a name="l18683"></a>18683                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;
<a name="l18684"></a>18684                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /C0 [&#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> - 1)][<span class="stringliteral">&#39;opacity&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;
<a name="l18685"></a>18685                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /C1 [&#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;opacity&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;
<a name="l18686"></a>18686                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /N &#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;exponent&#39;</span>];
<a name="l18687"></a>18687                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18688"></a>18688                         <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18689"></a>18689                         $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18690"></a>18690                     }
<a name="l18691"></a>18691                 }
<a name="l18692"></a>18692             }
<a name="l18693"></a>18693             <span class="comment">// set shading object</span>
<a name="l18694"></a>18694             $this-&gt;_newobj();
<a name="l18695"></a>18695             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /ShadingType &#39;</span>.$grad[<span class="stringliteral">&#39;type&#39;</span>];
<a name="l18696"></a>18696             <span class="keywordflow">if</span> (isset($grad[<span class="stringliteral">&#39;colspace&#39;</span>])) {
<a name="l18697"></a>18697                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ColorSpace /&#39;</span>.$grad[<span class="stringliteral">&#39;colspace&#39;</span>];
<a name="l18698"></a>18698             } <span class="keywordflow">else</span> {
<a name="l18699"></a>18699                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ColorSpace /DeviceRGB&#39;</span>;
<a name="l18700"></a>18700             }
<a name="l18701"></a>18701             <span class="keywordflow">if</span> (isset($grad[<span class="stringliteral">&#39;background&#39;</span>]) AND !empty($grad[<span class="stringliteral">&#39;background&#39;</span>])) {
<a name="l18702"></a>18702                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Background [&#39;</span>.$grad[<span class="stringliteral">&#39;background&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;
<a name="l18703"></a>18703             }
<a name="l18704"></a>18704             <span class="keywordflow">if</span> (isset($grad[<span class="stringliteral">&#39;antialias&#39;</span>]) AND ($grad[<span class="stringliteral">&#39;antialias&#39;</span>] === <span class="keyword">true</span>)) {
<a name="l18705"></a>18705                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /AntiAlias true&#39;</span>;
<a name="l18706"></a>18706             }
<a name="l18707"></a>18707             <span class="keywordflow">if</span> ($grad[<span class="stringliteral">&#39;type&#39;</span>] == 2) {
<a name="l18708"></a>18708                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;/Coords [%.3F %.3F %.3F %.3F]&#39;</span>, $grad[<span class="stringliteral">&#39;coords&#39;</span>][0], $grad[<span class="stringliteral">&#39;coords&#39;</span>][1], $grad[<span class="stringliteral">&#39;coords&#39;</span>][2], $grad[<span class="stringliteral">&#39;coords&#39;</span>][3]);
<a name="l18709"></a>18709                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;
<a name="l18710"></a>18710                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Function &#39;</span>.$fc.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l18711"></a>18711                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Extend [true true]&#39;</span>;
<a name="l18712"></a>18712                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18713"></a>18713             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($grad[<span class="stringliteral">&#39;type&#39;</span>] == 3) {
<a name="l18714"></a>18714                 <span class="comment">//x0, y0, r0, x1, y1, r1</span>
<a name="l18715"></a>18715                 <span class="comment">//at this this time radius of inner circle is 0</span>
<a name="l18716"></a>18716                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;/Coords [%.3F %.3F 0 %.3F %.3F %.3F]&#39;</span>, $grad[<span class="stringliteral">&#39;coords&#39;</span>][0], $grad[<span class="stringliteral">&#39;coords&#39;</span>][1], $grad[<span class="stringliteral">&#39;coords&#39;</span>][2], $grad[<span class="stringliteral">&#39;coords&#39;</span>][3], $grad[<span class="stringliteral">&#39;coords&#39;</span>][4]);
<a name="l18717"></a>18717                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;
<a name="l18718"></a>18718                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Function &#39;</span>.$fc.<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l18719"></a>18719                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Extend [true true]&#39;</span>;
<a name="l18720"></a>18720                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18721"></a>18721             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($grad[<span class="stringliteral">&#39;type&#39;</span>] == 6) {
<a name="l18722"></a>18722                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BitsPerCoordinate 16&#39;</span>;
<a name="l18723"></a>18723                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BitsPerComponent 8&#39;</span>;
<a name="l18724"></a>18724                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Decode[0 1 0 1 0 1 0 1 0 1]&#39;</span>;
<a name="l18725"></a>18725                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BitsPerFlag 8&#39;</span>;
<a name="l18726"></a>18726                 $stream = $this-&gt;_getrawstream($grad[<span class="stringliteral">&#39;stream&#39;</span>]);
<a name="l18727"></a>18727                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream);
<a name="l18728"></a>18728                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18729"></a>18729                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l18730"></a>18730             }
<a name="l18731"></a>18731             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18732"></a>18732             $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18733"></a>18733             <span class="keywordflow">if</span> ($grad[<span class="stringliteral">&#39;transparency&#39;</span>]) {
<a name="l18734"></a>18734                 $shading_transparency = preg_replace(<span class="stringliteral">&#39;/\/ColorSpace \/[^\s]+/si&#39;</span>, <span class="stringliteral">&#39;/ColorSpace /DeviceGray&#39;</span>, <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18735"></a>18735                 $shading_transparency = preg_replace(<span class="stringliteral">&#39;/\/Function [0-9]+ /si&#39;</span>, <span class="stringliteral">&#39;/Function &#39;</span>.$ft.<span class="charliteral">&#39; &#39;</span>, $shading_transparency);
<a name="l18736"></a>18736             }
<a name="l18737"></a>18737             $this-&gt;gradients[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>][<span class="stringliteral">&#39;id&#39;</span>] = $this-&gt;n;
<a name="l18738"></a>18738             <span class="comment">// set pattern object</span>
<a name="l18739"></a>18739             $this-&gt;_newobj();
<a name="l18740"></a>18740             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /Pattern /PatternType 2&#39;</span>;
<a name="l18741"></a>18741             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Shading &#39;</span>.$this-&gt;gradients[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>][<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l18742"></a>18742             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18743"></a>18743             <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18744"></a>18744             $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18745"></a>18745             $this-&gt;gradients[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>][<span class="stringliteral">&#39;pattern&#39;</span>] = $this-&gt;n;
<a name="l18746"></a>18746             <span class="comment">// set shading and pattern for transparency mask</span>
<a name="l18747"></a>18747             <span class="keywordflow">if</span> ($grad[<span class="stringliteral">&#39;transparency&#39;</span>]) {
<a name="l18748"></a>18748                 <span class="comment">// luminosity pattern</span>
<a name="l18749"></a>18749                 $idgs = <a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a> + $idt;
<a name="l18750"></a>18750                 $this-&gt;_newobj();
<a name="l18751"></a>18751                 $this-&gt;_out($shading_transparency);
<a name="l18752"></a>18752                 $this-&gt;gradients[$idgs][<span class="stringliteral">&#39;id&#39;</span>] = $this-&gt;n;
<a name="l18753"></a>18753                 $this-&gt;_newobj();
<a name="l18754"></a>18754                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /Pattern /PatternType 2&#39;</span>;
<a name="l18755"></a>18755                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Shading &#39;</span>.$this-&gt;gradients[$idgs][<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;
<a name="l18756"></a>18756                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18757"></a>18757                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18758"></a>18758                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18759"></a>18759                 $this-&gt;gradients[$idgs][<span class="stringliteral">&#39;pattern&#39;</span>] = $this-&gt;n;
<a name="l18760"></a>18760                 <span class="comment">// luminosity XObject</span>
<a name="l18761"></a>18761                 $oid = $this-&gt;_newobj();
<a name="l18762"></a>18762                 $this-&gt;xobjects[<span class="stringliteral">&#39;LX&#39;</span>.$oid] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $oid);
<a name="l18763"></a>18763                 $filter = <span class="stringliteral">&#39;&#39;</span>;
<a name="l18764"></a>18764                 $stream = <span class="stringliteral">&#39;q /a0 gs /Pattern cs /p&#39;</span>.$idgs.<span class="stringliteral">&#39; scn 0 0 &#39;</span>.$this-&gt;wPt.<span class="charliteral">&#39; &#39;</span>.$this-&gt;hPt.<span class="stringliteral">&#39; re f Q&#39;</span>;
<a name="l18765"></a>18765                 <span class="keywordflow">if</span> ($this-&gt;compress) {
<a name="l18766"></a>18766                     $filter = <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;
<a name="l18767"></a>18767                     $stream = gzcompress($stream);
<a name="l18768"></a>18768                 }
<a name="l18769"></a>18769                 $stream = $this-&gt;_getrawstream($stream);
<a name="l18770"></a>18770                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /XObject /Subtype /Form /FormType 1&#39;</span>.$filter;
<a name="l18771"></a>18771                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream);
<a name="l18772"></a>18772                 $rect = sprintf(<span class="stringliteral">&#39;%.2F %.2F&#39;</span>, $this-&gt;wPt, $this-&gt;hPt);
<a name="l18773"></a>18773                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /BBox [0 0 &#39;</span>.$rect.<span class="charliteral">&#39;]&#39;</span>;
<a name="l18774"></a>18774                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Group &lt;&lt; /Type /Group /S /Transparency /CS /DeviceGray &gt;&gt;&#39;</span>;
<a name="l18775"></a>18775                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Resources &lt;&lt;&#39;</span>;
<a name="l18776"></a>18776                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /ExtGState &lt;&lt; /a0 &lt;&lt; /ca 1 /CA 1 &gt;&gt; &gt;&gt;&#39;</span>;
<a name="l18777"></a>18777                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; /Pattern &lt;&lt; /p&#39;</span>.$idgs.<span class="charliteral">&#39; &#39;</span>.$this-&gt;gradients[$idgs][<span class="stringliteral">&#39;pattern&#39;</span>].<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>;
<a name="l18778"></a>18778                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;
<a name="l18779"></a>18779                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; &gt;&gt; &#39;</span>;
<a name="l18780"></a>18780                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;
<a name="l18781"></a>18781                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18782"></a>18782                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18783"></a>18783                 <span class="comment">// SMask</span>
<a name="l18784"></a>18784                 $this-&gt;_newobj();
<a name="l18785"></a>18785                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /Mask /S /Luminosity /G &#39;</span>.($this-&gt;n - 1).<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18786"></a>18786                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18787"></a>18787                 <span class="comment">// ExtGState</span>
<a name="l18788"></a>18788                 $this-&gt;_newobj();
<a name="l18789"></a>18789                 <a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a> = <span class="stringliteral">&#39;&lt;&lt; /Type /ExtGState /SMask &#39;</span>.($this-&gt;n - 1).<span class="stringliteral">&#39; 0 R /AIS false &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;
<a name="l18790"></a>18790                 $this-&gt;_out(<a class="code" href="getclasses_8php.html#a48cb304902320d173a4eaa41543327b9">$out</a>);
<a name="l18791"></a>18791                 $this-&gt;extgstates[] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n, <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;TGS&#39;</span>.<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>);
<a name="l18792"></a>18792             }
<a name="l18793"></a>18793         }
<a name="l18794"></a>18794     }
<a name="l18795"></a>18795 <span class="comment"></span>
<a name="l18796"></a>18796 <span class="comment">    /**</span>
<a name="l18797"></a>18797 <span class="comment">     * Draw the sector of a circle.</span>
<a name="l18798"></a>18798 <span class="comment">     * It can be used for instance to render pie charts.</span>
<a name="l18799"></a>18799 <span class="comment">     * @param $xc (float) abscissa of the center.</span>
<a name="l18800"></a>18800 <span class="comment">     * @param $yc (float) ordinate of the center.</span>
<a name="l18801"></a>18801 <span class="comment">     * @param $r (float) radius.</span>
<a name="l18802"></a>18802 <span class="comment">     * @param $a (float) start angle (in degrees).</span>
<a name="l18803"></a>18803 <span class="comment">     * @param $b (float) end angle (in degrees).</span>
<a name="l18804"></a>18804 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l18805"></a>18805 <span class="comment">     * @param $cw: (float) indicates whether to go clockwise (default: true).</span>
<a name="l18806"></a>18806 <span class="comment">     * @param $o: (float) origin of angles (0 for 3 o&#39;clock, 90 for noon, 180 for 9 o&#39;clock, 270 for 6 o&#39;clock). Default: 90.</span>
<a name="l18807"></a>18807 <span class="comment">     * @author Maxime Delorme, Nicola Asuni</span>
<a name="l18808"></a>18808 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18809"></a>18809 <span class="comment">     * @public</span>
<a name="l18810"></a>18810 <span class="comment">     */</span>
<a name="l18811"></a><a class="code" href="classTCPDF.html#ac138de610bac7bee8885178db32dcea0">18811</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac138de610bac7bee8885178db32dcea0" title="Draw the sector of a circle.">PieSector</a>($xc, $yc, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $a, $b, $style=<span class="stringliteral">&#39;FD&#39;</span>, <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>=<span class="keyword">true</span>, $o=90) {
<a name="l18812"></a>18812         $this-&gt;PieSectorXY($xc, $yc, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, $a, $b, $style, <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>, $o);
<a name="l18813"></a>18813     }
<a name="l18814"></a>18814 <span class="comment"></span>
<a name="l18815"></a>18815 <span class="comment">    /**</span>
<a name="l18816"></a>18816 <span class="comment">     * Draw the sector of an ellipse.</span>
<a name="l18817"></a>18817 <span class="comment">     * It can be used for instance to render pie charts.</span>
<a name="l18818"></a>18818 <span class="comment">     * @param $xc (float) abscissa of the center.</span>
<a name="l18819"></a>18819 <span class="comment">     * @param $yc (float) ordinate of the center.</span>
<a name="l18820"></a>18820 <span class="comment">     * @param $rx (float) the x-axis radius.</span>
<a name="l18821"></a>18821 <span class="comment">     * @param $ry (float) the y-axis radius.</span>
<a name="l18822"></a>18822 <span class="comment">     * @param $a (float) start angle (in degrees).</span>
<a name="l18823"></a>18823 <span class="comment">     * @param $b (float) end angle (in degrees).</span>
<a name="l18824"></a>18824 <span class="comment">     * @param $style (string) Style of rendering. See the getPathPaintOperator() function for more information.</span>
<a name="l18825"></a>18825 <span class="comment">     * @param $cw: (float) indicates whether to go clockwise.</span>
<a name="l18826"></a>18826 <span class="comment">     * @param $o: (float) origin of angles (0 for 3 o&#39;clock, 90 for noon, 180 for 9 o&#39;clock, 270 for 6 o&#39;clock).</span>
<a name="l18827"></a>18827 <span class="comment">     * @param $nc (integer) Number of curves used to draw a 90 degrees portion of arc.</span>
<a name="l18828"></a>18828 <span class="comment">     * @author Maxime Delorme, Nicola Asuni</span>
<a name="l18829"></a>18829 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18830"></a>18830 <span class="comment">     * @public</span>
<a name="l18831"></a>18831 <span class="comment">     */</span>
<a name="l18832"></a><a class="code" href="classTCPDF.html#a26e2c92f3d3177b8f5508f4724f516a8">18832</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a26e2c92f3d3177b8f5508f4724f516a8" title="Draw the sector of an ellipse.">PieSectorXY</a>($xc, $yc, $rx, $ry, $a, $b, $style=<span class="stringliteral">&#39;FD&#39;</span>, <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>=<span class="keyword">false</span>, $o=0, $nc=2) {
<a name="l18833"></a>18833         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l18834"></a>18834             $xc = $this-&gt;w - $xc;
<a name="l18835"></a>18835         }
<a name="l18836"></a>18836         $op = $this-&gt;getPathPaintOperator($style);
<a name="l18837"></a>18837         <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {
<a name="l18838"></a>18838             $line_style = array();
<a name="l18839"></a>18839         }
<a name="l18840"></a>18840         <span class="keywordflow">if</span> (<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>) {
<a name="l18841"></a>18841             $d = $b;
<a name="l18842"></a>18842             $b = 360 - $a + $o;
<a name="l18843"></a>18843             $a = 360 - $d + $o;
<a name="l18844"></a>18844         } <span class="keywordflow">else</span> {
<a name="l18845"></a>18845             $b += $o;
<a name="l18846"></a>18846             $a += $o;
<a name="l18847"></a>18847         }
<a name="l18848"></a>18848         $this-&gt;_outellipticalarc($xc, $yc, $rx, $ry, 0, $a, $b, <span class="keyword">true</span>, $nc);
<a name="l18849"></a>18849         $this-&gt;_out($op);
<a name="l18850"></a>18850     }
<a name="l18851"></a>18851 <span class="comment"></span>
<a name="l18852"></a>18852 <span class="comment">    /**</span>
<a name="l18853"></a>18853 <span class="comment">     * Embed vector-based Adobe Illustrator (AI) or AI-compatible EPS files.</span>
<a name="l18854"></a>18854 <span class="comment">     * NOTE: EPS is not yet fully implemented, use the setRasterizeVectorImages() method to enable/disable rasterization of vector images using ImageMagick library.</span>
<a name="l18855"></a>18855 <span class="comment">     * Only vector drawing is supported, not text or bitmap.</span>
<a name="l18856"></a>18856 <span class="comment">     * Although the script was successfully tested with various AI format versions, best results are probably achieved with files that were exported in the AI3 format (tested with Illustrator CS2, Freehand MX and Photoshop CS2).</span>
<a name="l18857"></a>18857 <span class="comment">     * @param $file (string) Name of the file containing the image or a &#39;@&#39; character followed by the EPS/AI data string.</span>
<a name="l18858"></a>18858 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner.</span>
<a name="l18859"></a>18859 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner.</span>
<a name="l18860"></a>18860 <span class="comment">     * @param $w (float) Width of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
<a name="l18861"></a>18861 <span class="comment">     * @param $h (float) Height of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
<a name="l18862"></a>18862 <span class="comment">     * @param $link (mixed) URL or identifier returned by AddLink().</span>
<a name="l18863"></a>18863 <span class="comment">     * @param $useBoundingBox (boolean) specifies whether to position the bounding box (true) or the complete canvas (false) at location (x,y). Default value is true.</span>
<a name="l18864"></a>18864 <span class="comment">     * @param $align (string) Indicates the alignment of the pointer next to image insertion relative to image height. The value can be:&lt;ul&gt;&lt;li&gt;T: top-right for LTR or top-left for RTL&lt;/li&gt;&lt;li&gt;M: middle-right for LTR or middle-left for RTL&lt;/li&gt;&lt;li&gt;B: bottom-right for LTR or bottom-left for RTL&lt;/li&gt;&lt;li&gt;N: next line&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l18865"></a>18865 <span class="comment">     * @param $palign (string) Allows to center or align the image on the current line. Possible values are:&lt;ul&gt;&lt;li&gt;L : left align&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;R : right align&lt;/li&gt;&lt;li&gt;&#39;&#39; : empty string : left for LTR or right for RTL&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l18866"></a>18866 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l18867"></a>18867 <span class="comment">     * @param $fitonpage (boolean) if true the image is resized to not exceed page dimensions.</span>
<a name="l18868"></a>18868 <span class="comment">     * @param $fixoutvals (boolean) if true remove values outside the bounding box.</span>
<a name="l18869"></a>18869 <span class="comment">     * @author Valentin Schmidt, Nicola Asuni</span>
<a name="l18870"></a>18870 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l18871"></a>18871 <span class="comment">     * @public</span>
<a name="l18872"></a>18872 <span class="comment">     */</span>
<a name="l18873"></a><a class="code" href="classTCPDF.html#ace0583441eed657b827420fcfb37a3bd">18873</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ace0583441eed657b827420fcfb37a3bd" title="Embed vector-based Adobe Illustrator (AI) or AI-compatible EPS files.">ImageEps</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=0, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=0, $link=<span class="stringliteral">&#39;&#39;</span>, $useBoundingBox=<span class="keyword">true</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $palign=<span class="stringliteral">&#39;&#39;</span>, $border=0, $fitonpage=<span class="keyword">false</span>, $fixoutvals=<span class="keyword">false</span>) {
<a name="l18874"></a>18874         <span class="keywordflow">if</span> ($this-&gt;rasterize_vector_images AND (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &gt; 0) AND (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &gt; 0)) {
<a name="l18875"></a>18875             <span class="comment">// convert EPS to raster image using GD or ImageMagick libraries</span>
<a name="l18876"></a>18876             <span class="keywordflow">return</span> $this-&gt;Image(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;EPS&#39;</span>, $link, $align, <span class="keyword">true</span>, 300, $palign, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, $fitonpage);
<a name="l18877"></a>18877         }
<a name="l18878"></a>18878         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l18879"></a>18879             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l18880"></a>18880         }
<a name="l18881"></a>18881         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l18882"></a>18882             $y = $this-&gt;y;
<a name="l18883"></a>18883         }
<a name="l18884"></a>18884         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l18885"></a>18885         list(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;checkPageRegions(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l18886"></a>18886         $k = $this-&gt;k;
<a name="l18887"></a>18887         <span class="keywordflow">if</span> (<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>{0} === <span class="charliteral">&#39;@&#39;</span>) { <span class="comment">// image from string</span>
<a name="l18888"></a>18888             <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, 1);
<a name="l18889"></a>18889         } <span class="keywordflow">else</span> { <span class="comment">// EPS/AI file</span>
<a name="l18890"></a>18890             <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = file_get_contents(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l18891"></a>18891         }
<a name="l18892"></a>18892         <span class="keywordflow">if</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> === <span class="keyword">false</span>) {
<a name="l18893"></a>18893             $this-&gt;Error(<span class="stringliteral">&#39;EPS file not found: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l18894"></a>18894         }
<a name="l18895"></a>18895         $regs = array();
<a name="l18896"></a>18896         <span class="comment">// EPS/AI compatibility check (only checks files created by Adobe Illustrator!)</span>
<a name="l18897"></a>18897         preg_match(<span class="stringliteral">&quot;/%%Creator:([^\r\n]+)/&quot;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, $regs); # find Creator
<a name="l18898"></a>18898         <span class="keywordflow">if</span> (count($regs) &gt; 1) {
<a name="l18899"></a>18899             $version_str = trim($regs[1]); # e.g. <span class="stringliteral">&quot;Adobe Illustrator(R) 8.0&quot;</span>
<a name="l18900"></a>18900             <span class="keywordflow">if</span> (strpos($version_str, <span class="stringliteral">&#39;Adobe Illustrator&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l18901"></a>18901                 $versexp = explode(<span class="charliteral">&#39; &#39;</span>, $version_str);
<a name="l18902"></a>18902                 $version = (<a class="code" href="original_2css_2theme__right_8css_8php.html#a5b5bc99dd62da39d31b482f44ce98f06">float</a>)array_pop($versexp);
<a name="l18903"></a>18903                 <span class="keywordflow">if</span> ($version &gt;= 9) {
<a name="l18904"></a>18904                     $this-&gt;Error(<span class="stringliteral">&#39;This version of Adobe Illustrator file is not supported: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l18905"></a>18905                 }
<a name="l18906"></a>18906             }
<a name="l18907"></a>18907         }
<a name="l18908"></a>18908         <span class="comment">// strip binary bytes in front of PS-header</span>
<a name="l18909"></a>18909         <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a> = strpos(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <span class="stringliteral">&#39;%!PS-Adobe&#39;</span>);
<a name="l18910"></a>18910         <span class="keywordflow">if</span> (<a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a> &gt; 0) {
<a name="l18911"></a>18911             <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = substr(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a>);
<a name="l18912"></a>18912         }
<a name="l18913"></a>18913         <span class="comment">// find BoundingBox params</span>
<a name="l18914"></a>18914         preg_match(<span class="stringliteral">&quot;/%%BoundingBox:([^\r\n]+)/&quot;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, $regs);
<a name="l18915"></a>18915         <span class="keywordflow">if</span> (count($regs) &gt; 1) {
<a name="l18916"></a>18916             list($x1, $y1, $x2, $y2) = explode(<span class="charliteral">&#39; &#39;</span>, trim($regs[1]));
<a name="l18917"></a>18917         } <span class="keywordflow">else</span> {
<a name="l18918"></a>18918             $this-&gt;Error(<span class="stringliteral">&#39;No BoundingBox found in EPS/AI file: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l18919"></a>18919         }
<a name="l18920"></a>18920         <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a> = strpos(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <span class="stringliteral">&#39;%%EndSetup&#39;</span>);
<a name="l18921"></a>18921         <span class="keywordflow">if</span> (<a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a> === <span class="keyword">false</span>) {
<a name="l18922"></a>18922             <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a> = strpos(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <span class="stringliteral">&#39;%%EndProlog&#39;</span>);
<a name="l18923"></a>18923         }
<a name="l18924"></a>18924         <span class="keywordflow">if</span> (<a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a> === <span class="keyword">false</span>) {
<a name="l18925"></a>18925             <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a> = strpos(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <span class="stringliteral">&#39;%%BoundingBox&#39;</span>);
<a name="l18926"></a>18926         }
<a name="l18927"></a>18927         <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = substr(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <a class="code" href="query_8php.html#a50a00e7de77365e00b117e73aa82fb9b">$start</a>);
<a name="l18928"></a>18928         $end = strpos(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <span class="stringliteral">&#39;%%PageTrailer&#39;</span>);
<a name="l18929"></a>18929         <span class="keywordflow">if</span> ($end===<span class="keyword">false</span>) {
<a name="l18930"></a>18930             $end = strpos(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <span class="stringliteral">&#39;showpage&#39;</span>);
<a name="l18931"></a>18931         }
<a name="l18932"></a>18932         <span class="keywordflow">if</span> ($end) {
<a name="l18933"></a>18933             <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = substr(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, 0, $end);
<a name="l18934"></a>18934         }
<a name="l18935"></a>18935         <span class="comment">// calculate image width and height on document</span>
<a name="l18936"></a>18936         <span class="keywordflow">if</span> ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0) AND (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0)) {
<a name="l18937"></a>18937             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = ($x2 - $x1) / $k;
<a name="l18938"></a>18938             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = ($y2 - $y1) / $k;
<a name="l18939"></a>18939         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0) {
<a name="l18940"></a>18940             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = ($x2-$x1) / $k * (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> / (($y2 - $y1) / $k));
<a name="l18941"></a>18941         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0) {
<a name="l18942"></a>18942             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = ($y2 - $y1) / $k * (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> / (($x2 - $x1) / $k));
<a name="l18943"></a>18943         }
<a name="l18944"></a>18944         <span class="comment">// fit the image on available space</span>
<a name="l18945"></a>18945         list(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;fitBlock(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $fitonpage);
<a name="l18946"></a>18946         <span class="keywordflow">if</span> ($this-&gt;rasterize_vector_images) {
<a name="l18947"></a>18947             <span class="comment">// convert EPS to raster image using GD or ImageMagick libraries</span>
<a name="l18948"></a>18948             <span class="keywordflow">return</span> $this-&gt;Image(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;EPS&#39;</span>, $link, $align, <span class="keyword">true</span>, 300, $palign, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, $fitonpage);
<a name="l18949"></a>18949         }
<a name="l18950"></a>18950         <span class="comment">// set scaling factors</span>
<a name="l18951"></a>18951         $scale_x = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> / (($x2 - $x1) / $k);
<a name="l18952"></a>18952         $scale_y = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> / (($y2 - $y1) / $k);
<a name="l18953"></a>18953         <span class="comment">// set alignment</span>
<a name="l18954"></a>18954         $this-&gt;img_rb_y = $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l18955"></a>18955         <span class="comment">// set alignment</span>
<a name="l18956"></a>18956         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l18957"></a>18957             <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l18958"></a>18958                 $ximg = $this-&gt;lMargin;
<a name="l18959"></a>18959             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l18960"></a>18960                 $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l18961"></a>18961             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l18962"></a>18962                 $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l18963"></a>18963             } <span class="keywordflow">else</span> {
<a name="l18964"></a>18964                 $ximg = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l18965"></a>18965             }
<a name="l18966"></a>18966             $this-&gt;img_rb_x = $ximg;
<a name="l18967"></a>18967         } <span class="keywordflow">else</span> {
<a name="l18968"></a>18968             <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l18969"></a>18969                 $ximg = $this-&gt;lMargin;
<a name="l18970"></a>18970             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l18971"></a>18971                 $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l18972"></a>18972             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l18973"></a>18973                 $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l18974"></a>18974             } <span class="keywordflow">else</span> {
<a name="l18975"></a>18975                 $ximg = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l18976"></a>18976             }
<a name="l18977"></a>18977             $this-&gt;img_rb_x = $ximg + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l18978"></a>18978         }
<a name="l18979"></a>18979         <span class="keywordflow">if</span> ($useBoundingBox) {
<a name="l18980"></a>18980             $dx = $ximg * $k - $x1;
<a name="l18981"></a>18981             $dy = $y * $k - $y1;
<a name="l18982"></a>18982         } <span class="keywordflow">else</span> {
<a name="l18983"></a>18983             $dx = $ximg * $k;
<a name="l18984"></a>18984             $dy = $y * $k;
<a name="l18985"></a>18985         }
<a name="l18986"></a>18986         <span class="comment">// save the current graphic state</span>
<a name="l18987"></a>18987         $this-&gt;_out(<span class="charliteral">&#39;q&#39;</span>.$this-&gt;epsmarker);
<a name="l18988"></a>18988         <span class="comment">// translate</span>
<a name="l18989"></a>18989         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F %.3F %.3F %.3F cm&#39;</span>, 1, 0, 0, 1, $dx, $dy + ($this-&gt;hPt - (2 * $y * $k) - ($y2 - $y1))));
<a name="l18990"></a>18990         <span class="comment">// scale</span>
<a name="l18991"></a>18991         <span class="keywordflow">if</span> (isset($scale_x)) {
<a name="l18992"></a>18992             $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F %.3F %.3F %.3F cm&#39;</span>, $scale_x, 0, 0, $scale_y, $x1 * (1 - $scale_x), $y2 * (1 - $scale_y)));
<a name="l18993"></a>18993         }
<a name="l18994"></a>18994         <span class="comment">// handle pc/unix/mac line endings</span>
<a name="l18995"></a>18995         $lines = preg_split(<span class="stringliteral">&#39;/[\r\n]+/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, -1, PREG_SPLIT_NO_EMPTY);
<a name="l18996"></a>18996         $u=0;
<a name="l18997"></a>18997         $cnt = count($lines);
<a name="l18998"></a>18998         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>=0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $cnt; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l18999"></a>18999             <a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a> = $lines[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>];
<a name="l19000"></a>19000             <span class="keywordflow">if</span> ((<a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a> == <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>{0} == <span class="charliteral">&#39;%&#39;</span>)) {
<a name="l19001"></a>19001                 <span class="keywordflow">continue</span>;
<a name="l19002"></a>19002             }
<a name="l19003"></a>19003             <a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a> = strlen(<a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>);
<a name="l19004"></a>19004             <span class="comment">// check for spot color names</span>
<a name="l19005"></a>19005             $color_name = <span class="stringliteral">&#39;&#39;</span>;
<a name="l19006"></a>19006             <span class="keywordflow">if</span> (strcasecmp(<span class="charliteral">&#39;x&#39;</span>, substr(trim(<a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>), -1)) == 0) {
<a name="l19007"></a>19007                 <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/\([^\)]*\)/&#39;</span>, <a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>, $matches) &gt; 0) {
<a name="l19008"></a>19008                     <span class="comment">// extract spot color name</span>
<a name="l19009"></a>19009                     $color_name = $matches[0];
<a name="l19010"></a>19010                     <span class="comment">// remove color name from string</span>
<a name="l19011"></a>19011                     <a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a> = str_replace(<span class="charliteral">&#39; &#39;</span>.$color_name, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>);
<a name="l19012"></a>19012                     <span class="comment">// remove pharentesis from color name</span>
<a name="l19013"></a>19013                     $color_name = substr($color_name, 1, -1);
<a name="l19014"></a>19014                 }
<a name="l19015"></a>19015             }
<a name="l19016"></a>19016             $chunks = explode(<span class="charliteral">&#39; &#39;</span>, <a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>);
<a name="l19017"></a>19017             $cmd = trim(array_pop($chunks));
<a name="l19018"></a>19018             <span class="comment">// RGB</span>
<a name="l19019"></a>19019             <span class="keywordflow">if</span> (($cmd == <span class="stringliteral">&#39;Xa&#39;</span>) OR ($cmd == <span class="stringliteral">&#39;XA&#39;</span>)) {
<a name="l19020"></a>19020                 $b = array_pop($chunks);
<a name="l19021"></a>19021                 $g = array_pop($chunks);
<a name="l19022"></a>19022                 <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = array_pop($chunks);
<a name="l19023"></a>19023                 $this-&gt;_out(<span class="stringliteral">&#39;&#39;</span>.<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>.<span class="charliteral">&#39; &#39;</span>.$g.<span class="charliteral">&#39; &#39;</span>.$b.<span class="charliteral">&#39; &#39;</span>.($cmd==<span class="stringliteral">&#39;Xa&#39;</span>?<span class="stringliteral">&#39;rg&#39;</span>:<span class="stringliteral">&#39;RG&#39;</span>)); <span class="comment">//substr($line, 0, -2).&#39;rg&#39; -&gt; in EPS (AI8): c m y k r g b rg!</span>
<a name="l19024"></a>19024                 <span class="keywordflow">continue</span>;
<a name="l19025"></a>19025             }
<a name="l19026"></a>19026             $skip = <span class="keyword">false</span>;
<a name="l19027"></a>19027             <span class="keywordflow">if</span> ($fixoutvals) {
<a name="l19028"></a>19028                 <span class="comment">// check for values outside the bounding box</span>
<a name="l19029"></a>19029                 <span class="keywordflow">switch</span> ($cmd) {
<a name="l19030"></a>19030                     <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:
<a name="l19031"></a>19031                     <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:
<a name="l19032"></a>19032                     <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {
<a name="l19033"></a>19033                         <span class="comment">// skip values outside bounding box</span>
<a name="l19034"></a>19034                         <span class="keywordflow">foreach</span> ($chunks as $key =&gt; $val) {
<a name="l19035"></a>19035                             <span class="keywordflow">if</span> ((($key % 2) == 0) AND (($val &lt; $x1) OR ($val &gt; $x2))) {
<a name="l19036"></a>19036                                 $skip = <span class="keyword">true</span>;
<a name="l19037"></a>19037                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((($key % 2) != 0) AND (($val &lt; $y1) OR ($val &gt; $y2))) {
<a name="l19038"></a>19038                                 $skip = <span class="keyword">true</span>;
<a name="l19039"></a>19039                             }
<a name="l19040"></a>19040                         }
<a name="l19041"></a>19041                     }
<a name="l19042"></a>19042                 }
<a name="l19043"></a>19043             }
<a name="l19044"></a>19044             <span class="keywordflow">switch</span> ($cmd) {
<a name="l19045"></a>19045                 <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:
<a name="l19046"></a>19046                 <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:
<a name="l19047"></a>19047                 <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>:
<a name="l19048"></a>19048                 <span class="keywordflow">case</span> <span class="charliteral">&#39;y&#39;</span>:
<a name="l19049"></a>19049                 <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:
<a name="l19050"></a>19050                 <span class="keywordflow">case</span> <span class="charliteral">&#39;k&#39;</span>:
<a name="l19051"></a>19051                 <span class="keywordflow">case</span> <span class="charliteral">&#39;K&#39;</span>:
<a name="l19052"></a>19052                 <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>:
<a name="l19053"></a>19053                 <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>:
<a name="l19054"></a>19054                 <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:
<a name="l19055"></a>19055                 <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:
<a name="l19056"></a>19056                 <span class="keywordflow">case</span> <span class="charliteral">&#39;J&#39;</span>:
<a name="l19057"></a>19057                 <span class="keywordflow">case</span> <span class="charliteral">&#39;j&#39;</span>:
<a name="l19058"></a>19058                 <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:
<a name="l19059"></a>19059                 <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:
<a name="l19060"></a>19060                 <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:
<a name="l19061"></a>19061                 <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>: {
<a name="l19062"></a>19062                     <span class="keywordflow">if</span> ($skip) {
<a name="l19063"></a>19063                         <span class="keywordflow">break</span>;
<a name="l19064"></a>19064                     }
<a name="l19065"></a>19065                     $this-&gt;_out(<a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>);
<a name="l19066"></a>19066                     <span class="keywordflow">break</span>;
<a name="l19067"></a>19067                 }
<a name="l19068"></a>19068                 <span class="keywordflow">case</span> <span class="charliteral">&#39;x&#39;</span>: {<span class="comment">// custom fill color</span>
<a name="l19069"></a>19069                     <span class="keywordflow">if</span> (empty($color_name)) {
<a name="l19070"></a>19070                         <span class="comment">// CMYK color</span>
<a name="l19071"></a>19071                         list($col_c, $col_m, $col_y, $col_k) = $chunks;
<a name="l19072"></a>19072                         $this-&gt;_out(<span class="stringliteral">&#39;&#39;</span>.$col_c.<span class="charliteral">&#39; &#39;</span>.$col_m.<span class="charliteral">&#39; &#39;</span>.$col_y.<span class="charliteral">&#39; &#39;</span>.$col_k.<span class="stringliteral">&#39; k&#39;</span>);
<a name="l19073"></a>19073                     } <span class="keywordflow">else</span> {
<a name="l19074"></a>19074                         <span class="comment">// Spot Color (CMYK + tint)</span>
<a name="l19075"></a>19075                         list($col_c, $col_m, $col_y, $col_k, $col_t) = $chunks;
<a name="l19076"></a>19076                         $this-&gt;AddSpotColor($color_name, ($col_c * 100), ($col_m * 100), ($col_y * 100), ($col_k * 100));
<a name="l19077"></a>19077                         $color_cmd = sprintf(<span class="stringliteral">&#39;/CS%d cs %.3F scn&#39;</span>, $this-&gt;spot_colors[$color_name][<span class="charliteral">&#39;i&#39;</span>], (1 - $col_t));
<a name="l19078"></a>19078                         $this-&gt;_out($color_cmd);
<a name="l19079"></a>19079                     }
<a name="l19080"></a>19080                     <span class="keywordflow">break</span>;
<a name="l19081"></a>19081                 }
<a name="l19082"></a>19082                 <span class="keywordflow">case</span> <span class="charliteral">&#39;X&#39;</span>: { <span class="comment">// custom stroke color</span>
<a name="l19083"></a>19083                     <span class="keywordflow">if</span> (empty($color_name)) {
<a name="l19084"></a>19084                         <span class="comment">// CMYK color</span>
<a name="l19085"></a>19085                         list($col_c, $col_m, $col_y, $col_k) = $chunks;
<a name="l19086"></a>19086                         $this-&gt;_out(<span class="stringliteral">&#39;&#39;</span>.$col_c.<span class="charliteral">&#39; &#39;</span>.$col_m.<span class="charliteral">&#39; &#39;</span>.$col_y.<span class="charliteral">&#39; &#39;</span>.$col_k.<span class="stringliteral">&#39; K&#39;</span>);
<a name="l19087"></a>19087                     } <span class="keywordflow">else</span> {
<a name="l19088"></a>19088                         <span class="comment">// Spot Color (CMYK + tint)</span>
<a name="l19089"></a>19089                         list($col_c, $col_m, $col_y, $col_k, $col_t) = $chunks;
<a name="l19090"></a>19090                         $this-&gt;AddSpotColor($color_name, ($col_c * 100), ($col_m * 100), ($col_y * 100), ($col_k * 100));
<a name="l19091"></a>19091                         $color_cmd = sprintf(<span class="stringliteral">&#39;/CS%d CS %.3F SCN&#39;</span>, $this-&gt;spot_colors[$color_name][<span class="charliteral">&#39;i&#39;</span>], (1 - $col_t));
<a name="l19092"></a>19092                         $this-&gt;_out($color_cmd);
<a name="l19093"></a>19093                     }
<a name="l19094"></a>19094                     <span class="keywordflow">break</span>;
<a name="l19095"></a>19095                 }
<a name="l19096"></a>19096                 <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>:
<a name="l19097"></a>19097                 <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:
<a name="l19098"></a>19098                 <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>:
<a name="l19099"></a>19099                 <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:
<a name="l19100"></a>19100                 <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {
<a name="l19101"></a>19101                     <span class="keywordflow">if</span> ($skip) {
<a name="l19102"></a>19102                         <span class="keywordflow">break</span>;
<a name="l19103"></a>19103                     }
<a name="l19104"></a>19104                     <a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>[(<a class="code" href="import_2csv_8php.html#aa28657aaa5fcc7509dd883662f8accbe">$len</a> - 1)] = strtolower($cmd);
<a name="l19105"></a>19105                     $this-&gt;_out(<a class="code" href="import_2csv_8php.html#a52f469b0182d9abac2d0f20548680c9c">$line</a>);
<a name="l19106"></a>19106                     <span class="keywordflow">break</span>;
<a name="l19107"></a>19107                 }
<a name="l19108"></a>19108                 <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:
<a name="l19109"></a>19109                 <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l19110"></a>19110                     $this-&gt;_out($cmd . <span class="charliteral">&#39;*&#39;</span>);
<a name="l19111"></a>19111                     <span class="keywordflow">break</span>;
<a name="l19112"></a>19112                 }
<a name="l19113"></a>19113                 <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:
<a name="l19114"></a>19114                 <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>: {
<a name="l19115"></a>19115                     <span class="keywordflow">if</span> ($u &gt; 0) {
<a name="l19116"></a>19116                         $isU = <span class="keyword">false</span>;
<a name="l19117"></a>19117                         $max = min((<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 5), $cnt);
<a name="l19118"></a>19118                         <span class="keywordflow">for</span> ($j = (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 1); $j &lt; $max; ++$j) {
<a name="l19119"></a>19119                             $isU = ($isU OR (($lines[$j] == <span class="charliteral">&#39;U&#39;</span>) OR ($lines[$j] == <span class="stringliteral">&#39;*U&#39;</span>)));
<a name="l19120"></a>19120                         }
<a name="l19121"></a>19121                         <span class="keywordflow">if</span> ($isU) {
<a name="l19122"></a>19122                             $this-&gt;_out(<span class="stringliteral">&#39;f*&#39;</span>);
<a name="l19123"></a>19123                         }
<a name="l19124"></a>19124                     } <span class="keywordflow">else</span> {
<a name="l19125"></a>19125                         $this-&gt;_out(<span class="stringliteral">&#39;f*&#39;</span>);
<a name="l19126"></a>19126                     }
<a name="l19127"></a>19127                     <span class="keywordflow">break</span>;
<a name="l19128"></a>19128                 }
<a name="l19129"></a>19129                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;*u&#39;</span>: {
<a name="l19130"></a>19130                     ++$u;
<a name="l19131"></a>19131                     <span class="keywordflow">break</span>;
<a name="l19132"></a>19132                 }
<a name="l19133"></a>19133                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;*U&#39;</span>: {
<a name="l19134"></a>19134                     --$u;
<a name="l19135"></a>19135                     <span class="keywordflow">break</span>;
<a name="l19136"></a>19136                 }
<a name="l19137"></a>19137             }
<a name="l19138"></a>19138         }
<a name="l19139"></a>19139         <span class="comment">// restore previous graphic state</span>
<a name="l19140"></a>19140         $this-&gt;_out($this-&gt;epsmarker.<span class="charliteral">&#39;Q&#39;</span>);
<a name="l19141"></a>19141         <span class="keywordflow">if</span> (!empty($border)) {
<a name="l19142"></a>19142             $bx = $this-&gt;x;
<a name="l19143"></a>19143             $by = $this-&gt;y;
<a name="l19144"></a>19144             $this-&gt;x = $ximg;
<a name="l19145"></a>19145             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l19146"></a>19146                 $this-&gt;x += <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19147"></a>19147             }
<a name="l19148"></a>19148             $this-&gt;y = $y;
<a name="l19149"></a>19149             $this-&gt;Cell(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $h, <span class="stringliteral">&#39;&#39;</span>, $border, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>);
<a name="l19150"></a>19150             $this-&gt;x = $bx;
<a name="l19151"></a>19151             $this-&gt;y = $by;
<a name="l19152"></a>19152         }
<a name="l19153"></a>19153         <span class="keywordflow">if</span> ($link) {
<a name="l19154"></a>19154             $this-&gt;Link($ximg, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $h, $link, 0);
<a name="l19155"></a>19155         }
<a name="l19156"></a>19156         <span class="comment">// set pointer to align the next text/objects</span>
<a name="l19157"></a>19157         <span class="keywordflow">switch</span>($align) {
<a name="l19158"></a>19158             <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:{
<a name="l19159"></a>19159                 $this-&gt;y = $y;
<a name="l19160"></a>19160                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l19161"></a>19161                 <span class="keywordflow">break</span>;
<a name="l19162"></a>19162             }
<a name="l19163"></a>19163             <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:{
<a name="l19164"></a>19164                 $this-&gt;y = $y + round($h/2);
<a name="l19165"></a>19165                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l19166"></a>19166                 <span class="keywordflow">break</span>;
<a name="l19167"></a>19167             }
<a name="l19168"></a>19168             <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:{
<a name="l19169"></a>19169                 $this-&gt;y = $this-&gt;img_rb_y;
<a name="l19170"></a>19170                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l19171"></a>19171                 <span class="keywordflow">break</span>;
<a name="l19172"></a>19172             }
<a name="l19173"></a>19173             <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:{
<a name="l19174"></a>19174                 $this-&gt;SetY($this-&gt;img_rb_y);
<a name="l19175"></a>19175                 <span class="keywordflow">break</span>;
<a name="l19176"></a>19176             }
<a name="l19177"></a>19177             <span class="keywordflow">default</span>:{
<a name="l19178"></a>19178                 <span class="keywordflow">break</span>;
<a name="l19179"></a>19179             }
<a name="l19180"></a>19180         }
<a name="l19181"></a>19181         $this-&gt;endlinex = $this-&gt;img_rb_x;
<a name="l19182"></a>19182     }
<a name="l19183"></a>19183 <span class="comment"></span>
<a name="l19184"></a>19184 <span class="comment">    /**</span>
<a name="l19185"></a>19185 <span class="comment">     * Set document barcode.</span>
<a name="l19186"></a>19186 <span class="comment">     * @param $bc (string) barcode</span>
<a name="l19187"></a>19187 <span class="comment">     * @public</span>
<a name="l19188"></a>19188 <span class="comment">     */</span>
<a name="l19189"></a><a class="code" href="classTCPDF.html#ad66f051c544895eb0a35ad0e033c3fa9">19189</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad66f051c544895eb0a35ad0e033c3fa9" title="Set document barcode.">setBarcode</a>($bc=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l19190"></a>19190         $this-&gt;barcode = $bc;
<a name="l19191"></a>19191     }
<a name="l19192"></a>19192 <span class="comment"></span>
<a name="l19193"></a>19193 <span class="comment">    /**</span>
<a name="l19194"></a>19194 <span class="comment">     * Get current barcode.</span>
<a name="l19195"></a>19195 <span class="comment">     * @return string</span>
<a name="l19196"></a>19196 <span class="comment">     * @public</span>
<a name="l19197"></a>19197 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l19198"></a>19198 <span class="comment">     */</span>
<a name="l19199"></a><a class="code" href="classTCPDF.html#aa3deb91c4ae36afa6253c831df589b3d">19199</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa3deb91c4ae36afa6253c831df589b3d" title="Get current barcode.">getBarcode</a>() {
<a name="l19200"></a>19200         <span class="keywordflow">return</span> $this-&gt;barcode;
<a name="l19201"></a>19201     }
<a name="l19202"></a>19202 <span class="comment"></span>
<a name="l19203"></a>19203 <span class="comment">    /**</span>
<a name="l19204"></a>19204 <span class="comment">     * Print a Linear Barcode.</span>
<a name="l19205"></a>19205 <span class="comment">     * @param $code (string) code to print</span>
<a name="l19206"></a>19206 <span class="comment">     * @param $type (string) type of barcode (see barcodes.php for supported formats).</span>
<a name="l19207"></a>19207 <span class="comment">     * @param $x (int) x position in user units (empty string = current x position)</span>
<a name="l19208"></a>19208 <span class="comment">     * @param $y (int) y position in user units (empty string = current y position)</span>
<a name="l19209"></a>19209 <span class="comment">     * @param $w (int) width in user units (empty string = remaining page width)</span>
<a name="l19210"></a>19210 <span class="comment">     * @param $h (int) height in user units (empty string = remaining page height)</span>
<a name="l19211"></a>19211 <span class="comment">     * @param $xres (float) width of the smallest bar in user units (empty string = default value = 0.4mm)</span>
<a name="l19212"></a>19212 <span class="comment">     * @param $style (array) array of options:&lt;ul&gt;</span>
<a name="l19213"></a>19213 <span class="comment">     * &lt;li&gt;boolean $style[&#39;border&#39;] if true prints a border&lt;/li&gt;</span>
<a name="l19214"></a>19214 <span class="comment">     * &lt;li&gt;int $style[&#39;padding&#39;] padding to leave around the barcode in user units (set to &#39;auto&#39; for automatic padding)&lt;/li&gt;</span>
<a name="l19215"></a>19215 <span class="comment">     * &lt;li&gt;int $style[&#39;hpadding&#39;] horizontal padding in user units (set to &#39;auto&#39; for automatic padding)&lt;/li&gt;</span>
<a name="l19216"></a>19216 <span class="comment">     * &lt;li&gt;int $style[&#39;vpadding&#39;] vertical padding in user units (set to &#39;auto&#39; for automatic padding)&lt;/li&gt;</span>
<a name="l19217"></a>19217 <span class="comment">     * &lt;li&gt;array $style[&#39;fgcolor&#39;] color array for bars and text&lt;/li&gt;</span>
<a name="l19218"></a>19218 <span class="comment">     * &lt;li&gt;mixed $style[&#39;bgcolor&#39;] color array for background (set to false for transparent)&lt;/li&gt;</span>
<a name="l19219"></a>19219 <span class="comment">     * &lt;li&gt;boolean $style[&#39;text&#39;] if true prints text below the barcode&lt;/li&gt;</span>
<a name="l19220"></a>19220 <span class="comment">     * &lt;li&gt;string $style[&#39;label&#39;] override default label&lt;/li&gt;</span>
<a name="l19221"></a>19221 <span class="comment">     * &lt;li&gt;string $style[&#39;font&#39;] font name for text&lt;/li&gt;&lt;li&gt;int $style[&#39;fontsize&#39;] font size for text&lt;/li&gt;</span>
<a name="l19222"></a>19222 <span class="comment">     * &lt;li&gt;int $style[&#39;stretchtext&#39;]: 0 = disabled; 1 = horizontal scaling only if necessary; 2 = forced horizontal scaling; 3 = character spacing only if necessary; 4 = forced character spacing.&lt;/li&gt;</span>
<a name="l19223"></a>19223 <span class="comment">     * &lt;li&gt;string $style[&#39;position&#39;] horizontal position of the containing barcode cell on the page: L = left margin; C = center; R = right margin.&lt;/li&gt;</span>
<a name="l19224"></a>19224 <span class="comment">     * &lt;li&gt;string $style[&#39;align&#39;] horizontal position of the barcode on the containing rectangle: L = left; C = center; R = right.&lt;/li&gt;</span>
<a name="l19225"></a>19225 <span class="comment">     * &lt;li&gt;string $style[&#39;stretch&#39;] if true stretch the barcode to best fit the available width, otherwise uses $xres resolution for a single bar.&lt;/li&gt;</span>
<a name="l19226"></a>19226 <span class="comment">     * &lt;li&gt;string $style[&#39;fitwidth&#39;] if true reduce the width to fit the barcode width + padding. When this option is enabled the &#39;stretch&#39; option is automatically disabled.&lt;/li&gt;</span>
<a name="l19227"></a>19227 <span class="comment">     * &lt;li&gt;string $style[&#39;cellfitalign&#39;] this option works only when &#39;fitwidth&#39; is true and &#39;position&#39; is unset or empty. Set the horizontal position of the containing barcode cell inside the specified rectangle: L = left; C = center; R = right.&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l19228"></a>19228 <span class="comment">     * @param $align (string) Indicates the alignment of the pointer next to barcode insertion relative to barcode height. The value can be:&lt;ul&gt;&lt;li&gt;T: top-right for LTR or top-left for RTL&lt;/li&gt;&lt;li&gt;M: middle-right for LTR or middle-left for RTL&lt;/li&gt;&lt;li&gt;B: bottom-right for LTR or bottom-left for RTL&lt;/li&gt;&lt;li&gt;N: next line&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l19229"></a>19229 <span class="comment">     * @author Nicola Asuni</span>
<a name="l19230"></a>19230 <span class="comment">     * @since 3.1.000 (2008-06-09)</span>
<a name="l19231"></a>19231 <span class="comment">     * @public</span>
<a name="l19232"></a>19232 <span class="comment">     */</span>
<a name="l19233"></a><a class="code" href="classTCPDF.html#a4816d61822a4bad6e35bb441c1699aab">19233</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4816d61822a4bad6e35bb441c1699aab" title="Print a Linear Barcode.">write1DBarcode</a>($code, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=<span class="stringliteral">&#39;&#39;</span>, $xres=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $align=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l19234"></a>19234         <span class="keywordflow">if</span> ($this-&gt;empty_string(trim($code))) {
<a name="l19235"></a>19235             <span class="keywordflow">return</span>;
<a name="l19236"></a>19236         }
<a name="l19237"></a>19237         require_once(dirname(__FILE__).<span class="stringliteral">&#39;/barcodes.php&#39;</span>);
<a name="l19238"></a>19238         <span class="comment">// save current graphic settings</span>
<a name="l19239"></a>19239         $gvars = $this-&gt;getGraphicVars();
<a name="l19240"></a>19240         <span class="comment">// create new barcode object</span>
<a name="l19241"></a>19241         $barcodeobj = <span class="keyword">new</span> TCPDFBarcode($code, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l19242"></a>19242         $arrcode = $barcodeobj-&gt;getBarcodeArray();
<a name="l19243"></a>19243         <span class="keywordflow">if</span> ($arrcode === <span class="keyword">false</span>) {
<a name="l19244"></a>19244             $this-&gt;Error(<span class="stringliteral">&#39;Error in 1D barcode string&#39;</span>);
<a name="l19245"></a>19245         }
<a name="l19246"></a>19246         <span class="comment">// set default values</span>
<a name="l19247"></a>19247         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;position&#39;</span>])) {
<a name="l19248"></a>19248             $style[<span class="stringliteral">&#39;position&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l19249"></a>19249         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;S&#39;</span>) {
<a name="l19250"></a>19250             <span class="comment">// keep this for backward compatibility</span>
<a name="l19251"></a>19251             $style[<span class="stringliteral">&#39;position&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l19252"></a>19252             $style[<span class="stringliteral">&#39;stretch&#39;</span>] = <span class="keyword">true</span>;
<a name="l19253"></a>19253         }
<a name="l19254"></a>19254         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;fitwidth&#39;</span>])) {
<a name="l19255"></a>19255             <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;stretch&#39;</span>])) {
<a name="l19256"></a>19256                 $style[<span class="stringliteral">&#39;fitwidth&#39;</span>] = <span class="keyword">true</span>;
<a name="l19257"></a>19257             } <span class="keywordflow">else</span> {
<a name="l19258"></a>19258                 $style[<span class="stringliteral">&#39;fitwidth&#39;</span>] = <span class="keyword">false</span>;
<a name="l19259"></a>19259             }
<a name="l19260"></a>19260         }
<a name="l19261"></a>19261         <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;fitwidth&#39;</span>]) {
<a name="l19262"></a>19262             <span class="comment">// disable stretch</span>
<a name="l19263"></a>19263             $style[<span class="stringliteral">&#39;stretch&#39;</span>] = <span class="keyword">false</span>;
<a name="l19264"></a>19264         }
<a name="l19265"></a>19265         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;stretch&#39;</span>])) {
<a name="l19266"></a>19266             <span class="keywordflow">if</span> ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0)) {
<a name="l19267"></a>19267                 $style[<span class="stringliteral">&#39;stretch&#39;</span>] = <span class="keyword">false</span>;
<a name="l19268"></a>19268             } <span class="keywordflow">else</span> {
<a name="l19269"></a>19269                 $style[<span class="stringliteral">&#39;stretch&#39;</span>] = <span class="keyword">true</span>;
<a name="l19270"></a>19270             }
<a name="l19271"></a>19271         }
<a name="l19272"></a>19272         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;fgcolor&#39;</span>])) {
<a name="l19273"></a>19273             $style[<span class="stringliteral">&#39;fgcolor&#39;</span>] = array(0,0,0); <span class="comment">// default black</span>
<a name="l19274"></a>19274         }
<a name="l19275"></a>19275         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;bgcolor&#39;</span>])) {
<a name="l19276"></a>19276             $style[<span class="stringliteral">&#39;bgcolor&#39;</span>] = <span class="keyword">false</span>; <span class="comment">// default transparent</span>
<a name="l19277"></a>19277         }
<a name="l19278"></a>19278         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;border&#39;</span>])) {
<a name="l19279"></a>19279             $style[<span class="stringliteral">&#39;border&#39;</span>] = <span class="keyword">false</span>;
<a name="l19280"></a>19280         }
<a name="l19281"></a>19281         <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> = 0;
<a name="l19282"></a>19282         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;text&#39;</span>])) {
<a name="l19283"></a>19283             $style[<span class="stringliteral">&#39;text&#39;</span>] = <span class="keyword">false</span>;
<a name="l19284"></a>19284         }
<a name="l19285"></a>19285         <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;text&#39;</span>] AND isset($style[<span class="stringliteral">&#39;font&#39;</span>])) {
<a name="l19286"></a>19286             <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;fontsize&#39;</span>])) {
<a name="l19287"></a>19287                 <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> = $style[<span class="stringliteral">&#39;fontsize&#39;</span>];
<a name="l19288"></a>19288             }
<a name="l19289"></a>19289             $this-&gt;SetFont($style[<span class="stringliteral">&#39;font&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>);
<a name="l19290"></a>19290         }
<a name="l19291"></a>19291         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;stretchtext&#39;</span>])) {
<a name="l19292"></a>19292             $style[<span class="stringliteral">&#39;stretchtext&#39;</span>] = 4;
<a name="l19293"></a>19293         }
<a name="l19294"></a>19294         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l19295"></a>19295             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l19296"></a>19296         }
<a name="l19297"></a>19297         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l19298"></a>19298             $y = $this-&gt;y;
<a name="l19299"></a>19299         }
<a name="l19300"></a>19300         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l19301"></a>19301         list(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;checkPageRegions(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l19302"></a>19302         <span class="keywordflow">if</span> ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0)) {
<a name="l19303"></a>19303             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l19304"></a>19304                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - $this-&gt;lMargin;
<a name="l19305"></a>19305             } <span class="keywordflow">else</span> {
<a name="l19306"></a>19306                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l19307"></a>19307             }
<a name="l19308"></a>19308         }
<a name="l19309"></a>19309         <span class="comment">// padding</span>
<a name="l19310"></a>19310         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;padding&#39;</span>])) {
<a name="l19311"></a>19311             $padding = 0;
<a name="l19312"></a>19312         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;padding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {
<a name="l19313"></a>19313             $padding = 10 * (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> / ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] + 20));
<a name="l19314"></a>19314         } <span class="keywordflow">else</span> {
<a name="l19315"></a>19315             $padding = floatval($style[<span class="stringliteral">&#39;padding&#39;</span>]);
<a name="l19316"></a>19316         }
<a name="l19317"></a>19317         <span class="comment">// horizontal padding</span>
<a name="l19318"></a>19318         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;hpadding&#39;</span>])) {
<a name="l19319"></a>19319             $hpadding = $padding;
<a name="l19320"></a>19320         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;hpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {
<a name="l19321"></a>19321             $hpadding = 10 * (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> / ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] + 20));
<a name="l19322"></a>19322         } <span class="keywordflow">else</span> {
<a name="l19323"></a>19323             $hpadding = floatval($style[<span class="stringliteral">&#39;hpadding&#39;</span>]);
<a name="l19324"></a>19324         }
<a name="l19325"></a>19325         <span class="comment">// vertical padding</span>
<a name="l19326"></a>19326         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;vpadding&#39;</span>])) {
<a name="l19327"></a>19327             $vpadding = $padding;
<a name="l19328"></a>19328         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;vpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {
<a name="l19329"></a>19329             $vpadding = ($hpadding / 2);
<a name="l19330"></a>19330         } <span class="keywordflow">else</span> {
<a name="l19331"></a>19331             $vpadding = floatval($style[<span class="stringliteral">&#39;vpadding&#39;</span>]);
<a name="l19332"></a>19332         }
<a name="l19333"></a>19333         <span class="comment">// calculate xres (single bar width)</span>
<a name="l19334"></a>19334         $max_xres = (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> - (2 * $hpadding)) / $arrcode[<span class="stringliteral">&#39;maxw&#39;</span>];
<a name="l19335"></a>19335         <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;stretch&#39;</span>]) {
<a name="l19336"></a>19336             $xres = $max_xres;
<a name="l19337"></a>19337         } <span class="keywordflow">else</span> {
<a name="l19338"></a>19338             <span class="keywordflow">if</span> ($this-&gt;empty_string($xres)) {
<a name="l19339"></a>19339                 $xres = (0.141 * $this-&gt;k); <span class="comment">// default bar width = 0.4 mm</span>
<a name="l19340"></a>19340             }
<a name="l19341"></a>19341             <span class="keywordflow">if</span> ($xres &gt; $max_xres) {
<a name="l19342"></a>19342                 <span class="comment">// correct xres to fit on $w</span>
<a name="l19343"></a>19343                 $xres = $max_xres;
<a name="l19344"></a>19344             }
<a name="l19345"></a>19345             <span class="keywordflow">if</span> ((isset($style[<span class="stringliteral">&#39;padding&#39;</span>]) AND ($style[<span class="stringliteral">&#39;padding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>))
<a name="l19346"></a>19346                 OR (isset($style[<span class="stringliteral">&#39;hpadding&#39;</span>]) AND ($style[<span class="stringliteral">&#39;hpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>))) {
<a name="l19347"></a>19347                 $hpadding = 10 * $xres;
<a name="l19348"></a>19348                 <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;vpadding&#39;</span>]) AND ($style[<span class="stringliteral">&#39;vpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>)) {
<a name="l19349"></a>19349                     $vpadding = ($hpadding / 2);
<a name="l19350"></a>19350                 }
<a name="l19351"></a>19351             }
<a name="l19352"></a>19352         }
<a name="l19353"></a>19353         <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;fitwidth&#39;</span>]) {
<a name="l19354"></a>19354             $wold = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19355"></a>19355             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = (($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres) + (2 * $hpadding));
<a name="l19356"></a>19356             <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;cellfitalign&#39;</span>])) {
<a name="l19357"></a>19357                 <span class="keywordflow">switch</span> ($style[<span class="stringliteral">&#39;cellfitalign&#39;</span>]) {
<a name="l19358"></a>19358                     <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {
<a name="l19359"></a>19359                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l19360"></a>19360                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> -= ($wold - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>);
<a name="l19361"></a>19361                         }
<a name="l19362"></a>19362                         <span class="keywordflow">break</span>;
<a name="l19363"></a>19363                     }
<a name="l19364"></a>19364                     <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {
<a name="l19365"></a>19365                         <span class="keywordflow">if</span> (!$this-&gt;rtl) {
<a name="l19366"></a>19366                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> += ($wold - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>);
<a name="l19367"></a>19367                         }
<a name="l19368"></a>19368                         <span class="keywordflow">break</span>;
<a name="l19369"></a>19369                     }
<a name="l19370"></a>19370                     <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {
<a name="l19371"></a>19371                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l19372"></a>19372                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> -= (($wold - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2);
<a name="l19373"></a>19373                         } <span class="keywordflow">else</span> {
<a name="l19374"></a>19374                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> += (($wold - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2);
<a name="l19375"></a>19375                         }
<a name="l19376"></a>19376                         <span class="keywordflow">break</span>;
<a name="l19377"></a>19377                     }
<a name="l19378"></a>19378                     <span class="keywordflow">default</span> : {
<a name="l19379"></a>19379                         <span class="keywordflow">break</span>;
<a name="l19380"></a>19380                     }
<a name="l19381"></a>19381                 }
<a name="l19382"></a>19382             }
<a name="l19383"></a>19383         }
<a name="l19384"></a>19384         $text_height = ($this-&gt;cell_height_ratio * <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> / $this-&gt;k);
<a name="l19385"></a>19385         <span class="comment">// height</span>
<a name="l19386"></a>19386         <span class="keywordflow">if</span> ((<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0)) {
<a name="l19387"></a>19387             <span class="comment">// set default height</span>
<a name="l19388"></a>19388             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = (($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres) / 3) + (2 * $vpadding) + $text_height;
<a name="l19389"></a>19389         }
<a name="l19390"></a>19390         $barh = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> - $text_height - (2 * $vpadding);
<a name="l19391"></a>19391         <span class="keywordflow">if</span> ($barh &lt;=0) {
<a name="l19392"></a>19392             <span class="comment">// try to reduce font or padding to fit barcode on available height</span>
<a name="l19393"></a>19393             <span class="keywordflow">if</span> ($text_height &gt; <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>) {
<a name="l19394"></a>19394                 <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> = ((<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> * $this-&gt;k) / (4 * $this-&gt;cell_height_ratio));
<a name="l19395"></a>19395                 $text_height = ($this-&gt;cell_height_ratio * <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> / $this-&gt;k);
<a name="l19396"></a>19396                 $this-&gt;SetFont($style[<span class="stringliteral">&#39;font&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>);
<a name="l19397"></a>19397             }
<a name="l19398"></a>19398             <span class="keywordflow">if</span> ($vpadding &gt; 0) {
<a name="l19399"></a>19399                 $vpadding = ((<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> - $text_height) / 4);
<a name="l19400"></a>19400             }
<a name="l19401"></a>19401             $barh = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> - $text_height - (2 * $vpadding);
<a name="l19402"></a>19402         }
<a name="l19403"></a>19403         <span class="comment">// fit the barcode on available space</span>
<a name="l19404"></a>19404         list(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;fitBlock(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <span class="keyword">false</span>);
<a name="l19405"></a>19405         <span class="comment">// set alignment</span>
<a name="l19406"></a>19406         $this-&gt;img_rb_y = $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l19407"></a>19407         <span class="comment">// set alignment</span>
<a name="l19408"></a>19408         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l19409"></a>19409             <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l19410"></a>19410                 $xpos = $this-&gt;lMargin;
<a name="l19411"></a>19411             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l19412"></a>19412                 $xpos = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l19413"></a>19413             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l19414"></a>19414                 $xpos = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19415"></a>19415             } <span class="keywordflow">else</span> {
<a name="l19416"></a>19416                 $xpos = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19417"></a>19417             }
<a name="l19418"></a>19418             $this-&gt;img_rb_x = $xpos;
<a name="l19419"></a>19419         } <span class="keywordflow">else</span> {
<a name="l19420"></a>19420             <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l19421"></a>19421                 $xpos = $this-&gt;lMargin;
<a name="l19422"></a>19422             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l19423"></a>19423                 $xpos = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l19424"></a>19424             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l19425"></a>19425                 $xpos = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19426"></a>19426             } <span class="keywordflow">else</span> {
<a name="l19427"></a>19427                 $xpos = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l19428"></a>19428             }
<a name="l19429"></a>19429             $this-&gt;img_rb_x = $xpos + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19430"></a>19430         }
<a name="l19431"></a>19431         $xpos_rect = $xpos;
<a name="l19432"></a>19432         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;align&#39;</span>])) {
<a name="l19433"></a>19433             $style[<span class="stringliteral">&#39;align&#39;</span>] = <span class="charliteral">&#39;C&#39;</span>;
<a name="l19434"></a>19434         }
<a name="l19435"></a>19435         <span class="keywordflow">switch</span> ($style[<span class="stringliteral">&#39;align&#39;</span>]) {
<a name="l19436"></a>19436             <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {
<a name="l19437"></a>19437                 $xpos = $xpos_rect + $hpadding;
<a name="l19438"></a>19438                 <span class="keywordflow">break</span>;
<a name="l19439"></a>19439             }
<a name="l19440"></a>19440             <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {
<a name="l19441"></a>19441                 $xpos = $xpos_rect + (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> - ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres)) - $hpadding;
<a name="l19442"></a>19442                 <span class="keywordflow">break</span>;
<a name="l19443"></a>19443             }
<a name="l19444"></a>19444             <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
<a name="l19445"></a>19445             <span class="keywordflow">default</span> : {
<a name="l19446"></a>19446                 $xpos = $xpos_rect + ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> - ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres)) / 2);
<a name="l19447"></a>19447                 <span class="keywordflow">break</span>;
<a name="l19448"></a>19448             }
<a name="l19449"></a>19449         }
<a name="l19450"></a>19450         $xpos_text = $xpos;
<a name="l19451"></a>19451         <span class="comment">// barcode is always printed in LTR direction</span>
<a name="l19452"></a>19452         $tempRTL = $this-&gt;rtl;
<a name="l19453"></a>19453         $this-&gt;rtl = <span class="keyword">false</span>;
<a name="l19454"></a>19454         <span class="comment">// print background color</span>
<a name="l19455"></a>19455         <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;bgcolor&#39;</span>]) {
<a name="l19456"></a>19456             $this-&gt;Rect($xpos_rect, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $h, $style[<span class="stringliteral">&#39;border&#39;</span>] ? <span class="stringliteral">&#39;DF&#39;</span> : <span class="charliteral">&#39;F&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $style[<span class="stringliteral">&#39;bgcolor&#39;</span>]);
<a name="l19457"></a>19457         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;border&#39;</span>]) {
<a name="l19458"></a>19458             $this-&gt;Rect($xpos_rect, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $h, <span class="charliteral">&#39;D&#39;</span>);
<a name="l19459"></a>19459         }
<a name="l19460"></a>19460         <span class="comment">// set foreground color</span>
<a name="l19461"></a>19461         $this-&gt;SetDrawColorArray($style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);
<a name="l19462"></a>19462         $this-&gt;SetTextColorArray($style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);
<a name="l19463"></a>19463         <span class="comment">// print bars</span>
<a name="l19464"></a>19464         <span class="keywordflow">foreach</span> ($arrcode[<span class="stringliteral">&#39;bcode&#39;</span>] as $k =&gt; $v) {
<a name="l19465"></a>19465             $bw = ($v[<span class="charliteral">&#39;w&#39;</span>] * $xres);
<a name="l19466"></a>19466             <span class="keywordflow">if</span> ($v[<span class="charliteral">&#39;t&#39;</span>]) {
<a name="l19467"></a>19467                 <span class="comment">// draw a vertical bar</span>
<a name="l19468"></a>19468                 $ypos = $y + $vpadding + ($v[<span class="charliteral">&#39;p&#39;</span>] * $barh / $arrcode[<span class="stringliteral">&#39;maxh&#39;</span>]);
<a name="l19469"></a>19469                 $this-&gt;Rect($xpos, $ypos, $bw, ($v[<span class="charliteral">&#39;h&#39;</span>] * $barh / $arrcode[<span class="stringliteral">&#39;maxh&#39;</span>]), <span class="charliteral">&#39;F&#39;</span>, array(), $style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);
<a name="l19470"></a>19470             }
<a name="l19471"></a>19471             $xpos += $bw;
<a name="l19472"></a>19472         }
<a name="l19473"></a>19473         <span class="comment">// print text</span>
<a name="l19474"></a>19474         <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;text&#39;</span>]) {
<a name="l19475"></a>19475             <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;label&#39;</span>]) AND !$this-&gt;empty_string($style[<span class="stringliteral">&#39;label&#39;</span>])) {
<a name="l19476"></a>19476                 $label = $style[<span class="stringliteral">&#39;label&#39;</span>];
<a name="l19477"></a>19477             } <span class="keywordflow">else</span> {
<a name="l19478"></a>19478                 $label = $code;
<a name="l19479"></a>19479             }
<a name="l19480"></a>19480             $txtwidth = ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres);
<a name="l19481"></a>19481             <span class="keywordflow">if</span> ($this-&gt;GetStringWidth($label) &gt; $txtwidth) {
<a name="l19482"></a>19482                 $style[<span class="stringliteral">&#39;stretchtext&#39;</span>] = 2;
<a name="l19483"></a>19483             }
<a name="l19484"></a>19484             <span class="comment">// print text</span>
<a name="l19485"></a>19485             $this-&gt;x = $xpos_text;
<a name="l19486"></a>19486             $this-&gt;y = $y + $vpadding + $barh;
<a name="l19487"></a>19487             $cellpadding = $this-&gt;cell_padding;
<a name="l19488"></a>19488             $this-&gt;SetCellPadding(0);
<a name="l19489"></a>19489             $this-&gt;Cell($txtwidth, <span class="stringliteral">&#39;&#39;</span>, $label, 0, 0, <span class="charliteral">&#39;C&#39;</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>, $style[<span class="stringliteral">&#39;stretchtext&#39;</span>], <span class="keyword">false</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;T&#39;</span>);
<a name="l19490"></a>19490             $this-&gt;cell_padding = $cellpadding;
<a name="l19491"></a>19491         }
<a name="l19492"></a>19492         <span class="comment">// restore original direction</span>
<a name="l19493"></a>19493         $this-&gt;rtl = $tempRTL;
<a name="l19494"></a>19494         <span class="comment">// restore previous settings</span>
<a name="l19495"></a>19495         $this-&gt;setGraphicVars($gvars);
<a name="l19496"></a>19496         <span class="comment">// set pointer to align the next text/objects</span>
<a name="l19497"></a>19497         <span class="keywordflow">switch</span>($align) {
<a name="l19498"></a>19498             <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:{
<a name="l19499"></a>19499                 $this-&gt;y = $y;
<a name="l19500"></a>19500                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l19501"></a>19501                 <span class="keywordflow">break</span>;
<a name="l19502"></a>19502             }
<a name="l19503"></a>19503             <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:{
<a name="l19504"></a>19504                 $this-&gt;y = $y + round($h / 2);
<a name="l19505"></a>19505                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l19506"></a>19506                 <span class="keywordflow">break</span>;
<a name="l19507"></a>19507             }
<a name="l19508"></a>19508             <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:{
<a name="l19509"></a>19509                 $this-&gt;y = $this-&gt;img_rb_y;
<a name="l19510"></a>19510                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l19511"></a>19511                 <span class="keywordflow">break</span>;
<a name="l19512"></a>19512             }
<a name="l19513"></a>19513             <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:{
<a name="l19514"></a>19514                 $this-&gt;SetY($this-&gt;img_rb_y);
<a name="l19515"></a>19515                 <span class="keywordflow">break</span>;
<a name="l19516"></a>19516             }
<a name="l19517"></a>19517             <span class="keywordflow">default</span>:{
<a name="l19518"></a>19518                 <span class="keywordflow">break</span>;
<a name="l19519"></a>19519             }
<a name="l19520"></a>19520         }
<a name="l19521"></a>19521         $this-&gt;endlinex = $this-&gt;img_rb_x;
<a name="l19522"></a>19522     }
<a name="l19523"></a>19523 <span class="comment"></span>
<a name="l19524"></a>19524 <span class="comment">    /**</span>
<a name="l19525"></a>19525 <span class="comment">     * This function is DEPRECATED, please use the new write1DBarcode() function.</span>
<a name="l19526"></a>19526 <span class="comment">     * @param $x (int) x position in user units</span>
<a name="l19527"></a>19527 <span class="comment">     * @param $y (int) y position in user units</span>
<a name="l19528"></a>19528 <span class="comment">     * @param $w (int) width in user units</span>
<a name="l19529"></a>19529 <span class="comment">     * @param $h (int) height position in user units</span>
<a name="l19530"></a>19530 <span class="comment">     * @param $type (string) type of barcode</span>
<a name="l19531"></a>19531 <span class="comment">     * @param $style (string) barcode style</span>
<a name="l19532"></a>19532 <span class="comment">     * @param $font (string) font for text</span>
<a name="l19533"></a>19533 <span class="comment">     * @param $xres (int) x resolution</span>
<a name="l19534"></a>19534 <span class="comment">     * @param $code (string) code to print</span>
<a name="l19535"></a>19535 <span class="comment">     * @deprecated deprecated since version 3.1.000 (2008-06-10)</span>
<a name="l19536"></a>19536 <span class="comment">     * @public</span>
<a name="l19537"></a>19537 <span class="comment">     * @see write1DBarcode()</span>
<a name="l19538"></a>19538 <span class="comment">     */</span>
<a name="l19539"></a><a class="code" href="classTCPDF.html#a0129d60f5bc89bd3a2b532f367bd984d">19539</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0129d60f5bc89bd3a2b532f367bd984d" title="This function is DEPRECATED, please use the new write1DBarcode() function.">writeBarcode</a>(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, $style, <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $xres, $code) {
<a name="l19540"></a>19540         <span class="comment">// convert old settings for the new write1DBarcode() function.</span>
<a name="l19541"></a>19541         $xres = 1 / $xres;
<a name="l19542"></a>19542         $newstyle = array(
<a name="l19543"></a>19543             <span class="stringliteral">&#39;position&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,
<a name="l19544"></a>19544             <span class="stringliteral">&#39;align&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,
<a name="l19545"></a>19545             <span class="stringliteral">&#39;stretch&#39;</span> =&gt; <span class="keyword">false</span>,
<a name="l19546"></a>19546             <span class="stringliteral">&#39;fitwidth&#39;</span> =&gt; <span class="keyword">false</span>,
<a name="l19547"></a>19547             <span class="stringliteral">&#39;cellfitalign&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,
<a name="l19548"></a>19548             <span class="stringliteral">&#39;border&#39;</span> =&gt; <span class="keyword">false</span>,
<a name="l19549"></a>19549             <span class="stringliteral">&#39;padding&#39;</span> =&gt; 0,
<a name="l19550"></a>19550             <span class="stringliteral">&#39;fgcolor&#39;</span> =&gt; array(0,0,0),
<a name="l19551"></a>19551             <span class="stringliteral">&#39;bgcolor&#39;</span> =&gt; <span class="keyword">false</span>,
<a name="l19552"></a>19552             <span class="stringliteral">&#39;text&#39;</span> =&gt; <span class="keyword">true</span>,
<a name="l19553"></a>19553             <span class="stringliteral">&#39;font&#39;</span> =&gt; <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>,
<a name="l19554"></a>19554             <span class="stringliteral">&#39;fontsize&#39;</span> =&gt; 8,
<a name="l19555"></a>19555             <span class="stringliteral">&#39;stretchtext&#39;</span> =&gt; 4
<a name="l19556"></a>19556         );
<a name="l19557"></a>19557         <span class="keywordflow">if</span> ($style &amp; 1) {
<a name="l19558"></a>19558             $newstyle[<span class="stringliteral">&#39;border&#39;</span>] = <span class="keyword">true</span>;
<a name="l19559"></a>19559         }
<a name="l19560"></a>19560         <span class="keywordflow">if</span> ($style &amp; 2) {
<a name="l19561"></a>19561             $newstyle[<span class="stringliteral">&#39;bgcolor&#39;</span>] = <span class="keyword">false</span>;
<a name="l19562"></a>19562         }
<a name="l19563"></a>19563         <span class="keywordflow">if</span> ($style &amp; 4) {
<a name="l19564"></a>19564             $newstyle[<span class="stringliteral">&#39;position&#39;</span>] = <span class="charliteral">&#39;C&#39;</span>;
<a name="l19565"></a>19565         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style &amp; 8) {
<a name="l19566"></a>19566             $newstyle[<span class="stringliteral">&#39;position&#39;</span>] = <span class="charliteral">&#39;L&#39;</span>;
<a name="l19567"></a>19567         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style &amp; 16) {
<a name="l19568"></a>19568             $newstyle[<span class="stringliteral">&#39;position&#39;</span>] = <span class="charliteral">&#39;R&#39;</span>;
<a name="l19569"></a>19569         }
<a name="l19570"></a>19570         <span class="keywordflow">if</span> ($style &amp; 128) {
<a name="l19571"></a>19571             $newstyle[<span class="stringliteral">&#39;text&#39;</span>] = <span class="keyword">true</span>;
<a name="l19572"></a>19572         }
<a name="l19573"></a>19573         <span class="keywordflow">if</span> ($style &amp; 256) {
<a name="l19574"></a>19574             $newstyle[<span class="stringliteral">&#39;stretchtext&#39;</span>] = 4;
<a name="l19575"></a>19575         }
<a name="l19576"></a>19576         $this-&gt;write1DBarcode($code, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $xres, $newstyle, <span class="stringliteral">&#39;&#39;</span>);
<a name="l19577"></a>19577     }
<a name="l19578"></a>19578 <span class="comment"></span>
<a name="l19579"></a>19579 <span class="comment">    /**</span>
<a name="l19580"></a>19580 <span class="comment">     * Print 2D Barcode.</span>
<a name="l19581"></a>19581 <span class="comment">     * @param $code (string) code to print</span>
<a name="l19582"></a>19582 <span class="comment">     * @param $type (string) type of barcode (see 2dbarcodes.php for supported formats).</span>
<a name="l19583"></a>19583 <span class="comment">     * @param $x (int) x position in user units</span>
<a name="l19584"></a>19584 <span class="comment">     * @param $y (int) y position in user units</span>
<a name="l19585"></a>19585 <span class="comment">     * @param $w (int) width in user units</span>
<a name="l19586"></a>19586 <span class="comment">     * @param $h (int) height in user units</span>
<a name="l19587"></a>19587 <span class="comment">     * @param $style (array) array of options:&lt;ul&gt;</span>
<a name="l19588"></a>19588 <span class="comment">     * &lt;li&gt;boolean $style[&#39;border&#39;] if true prints a border around the barcode&lt;/li&gt;</span>
<a name="l19589"></a>19589 <span class="comment">     * &lt;li&gt;int $style[&#39;padding&#39;] padding to leave around the barcode in barcode units (set to &#39;auto&#39; for automatic padding)&lt;/li&gt;</span>
<a name="l19590"></a>19590 <span class="comment">     * &lt;li&gt;int $style[&#39;hpadding&#39;] horizontal padding in barcode units (set to &#39;auto&#39; for automatic padding)&lt;/li&gt;</span>
<a name="l19591"></a>19591 <span class="comment">     * &lt;li&gt;int $style[&#39;vpadding&#39;] vertical padding in barcode units (set to &#39;auto&#39; for automatic padding)&lt;/li&gt;</span>
<a name="l19592"></a>19592 <span class="comment">     * &lt;li&gt;int $style[&#39;module_width&#39;] width of a single module in points&lt;/li&gt;</span>
<a name="l19593"></a>19593 <span class="comment">     * &lt;li&gt;int $style[&#39;module_height&#39;] height of a single module in points&lt;/li&gt;</span>
<a name="l19594"></a>19594 <span class="comment">     * &lt;li&gt;array $style[&#39;fgcolor&#39;] color array for bars and text&lt;/li&gt;</span>
<a name="l19595"></a>19595 <span class="comment">     * &lt;li&gt;mixed $style[&#39;bgcolor&#39;] color array for background or false for transparent&lt;/li&gt;</span>
<a name="l19596"></a>19596 <span class="comment">     * &lt;li&gt;string $style[&#39;position&#39;] barcode position on the page: L = left margin; C = center; R = right margin; S = stretch&lt;/li&gt;&lt;li&gt;$style[&#39;module_width&#39;] width of a single module in points&lt;/li&gt;</span>
<a name="l19597"></a>19597 <span class="comment">     * &lt;li&gt;$style[&#39;module_height&#39;] height of a single module in points&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l19598"></a>19598 <span class="comment">     * @param $align (string) Indicates the alignment of the pointer next to barcode insertion relative to barcode height. The value can be:&lt;ul&gt;&lt;li&gt;T: top-right for LTR or top-left for RTL&lt;/li&gt;&lt;li&gt;M: middle-right for LTR or middle-left for RTL&lt;/li&gt;&lt;li&gt;B: bottom-right for LTR or bottom-left for RTL&lt;/li&gt;&lt;li&gt;N: next line&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l19599"></a>19599 <span class="comment">     * @param $distort (boolean) if true distort the barcode to fit width and height, otherwise preserve aspect ratio</span>
<a name="l19600"></a>19600 <span class="comment">     * @author Nicola Asuni</span>
<a name="l19601"></a>19601 <span class="comment">     * @since 4.5.037 (2009-04-07)</span>
<a name="l19602"></a>19602 <span class="comment">     * @public</span>
<a name="l19603"></a>19603 <span class="comment">     */</span>
<a name="l19604"></a><a class="code" href="classTCPDF.html#afddb62386f44b3011c9e4a8ed1d90517">19604</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#afddb62386f44b3011c9e4a8ed1d90517" title="Print 2D Barcode.">write2DBarcode</a>($code, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $distort=<span class="keyword">false</span>) {
<a name="l19605"></a>19605         <span class="keywordflow">if</span> ($this-&gt;empty_string(trim($code))) {
<a name="l19606"></a>19606             <span class="keywordflow">return</span>;
<a name="l19607"></a>19607         }
<a name="l19608"></a>19608         require_once(dirname(__FILE__).<span class="stringliteral">&#39;/2dbarcodes.php&#39;</span>);
<a name="l19609"></a>19609         <span class="comment">// save current graphic settings</span>
<a name="l19610"></a>19610         $gvars = $this-&gt;getGraphicVars();
<a name="l19611"></a>19611         <span class="comment">// create new barcode object</span>
<a name="l19612"></a>19612         $barcodeobj = <span class="keyword">new</span> TCPDF2DBarcode($code, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l19613"></a>19613         $arrcode = $barcodeobj-&gt;getBarcodeArray();
<a name="l19614"></a>19614         <span class="keywordflow">if</span> (($arrcode === <span class="keyword">false</span>) OR empty($arrcode)) {
<a name="l19615"></a>19615             $this-&gt;Error(<span class="stringliteral">&#39;Error in 2D barcode string&#39;</span>);
<a name="l19616"></a>19616         }
<a name="l19617"></a>19617         <span class="comment">// set default values</span>
<a name="l19618"></a>19618         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;position&#39;</span>])) {
<a name="l19619"></a>19619             $style[<span class="stringliteral">&#39;position&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l19620"></a>19620         }
<a name="l19621"></a>19621         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;fgcolor&#39;</span>])) {
<a name="l19622"></a>19622             $style[<span class="stringliteral">&#39;fgcolor&#39;</span>] = array(0,0,0); <span class="comment">// default black</span>
<a name="l19623"></a>19623         }
<a name="l19624"></a>19624         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;bgcolor&#39;</span>])) {
<a name="l19625"></a>19625             $style[<span class="stringliteral">&#39;bgcolor&#39;</span>] = <span class="keyword">false</span>; <span class="comment">// default transparent</span>
<a name="l19626"></a>19626         }
<a name="l19627"></a>19627         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;border&#39;</span>])) {
<a name="l19628"></a>19628             $style[<span class="stringliteral">&#39;border&#39;</span>] = <span class="keyword">false</span>;
<a name="l19629"></a>19629         }
<a name="l19630"></a>19630         <span class="comment">// padding</span>
<a name="l19631"></a>19631         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;padding&#39;</span>])) {
<a name="l19632"></a>19632             $style[<span class="stringliteral">&#39;padding&#39;</span>] = 0;
<a name="l19633"></a>19633         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;padding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {
<a name="l19634"></a>19634             $style[<span class="stringliteral">&#39;padding&#39;</span>] = 4;
<a name="l19635"></a>19635         }
<a name="l19636"></a>19636         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;hpadding&#39;</span>])) {
<a name="l19637"></a>19637             $style[<span class="stringliteral">&#39;hpadding&#39;</span>] = $style[<span class="stringliteral">&#39;padding&#39;</span>];
<a name="l19638"></a>19638         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;hpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {
<a name="l19639"></a>19639             $style[<span class="stringliteral">&#39;hpadding&#39;</span>] = 4;
<a name="l19640"></a>19640         }
<a name="l19641"></a>19641         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;vpadding&#39;</span>])) {
<a name="l19642"></a>19642             $style[<span class="stringliteral">&#39;vpadding&#39;</span>] = $style[<span class="stringliteral">&#39;padding&#39;</span>];
<a name="l19643"></a>19643         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;vpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {
<a name="l19644"></a>19644             $style[<span class="stringliteral">&#39;vpadding&#39;</span>] = 4;
<a name="l19645"></a>19645         }
<a name="l19646"></a>19646         $hpad = (2 * $style[<span class="stringliteral">&#39;hpadding&#39;</span>]);
<a name="l19647"></a>19647         $vpad = (2 * $style[<span class="stringliteral">&#39;vpadding&#39;</span>]);
<a name="l19648"></a>19648         <span class="comment">// cell (module) dimension</span>
<a name="l19649"></a>19649         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;module_width&#39;</span>])) {
<a name="l19650"></a>19650             $style[<span class="stringliteral">&#39;module_width&#39;</span>] = 1; <span class="comment">// width of a single module in points</span>
<a name="l19651"></a>19651         }
<a name="l19652"></a>19652         <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;module_height&#39;</span>])) {
<a name="l19653"></a>19653             $style[<span class="stringliteral">&#39;module_height&#39;</span>] = 1; <span class="comment">// height of a single module in points</span>
<a name="l19654"></a>19654         }
<a name="l19655"></a>19655         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l19656"></a>19656             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l19657"></a>19657         }
<a name="l19658"></a>19658         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l19659"></a>19659             $y = $this-&gt;y;
<a name="l19660"></a>19660         }
<a name="l19661"></a>19661         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l19662"></a>19662         list(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;checkPageRegions(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l19663"></a>19663         <span class="comment">// number of barcode columns and rows</span>
<a name="l19664"></a>19664         <a class="code" href="query_8php.html#ace2ec39e7df3899fa8df9640ec274b03">$rows</a> = $arrcode[<span class="stringliteral">&#39;num_rows&#39;</span>];
<a name="l19665"></a>19665         $cols = $arrcode[<span class="stringliteral">&#39;num_cols&#39;</span>];
<a name="l19666"></a>19666         <span class="comment">// module width and height</span>
<a name="l19667"></a>19667         $mw = $style[<span class="stringliteral">&#39;module_width&#39;</span>];
<a name="l19668"></a>19668         $mh = $style[<span class="stringliteral">&#39;module_height&#39;</span>];
<a name="l19669"></a>19669         <span class="comment">// get max dimensions</span>
<a name="l19670"></a>19670         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l19671"></a>19671             $maxw = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - $this-&gt;lMargin;
<a name="l19672"></a>19672         } <span class="keywordflow">else</span> {
<a name="l19673"></a>19673             $maxw = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l19674"></a>19674         }
<a name="l19675"></a>19675         $maxh = ($this-&gt;h - $this-&gt;tMargin - $this-&gt;bMargin);
<a name="l19676"></a>19676         $ratioHW = (((<a class="code" href="query_8php.html#ace2ec39e7df3899fa8df9640ec274b03">$rows</a> * $mh) + $hpad) / (($cols * $mw) + $vpad));
<a name="l19677"></a>19677         $ratioWH = ((($cols * $mw) + $vpad) / ((<a class="code" href="query_8php.html#ace2ec39e7df3899fa8df9640ec274b03">$rows</a> * $mh) + $hpad));
<a name="l19678"></a>19678         <span class="keywordflow">if</span> (!$distort) {
<a name="l19679"></a>19679             <span class="keywordflow">if</span> (($maxw * $ratioHW) &gt; $maxh) {
<a name="l19680"></a>19680                 $maxw = $maxh * $ratioWH;
<a name="l19681"></a>19681             }
<a name="l19682"></a>19682             <span class="keywordflow">if</span> (($maxh * $ratioWH) &gt; $maxw) {
<a name="l19683"></a>19683                 $maxh = $maxw * $ratioHW;
<a name="l19684"></a>19684             }
<a name="l19685"></a>19685         }
<a name="l19686"></a>19686         <span class="comment">// set maximum dimesions</span>
<a name="l19687"></a>19687         <span class="keywordflow">if</span> (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &gt; $maxw) {
<a name="l19688"></a>19688             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $maxw;
<a name="l19689"></a>19689         }
<a name="l19690"></a>19690         <span class="keywordflow">if</span> (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &gt; $maxh) {
<a name="l19691"></a>19691             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $maxh;
<a name="l19692"></a>19692         }
<a name="l19693"></a>19693         <span class="comment">// set dimensions</span>
<a name="l19694"></a>19694         <span class="keywordflow">if</span> (((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0)) AND ((<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0))) {
<a name="l19695"></a>19695             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = ($cols + $hpad) * ($mw / $this-&gt;k);
<a name="l19696"></a>19696             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = (<a class="code" href="query_8php.html#ace2ec39e7df3899fa8df9640ec274b03">$rows</a> + $vpad) * ($mh / $this-&gt;k);
<a name="l19697"></a>19697         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0)) {
<a name="l19698"></a>19698             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> * $ratioWH;
<a name="l19699"></a>19699         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0)) {
<a name="l19700"></a>19700             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $ratioHW;
<a name="l19701"></a>19701         }
<a name="l19702"></a>19702         <span class="comment">// barcode size (excluding padding)</span>
<a name="l19703"></a>19703         $bw = (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $cols) / ($cols + $hpad);
<a name="l19704"></a>19704         $bh = (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> * <a class="code" href="query_8php.html#ace2ec39e7df3899fa8df9640ec274b03">$rows</a>) / (<a class="code" href="query_8php.html#ace2ec39e7df3899fa8df9640ec274b03">$rows</a> + $vpad);
<a name="l19705"></a>19705         <span class="comment">// dimension of single barcode cell unit</span>
<a name="l19706"></a>19706         <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> = $bw / $cols;
<a name="l19707"></a>19707         <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a> = $bh / <a class="code" href="query_8php.html#ace2ec39e7df3899fa8df9640ec274b03">$rows</a>;
<a name="l19708"></a>19708         <span class="keywordflow">if</span> (!$distort) {
<a name="l19709"></a>19709             <span class="keywordflow">if</span> ((<a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> / <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a>) &gt; ($mw / $mh)) {
<a name="l19710"></a>19710                 <span class="comment">// correct horizontal distortion</span>
<a name="l19711"></a>19711                 <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> = <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a> * $mw / $mh;
<a name="l19712"></a>19712                 $bw = <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> * $cols;
<a name="l19713"></a>19713                 $style[<span class="stringliteral">&#39;hpadding&#39;</span>] = (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> - $bw) / (2 * <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>);
<a name="l19714"></a>19714             } <span class="keywordflow">else</span> {
<a name="l19715"></a>19715                 <span class="comment">// correct vertical distortion</span>
<a name="l19716"></a>19716                 <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a> = <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> * $mh / $mw;
<a name="l19717"></a>19717                 $bh = <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a> * <a class="code" href="query_8php.html#ace2ec39e7df3899fa8df9640ec274b03">$rows</a>;
<a name="l19718"></a>19718                 $style[<span class="stringliteral">&#39;vpadding&#39;</span>] = (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> - $bh) / (2 * <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a>);
<a name="l19719"></a>19719             }
<a name="l19720"></a>19720         }
<a name="l19721"></a>19721         <span class="comment">// fit the barcode on available space</span>
<a name="l19722"></a>19722         list(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;fitBlock(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <span class="keyword">false</span>);
<a name="l19723"></a>19723         <span class="comment">// set alignment</span>
<a name="l19724"></a>19724         $this-&gt;img_rb_y = $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l19725"></a>19725         <span class="comment">// set alignment</span>
<a name="l19726"></a>19726         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l19727"></a>19727             <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l19728"></a>19728                 $xpos = $this-&gt;lMargin;
<a name="l19729"></a>19729             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l19730"></a>19730                 $xpos = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l19731"></a>19731             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l19732"></a>19732                 $xpos = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19733"></a>19733             } <span class="keywordflow">else</span> {
<a name="l19734"></a>19734                 $xpos = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19735"></a>19735             }
<a name="l19736"></a>19736             $this-&gt;img_rb_x = $xpos;
<a name="l19737"></a>19737         } <span class="keywordflow">else</span> {
<a name="l19738"></a>19738             <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l19739"></a>19739                 $xpos = $this-&gt;lMargin;
<a name="l19740"></a>19740             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l19741"></a>19741                 $xpos = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l19742"></a>19742             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l19743"></a>19743                 $xpos = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19744"></a>19744             } <span class="keywordflow">else</span> {
<a name="l19745"></a>19745                 $xpos = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l19746"></a>19746             }
<a name="l19747"></a>19747             $this-&gt;img_rb_x = $xpos + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l19748"></a>19748         }
<a name="l19749"></a>19749         $xstart = $xpos + ($style[<span class="stringliteral">&#39;hpadding&#39;</span>] * <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>);
<a name="l19750"></a>19750         $ystart = $y + ($style[<span class="stringliteral">&#39;vpadding&#39;</span>] * <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a>);
<a name="l19751"></a>19751         <span class="comment">// barcode is always printed in LTR direction</span>
<a name="l19752"></a>19752         $tempRTL = $this-&gt;rtl;
<a name="l19753"></a>19753         $this-&gt;rtl = <span class="keyword">false</span>;
<a name="l19754"></a>19754         <span class="comment">// print background color</span>
<a name="l19755"></a>19755         <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;bgcolor&#39;</span>]) {
<a name="l19756"></a>19756             $this-&gt;Rect($xpos, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $h, $style[<span class="stringliteral">&#39;border&#39;</span>] ? <span class="stringliteral">&#39;DF&#39;</span> : <span class="charliteral">&#39;F&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $style[<span class="stringliteral">&#39;bgcolor&#39;</span>]);
<a name="l19757"></a>19757         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($style[<span class="stringliteral">&#39;border&#39;</span>]) {
<a name="l19758"></a>19758             $this-&gt;Rect($xpos, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $h, <span class="charliteral">&#39;D&#39;</span>);
<a name="l19759"></a>19759         }
<a name="l19760"></a>19760         <span class="comment">// set foreground color</span>
<a name="l19761"></a>19761         $this-&gt;SetDrawColorArray($style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);
<a name="l19762"></a>19762         <span class="comment">// print barcode cells</span>
<a name="l19763"></a>19763         <span class="comment">// for each row</span>
<a name="l19764"></a>19764         <span class="keywordflow">for</span> (<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = 0; <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> &lt; <a class="code" href="query_8php.html#ace2ec39e7df3899fa8df9640ec274b03">$rows</a>; ++<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>) {
<a name="l19765"></a>19765             $xr = $xstart;
<a name="l19766"></a>19766             <span class="comment">// for each column</span>
<a name="l19767"></a>19767             <span class="keywordflow">for</span> (<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = 0; <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> &lt; $cols; ++<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) {
<a name="l19768"></a>19768                 <span class="keywordflow">if</span> ($arrcode[<span class="stringliteral">&#39;bcode&#39;</span>][<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>][<a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>] == 1) {
<a name="l19769"></a>19769                     <span class="comment">// draw a single barcode cell</span>
<a name="l19770"></a>19770                     $this-&gt;Rect($xr, $ystart, <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>, <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a>, <span class="charliteral">&#39;F&#39;</span>, array(), $style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);
<a name="l19771"></a>19771                 }
<a name="l19772"></a>19772                 $xr += <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>;
<a name="l19773"></a>19773             }
<a name="l19774"></a>19774             $ystart += <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a>;
<a name="l19775"></a>19775         }
<a name="l19776"></a>19776         <span class="comment">// restore original direction</span>
<a name="l19777"></a>19777         $this-&gt;rtl = $tempRTL;
<a name="l19778"></a>19778         <span class="comment">// restore previous settings</span>
<a name="l19779"></a>19779         $this-&gt;setGraphicVars($gvars);
<a name="l19780"></a>19780         <span class="comment">// set pointer to align the next text/objects</span>
<a name="l19781"></a>19781         <span class="keywordflow">switch</span>($align) {
<a name="l19782"></a>19782             <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:{
<a name="l19783"></a>19783                 $this-&gt;y = $y;
<a name="l19784"></a>19784                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l19785"></a>19785                 <span class="keywordflow">break</span>;
<a name="l19786"></a>19786             }
<a name="l19787"></a>19787             <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:{
<a name="l19788"></a>19788                 $this-&gt;y = $y + round($h/2);
<a name="l19789"></a>19789                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l19790"></a>19790                 <span class="keywordflow">break</span>;
<a name="l19791"></a>19791             }
<a name="l19792"></a>19792             <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:{
<a name="l19793"></a>19793                 $this-&gt;y = $this-&gt;img_rb_y;
<a name="l19794"></a>19794                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l19795"></a>19795                 <span class="keywordflow">break</span>;
<a name="l19796"></a>19796             }
<a name="l19797"></a>19797             <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:{
<a name="l19798"></a>19798                 $this-&gt;SetY($this-&gt;img_rb_y);
<a name="l19799"></a>19799                 <span class="keywordflow">break</span>;
<a name="l19800"></a>19800             }
<a name="l19801"></a>19801             <span class="keywordflow">default</span>:{
<a name="l19802"></a>19802                 <span class="keywordflow">break</span>;
<a name="l19803"></a>19803             }
<a name="l19804"></a>19804         }
<a name="l19805"></a>19805         $this-&gt;endlinex = $this-&gt;img_rb_x;
<a name="l19806"></a>19806     }
<a name="l19807"></a>19807 <span class="comment"></span>
<a name="l19808"></a>19808 <span class="comment">    /**</span>
<a name="l19809"></a>19809 <span class="comment">     * Returns an array containing current margins:</span>
<a name="l19810"></a>19810 <span class="comment">     * &lt;ul&gt;</span>
<a name="l19811"></a>19811 <span class="comment">            &lt;li&gt;$ret[&#39;left&#39;] = left margin&lt;/li&gt;</span>
<a name="l19812"></a>19812 <span class="comment">            &lt;li&gt;$ret[&#39;right&#39;] = right margin&lt;/li&gt;</span>
<a name="l19813"></a>19813 <span class="comment">            &lt;li&gt;$ret[&#39;top&#39;] = top margin&lt;/li&gt;</span>
<a name="l19814"></a>19814 <span class="comment">            &lt;li&gt;$ret[&#39;bottom&#39;] = bottom margin&lt;/li&gt;</span>
<a name="l19815"></a>19815 <span class="comment">            &lt;li&gt;$ret[&#39;header&#39;] = header margin&lt;/li&gt;</span>
<a name="l19816"></a>19816 <span class="comment">            &lt;li&gt;$ret[&#39;footer&#39;] = footer margin&lt;/li&gt;</span>
<a name="l19817"></a>19817 <span class="comment">            &lt;li&gt;$ret[&#39;cell&#39;] = cell padding array&lt;/li&gt;</span>
<a name="l19818"></a>19818 <span class="comment">            &lt;li&gt;$ret[&#39;padding_left&#39;] = cell left padding&lt;/li&gt;</span>
<a name="l19819"></a>19819 <span class="comment">            &lt;li&gt;$ret[&#39;padding_top&#39;] = cell top padding&lt;/li&gt;</span>
<a name="l19820"></a>19820 <span class="comment">            &lt;li&gt;$ret[&#39;padding_right&#39;] = cell right padding&lt;/li&gt;</span>
<a name="l19821"></a>19821 <span class="comment">            &lt;li&gt;$ret[&#39;padding_bottom&#39;] = cell bottom padding&lt;/li&gt;</span>
<a name="l19822"></a>19822 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l19823"></a>19823 <span class="comment">     * @return array containing all margins measures</span>
<a name="l19824"></a>19824 <span class="comment">     * @public</span>
<a name="l19825"></a>19825 <span class="comment">     * @since 3.2.000 (2008-06-23)</span>
<a name="l19826"></a>19826 <span class="comment">     */</span>
<a name="l19827"></a><a class="code" href="classTCPDF.html#ae9bd660bf5b5e00eea82f1168cc67b5b">19827</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae9bd660bf5b5e00eea82f1168cc67b5b" title="Returns an array containing current margins:">getMargins</a>() {
<a name="l19828"></a>19828         $ret = array(
<a name="l19829"></a>19829             <span class="stringliteral">&#39;left&#39;</span> =&gt; $this-&gt;lMargin,
<a name="l19830"></a>19830             <span class="stringliteral">&#39;right&#39;</span> =&gt; $this-&gt;rMargin,
<a name="l19831"></a>19831             <span class="stringliteral">&#39;top&#39;</span> =&gt; $this-&gt;tMargin,
<a name="l19832"></a>19832             <span class="stringliteral">&#39;bottom&#39;</span> =&gt; $this-&gt;bMargin,
<a name="l19833"></a>19833             <span class="stringliteral">&#39;header&#39;</span> =&gt; $this-&gt;header_margin,
<a name="l19834"></a>19834             <span class="stringliteral">&#39;footer&#39;</span> =&gt; $this-&gt;footer_margin,
<a name="l19835"></a>19835             <span class="stringliteral">&#39;cell&#39;</span> =&gt; $this-&gt;cell_padding,
<a name="l19836"></a>19836             <span class="stringliteral">&#39;padding_left&#39;</span> =&gt; $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>],
<a name="l19837"></a>19837             <span class="stringliteral">&#39;padding_top&#39;</span> =&gt; $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>],
<a name="l19838"></a>19838             <span class="stringliteral">&#39;padding_right&#39;</span> =&gt; $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>],
<a name="l19839"></a>19839             <span class="stringliteral">&#39;padding_bottom&#39;</span> =&gt; $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>]
<a name="l19840"></a>19840         );
<a name="l19841"></a>19841         <span class="keywordflow">return</span> $ret;
<a name="l19842"></a>19842     }
<a name="l19843"></a>19843 <span class="comment"></span>
<a name="l19844"></a>19844 <span class="comment">    /**</span>
<a name="l19845"></a>19845 <span class="comment">     * Returns an array containing original margins:</span>
<a name="l19846"></a>19846 <span class="comment">     * &lt;ul&gt;</span>
<a name="l19847"></a>19847 <span class="comment">            &lt;li&gt;$ret[&#39;left&#39;] = left margin&lt;/li&gt;</span>
<a name="l19848"></a>19848 <span class="comment">            &lt;li&gt;$ret[&#39;right&#39;] = right margin&lt;/li&gt;</span>
<a name="l19849"></a>19849 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l19850"></a>19850 <span class="comment">     * @return array containing all margins measures</span>
<a name="l19851"></a>19851 <span class="comment">     * @public</span>
<a name="l19852"></a>19852 <span class="comment">     * @since 4.0.012 (2008-07-24)</span>
<a name="l19853"></a>19853 <span class="comment">     */</span>
<a name="l19854"></a><a class="code" href="classTCPDF.html#a0cee973f21b885929d2c71c28782adac">19854</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0cee973f21b885929d2c71c28782adac" title="Returns an array containing original margins:">getOriginalMargins</a>() {
<a name="l19855"></a>19855         $ret = array(
<a name="l19856"></a>19856             <span class="stringliteral">&#39;left&#39;</span> =&gt; $this-&gt;original_lMargin,
<a name="l19857"></a>19857             <span class="stringliteral">&#39;right&#39;</span> =&gt; $this-&gt;original_rMargin
<a name="l19858"></a>19858         );
<a name="l19859"></a>19859         <span class="keywordflow">return</span> $ret;
<a name="l19860"></a>19860     }
<a name="l19861"></a>19861 <span class="comment"></span>
<a name="l19862"></a>19862 <span class="comment">    /**</span>
<a name="l19863"></a>19863 <span class="comment">     * Returns the current font size.</span>
<a name="l19864"></a>19864 <span class="comment">     * @return current font size</span>
<a name="l19865"></a>19865 <span class="comment">     * @public</span>
<a name="l19866"></a>19866 <span class="comment">     * @since 3.2.000 (2008-06-23)</span>
<a name="l19867"></a>19867 <span class="comment">     */</span>
<a name="l19868"></a><a class="code" href="classTCPDF.html#acd080ff16d09e445402c5bc8e831af7b">19868</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#acd080ff16d09e445402c5bc8e831af7b" title="Returns the current font size.">getFontSize</a>() {
<a name="l19869"></a>19869         <span class="keywordflow">return</span> $this-&gt;FontSize;
<a name="l19870"></a>19870     }
<a name="l19871"></a>19871 <span class="comment"></span>
<a name="l19872"></a>19872 <span class="comment">    /**</span>
<a name="l19873"></a>19873 <span class="comment">     * Returns the current font size in points unit.</span>
<a name="l19874"></a>19874 <span class="comment">     * @return current font size in points unit</span>
<a name="l19875"></a>19875 <span class="comment">     * @public</span>
<a name="l19876"></a>19876 <span class="comment">     * @since 3.2.000 (2008-06-23)</span>
<a name="l19877"></a>19877 <span class="comment">     */</span>
<a name="l19878"></a><a class="code" href="classTCPDF.html#a8d34f3978888eaf89b4d78a361fb4416">19878</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8d34f3978888eaf89b4d78a361fb4416" title="Returns the current font size in points unit.">getFontSizePt</a>() {
<a name="l19879"></a>19879         <span class="keywordflow">return</span> $this-&gt;FontSizePt;
<a name="l19880"></a>19880     }
<a name="l19881"></a>19881 <span class="comment"></span>
<a name="l19882"></a>19882 <span class="comment">    /**</span>
<a name="l19883"></a>19883 <span class="comment">     * Returns the current font family name.</span>
<a name="l19884"></a>19884 <span class="comment">     * @return string current font family name</span>
<a name="l19885"></a>19885 <span class="comment">     * @public</span>
<a name="l19886"></a>19886 <span class="comment">     * @since 4.3.008 (2008-12-05)</span>
<a name="l19887"></a>19887 <span class="comment">     */</span>
<a name="l19888"></a><a class="code" href="classTCPDF.html#acf73334191df85e1c4effbc5cf257cf5">19888</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#acf73334191df85e1c4effbc5cf257cf5" title="Returns the current font family name.">getFontFamily</a>() {
<a name="l19889"></a>19889         <span class="keywordflow">return</span> $this-&gt;FontFamily;
<a name="l19890"></a>19890     }
<a name="l19891"></a>19891 <span class="comment"></span>
<a name="l19892"></a>19892 <span class="comment">    /**</span>
<a name="l19893"></a>19893 <span class="comment">     * Returns the current font style.</span>
<a name="l19894"></a>19894 <span class="comment">     * @return string current font style</span>
<a name="l19895"></a>19895 <span class="comment">     * @public</span>
<a name="l19896"></a>19896 <span class="comment">     * @since 4.3.008 (2008-12-05)</span>
<a name="l19897"></a>19897 <span class="comment">     */</span>
<a name="l19898"></a><a class="code" href="classTCPDF.html#a130bd080e3028082d43b4d1d64f6702e">19898</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a130bd080e3028082d43b4d1d64f6702e" title="Returns the current font style.">getFontStyle</a>() {
<a name="l19899"></a>19899         <span class="keywordflow">return</span> $this-&gt;FontStyle;
<a name="l19900"></a>19900     }
<a name="l19901"></a>19901 <span class="comment"></span>
<a name="l19902"></a>19902 <span class="comment">    /**</span>
<a name="l19903"></a>19903 <span class="comment">     * Cleanup HTML code (requires HTML Tidy library).</span>
<a name="l19904"></a>19904 <span class="comment">     * @param $html (string) htmlcode to fix</span>
<a name="l19905"></a>19905 <span class="comment">     * @param $default_css (string) CSS commands to add</span>
<a name="l19906"></a>19906 <span class="comment">     * @param $tagvs (array) parameters for setHtmlVSpace method</span>
<a name="l19907"></a>19907 <span class="comment">     * @param $tidy_options (array) options for tidy_parse_string function</span>
<a name="l19908"></a>19908 <span class="comment">     * @return string XHTML code cleaned up</span>
<a name="l19909"></a>19909 <span class="comment">     * @author Nicola Asuni</span>
<a name="l19910"></a>19910 <span class="comment">     * @public</span>
<a name="l19911"></a>19911 <span class="comment">     * @since 5.9.017 (2010-11-16)</span>
<a name="l19912"></a>19912 <span class="comment">     * @see setHtmlVSpace()</span>
<a name="l19913"></a>19913 <span class="comment">     */</span>
<a name="l19914"></a><a class="code" href="classTCPDF.html#ae11c5c603573f58c854481fb3d74d588">19914</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae11c5c603573f58c854481fb3d74d588" title="Cleanup HTML code (requires HTML Tidy library).">fixHTMLCode</a>(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, $default_css=<span class="stringliteral">&#39;&#39;</span>, $tagvs=<span class="stringliteral">&#39;&#39;</span>, $tidy_options=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l19915"></a>19915         <span class="comment">// configure parameters for HTML Tidy</span>
<a name="l19916"></a>19916         <span class="keywordflow">if</span> ($tidy_options === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l19917"></a>19917             $tidy_options = array (
<a name="l19918"></a>19918                 <span class="stringliteral">&#39;clean&#39;</span> =&gt; 1,
<a name="l19919"></a>19919                 <span class="stringliteral">&#39;drop-empty-paras&#39;</span> =&gt; 0,
<a name="l19920"></a>19920                 <span class="stringliteral">&#39;drop-proprietary-attributes&#39;</span> =&gt; 1,
<a name="l19921"></a>19921                 <span class="stringliteral">&#39;fix-backslash&#39;</span> =&gt; 1,
<a name="l19922"></a>19922                 <span class="stringliteral">&#39;hide-comments&#39;</span> =&gt; 1,
<a name="l19923"></a>19923                 <span class="stringliteral">&#39;join-styles&#39;</span> =&gt; 1,
<a name="l19924"></a>19924                 <span class="stringliteral">&#39;lower-literals&#39;</span> =&gt; 1,
<a name="l19925"></a>19925                 <span class="stringliteral">&#39;merge-divs&#39;</span> =&gt; 1,
<a name="l19926"></a>19926                 <span class="stringliteral">&#39;merge-spans&#39;</span> =&gt; 1,
<a name="l19927"></a>19927                 <span class="stringliteral">&#39;output-xhtml&#39;</span> =&gt; 1,
<a name="l19928"></a>19928                 <span class="stringliteral">&#39;word-2000&#39;</span> =&gt; 1,
<a name="l19929"></a>19929                 <span class="stringliteral">&#39;wrap&#39;</span> =&gt; 0,
<a name="l19930"></a>19930                 <span class="stringliteral">&#39;output-bom&#39;</span> =&gt; 0,
<a name="l19931"></a>19931                 <span class="comment">//&#39;char-encoding&#39; =&gt; &#39;utf8&#39;,</span>
<a name="l19932"></a>19932                 <span class="comment">//&#39;input-encoding&#39; =&gt; &#39;utf8&#39;,</span>
<a name="l19933"></a>19933                 <span class="comment">//&#39;output-encoding&#39; =&gt; &#39;utf8&#39;</span>
<a name="l19934"></a>19934             );
<a name="l19935"></a>19935         }
<a name="l19936"></a>19936         <span class="comment">// clean up the HTML code</span>
<a name="l19937"></a>19937         $tidy = tidy_parse_string(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, $tidy_options);
<a name="l19938"></a>19938         <span class="comment">// fix the HTML</span>
<a name="l19939"></a>19939         $tidy-&gt;cleanRepair();
<a name="l19940"></a>19940         <span class="comment">// get the CSS part</span>
<a name="l19941"></a>19941         $tidy_head = tidy_get_head($tidy);
<a name="l19942"></a>19942         $css = $tidy_head-&gt;value;
<a name="l19943"></a>19943         $css = preg_replace(<span class="stringliteral">&#39;/&lt;style([^&gt;]+)&gt;/ims&#39;</span>, <span class="stringliteral">&#39;&lt;style&gt;&#39;</span>, $css);
<a name="l19944"></a>19944         $css = preg_replace(<span class="stringliteral">&#39;/&lt;\/style&gt;(.*)&lt;style&gt;/ims&#39;</span>, <span class="stringliteral">&quot;\n&quot;</span>, $css);
<a name="l19945"></a>19945         $css = str_replace(<span class="stringliteral">&#39;/*&lt;![CDATA[*/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $css);
<a name="l19946"></a>19946         $css = str_replace(<span class="stringliteral">&#39;/*]]&gt;*/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $css);
<a name="l19947"></a>19947         preg_match(<span class="stringliteral">&#39;/&lt;style&gt;(.*)&lt;\/style&gt;/ims&#39;</span>, $css, $matches);
<a name="l19948"></a>19948         <span class="keywordflow">if</span> (isset($matches[1])) {
<a name="l19949"></a>19949             $css = strtolower($matches[1]);
<a name="l19950"></a>19950         } <span class="keywordflow">else</span> {
<a name="l19951"></a>19951             $css = <span class="stringliteral">&#39;&#39;</span>;
<a name="l19952"></a>19952         }
<a name="l19953"></a>19953         <span class="comment">// include default css</span>
<a name="l19954"></a>19954         $css = <span class="stringliteral">&#39;&lt;style&gt;&#39;</span>.$default_css.$css.<span class="stringliteral">&#39;&lt;/style&gt;&#39;</span>;
<a name="l19955"></a>19955         <span class="comment">// get the body part</span>
<a name="l19956"></a>19956         $tidy_body = tidy_get_body($tidy);
<a name="l19957"></a>19957         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = $tidy_body-&gt;value;
<a name="l19958"></a>19958         <span class="comment">// fix some self-closing tags</span>
<a name="l19959"></a>19959         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = str_replace(<span class="stringliteral">&#39;&lt;br&gt;&#39;</span>, <span class="stringliteral">&#39;&lt;br /&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l19960"></a>19960         <span class="comment">// remove some empty tag blocks</span>
<a name="l19961"></a>19961         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;div([^&gt;]*)&gt;&lt;\/div&gt;/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l19962"></a>19962         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;p([^&gt;]*)&gt;&lt;\/p&gt;/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l19963"></a>19963         <span class="keywordflow">if</span> ($tagvs !== <span class="stringliteral">&#39;&#39;</span>) {
<a name="l19964"></a>19964             <span class="comment">// set vertical space for some XHTML tags</span>
<a name="l19965"></a>19965             $this-&gt;setHtmlVSpace($tagvs);
<a name="l19966"></a>19966         }
<a name="l19967"></a>19967         <span class="comment">// return the cleaned XHTML code + CSS</span>
<a name="l19968"></a>19968         <span class="keywordflow">return</span> $css.$html;
<a name="l19969"></a>19969     }
<a name="l19970"></a>19970 <span class="comment"></span>
<a name="l19971"></a>19971 <span class="comment">    /**</span>
<a name="l19972"></a>19972 <span class="comment">     * Extracts the CSS properties from a CSS string.</span>
<a name="l19973"></a>19973 <span class="comment">     * @param $cssdata (string) string containing CSS definitions.</span>
<a name="l19974"></a>19974 <span class="comment">     * @return An array where the keys are the CSS selectors and the values are the CSS properties.</span>
<a name="l19975"></a>19975 <span class="comment">     * @author Nicola Asuni</span>
<a name="l19976"></a>19976 <span class="comment">     * @since 5.1.000 (2010-05-25)</span>
<a name="l19977"></a>19977 <span class="comment">     * @protected</span>
<a name="l19978"></a>19978 <span class="comment">     */</span>
<a name="l19979"></a><a class="code" href="classTCPDF.html#a91e5459a8a22ce48eb9a7915b939431d">19979</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a91e5459a8a22ce48eb9a7915b939431d" title="Extracts the CSS properties from a CSS string.">extractCSSproperties</a>($cssdata) {
<a name="l19980"></a>19980         <span class="keywordflow">if</span> (empty($cssdata)) {
<a name="l19981"></a>19981             <span class="keywordflow">return</span> array();
<a name="l19982"></a>19982         }
<a name="l19983"></a>19983         <span class="comment">// remove comments</span>
<a name="l19984"></a>19984         $cssdata = preg_replace(<span class="stringliteral">&#39;/\/\*[^\*]*\*\//&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $cssdata);
<a name="l19985"></a>19985         <span class="comment">// remove newlines and multiple spaces</span>
<a name="l19986"></a>19986         $cssdata = preg_replace(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, <span class="charliteral">&#39; &#39;</span>, $cssdata);
<a name="l19987"></a>19987         <span class="comment">// remove some spaces</span>
<a name="l19988"></a>19988         $cssdata = preg_replace(<span class="stringliteral">&#39;/[\s]*([;:\{\}]{1})[\s]*/&#39;</span>, <span class="stringliteral">&#39;\\1&#39;</span>, $cssdata);
<a name="l19989"></a>19989         <span class="comment">// remove empty blocks</span>
<a name="l19990"></a>19990         $cssdata = preg_replace(<span class="stringliteral">&#39;/([^\}\{]+)\{\}/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $cssdata);
<a name="l19991"></a>19991         <span class="comment">// replace media type parenthesis</span>
<a name="l19992"></a>19992         $cssdata = preg_replace(<span class="stringliteral">&#39;/@media[\s]+([^\{]*)\{/i&#39;</span>, <span class="stringliteral">&#39;@media \\1§&#39;</span>, $cssdata);
<a name="l19993"></a>19993         $cssdata = preg_replace(<span class="stringliteral">&#39;/\}\}/si&#39;</span>, <span class="stringliteral">&#39;}§&#39;</span>, $cssdata);
<a name="l19994"></a>19994         <span class="comment">// trim string</span>
<a name="l19995"></a>19995         $cssdata = trim($cssdata);
<a name="l19996"></a>19996         <span class="comment">// find media blocks (all, braille, embossed, handheld, print, projection, screen, speech, tty, tv)</span>
<a name="l19997"></a>19997         $cssblocks = array();
<a name="l19998"></a>19998         $matches = array();
<a name="l19999"></a>19999         <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/@media[\s]+([^\§]*)§([^§]*)§/i&#39;</span>, $cssdata, $matches) &gt; 0) {
<a name="l20000"></a>20000             <span class="keywordflow">foreach</span> ($matches[1] as $key =&gt; <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>) {
<a name="l20001"></a>20001                 $cssblocks[<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>] = $matches[2][$key];
<a name="l20002"></a>20002             }
<a name="l20003"></a>20003             <span class="comment">// remove media blocks</span>
<a name="l20004"></a>20004             $cssdata = preg_replace(<span class="stringliteral">&#39;/@media[\s]+([^\§]*)§([^§]*)§/i&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $cssdata);
<a name="l20005"></a>20005         }
<a name="l20006"></a>20006         <span class="comment">// keep &#39;all&#39; and &#39;print&#39; media, other media types are discarded</span>
<a name="l20007"></a>20007         <span class="keywordflow">if</span> (isset($cssblocks[<span class="stringliteral">&#39;all&#39;</span>]) AND !empty($cssblocks[<span class="stringliteral">&#39;all&#39;</span>])) {
<a name="l20008"></a>20008             $cssdata .= $cssblocks[<span class="stringliteral">&#39;all&#39;</span>];
<a name="l20009"></a>20009         }
<a name="l20010"></a>20010         <span class="keywordflow">if</span> (isset($cssblocks[<span class="stringliteral">&#39;print&#39;</span>]) AND !empty($cssblocks[<span class="stringliteral">&#39;print&#39;</span>])) {
<a name="l20011"></a>20011             $cssdata .= $cssblocks[<span class="stringliteral">&#39;print&#39;</span>];
<a name="l20012"></a>20012         }
<a name="l20013"></a>20013         <span class="comment">// reset css blocks array</span>
<a name="l20014"></a>20014         $cssblocks = array();
<a name="l20015"></a>20015         $matches = array();
<a name="l20016"></a>20016         <span class="comment">// explode css data string into array</span>
<a name="l20017"></a>20017         <span class="keywordflow">if</span> (substr($cssdata, -1) == <span class="charliteral">&#39;}&#39;</span>) {
<a name="l20018"></a>20018             <span class="comment">// remove last parethesis</span>
<a name="l20019"></a>20019             $cssdata = substr($cssdata, 0, -1);
<a name="l20020"></a>20020         }
<a name="l20021"></a>20021         $matches = explode(<span class="charliteral">&#39;}&#39;</span>, $cssdata);
<a name="l20022"></a>20022         <span class="keywordflow">foreach</span> ($matches as $key =&gt; $block) {
<a name="l20023"></a>20023             <span class="comment">// index 0 contains the CSS selector, index 1 contains CSS properties</span>
<a name="l20024"></a>20024             $cssblocks[$key] = explode(<span class="charliteral">&#39;{&#39;</span>, $block);
<a name="l20025"></a>20025             <span class="keywordflow">if</span> (!isset($cssblocks[$key][1])) {
<a name="l20026"></a>20026                 <span class="comment">// remove empty definitions</span>
<a name="l20027"></a>20027                 unset($cssblocks[$key]);
<a name="l20028"></a>20028             }
<a name="l20029"></a>20029         }
<a name="l20030"></a>20030         <span class="comment">// split groups of selectors (comma-separated list of selectors)</span>
<a name="l20031"></a>20031         <span class="keywordflow">foreach</span> ($cssblocks as $key =&gt; $block) {
<a name="l20032"></a>20032             <span class="keywordflow">if</span> (strpos($block[0], <span class="charliteral">&#39;,&#39;</span>) &gt; 0) {
<a name="l20033"></a>20033                 $selectors = explode(<span class="charliteral">&#39;,&#39;</span>, $block[0]);
<a name="l20034"></a>20034                 <span class="keywordflow">foreach</span> ($selectors as $sel) {
<a name="l20035"></a>20035                     $cssblocks[] = array(0 =&gt; trim($sel), 1 =&gt; $block[1]);
<a name="l20036"></a>20036                 }
<a name="l20037"></a>20037                 unset($cssblocks[$key]);
<a name="l20038"></a>20038             }
<a name="l20039"></a>20039         }
<a name="l20040"></a>20040         <span class="comment">// covert array to selector =&gt; properties</span>
<a name="l20041"></a>20041         $cssdata = array();
<a name="l20042"></a>20042         <span class="keywordflow">foreach</span> ($cssblocks as $block) {
<a name="l20043"></a>20043             $selector = $block[0];
<a name="l20044"></a>20044             <span class="comment">// calculate selector&#39;s specificity</span>
<a name="l20045"></a>20045             $matches = array();
<a name="l20046"></a>20046             $a = 0; <span class="comment">// the declaration is not from is a &#39;style&#39; attribute</span>
<a name="l20047"></a>20047             $b = intval(preg_match_all(<span class="stringliteral">&#39;/[\#]/&#39;</span>, $selector, $matches)); <span class="comment">// number of ID attributes</span>
<a name="l20048"></a>20048             <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = intval(preg_match_all(<span class="stringliteral">&#39;/[\[\.]/&#39;</span>, $selector, $matches)); <span class="comment">// number of other attributes</span>
<a name="l20049"></a>20049             <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> += intval(preg_match_all(<span class="stringliteral">&#39;/[\:]link|visited|hover|active|focus|target|lang|enabled|disabled|checked|indeterminate|root|nth|first|last|only|empty|contains|not/i&#39;</span>, $selector, $matches)); <span class="comment">// number of pseudo-classes</span>
<a name="l20050"></a>20050             $d = intval(preg_match_all(<span class="stringliteral">&#39;/[&gt;\+\~\s]{1}[a-zA-Z0-9]+/&#39;</span>, <span class="charliteral">&#39; &#39;</span>.$selector, $matches)); <span class="comment">// number of element names</span>
<a name="l20051"></a>20051             $d += intval(preg_match_all(<span class="stringliteral">&#39;/[\:][\:]/&#39;</span>, $selector, $matches)); <span class="comment">// number of pseudo-elements</span>
<a name="l20052"></a>20052             $specificity = $a.$b.$c.$d;
<a name="l20053"></a>20053             <span class="comment">// add specificity to the beginning of the selector</span>
<a name="l20054"></a>20054             $cssdata[$specificity.<span class="charliteral">&#39; &#39;</span>.$selector] = $block[1];
<a name="l20055"></a>20055         }
<a name="l20056"></a>20056         <span class="comment">// sort selectors alphabetically to account for specificity</span>
<a name="l20057"></a>20057         ksort($cssdata, SORT_STRING);
<a name="l20058"></a>20058         <span class="comment">// return array</span>
<a name="l20059"></a>20059         <span class="keywordflow">return</span> $cssdata;
<a name="l20060"></a>20060     }
<a name="l20061"></a>20061 <span class="comment"></span>
<a name="l20062"></a>20062 <span class="comment">    /**</span>
<a name="l20063"></a>20063 <span class="comment">     * Returns true if the CSS selector is valid for the selected HTML tag</span>
<a name="l20064"></a>20064 <span class="comment">     * @param $dom (array) array of HTML tags and properties</span>
<a name="l20065"></a>20065 <span class="comment">     * @param $key (int) key of the current HTML tag</span>
<a name="l20066"></a>20066 <span class="comment">     * @param $selector (string) CSS selector string</span>
<a name="l20067"></a>20067 <span class="comment">     * @return true if the selector is valid, false otherwise</span>
<a name="l20068"></a>20068 <span class="comment">     * @protected</span>
<a name="l20069"></a>20069 <span class="comment">     * @since 5.1.000 (2010-05-25)</span>
<a name="l20070"></a>20070 <span class="comment">     */</span>
<a name="l20071"></a><a class="code" href="classTCPDF.html#a93b5c29f2b8227063a003b13dc98f493">20071</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a93b5c29f2b8227063a003b13dc98f493" title="Returns true if the CSS selector is valid for the selected HTML tag.">isValidCSSSelectorForTag</a>($dom, $key, $selector) {
<a name="l20072"></a>20072         $valid = <span class="keyword">false</span>; <span class="comment">// value to be returned</span>
<a name="l20073"></a>20073         $tag = $dom[$key][<span class="stringliteral">&#39;value&#39;</span>];
<a name="l20074"></a>20074         <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> = array();
<a name="l20075"></a>20075         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;class&#39;</span>]) AND !empty($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;class&#39;</span>])) {
<a name="l20076"></a>20076             <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a> = explode(<span class="charliteral">&#39; &#39;</span>, strtolower($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;class&#39;</span>]));
<a name="l20077"></a>20077         }
<a name="l20078"></a>20078         <a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l20079"></a>20079         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>]) AND !empty($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>])) {
<a name="l20080"></a>20080             <a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a> = strtolower($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>]);
<a name="l20081"></a>20081         }
<a name="l20082"></a>20082         $selector = preg_replace(<span class="stringliteral">&#39;/([&gt;\+\~\s]{1})([\.]{1})([^&gt;\+\~\s]*)/si&#39;</span>, <span class="stringliteral">&#39;\\1*.\\3&#39;</span>, $selector);
<a name="l20083"></a>20083         $matches = array();
<a name="l20084"></a>20084         <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/([&gt;\+\~\s]{1})([a-zA-Z0-9\*]+)([^&gt;\+\~\s]*)/si&#39;</span>, $selector, $matches, PREG_PATTERN_ORDER | PREG_OFFSET_CAPTURE) &gt; 0) {
<a name="l20085"></a>20085             $parentop = array_pop($matches[1]);
<a name="l20086"></a>20086             $operator = $parentop[0];
<a name="l20087"></a>20087             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = $parentop[1];
<a name="l20088"></a>20088             $lasttag = array_pop($matches[2]);
<a name="l20089"></a>20089             $lasttag = strtolower(trim($lasttag[0]));
<a name="l20090"></a>20090             <span class="keywordflow">if</span> (($lasttag == <span class="charliteral">&#39;*&#39;</span>) OR ($lasttag == $tag)) {
<a name="l20091"></a>20091                 <span class="comment">// the last element on selector is our tag or &#39;any tag&#39;</span>
<a name="l20092"></a>20092                 $attrib = array_pop($matches[3]);
<a name="l20093"></a>20093                 $attrib = strtolower(trim($attrib[0]));
<a name="l20094"></a>20094                 <span class="keywordflow">if</span> (!empty($attrib)) {
<a name="l20095"></a>20095                     <span class="comment">// check if matches class, id, attribute, pseudo-class or pseudo-element</span>
<a name="l20096"></a>20096                     <span class="keywordflow">switch</span> ($attrib{0}) {
<a name="l20097"></a>20097                         <span class="keywordflow">case</span> <span class="charliteral">&#39;.&#39;</span>: { <span class="comment">// class</span>
<a name="l20098"></a>20098                             <span class="keywordflow">if</span> (in_array(substr($attrib, 1), <a class="code" href="main_8php.html#a252ba022809910ea710a068fc1bab657">$class</a>)) {
<a name="l20099"></a>20099                                 $valid = <span class="keyword">true</span>;
<a name="l20100"></a>20100                             }
<a name="l20101"></a>20101                             <span class="keywordflow">break</span>;
<a name="l20102"></a>20102                         }
<a name="l20103"></a>20103                         <span class="keywordflow">case</span> <span class="charliteral">&#39;#&#39;</span>: { <span class="comment">// ID</span>
<a name="l20104"></a>20104                             <span class="keywordflow">if</span> (substr($attrib, 1) == <a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>) {
<a name="l20105"></a>20105                                 $valid = <span class="keyword">true</span>;
<a name="l20106"></a>20106                             }
<a name="l20107"></a>20107                             <span class="keywordflow">break</span>;
<a name="l20108"></a>20108                         }
<a name="l20109"></a>20109                         <span class="keywordflow">case</span> <span class="charliteral">&#39;[&#39;</span>: { <span class="comment">// attribute</span>
<a name="l20110"></a>20110                             $attrmatch = array();
<a name="l20111"></a>20111                             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/\[([a-zA-Z0-9]*)[\s]*([\~\^\$\*\|\=]*)[\s]*[&quot;]?([^&quot;\]]*)[&quot;]?\]/i&#39;</span>, $attrib, $attrmatch) &gt; 0) {
<a name="l20112"></a>20112                                 $att = strtolower($attrmatch[1]);
<a name="l20113"></a>20113                                 $val = $attrmatch[3];
<a name="l20114"></a>20114                                 <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][$att])) {
<a name="l20115"></a>20115                                     <span class="keywordflow">switch</span> ($attrmatch[2]) {
<a name="l20116"></a>20116                                         <span class="keywordflow">case</span> <span class="charliteral">&#39;=&#39;</span>: {
<a name="l20117"></a>20117                                             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][$att] == $val) {
<a name="l20118"></a>20118                                                 $valid = <span class="keyword">true</span>;
<a name="l20119"></a>20119                                             }
<a name="l20120"></a>20120                                             <span class="keywordflow">break</span>;
<a name="l20121"></a>20121                                         }
<a name="l20122"></a>20122                                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;~=&#39;</span>: {
<a name="l20123"></a>20123                                             <span class="keywordflow">if</span> (in_array($val, explode(<span class="charliteral">&#39; &#39;</span>, $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][$att]))) {
<a name="l20124"></a>20124                                                 $valid = <span class="keyword">true</span>;
<a name="l20125"></a>20125                                             }
<a name="l20126"></a>20126                                             <span class="keywordflow">break</span>;
<a name="l20127"></a>20127                                         }
<a name="l20128"></a>20128                                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;^=&#39;</span>: {
<a name="l20129"></a>20129                                             <span class="keywordflow">if</span> ($val == substr($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][$att], 0, strlen($val))) {
<a name="l20130"></a>20130                                                 $valid = <span class="keyword">true</span>;
<a name="l20131"></a>20131                                             }
<a name="l20132"></a>20132                                             <span class="keywordflow">break</span>;
<a name="l20133"></a>20133                                         }
<a name="l20134"></a>20134                                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;$=&#39;</span>: {
<a name="l20135"></a>20135                                             <span class="keywordflow">if</span> ($val == substr($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][$att], -strlen($val))) {
<a name="l20136"></a>20136                                                 $valid = <span class="keyword">true</span>;
<a name="l20137"></a>20137                                             }
<a name="l20138"></a>20138                                             <span class="keywordflow">break</span>;
<a name="l20139"></a>20139                                         }
<a name="l20140"></a>20140                                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;*=&#39;</span>: {
<a name="l20141"></a>20141                                             <span class="keywordflow">if</span> (strpos($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][$att], $val) !== <span class="keyword">false</span>) {
<a name="l20142"></a>20142                                                 $valid = <span class="keyword">true</span>;
<a name="l20143"></a>20143                                             }
<a name="l20144"></a>20144                                             <span class="keywordflow">break</span>;
<a name="l20145"></a>20145                                         }
<a name="l20146"></a>20146                                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;|=&#39;</span>: {
<a name="l20147"></a>20147                                             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][$att] == $val) {
<a name="l20148"></a>20148                                                 $valid = <span class="keyword">true</span>;
<a name="l20149"></a>20149                                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (preg_match(<span class="charliteral">&#39;/&#39;</span>.$val.<span class="stringliteral">&#39;[\-]{1}/i&#39;</span>, $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][$att]) &gt; 0) {
<a name="l20150"></a>20150                                                 $valid = <span class="keyword">true</span>;
<a name="l20151"></a>20151                                             }
<a name="l20152"></a>20152                                             <span class="keywordflow">break</span>;
<a name="l20153"></a>20153                                         }
<a name="l20154"></a>20154                                         <span class="keywordflow">default</span>: {
<a name="l20155"></a>20155                                             $valid = <span class="keyword">true</span>;
<a name="l20156"></a>20156                                         }
<a name="l20157"></a>20157                                     }
<a name="l20158"></a>20158                                 }
<a name="l20159"></a>20159                             }
<a name="l20160"></a>20160                             <span class="keywordflow">break</span>;
<a name="l20161"></a>20161                         }
<a name="l20162"></a>20162                         <span class="keywordflow">case</span> <span class="charliteral">&#39;:&#39;</span>: { <span class="comment">// pseudo-class or pseudo-element</span>
<a name="l20163"></a>20163                             <span class="keywordflow">if</span> ($attrib{1} == <span class="charliteral">&#39;:&#39;</span>) { <span class="comment">// pseudo-element</span>
<a name="l20164"></a>20164                                 <span class="comment">// pseudo-elements are not supported!</span>
<a name="l20165"></a>20165                                 <span class="comment">// (::first-line, ::first-letter, ::before, ::after)</span>
<a name="l20166"></a>20166                             } <span class="keywordflow">else</span> { <span class="comment">// pseudo-class</span>
<a name="l20167"></a>20167                                 <span class="comment">// pseudo-classes are not supported!</span>
<a name="l20168"></a>20168                                 <span class="comment">// (:root, :nth-child(n), :nth-last-child(n), :nth-of-type(n), :nth-last-of-type(n), :first-child, :last-child, :first-of-type, :last-of-type, :only-child, :only-of-type, :empty, :link, :visited, :active, :hover, :focus, :target, :lang(fr), :enabled, :disabled, :checked)</span>
<a name="l20169"></a>20169                             }
<a name="l20170"></a>20170                             <span class="keywordflow">break</span>;
<a name="l20171"></a>20171                         }
<a name="l20172"></a>20172                     } <span class="comment">// end of switch</span>
<a name="l20173"></a>20173                 } <span class="keywordflow">else</span> {
<a name="l20174"></a>20174                     $valid = <span class="keyword">true</span>;
<a name="l20175"></a>20175                 }
<a name="l20176"></a>20176                 <span class="keywordflow">if</span> ($valid AND (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> &gt; 0)) {
<a name="l20177"></a>20177                     $valid = <span class="keyword">false</span>;
<a name="l20178"></a>20178                     <span class="comment">// check remaining selector part</span>
<a name="l20179"></a>20179                     $selector = substr($selector, 0, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l20180"></a>20180                     <span class="keywordflow">switch</span> ($operator) {
<a name="l20181"></a>20181                         <span class="keywordflow">case</span> <span class="charliteral">&#39; &#39;</span>: { <span class="comment">// descendant of an element</span>
<a name="l20182"></a>20182                             <span class="keywordflow">while</span> ($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] &gt; 0) {
<a name="l20183"></a>20183                                 <span class="keywordflow">if</span> ($this-&gt;isValidCSSSelectorForTag($dom, $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>], $selector)) {
<a name="l20184"></a>20184                                     $valid = <span class="keyword">true</span>;
<a name="l20185"></a>20185                                     <span class="keywordflow">break</span>;
<a name="l20186"></a>20186                                 } <span class="keywordflow">else</span> {
<a name="l20187"></a>20187                                     $key = $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>];
<a name="l20188"></a>20188                                 }
<a name="l20189"></a>20189                             }
<a name="l20190"></a>20190                             <span class="keywordflow">break</span>;
<a name="l20191"></a>20191                         }
<a name="l20192"></a>20192                         <span class="keywordflow">case</span> <span class="charliteral">&#39;&gt;&#39;</span>: { <span class="comment">// child of an element</span>
<a name="l20193"></a>20193                             $valid = $this-&gt;isValidCSSSelectorForTag($dom, $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>], $selector);
<a name="l20194"></a>20194                             <span class="keywordflow">break</span>;
<a name="l20195"></a>20195                         }
<a name="l20196"></a>20196                         <span class="keywordflow">case</span> <span class="charliteral">&#39;+&#39;</span>: { <span class="comment">// immediately preceded by an element</span>
<a name="l20197"></a>20197                             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = ($key - 1); <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]; --<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l20198"></a>20198                                 <span class="keywordflow">if</span> ($dom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;opening&#39;</span>]) {
<a name="l20199"></a>20199                                     $valid = $this-&gt;isValidCSSSelectorForTag($dom, $i, $selector);
<a name="l20200"></a>20200                                     <span class="keywordflow">break</span>;
<a name="l20201"></a>20201                                 }
<a name="l20202"></a>20202                             }
<a name="l20203"></a>20203                             <span class="keywordflow">break</span>;
<a name="l20204"></a>20204                         }
<a name="l20205"></a>20205                         <span class="keywordflow">case</span> <span class="charliteral">&#39;~&#39;</span>: { <span class="comment">// preceded by an element</span>
<a name="l20206"></a>20206                             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = ($key - 1); <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]; --<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l20207"></a>20207                                 <span class="keywordflow">if</span> ($dom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;opening&#39;</span>]) {
<a name="l20208"></a>20208                                     <span class="keywordflow">if</span> ($this-&gt;isValidCSSSelectorForTag($dom, $i, $selector)) {
<a name="l20209"></a>20209                                         <span class="keywordflow">break</span>;
<a name="l20210"></a>20210                                     }
<a name="l20211"></a>20211                                 }
<a name="l20212"></a>20212                             }
<a name="l20213"></a>20213                             <span class="keywordflow">break</span>;
<a name="l20214"></a>20214                         }
<a name="l20215"></a>20215                     }
<a name="l20216"></a>20216                 }
<a name="l20217"></a>20217             }
<a name="l20218"></a>20218         }
<a name="l20219"></a>20219         <span class="keywordflow">return</span> $valid;
<a name="l20220"></a>20220     }
<a name="l20221"></a>20221 <span class="comment"></span>
<a name="l20222"></a>20222 <span class="comment">    /**</span>
<a name="l20223"></a>20223 <span class="comment">     * Returns the styles array that apply for the selected HTML tag.</span>
<a name="l20224"></a>20224 <span class="comment">     * @param $dom (array) array of HTML tags and properties</span>
<a name="l20225"></a>20225 <span class="comment">     * @param $key (int) key of the current HTML tag</span>
<a name="l20226"></a>20226 <span class="comment">     * @param $css (array) array of CSS properties</span>
<a name="l20227"></a>20227 <span class="comment">     * @return array containing CSS properties</span>
<a name="l20228"></a>20228 <span class="comment">     * @protected</span>
<a name="l20229"></a>20229 <span class="comment">     * @since 5.1.000 (2010-05-25)</span>
<a name="l20230"></a>20230 <span class="comment">     */</span>
<a name="l20231"></a><a class="code" href="classTCPDF.html#ade4ce9be2bbe6feaba8d26dfe16abaf3">20231</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ade4ce9be2bbe6feaba8d26dfe16abaf3" title="Returns the styles array that apply for the selected HTML tag.">getCSSdataArray</a>($dom, $key, $css) {
<a name="l20232"></a>20232         $cssarray = array(); <span class="comment">// style to be returned</span>
<a name="l20233"></a>20233         <span class="comment">// get parent CSS selectors</span>
<a name="l20234"></a>20234         $selectors = array();
<a name="l20235"></a>20235         <span class="keywordflow">if</span> (isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;csssel&#39;</span>])) {
<a name="l20236"></a>20236             $selectors = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;csssel&#39;</span>];
<a name="l20237"></a>20237         }
<a name="l20238"></a>20238         <span class="comment">// get all styles that apply</span>
<a name="l20239"></a>20239         <span class="keywordflow">foreach</span>($css as $selector =&gt; $style) {
<a name="l20240"></a>20240             <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos($selector, <span class="charliteral">&#39; &#39;</span>);
<a name="l20241"></a>20241             <span class="comment">// get specificity</span>
<a name="l20242"></a>20242             $specificity = substr($selector, 0, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>);
<a name="l20243"></a>20243             <span class="comment">// remove specificity</span>
<a name="l20244"></a>20244             $selector = substr($selector, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>);
<a name="l20245"></a>20245             <span class="comment">// check if this selector apply to current tag</span>
<a name="l20246"></a>20246             <span class="keywordflow">if</span> ($this-&gt;isValidCSSSelectorForTag($dom, $key, $selector)) {
<a name="l20247"></a>20247                 <span class="keywordflow">if</span> (!in_array($selector, $selectors)) {
<a name="l20248"></a>20248                     <span class="comment">// add style if not already added on parent selector</span>
<a name="l20249"></a>20249                     $cssarray[] = array(<span class="charliteral">&#39;k&#39;</span> =&gt; $selector, <span class="charliteral">&#39;s&#39;</span> =&gt; $specificity, <span class="charliteral">&#39;c&#39;</span> =&gt; $style);
<a name="l20250"></a>20250                     $selectors[] = $selector;
<a name="l20251"></a>20251                 }
<a name="l20252"></a>20252             }
<a name="l20253"></a>20253         }
<a name="l20254"></a>20254         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>])) {
<a name="l20255"></a>20255             <span class="comment">// attach inline style (latest properties have high priority)</span>
<a name="l20256"></a>20256             $cssarray[] = array(<span class="charliteral">&#39;k&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;s&#39;</span> =&gt; <span class="stringliteral">&#39;1000&#39;</span>, <span class="charliteral">&#39;c&#39;</span> =&gt; $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>]);
<a name="l20257"></a>20257         }
<a name="l20258"></a>20258         <span class="comment">// order the css array to account for specificity</span>
<a name="l20259"></a>20259         $cssordered = array();
<a name="l20260"></a>20260         <span class="keywordflow">foreach</span> ($cssarray as $key =&gt; $val) {
<a name="l20261"></a>20261             $skey = sprintf(<span class="stringliteral">&#39;%04d&#39;</span>, $key);
<a name="l20262"></a>20262             $cssordered[$val[<span class="charliteral">&#39;s&#39;</span>].<span class="charliteral">&#39;_&#39;</span>.$skey] = $val;
<a name="l20263"></a>20263         }
<a name="l20264"></a>20264         <span class="comment">// sort selectors alphabetically to account for specificity</span>
<a name="l20265"></a>20265         ksort($cssordered, SORT_STRING);
<a name="l20266"></a>20266         <span class="keywordflow">return</span> array($selectors, $cssordered);
<a name="l20267"></a>20267     }
<a name="l20268"></a>20268 <span class="comment"></span>
<a name="l20269"></a>20269 <span class="comment">    /**</span>
<a name="l20270"></a>20270 <span class="comment">     * Compact CSS data array into single string.</span>
<a name="l20271"></a>20271 <span class="comment">     * @param $css (array) array of CSS properties</span>
<a name="l20272"></a>20272 <span class="comment">     * @return string containing merged CSS properties</span>
<a name="l20273"></a>20273 <span class="comment">     * @protected</span>
<a name="l20274"></a>20274 <span class="comment">     * @since 5.9.070 (2011-04-19)</span>
<a name="l20275"></a>20275 <span class="comment">     */</span>
<a name="l20276"></a><a class="code" href="classTCPDF.html#a1c13044766ea9f46ac1e3035b8bfaa83">20276</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1c13044766ea9f46ac1e3035b8bfaa83" title="Compact CSS data array into single string.">getTagStyleFromCSSarray</a>($css) {
<a name="l20277"></a>20277         $tagstyle = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// value to be returned</span>
<a name="l20278"></a>20278         <span class="keywordflow">foreach</span> ($css as $style) {
<a name="l20279"></a>20279             <span class="comment">// split single css commands</span>
<a name="l20280"></a>20280             $csscmds = explode(<span class="charliteral">&#39;;&#39;</span>, $style[<span class="charliteral">&#39;c&#39;</span>]);
<a name="l20281"></a>20281             <span class="keywordflow">foreach</span> ($csscmds as $cmd) {
<a name="l20282"></a>20282                 <span class="keywordflow">if</span> (!empty($cmd)) {
<a name="l20283"></a>20283                     <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos($cmd, <span class="charliteral">&#39;:&#39;</span>);
<a name="l20284"></a>20284                     <span class="keywordflow">if</span> (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> !== <span class="keyword">false</span>) {
<a name="l20285"></a>20285                         $cmd = substr($cmd, 0, (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + 1));
<a name="l20286"></a>20286                         <span class="keywordflow">if</span> (strpos($tagstyle, $cmd) !== <span class="keyword">false</span>) {
<a name="l20287"></a>20287                             <span class="comment">// remove duplicate commands (last commands have high priority)</span>
<a name="l20288"></a>20288                             $tagstyle = preg_replace(<span class="charliteral">&#39;/&#39;</span>.$cmd.<span class="stringliteral">&#39;[^;]+/i&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $tagstyle);
<a name="l20289"></a>20289                         }
<a name="l20290"></a>20290                     }
<a name="l20291"></a>20291                 }
<a name="l20292"></a>20292             }
<a name="l20293"></a>20293             $tagstyle .= <span class="charliteral">&#39;;&#39;</span>.$style[<span class="charliteral">&#39;c&#39;</span>];
<a name="l20294"></a>20294         }
<a name="l20295"></a>20295         <span class="comment">// remove multiple semicolons</span>
<a name="l20296"></a>20296         $tagstyle = preg_replace(<span class="stringliteral">&#39;/[;]+/&#39;</span>, <span class="charliteral">&#39;;&#39;</span>, $tagstyle);
<a name="l20297"></a>20297         <span class="keywordflow">return</span> $tagstyle;
<a name="l20298"></a>20298     }
<a name="l20299"></a>20299 <span class="comment"></span>
<a name="l20300"></a>20300 <span class="comment">    /**</span>
<a name="l20301"></a>20301 <span class="comment">     * Returns the border width from CSS property</span>
<a name="l20302"></a>20302 <span class="comment">     * @param $width (string) border width</span>
<a name="l20303"></a>20303 <span class="comment">     * @return int with in user units</span>
<a name="l20304"></a>20304 <span class="comment">     * @protected</span>
<a name="l20305"></a>20305 <span class="comment">     * @since 5.7.000 (2010-08-02)</span>
<a name="l20306"></a>20306 <span class="comment">     */</span>
<a name="l20307"></a><a class="code" href="classTCPDF.html#a79695745bece08e32a7899f8217bf74d">20307</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a79695745bece08e32a7899f8217bf74d" title="Returns the border width from CSS property.">getCSSBorderWidth</a>($width) {
<a name="l20308"></a>20308         <span class="keywordflow">if</span> ($width == <span class="stringliteral">&#39;thin&#39;</span>) {
<a name="l20309"></a>20309             $width = (2 / $this-&gt;k);
<a name="l20310"></a>20310         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($width == <span class="stringliteral">&#39;medium&#39;</span>) {
<a name="l20311"></a>20311             $width = (4 / $this-&gt;k);
<a name="l20312"></a>20312         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($width == <span class="stringliteral">&#39;thick&#39;</span>) {
<a name="l20313"></a>20313             $width = (6 / $this-&gt;k);
<a name="l20314"></a>20314         } <span class="keywordflow">else</span> {
<a name="l20315"></a>20315             $width = $this-&gt;getHTMLUnitToUnits($width, 1, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20316"></a>20316         }
<a name="l20317"></a>20317         <span class="keywordflow">return</span> $width;
<a name="l20318"></a>20318     }
<a name="l20319"></a>20319 <span class="comment"></span>
<a name="l20320"></a>20320 <span class="comment">    /**</span>
<a name="l20321"></a>20321 <span class="comment">     * Returns the border dash style from CSS property</span>
<a name="l20322"></a>20322 <span class="comment">     * @param $style (string) border style to convert</span>
<a name="l20323"></a>20323 <span class="comment">     * @return int sash style (return -1 in case of none or hidden border)</span>
<a name="l20324"></a>20324 <span class="comment">     * @protected</span>
<a name="l20325"></a>20325 <span class="comment">     * @since 5.7.000 (2010-08-02)</span>
<a name="l20326"></a>20326 <span class="comment">     */</span>
<a name="l20327"></a><a class="code" href="classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">20327</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7cd52df1697c10362b74645261fb38f1" title="Returns the border dash style from CSS property.">getCSSBorderDashStyle</a>($style) {
<a name="l20328"></a>20328         <span class="keywordflow">switch</span> (strtolower($style)) {
<a name="l20329"></a>20329             <span class="keywordflow">case</span> <span class="stringliteral">&#39;none&#39;</span>:
<a name="l20330"></a>20330             <span class="keywordflow">case</span> <span class="stringliteral">&#39;hidden&#39;</span>: {
<a name="l20331"></a>20331                 $dash = -1;
<a name="l20332"></a>20332                 <span class="keywordflow">break</span>;
<a name="l20333"></a>20333             }
<a name="l20334"></a>20334             <span class="keywordflow">case</span> <span class="stringliteral">&#39;dotted&#39;</span>: {
<a name="l20335"></a>20335                 $dash = 1;
<a name="l20336"></a>20336                 <span class="keywordflow">break</span>;
<a name="l20337"></a>20337             }
<a name="l20338"></a>20338             <span class="keywordflow">case</span> <span class="stringliteral">&#39;dashed&#39;</span>: {
<a name="l20339"></a>20339                 $dash = 3;
<a name="l20340"></a>20340                 <span class="keywordflow">break</span>;
<a name="l20341"></a>20341             }
<a name="l20342"></a>20342             <span class="keywordflow">case</span> <span class="stringliteral">&#39;double&#39;</span>:
<a name="l20343"></a>20343             <span class="keywordflow">case</span> <span class="stringliteral">&#39;groove&#39;</span>:
<a name="l20344"></a>20344             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ridge&#39;</span>:
<a name="l20345"></a>20345             <span class="keywordflow">case</span> <span class="stringliteral">&#39;inset&#39;</span>:
<a name="l20346"></a>20346             <span class="keywordflow">case</span> <span class="stringliteral">&#39;outset&#39;</span>:
<a name="l20347"></a>20347             <span class="keywordflow">case</span> <span class="stringliteral">&#39;solid&#39;</span>:
<a name="l20348"></a>20348             <span class="keywordflow">default</span>: {
<a name="l20349"></a>20349                 $dash = 0;
<a name="l20350"></a>20350                 <span class="keywordflow">break</span>;
<a name="l20351"></a>20351             }
<a name="l20352"></a>20352         }
<a name="l20353"></a>20353         <span class="keywordflow">return</span> $dash;
<a name="l20354"></a>20354     }
<a name="l20355"></a>20355 <span class="comment"></span>
<a name="l20356"></a>20356 <span class="comment">    /**</span>
<a name="l20357"></a>20357 <span class="comment">     * Returns the border style array from CSS border properties</span>
<a name="l20358"></a>20358 <span class="comment">     * @param $cssborder (string) border properties</span>
<a name="l20359"></a>20359 <span class="comment">     * @return array containing border properties</span>
<a name="l20360"></a>20360 <span class="comment">     * @protected</span>
<a name="l20361"></a>20361 <span class="comment">     * @since 5.7.000 (2010-08-02)</span>
<a name="l20362"></a>20362 <span class="comment">     */</span>
<a name="l20363"></a><a class="code" href="classTCPDF.html#a2e65a8cc55a9b4b9c9ac01e6513d64c7">20363</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2e65a8cc55a9b4b9c9ac01e6513d64c7" title="Returns the border style array from CSS border properties.">getCSSBorderStyle</a>($cssborder) {
<a name="l20364"></a>20364         $bprop = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($cssborder));
<a name="l20365"></a>20365         $border = array(); <span class="comment">// value to be returned</span>
<a name="l20366"></a>20366         <span class="keywordflow">switch</span> (count($bprop)) {
<a name="l20367"></a>20367             <span class="keywordflow">case</span> 3: {
<a name="l20368"></a>20368                 $width = $bprop[0];
<a name="l20369"></a>20369                 $style = $bprop[1];
<a name="l20370"></a>20370                 $color = $bprop[2];
<a name="l20371"></a>20371                 <span class="keywordflow">break</span>;
<a name="l20372"></a>20372             }
<a name="l20373"></a>20373             <span class="keywordflow">case</span> 2: {
<a name="l20374"></a>20374                 $width = <span class="stringliteral">&#39;medium&#39;</span>;
<a name="l20375"></a>20375                 $style = $bprop[0];
<a name="l20376"></a>20376                 $color = $bprop[1];
<a name="l20377"></a>20377                 <span class="keywordflow">break</span>;
<a name="l20378"></a>20378             }
<a name="l20379"></a>20379             <span class="keywordflow">case</span> 1: {
<a name="l20380"></a>20380                 $width = <span class="stringliteral">&#39;medium&#39;</span>;
<a name="l20381"></a>20381                 $style = $bprop[0];
<a name="l20382"></a>20382                 $color = <span class="stringliteral">&#39;black&#39;</span>;
<a name="l20383"></a>20383                 <span class="keywordflow">break</span>;
<a name="l20384"></a>20384             }
<a name="l20385"></a>20385             <span class="keywordflow">default</span>: {
<a name="l20386"></a>20386                 $width = <span class="stringliteral">&#39;medium&#39;</span>;
<a name="l20387"></a>20387                 $style = <span class="stringliteral">&#39;solid&#39;</span>;
<a name="l20388"></a>20388                 $color = <span class="stringliteral">&#39;black&#39;</span>;
<a name="l20389"></a>20389                 <span class="keywordflow">break</span>;
<a name="l20390"></a>20390             }
<a name="l20391"></a>20391         }
<a name="l20392"></a>20392         <span class="keywordflow">if</span> ($style == <span class="stringliteral">&#39;none&#39;</span>) {
<a name="l20393"></a>20393             <span class="keywordflow">return</span> array();
<a name="l20394"></a>20394         }
<a name="l20395"></a>20395         $border[<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;
<a name="l20396"></a>20396         $border[<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;
<a name="l20397"></a>20397         $border[<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;getCSSBorderDashStyle($style);
<a name="l20398"></a>20398         <span class="keywordflow">if</span> ($border[<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {
<a name="l20399"></a>20399             <span class="keywordflow">return</span> array();
<a name="l20400"></a>20400         }
<a name="l20401"></a>20401         $border[<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;getCSSBorderWidth($width);
<a name="l20402"></a>20402         $border[<span class="stringliteral">&#39;color&#39;</span>] = $this-&gt;convertHTMLColorToDec($color);
<a name="l20403"></a>20403         <span class="keywordflow">return</span> $border;
<a name="l20404"></a>20404     }
<a name="l20405"></a>20405 <span class="comment"></span>
<a name="l20406"></a>20406 <span class="comment">    /**</span>
<a name="l20407"></a>20407 <span class="comment">     * Get the internal Cell padding from CSS attribute.</span>
<a name="l20408"></a>20408 <span class="comment">     * @param $csspadding (string) padding properties</span>
<a name="l20409"></a>20409 <span class="comment">     * @param $width (float) width of the containing element</span>
<a name="l20410"></a>20410 <span class="comment">     * @return array of cell paddings</span>
<a name="l20411"></a>20411 <span class="comment">     * @public</span>
<a name="l20412"></a>20412 <span class="comment">     * @since 5.9.000 (2010-10-04)</span>
<a name="l20413"></a>20413 <span class="comment">     */</span>
<a name="l20414"></a><a class="code" href="classTCPDF.html#acd3d7dae873b9873302616698abafcf3">20414</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#acd3d7dae873b9873302616698abafcf3" title="Get the internal Cell padding from CSS attribute.">getCSSPadding</a>($csspadding, $width=0) {
<a name="l20415"></a>20415         $padding = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($csspadding));
<a name="l20416"></a>20416         $cell_padding = array(); <span class="comment">// value to be returned</span>
<a name="l20417"></a>20417         <span class="keywordflow">switch</span> (count($padding)) {
<a name="l20418"></a>20418             <span class="keywordflow">case</span> 4: {
<a name="l20419"></a>20419                 $cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $padding[0];
<a name="l20420"></a>20420                 $cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $padding[1];
<a name="l20421"></a>20421                 $cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $padding[2];
<a name="l20422"></a>20422                 $cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $padding[3];
<a name="l20423"></a>20423                 <span class="keywordflow">break</span>;
<a name="l20424"></a>20424             }
<a name="l20425"></a>20425             <span class="keywordflow">case</span> 3: {
<a name="l20426"></a>20426                 $cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $padding[0];
<a name="l20427"></a>20427                 $cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $padding[1];
<a name="l20428"></a>20428                 $cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $padding[2];
<a name="l20429"></a>20429                 $cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $padding[1];
<a name="l20430"></a>20430                 <span class="keywordflow">break</span>;
<a name="l20431"></a>20431             }
<a name="l20432"></a>20432             <span class="keywordflow">case</span> 2: {
<a name="l20433"></a>20433                 $cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $padding[0];
<a name="l20434"></a>20434                 $cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $padding[1];
<a name="l20435"></a>20435                 $cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $padding[0];
<a name="l20436"></a>20436                 $cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $padding[1];
<a name="l20437"></a>20437                 <span class="keywordflow">break</span>;
<a name="l20438"></a>20438             }
<a name="l20439"></a>20439             <span class="keywordflow">case</span> 1: {
<a name="l20440"></a>20440                 $cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $padding[0];
<a name="l20441"></a>20441                 $cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $padding[0];
<a name="l20442"></a>20442                 $cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $padding[0];
<a name="l20443"></a>20443                 $cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $padding[0];
<a name="l20444"></a>20444                 <span class="keywordflow">break</span>;
<a name="l20445"></a>20445             }
<a name="l20446"></a>20446             <span class="keywordflow">default</span>: {
<a name="l20447"></a>20447                 <span class="keywordflow">return</span> $this-&gt;cell_padding;
<a name="l20448"></a>20448             }
<a name="l20449"></a>20449         }
<a name="l20450"></a>20450         <span class="keywordflow">if</span> ($width == 0) {
<a name="l20451"></a>20451             $width = $this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin;
<a name="l20452"></a>20452         }
<a name="l20453"></a>20453         $cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $this-&gt;getHTMLUnitToUnits($cell_padding[<span class="charliteral">&#39;T&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20454"></a>20454         $cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $this-&gt;getHTMLUnitToUnits($cell_padding[<span class="charliteral">&#39;R&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20455"></a>20455         $cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $this-&gt;getHTMLUnitToUnits($cell_padding[<span class="charliteral">&#39;B&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20456"></a>20456         $cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $this-&gt;getHTMLUnitToUnits($cell_padding[<span class="charliteral">&#39;L&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20457"></a>20457         <span class="keywordflow">return</span> $cell_padding;
<a name="l20458"></a>20458     }
<a name="l20459"></a>20459 <span class="comment"></span>
<a name="l20460"></a>20460 <span class="comment">    /**</span>
<a name="l20461"></a>20461 <span class="comment">     * Get the internal Cell margin from CSS attribute.</span>
<a name="l20462"></a>20462 <span class="comment">     * @param $cssmargin (string) margin properties</span>
<a name="l20463"></a>20463 <span class="comment">     * @param $width (float) width of the containing element</span>
<a name="l20464"></a>20464 <span class="comment">     * @return array of cell margins</span>
<a name="l20465"></a>20465 <span class="comment">     * @public</span>
<a name="l20466"></a>20466 <span class="comment">     * @since 5.9.000 (2010-10-04)</span>
<a name="l20467"></a>20467 <span class="comment">     */</span>
<a name="l20468"></a><a class="code" href="classTCPDF.html#a5667689bccca7385dc41c64040e59121">20468</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5667689bccca7385dc41c64040e59121" title="Get the internal Cell margin from CSS attribute.">getCSSMargin</a>($cssmargin, $width=0) {
<a name="l20469"></a>20469         $margin = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($cssmargin));
<a name="l20470"></a>20470         $cell_margin = array(); <span class="comment">// value to be returned</span>
<a name="l20471"></a>20471         <span class="keywordflow">switch</span> (count($margin)) {
<a name="l20472"></a>20472             <span class="keywordflow">case</span> 4: {
<a name="l20473"></a>20473                 $cell_margin[<span class="charliteral">&#39;T&#39;</span>] = $margin[0];
<a name="l20474"></a>20474                 $cell_margin[<span class="charliteral">&#39;R&#39;</span>] = $margin[1];
<a name="l20475"></a>20475                 $cell_margin[<span class="charliteral">&#39;B&#39;</span>] = $margin[2];
<a name="l20476"></a>20476                 $cell_margin[<span class="charliteral">&#39;L&#39;</span>] = $margin[3];
<a name="l20477"></a>20477                 <span class="keywordflow">break</span>;
<a name="l20478"></a>20478             }
<a name="l20479"></a>20479             <span class="keywordflow">case</span> 3: {
<a name="l20480"></a>20480                 $cell_margin[<span class="charliteral">&#39;T&#39;</span>] = $margin[0];
<a name="l20481"></a>20481                 $cell_margin[<span class="charliteral">&#39;R&#39;</span>] = $margin[1];
<a name="l20482"></a>20482                 $cell_margin[<span class="charliteral">&#39;B&#39;</span>] = $margin[2];
<a name="l20483"></a>20483                 $cell_margin[<span class="charliteral">&#39;L&#39;</span>] = $margin[1];
<a name="l20484"></a>20484                 <span class="keywordflow">break</span>;
<a name="l20485"></a>20485             }
<a name="l20486"></a>20486             <span class="keywordflow">case</span> 2: {
<a name="l20487"></a>20487                 $cell_margin[<span class="charliteral">&#39;T&#39;</span>] = $margin[0];
<a name="l20488"></a>20488                 $cell_margin[<span class="charliteral">&#39;R&#39;</span>] = $margin[1];
<a name="l20489"></a>20489                 $cell_margin[<span class="charliteral">&#39;B&#39;</span>] = $margin[0];
<a name="l20490"></a>20490                 $cell_margin[<span class="charliteral">&#39;L&#39;</span>] = $margin[1];
<a name="l20491"></a>20491                 <span class="keywordflow">break</span>;
<a name="l20492"></a>20492             }
<a name="l20493"></a>20493             <span class="keywordflow">case</span> 1: {
<a name="l20494"></a>20494                 $cell_margin[<span class="charliteral">&#39;T&#39;</span>] = $margin[0];
<a name="l20495"></a>20495                 $cell_margin[<span class="charliteral">&#39;R&#39;</span>] = $margin[0];
<a name="l20496"></a>20496                 $cell_margin[<span class="charliteral">&#39;B&#39;</span>] = $margin[0];
<a name="l20497"></a>20497                 $cell_margin[<span class="charliteral">&#39;L&#39;</span>] = $margin[0];
<a name="l20498"></a>20498                 <span class="keywordflow">break</span>;
<a name="l20499"></a>20499             }
<a name="l20500"></a>20500             <span class="keywordflow">default</span>: {
<a name="l20501"></a>20501                 <span class="keywordflow">return</span> $this-&gt;cell_margin;
<a name="l20502"></a>20502             }
<a name="l20503"></a>20503         }
<a name="l20504"></a>20504         <span class="keywordflow">if</span> ($width == 0) {
<a name="l20505"></a>20505             $width = $this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin;
<a name="l20506"></a>20506         }
<a name="l20507"></a>20507         $cell_margin[<span class="charliteral">&#39;T&#39;</span>] = $this-&gt;getHTMLUnitToUnits(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, $cell_margin[<span class="charliteral">&#39;T&#39;</span>]), $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20508"></a>20508         $cell_margin[<span class="charliteral">&#39;R&#39;</span>] = $this-&gt;getHTMLUnitToUnits(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, $cell_margin[<span class="charliteral">&#39;R&#39;</span>]), $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20509"></a>20509         $cell_margin[<span class="charliteral">&#39;B&#39;</span>] = $this-&gt;getHTMLUnitToUnits(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, $cell_margin[<span class="charliteral">&#39;B&#39;</span>]), $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20510"></a>20510         $cell_margin[<span class="charliteral">&#39;L&#39;</span>] = $this-&gt;getHTMLUnitToUnits(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, $cell_margin[<span class="charliteral">&#39;L&#39;</span>]), $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20511"></a>20511         <span class="keywordflow">return</span> $cell_margin;
<a name="l20512"></a>20512     }
<a name="l20513"></a>20513 <span class="comment"></span>
<a name="l20514"></a>20514 <span class="comment">    /**</span>
<a name="l20515"></a>20515 <span class="comment">     * Get the border-spacing from CSS attribute.</span>
<a name="l20516"></a>20516 <span class="comment">     * @param $cssbspace (string) border-spacing CSS properties</span>
<a name="l20517"></a>20517 <span class="comment">     * @param $width (float) width of the containing element</span>
<a name="l20518"></a>20518 <span class="comment">     * @return array of border spacings</span>
<a name="l20519"></a>20519 <span class="comment">     * @public</span>
<a name="l20520"></a>20520 <span class="comment">     * @since 5.9.010 (2010-10-27)</span>
<a name="l20521"></a>20521 <span class="comment">     */</span>
<a name="l20522"></a><a class="code" href="classTCPDF.html#a7ec79640f33b5a1334632c2a893571b7">20522</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7ec79640f33b5a1334632c2a893571b7" title="Get the border-spacing from CSS attribute.">getCSSBorderMargin</a>($cssbspace, $width=0) {
<a name="l20523"></a>20523         $space = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($cssbspace));
<a name="l20524"></a>20524         $border_spacing = array(); <span class="comment">// value to be returned</span>
<a name="l20525"></a>20525         <span class="keywordflow">switch</span> (count($space)) {
<a name="l20526"></a>20526             <span class="keywordflow">case</span> 2: {
<a name="l20527"></a>20527                 $border_spacing[<span class="charliteral">&#39;H&#39;</span>] = $space[0];
<a name="l20528"></a>20528                 $border_spacing[<span class="charliteral">&#39;V&#39;</span>] = $space[1];
<a name="l20529"></a>20529                 <span class="keywordflow">break</span>;
<a name="l20530"></a>20530             }
<a name="l20531"></a>20531             <span class="keywordflow">case</span> 1: {
<a name="l20532"></a>20532                 $border_spacing[<span class="charliteral">&#39;H&#39;</span>] = $space[0];
<a name="l20533"></a>20533                 $border_spacing[<span class="charliteral">&#39;V&#39;</span>] = $space[0];
<a name="l20534"></a>20534                 <span class="keywordflow">break</span>;
<a name="l20535"></a>20535             }
<a name="l20536"></a>20536             <span class="keywordflow">default</span>: {
<a name="l20537"></a>20537                 <span class="keywordflow">return</span> array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0);
<a name="l20538"></a>20538             }
<a name="l20539"></a>20539         }
<a name="l20540"></a>20540         <span class="keywordflow">if</span> ($width == 0) {
<a name="l20541"></a>20541             $width = $this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin;
<a name="l20542"></a>20542         }
<a name="l20543"></a>20543         $border_spacing[<span class="charliteral">&#39;H&#39;</span>] = $this-&gt;getHTMLUnitToUnits($border_spacing[<span class="charliteral">&#39;H&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20544"></a>20544         $border_spacing[<span class="charliteral">&#39;V&#39;</span>] = $this-&gt;getHTMLUnitToUnits($border_spacing[<span class="charliteral">&#39;V&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20545"></a>20545         <span class="keywordflow">return</span> $border_spacing;
<a name="l20546"></a>20546     }
<a name="l20547"></a>20547 <span class="comment"></span>
<a name="l20548"></a>20548 <span class="comment">    /**</span>
<a name="l20549"></a>20549 <span class="comment">     * Returns the letter-spacing value from CSS value</span>
<a name="l20550"></a>20550 <span class="comment">     * @param $spacing (string) letter-spacing value</span>
<a name="l20551"></a>20551 <span class="comment">     * @param $parent (float) font spacing (tracking/kerning) value of the parent element</span>
<a name="l20552"></a>20552 <span class="comment">     * @return float quantity to increases or decreases the space between characters in a text.</span>
<a name="l20553"></a>20553 <span class="comment">     * @protected</span>
<a name="l20554"></a>20554 <span class="comment">     * @since 5.9.000 (2010-10-02)</span>
<a name="l20555"></a>20555 <span class="comment">     */</span>
<a name="l20556"></a><a class="code" href="classTCPDF.html#a4f4b2eb6bd3ea30b0cfa58a10396736b">20556</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4f4b2eb6bd3ea30b0cfa58a10396736b" title="Returns the letter-spacing value from CSS value.">getCSSFontSpacing</a>($spacing, $parent=0) {
<a name="l20557"></a>20557         $val = 0; <span class="comment">// value to be returned</span>
<a name="l20558"></a>20558         $spacing = trim($spacing);
<a name="l20559"></a>20559         <span class="keywordflow">switch</span> ($spacing) {
<a name="l20560"></a>20560             <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>: {
<a name="l20561"></a>20561                 $val = 0;
<a name="l20562"></a>20562                 <span class="keywordflow">break</span>;
<a name="l20563"></a>20563             }
<a name="l20564"></a>20564             <span class="keywordflow">case</span> <span class="stringliteral">&#39;inherit&#39;</span>: {
<a name="l20565"></a>20565                 <span class="keywordflow">if</span> ($parent == <span class="stringliteral">&#39;normal&#39;</span>) {
<a name="l20566"></a>20566                     $val = 0;
<a name="l20567"></a>20567                 } <span class="keywordflow">else</span> {
<a name="l20568"></a>20568                     $val = $parent;
<a name="l20569"></a>20569                 }
<a name="l20570"></a>20570                 <span class="keywordflow">break</span>;
<a name="l20571"></a>20571             }
<a name="l20572"></a>20572             <span class="keywordflow">default</span>: {
<a name="l20573"></a>20573                 $val = $this-&gt;getHTMLUnitToUnits($spacing, 0, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l20574"></a>20574             }
<a name="l20575"></a>20575         }
<a name="l20576"></a>20576         <span class="keywordflow">return</span> $val;
<a name="l20577"></a>20577     }
<a name="l20578"></a>20578 <span class="comment"></span>
<a name="l20579"></a>20579 <span class="comment">    /**</span>
<a name="l20580"></a>20580 <span class="comment">     * Returns the percentage of font stretching from CSS value</span>
<a name="l20581"></a>20581 <span class="comment">     * @param $stretch (string) stretch mode</span>
<a name="l20582"></a>20582 <span class="comment">     * @param $parent (float) stretch value of the parent element</span>
<a name="l20583"></a>20583 <span class="comment">     * @return float font stretching percentage</span>
<a name="l20584"></a>20584 <span class="comment">     * @protected</span>
<a name="l20585"></a>20585 <span class="comment">     * @since 5.9.000 (2010-10-02)</span>
<a name="l20586"></a>20586 <span class="comment">     */</span>
<a name="l20587"></a><a class="code" href="classTCPDF.html#a0d8075a3d1489875d600e7735c790929">20587</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0d8075a3d1489875d600e7735c790929" title="Returns the percentage of font stretching from CSS value.">getCSSFontStretching</a>($stretch, $parent=100) {
<a name="l20588"></a>20588         $val = 100; <span class="comment">// value to be returned</span>
<a name="l20589"></a>20589         $stretch = trim($stretch);
<a name="l20590"></a>20590         <span class="keywordflow">switch</span> ($stretch) {
<a name="l20591"></a>20591             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ultra-condensed&#39;</span>: {
<a name="l20592"></a>20592                 $val = 40;
<a name="l20593"></a>20593                 <span class="keywordflow">break</span>;
<a name="l20594"></a>20594             }
<a name="l20595"></a>20595             <span class="keywordflow">case</span> <span class="stringliteral">&#39;extra-condensed&#39;</span>: {
<a name="l20596"></a>20596                 $val = 55;
<a name="l20597"></a>20597                 <span class="keywordflow">break</span>;
<a name="l20598"></a>20598             }
<a name="l20599"></a>20599             <span class="keywordflow">case</span> <span class="stringliteral">&#39;condensed&#39;</span>: {
<a name="l20600"></a>20600                 $val = 70;
<a name="l20601"></a>20601                 <span class="keywordflow">break</span>;
<a name="l20602"></a>20602             }
<a name="l20603"></a>20603             <span class="keywordflow">case</span> <span class="stringliteral">&#39;semi-condensed&#39;</span>: {
<a name="l20604"></a>20604                 $val = 85;
<a name="l20605"></a>20605                 <span class="keywordflow">break</span>;
<a name="l20606"></a>20606             }
<a name="l20607"></a>20607             <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>: {
<a name="l20608"></a>20608                 $val = 100;
<a name="l20609"></a>20609                 <span class="keywordflow">break</span>;
<a name="l20610"></a>20610             }
<a name="l20611"></a>20611             <span class="keywordflow">case</span> <span class="stringliteral">&#39;semi-expanded&#39;</span>: {
<a name="l20612"></a>20612                 $val = 115;
<a name="l20613"></a>20613                 <span class="keywordflow">break</span>;
<a name="l20614"></a>20614             }
<a name="l20615"></a>20615             <span class="keywordflow">case</span> <span class="stringliteral">&#39;expanded&#39;</span>: {
<a name="l20616"></a>20616                 $val = 130;
<a name="l20617"></a>20617                 <span class="keywordflow">break</span>;
<a name="l20618"></a>20618             }
<a name="l20619"></a>20619             <span class="keywordflow">case</span> <span class="stringliteral">&#39;extra-expanded&#39;</span>: {
<a name="l20620"></a>20620                 $val = 145;
<a name="l20621"></a>20621                 <span class="keywordflow">break</span>;
<a name="l20622"></a>20622             }
<a name="l20623"></a>20623             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ultra-expanded&#39;</span>: {
<a name="l20624"></a>20624                 $val = 160;
<a name="l20625"></a>20625                 <span class="keywordflow">break</span>;
<a name="l20626"></a>20626             }
<a name="l20627"></a>20627             <span class="keywordflow">case</span> <span class="stringliteral">&#39;wider&#39;</span>: {
<a name="l20628"></a>20628                 $val = $parent + 10;
<a name="l20629"></a>20629                 <span class="keywordflow">break</span>;
<a name="l20630"></a>20630             }
<a name="l20631"></a>20631             <span class="keywordflow">case</span> <span class="stringliteral">&#39;narrower&#39;</span>: {
<a name="l20632"></a>20632                 $val = $parent - 10;
<a name="l20633"></a>20633                 <span class="keywordflow">break</span>;
<a name="l20634"></a>20634             }
<a name="l20635"></a>20635             <span class="keywordflow">case</span> <span class="stringliteral">&#39;inherit&#39;</span>: {
<a name="l20636"></a>20636                 <span class="keywordflow">if</span> ($parent == <span class="stringliteral">&#39;normal&#39;</span>) {
<a name="l20637"></a>20637                     $val = 100;
<a name="l20638"></a>20638                 } <span class="keywordflow">else</span> {
<a name="l20639"></a>20639                     $val = $parent;
<a name="l20640"></a>20640                 }
<a name="l20641"></a>20641                 <span class="keywordflow">break</span>;
<a name="l20642"></a>20642             }
<a name="l20643"></a>20643             <span class="keywordflow">default</span>: {
<a name="l20644"></a>20644                 $val = $this-&gt;getHTMLUnitToUnits($stretch, 100, <span class="charliteral">&#39;%&#39;</span>, <span class="keyword">false</span>);
<a name="l20645"></a>20645             }
<a name="l20646"></a>20646         }
<a name="l20647"></a>20647         <span class="keywordflow">return</span> $val;
<a name="l20648"></a>20648     }
<a name="l20649"></a>20649 <span class="comment"></span>
<a name="l20650"></a>20650 <span class="comment">    /**</span>
<a name="l20651"></a>20651 <span class="comment">     * Returns the HTML DOM array.</span>
<a name="l20652"></a>20652 <span class="comment">     * @param $html (string) html code</span>
<a name="l20653"></a>20653 <span class="comment">     * @return array</span>
<a name="l20654"></a>20654 <span class="comment">     * @protected</span>
<a name="l20655"></a>20655 <span class="comment">     * @since 3.2.000 (2008-06-20)</span>
<a name="l20656"></a>20656 <span class="comment">     */</span>
<a name="l20657"></a><a class="code" href="classTCPDF.html#a591ae03ca6c5202c19a36d3dccb1eb0a">20657</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a591ae03ca6c5202c19a36d3dccb1eb0a" title="Returns the HTML DOM array.">getHtmlDomArray</a>(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>) {
<a name="l20658"></a>20658         <span class="comment">// array of CSS styles ( selector =&gt; properties).</span>
<a name="l20659"></a>20659         $css = array();
<a name="l20660"></a>20660         <span class="comment">// get CSS array defined at previous call</span>
<a name="l20661"></a>20661         $matches = array();
<a name="l20662"></a>20662         <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/&lt;cssarray&gt;([^&lt;]*)&lt;\/cssarray&gt;/isU&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, $matches) &gt; 0) {
<a name="l20663"></a>20663             <span class="keywordflow">if</span> (isset($matches[1][0])) {
<a name="l20664"></a>20664                 $css = array_merge($css, unserialize($this-&gt;unhtmlentities($matches[1][0])));
<a name="l20665"></a>20665             }
<a name="l20666"></a>20666             <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;cssarray&gt;(.*?)&lt;\/cssarray&gt;/isU&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20667"></a>20667         }
<a name="l20668"></a>20668         <span class="comment">// extract external CSS files</span>
<a name="l20669"></a>20669         $matches = array();
<a name="l20670"></a>20670         <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/&lt;link([^&gt;]*)&gt;/isU&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, $matches) &gt; 0) {
<a name="l20671"></a>20671             <span class="keywordflow">foreach</span> ($matches[1] as $key =&gt; $link) {
<a name="l20672"></a>20672                 <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = array();
<a name="l20673"></a>20673                 <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/type[\s]*=[\s]*&quot;text\/css&quot;/&#39;</span>, $link, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>)) {
<a name="l20674"></a>20674                     <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = array();
<a name="l20675"></a>20675                     preg_match(<span class="stringliteral">&#39;/media[\s]*=[\s]*&quot;([^&quot;]*)&quot;/&#39;</span>, $link, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l20676"></a>20676                     <span class="comment">// get &#39;all&#39; and &#39;print&#39; media, other media types are discarded</span>
<a name="l20677"></a>20677                     <span class="comment">// (all, braille, embossed, handheld, print, projection, screen, speech, tty, tv)</span>
<a name="l20678"></a>20678                     <span class="keywordflow">if</span> (empty(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>) OR (isset(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>[1]) AND ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>[1] == <span class="stringliteral">&#39;all&#39;</span>) OR (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>[1] == <span class="stringliteral">&#39;print&#39;</span>)))) {
<a name="l20679"></a>20679                         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = array();
<a name="l20680"></a>20680                         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/href[\s]*=[\s]*&quot;([^&quot;]*)&quot;/&#39;</span>, $link, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>) &gt; 0) {
<a name="l20681"></a>20681                             <span class="comment">// read CSS data file</span>
<a name="l20682"></a>20682                             $cssdata = file_get_contents(trim(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>[1]));
<a name="l20683"></a>20683                             $css = array_merge($css, $this-&gt;extractCSSproperties($cssdata));
<a name="l20684"></a>20684                         }
<a name="l20685"></a>20685                     }
<a name="l20686"></a>20686                 }
<a name="l20687"></a>20687             }
<a name="l20688"></a>20688         }
<a name="l20689"></a>20689         <span class="comment">// extract style tags</span>
<a name="l20690"></a>20690         $matches = array();
<a name="l20691"></a>20691         <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/&lt;style([^&gt;]*)&gt;([^&lt;]*)&lt;\/style&gt;/isU&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, $matches) &gt; 0) {
<a name="l20692"></a>20692             <span class="keywordflow">foreach</span> ($matches[1] as $key =&gt; $media) {
<a name="l20693"></a>20693                 <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = array();
<a name="l20694"></a>20694                 preg_match(<span class="stringliteral">&#39;/media[\s]*=[\s]*&quot;([^&quot;]*)&quot;/&#39;</span>, $media, <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>);
<a name="l20695"></a>20695                 <span class="comment">// get &#39;all&#39; and &#39;print&#39; media, other media types are discarded</span>
<a name="l20696"></a>20696                 <span class="comment">// (all, braille, embossed, handheld, print, projection, screen, speech, tty, tv)</span>
<a name="l20697"></a>20697                 <span class="keywordflow">if</span> (empty(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>) OR (isset(<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>[1]) AND ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>[1] == <span class="stringliteral">&#39;all&#39;</span>) OR (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a>[1] == <span class="stringliteral">&#39;print&#39;</span>)))) {
<a name="l20698"></a>20698                     $cssdata = $matches[2][$key];
<a name="l20699"></a>20699                     $css = array_merge($css, $this-&gt;extractCSSproperties($cssdata));
<a name="l20700"></a>20700                 }
<a name="l20701"></a>20701             }
<a name="l20702"></a>20702         }
<a name="l20703"></a>20703         <span class="comment">// create a special tag to contain the CSS array (used for table content)</span>
<a name="l20704"></a>20704         $csstagarray = <span class="stringliteral">&#39;&lt;cssarray&gt;&#39;</span>.htmlentities(serialize($css)).<span class="stringliteral">&#39;&lt;/cssarray&gt;&#39;</span>;
<a name="l20705"></a>20705         <span class="comment">// remove head and style blocks</span>
<a name="l20706"></a>20706         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;head([^&gt;]*)&gt;(.*?)&lt;\/head&gt;/siU&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20707"></a>20707         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;style([^&gt;]*)&gt;([^&lt;]*)&lt;\/style&gt;/isU&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20708"></a>20708         <span class="comment">// define block tags</span>
<a name="l20709"></a>20709         $blocktags = array(<span class="stringliteral">&#39;blockquote&#39;</span>,<span class="stringliteral">&#39;br&#39;</span>,<span class="stringliteral">&#39;dd&#39;</span>,<span class="stringliteral">&#39;dl&#39;</span>,<span class="stringliteral">&#39;div&#39;</span>,<span class="stringliteral">&#39;dt&#39;</span>,<span class="stringliteral">&#39;h1&#39;</span>,<span class="stringliteral">&#39;h2&#39;</span>,<span class="stringliteral">&#39;h3&#39;</span>,<span class="stringliteral">&#39;h4&#39;</span>,<span class="stringliteral">&#39;h5&#39;</span>,<span class="stringliteral">&#39;h6&#39;</span>,<span class="stringliteral">&#39;hr&#39;</span>,<span class="stringliteral">&#39;li&#39;</span>,<span class="stringliteral">&#39;ol&#39;</span>,<span class="charliteral">&#39;p&#39;</span>,<span class="stringliteral">&#39;pre&#39;</span>,<span class="stringliteral">&#39;ul&#39;</span>,<span class="stringliteral">&#39;tcpdf&#39;</span>,<span class="stringliteral">&#39;table&#39;</span>,<span class="stringliteral">&#39;tr&#39;</span>,<span class="stringliteral">&#39;td&#39;</span>);
<a name="l20710"></a>20710         <span class="comment">// define self-closing tags</span>
<a name="l20711"></a>20711         $selfclosingtags = array(<span class="stringliteral">&#39;area&#39;</span>,<span class="stringliteral">&#39;base&#39;</span>,<span class="stringliteral">&#39;basefont&#39;</span>,<span class="stringliteral">&#39;br&#39;</span>,<span class="stringliteral">&#39;hr&#39;</span>,<span class="stringliteral">&#39;input&#39;</span>,<span class="stringliteral">&#39;img&#39;</span>,<span class="stringliteral">&#39;link&#39;</span>,<span class="stringliteral">&#39;meta&#39;</span>);
<a name="l20712"></a>20712         <span class="comment">// remove all unsupported tags (the line below lists all supported tags)</span>
<a name="l20713"></a>20713         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = strip_tags(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <span class="stringliteral">&#39;&lt;marker/&gt;&lt;a&gt;&lt;b&gt;&lt;blockquote&gt;&lt;body&gt;&lt;br&gt;&lt;br/&gt;&lt;dd&gt;&lt;del&gt;&lt;div&gt;&lt;dl&gt;&lt;dt&gt;&lt;em&gt;&lt;font&gt;&lt;form&gt;&lt;h1&gt;&lt;h2&gt;&lt;h3&gt;&lt;h4&gt;&lt;h5&gt;&lt;h6&gt;&lt;hr&gt;&lt;hr/&gt;&lt;i&gt;&lt;img&gt;&lt;input&gt;&lt;label&gt;&lt;li&gt;&lt;ol&gt;&lt;option&gt;&lt;p&gt;&lt;pre&gt;&lt;s&gt;&lt;select&gt;&lt;small&gt;&lt;span&gt;&lt;strike&gt;&lt;strong&gt;&lt;sub&gt;&lt;sup&gt;&lt;table&gt;&lt;tablehead&gt;&lt;tcpdf&gt;&lt;td&gt;&lt;textarea&gt;&lt;th&gt;&lt;thead&gt;&lt;tr&gt;&lt;tt&gt;&lt;u&gt;&lt;ul&gt;&#39;</span>);
<a name="l20714"></a>20714         <span class="comment">//replace some blank characters</span>
<a name="l20715"></a>20715         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;pre/&#39;</span>, <span class="stringliteral">&#39;&lt;xre&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>); <span class="comment">// preserve pre tag</span>
<a name="l20716"></a>20716         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;(table|tr|td|th|tcpdf|blockquote|dd|div|dl|dt|form|h1|h2|h3|h4|h5|h6|br|hr|li|ol|ul|p)([^&gt;]*)&gt;[\n\r\t]+/&#39;</span>, <span class="stringliteral">&#39;&lt;\\1\\2&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20717"></a>20717         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;@(\r\n|\r)@&#39;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20718"></a>20718         $repTable = array(<span class="stringliteral">&quot;\t&quot;</span> =&gt; <span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&quot;\0&quot;</span> =&gt; <span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&quot;\x0B&quot;</span> =&gt; <span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&quot;\\&quot;</span> =&gt; <span class="stringliteral">&quot;\\\\&quot;</span>);
<a name="l20719"></a>20719         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = strtr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, $repTable);
<a name="l20720"></a>20720         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0;
<a name="l20721"></a>20721         <span class="keywordflow">while</span> ((<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> &lt; strlen(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>)) AND (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <span class="stringliteral">&#39;&lt;/pre&gt;&#39;</span>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>)) !== <span class="keyword">false</span>) {
<a name="l20722"></a>20722             $html_a = substr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, 0, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l20723"></a>20723             $html_b = substr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> - <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> + 6));
<a name="l20724"></a>20724             <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;xre([^&gt;]*)&gt;(.*?)\n(.*?)&lt;/pre&gt;&#39;si&quot;</span>, $html_b)) {
<a name="l20725"></a>20725                 <span class="comment">// preserve newlines on &lt;pre&gt; tag</span>
<a name="l20726"></a>20726                 $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;xre([^&gt;]*)&gt;(.*?)\n(.*?)&lt;/pre&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;&lt;xre\\1&gt;\\2&lt;br /&gt;\\3&lt;/pre&gt;&quot;</span>, $html_b);
<a name="l20727"></a>20727             }
<a name="l20728"></a>20728             <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;xre([^&gt;]*)&gt;(.*?)&quot;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&quot;(.*?)&lt;/pre&gt;&#39;&quot;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $html_b)) {
<a name="l20729"></a>20729                 <span class="comment">// preserve spaces on &lt;pre&gt; tag</span>
<a name="l20730"></a>20730                 $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;xre([^&gt;]*)&gt;(.*?)&quot;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&quot;(.*?)&lt;/pre&gt;&#39;&quot;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], <span class="stringliteral">&quot;&lt;xre\\1&gt;\\2&amp;nbsp;\\3&lt;/pre&gt;&quot;</span>, $html_b);
<a name="l20731"></a>20731             }
<a name="l20732"></a>20732             <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = $html_a.$html_b.substr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + 6);
<a name="l20733"></a>20733             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = strlen($html_a.$html_b);
<a name="l20734"></a>20734         }
<a name="l20735"></a>20735         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0;
<a name="l20736"></a>20736         <span class="keywordflow">while</span> ((<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> &lt; strlen(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>)) AND (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <span class="stringliteral">&#39;&lt;/textarea&gt;&#39;</span>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>)) !== <span class="keyword">false</span>) {
<a name="l20737"></a>20737             $html_a = substr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, 0, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l20738"></a>20738             $html_b = substr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> - <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> + 11));
<a name="l20739"></a>20739             <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;textarea([^&gt;]*)&gt;(.*?)\n(.*?)&lt;/textarea&gt;&#39;si&quot;</span>, $html_b)) {
<a name="l20740"></a>20740                 <span class="comment">// preserve newlines on &lt;textarea&gt; tag</span>
<a name="l20741"></a>20741                 $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;textarea([^&gt;]*)&gt;(.*?)\n(.*?)&lt;/textarea&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;&lt;textarea\\1&gt;\\2&lt;TBR&gt;\\3&lt;/textarea&gt;&quot;</span>, $html_b);
<a name="l20742"></a>20742                 $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;textarea([^&gt;]*)&gt;(.*?)[\&quot;](.*?)&lt;/textarea&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;&lt;textarea\\1&gt;\\2&#39;&#39;\\3&lt;/textarea&gt;&quot;</span>, $html_b);
<a name="l20743"></a>20743             }
<a name="l20744"></a>20744             <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = $html_a.$html_b.substr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + 11);
<a name="l20745"></a>20745             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = strlen($html_a.$html_b);
<a name="l20746"></a>20746         }
<a name="l20747"></a>20747         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/([\s]*)&lt;option/si&#39;</span>, <span class="stringliteral">&#39;&lt;option&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20748"></a>20748         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;\/option&gt;([\s]*)/si&#39;</span>, <span class="stringliteral">&#39;&lt;/option&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20749"></a>20749         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0;
<a name="l20750"></a>20750         <span class="keywordflow">while</span> ((<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> &lt; strlen(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>)) AND (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <span class="stringliteral">&#39;&lt;/option&gt;&#39;</span>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>)) !== <span class="keyword">false</span>) {
<a name="l20751"></a>20751             $html_a = substr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, 0, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l20752"></a>20752             $html_b = substr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> - <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> + 9));
<a name="l20753"></a>20753             <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;option([^&gt;]*)&gt;(.*?)&lt;/option&gt;&#39;si&quot;</span>, $html_b)) {
<a name="l20754"></a>20754                 $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;option([\s]+)value=\&quot;([^\&quot;]*)\&quot;([^&gt;]*)&gt;(.*?)&lt;/option&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;\\2#!TaB!#\\4#!NwL!#&quot;</span>, $html_b);
<a name="l20755"></a>20755                 $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;option([^&gt;]*)&gt;(.*?)&lt;/option&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;\\2#!NwL!#&quot;</span>, $html_b);
<a name="l20756"></a>20756             }
<a name="l20757"></a>20757             <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = $html_a.$html_b.substr(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + 9);
<a name="l20758"></a>20758             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = strlen($html_a.$html_b);
<a name="l20759"></a>20759         }
<a name="l20760"></a>20760         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;/select&#39;si&quot;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>)) {
<a name="l20761"></a>20761             <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&quot;&#39;&lt;select([^&gt;]*)&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;&lt;select\\1 opt=\&quot;&quot;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20762"></a>20762             <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&quot;&#39;#!NwL!#&lt;/select&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;\&quot; /&gt;&quot;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20763"></a>20763         }
<a name="l20764"></a>20764         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="charliteral">&#39; &#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20765"></a>20765         <span class="comment">// restore textarea newlines</span>
<a name="l20766"></a>20766         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = str_replace(<span class="stringliteral">&#39;&lt;TBR&gt;&#39;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20767"></a>20767         <span class="comment">// remove extra spaces from code</span>
<a name="l20768"></a>20768         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/[\s]+&lt;\/(table|tr|ul|ol|dl)&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;/\\1&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20769"></a>20769         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+&lt;\/(td|th|li|dt|dd)&gt;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], <span class="stringliteral">&#39;&lt;/\\1&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20770"></a>20770         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/[\s]+&lt;(tr|td|th|li|dt|dd)/&#39;</span>, <span class="stringliteral">&#39;&lt;\\1&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20771"></a>20771         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+&lt;(ul|ol|dl|br)/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], <span class="stringliteral">&#39;&lt;\\1&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20772"></a>20772         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;\/(table|tr|td|th|blockquote|dd|dt|dl|div|dt|h1|h2|h3|h4|h5|h6|hr|li|ol|ul|p)&gt;[\s]+&lt;/&#39;</span>, <span class="stringliteral">&#39;&lt;/\\1&gt;&lt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20773"></a>20773         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;\/(td|th)&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;marker style=&quot;font-size:0&quot;/&gt;&lt;/\\1&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20774"></a>20774         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;\/table&gt;([\s]*)&lt;marker style=&quot;font-size:0&quot;\/&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;/table&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20775"></a>20775         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+&lt;img/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], chr(32).<span class="stringliteral">&#39;&lt;img&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20776"></a>20776         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;img([^&gt;]*)&gt;[\s]+([^&lt;])/xi&#39;</span>, <span class="stringliteral">&#39;&lt;img\\1&gt;&amp;nbsp;\\2&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20777"></a>20777         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;img([^&gt;]*)&gt;/xi&#39;</span>, <span class="stringliteral">&#39;&lt;img\\1&gt;&lt;span&gt;&lt;marker style=&quot;font-size:0&quot;/&gt;&lt;/span&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20778"></a>20778         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;xre/&#39;</span>, <span class="stringliteral">&#39;&lt;pre&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>); <span class="comment">// restore pre tag</span>
<a name="l20779"></a>20779         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;textarea([^&gt;]*)&gt;([^&lt;]*)&lt;\/textarea&gt;/xi&#39;</span>, <span class="stringliteral">&#39;&lt;textarea\\1 value=&quot;\\2&quot; /&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20780"></a>20780         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;li([^&gt;]*)&gt;&lt;\/li&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;li\\1&gt;&amp;nbsp;&lt;/li&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20781"></a>20781         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;li([^&gt;]*)&gt;&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;*&lt;img/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], <span class="stringliteral">&#39;&lt;li\\1&gt;&lt;font size=&quot;1&quot;&gt;&amp;nbsp;&lt;/font&gt;&lt;img&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20782"></a>20782         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/&lt;([^&gt;\/]*)&gt;[\s]/&#39;</span>, <span class="stringliteral">&#39;&lt;\\1&gt;&amp;nbsp;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>); <span class="comment">// preserve some spaces</span>
<a name="l20783"></a>20783         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/[\s]&lt;\/([^&gt;]*)&gt;/&#39;</span>, <span class="stringliteral">&#39;&amp;nbsp;&lt;/\\1&gt;&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>); <span class="comment">// preserve some spaces</span>
<a name="l20784"></a>20784         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], chr(32), <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>); <span class="comment">// replace multiple spaces with a single space</span>
<a name="l20785"></a>20785         <span class="comment">// trim string</span>
<a name="l20786"></a>20786         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = $this-&gt;stringTrim(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l20787"></a>20787         <span class="comment">// fix first image tag alignment</span>
<a name="l20788"></a>20788         <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a> = preg_replace(<span class="stringliteral">&#39;/^&lt;img/&#39;</span>, <span class="stringliteral">&#39;&lt;span style=&quot;font-size:0&quot;&gt;&lt;br /&gt;&lt;/span&gt; &lt;img&#39;</span>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, 1);
<a name="l20789"></a>20789         <span class="comment">// pattern for generic tag</span>
<a name="l20790"></a>20790         $tagpattern = <span class="stringliteral">&#39;/(&lt;[^&gt;]+&gt;)/&#39;</span>;
<a name="l20791"></a>20791         <span class="comment">// explodes the string</span>
<a name="l20792"></a>20792         $a = preg_split($tagpattern, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);
<a name="l20793"></a>20793         <span class="comment">// count elements</span>
<a name="l20794"></a>20794         $maxel = count($a);
<a name="l20795"></a>20795         $elkey = 0;
<a name="l20796"></a>20796         $key = 0;
<a name="l20797"></a>20797         <span class="comment">// create an array of elements</span>
<a name="l20798"></a>20798         $dom = array();
<a name="l20799"></a>20799         $dom[$key] = array();
<a name="l20800"></a>20800         <span class="comment">// set inheritable properties fot the first void element</span>
<a name="l20801"></a>20801         <span class="comment">// possible inheritable properties are: azimuth, border-collapse, border-spacing, caption-side, color, cursor, direction, empty-cells, font, font-family, font-stretch, font-size, font-size-adjust, font-style, font-variant, font-weight, letter-spacing, line-height, list-style, list-style-image, list-style-position, list-style-type, orphans, page, page-break-inside, quotes, speak, speak-header, text-align, text-indent, text-transform, volume, white-space, widows, word-spacing</span>
<a name="l20802"></a>20802         $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] = <span class="keyword">false</span>;
<a name="l20803"></a>20803         $dom[$key][<span class="stringliteral">&#39;block&#39;</span>] = <span class="keyword">false</span>;
<a name="l20804"></a>20804         $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l20805"></a>20805         $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] = 0;
<a name="l20806"></a>20806         $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = <span class="keyword">false</span>;
<a name="l20807"></a>20807         $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $this-&gt;FontFamily;
<a name="l20808"></a>20808         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = $this-&gt;FontStyle;
<a name="l20809"></a>20809         $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $this-&gt;FontSizePt;
<a name="l20810"></a>20810         $dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] = $this-&gt;font_stretching;
<a name="l20811"></a>20811         $dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] = $this-&gt;font_spacing;
<a name="l20812"></a>20812         $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] = $this-&gt;textstrokewidth;
<a name="l20813"></a>20813         $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = (($this-&gt;textrendermode % 2) == 0);
<a name="l20814"></a>20814         $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = ($this-&gt;textrendermode &gt; 3);
<a name="l20815"></a>20815         $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $this-&gt;cell_height_ratio;
<a name="l20816"></a>20816         $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = <span class="keyword">false</span>;
<a name="l20817"></a>20817         $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = $this-&gt;fgcolor; <span class="comment">// color</span>
<a name="l20818"></a>20818         $dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] = $this-&gt;strokecolor;
<a name="l20819"></a>20819         $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l20820"></a>20820         $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l20821"></a>20821         $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] = 0;
<a name="l20822"></a>20822         $dom[$key][<span class="stringliteral">&#39;border&#39;</span>] = array();
<a name="l20823"></a>20823         $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $this-&gt;rtl?<span class="stringliteral">&#39;rtl&#39;</span>:<span class="stringliteral">&#39;ltr&#39;</span>;
<a name="l20824"></a>20824         $thead = <span class="keyword">false</span>; <span class="comment">// true when we are inside the THEAD tag</span>
<a name="l20825"></a>20825         ++$key;
<a name="l20826"></a>20826         $level = array();
<a name="l20827"></a>20827         array_push($level, 0); <span class="comment">// root</span>
<a name="l20828"></a>20828         <span class="keywordflow">while</span> ($elkey &lt; $maxel) {
<a name="l20829"></a>20829             $dom[$key] = array();
<a name="l20830"></a>20830             $element = $a[$elkey];
<a name="l20831"></a>20831             $dom[$key][<span class="stringliteral">&#39;elkey&#39;</span>] = $elkey;
<a name="l20832"></a>20832             <span class="keywordflow">if</span> (preg_match($tagpattern, $element)) {
<a name="l20833"></a>20833                 <span class="comment">// html tag</span>
<a name="l20834"></a>20834                 $element = substr($element, 1, -1);
<a name="l20835"></a>20835                 <span class="comment">// get tag name</span>
<a name="l20836"></a>20836                 preg_match(<span class="stringliteral">&#39;/[\/]?([a-zA-Z0-9]*)/&#39;</span>, $element, $tag);
<a name="l20837"></a>20837                 $tagname = strtolower($tag[1]);
<a name="l20838"></a>20838                 <span class="comment">// check if we are inside a table header</span>
<a name="l20839"></a>20839                 <span class="keywordflow">if</span> ($tagname == <span class="stringliteral">&#39;thead&#39;</span>) {
<a name="l20840"></a>20840                     <span class="keywordflow">if</span> ($element{0} == <span class="charliteral">&#39;/&#39;</span>) {
<a name="l20841"></a>20841                         $thead = <span class="keyword">false</span>;
<a name="l20842"></a>20842                     } <span class="keywordflow">else</span> {
<a name="l20843"></a>20843                         $thead = <span class="keyword">true</span>;
<a name="l20844"></a>20844                     }
<a name="l20845"></a>20845                     ++$elkey;
<a name="l20846"></a>20846                     <span class="keywordflow">continue</span>;
<a name="l20847"></a>20847                 }
<a name="l20848"></a>20848                 $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] = <span class="keyword">true</span>;
<a name="l20849"></a>20849                 $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $tagname;
<a name="l20850"></a>20850                 <span class="keywordflow">if</span> (in_array($dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $blocktags)) {
<a name="l20851"></a>20851                     $dom[$key][<span class="stringliteral">&#39;block&#39;</span>] = <span class="keyword">true</span>;
<a name="l20852"></a>20852                 } <span class="keywordflow">else</span> {
<a name="l20853"></a>20853                     $dom[$key][<span class="stringliteral">&#39;block&#39;</span>] = <span class="keyword">false</span>;
<a name="l20854"></a>20854                 }
<a name="l20855"></a>20855                 <span class="keywordflow">if</span> ($element{0} == <span class="charliteral">&#39;/&#39;</span>) {
<a name="l20856"></a>20856                     <span class="comment">// *** closing html tag</span>
<a name="l20857"></a>20857                     $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] = <span class="keyword">false</span>;
<a name="l20858"></a>20858                     $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] = end($level);
<a name="l20859"></a>20859                     array_pop($level);
<a name="l20860"></a>20860                     $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;hide&#39;</span>];
<a name="l20861"></a>20861                     $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontname&#39;</span>];
<a name="l20862"></a>20862                     $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontstyle&#39;</span>];
<a name="l20863"></a>20863                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontsize&#39;</span>];
<a name="l20864"></a>20864                     $dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;font-stretch&#39;</span>];
<a name="l20865"></a>20865                     $dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;letter-spacing&#39;</span>];
<a name="l20866"></a>20866                     $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;stroke&#39;</span>];
<a name="l20867"></a>20867                     $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fill&#39;</span>];
<a name="l20868"></a>20868                     $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;clip&#39;</span>];
<a name="l20869"></a>20869                     $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;line-height&#39;</span>];
<a name="l20870"></a>20870                     $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;bgcolor&#39;</span>];
<a name="l20871"></a>20871                     $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fgcolor&#39;</span>];
<a name="l20872"></a>20872                     $dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;strokecolor&#39;</span>];
<a name="l20873"></a>20873                     $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;align&#39;</span>];
<a name="l20874"></a>20874                     $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;dir&#39;</span>];
<a name="l20875"></a>20875                     <span class="keywordflow">if</span> (isset($dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;listtype&#39;</span>])) {
<a name="l20876"></a>20876                         $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;listtype&#39;</span>];
<a name="l20877"></a>20877                     }
<a name="l20878"></a>20878                     <span class="comment">// set the number of columns in table tag</span>
<a name="l20879"></a>20879                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND (!isset($dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;cols&#39;</span>]))) {
<a name="l20880"></a>20880                         $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;cols&#39;</span>] = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;cols&#39;</span>];
<a name="l20881"></a>20881                     }
<a name="l20882"></a>20882                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;td&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;th&#39;</span>)) {
<a name="l20883"></a>20883                         $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] = $csstagarray;
<a name="l20884"></a>20884                         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = ($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] + 1); <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $key; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l20885"></a>20885                             $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] .= $a[$dom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;elkey&#39;</span>]];
<a name="l20886"></a>20886                         }
<a name="l20887"></a>20887                         $key = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l20888"></a>20888                         <span class="comment">// mark nested tables</span>
<a name="l20889"></a>20889                         $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] = str_replace(<span class="stringliteral">&#39;&lt;table&#39;</span>, <span class="stringliteral">&#39;&lt;table nested=&quot;true&quot;&#39;</span>, $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>]);
<a name="l20890"></a>20890                         <span class="comment">// remove thead sections from nested tables</span>
<a name="l20891"></a>20891                         $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] = str_replace(<span class="stringliteral">&#39;&lt;thead&gt;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>]);
<a name="l20892"></a>20892                         $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] = str_replace(<span class="stringliteral">&#39;&lt;/thead&gt;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>]);
<a name="l20893"></a>20893                     }
<a name="l20894"></a>20894                     <span class="comment">// store header rows on a new table</span>
<a name="l20895"></a>20895                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] === <span class="keyword">true</span>)) {
<a name="l20896"></a>20896                         <span class="keywordflow">if</span> ($this-&gt;empty_string($dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>])) {
<a name="l20897"></a>20897                             $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] = $csstagarray.$a[$dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;elkey&#39;</span>]];
<a name="l20898"></a>20898                         }
<a name="l20899"></a>20899                         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;= $key; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l20900"></a>20900                             $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] .= $a[$dom[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="stringliteral">&#39;elkey&#39;</span>]];
<a name="l20901"></a>20901                         }
<a name="l20902"></a>20902                         <span class="keywordflow">if</span> (!isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>])) {
<a name="l20903"></a>20903                             $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>] = array();
<a name="l20904"></a>20904                         }
<a name="l20905"></a>20905                         <span class="comment">// header elements must be always contained in a single page</span>
<a name="l20906"></a>20906                         $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l20907"></a>20907                     }
<a name="l20908"></a>20908                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>) AND (!$this-&gt;empty_string($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>]))) {
<a name="l20909"></a>20909                         <span class="comment">// remove the nobr attributes from the table header</span>
<a name="l20910"></a>20910                         $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] = str_replace(<span class="stringliteral">&#39; nobr=&quot;true&quot;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>]);
<a name="l20911"></a>20911                         $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] .= <span class="stringliteral">&#39;&lt;/tablehead&gt;&#39;</span>;
<a name="l20912"></a>20912                     }
<a name="l20913"></a>20913                 } <span class="keywordflow">else</span> {
<a name="l20914"></a>20914                     <span class="comment">// *** opening or self-closing html tag</span>
<a name="l20915"></a>20915                     $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] = <span class="keyword">true</span>;
<a name="l20916"></a>20916                     $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] = end($level);
<a name="l20917"></a>20917                     <span class="keywordflow">if</span> ((substr($element, -1, 1) == <span class="charliteral">&#39;/&#39;</span>) OR (in_array($dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $selfclosingtags))) {
<a name="l20918"></a>20918                         <span class="comment">// self-closing tag</span>
<a name="l20919"></a>20919                         $dom[$key][<span class="stringliteral">&#39;self&#39;</span>] = <span class="keyword">true</span>;
<a name="l20920"></a>20920                     } <span class="keywordflow">else</span> {
<a name="l20921"></a>20921                         <span class="comment">// opening tag</span>
<a name="l20922"></a>20922                         array_push($level, $key);
<a name="l20923"></a>20923                         $dom[$key][<span class="stringliteral">&#39;self&#39;</span>] = <span class="keyword">false</span>;
<a name="l20924"></a>20924                     }
<a name="l20925"></a>20925                     <span class="comment">// copy some values from parent</span>
<a name="l20926"></a>20926                     $parentkey = 0;
<a name="l20927"></a>20927                     <span class="keywordflow">if</span> ($key &gt; 0) {
<a name="l20928"></a>20928                         $parentkey = $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>];
<a name="l20929"></a>20929                         $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;hide&#39;</span>];
<a name="l20930"></a>20930                         $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fontname&#39;</span>];
<a name="l20931"></a>20931                         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fontstyle&#39;</span>];
<a name="l20932"></a>20932                         $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fontsize&#39;</span>];
<a name="l20933"></a>20933                         $dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;font-stretch&#39;</span>];
<a name="l20934"></a>20934                         $dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;letter-spacing&#39;</span>];
<a name="l20935"></a>20935                         $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;stroke&#39;</span>];
<a name="l20936"></a>20936                         $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fill&#39;</span>];
<a name="l20937"></a>20937                         $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;clip&#39;</span>];
<a name="l20938"></a>20938                         $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;line-height&#39;</span>];
<a name="l20939"></a>20939                         $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;bgcolor&#39;</span>];
<a name="l20940"></a>20940                         $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fgcolor&#39;</span>];
<a name="l20941"></a>20941                         $dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;strokecolor&#39;</span>];
<a name="l20942"></a>20942                         $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;align&#39;</span>];
<a name="l20943"></a>20943                         $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;listtype&#39;</span>];
<a name="l20944"></a>20944                         $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;text-indent&#39;</span>];
<a name="l20945"></a>20945                         $dom[$key][<span class="stringliteral">&#39;border&#39;</span>] = array();
<a name="l20946"></a>20946                         $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;dir&#39;</span>];
<a name="l20947"></a>20947                     }
<a name="l20948"></a>20948                     <span class="comment">// get attributes</span>
<a name="l20949"></a>20949                     preg_match_all(<span class="stringliteral">&#39;/([^=\s]*)[\s]*=[\s]*&quot;([^&quot;]*)&quot;/&#39;</span>, $element, $attr_array, PREG_PATTERN_ORDER);
<a name="l20950"></a>20950                     $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>] = array(); <span class="comment">// reset attribute array</span>
<a name="l20951"></a>20951                     <span class="keywordflow">while</span> (list(<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) = each($attr_array[1])) {
<a name="l20952"></a>20952                         $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][strtolower(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>)] = $attr_array[2][<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>];
<a name="l20953"></a>20953                     }
<a name="l20954"></a>20954                     <span class="keywordflow">if</span> (!empty($css)) {
<a name="l20955"></a>20955                         <span class="comment">// merge CSS style to current style</span>
<a name="l20956"></a>20956                         list($dom[$key][<span class="stringliteral">&#39;csssel&#39;</span>], $dom[$key][<span class="stringliteral">&#39;cssdata&#39;</span>]) = $this-&gt;getCSSdataArray($dom, $key, $css);
<a name="l20957"></a>20957                         $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>] = $this-&gt;getTagStyleFromCSSarray($dom[$key][<span class="stringliteral">&#39;cssdata&#39;</span>]);
<a name="l20958"></a>20958                     }
<a name="l20959"></a>20959                     <span class="comment">// split style attributes</span>
<a name="l20960"></a>20960                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>]) AND !empty($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>])) {
<a name="l20961"></a>20961                         <span class="comment">// get style attributes</span>
<a name="l20962"></a>20962                         preg_match_all(<span class="stringliteral">&#39;/([^;:\s]*):([^;]*)/&#39;</span>, $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>], $style_array, PREG_PATTERN_ORDER);
<a name="l20963"></a>20963                         $dom[$key][<span class="stringliteral">&#39;style&#39;</span>] = array(); <span class="comment">// reset style attribute array</span>
<a name="l20964"></a>20964                         <span class="keywordflow">while</span> (list(<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) = each($style_array[1])) {
<a name="l20965"></a>20965                             <span class="comment">// in case of duplicate attribute the last replace the previous</span>
<a name="l20966"></a>20966                             $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][strtolower(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>)] = trim($style_array[2][<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>]);
<a name="l20967"></a>20967                         }
<a name="l20968"></a>20968                         <span class="comment">// --- get some style attributes ---</span>
<a name="l20969"></a>20969                         <span class="comment">// text direction</span>
<a name="l20970"></a>20970                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;direction&#39;</span>])) {
<a name="l20971"></a>20971                             $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;direction&#39;</span>];
<a name="l20972"></a>20972                         }
<a name="l20973"></a>20973                         <span class="comment">// display</span>
<a name="l20974"></a>20974                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;display&#39;</span>])) {
<a name="l20975"></a>20975                             $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = (trim(strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;display&#39;</span>])) == <span class="stringliteral">&#39;none&#39;</span>);
<a name="l20976"></a>20976                         }
<a name="l20977"></a>20977                         <span class="comment">// font family</span>
<a name="l20978"></a>20978                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-family&#39;</span>])) {
<a name="l20979"></a>20979                             $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $this-&gt;getFontFamilyName($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-family&#39;</span>]);
<a name="l20980"></a>20980                         }
<a name="l20981"></a>20981                         <span class="comment">// list-style-type</span>
<a name="l20982"></a>20982                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;list-style-type&#39;</span>])) {
<a name="l20983"></a>20983                             $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = trim(strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;list-style-type&#39;</span>]));
<a name="l20984"></a>20984                             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] == <span class="stringliteral">&#39;inherit&#39;</span>) {
<a name="l20985"></a>20985                                 $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;listtype&#39;</span>];
<a name="l20986"></a>20986                             }
<a name="l20987"></a>20987                         }
<a name="l20988"></a>20988                         <span class="comment">// text-indent</span>
<a name="l20989"></a>20989                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-indent&#39;</span>])) {
<a name="l20990"></a>20990                             $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] = $this-&gt;getHTMLUnitToUnits($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-indent&#39;</span>]);
<a name="l20991"></a>20991                             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] == <span class="stringliteral">&#39;inherit&#39;</span>) {
<a name="l20992"></a>20992                                 $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;text-indent&#39;</span>];
<a name="l20993"></a>20993                             }
<a name="l20994"></a>20994                         }
<a name="l20995"></a>20995                         <span class="comment">// font size</span>
<a name="l20996"></a>20996                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-size&#39;</span>])) {
<a name="l20997"></a>20997                             $fsize = trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-size&#39;</span>]);
<a name="l20998"></a>20998                             <span class="keywordflow">switch</span> ($fsize) {
<a name="l20999"></a>20999                                 <span class="comment">// absolute-size</span>
<a name="l21000"></a>21000                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;xx-small&#39;</span>: {
<a name="l21001"></a>21001                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>] - 4;
<a name="l21002"></a>21002                                     <span class="keywordflow">break</span>;
<a name="l21003"></a>21003                                 }
<a name="l21004"></a>21004                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;x-small&#39;</span>: {
<a name="l21005"></a>21005                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>] - 3;
<a name="l21006"></a>21006                                     <span class="keywordflow">break</span>;
<a name="l21007"></a>21007                                 }
<a name="l21008"></a>21008                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;small&#39;</span>: {
<a name="l21009"></a>21009                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>] - 2;
<a name="l21010"></a>21010                                     <span class="keywordflow">break</span>;
<a name="l21011"></a>21011                                 }
<a name="l21012"></a>21012                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;medium&#39;</span>: {
<a name="l21013"></a>21013                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>];
<a name="l21014"></a>21014                                     <span class="keywordflow">break</span>;
<a name="l21015"></a>21015                                 }
<a name="l21016"></a>21016                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;large&#39;</span>: {
<a name="l21017"></a>21017                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>] + 2;
<a name="l21018"></a>21018                                     <span class="keywordflow">break</span>;
<a name="l21019"></a>21019                                 }
<a name="l21020"></a>21020                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;x-large&#39;</span>: {
<a name="l21021"></a>21021                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>] + 4;
<a name="l21022"></a>21022                                     <span class="keywordflow">break</span>;
<a name="l21023"></a>21023                                 }
<a name="l21024"></a>21024                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;xx-large&#39;</span>: {
<a name="l21025"></a>21025                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>] + 6;
<a name="l21026"></a>21026                                     <span class="keywordflow">break</span>;
<a name="l21027"></a>21027                                 }
<a name="l21028"></a>21028                                 <span class="comment">// relative-size</span>
<a name="l21029"></a>21029                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;smaller&#39;</span>: {
<a name="l21030"></a>21030                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fontsize&#39;</span>] - 3;
<a name="l21031"></a>21031                                     <span class="keywordflow">break</span>;
<a name="l21032"></a>21032                                 }
<a name="l21033"></a>21033                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;larger&#39;</span>: {
<a name="l21034"></a>21034                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fontsize&#39;</span>] + 3;
<a name="l21035"></a>21035                                     <span class="keywordflow">break</span>;
<a name="l21036"></a>21036                                 }
<a name="l21037"></a>21037                                 <span class="keywordflow">default</span>: {
<a name="l21038"></a>21038                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $this-&gt;getHTMLUnitToUnits($fsize, $dom[$parentkey][<span class="stringliteral">&#39;fontsize&#39;</span>], <span class="stringliteral">&#39;pt&#39;</span>, <span class="keyword">true</span>);
<a name="l21039"></a>21039                                 }
<a name="l21040"></a>21040                             }
<a name="l21041"></a>21041                         }
<a name="l21042"></a>21042                         <span class="comment">// font-stretch</span>
<a name="l21043"></a>21043                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-stretch&#39;</span>])) {
<a name="l21044"></a>21044                             $dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] = $this-&gt;getCSSFontStretching($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-stretch&#39;</span>], $dom[$parentkey][<span class="stringliteral">&#39;font-stretch&#39;</span>]);
<a name="l21045"></a>21045                         }
<a name="l21046"></a>21046                         <span class="comment">// letter-spacing</span>
<a name="l21047"></a>21047                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;letter-spacing&#39;</span>])) {
<a name="l21048"></a>21048                             $dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] = $this-&gt;getCSSFontSpacing($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;letter-spacing&#39;</span>], $dom[$parentkey][<span class="stringliteral">&#39;letter-spacing&#39;</span>]);
<a name="l21049"></a>21049                         }
<a name="l21050"></a>21050                         <span class="comment">// line-height</span>
<a name="l21051"></a>21051                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;line-height&#39;</span>])) {
<a name="l21052"></a>21052                             $lineheight = trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;line-height&#39;</span>]);
<a name="l21053"></a>21053                             <span class="keywordflow">switch</span> ($lineheight) {
<a name="l21054"></a>21054                                 <span class="comment">// A normal line height. This is default</span>
<a name="l21055"></a>21055                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>: {
<a name="l21056"></a>21056                                     $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $dom[0][<span class="stringliteral">&#39;line-height&#39;</span>];
<a name="l21057"></a>21057                                     <span class="keywordflow">break</span>;
<a name="l21058"></a>21058                                 }
<a name="l21059"></a>21059                                 <span class="keywordflow">default</span>: {
<a name="l21060"></a>21060                                     <span class="keywordflow">if</span> (is_numeric($lineheight)) {
<a name="l21061"></a>21061                                         $lineheight = $lineheight * 100;
<a name="l21062"></a>21062                                     }
<a name="l21063"></a>21063                                     $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $this-&gt;getHTMLUnitToUnits($lineheight, 1, <span class="charliteral">&#39;%&#39;</span>, <span class="keyword">true</span>);
<a name="l21064"></a>21064                                 }
<a name="l21065"></a>21065                             }
<a name="l21066"></a>21066                         }
<a name="l21067"></a>21067                         <span class="comment">// font style</span>
<a name="l21068"></a>21068                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-weight&#39;</span>])) {
<a name="l21069"></a>21069                             <span class="keywordflow">if</span> (strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-weight&#39;</span>]{0}) == <span class="charliteral">&#39;n&#39;</span>) {
<a name="l21070"></a>21070                                 <span class="keywordflow">if</span> (strpos($dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>], <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {
<a name="l21071"></a>21071                                     $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = str_replace(<span class="charliteral">&#39;B&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>]);
<a name="l21072"></a>21072                                 }
<a name="l21073"></a>21073                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-weight&#39;</span>]{0}) == <span class="charliteral">&#39;b&#39;</span>) {
<a name="l21074"></a>21074                                 $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;B&#39;</span>;
<a name="l21075"></a>21075                             }
<a name="l21076"></a>21076                         }
<a name="l21077"></a>21077                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-style&#39;</span>]) AND (strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-style&#39;</span>]{0}) == <span class="charliteral">&#39;i&#39;</span>)) {
<a name="l21078"></a>21078                             $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;I&#39;</span>;
<a name="l21079"></a>21079                         }
<a name="l21080"></a>21080                         <span class="comment">// font color</span>
<a name="l21081"></a>21081                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]) AND (!$this-&gt;empty_string($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]))) {
<a name="l21082"></a>21082                             $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = $this-&gt;convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]);
<a name="l21083"></a>21083                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;a&#39;</span>) {
<a name="l21084"></a>21084                             $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = $this-&gt;htmlLinkColorArray;
<a name="l21085"></a>21085                         }
<a name="l21086"></a>21086                         <span class="comment">// background color</span>
<a name="l21087"></a>21087                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;background-color&#39;</span>]) AND (!$this-&gt;empty_string($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;background-color&#39;</span>]))) {
<a name="l21088"></a>21088                             $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = $this-&gt;convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;background-color&#39;</span>]);
<a name="l21089"></a>21089                         }
<a name="l21090"></a>21090                         <span class="comment">// text-decoration</span>
<a name="l21091"></a>21091                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-decoration&#39;</span>])) {
<a name="l21092"></a>21092                             $decors = explode(<span class="charliteral">&#39; &#39;</span>, strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-decoration&#39;</span>]));
<a name="l21093"></a>21093                             <span class="keywordflow">foreach</span> ($decors as $dec) {
<a name="l21094"></a>21094                                 $dec = trim($dec);
<a name="l21095"></a>21095                                 <span class="keywordflow">if</span> (!$this-&gt;empty_string($dec)) {
<a name="l21096"></a>21096                                     <span class="keywordflow">if</span> ($dec{0} == <span class="charliteral">&#39;u&#39;</span>) {
<a name="l21097"></a>21097                                         <span class="comment">// underline</span>
<a name="l21098"></a>21098                                         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;U&#39;</span>;
<a name="l21099"></a>21099                                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dec{0} == <span class="charliteral">&#39;l&#39;</span>) {
<a name="l21100"></a>21100                                         <span class="comment">// line-trough</span>
<a name="l21101"></a>21101                                         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;D&#39;</span>;
<a name="l21102"></a>21102                                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dec{0} == <span class="charliteral">&#39;o&#39;</span>) {
<a name="l21103"></a>21103                                         <span class="comment">// overline</span>
<a name="l21104"></a>21104                                         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;O&#39;</span>;
<a name="l21105"></a>21105                                     }
<a name="l21106"></a>21106                                 }
<a name="l21107"></a>21107                             }
<a name="l21108"></a>21108                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;a&#39;</span>) {
<a name="l21109"></a>21109                             $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = $this-&gt;htmlLinkFontStyle;
<a name="l21110"></a>21110                         }
<a name="l21111"></a>21111                         <span class="comment">// check for width attribute</span>
<a name="l21112"></a>21112                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>])) {
<a name="l21113"></a>21113                             $dom[$key][<span class="stringliteral">&#39;width&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>];
<a name="l21114"></a>21114                         }
<a name="l21115"></a>21115                         <span class="comment">// check for height attribute</span>
<a name="l21116"></a>21116                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;height&#39;</span>])) {
<a name="l21117"></a>21117                             $dom[$key][<span class="stringliteral">&#39;height&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;height&#39;</span>];
<a name="l21118"></a>21118                         }
<a name="l21119"></a>21119                         <span class="comment">// check for text alignment</span>
<a name="l21120"></a>21120                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-align&#39;</span>])) {
<a name="l21121"></a>21121                             $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = strtoupper($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-align&#39;</span>]{0});
<a name="l21122"></a>21122                         }
<a name="l21123"></a>21123                         <span class="comment">// check for CSS border properties</span>
<a name="l21124"></a>21124                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>])) {
<a name="l21125"></a>21125                             $borderstyle = $this-&gt;getCSSBorderStyle($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>]);
<a name="l21126"></a>21126                             <span class="keywordflow">if</span> (!empty($borderstyle)) {
<a name="l21127"></a>21127                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="stringliteral">&#39;LTRB&#39;</span>] = $borderstyle;
<a name="l21128"></a>21128                             }
<a name="l21129"></a>21129                         }
<a name="l21130"></a>21130                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-color&#39;</span>])) {
<a name="l21131"></a>21131                             $brd_colors = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-color&#39;</span>]));
<a name="l21132"></a>21132                             <span class="keywordflow">if</span> (isset($brd_colors[3])) {
<a name="l21133"></a>21133                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>] = $this-&gt;convertHTMLColorToDec($brd_colors[3]);
<a name="l21134"></a>21134                             }
<a name="l21135"></a>21135                             <span class="keywordflow">if</span> (isset($brd_colors[1])) {
<a name="l21136"></a>21136                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>] = $this-&gt;convertHTMLColorToDec($brd_colors[1]);
<a name="l21137"></a>21137                             }
<a name="l21138"></a>21138                             <span class="keywordflow">if</span> (isset($brd_colors[0])) {
<a name="l21139"></a>21139                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>] = $this-&gt;convertHTMLColorToDec($brd_colors[0]);
<a name="l21140"></a>21140                             }
<a name="l21141"></a>21141                             <span class="keywordflow">if</span> (isset($brd_colors[2])) {
<a name="l21142"></a>21142                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>] = $this-&gt;convertHTMLColorToDec($brd_colors[2]);
<a name="l21143"></a>21143                             }
<a name="l21144"></a>21144                         }
<a name="l21145"></a>21145                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-width&#39;</span>])) {
<a name="l21146"></a>21146                             $brd_widths = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-width&#39;</span>]));
<a name="l21147"></a>21147                             <span class="keywordflow">if</span> (isset($brd_widths[3])) {
<a name="l21148"></a>21148                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;getCSSBorderWidth($brd_widths[3]);
<a name="l21149"></a>21149                             }
<a name="l21150"></a>21150                             <span class="keywordflow">if</span> (isset($brd_widths[1])) {
<a name="l21151"></a>21151                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;getCSSBorderWidth($brd_widths[1]);
<a name="l21152"></a>21152                             }
<a name="l21153"></a>21153                             <span class="keywordflow">if</span> (isset($brd_widths[0])) {
<a name="l21154"></a>21154                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;getCSSBorderWidth($brd_widths[0]);
<a name="l21155"></a>21155                             }
<a name="l21156"></a>21156                             <span class="keywordflow">if</span> (isset($brd_widths[2])) {
<a name="l21157"></a>21157                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;getCSSBorderWidth($brd_widths[2]);
<a name="l21158"></a>21158                             }
<a name="l21159"></a>21159                         }
<a name="l21160"></a>21160                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-style&#39;</span>])) {
<a name="l21161"></a>21161                             $brd_styles = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-style&#39;</span>]));
<a name="l21162"></a>21162                             <span class="keywordflow">if</span> (isset($brd_styles[3])) {
<a name="l21163"></a>21163                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;
<a name="l21164"></a>21164                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;
<a name="l21165"></a>21165                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;getCSSBorderDashStyle($brd_styles[3]);
<a name="l21166"></a>21166                                 <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {
<a name="l21167"></a>21167                                     $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>] = array();
<a name="l21168"></a>21168                                 }
<a name="l21169"></a>21169                             }
<a name="l21170"></a>21170                             <span class="keywordflow">if</span> (isset($brd_styles[1])) {
<a name="l21171"></a>21171                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;
<a name="l21172"></a>21172                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;
<a name="l21173"></a>21173                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;getCSSBorderDashStyle($brd_styles[1]);
<a name="l21174"></a>21174                                 <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {
<a name="l21175"></a>21175                                     $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>] = array();
<a name="l21176"></a>21176                                 }
<a name="l21177"></a>21177                             }
<a name="l21178"></a>21178                             <span class="keywordflow">if</span> (isset($brd_styles[0])) {
<a name="l21179"></a>21179                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;
<a name="l21180"></a>21180                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;
<a name="l21181"></a>21181                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;getCSSBorderDashStyle($brd_styles[0]);
<a name="l21182"></a>21182                                 <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {
<a name="l21183"></a>21183                                     $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>] = array();
<a name="l21184"></a>21184                                 }
<a name="l21185"></a>21185                             }
<a name="l21186"></a>21186                             <span class="keywordflow">if</span> (isset($brd_styles[2])) {
<a name="l21187"></a>21187                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;
<a name="l21188"></a>21188                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;
<a name="l21189"></a>21189                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;getCSSBorderDashStyle($brd_styles[2]);
<a name="l21190"></a>21190                                 <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {
<a name="l21191"></a>21191                                     $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>] = array();
<a name="l21192"></a>21192                                 }
<a name="l21193"></a>21193                             }
<a name="l21194"></a>21194                         }
<a name="l21195"></a>21195                         $cellside = array(<span class="charliteral">&#39;L&#39;</span> =&gt; <span class="stringliteral">&#39;left&#39;</span>, <span class="charliteral">&#39;R&#39;</span> =&gt; <span class="stringliteral">&#39;right&#39;</span>, <span class="charliteral">&#39;T&#39;</span> =&gt; <span class="stringliteral">&#39;top&#39;</span>, <span class="charliteral">&#39;B&#39;</span> =&gt; <span class="stringliteral">&#39;bottom&#39;</span>);
<a name="l21196"></a>21196                         <span class="keywordflow">foreach</span> ($cellside as $bsk =&gt; $bsv) {
<a name="l21197"></a>21197                             <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv])) {
<a name="l21198"></a>21198                                 $borderstyle = $this-&gt;getCSSBorderStyle($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv]);
<a name="l21199"></a>21199                                 <span class="keywordflow">if</span> (!empty($borderstyle)) {
<a name="l21200"></a>21200                                     $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk] = $borderstyle;
<a name="l21201"></a>21201                                 }
<a name="l21202"></a>21202                             }
<a name="l21203"></a>21203                             <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-color&#39;</span>])) {
<a name="l21204"></a>21204                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk][<span class="stringliteral">&#39;color&#39;</span>] = $this-&gt;convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-color&#39;</span>]);
<a name="l21205"></a>21205                             }
<a name="l21206"></a>21206                             <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-width&#39;</span>])) {
<a name="l21207"></a>21207                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;getCSSBorderWidth($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-width&#39;</span>]);
<a name="l21208"></a>21208                             }
<a name="l21209"></a>21209                             <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-style&#39;</span>])) {
<a name="l21210"></a>21210                                 $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;getCSSBorderDashStyle($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-style&#39;</span>]);
<a name="l21211"></a>21211                                 <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {
<a name="l21212"></a>21212                                     $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk] = array();
<a name="l21213"></a>21213                                 }
<a name="l21214"></a>21214                             }
<a name="l21215"></a>21215                         }
<a name="l21216"></a>21216                         <span class="comment">// check for CSS padding properties</span>
<a name="l21217"></a>21217                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;padding&#39;</span>])) {
<a name="l21218"></a>21218                             $dom[$key][<span class="stringliteral">&#39;padding&#39;</span>] = $this-&gt;getCSSPadding($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;padding&#39;</span>]);
<a name="l21219"></a>21219                         } <span class="keywordflow">else</span> {
<a name="l21220"></a>21220                             $dom[$key][<span class="stringliteral">&#39;padding&#39;</span>] = $this-&gt;cell_padding;
<a name="l21221"></a>21221                         }
<a name="l21222"></a>21222                         <span class="keywordflow">foreach</span> ($cellside as $psk =&gt; $psv) {
<a name="l21223"></a>21223                             <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;padding-&#39;</span>.$psv])) {
<a name="l21224"></a>21224                                 $dom[$key][<span class="stringliteral">&#39;padding&#39;</span>][$psk] = $this-&gt;getHTMLUnitToUnits($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;padding-&#39;</span>.$psv], 0, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l21225"></a>21225                             }
<a name="l21226"></a>21226                         }
<a name="l21227"></a>21227                         <span class="comment">// check for CSS margin properties</span>
<a name="l21228"></a>21228                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;margin&#39;</span>])) {
<a name="l21229"></a>21229                             $dom[$key][<span class="stringliteral">&#39;margin&#39;</span>] = $this-&gt;getCSSMargin($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;margin&#39;</span>]);
<a name="l21230"></a>21230                         } <span class="keywordflow">else</span> {
<a name="l21231"></a>21231                             $dom[$key][<span class="stringliteral">&#39;margin&#39;</span>] = $this-&gt;cell_margin;
<a name="l21232"></a>21232                         }
<a name="l21233"></a>21233                         <span class="keywordflow">foreach</span> ($cellside as $psk =&gt; $psv) {
<a name="l21234"></a>21234                             <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;margin-&#39;</span>.$psv])) {
<a name="l21235"></a>21235                                 $dom[$key][<span class="stringliteral">&#39;margin&#39;</span>][$psk] = $this-&gt;getHTMLUnitToUnits(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;margin-&#39;</span>.$psv]), 0, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l21236"></a>21236                             }
<a name="l21237"></a>21237                         }
<a name="l21238"></a>21238                         <span class="comment">// check for CSS border-spacing properties</span>
<a name="l21239"></a>21239                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-spacing&#39;</span>])) {
<a name="l21240"></a>21240                             $dom[$key][<span class="stringliteral">&#39;border-spacing&#39;</span>] = $this-&gt;getCSSBorderMargin($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-spacing&#39;</span>]);
<a name="l21241"></a>21241                         }
<a name="l21242"></a>21242                         <span class="comment">// page-break-inside</span>
<a name="l21243"></a>21243                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-inside&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-inside&#39;</span>] == <span class="stringliteral">&#39;avoid&#39;</span>)) {
<a name="l21244"></a>21244                             $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l21245"></a>21245                         }
<a name="l21246"></a>21246                         <span class="comment">// page-break-before</span>
<a name="l21247"></a>21247                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-before&#39;</span>])) {
<a name="l21248"></a>21248                             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-before&#39;</span>] == <span class="stringliteral">&#39;always&#39;</span>) {
<a name="l21249"></a>21249                                 $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l21250"></a>21250                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-before&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span>) {
<a name="l21251"></a>21251                                 $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l21252"></a>21252                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-before&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span>) {
<a name="l21253"></a>21253                                 $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l21254"></a>21254                             }
<a name="l21255"></a>21255                         }
<a name="l21256"></a>21256                         <span class="comment">// page-break-after</span>
<a name="l21257"></a>21257                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-after&#39;</span>])) {
<a name="l21258"></a>21258                             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-after&#39;</span>] == <span class="stringliteral">&#39;always&#39;</span>) {
<a name="l21259"></a>21259                                 $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l21260"></a>21260                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-after&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span>) {
<a name="l21261"></a>21261                                 $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>] = <span class="stringliteral">&#39;left&#39;</span>;
<a name="l21262"></a>21262                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-after&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span>) {
<a name="l21263"></a>21263                                 $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>] = <span class="stringliteral">&#39;right&#39;</span>;
<a name="l21264"></a>21264                             }
<a name="l21265"></a>21265                         }
<a name="l21266"></a>21266                     }
<a name="l21267"></a>21267                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;display&#39;</span>])) {
<a name="l21268"></a>21268                         $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = (trim(strtolower($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;display&#39;</span>])) == <span class="stringliteral">&#39;none&#39;</span>);
<a name="l21269"></a>21269                     }
<a name="l21270"></a>21270                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>] != 0)) {
<a name="l21271"></a>21271                         $borderstyle = $this-&gt;getCSSBorderStyle($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>].<span class="stringliteral">&#39; solid black&#39;</span>);
<a name="l21272"></a>21272                         <span class="keywordflow">if</span> (!empty($borderstyle)) {
<a name="l21273"></a>21273                             $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="stringliteral">&#39;LTRB&#39;</span>] = $borderstyle;
<a name="l21274"></a>21274                         }
<a name="l21275"></a>21275                     }
<a name="l21276"></a>21276                     <span class="comment">// check for font tag</span>
<a name="l21277"></a>21277                     <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;font&#39;</span>) {
<a name="l21278"></a>21278                         <span class="comment">// font family</span>
<a name="l21279"></a>21279                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;face&#39;</span>])) {
<a name="l21280"></a>21280                             $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $this-&gt;getFontFamilyName($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;face&#39;</span>]);
<a name="l21281"></a>21281                         }
<a name="l21282"></a>21282                         <span class="comment">// font size</span>
<a name="l21283"></a>21283                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>])) {
<a name="l21284"></a>21284                             <span class="keywordflow">if</span> ($key &gt; 0) {
<a name="l21285"></a>21285                                 <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]{0} == <span class="charliteral">&#39;+&#39;</span>) {
<a name="l21286"></a>21286                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontsize&#39;</span>] + intval(substr($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>], 1));
<a name="l21287"></a>21287                                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]{0} == <span class="charliteral">&#39;-&#39;</span>) {
<a name="l21288"></a>21288                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontsize&#39;</span>] - intval(substr($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>], 1));
<a name="l21289"></a>21289                                 } <span class="keywordflow">else</span> {
<a name="l21290"></a>21290                                     $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = intval($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]);
<a name="l21291"></a>21291                                 }
<a name="l21292"></a>21292                             } <span class="keywordflow">else</span> {
<a name="l21293"></a>21293                                 $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = intval($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]);
<a name="l21294"></a>21294                             }
<a name="l21295"></a>21295                         }
<a name="l21296"></a>21296                     }
<a name="l21297"></a>21297                     <span class="comment">// force natural alignment for lists</span>
<a name="l21298"></a>21298                     <span class="keywordflow">if</span> ((($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;ul&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;ol&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;dl&#39;</span>))
<a name="l21299"></a>21299                         AND (!isset($dom[$key][<span class="stringliteral">&#39;align&#39;</span>]) OR $this-&gt;empty_string($dom[$key][<span class="stringliteral">&#39;align&#39;</span>]) OR ($dom[$key][<span class="stringliteral">&#39;align&#39;</span>] != <span class="charliteral">&#39;J&#39;</span>))) {
<a name="l21300"></a>21300                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l21301"></a>21301                             $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = <span class="charliteral">&#39;R&#39;</span>;
<a name="l21302"></a>21302                         } <span class="keywordflow">else</span> {
<a name="l21303"></a>21303                             $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = <span class="charliteral">&#39;L&#39;</span>;
<a name="l21304"></a>21304                         }
<a name="l21305"></a>21305                     }
<a name="l21306"></a>21306                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;small&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;sup&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;sub&#39;</span>)) {
<a name="l21307"></a>21307                         <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]) AND !isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-size&#39;</span>])) {
<a name="l21308"></a>21308                             $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] * K_SMALL_RATIO;
<a name="l21309"></a>21309                         }
<a name="l21310"></a>21310                     }
<a name="l21311"></a>21311                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;strong&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;b&#39;</span>)) {
<a name="l21312"></a>21312                         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;B&#39;</span>;
<a name="l21313"></a>21313                     }
<a name="l21314"></a>21314                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;em&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;i&#39;</span>)) {
<a name="l21315"></a>21315                         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;I&#39;</span>;
<a name="l21316"></a>21316                     }
<a name="l21317"></a>21317                     <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;u&#39;</span>) {
<a name="l21318"></a>21318                         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;U&#39;</span>;
<a name="l21319"></a>21319                     }
<a name="l21320"></a>21320                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;del&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;s&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;strike&#39;</span>)) {
<a name="l21321"></a>21321                         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;D&#39;</span>;
<a name="l21322"></a>21322                     }
<a name="l21323"></a>21323                     <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-decoration&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;a&#39;</span>)) {
<a name="l21324"></a>21324                         $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = $this-&gt;htmlLinkFontStyle;
<a name="l21325"></a>21325                     }
<a name="l21326"></a>21326                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;pre&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tt&#39;</span>)) {
<a name="l21327"></a>21327                         $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $this-&gt;default_monospaced_font;
<a name="l21328"></a>21328                     }
<a name="l21329"></a>21329                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]{0} == <span class="charliteral">&#39;h&#39;</span>) AND (intval($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]{1}) &gt; 0) AND (intval($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]{1}) &lt; 7)) {
<a name="l21330"></a>21330                         <span class="comment">// headings h1, h2, h3, h4, h5, h6</span>
<a name="l21331"></a>21331                         <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]) AND !isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-size&#39;</span>])) {
<a name="l21332"></a>21332                             $headsize = (4 - intval($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]{1})) * 2;
<a name="l21333"></a>21333                             $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>] + $headsize;
<a name="l21334"></a>21334                         }
<a name="l21335"></a>21335                         <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-weight&#39;</span>])) {
<a name="l21336"></a>21336                             $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;B&#39;</span>;
<a name="l21337"></a>21337                         }
<a name="l21338"></a>21338                     }
<a name="l21339"></a>21339                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>)) {
<a name="l21340"></a>21340                         $dom[$key][<span class="stringliteral">&#39;rows&#39;</span>] = 0; <span class="comment">// number of rows</span>
<a name="l21341"></a>21341                         $dom[$key][<span class="stringliteral">&#39;trids&#39;</span>] = array(); <span class="comment">// IDs of TR elements</span>
<a name="l21342"></a>21342                         $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// table header rows</span>
<a name="l21343"></a>21343                     }
<a name="l21344"></a>21344                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>)) {
<a name="l21345"></a>21345                         $dom[$key][<span class="stringliteral">&#39;cols&#39;</span>] = 0;
<a name="l21346"></a>21346                         <span class="keywordflow">if</span> ($thead) {
<a name="l21347"></a>21347                             $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>] = <span class="keyword">true</span>;
<a name="l21348"></a>21348                             <span class="comment">// rows on thead block are printed as a separate table</span>
<a name="l21349"></a>21349                         } <span class="keywordflow">else</span> {
<a name="l21350"></a>21350                             $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>] = <span class="keyword">false</span>;
<a name="l21351"></a>21351                             <span class="comment">// store the number of rows on table element</span>
<a name="l21352"></a>21352                             ++$dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;rows&#39;</span>];
<a name="l21353"></a>21353                             <span class="comment">// store the TR elements IDs on table element</span>
<a name="l21354"></a>21354                             array_push($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;trids&#39;</span>], $key);
<a name="l21355"></a>21355                         }
<a name="l21356"></a>21356                     }
<a name="l21357"></a>21357                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;th&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;td&#39;</span>)) {
<a name="l21358"></a>21358                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;colspan&#39;</span>])) {
<a name="l21359"></a>21359                             $colspan = intval($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;colspan&#39;</span>]);
<a name="l21360"></a>21360                         } <span class="keywordflow">else</span> {
<a name="l21361"></a>21361                             $colspan = 1;
<a name="l21362"></a>21362                         }
<a name="l21363"></a>21363                         $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;colspan&#39;</span>] = $colspan;
<a name="l21364"></a>21364                         $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;cols&#39;</span>] += $colspan;
<a name="l21365"></a>21365                     }
<a name="l21366"></a>21366                     <span class="comment">// text direction</span>
<a name="l21367"></a>21367                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;dir&#39;</span>])) {
<a name="l21368"></a>21368                         $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;dir&#39;</span>];
<a name="l21369"></a>21369                     }
<a name="l21370"></a>21370                     <span class="comment">// set foreground color attribute</span>
<a name="l21371"></a>21371                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]) AND (!$this-&gt;empty_string($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]))) {
<a name="l21372"></a>21372                         $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = $this-&gt;convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]);
<a name="l21373"></a>21373                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (!isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;a&#39;</span>)) {
<a name="l21374"></a>21374                         $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = $this-&gt;htmlLinkColorArray;
<a name="l21375"></a>21375                     }
<a name="l21376"></a>21376                     <span class="comment">// set background color attribute</span>
<a name="l21377"></a>21377                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;bgcolor&#39;</span>]) AND (!$this-&gt;empty_string($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;bgcolor&#39;</span>]))) {
<a name="l21378"></a>21378                         $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = $this-&gt;convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;bgcolor&#39;</span>]);
<a name="l21379"></a>21379                     }
<a name="l21380"></a>21380                     <span class="comment">// set stroke color attribute</span>
<a name="l21381"></a>21381                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;strokecolor&#39;</span>]) AND (!$this-&gt;empty_string($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;strokecolor&#39;</span>]))) {
<a name="l21382"></a>21382                         $dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] = $this-&gt;convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;strokecolor&#39;</span>]);
<a name="l21383"></a>21383                     }
<a name="l21384"></a>21384                     <span class="comment">// check for width attribute</span>
<a name="l21385"></a>21385                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>])) {
<a name="l21386"></a>21386                         $dom[$key][<span class="stringliteral">&#39;width&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>];
<a name="l21387"></a>21387                     }
<a name="l21388"></a>21388                     <span class="comment">// check for height attribute</span>
<a name="l21389"></a>21389                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;height&#39;</span>])) {
<a name="l21390"></a>21390                         $dom[$key][<span class="stringliteral">&#39;height&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;height&#39;</span>];
<a name="l21391"></a>21391                     }
<a name="l21392"></a>21392                     <span class="comment">// check for text alignment</span>
<a name="l21393"></a>21393                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>]) AND (!$this-&gt;empty_string($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>])) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] !== <span class="stringliteral">&#39;img&#39;</span>)) {
<a name="l21394"></a>21394                         $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = strtoupper($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>]{0});
<a name="l21395"></a>21395                     }
<a name="l21396"></a>21396                     <span class="comment">// check for text rendering mode (the following attributes do not exist in HTML)</span>
<a name="l21397"></a>21397                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;stroke&#39;</span>])) {
<a name="l21398"></a>21398                         <span class="comment">// font stroke width</span>
<a name="l21399"></a>21399                         $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] = $this-&gt;getHTMLUnitToUnits($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;stroke&#39;</span>], $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>], <span class="stringliteral">&#39;pt&#39;</span>, <span class="keyword">true</span>);
<a name="l21400"></a>21400                     }
<a name="l21401"></a>21401                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;fill&#39;</span>])) {
<a name="l21402"></a>21402                         <span class="comment">// font fill</span>
<a name="l21403"></a>21403                         <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;fill&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>) {
<a name="l21404"></a>21404                             $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = <span class="keyword">true</span>;
<a name="l21405"></a>21405                         } <span class="keywordflow">else</span> {
<a name="l21406"></a>21406                             $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = <span class="keyword">false</span>;
<a name="l21407"></a>21407                         }
<a name="l21408"></a>21408                     }
<a name="l21409"></a>21409                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;clip&#39;</span>])) {
<a name="l21410"></a>21410                         <span class="comment">// clipping mode</span>
<a name="l21411"></a>21411                         <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;clip&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>) {
<a name="l21412"></a>21412                             $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = <span class="keyword">true</span>;
<a name="l21413"></a>21413                         } <span class="keywordflow">else</span> {
<a name="l21414"></a>21414                             $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = <span class="keyword">false</span>;
<a name="l21415"></a>21415                         }
<a name="l21416"></a>21416                     }
<a name="l21417"></a>21417                 } <span class="comment">// end opening tag</span>
<a name="l21418"></a>21418             } <span class="keywordflow">else</span> {
<a name="l21419"></a>21419                 <span class="comment">// text</span>
<a name="l21420"></a>21420                 $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] = <span class="keyword">false</span>;
<a name="l21421"></a>21421                 $dom[$key][<span class="stringliteral">&#39;block&#39;</span>] = <span class="keyword">false</span>;
<a name="l21422"></a>21422                 <span class="comment">//$element = str_replace(&#39;&amp;nbsp;&#39;, $this-&gt;unichr(160), $element);</span>
<a name="l21423"></a>21423                 $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = stripslashes($this-&gt;unhtmlentities($element));
<a name="l21424"></a>21424                 $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] = end($level);
<a name="l21425"></a>21425                 $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;dir&#39;</span>];
<a name="l21426"></a>21426             }
<a name="l21427"></a>21427             ++$elkey;
<a name="l21428"></a>21428             ++$key;
<a name="l21429"></a>21429         }
<a name="l21430"></a>21430         <span class="keywordflow">return</span> $dom;
<a name="l21431"></a>21431     }
<a name="l21432"></a>21432 <span class="comment"></span>
<a name="l21433"></a>21433 <span class="comment">    /**</span>
<a name="l21434"></a>21434 <span class="comment">     * Returns the string used to find spaces</span>
<a name="l21435"></a>21435 <span class="comment">     * @return string</span>
<a name="l21436"></a>21436 <span class="comment">     * @protected</span>
<a name="l21437"></a>21437 <span class="comment">     * @author Nicola Asuni</span>
<a name="l21438"></a>21438 <span class="comment">     * @since 4.8.024 (2010-01-15)</span>
<a name="l21439"></a>21439 <span class="comment">     */</span>
<a name="l21440"></a><a class="code" href="classTCPDF.html#a623785c4dc57739d845b36e810704a89">21440</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a623785c4dc57739d845b36e810704a89" title="Returns the string used to find spaces.">getSpaceString</a>() {
<a name="l21441"></a>21441         $spacestr = chr(32);
<a name="l21442"></a>21442         <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l21443"></a>21443             $spacestr = chr(0).chr(32);
<a name="l21444"></a>21444         }
<a name="l21445"></a>21445         <span class="keywordflow">return</span> $spacestr;
<a name="l21446"></a>21446     }
<a name="l21447"></a>21447 <span class="comment"></span>
<a name="l21448"></a>21448 <span class="comment">    /**</span>
<a name="l21449"></a>21449 <span class="comment">     * Prints a cell (rectangular area) with optional borders, background color and html text string.</span>
<a name="l21450"></a>21450 <span class="comment">     * The upper-left corner of the cell corresponds to the current position. After the call, the current position moves to the right or to the next line.&lt;br /&gt;</span>
<a name="l21451"></a>21451 <span class="comment">     * If automatic page breaking is enabled and the cell goes beyond the limit, a page break is done before outputting.</span>
<a name="l21452"></a>21452 <span class="comment">     * @param $w (float) Cell width. If 0, the cell extends up to the right margin.</span>
<a name="l21453"></a>21453 <span class="comment">     * @param $h (float) Cell minimum height. The cell extends automatically if needed.</span>
<a name="l21454"></a>21454 <span class="comment">     * @param $x (float) upper-left corner X coordinate</span>
<a name="l21455"></a>21455 <span class="comment">     * @param $y (float) upper-left corner Y coordinate</span>
<a name="l21456"></a>21456 <span class="comment">     * @param $html (string) html text to print. Default value: empty string.</span>
<a name="l21457"></a>21457 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l21458"></a>21458 <span class="comment">     * @param $ln (int) Indicates where the current position should go after the call. Possible values are:&lt;ul&gt;&lt;li&gt;0: to the right (or left for RTL language)&lt;/li&gt;&lt;li&gt;1: to the beginning of the next line&lt;/li&gt;&lt;li&gt;2: below&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l21459"></a>21459 <span class="comment">Putting 1 is equivalent to putting 0 and calling Ln() just after. Default value: 0.</span>
<a name="l21460"></a>21460 <span class="comment">     * @param $fill (boolean) Indicates if the cell background must be painted (true) or transparent (false).</span>
<a name="l21461"></a>21461 <span class="comment">     * @param $reseth (boolean) if true reset the last cell height (default true).</span>
<a name="l21462"></a>21462 <span class="comment">     * @param $align (string) Allows to center or align the text. Possible values are:&lt;ul&gt;&lt;li&gt;L : left align&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;R : right align&lt;/li&gt;&lt;li&gt;&#39;&#39; : empty string : left for LTR or right for RTL&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l21463"></a>21463 <span class="comment">     * @param $autopadding (boolean) if true, uses internal padding and automatically adjust it to account for line width.</span>
<a name="l21464"></a>21464 <span class="comment">     * @see Multicell(), writeHTML()</span>
<a name="l21465"></a>21465 <span class="comment">     * @public</span>
<a name="l21466"></a>21466 <span class="comment">     */</span>
<a name="l21467"></a><a class="code" href="classTCPDF.html#a8458280d15b73d3baffb28eebe2d9246">21467</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8458280d15b73d3baffb28eebe2d9246" title="Prints a cell (rectangular area) with optional borders, background color and html text string...">writeHTMLCell</a>(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>=<span class="stringliteral">&#39;&#39;</span>, $border=0, $ln=0, $fill=<span class="keyword">false</span>, $reseth=<span class="keyword">true</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $autopadding=<span class="keyword">true</span>) {
<a name="l21468"></a>21468         <span class="keywordflow">return</span> $this-&gt;MultiCell(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, $border, $align, $fill, $ln, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $reseth, 0, <span class="keyword">true</span>, $autopadding, 0, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>);
<a name="l21469"></a>21469     }
<a name="l21470"></a>21470 <span class="comment"></span>
<a name="l21471"></a>21471 <span class="comment">    /**</span>
<a name="l21472"></a>21472 <span class="comment">     * Allows to preserve some HTML formatting (limited support).&lt;br /&gt;</span>
<a name="l21473"></a>21473 <span class="comment">     * IMPORTANT: The HTML must be well formatted - try to clean-up it using an application like HTML-Tidy before submitting.</span>
<a name="l21474"></a>21474 <span class="comment">     * Supported tags are: a, b, blockquote, br, dd, del, div, dl, dt, em, font, h1, h2, h3, h4, h5, h6, hr, i, img, li, ol, p, pre, small, span, strong, sub, sup, table, tcpdf, td, th, thead, tr, tt, u, ul</span>
<a name="l21475"></a>21475 <span class="comment">     * @param $html (string) text to display</span>
<a name="l21476"></a>21476 <span class="comment">     * @param $ln (boolean) if true add a new line after text (default = true)</span>
<a name="l21477"></a>21477 <span class="comment">     * @param $fill (boolean) Indicates if the background must be painted (true) or transparent (false).</span>
<a name="l21478"></a>21478 <span class="comment">     * @param $reseth (boolean) if true reset the last cell height (default false).</span>
<a name="l21479"></a>21479 <span class="comment">     * @param $cell (boolean) if true add the current left (or right for RTL) padding to each Write (default false).</span>
<a name="l21480"></a>21480 <span class="comment">     * @param $align (string) Allows to center or align the text. Possible values are:&lt;ul&gt;&lt;li&gt;L : left align&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;R : right align&lt;/li&gt;&lt;li&gt;&#39;&#39; : empty string : left for LTR or right for RTL&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l21481"></a>21481 <span class="comment">     * @public</span>
<a name="l21482"></a>21482 <span class="comment">     */</span>
<a name="l21483"></a><a class="code" href="classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407">21483</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407" title="Allows to preserve some HTML formatting (limited support).">writeHTML</a>(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>, $ln=<span class="keyword">true</span>, $fill=<span class="keyword">false</span>, $reseth=<span class="keyword">false</span>, $cell=<span class="keyword">false</span>, $align=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l21484"></a>21484         $gvars = $this-&gt;getGraphicVars();
<a name="l21485"></a>21485         <span class="comment">// store current values</span>
<a name="l21486"></a>21486         $prev_cell_margin = $this-&gt;cell_margin;
<a name="l21487"></a>21487         $prev_cell_padding = $this-&gt;cell_padding;
<a name="l21488"></a>21488         $prevPage = $this-&gt;page;
<a name="l21489"></a>21489         $prevlMargin = $this-&gt;lMargin;
<a name="l21490"></a>21490         $prevrMargin = $this-&gt;rMargin;
<a name="l21491"></a>21491         $curfontname = $this-&gt;FontFamily;
<a name="l21492"></a>21492         $curfontstyle = $this-&gt;FontStyle;
<a name="l21493"></a>21493         $curfontsize = $this-&gt;FontSizePt;
<a name="l21494"></a>21494         $curfontascent = $this-&gt;getFontAscent($curfontname, $curfontstyle, $curfontsize);
<a name="l21495"></a>21495         $curfontdescent = $this-&gt;getFontDescent($curfontname, $curfontstyle, $curfontsize);
<a name="l21496"></a>21496         $curfontstretcing = $this-&gt;font_stretching;
<a name="l21497"></a>21497         $curfontkerning = $this-&gt;font_spacing;
<a name="l21498"></a>21498         $this-&gt;newline = <span class="keyword">true</span>;
<a name="l21499"></a>21499         $newline = <span class="keyword">true</span>;
<a name="l21500"></a>21500         $startlinepage = $this-&gt;page;
<a name="l21501"></a>21501         $minstartliney = $this-&gt;y;
<a name="l21502"></a>21502         $maxbottomliney = 0;
<a name="l21503"></a>21503         $startlinex = $this-&gt;x;
<a name="l21504"></a>21504         $startliney = $this-&gt;y;
<a name="l21505"></a>21505         $yshift = 0;
<a name="l21506"></a>21506         $loop = 0;
<a name="l21507"></a>21507         $curpos = 0;
<a name="l21508"></a>21508         $this_method_vars = array();
<a name="l21509"></a>21509         $undo = <span class="keyword">false</span>;
<a name="l21510"></a>21510         $fontaligned = <span class="keyword">false</span>;
<a name="l21511"></a>21511         $reverse_dir = <span class="keyword">false</span>; <span class="comment">// true when the text direction is reversed</span>
<a name="l21512"></a>21512         $this-&gt;premode = <span class="keyword">false</span>;
<a name="l21513"></a>21513         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l21514"></a>21514             <span class="comment">// we are inside an XObject template</span>
<a name="l21515"></a>21515             $pask = count($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>]);
<a name="l21516"></a>21516         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;PageAnnots[$this-&gt;page])) {
<a name="l21517"></a>21517             $pask = count($this-&gt;PageAnnots[$this-&gt;page]);
<a name="l21518"></a>21518         } <span class="keywordflow">else</span> {
<a name="l21519"></a>21519             $pask = 0;
<a name="l21520"></a>21520         }
<a name="l21521"></a>21521         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l21522"></a>21522             <span class="comment">// we are inside an XObject template</span>
<a name="l21523"></a>21523             $startlinepos = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);
<a name="l21524"></a>21524         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (!$this-&gt;InFooter) {
<a name="l21525"></a>21525             <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$this-&gt;page])) {
<a name="l21526"></a>21526                 $this-&gt;footerpos[$this-&gt;page] = $this-&gt;pagelen[$this-&gt;page] - $this-&gt;footerlen[$this-&gt;page];
<a name="l21527"></a>21527             } <span class="keywordflow">else</span> {
<a name="l21528"></a>21528                 $this-&gt;footerpos[$this-&gt;page] = $this-&gt;pagelen[$this-&gt;page];
<a name="l21529"></a>21529             }
<a name="l21530"></a>21530             $startlinepos = $this-&gt;footerpos[$this-&gt;page];
<a name="l21531"></a>21531         } <span class="keywordflow">else</span> {
<a name="l21532"></a>21532             <span class="comment">// we are inside the footer</span>
<a name="l21533"></a>21533             $startlinepos = $this-&gt;pagelen[$this-&gt;page];
<a name="l21534"></a>21534         }
<a name="l21535"></a>21535         $lalign = $align;
<a name="l21536"></a>21536         $plalign = $align;
<a name="l21537"></a>21537         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l21538"></a>21538             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;x - $this-&gt;lMargin;
<a name="l21539"></a>21539         } <span class="keywordflow">else</span> {
<a name="l21540"></a>21540             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;
<a name="l21541"></a>21541         }
<a name="l21542"></a>21542         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> -= ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]);
<a name="l21543"></a>21543         <span class="keywordflow">if</span> ($cell) {
<a name="l21544"></a>21544             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l21545"></a>21545                 $this-&gt;x -= $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l21546"></a>21546                 $this-&gt;lMargin += $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l21547"></a>21547             } <span class="keywordflow">else</span> {
<a name="l21548"></a>21548                 $this-&gt;x += $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];
<a name="l21549"></a>21549                 $this-&gt;rMargin += $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];
<a name="l21550"></a>21550             }
<a name="l21551"></a>21551         }
<a name="l21552"></a>21552         <span class="keywordflow">if</span> ($this-&gt;customlistindent &gt;= 0) {
<a name="l21553"></a>21553             $this-&gt;listindent = $this-&gt;customlistindent;
<a name="l21554"></a>21554         } <span class="keywordflow">else</span> {
<a name="l21555"></a>21555             $this-&gt;listindent = $this-&gt;GetStringWidth(<span class="stringliteral">&#39;000000&#39;</span>);
<a name="l21556"></a>21556         }
<a name="l21557"></a>21557         $this-&gt;listindentlevel = 0;
<a name="l21558"></a>21558         <span class="comment">// save previous states</span>
<a name="l21559"></a>21559         $prev_cell_height_ratio = $this-&gt;cell_height_ratio;
<a name="l21560"></a>21560         $prev_listnum = $this-&gt;listnum;
<a name="l21561"></a>21561         $prev_listordered = $this-&gt;listordered;
<a name="l21562"></a>21562         $prev_listcount = $this-&gt;listcount;
<a name="l21563"></a>21563         $prev_lispacer = $this-&gt;lispacer;
<a name="l21564"></a>21564         $this-&gt;listnum = 0;
<a name="l21565"></a>21565         $this-&gt;listordered = array();
<a name="l21566"></a>21566         $this-&gt;listcount = array();
<a name="l21567"></a>21567         $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;
<a name="l21568"></a>21568         <span class="keywordflow">if</span> (($this-&gt;empty_string($this-&gt;lasth)) OR ($reseth)) {
<a name="l21569"></a>21569             <span class="comment">// reset row height</span>
<a name="l21570"></a>21570             $this-&gt;resetLastH();
<a name="l21571"></a>21571         }
<a name="l21572"></a>21572         $dom = $this-&gt;getHtmlDomArray(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l21573"></a>21573         $maxel = count($dom);
<a name="l21574"></a>21574         $key = 0;
<a name="l21575"></a>21575         $hidden_node_key = -1;
<a name="l21576"></a>21576         <span class="keywordflow">while</span> ($key &lt; $maxel) {
<a name="l21577"></a>21577             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>]) {
<a name="l21578"></a>21578                 <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) {
<a name="l21579"></a>21579                     <span class="keywordflow">if</span> (($hidden_node_key &lt;= 0) AND $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>]) {
<a name="l21580"></a>21580                         <span class="comment">// store the node key</span>
<a name="l21581"></a>21581                         $hidden_node_key = $key;
<a name="l21582"></a>21582                     }
<a name="l21583"></a>21583                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($hidden_node_key &gt; 0) AND ($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] == $hidden_node_key)) {
<a name="l21584"></a>21584                     <span class="comment">// we have reached the closing tag of the hidden node</span>
<a name="l21585"></a>21585                     $hidden_node_key = 0;
<a name="l21586"></a>21586                 }
<a name="l21587"></a>21587             }
<a name="l21588"></a>21588             <span class="keywordflow">if</span> ($hidden_node_key &gt;= 0) {
<a name="l21589"></a>21589                 <span class="comment">// skip this node</span>
<a name="l21590"></a>21590                 ++$key;
<a name="l21591"></a>21591                 <span class="keywordflow">if</span> ($hidden_node_key == 0) {
<a name="l21592"></a>21592                     <span class="comment">// reset hidden mode</span>
<a name="l21593"></a>21593                     $hidden_node_key = -1;
<a name="l21594"></a>21594                 }
<a name="l21595"></a>21595                 <span class="keywordflow">continue</span>;
<a name="l21596"></a>21596             }
<a name="l21597"></a>21597             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>])) {
<a name="l21598"></a>21598                 <span class="comment">// check for pagebreak</span>
<a name="l21599"></a>21599                 <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span>)) {
<a name="l21600"></a>21600                     <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l21601"></a>21601                     $this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1);
<a name="l21602"></a>21602                     $this-&gt;htmlvspace = ($this-&gt;PageBreakTrigger + 1);
<a name="l21603"></a>21603                 }
<a name="l21604"></a>21604                 <span class="keywordflow">if</span> ((($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span>) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) == 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) != 0))))
<a name="l21605"></a>21605                     OR (($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span>) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) != 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) == 0))))) {
<a name="l21606"></a>21606                     <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l21607"></a>21607                     $this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1);
<a name="l21608"></a>21608                     $this-&gt;htmlvspace = ($this-&gt;PageBreakTrigger + 1);
<a name="l21609"></a>21609                 }
<a name="l21610"></a>21610             }
<a name="l21611"></a>21611             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l21612"></a>21612                 <span class="keywordflow">if</span> (isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>]) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l21613"></a>21613                     $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] = <span class="keyword">false</span>;
<a name="l21614"></a>21614                 } <span class="keywordflow">else</span> {
<a name="l21615"></a>21615                     <span class="comment">// store current object</span>
<a name="l21616"></a>21616                     $this-&gt;startTransaction();
<a name="l21617"></a>21617                     <span class="comment">// save this method vars</span>
<a name="l21618"></a>21618                     $this_method_vars[<span class="stringliteral">&#39;html&#39;</span>] = <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>;
<a name="l21619"></a>21619                     $this_method_vars[<span class="stringliteral">&#39;ln&#39;</span>] = $ln;
<a name="l21620"></a>21620                     $this_method_vars[<span class="stringliteral">&#39;fill&#39;</span>] = $fill;
<a name="l21621"></a>21621                     $this_method_vars[<span class="stringliteral">&#39;reseth&#39;</span>] = $reseth;
<a name="l21622"></a>21622                     $this_method_vars[<span class="stringliteral">&#39;cell&#39;</span>] = $cell;
<a name="l21623"></a>21623                     $this_method_vars[<span class="stringliteral">&#39;align&#39;</span>] = $align;
<a name="l21624"></a>21624                     $this_method_vars[<span class="stringliteral">&#39;gvars&#39;</span>] = $gvars;
<a name="l21625"></a>21625                     $this_method_vars[<span class="stringliteral">&#39;prevPage&#39;</span>] = $prevPage;
<a name="l21626"></a>21626                     $this_method_vars[<span class="stringliteral">&#39;prev_cell_margin&#39;</span>] = $prev_cell_margin;
<a name="l21627"></a>21627                     $this_method_vars[<span class="stringliteral">&#39;prev_cell_padding&#39;</span>] = $prev_cell_padding;
<a name="l21628"></a>21628                     $this_method_vars[<span class="stringliteral">&#39;prevlMargin&#39;</span>] = $prevlMargin;
<a name="l21629"></a>21629                     $this_method_vars[<span class="stringliteral">&#39;prevrMargin&#39;</span>] = $prevrMargin;
<a name="l21630"></a>21630                     $this_method_vars[<span class="stringliteral">&#39;curfontname&#39;</span>] = $curfontname;
<a name="l21631"></a>21631                     $this_method_vars[<span class="stringliteral">&#39;curfontstyle&#39;</span>] = $curfontstyle;
<a name="l21632"></a>21632                     $this_method_vars[<span class="stringliteral">&#39;curfontsize&#39;</span>] = $curfontsize;
<a name="l21633"></a>21633                     $this_method_vars[<span class="stringliteral">&#39;curfontascent&#39;</span>] = $curfontascent;
<a name="l21634"></a>21634                     $this_method_vars[<span class="stringliteral">&#39;curfontdescent&#39;</span>] = $curfontdescent;
<a name="l21635"></a>21635                     $this_method_vars[<span class="stringliteral">&#39;curfontstretcing&#39;</span>] = $curfontstretcing;
<a name="l21636"></a>21636                     $this_method_vars[<span class="stringliteral">&#39;curfontkerning&#39;</span>] = $curfontkerning;
<a name="l21637"></a>21637                     $this_method_vars[<span class="stringliteral">&#39;minstartliney&#39;</span>] = $minstartliney;
<a name="l21638"></a>21638                     $this_method_vars[<span class="stringliteral">&#39;maxbottomliney&#39;</span>] = $maxbottomliney;
<a name="l21639"></a>21639                     $this_method_vars[<span class="stringliteral">&#39;yshift&#39;</span>] = $yshift;
<a name="l21640"></a>21640                     $this_method_vars[<span class="stringliteral">&#39;startlinepage&#39;</span>] = $startlinepage;
<a name="l21641"></a>21641                     $this_method_vars[<span class="stringliteral">&#39;startlinepos&#39;</span>] = $startlinepos;
<a name="l21642"></a>21642                     $this_method_vars[<span class="stringliteral">&#39;startlinex&#39;</span>] = $startlinex;
<a name="l21643"></a>21643                     $this_method_vars[<span class="stringliteral">&#39;startliney&#39;</span>] = $startliney;
<a name="l21644"></a>21644                     $this_method_vars[<span class="stringliteral">&#39;newline&#39;</span>] = $newline;
<a name="l21645"></a>21645                     $this_method_vars[<span class="stringliteral">&#39;loop&#39;</span>] = $loop;
<a name="l21646"></a>21646                     $this_method_vars[<span class="stringliteral">&#39;curpos&#39;</span>] = $curpos;
<a name="l21647"></a>21647                     $this_method_vars[<span class="stringliteral">&#39;pask&#39;</span>] = $pask;
<a name="l21648"></a>21648                     $this_method_vars[<span class="stringliteral">&#39;lalign&#39;</span>] = $lalign;
<a name="l21649"></a>21649                     $this_method_vars[<span class="stringliteral">&#39;plalign&#39;</span>] = $plalign;
<a name="l21650"></a>21650                     $this_method_vars[<span class="charliteral">&#39;w&#39;</span>] = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l21651"></a>21651                     $this_method_vars[<span class="stringliteral">&#39;prev_cell_height_ratio&#39;</span>] = $prev_cell_height_ratio;
<a name="l21652"></a>21652                     $this_method_vars[<span class="stringliteral">&#39;prev_listnum&#39;</span>] = $prev_listnum;
<a name="l21653"></a>21653                     $this_method_vars[<span class="stringliteral">&#39;prev_listordered&#39;</span>] = $prev_listordered;
<a name="l21654"></a>21654                     $this_method_vars[<span class="stringliteral">&#39;prev_listcount&#39;</span>] = $prev_listcount;
<a name="l21655"></a>21655                     $this_method_vars[<span class="stringliteral">&#39;prev_lispacer&#39;</span>] = $prev_lispacer;
<a name="l21656"></a>21656                     $this_method_vars[<span class="stringliteral">&#39;fontaligned&#39;</span>] = $fontaligned;
<a name="l21657"></a>21657                     $this_method_vars[<span class="stringliteral">&#39;key&#39;</span>] = $key;
<a name="l21658"></a>21658                     $this_method_vars[<span class="stringliteral">&#39;dom&#39;</span>] = $dom;
<a name="l21659"></a>21659                 }
<a name="l21660"></a>21660             }
<a name="l21661"></a>21661             <span class="comment">// print THEAD block</span>
<a name="l21662"></a>21662             <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND isset($dom[$key][<span class="stringliteral">&#39;thead&#39;</span>]) AND $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>]) {
<a name="l21663"></a>21663                 <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]) AND isset($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;thead&#39;</span>]) AND !$this-&gt;empty_string($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;thead&#39;</span>])) {
<a name="l21664"></a>21664                     $this-&gt;inthead = <span class="keyword">true</span>;
<a name="l21665"></a>21665                     <span class="comment">// print table header (thead)</span>
<a name="l21666"></a>21666                     $this-&gt;writeHTML($this-&gt;thead, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l21667"></a>21667                     <span class="comment">// check if we are on a new page or on a new column</span>
<a name="l21668"></a>21668                     <span class="keywordflow">if</span> (($this-&gt;y &lt; $this-&gt;start_transaction_y) OR ($this-&gt;checkPageBreak($this-&gt;lasth, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>))) {
<a name="l21669"></a>21669                         <span class="comment">// we are on a new page or on a new column and the total object height is less than the available vertical space.</span>
<a name="l21670"></a>21670                         <span class="comment">// restore previous object</span>
<a name="l21671"></a>21671                         $this-&gt;rollbackTransaction(<span class="keyword">true</span>);
<a name="l21672"></a>21672                         <span class="comment">// restore previous values</span>
<a name="l21673"></a>21673                         <span class="keywordflow">foreach</span> ($this_method_vars as $vkey =&gt; $vval) {
<a name="l21674"></a>21674                             $$vkey = $vval;
<a name="l21675"></a>21675                         }
<a name="l21676"></a>21676                         <span class="comment">// disable table header</span>
<a name="l21677"></a>21677                         $tmp_thead = $this-&gt;thead;
<a name="l21678"></a>21678                         $this-&gt;thead = <span class="stringliteral">&#39;&#39;</span>;
<a name="l21679"></a>21679                         <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l21680"></a>21680                         $pre_y = $this-&gt;y;
<a name="l21681"></a>21681                         <span class="keywordflow">if</span> ((!$this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1)) AND ($this-&gt;y &lt; $pre_y)) {
<a name="l21682"></a>21682                             <span class="comment">// fix for multicolumn mode</span>
<a name="l21683"></a>21683                             $startliney = $this-&gt;y;
<a name="l21684"></a>21684                         }
<a name="l21685"></a>21685                         $this-&gt;start_transaction_page = $this-&gt;page;
<a name="l21686"></a>21686                         $this-&gt;start_transaction_y = $this-&gt;y;
<a name="l21687"></a>21687                         <span class="comment">// restore table header</span>
<a name="l21688"></a>21688                         $this-&gt;thead = $tmp_thead;
<a name="l21689"></a>21689                         <span class="comment">// fix table border properties</span>
<a name="l21690"></a>21690                         <span class="keywordflow">if</span> (isset($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {
<a name="l21691"></a>21691                             $tmp_cellspacing = $this-&gt;getHTMLUnitToUnits($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l21692"></a>21692                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;border-spacing&#39;</span>])) {
<a name="l21693"></a>21693                             $tmp_cellspacing = $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;border-spacing&#39;</span>][<span class="charliteral">&#39;V&#39;</span>];
<a name="l21694"></a>21694                         } <span class="keywordflow">else</span> {
<a name="l21695"></a>21695                             $tmp_cellspacing = 0;
<a name="l21696"></a>21696                         }
<a name="l21697"></a>21697                         $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;page&#39;</span>] = $this-&gt;page;
<a name="l21698"></a>21698                         $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>] = $this-&gt;current_column;
<a name="l21699"></a>21699                         $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;y&#39;</span>] = $this-&gt;y + $tmp_cellspacing;
<a name="l21700"></a>21700                         $xoffset = ($this-&gt;x - $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>]);
<a name="l21701"></a>21701                         $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>] += $xoffset;
<a name="l21702"></a>21702                         $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;xmax&#39;</span>] += $xoffset;
<a name="l21703"></a>21703                         <span class="comment">// print table header (thead)</span>
<a name="l21704"></a>21704                         $this-&gt;writeHTML($this-&gt;thead, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l21705"></a>21705                     }
<a name="l21706"></a>21706                 }
<a name="l21707"></a>21707                 <span class="comment">// move $key index forward to skip THEAD block</span>
<a name="l21708"></a>21708                 <span class="keywordflow">while</span> ( ($key &lt; $maxel) AND (!(
<a name="l21709"></a>21709                     ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND (!isset($dom[$key][<span class="stringliteral">&#39;thead&#39;</span>]) OR !$dom[$key][<span class="stringliteral">&#39;thead&#39;</span>]))
<a name="l21710"></a>21710                     OR ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND (!$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>))) )) {
<a name="l21711"></a>21711                     ++$key;
<a name="l21712"></a>21712                 }
<a name="l21713"></a>21713             }
<a name="l21714"></a>21714             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] OR ($key == 0)) {
<a name="l21715"></a>21715                 <span class="keywordflow">if</span> ((($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>)) AND (isset($dom[$key][<span class="stringliteral">&#39;align&#39;</span>]))) {
<a name="l21716"></a>21716                     $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = ($this-&gt;rtl) ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;L&#39;</span>;
<a name="l21717"></a>21717                 }
<a name="l21718"></a>21718                 <span class="comment">// vertically align image in line</span>
<a name="l21719"></a>21719                 <span class="keywordflow">if</span> ((!$this-&gt;newline) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;img&#39;</span>) AND (isset($dom[$key][<span class="stringliteral">&#39;height&#39;</span>])) AND ($dom[$key][<span class="stringliteral">&#39;height&#39;</span>] &gt; 0)) {
<a name="l21720"></a>21720                     <span class="comment">// get image height</span>
<a name="l21721"></a>21721                     $imgh = $this-&gt;getHTMLUnitToUnits($dom[$key][<span class="stringliteral">&#39;height&#39;</span>], $this-&gt;lasth, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l21722"></a>21722                     $autolinebreak = <span class="keyword">false</span>;
<a name="l21723"></a>21723                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;width&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;width&#39;</span>] &gt; 0)) {
<a name="l21724"></a>21724                         $imgw = $this-&gt;getHTMLUnitToUnits($dom[$key][<span class="stringliteral">&#39;width&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l21725"></a>21725                         <span class="keywordflow">if</span> (($imgw &lt;= ($this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]))
<a name="l21726"></a>21726                             AND ((($this-&gt;rtl) AND (($this-&gt;x - $imgw) &lt; ($this-&gt;lMargin + $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>])))
<a name="l21727"></a>21727                             OR ((!$this-&gt;rtl) AND (($this-&gt;x + $imgw) &gt; ($this-&gt;w - $this-&gt;rMargin - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]))))) {
<a name="l21728"></a>21728                             <span class="comment">// add automatic line break</span>
<a name="l21729"></a>21729                             $autolinebreak = <span class="keyword">true</span>;
<a name="l21730"></a>21730                             $this-&gt;Ln(<span class="stringliteral">&#39;&#39;</span>, $cell);
<a name="l21731"></a>21731                             <span class="keywordflow">if</span> ((!$dom[($key-1)][<span class="stringliteral">&#39;tag&#39;</span>]) AND ($dom[($key-1)][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39; &#39;</span>)) {
<a name="l21732"></a>21732                                 <span class="comment">// go back to evaluate this line break</span>
<a name="l21733"></a>21733                                 --$key;
<a name="l21734"></a>21734                             }
<a name="l21735"></a>21735                         }
<a name="l21736"></a>21736                     }
<a name="l21737"></a>21737                     <span class="keywordflow">if</span> (!$autolinebreak) {
<a name="l21738"></a>21738                         <span class="keywordflow">if</span> ($this-&gt;inPageBody()) {
<a name="l21739"></a>21739                             $pre_y = $this-&gt;y;
<a name="l21740"></a>21740                             <span class="comment">// check for page break</span>
<a name="l21741"></a>21741                             <span class="keywordflow">if</span> ((!$this-&gt;checkPageBreak($imgh)) AND ($this-&gt;y &lt; $pre_y)) {
<a name="l21742"></a>21742                                 <span class="comment">// fix for multicolumn mode</span>
<a name="l21743"></a>21743                                 $startliney = $this-&gt;y;
<a name="l21744"></a>21744                             }
<a name="l21745"></a>21745                         }
<a name="l21746"></a>21746                         <span class="keywordflow">if</span> ($this-&gt;page &gt; $startlinepage) {
<a name="l21747"></a>21747                             <span class="comment">// fix line splitted over two pages</span>
<a name="l21748"></a>21748                             <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$startlinepage])) {
<a name="l21749"></a>21749                                 $curpos = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];
<a name="l21750"></a>21750                             }
<a name="l21751"></a>21751                             <span class="comment">// line to be moved one page forward</span>
<a name="l21752"></a>21752                             $pagebuff = $this-&gt;getPageBuffer($startlinepage);
<a name="l21753"></a>21753                             $linebeg = substr($pagebuff, $startlinepos, ($curpos - $startlinepos));
<a name="l21754"></a>21754                             $tstart = substr($pagebuff, 0, $startlinepos);
<a name="l21755"></a>21755                             $tend = substr($this-&gt;getPageBuffer($startlinepage), $curpos);
<a name="l21756"></a>21756                             <span class="comment">// remove line from previous page</span>
<a name="l21757"></a>21757                             $this-&gt;setPageBuffer($startlinepage, $tstart.<span class="stringliteral">&#39;&#39;</span>.$tend);
<a name="l21758"></a>21758                             $pagebuff = $this-&gt;getPageBuffer($this-&gt;page);
<a name="l21759"></a>21759                             $tstart = substr($pagebuff, 0, $this-&gt;cntmrk[$this-&gt;page]);
<a name="l21760"></a>21760                             $tend = substr($pagebuff, $this-&gt;cntmrk[$this-&gt;page]);
<a name="l21761"></a>21761                             <span class="comment">// add line start to current page</span>
<a name="l21762"></a>21762                             $yshift = ($minstartliney - $this-&gt;y);
<a name="l21763"></a>21763                             <span class="keywordflow">if</span> ($fontaligned) {
<a name="l21764"></a>21764                                 $yshift += ($curfontsize / $this-&gt;k);
<a name="l21765"></a>21765                             }
<a name="l21766"></a>21766                             $try = sprintf(<span class="stringliteral">&#39;1 0 0 1 0 %.3F cm&#39;</span>, ($yshift * $this-&gt;k));
<a name="l21767"></a>21767                             $this-&gt;setPageBuffer($this-&gt;page, $tstart.<span class="stringliteral">&quot;\nq\n&quot;</span>.$try.<span class="stringliteral">&quot;\n&quot;</span>.$linebeg.<span class="stringliteral">&quot;\nQ\n&quot;</span>.$tend);
<a name="l21768"></a>21768                             <span class="comment">// shift the annotations and links</span>
<a name="l21769"></a>21769                             <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {
<a name="l21770"></a>21770                                 $next_pask = count($this-&gt;PageAnnots[$this-&gt;page]);
<a name="l21771"></a>21771                             } <span class="keywordflow">else</span> {
<a name="l21772"></a>21772                                 $next_pask = 0;
<a name="l21773"></a>21773                             }
<a name="l21774"></a>21774                             <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$startlinepage])) {
<a name="l21775"></a>21775                                 <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$startlinepage] as $pak =&gt; $pac) {
<a name="l21776"></a>21776                                     <span class="keywordflow">if</span> ($pak &gt;= $pask) {
<a name="l21777"></a>21777                                         $this-&gt;PageAnnots[$this-&gt;page][] = $pac;
<a name="l21778"></a>21778                                         unset($this-&gt;PageAnnots[$startlinepage][$pak]);
<a name="l21779"></a>21779                                         $npak = count($this-&gt;PageAnnots[$this-&gt;page]) - 1;
<a name="l21780"></a>21780                                         $this-&gt;PageAnnots[$this-&gt;page][$npak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;
<a name="l21781"></a>21781                                     }
<a name="l21782"></a>21782                                 }
<a name="l21783"></a>21783                             }
<a name="l21784"></a>21784                             $pask = $next_pask;
<a name="l21785"></a>21785                             $startlinepos = $this-&gt;cntmrk[$this-&gt;page];
<a name="l21786"></a>21786                             $startlinepage = $this-&gt;page;
<a name="l21787"></a>21787                             $startliney = $this-&gt;y;
<a name="l21788"></a>21788                             $this-&gt;newline = <span class="keyword">false</span>;
<a name="l21789"></a>21789                         }
<a name="l21790"></a>21790                         $this-&gt;y += ((($curfontsize * $this-&gt;cell_height_ratio / $this-&gt;k) + $curfontascent - $curfontdescent) / 2) - $imgh;
<a name="l21791"></a>21791                         $minstartliney = min($this-&gt;y, $minstartliney);
<a name="l21792"></a>21792                         $maxbottomliney = ($startliney + ($this-&gt;FontSize * $this-&gt;cell_height_ratio));
<a name="l21793"></a>21793                     }
<a name="l21794"></a>21794                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>]) OR isset($dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>]) OR isset($dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>]) OR isset($dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])) {
<a name="l21795"></a>21795                     <span class="comment">// account for different font size</span>
<a name="l21796"></a>21796                     $pfontname = $curfontname;
<a name="l21797"></a>21797                     $pfontstyle = $curfontstyle;
<a name="l21798"></a>21798                     $pfontsize = $curfontsize;
<a name="l21799"></a>21799                     $fontname = isset($dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] : $curfontname;
<a name="l21800"></a>21800                     $fontstyle = isset($dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] : $curfontstyle;
<a name="l21801"></a>21801                     <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> = isset($dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] : $curfontsize;
<a name="l21802"></a>21802                     $fontascent = $this-&gt;getFontAscent($fontname, $fontstyle, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>);
<a name="l21803"></a>21803                     $fontdescent = $this-&gt;getFontDescent($fontname, $fontstyle, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>);
<a name="l21804"></a>21804                     <span class="keywordflow">if</span> (($fontname != $curfontname) OR ($fontstyle != $curfontstyle) OR (<a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> != $curfontsize)
<a name="l21805"></a>21805                         OR ($this-&gt;cell_height_ratio != $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])
<a name="l21806"></a>21806                         OR ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;li&#39;</span>)) ) {
<a name="l21807"></a>21807                         <span class="keywordflow">if</span> (($key &lt; ($maxel - 1)) AND (
<a name="l21808"></a>21808                                 ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;li&#39;</span>))
<a name="l21809"></a>21809                                 OR ($this-&gt;cell_height_ratio != $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])
<a name="l21810"></a>21810                                 OR (!$this-&gt;newline AND is_numeric(<a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>) AND is_numeric($curfontsize) AND (<a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> &gt;= 0) AND ($curfontsize &gt;= 0) AND (<a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> != $curfontsize))
<a name="l21811"></a>21811                             )) {
<a name="l21812"></a>21812                             <span class="keywordflow">if</span> ($this-&gt;page &gt; $startlinepage) {
<a name="l21813"></a>21813                                 <span class="comment">// fix lines splitted over two pages</span>
<a name="l21814"></a>21814                                 <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$startlinepage])) {
<a name="l21815"></a>21815                                     $curpos = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];
<a name="l21816"></a>21816                                 }
<a name="l21817"></a>21817                                 <span class="comment">// line to be moved one page forward</span>
<a name="l21818"></a>21818                                 $pagebuff = $this-&gt;getPageBuffer($startlinepage);
<a name="l21819"></a>21819                                 $linebeg = substr($pagebuff, $startlinepos, ($curpos - $startlinepos));
<a name="l21820"></a>21820                                 $tstart = substr($pagebuff, 0, $startlinepos);
<a name="l21821"></a>21821                                 $tend = substr($this-&gt;getPageBuffer($startlinepage), $curpos);
<a name="l21822"></a>21822                                 <span class="comment">// remove line start from previous page</span>
<a name="l21823"></a>21823                                 $this-&gt;setPageBuffer($startlinepage, $tstart.<span class="stringliteral">&#39;&#39;</span>.$tend);
<a name="l21824"></a>21824                                 $pagebuff = $this-&gt;getPageBuffer($this-&gt;page);
<a name="l21825"></a>21825                                 $tstart = substr($pagebuff, 0, $this-&gt;cntmrk[$this-&gt;page]);
<a name="l21826"></a>21826                                 $tend = substr($pagebuff, $this-&gt;cntmrk[$this-&gt;page]);
<a name="l21827"></a>21827                                 <span class="comment">// add line start to current page</span>
<a name="l21828"></a>21828                                 $yshift = ($minstartliney - $this-&gt;y);
<a name="l21829"></a>21829                                 $try = sprintf(<span class="stringliteral">&#39;1 0 0 1 0 %.3F cm&#39;</span>, ($yshift * $this-&gt;k));
<a name="l21830"></a>21830                                 $this-&gt;setPageBuffer($this-&gt;page, $tstart.<span class="stringliteral">&quot;\nq\n&quot;</span>.$try.<span class="stringliteral">&quot;\n&quot;</span>.$linebeg.<span class="stringliteral">&quot;\nQ\n&quot;</span>.$tend);
<a name="l21831"></a>21831                                 <span class="comment">// shift the annotations and links</span>
<a name="l21832"></a>21832                                 <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {
<a name="l21833"></a>21833                                     $next_pask = count($this-&gt;PageAnnots[$this-&gt;page]);
<a name="l21834"></a>21834                                 } <span class="keywordflow">else</span> {
<a name="l21835"></a>21835                                     $next_pask = 0;
<a name="l21836"></a>21836                                 }
<a name="l21837"></a>21837                                 <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$startlinepage])) {
<a name="l21838"></a>21838                                     <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$startlinepage] as $pak =&gt; $pac) {
<a name="l21839"></a>21839                                         <span class="keywordflow">if</span> ($pak &gt;= $pask) {
<a name="l21840"></a>21840                                             $this-&gt;PageAnnots[$this-&gt;page][] = $pac;
<a name="l21841"></a>21841                                             unset($this-&gt;PageAnnots[$startlinepage][$pak]);
<a name="l21842"></a>21842                                             $npak = count($this-&gt;PageAnnots[$this-&gt;page]) - 1;
<a name="l21843"></a>21843                                             $this-&gt;PageAnnots[$this-&gt;page][$npak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;
<a name="l21844"></a>21844                                         }
<a name="l21845"></a>21845                                     }
<a name="l21846"></a>21846                                 }
<a name="l21847"></a>21847                                 $pask = $next_pask;
<a name="l21848"></a>21848                                 $startlinepos = $this-&gt;cntmrk[$this-&gt;page];
<a name="l21849"></a>21849                                 $startlinepage = $this-&gt;page;
<a name="l21850"></a>21850                                 $startliney = $this-&gt;y;
<a name="l21851"></a>21851                             }
<a name="l21852"></a>21852                             <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])) {
<a name="l21853"></a>21853                                 $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $this-&gt;cell_height_ratio;
<a name="l21854"></a>21854                             }
<a name="l21855"></a>21855                             <span class="keywordflow">if</span> (!$dom[$key][<span class="stringliteral">&#39;block&#39;</span>]) {
<a name="l21856"></a>21856                                 <span class="keywordflow">if</span> (!(isset($dom[($key + 1)]) AND $dom[($key + 1)][<span class="stringliteral">&#39;tag&#39;</span>] AND (!$dom[($key + 1)][<span class="stringliteral">&#39;opening&#39;</span>]) AND ($dom[($key + 1)][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;li&#39;</span>) AND $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND (!$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]))) {
<a name="l21857"></a>21857                                     $this-&gt;y += (((($curfontsize * $this-&gt;cell_height_ratio) - (<a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> * $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])) / $this-&gt;k) + $curfontascent - $fontascent - $curfontdescent + $fontdescent) / 2;
<a name="l21858"></a>21858                                 }
<a name="l21859"></a>21859                                 <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;sup&#39;</span>) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;sub&#39;</span>)) {
<a name="l21860"></a>21860                                     $current_line_align_data = array($key, $minstartliney, $maxbottomliney);
<a name="l21861"></a>21861                                     <span class="keywordflow">if</span> (isset($line_align_data) AND (($line_align_data[0] == ($key - 1)) OR (($line_align_data[0] == ($key - 2)) AND (isset($dom[($key - 1)])) AND (preg_match(<span class="stringliteral">&#39;/^([\s]+)$/&#39;</span>, $dom[($key - 1)][<span class="stringliteral">&#39;value&#39;</span>]) &gt; 0)))) {
<a name="l21862"></a>21862                                         $minstartliney = min($this-&gt;y, $line_align_data[1]);
<a name="l21863"></a>21863                                         $maxbottomliney = max(($this-&gt;y + ((<a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> * $this-&gt;cell_height_ratio) / $this-&gt;k)), $line_align_data[2]);
<a name="l21864"></a>21864                                     } <span class="keywordflow">else</span> {
<a name="l21865"></a>21865                                         $minstartliney = min($this-&gt;y, $minstartliney);
<a name="l21866"></a>21866                                         $maxbottomliney = max(($this-&gt;y + ((<a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> * $this-&gt;cell_height_ratio) / $this-&gt;k)), $maxbottomliney);
<a name="l21867"></a>21867                                     }
<a name="l21868"></a>21868                                     $line_align_data = $current_line_align_data;
<a name="l21869"></a>21869                                 }
<a name="l21870"></a>21870                             }
<a name="l21871"></a>21871                             $this-&gt;cell_height_ratio = $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>];
<a name="l21872"></a>21872                             $fontaligned = <span class="keyword">true</span>;
<a name="l21873"></a>21873                         }
<a name="l21874"></a>21874                         $this-&gt;SetFont($fontname, $fontstyle, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>);
<a name="l21875"></a>21875                         <span class="comment">// reset row height</span>
<a name="l21876"></a>21876                         $this-&gt;resetLastH();
<a name="l21877"></a>21877                         $curfontname = $fontname;
<a name="l21878"></a>21878                         $curfontstyle = $fontstyle;
<a name="l21879"></a>21879                         $curfontsize = <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>;
<a name="l21880"></a>21880                         $curfontascent = $fontascent;
<a name="l21881"></a>21881                         $curfontdescent = $fontdescent;
<a name="l21882"></a>21882                     }
<a name="l21883"></a>21883                 }
<a name="l21884"></a>21884                 <span class="comment">// set text rendering mode</span>
<a name="l21885"></a>21885                 $textstroke = isset($dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] : $this-&gt;textstrokewidth;
<a name="l21886"></a>21886                 $textfill = isset($dom[$key][<span class="stringliteral">&#39;fill&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] : (($this-&gt;textrendermode % 2) == 0);
<a name="l21887"></a>21887                 $textclip = isset($dom[$key][<span class="stringliteral">&#39;clip&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] : ($this-&gt;textrendermode &gt; 3);
<a name="l21888"></a>21888                 $this-&gt;setTextRenderingMode($textstroke, $textfill, $textclip);
<a name="l21889"></a>21889                 <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l21890"></a>21890                     $this-&gt;setFontStretching($dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>]);
<a name="l21891"></a>21891                 }
<a name="l21892"></a>21892                 <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l21893"></a>21893                     $this-&gt;setFontSpacing($dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>]);
<a name="l21894"></a>21894                 }
<a name="l21895"></a>21895                 <span class="keywordflow">if</span> (($plalign == <span class="charliteral">&#39;J&#39;</span>) AND $dom[$key][<span class="stringliteral">&#39;block&#39;</span>]) {
<a name="l21896"></a>21896                     $plalign = <span class="stringliteral">&#39;&#39;</span>;
<a name="l21897"></a>21897                 }
<a name="l21898"></a>21898                 <span class="comment">// get current position on page buffer</span>
<a name="l21899"></a>21899                 $curpos = $this-&gt;pagelen[$startlinepage];
<a name="l21900"></a>21900                 <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l21901"></a>21901                     $this-&gt;SetFillColorArray($dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>]);
<a name="l21902"></a>21902                     $wfill = <span class="keyword">true</span>;
<a name="l21903"></a>21903                 } <span class="keywordflow">else</span> {
<a name="l21904"></a>21904                     $wfill = $fill | <span class="keyword">false</span>;
<a name="l21905"></a>21905                 }
<a name="l21906"></a>21906                 <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l21907"></a>21907                     $this-&gt;SetTextColorArray($dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>]);
<a name="l21908"></a>21908                 }
<a name="l21909"></a>21909                 <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l21910"></a>21910                     $this-&gt;SetDrawColorArray($dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>]);
<a name="l21911"></a>21911                 }
<a name="l21912"></a>21912                 <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;align&#39;</span>])) {
<a name="l21913"></a>21913                     $lalign = $dom[$key][<span class="stringliteral">&#39;align&#39;</span>];
<a name="l21914"></a>21914                 }
<a name="l21915"></a>21915                 <span class="keywordflow">if</span> ($this-&gt;empty_string($lalign)) {
<a name="l21916"></a>21916                     $lalign = $align;
<a name="l21917"></a>21917                 }
<a name="l21918"></a>21918             }
<a name="l21919"></a>21919             <span class="comment">// align lines</span>
<a name="l21920"></a>21920             <span class="keywordflow">if</span> ($this-&gt;newline AND (strlen($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]) &gt; 0) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;td&#39;</span>) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;th&#39;</span>)) {
<a name="l21921"></a>21921                 $newline = <span class="keyword">true</span>;
<a name="l21922"></a>21922                 $fontaligned = <span class="keyword">false</span>;
<a name="l21923"></a>21923                 <span class="comment">// we are at the beginning of a new line</span>
<a name="l21924"></a>21924                 <span class="keywordflow">if</span> (isset($startlinex)) {
<a name="l21925"></a>21925                     $yshift = ($minstartliney - $startliney);
<a name="l21926"></a>21926                     <span class="keywordflow">if</span> (($yshift &gt; 0) OR ($this-&gt;page &gt; $startlinepage)) {
<a name="l21927"></a>21927                         $yshift = 0;
<a name="l21928"></a>21928                     }
<a name="l21929"></a>21929                     $t_x = 0;
<a name="l21930"></a>21930                     <span class="comment">// the last line must be shifted to be aligned as requested</span>
<a name="l21931"></a>21931                     $linew = abs($this-&gt;endlinex - $startlinex);
<a name="l21932"></a>21932                     <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l21933"></a>21933                         <span class="comment">// we are inside an XObject template</span>
<a name="l21934"></a>21934                         $pstart = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], 0, $startlinepos);
<a name="l21935"></a>21935                         <span class="keywordflow">if</span> (isset($opentagpos)) {
<a name="l21936"></a>21936                             $midpos = $opentagpos;
<a name="l21937"></a>21937                         } <span class="keywordflow">else</span> {
<a name="l21938"></a>21938                             $midpos = 0;
<a name="l21939"></a>21939                         }
<a name="l21940"></a>21940                         <span class="keywordflow">if</span> ($midpos &gt; 0) {
<a name="l21941"></a>21941                             $pmid = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $startlinepos, ($midpos - $startlinepos));
<a name="l21942"></a>21942                             $pend = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $midpos);
<a name="l21943"></a>21943                         } <span class="keywordflow">else</span> {
<a name="l21944"></a>21944                             $pmid = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $startlinepos);
<a name="l21945"></a>21945                             $pend = <span class="stringliteral">&#39;&#39;</span>;
<a name="l21946"></a>21946                         }
<a name="l21947"></a>21947                     } <span class="keywordflow">else</span> {
<a name="l21948"></a>21948                         $pstart = substr($this-&gt;getPageBuffer($startlinepage), 0, $startlinepos);
<a name="l21949"></a>21949                         <span class="keywordflow">if</span> (isset($opentagpos) AND isset($this-&gt;footerlen[$startlinepage]) AND (!$this-&gt;InFooter)) {
<a name="l21950"></a>21950                             $this-&gt;footerpos[$startlinepage] = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];
<a name="l21951"></a>21951                             $midpos = min($opentagpos, $this-&gt;footerpos[$startlinepage]);
<a name="l21952"></a>21952                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($opentagpos)) {
<a name="l21953"></a>21953                             $midpos = $opentagpos;
<a name="l21954"></a>21954                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;footerlen[$startlinepage]) AND (!$this-&gt;InFooter)) {
<a name="l21955"></a>21955                             $this-&gt;footerpos[$startlinepage] = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];
<a name="l21956"></a>21956                             $midpos = $this-&gt;footerpos[$startlinepage];
<a name="l21957"></a>21957                         } <span class="keywordflow">else</span> {
<a name="l21958"></a>21958                             $midpos = 0;
<a name="l21959"></a>21959                         }
<a name="l21960"></a>21960                         <span class="keywordflow">if</span> ($midpos &gt; 0) {
<a name="l21961"></a>21961                             $pmid = substr($this-&gt;getPageBuffer($startlinepage), $startlinepos, ($midpos - $startlinepos));
<a name="l21962"></a>21962                             $pend = substr($this-&gt;getPageBuffer($startlinepage), $midpos);
<a name="l21963"></a>21963                         } <span class="keywordflow">else</span> {
<a name="l21964"></a>21964                             $pmid = substr($this-&gt;getPageBuffer($startlinepage), $startlinepos);
<a name="l21965"></a>21965                             $pend = <span class="stringliteral">&#39;&#39;</span>;
<a name="l21966"></a>21966                         }
<a name="l21967"></a>21967                     }
<a name="l21968"></a>21968                     <span class="keywordflow">if</span> ((isset($plalign) AND ((($plalign == <span class="charliteral">&#39;C&#39;</span>) OR ($plalign == <span class="charliteral">&#39;J&#39;</span>) OR (($plalign == <span class="charliteral">&#39;R&#39;</span>) AND (!$this-&gt;rtl)) OR (($plalign == <span class="charliteral">&#39;L&#39;</span>) AND ($this-&gt;rtl)))))) {
<a name="l21969"></a>21969                         <span class="comment">// calculate shifting amount</span>
<a name="l21970"></a>21970                         $tw = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l21971"></a>21971                         <span class="keywordflow">if</span> (($plalign == <span class="charliteral">&#39;J&#39;</span>) AND $this-&gt;isRTLTextDir() AND ($this-&gt;num_columns &gt; 1)) {
<a name="l21972"></a>21972                             $tw += $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l21973"></a>21973                         }
<a name="l21974"></a>21974                         <span class="keywordflow">if</span> ($this-&gt;lMargin != $prevlMargin) {
<a name="l21975"></a>21975                             $tw += ($prevlMargin - $this-&gt;lMargin);
<a name="l21976"></a>21976                         }
<a name="l21977"></a>21977                         <span class="keywordflow">if</span> ($this-&gt;rMargin != $prevrMargin) {
<a name="l21978"></a>21978                             $tw += ($prevrMargin - $this-&gt;rMargin);
<a name="l21979"></a>21979                         }
<a name="l21980"></a>21980                         $one_space_width = $this-&gt;GetStringWidth(chr(32));
<a name="l21981"></a>21981                         $no = 0; <span class="comment">// number of spaces on a line contained on a single block</span>
<a name="l21982"></a>21982                         <span class="keywordflow">if</span> ($this-&gt;isRTLTextDir()) { <span class="comment">// RTL</span>
<a name="l21983"></a>21983                             <span class="comment">// remove left space if exist</span>
<a name="l21984"></a>21984                             $pos1 = $this-&gt;revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>);
<a name="l21985"></a>21985                             <span class="keywordflow">if</span> ($pos1 &gt; 0) {
<a name="l21986"></a>21986                                 $pos1 = intval($pos1);
<a name="l21987"></a>21987                                 <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l21988"></a>21988                                     $pos2 = intval($this-&gt;revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>.chr(0).chr(32)));
<a name="l21989"></a>21989                                     $spacelen = 2;
<a name="l21990"></a>21990                                 } <span class="keywordflow">else</span> {
<a name="l21991"></a>21991                                     $pos2 = intval($this-&gt;revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>.chr(32)));
<a name="l21992"></a>21992                                     $spacelen = 1;
<a name="l21993"></a>21993                                 }
<a name="l21994"></a>21994                                 <span class="keywordflow">if</span> ($pos1 == $pos2) {
<a name="l21995"></a>21995                                     $pmid = substr($pmid, 0, ($pos1 + 2)).substr($pmid, ($pos1 + 2 + $spacelen));
<a name="l21996"></a>21996                                     <span class="keywordflow">if</span> (substr($pmid, $pos1, 4) == <span class="stringliteral">&#39;[()]&#39;</span>) {
<a name="l21997"></a>21997                                         $linew -= $one_space_width;
<a name="l21998"></a>21998                                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($pos1 == strpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>)) {
<a name="l21999"></a>21999                                         $no = 1;
<a name="l22000"></a>22000                                     }
<a name="l22001"></a>22001                                 }
<a name="l22002"></a>22002                             }
<a name="l22003"></a>22003                         } <span class="keywordflow">else</span> { <span class="comment">// LTR</span>
<a name="l22004"></a>22004                             <span class="comment">// remove right space if exist</span>
<a name="l22005"></a>22005                             $pos1 = $this-&gt;revstrpos($pmid, <span class="stringliteral">&#39;)]&#39;</span>);
<a name="l22006"></a>22006                             <span class="keywordflow">if</span> ($pos1 &gt; 0) {
<a name="l22007"></a>22007                                 $pos1 = intval($pos1);
<a name="l22008"></a>22008                                 <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l22009"></a>22009                                     $pos2 = intval($this-&gt;revstrpos($pmid, chr(0).chr(32).<span class="stringliteral">&#39;)]&#39;</span>)) + 2;
<a name="l22010"></a>22010                                     $spacelen = 2;
<a name="l22011"></a>22011                                 } <span class="keywordflow">else</span> {
<a name="l22012"></a>22012                                     $pos2 = intval($this-&gt;revstrpos($pmid, chr(32).<span class="stringliteral">&#39;)]&#39;</span>)) + 1;
<a name="l22013"></a>22013                                     $spacelen = 1;
<a name="l22014"></a>22014                                 }
<a name="l22015"></a>22015                                 <span class="keywordflow">if</span> ($pos1 == $pos2) {
<a name="l22016"></a>22016                                     $pmid = substr($pmid, 0, ($pos1 - $spacelen)).substr($pmid, $pos1);
<a name="l22017"></a>22017                                     $linew -= $one_space_width;
<a name="l22018"></a>22018                                 }
<a name="l22019"></a>22019                             }
<a name="l22020"></a>22020                         }
<a name="l22021"></a>22021                         $mdiff = ($tw - $linew);
<a name="l22022"></a>22022                         <span class="keywordflow">if</span> ($plalign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l22023"></a>22023                             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l22024"></a>22024                                 $t_x = -($mdiff / 2);
<a name="l22025"></a>22025                             } <span class="keywordflow">else</span> {
<a name="l22026"></a>22026                                 $t_x = ($mdiff / 2);
<a name="l22027"></a>22027                             }
<a name="l22028"></a>22028                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($plalign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l22029"></a>22029                             <span class="comment">// right alignment on LTR document</span>
<a name="l22030"></a>22030                             $t_x = $mdiff;
<a name="l22031"></a>22031                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($plalign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l22032"></a>22032                             <span class="comment">// left alignment on RTL document</span>
<a name="l22033"></a>22033                             $t_x = -$mdiff;
<a name="l22034"></a>22034                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($plalign == <span class="charliteral">&#39;J&#39;</span>) AND ($plalign == $lalign)) {
<a name="l22035"></a>22035                             <span class="comment">// Justification</span>
<a name="l22036"></a>22036                             <span class="keywordflow">if</span> ($this-&gt;isRTLTextDir()) {
<a name="l22037"></a>22037                                 <span class="comment">// align text on the left</span>
<a name="l22038"></a>22038                                 $t_x = -$mdiff;
<a name="l22039"></a>22039                             }
<a name="l22040"></a>22040                             $ns = 0; <span class="comment">// number of spaces</span>
<a name="l22041"></a>22041                             $pmidtemp = $pmid;
<a name="l22042"></a>22042                             <span class="comment">// escape special characters</span>
<a name="l22043"></a>22043                             $pmidtemp = preg_replace(<span class="stringliteral">&#39;/[\\\][\(]/x&#39;</span>, <span class="stringliteral">&#39;\\#!#OP#!#&#39;</span>, $pmidtemp);
<a name="l22044"></a>22044                             $pmidtemp = preg_replace(<span class="stringliteral">&#39;/[\\\][\)]/x&#39;</span>, <span class="stringliteral">&#39;\\#!#CP#!#&#39;</span>, $pmidtemp);
<a name="l22045"></a>22045                             <span class="comment">// search spaces</span>
<a name="l22046"></a>22046                             <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/\[\(([^\)]*)\)\]/x&#39;</span>, $pmidtemp, $lnstring, PREG_PATTERN_ORDER)) {
<a name="l22047"></a>22047                                 $spacestr = $this-&gt;getSpaceString();
<a name="l22048"></a>22048                                 $maxkk = count($lnstring[1]) - 1;
<a name="l22049"></a>22049                                 <span class="keywordflow">for</span> ($kk=0; $kk &lt;= $maxkk; ++$kk) {
<a name="l22050"></a>22050                                     <span class="comment">// restore special characters</span>
<a name="l22051"></a>22051                                     $lnstring[1][$kk] = str_replace(<span class="stringliteral">&#39;#!#OP#!#&#39;</span>, <span class="charliteral">&#39;(&#39;</span>, $lnstring[1][$kk]);
<a name="l22052"></a>22052                                     $lnstring[1][$kk] = str_replace(<span class="stringliteral">&#39;#!#CP#!#&#39;</span>, <span class="charliteral">&#39;)&#39;</span>, $lnstring[1][$kk]);
<a name="l22053"></a>22053                                     <span class="comment">// store number of spaces on the strings</span>
<a name="l22054"></a>22054                                     $lnstring[2][$kk] = substr_count($lnstring[1][$kk], $spacestr);
<a name="l22055"></a>22055                                     <span class="comment">// count total spaces on line</span>
<a name="l22056"></a>22056                                     $ns += $lnstring[2][$kk];
<a name="l22057"></a>22057                                     $lnstring[3][$kk] = $ns;
<a name="l22058"></a>22058                                 }
<a name="l22059"></a>22059                                 <span class="keywordflow">if</span> ($ns == 0) {
<a name="l22060"></a>22060                                     $ns = 1;
<a name="l22061"></a>22061                                 }
<a name="l22062"></a>22062                                 <span class="comment">// calculate additional space to add to each existing space</span>
<a name="l22063"></a>22063                                 $spacewidth = ($mdiff / ($ns - $no)) * $this-&gt;k;
<a name="l22064"></a>22064                                 $spacewidthu = -1000 * ($mdiff + (($ns + $no) * $one_space_width)) / $ns / $this-&gt;FontSize;
<a name="l22065"></a>22065                                 <span class="keywordflow">if</span> ($this-&gt;font_spacing != 0) {
<a name="l22066"></a>22066                                     <span class="comment">// fixed spacing mode</span>
<a name="l22067"></a>22067                                     $osw = -1000 * $this-&gt;font_spacing / $this-&gt;FontSize;
<a name="l22068"></a>22068                                     $spacewidthu += $osw;
<a name="l22069"></a>22069                                 }
<a name="l22070"></a>22070                                 $nsmax = $ns;
<a name="l22071"></a>22071                                 $ns = 0;
<a name="l22072"></a>22072                                 reset($lnstring);
<a name="l22073"></a>22073                                 <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0;
<a name="l22074"></a>22074                                 $strcount = 0;
<a name="l22075"></a>22075                                 $prev_epsposbeg = 0;
<a name="l22076"></a>22076                                 $textpos = 0;
<a name="l22077"></a>22077                                 <span class="keywordflow">if</span> ($this-&gt;isRTLTextDir()) {
<a name="l22078"></a>22078                                     $textpos = $this-&gt;wPt;
<a name="l22079"></a>22079                                 }
<a name="l22080"></a>22080                                 global $spacew;
<a name="l22081"></a>22081                                 <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s](Td|cm|m|l|c|re)[\s]/x&#39;</span>, $pmid, $strpiece, PREG_OFFSET_CAPTURE, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) == 1) {
<a name="l22082"></a>22082                                     <span class="comment">// check if we are inside a string section &#39;[( ... )]&#39;</span>
<a name="l22083"></a>22083                                     $stroffset = strpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l22084"></a>22084                                     <span class="keywordflow">if</span> (($stroffset !== <span class="keyword">false</span>) AND ($stroffset &lt;= $strpiece[2][1])) {
<a name="l22085"></a>22085                                         <span class="comment">// set offset to the end of string section</span>
<a name="l22086"></a>22086                                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = strpos($pmid, <span class="stringliteral">&#39;)]&#39;</span>, $stroffset);
<a name="l22087"></a>22087                                         <span class="keywordflow">while</span> ((<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> !== <span class="keyword">false</span>) AND ($pmid[(<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> - 1)] == <span class="charliteral">&#39;\\&#39;</span>)) {
<a name="l22088"></a>22088                                             <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = strpos($pmid, <span class="stringliteral">&#39;)]&#39;</span>, (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> + 1));
<a name="l22089"></a>22089                                         }
<a name="l22090"></a>22090                                         <span class="keywordflow">if</span> (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> === <span class="keyword">false</span>) {
<a name="l22091"></a>22091                                             $this-&gt;Error(<span class="stringliteral">&#39;HTML Justification: malformed PDF code.&#39;</span>);
<a name="l22092"></a>22092                                         }
<a name="l22093"></a>22093                                         <span class="keywordflow">continue</span>;
<a name="l22094"></a>22094                                     }
<a name="l22095"></a>22095                                     <span class="keywordflow">if</span> ($this-&gt;isRTLTextDir()) {
<a name="l22096"></a>22096                                         $spacew = ($spacewidth * ($nsmax - $ns));
<a name="l22097"></a>22097                                     } <span class="keywordflow">else</span> {
<a name="l22098"></a>22098                                         $spacew = ($spacewidth * $ns);
<a name="l22099"></a>22099                                     }
<a name="l22100"></a>22100                                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = $strpiece[2][1] + strlen($strpiece[2][0]);
<a name="l22101"></a>22101                                     $epsposbeg = strpos($pmid, <span class="charliteral">&#39;q&#39;</span>.$this-&gt;epsmarker, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l22102"></a>22102                                     $epsposend = strpos($pmid, $this-&gt;epsmarker.<span class="charliteral">&#39;Q&#39;</span>, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>) + strlen($this-&gt;epsmarker.<span class="charliteral">&#39;Q&#39;</span>);
<a name="l22103"></a>22103                                     <span class="keywordflow">if</span> ((($epsposbeg &gt; 0) AND ($epsposend &gt; 0) AND (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> &gt; $epsposbeg) AND (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> &lt; $epsposend))
<a name="l22104"></a>22104                                         OR (($epsposbeg === <span class="keyword">false</span>) AND ($epsposend &gt; 0) AND (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> &lt; $epsposend))) {
<a name="l22105"></a>22105                                         <span class="comment">// shift EPS images</span>
<a name="l22106"></a>22106                                         $trx = sprintf(<span class="stringliteral">&#39;1 0 0 1 %.3F 0 cm&#39;</span>, $spacew);
<a name="l22107"></a>22107                                         $epsposbeg = strpos($pmid, <span class="charliteral">&#39;q&#39;</span>.$this-&gt;epsmarker, ($prev_epsposbeg - 6));
<a name="l22108"></a>22108                                         $pmid_b = substr($pmid, 0, $epsposbeg);
<a name="l22109"></a>22109                                         $pmid_m = substr($pmid, $epsposbeg, ($epsposend - $epsposbeg));
<a name="l22110"></a>22110                                         $pmid_e = substr($pmid, $epsposend);
<a name="l22111"></a>22111                                         $pmid = $pmid_b.<span class="stringliteral">&quot;\nq\n&quot;</span>.$trx.<span class="stringliteral">&quot;\n&quot;</span>.$pmid_m.<span class="stringliteral">&quot;\nQ\n&quot;</span>.$pmid_e;
<a name="l22112"></a>22112                                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = $epsposend;
<a name="l22113"></a>22113                                         <span class="keywordflow">continue</span>;
<a name="l22114"></a>22114 
<a name="l22115"></a>22115                                     }
<a name="l22116"></a>22116                                     $prev_epsposbeg = $epsposbeg;
<a name="l22117"></a>22117                                     $currentxpos = 0;
<a name="l22118"></a>22118                                     <span class="comment">// shift blocks of code</span>
<a name="l22119"></a>22119                                     <span class="keywordflow">switch</span> ($strpiece[2][0]) {
<a name="l22120"></a>22120                                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;Td&#39;</span>:
<a name="l22121"></a>22121                                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;cm&#39;</span>:
<a name="l22122"></a>22122                                         <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:
<a name="l22123"></a>22123                                         <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>: {
<a name="l22124"></a>22124                                             <span class="comment">// get current X position</span>
<a name="l22125"></a>22125                                             preg_match(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](&#39;</span>.$strpiece[2][0].<span class="stringliteral">&#39;)([\s]*)/x&#39;</span>, $pmid, $xmatches);
<a name="l22126"></a>22126                                             $currentxpos = $xmatches[1];
<a name="l22127"></a>22127                                             $textpos = $currentxpos;
<a name="l22128"></a>22128                                             <span class="keywordflow">if</span> (($strcount &lt;= $maxkk) AND ($strpiece[2][0] == <span class="stringliteral">&#39;Td&#39;</span>)) {
<a name="l22129"></a>22129                                                 $ns = $lnstring[3][$strcount];
<a name="l22130"></a>22130                                                 <span class="keywordflow">if</span> ($this-&gt;isRTLTextDir()) {
<a name="l22131"></a>22131                                                     $spacew = ($spacewidth * ($nsmax - $ns));
<a name="l22132"></a>22132                                                 }
<a name="l22133"></a>22133                                                 ++$strcount;
<a name="l22134"></a>22134                                             }
<a name="l22135"></a>22135                                             <span class="comment">// justify block</span>
<a name="l22136"></a>22136                                             $pmid = preg_replace_callback(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](&#39;</span>.$strpiece[2][0].<span class="stringliteral">&#39;)([\s]*)/x&#39;</span>,
<a name="l22137"></a>22137                                                 create_function(<span class="stringliteral">&#39;$matches&#39;</span>, <span class="stringliteral">&#39;global $spacew;</span>
<a name="l22138"></a>22138 <span class="stringliteral">                                                $newx = sprintf(&quot;%.2F&quot;,(floatval($matches[1]) + $spacew));</span>
<a name="l22139"></a>22139 <span class="stringliteral">                                                return &quot;&quot;.$newx.&quot; &quot;.$matches[2].&quot; x*#!#*x&quot;.$matches[3].$matches[4];&#39;</span>), $pmid, 1);
<a name="l22140"></a>22140                                             <span class="keywordflow">break</span>;
<a name="l22141"></a>22141                                         }
<a name="l22142"></a>22142                                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;re&#39;</span>: {
<a name="l22143"></a>22143                                             <span class="comment">// justify block</span>
<a name="l22144"></a>22144                                             <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;lispacer)) {
<a name="l22145"></a>22145                                                 $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;
<a name="l22146"></a>22146                                                 <span class="keywordflow">continue</span>;
<a name="l22147"></a>22147                                             }
<a name="l22148"></a>22148                                             preg_match(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](re)([\s]*)/x&#39;</span>, $pmid, $xmatches);
<a name="l22149"></a>22149                                             $currentxpos = $xmatches[1];
<a name="l22150"></a>22150                                             global $x_diff, $w_diff;
<a name="l22151"></a>22151                                             $x_diff = 0;
<a name="l22152"></a>22152                                             $w_diff = 0;
<a name="l22153"></a>22153                                             <span class="keywordflow">if</span> ($this-&gt;isRTLTextDir()) { <span class="comment">// RTL</span>
<a name="l22154"></a>22154                                                 <span class="keywordflow">if</span> ($currentxpos &lt; $textpos) {
<a name="l22155"></a>22155                                                     $x_diff = ($spacewidth * ($nsmax - $lnstring[3][$strcount]));
<a name="l22156"></a>22156                                                     $w_diff = ($spacewidth * $lnstring[2][$strcount]);
<a name="l22157"></a>22157                                                 } <span class="keywordflow">else</span> {
<a name="l22158"></a>22158                                                     <span class="keywordflow">if</span> ($strcount &gt; 0) {
<a name="l22159"></a>22159                                                         $x_diff = ($spacewidth * ($nsmax - $lnstring[3][($strcount - 1)]));
<a name="l22160"></a>22160                                                         $w_diff = ($spacewidth * $lnstring[2][($strcount - 1)]);
<a name="l22161"></a>22161                                                     }
<a name="l22162"></a>22162                                                 }
<a name="l22163"></a>22163                                             } <span class="keywordflow">else</span> { <span class="comment">// LTR</span>
<a name="l22164"></a>22164                                                 <span class="keywordflow">if</span> ($currentxpos &gt; $textpos) {
<a name="l22165"></a>22165                                                     <span class="keywordflow">if</span> ($strcount &gt; 0) {
<a name="l22166"></a>22166                                                         $x_diff = ($spacewidth * $lnstring[3][($strcount - 1)]);
<a name="l22167"></a>22167                                                     }
<a name="l22168"></a>22168                                                     $w_diff = ($spacewidth * $lnstring[2][$strcount]);
<a name="l22169"></a>22169                                                 } <span class="keywordflow">else</span> {
<a name="l22170"></a>22170                                                     <span class="keywordflow">if</span> ($strcount &gt; 1) {
<a name="l22171"></a>22171                                                         $x_diff = ($spacewidth * $lnstring[3][($strcount - 2)]);
<a name="l22172"></a>22172                                                     }
<a name="l22173"></a>22173                                                     <span class="keywordflow">if</span> ($strcount &gt; 0) {
<a name="l22174"></a>22174                                                         $w_diff = ($spacewidth * $lnstring[2][($strcount - 1)]);
<a name="l22175"></a>22175                                                     }
<a name="l22176"></a>22176                                                 }
<a name="l22177"></a>22177                                             }
<a name="l22178"></a>22178                                             $pmid = preg_replace_callback(<span class="stringliteral">&#39;/(&#39;</span>.$xmatches[1].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[2].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[3].<span class="stringliteral">&#39;)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](re)([\s]*)/x&#39;</span>,
<a name="l22179"></a>22179                                                 create_function(<span class="stringliteral">&#39;$matches&#39;</span>, <span class="stringliteral">&#39;global $x_diff, $w_diff;</span>
<a name="l22180"></a>22180 <span class="stringliteral">                                                $newx = sprintf(&quot;%.2F&quot;,(floatval($matches[1]) + $x_diff));</span>
<a name="l22181"></a>22181 <span class="stringliteral">                                                $neww = sprintf(&quot;%.2F&quot;,(floatval($matches[3]) + $w_diff));</span>
<a name="l22182"></a>22182 <span class="stringliteral">                                                return &quot;&quot;.$newx.&quot; &quot;.$matches[2].&quot; &quot;.$neww.&quot; &quot;.$matches[4].&quot; x*#!#*x&quot;.$matches[5].$matches[6];&#39;</span>), $pmid, 1);
<a name="l22183"></a>22183                                             <span class="keywordflow">break</span>;
<a name="l22184"></a>22184                                         }
<a name="l22185"></a>22185                                         <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>: {
<a name="l22186"></a>22186                                             <span class="comment">// get current X position</span>
<a name="l22187"></a>22187                                             preg_match(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](c)([\s]*)/x&#39;</span>, $pmid, $xmatches);
<a name="l22188"></a>22188                                             $currentxpos = $xmatches[1];
<a name="l22189"></a>22189                                             <span class="comment">// justify block</span>
<a name="l22190"></a>22190                                             $pmid = preg_replace_callback(<span class="stringliteral">&#39;/(&#39;</span>.$xmatches[1].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[2].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[3].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[4].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[5].<span class="stringliteral">&#39;)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](c)([\s]*)/x&#39;</span>,
<a name="l22191"></a>22191                                                 create_function(<span class="stringliteral">&#39;$matches&#39;</span>, <span class="stringliteral">&#39;global $spacew;</span>
<a name="l22192"></a>22192 <span class="stringliteral">                                                $newx1 = sprintf(&quot;%.3F&quot;,(floatval($matches[1]) + $spacew));</span>
<a name="l22193"></a>22193 <span class="stringliteral">                                                $newx2 = sprintf(&quot;%.3F&quot;,(floatval($matches[3]) + $spacew));</span>
<a name="l22194"></a>22194 <span class="stringliteral">                                                $newx3 = sprintf(&quot;%.3F&quot;,(floatval($matches[5]) + $spacew));</span>
<a name="l22195"></a>22195 <span class="stringliteral">                                                return &quot;&quot;.$newx1.&quot; &quot;.$matches[2].&quot; &quot;.$newx2.&quot; &quot;.$matches[4].&quot; &quot;.$newx3.&quot; &quot;.$matches[6].&quot; x*#!#*x&quot;.$matches[7].$matches[8];&#39;</span>), $pmid, 1);
<a name="l22196"></a>22196                                             <span class="keywordflow">break</span>;
<a name="l22197"></a>22197                                         }
<a name="l22198"></a>22198                                     }
<a name="l22199"></a>22199                                     <span class="comment">// shift the annotations and links</span>
<a name="l22200"></a>22200                                     $cxpos = ($currentxpos / $this-&gt;k);
<a name="l22201"></a>22201                                     $lmpos = ($this-&gt;lMargin + $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] + $this-&gt;feps);
<a name="l22202"></a>22202                                     <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l22203"></a>22203                                         <span class="comment">// we are inside an XObject template</span>
<a name="l22204"></a>22204                                         <span class="keywordflow">foreach</span> ($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>] as $pak =&gt; $pac) {
<a name="l22205"></a>22205                                             <span class="keywordflow">if</span> (($pac[<span class="charliteral">&#39;y&#39;</span>] &gt;= $minstartliney) AND (($pac[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k) &gt;= ($currentxpos - $this-&gt;feps)) AND (($pac[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k) &lt;= ($currentxpos + $this-&gt;feps))) {
<a name="l22206"></a>22206                                                 <span class="keywordflow">if</span> ($cxpos &gt; $lmpos) {
<a name="l22207"></a>22207                                                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;x&#39;</span>] += ($spacew / $this-&gt;k);
<a name="l22208"></a>22208                                                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;w&#39;</span>] += (($spacewidth * $pac[<span class="stringliteral">&#39;numspaces&#39;</span>]) / $this-&gt;k);
<a name="l22209"></a>22209                                                 } <span class="keywordflow">else</span> {
<a name="l22210"></a>22210                                                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;w&#39;</span>] += (($spacewidth * $pac[<span class="stringliteral">&#39;numspaces&#39;</span>]) / $this-&gt;k);
<a name="l22211"></a>22211                                                 }
<a name="l22212"></a>22212                                                 <span class="keywordflow">break</span>;
<a name="l22213"></a>22213                                             }
<a name="l22214"></a>22214                                         }
<a name="l22215"></a>22215                                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;PageAnnots[$this-&gt;page])) {
<a name="l22216"></a>22216                                         <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$this-&gt;page] as $pak =&gt; $pac) {
<a name="l22217"></a>22217                                             <span class="keywordflow">if</span> (($pac[<span class="charliteral">&#39;y&#39;</span>] &gt;= $minstartliney) AND (($pac[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k) &gt;= ($currentxpos - $this-&gt;feps)) AND (($pac[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k) &lt;= ($currentxpos + $this-&gt;feps))) {
<a name="l22218"></a>22218                                                 <span class="keywordflow">if</span> ($cxpos &gt; $lmpos) {
<a name="l22219"></a>22219                                                     $this-&gt;PageAnnots[$this-&gt;page][$pak][<span class="charliteral">&#39;x&#39;</span>] += ($spacew / $this-&gt;k);
<a name="l22220"></a>22220                                                     $this-&gt;PageAnnots[$this-&gt;page][$pak][<span class="charliteral">&#39;w&#39;</span>] += (($spacewidth * $pac[<span class="stringliteral">&#39;numspaces&#39;</span>]) / $this-&gt;k);
<a name="l22221"></a>22221                                                 } <span class="keywordflow">else</span> {
<a name="l22222"></a>22222                                                     $this-&gt;PageAnnots[$this-&gt;page][$pak][<span class="charliteral">&#39;w&#39;</span>] += (($spacewidth * $pac[<span class="stringliteral">&#39;numspaces&#39;</span>]) / $this-&gt;k);
<a name="l22223"></a>22223                                                 }
<a name="l22224"></a>22224                                                 <span class="keywordflow">break</span>;
<a name="l22225"></a>22225                                             }
<a name="l22226"></a>22226                                         }
<a name="l22227"></a>22227                                     }
<a name="l22228"></a>22228                                 } <span class="comment">// end of while</span>
<a name="l22229"></a>22229                                 <span class="comment">// remove markers</span>
<a name="l22230"></a>22230                                 $pmid = str_replace(<span class="stringliteral">&#39;x*#!#*x&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $pmid);
<a name="l22231"></a>22231                                 <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l22232"></a>22232                                     <span class="comment">// multibyte characters</span>
<a name="l22233"></a>22233                                     $spacew = $spacewidthu;
<a name="l22234"></a>22234                                     <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {
<a name="l22235"></a>22235                                         <span class="comment">// word spacing is affected by stretching</span>
<a name="l22236"></a>22236                                         $spacew /= ($this-&gt;font_stretching / 100);
<a name="l22237"></a>22237                                     }
<a name="l22238"></a>22238                                     $pmidtemp = $pmid;
<a name="l22239"></a>22239                                     <span class="comment">// escape special characters</span>
<a name="l22240"></a>22240                                     $pmidtemp = preg_replace(<span class="stringliteral">&#39;/[\\\][\(]/x&#39;</span>, <span class="stringliteral">&#39;\\#!#OP#!#&#39;</span>, $pmidtemp);
<a name="l22241"></a>22241                                     $pmidtemp = preg_replace(<span class="stringliteral">&#39;/[\\\][\)]/x&#39;</span>, <span class="stringliteral">&#39;\\#!#CP#!#&#39;</span>, $pmidtemp);
<a name="l22242"></a>22242                                     $pmid = preg_replace_callback(<span class="stringliteral">&quot;/\[\(([^\)]*)\)\]/x&quot;</span>,
<a name="l22243"></a>22243                                                 create_function(<span class="stringliteral">&#39;$matches&#39;</span>, <span class="stringliteral">&#39;global $spacew;</span>
<a name="l22244"></a>22244 <span class="stringliteral">                                                $matches[1] = str_replace(&quot;#!#OP#!#&quot;, &quot;(&quot;, $matches[1]);</span>
<a name="l22245"></a>22245 <span class="stringliteral">                                                $matches[1] = str_replace(&quot;#!#CP#!#&quot;, &quot;)&quot;, $matches[1]);</span>
<a name="l22246"></a>22246 <span class="stringliteral">                                                return &quot;[(&quot;.str_replace(chr(0).chr(32), &quot;) &quot;.sprintf(&quot;%.3F&quot;, $spacew).&quot; (&quot;, $matches[1]).&quot;)]&quot;;&#39;</span>), $pmidtemp);
<a name="l22247"></a>22247                                     <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l22248"></a>22248                                         <span class="comment">// we are inside an XObject template</span>
<a name="l22249"></a>22249                                         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\n&quot;</span>.$pend;
<a name="l22250"></a>22250                                     } <span class="keywordflow">else</span> {
<a name="l22251"></a>22251                                         $this-&gt;setPageBuffer($startlinepage, $pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\n&quot;</span>.$pend);
<a name="l22252"></a>22252                                     }
<a name="l22253"></a>22253                                     $endlinepos = strlen($pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l22254"></a>22254                                 } <span class="keywordflow">else</span> {
<a name="l22255"></a>22255                                     <span class="comment">// non-unicode (single-byte characters)</span>
<a name="l22256"></a>22256                                     <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {
<a name="l22257"></a>22257                                         <span class="comment">// word spacing (Tw) is affected by stretching</span>
<a name="l22258"></a>22258                                         $spacewidth /= ($this-&gt;font_stretching / 100);
<a name="l22259"></a>22259                                     }
<a name="l22260"></a>22260                                     $rs = sprintf(<span class="stringliteral">&#39;%.3F Tw&#39;</span>, $spacewidth);
<a name="l22261"></a>22261                                     $pmid = preg_replace(<span class="stringliteral">&quot;/\[\(/x&quot;</span>, $rs.<span class="stringliteral">&#39; [(&#39;</span>, $pmid);
<a name="l22262"></a>22262                                     <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l22263"></a>22263                                         <span class="comment">// we are inside an XObject template</span>
<a name="l22264"></a>22264                                         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nBT 0 Tw ET\n&quot;</span>.$pend;
<a name="l22265"></a>22265                                     } <span class="keywordflow">else</span> {
<a name="l22266"></a>22266                                         $this-&gt;setPageBuffer($startlinepage, $pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nBT 0 Tw ET\n&quot;</span>.$pend);
<a name="l22267"></a>22267                                     }
<a name="l22268"></a>22268                                     $endlinepos = strlen($pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nBT 0 Tw ET\n&quot;</span>);
<a name="l22269"></a>22269                                 }
<a name="l22270"></a>22270                             }
<a name="l22271"></a>22271                         } <span class="comment">// end of J</span>
<a name="l22272"></a>22272                     } <span class="comment">// end if $startlinex</span>
<a name="l22273"></a>22273                     <span class="keywordflow">if</span> (($t_x != 0) OR ($yshift &lt; 0)) {
<a name="l22274"></a>22274                         <span class="comment">// shift the line</span>
<a name="l22275"></a>22275                         $trx = sprintf(<span class="stringliteral">&#39;1 0 0 1 %.3F %.3F cm&#39;</span>, ($t_x * $this-&gt;k), ($yshift * $this-&gt;k));
<a name="l22276"></a>22276                         $pstart .= <span class="stringliteral">&quot;\nq\n&quot;</span>.$trx.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nQ\n&quot;</span>;
<a name="l22277"></a>22277                         $endlinepos = strlen($pstart);
<a name="l22278"></a>22278                         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l22279"></a>22279                             <span class="comment">// we are inside an XObject template</span>
<a name="l22280"></a>22280                             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$pend;
<a name="l22281"></a>22281                             <span class="keywordflow">foreach</span> ($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>] as $pak =&gt; $pac) {
<a name="l22282"></a>22282                                 <span class="keywordflow">if</span> ($pak &gt;= $pask) {
<a name="l22283"></a>22283                                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;x&#39;</span>] += $t_x;
<a name="l22284"></a>22284                                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;
<a name="l22285"></a>22285                                 }
<a name="l22286"></a>22286                             }
<a name="l22287"></a>22287                         } <span class="keywordflow">else</span> {
<a name="l22288"></a>22288                             $this-&gt;setPageBuffer($startlinepage, $pstart.$pend);
<a name="l22289"></a>22289                             <span class="comment">// shift the annotations and links</span>
<a name="l22290"></a>22290                             <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {
<a name="l22291"></a>22291                                 <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$this-&gt;page] as $pak =&gt; $pac) {
<a name="l22292"></a>22292                                     <span class="keywordflow">if</span> ($pak &gt;= $pask) {
<a name="l22293"></a>22293                                         $this-&gt;PageAnnots[$this-&gt;page][$pak][<span class="charliteral">&#39;x&#39;</span>] += $t_x;
<a name="l22294"></a>22294                                         $this-&gt;PageAnnots[$this-&gt;page][$pak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;
<a name="l22295"></a>22295                                     }
<a name="l22296"></a>22296                                 }
<a name="l22297"></a>22297                             }
<a name="l22298"></a>22298                         }
<a name="l22299"></a>22299                         $this-&gt;y -= $yshift;
<a name="l22300"></a>22300                     }
<a name="l22301"></a>22301                 }
<a name="l22302"></a>22302                 $pbrk = $this-&gt;checkPageBreak($this-&gt;lasth);
<a name="l22303"></a>22303                 $this-&gt;newline = <span class="keyword">false</span>;
<a name="l22304"></a>22304                 $startlinex = $this-&gt;x;
<a name="l22305"></a>22305                 $startliney = $this-&gt;y;
<a name="l22306"></a>22306                 <span class="keywordflow">if</span> ($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;sup&#39;</span>) {
<a name="l22307"></a>22307                     $startliney -= ((0.3 * $this-&gt;FontSizePt) / $this-&gt;k);
<a name="l22308"></a>22308                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;sub&#39;</span>) {
<a name="l22309"></a>22309                     $startliney -= (($this-&gt;FontSizePt / 0.7) / $this-&gt;k);
<a name="l22310"></a>22310                 } <span class="keywordflow">else</span> {
<a name="l22311"></a>22311                     $minstartliney = $startliney;
<a name="l22312"></a>22312                     $maxbottomliney = ($this-&gt;y + ((<a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> * $this-&gt;cell_height_ratio) / $this-&gt;k));
<a name="l22313"></a>22313                 }
<a name="l22314"></a>22314                 $startlinepage = $this-&gt;page;
<a name="l22315"></a>22315                 <span class="keywordflow">if</span> (isset($endlinepos) AND (!$pbrk)) {
<a name="l22316"></a>22316                     $startlinepos = $endlinepos;
<a name="l22317"></a>22317                 } <span class="keywordflow">else</span> {
<a name="l22318"></a>22318                     <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l22319"></a>22319                         <span class="comment">// we are inside an XObject template</span>
<a name="l22320"></a>22320                         $startlinepos = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);
<a name="l22321"></a>22321                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (!$this-&gt;InFooter) {
<a name="l22322"></a>22322                         <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$this-&gt;page])) {
<a name="l22323"></a>22323                             $this-&gt;footerpos[$this-&gt;page] = $this-&gt;pagelen[$this-&gt;page] - $this-&gt;footerlen[$this-&gt;page];
<a name="l22324"></a>22324                         } <span class="keywordflow">else</span> {
<a name="l22325"></a>22325                             $this-&gt;footerpos[$this-&gt;page] = $this-&gt;pagelen[$this-&gt;page];
<a name="l22326"></a>22326                         }
<a name="l22327"></a>22327                         $startlinepos = $this-&gt;footerpos[$this-&gt;page];
<a name="l22328"></a>22328                     } <span class="keywordflow">else</span> {
<a name="l22329"></a>22329                         $startlinepos = $this-&gt;pagelen[$this-&gt;page];
<a name="l22330"></a>22330                     }
<a name="l22331"></a>22331                 }
<a name="l22332"></a>22332                 unset($endlinepos);
<a name="l22333"></a>22333                 $plalign = $lalign;
<a name="l22334"></a>22334                 <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {
<a name="l22335"></a>22335                     $pask = count($this-&gt;PageAnnots[$this-&gt;page]);
<a name="l22336"></a>22336                 } <span class="keywordflow">else</span> {
<a name="l22337"></a>22337                     $pask = 0;
<a name="l22338"></a>22338                 }
<a name="l22339"></a>22339                 <span class="keywordflow">if</span> (!($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND !$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>)
<a name="l22340"></a>22340                     AND (isset($this-&gt;emptypagemrk[$this-&gt;page]))
<a name="l22341"></a>22341                     AND ($this-&gt;emptypagemrk[$this-&gt;page] == $this-&gt;pagelen[$this-&gt;page]))) {
<a name="l22342"></a>22342                     $this-&gt;SetFont($fontname, $fontstyle, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>);
<a name="l22343"></a>22343                     <span class="keywordflow">if</span> ($wfill) {
<a name="l22344"></a>22344                         $this-&gt;SetFillColorArray($this-&gt;bgcolor);
<a name="l22345"></a>22345                     }
<a name="l22346"></a>22346                 }
<a name="l22347"></a>22347             } <span class="comment">// end newline</span>
<a name="l22348"></a>22348             <span class="keywordflow">if</span> (isset($opentagpos)) {
<a name="l22349"></a>22349                 unset($opentagpos);
<a name="l22350"></a>22350             }
<a name="l22351"></a>22351             <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>]) {
<a name="l22352"></a>22352                 <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) {
<a name="l22353"></a>22353                     <span class="comment">// get text indentation (if any)</span>
<a name="l22354"></a>22354                     <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>]) AND $dom[$key][<span class="stringliteral">&#39;block&#39;</span>]) {
<a name="l22355"></a>22355                         $this-&gt;textindent = $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>];
<a name="l22356"></a>22356                         $this-&gt;newline = <span class="keyword">true</span>;
<a name="l22357"></a>22357                     }
<a name="l22358"></a>22358                     <span class="comment">// table</span>
<a name="l22359"></a>22359                     <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>) {
<a name="l22360"></a>22360                         <span class="comment">// available page width</span>
<a name="l22361"></a>22361                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l22362"></a>22362                             $wtmp = $this-&gt;x - $this-&gt;lMargin;
<a name="l22363"></a>22363                         } <span class="keywordflow">else</span> {
<a name="l22364"></a>22364                             $wtmp = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;
<a name="l22365"></a>22365                         }
<a name="l22366"></a>22366                         <span class="comment">// get cell spacing</span>
<a name="l22367"></a>22367                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {
<a name="l22368"></a>22368                             $clsp = $this-&gt;getHTMLUnitToUnits($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l22369"></a>22369                             $cellspacing = array(<span class="charliteral">&#39;H&#39;</span> =&gt; $clsp, <span class="charliteral">&#39;V&#39;</span> =&gt; $clsp);
<a name="l22370"></a>22370                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($dom[$key][<span class="stringliteral">&#39;border-spacing&#39;</span>])) {
<a name="l22371"></a>22371                             $cellspacing = $dom[$key][<span class="stringliteral">&#39;border-spacing&#39;</span>];
<a name="l22372"></a>22372                         } <span class="keywordflow">else</span> {
<a name="l22373"></a>22373                             $cellspacing = array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0);
<a name="l22374"></a>22374                         }
<a name="l22375"></a>22375                         <span class="comment">// table width</span>
<a name="l22376"></a>22376                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;width&#39;</span>])) {
<a name="l22377"></a>22377                             <a class="code" href="install_8php.html#a98904427c6610c1e0eb529c2f580ecd5">$table_width</a> = $this-&gt;getHTMLUnitToUnits($dom[$key][<span class="stringliteral">&#39;width&#39;</span>], $wtmp, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l22378"></a>22378                         } <span class="keywordflow">else</span> {
<a name="l22379"></a>22379                             <a class="code" href="install_8php.html#a98904427c6610c1e0eb529c2f580ecd5">$table_width</a> = $wtmp;
<a name="l22380"></a>22380                         }
<a name="l22381"></a>22381                         <a class="code" href="install_8php.html#a98904427c6610c1e0eb529c2f580ecd5">$table_width</a> -= (2 * $cellspacing[<span class="charliteral">&#39;H&#39;</span>]);
<a name="l22382"></a>22382                         <span class="keywordflow">if</span> (!$this-&gt;inthead) {
<a name="l22383"></a>22383                             $this-&gt;y += $cellspacing[<span class="charliteral">&#39;V&#39;</span>];
<a name="l22384"></a>22384                         }
<a name="l22385"></a>22385                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l22386"></a>22386                             $cellspacingx = -$cellspacing[<span class="charliteral">&#39;H&#39;</span>];
<a name="l22387"></a>22387                         } <span class="keywordflow">else</span> {
<a name="l22388"></a>22388                             $cellspacingx = $cellspacing[<span class="charliteral">&#39;H&#39;</span>];
<a name="l22389"></a>22389                         }
<a name="l22390"></a>22390                         <span class="comment">// total table width without cellspaces</span>
<a name="l22391"></a>22391                         $table_columns_width = (<a class="code" href="install_8php.html#a98904427c6610c1e0eb529c2f580ecd5">$table_width</a> - ($cellspacing[<span class="charliteral">&#39;H&#39;</span>] * ($dom[$key][<span class="stringliteral">&#39;cols&#39;</span>] - 1)));
<a name="l22392"></a>22392                         <span class="comment">// minimum column width</span>
<a name="l22393"></a>22393                         $table_min_column_width = ($table_columns_width / $dom[$key][<span class="stringliteral">&#39;cols&#39;</span>]);
<a name="l22394"></a>22394                         <span class="comment">// array of custom column widths</span>
<a name="l22395"></a>22395                         $table_colwidths = array_fill(0, $dom[$key][<span class="stringliteral">&#39;cols&#39;</span>], $table_min_column_width);
<a name="l22396"></a>22396                     }
<a name="l22397"></a>22397                     <span class="comment">// table row</span>
<a name="l22398"></a>22398                     <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) {
<a name="l22399"></a>22399                         <span class="comment">// reset column counter</span>
<a name="l22400"></a>22400                         $colid = 0;
<a name="l22401"></a>22401                     }
<a name="l22402"></a>22402                     <span class="comment">// table cell</span>
<a name="l22403"></a>22403                     <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;td&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;th&#39;</span>)) {
<a name="l22404"></a>22404                         $trid = $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>];
<a name="l22405"></a>22405                         $table_el = $dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>];
<a name="l22406"></a>22406                         <span class="keywordflow">if</span> (!isset($dom[$table_el][<span class="stringliteral">&#39;cols&#39;</span>])) {
<a name="l22407"></a>22407                             $dom[$table_el][<span class="stringliteral">&#39;cols&#39;</span>] = $dom[$trid][<span class="stringliteral">&#39;cols&#39;</span>];
<a name="l22408"></a>22408                         }
<a name="l22409"></a>22409                         <span class="comment">// store border info</span>
<a name="l22410"></a>22410                         $tdborder = 0;
<a name="l22411"></a>22411                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;border&#39;</span>]) AND !empty($dom[$key][<span class="stringliteral">&#39;border&#39;</span>])) {
<a name="l22412"></a>22412                             $tdborder = $dom[$key][<span class="stringliteral">&#39;border&#39;</span>];
<a name="l22413"></a>22413                         }
<a name="l22414"></a>22414                         $colspan = $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;colspan&#39;</span>];
<a name="l22415"></a>22415                         $old_cell_padding = $this-&gt;cell_padding;
<a name="l22416"></a>22416                         <span class="keywordflow">if</span> (isset($dom[($dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellpadding&#39;</span>])) {
<a name="l22417"></a>22417                             $crclpd = $this-&gt;getHTMLUnitToUnits($dom[($dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellpadding&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l22418"></a>22418                             $current_cell_padding = array(<span class="charliteral">&#39;L&#39;</span> =&gt; $crclpd, <span class="charliteral">&#39;T&#39;</span> =&gt; $crclpd, <span class="charliteral">&#39;R&#39;</span> =&gt; $crclpd, <span class="charliteral">&#39;B&#39;</span> =&gt; $crclpd);
<a name="l22419"></a>22419                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($dom[($dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;padding&#39;</span>])) {
<a name="l22420"></a>22420                             $current_cell_padding = $dom[($dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;padding&#39;</span>];
<a name="l22421"></a>22421                         } <span class="keywordflow">else</span> {
<a name="l22422"></a>22422                             $current_cell_padding = array(<span class="charliteral">&#39;L&#39;</span> =&gt; 0, <span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0);
<a name="l22423"></a>22423                         }
<a name="l22424"></a>22424                         $this-&gt;cell_padding = $current_cell_padding;
<a name="l22425"></a>22425                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;height&#39;</span>])) {
<a name="l22426"></a>22426                             <span class="comment">// minimum cell height</span>
<a name="l22427"></a>22427                             $cellh = $this-&gt;getHTMLUnitToUnits($dom[$key][<span class="stringliteral">&#39;height&#39;</span>], 0, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l22428"></a>22428                         } <span class="keywordflow">else</span> {
<a name="l22429"></a>22429                             $cellh = 0;
<a name="l22430"></a>22430                         }
<a name="l22431"></a>22431                         <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;content&#39;</span>])) {
<a name="l22432"></a>22432                             $cell_content = stripslashes($dom[$key][<span class="stringliteral">&#39;content&#39;</span>]);
<a name="l22433"></a>22433                         } <span class="keywordflow">else</span> {
<a name="l22434"></a>22434                             $cell_content = <span class="stringliteral">&#39;&amp;nbsp;&#39;</span>;
<a name="l22435"></a>22435                         }
<a name="l22436"></a>22436                         $tagtype = $dom[$key][<span class="stringliteral">&#39;value&#39;</span>];
<a name="l22437"></a>22437                         $parentid = $key;
<a name="l22438"></a>22438                         <span class="keywordflow">while</span> (($key &lt; $maxel) AND (!(($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>]) AND (!$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == $tagtype) AND ($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] == $parentid)))) {
<a name="l22439"></a>22439                             <span class="comment">// move $key index forward</span>
<a name="l22440"></a>22440                             ++$key;
<a name="l22441"></a>22441                         }
<a name="l22442"></a>22442                         <span class="keywordflow">if</span> (!isset($dom[$trid][<span class="stringliteral">&#39;startpage&#39;</span>])) {
<a name="l22443"></a>22443                             $dom[$trid][<span class="stringliteral">&#39;startpage&#39;</span>] = $this-&gt;page;
<a name="l22444"></a>22444                         } <span class="keywordflow">else</span> {
<a name="l22445"></a>22445                             $this-&gt;setPage($dom[$trid][<span class="stringliteral">&#39;startpage&#39;</span>]);
<a name="l22446"></a>22446                         }
<a name="l22447"></a>22447                         <span class="keywordflow">if</span> (!isset($dom[$trid][<span class="stringliteral">&#39;startcolumn&#39;</span>])) {
<a name="l22448"></a>22448                             $dom[$trid][<span class="stringliteral">&#39;startcolumn&#39;</span>] = $this-&gt;current_column;
<a name="l22449"></a>22449                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;current_column != $dom[$trid][<span class="stringliteral">&#39;startcolumn&#39;</span>]) {
<a name="l22450"></a>22450                             $tmpx = $this-&gt;x;
<a name="l22451"></a>22451                             $this-&gt;selectColumn($dom[$trid][<span class="stringliteral">&#39;startcolumn&#39;</span>]);
<a name="l22452"></a>22452                             $this-&gt;x = $tmpx;
<a name="l22453"></a>22453                         }
<a name="l22454"></a>22454                         <span class="keywordflow">if</span> (!isset($dom[$trid][<span class="stringliteral">&#39;starty&#39;</span>])) {
<a name="l22455"></a>22455                             $dom[$trid][<span class="stringliteral">&#39;starty&#39;</span>] = $this-&gt;y;
<a name="l22456"></a>22456                         } <span class="keywordflow">else</span> {
<a name="l22457"></a>22457                             $this-&gt;y = $dom[$trid][<span class="stringliteral">&#39;starty&#39;</span>];
<a name="l22458"></a>22458                         }
<a name="l22459"></a>22459                         <span class="keywordflow">if</span> (!isset($dom[$trid][<span class="stringliteral">&#39;startx&#39;</span>])) {
<a name="l22460"></a>22460                             $dom[$trid][<span class="stringliteral">&#39;startx&#39;</span>] = $this-&gt;x;
<a name="l22461"></a>22461                             $this-&gt;x += $cellspacingx;
<a name="l22462"></a>22462                         } <span class="keywordflow">else</span> {
<a name="l22463"></a>22463                             $this-&gt;x += ($cellspacingx / 2);
<a name="l22464"></a>22464                         }
<a name="l22465"></a>22465                         <span class="keywordflow">if</span> (isset($dom[$parentid][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;rowspan&#39;</span>])) {
<a name="l22466"></a>22466                             $rowspan = intval($dom[$parentid][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;rowspan&#39;</span>]);
<a name="l22467"></a>22467                         } <span class="keywordflow">else</span> {
<a name="l22468"></a>22468                             $rowspan = 1;
<a name="l22469"></a>22469                         }
<a name="l22470"></a>22470                         <span class="comment">// skip row-spanned cells started on the previous rows</span>
<a name="l22471"></a>22471                         <span class="keywordflow">if</span> (isset($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>])) {
<a name="l22472"></a>22472                             $rsk = 0;
<a name="l22473"></a>22473                             $rskmax = count($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>]);
<a name="l22474"></a>22474                             <span class="keywordflow">while</span> ($rsk &lt; $rskmax) {
<a name="l22475"></a>22475                                 $trwsp = $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$rsk];
<a name="l22476"></a>22476                                 $rsstartx = $trwsp[<span class="stringliteral">&#39;startx&#39;</span>];
<a name="l22477"></a>22477                                 $rsendx = $trwsp[<span class="stringliteral">&#39;endx&#39;</span>];
<a name="l22478"></a>22478                                 <span class="comment">// account for margin changes</span>
<a name="l22479"></a>22479                                 <span class="keywordflow">if</span> ($trwsp[<span class="stringliteral">&#39;startpage&#39;</span>] &lt; $this-&gt;page) {
<a name="l22480"></a>22480                                     <span class="keywordflow">if</span> (($this-&gt;rtl) AND ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$trwsp[<span class="stringliteral">&#39;startpage&#39;</span>]][<span class="stringliteral">&#39;orm&#39;</span>])) {
<a name="l22481"></a>22481                                         $dl = ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$trwsp[<span class="stringliteral">&#39;startpage&#39;</span>]][<span class="stringliteral">&#39;orm&#39;</span>]);
<a name="l22482"></a>22482                                         $rsstartx -= $dl;
<a name="l22483"></a>22483                                         $rsendx -= $dl;
<a name="l22484"></a>22484                                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((!$this-&gt;rtl) AND ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$trwsp[<span class="stringliteral">&#39;startpage&#39;</span>]][<span class="stringliteral">&#39;olm&#39;</span>])) {
<a name="l22485"></a>22485                                         $dl = ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$trwsp[<span class="stringliteral">&#39;startpage&#39;</span>]][<span class="stringliteral">&#39;olm&#39;</span>]);
<a name="l22486"></a>22486                                         $rsstartx += $dl;
<a name="l22487"></a>22487                                         $rsendx += $dl;
<a name="l22488"></a>22488                                     }
<a name="l22489"></a>22489                                 }
<a name="l22490"></a>22490                                 <span class="keywordflow">if</span> (($trwsp[<span class="stringliteral">&#39;rowspan&#39;</span>] &gt; 0)
<a name="l22491"></a>22491                                     AND ($rsstartx &gt; ($this-&gt;x - $cellspacing[<span class="charliteral">&#39;H&#39;</span>] - $current_cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;feps))
<a name="l22492"></a>22492                                     AND ($rsstartx &lt; ($this-&gt;x + $cellspacing[<span class="charliteral">&#39;H&#39;</span>] + $current_cell_padding[<span class="charliteral">&#39;R&#39;</span>] + $this-&gt;feps))
<a name="l22493"></a>22493                                     AND (($trwsp[<span class="stringliteral">&#39;starty&#39;</span>] &lt; ($this-&gt;y - $this-&gt;feps)) OR ($trwsp[<span class="stringliteral">&#39;startpage&#39;</span>] &lt; $this-&gt;page) OR ($trwsp[<span class="stringliteral">&#39;startcolumn&#39;</span>] &lt; $this-&gt;current_column))) {
<a name="l22494"></a>22494                                     <span class="comment">// set the starting X position of the current cell</span>
<a name="l22495"></a>22495                                     $this-&gt;x = $rsendx + $cellspacingx;
<a name="l22496"></a>22496                                     <span class="comment">// increment column indicator</span>
<a name="l22497"></a>22497                                     $colid += $trwsp[<span class="stringliteral">&#39;colspan&#39;</span>];
<a name="l22498"></a>22498                                     <span class="keywordflow">if</span> (($trwsp[<span class="stringliteral">&#39;rowspan&#39;</span>] == 1)
<a name="l22499"></a>22499                                         AND (isset($dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>]))
<a name="l22500"></a>22500                                         AND (isset($dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]))
<a name="l22501"></a>22501                                         AND (isset($dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>]))
<a name="l22502"></a>22502                                         AND ($trwsp[<span class="stringliteral">&#39;endpage&#39;</span>] == $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>])
<a name="l22503"></a>22503                                         AND ($trwsp[<span class="stringliteral">&#39;endcolumn&#39;</span>] == $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {
<a name="l22504"></a>22504                                         <span class="comment">// set ending Y position for row</span>
<a name="l22505"></a>22505                                         $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$rsk][<span class="stringliteral">&#39;endy&#39;</span>] = max($dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>], $trwsp[<span class="stringliteral">&#39;endy&#39;</span>]);
<a name="l22506"></a>22506                                         $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$rsk][<span class="stringliteral">&#39;endy&#39;</span>];
<a name="l22507"></a>22507                                     }
<a name="l22508"></a>22508                                     $rsk = 0;
<a name="l22509"></a>22509                                 } <span class="keywordflow">else</span> {
<a name="l22510"></a>22510                                     ++$rsk;
<a name="l22511"></a>22511                                 }
<a name="l22512"></a>22512                             }
<a name="l22513"></a>22513                         }
<a name="l22514"></a>22514                         <span class="keywordflow">if</span> (isset($dom[$parentid][<span class="stringliteral">&#39;width&#39;</span>])) {
<a name="l22515"></a>22515                             <span class="comment">// user specified width</span>
<a name="l22516"></a>22516                             $cellw = $this-&gt;getHTMLUnitToUnits($dom[$parentid][<span class="stringliteral">&#39;width&#39;</span>], $table_columns_width, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l22517"></a>22517                             $tmpcw = ($cellw / $colspan);
<a name="l22518"></a>22518                             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $colspan; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l22519"></a>22519                                 $table_colwidths[($colid + <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>)] = $tmpcw;
<a name="l22520"></a>22520                             }
<a name="l22521"></a>22521                         } <span class="keywordflow">else</span> {
<a name="l22522"></a>22522                             <span class="comment">// inherit column width</span>
<a name="l22523"></a>22523                             $cellw = 0;
<a name="l22524"></a>22524                             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $colspan; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l22525"></a>22525                                 $cellw += $table_colwidths[($colid + <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>)];
<a name="l22526"></a>22526                             }
<a name="l22527"></a>22527                         }
<a name="l22528"></a>22528                         $cellw += (($colspan - 1) * $cellspacing[<span class="charliteral">&#39;H&#39;</span>]);
<a name="l22529"></a>22529                         <span class="comment">// increment column indicator</span>
<a name="l22530"></a>22530                         $colid += $colspan;
<a name="l22531"></a>22531                         <span class="comment">// add rowspan information to table element</span>
<a name="l22532"></a>22532                         <span class="keywordflow">if</span> ($rowspan &gt; 1) {
<a name="l22533"></a>22533                             $trsid = array_push($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>], array(<span class="stringliteral">&#39;trid&#39;</span> =&gt; $trid, <span class="stringliteral">&#39;rowspan&#39;</span> =&gt; $rowspan, <span class="stringliteral">&#39;mrowspan&#39;</span> =&gt; $rowspan, <span class="stringliteral">&#39;colspan&#39;</span> =&gt; $colspan, <span class="stringliteral">&#39;startpage&#39;</span> =&gt; $this-&gt;page, <span class="stringliteral">&#39;startcolumn&#39;</span> =&gt; $this-&gt;current_column, <span class="stringliteral">&#39;startx&#39;</span> =&gt; $this-&gt;x, <span class="stringliteral">&#39;starty&#39;</span> =&gt; $this-&gt;y));
<a name="l22534"></a>22534                         }
<a name="l22535"></a>22535                         $cellid = array_push($dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>], array(<span class="stringliteral">&#39;startx&#39;</span> =&gt; $this-&gt;x));
<a name="l22536"></a>22536                         <span class="keywordflow">if</span> ($rowspan &gt; 1) {
<a name="l22537"></a>22537                             $dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>][($cellid - 1)][<span class="stringliteral">&#39;rowspanid&#39;</span>] = ($trsid - 1);
<a name="l22538"></a>22538                         }
<a name="l22539"></a>22539                         <span class="comment">// push background colors</span>
<a name="l22540"></a>22540                         <span class="keywordflow">if</span> (isset($dom[$parentid][<span class="stringliteral">&#39;bgcolor&#39;</span>]) AND ($dom[$parentid][<span class="stringliteral">&#39;bgcolor&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l22541"></a>22541                             $dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>][($cellid - 1)][<span class="stringliteral">&#39;bgcolor&#39;</span>] = $dom[$parentid][<span class="stringliteral">&#39;bgcolor&#39;</span>];
<a name="l22542"></a>22542                         }
<a name="l22543"></a>22543                         <span class="comment">// store border info</span>
<a name="l22544"></a>22544                         <span class="keywordflow">if</span> (isset($tdborder) AND !empty($tdborder)) {
<a name="l22545"></a>22545                             $dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>][($cellid - 1)][<span class="stringliteral">&#39;border&#39;</span>] = $tdborder;
<a name="l22546"></a>22546                         }
<a name="l22547"></a>22547                         $prevLastH = $this-&gt;lasth;
<a name="l22548"></a>22548                         <span class="comment">// store some info for multicolumn mode</span>
<a name="l22549"></a>22549                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l22550"></a>22550                             $this-&gt;colxshift[<span class="charliteral">&#39;x&#39;</span>] = $this-&gt;w - $this-&gt;x - $this-&gt;rMargin;
<a name="l22551"></a>22551                         } <span class="keywordflow">else</span> {
<a name="l22552"></a>22552                             $this-&gt;colxshift[<span class="charliteral">&#39;x&#39;</span>] = $this-&gt;x - $this-&gt;lMargin;
<a name="l22553"></a>22553                         }
<a name="l22554"></a>22554                         $this-&gt;colxshift[<span class="charliteral">&#39;s&#39;</span>] = $cellspacing;
<a name="l22555"></a>22555                         $this-&gt;colxshift[<span class="charliteral">&#39;p&#39;</span>] = $current_cell_padding;
<a name="l22556"></a>22556                         <span class="comment">// ****** write the cell content ******</span>
<a name="l22557"></a>22557                         $this-&gt;MultiCell($cellw, $cellh, $cell_content, <span class="keyword">false</span>, $lalign, <span class="keyword">false</span>, 2, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, 0, <span class="keyword">true</span>, <span class="keyword">true</span>, 0, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>);
<a name="l22558"></a>22558                         <span class="comment">// restore some values</span>
<a name="l22559"></a>22559                         $this-&gt;colxshift = array(<span class="charliteral">&#39;x&#39;</span> =&gt; 0, <span class="charliteral">&#39;s&#39;</span> =&gt; array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0), <span class="charliteral">&#39;p&#39;</span> =&gt; array(<span class="charliteral">&#39;L&#39;</span> =&gt; 0, <span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0));
<a name="l22560"></a>22560                         $this-&gt;lasth = $prevLastH;
<a name="l22561"></a>22561                         $this-&gt;cell_padding = $old_cell_padding;
<a name="l22562"></a>22562                         $dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>][($cellid - 1)][<span class="stringliteral">&#39;endx&#39;</span>] = $this-&gt;x;
<a name="l22563"></a>22563                         <span class="comment">// update the end of row position</span>
<a name="l22564"></a>22564                         <span class="keywordflow">if</span> ($rowspan &lt;= 1) {
<a name="l22565"></a>22565                             <span class="keywordflow">if</span> (isset($dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>])) {
<a name="l22566"></a>22566                                 <span class="keywordflow">if</span> (($this-&gt;page == $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]) AND ($this-&gt;current_column == $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {
<a name="l22567"></a>22567                                     $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = max($this-&gt;y, $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>]);
<a name="l22568"></a>22568                                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($this-&gt;page &gt; $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]) OR ($this-&gt;current_column &gt; $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {
<a name="l22569"></a>22569                                     $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = $this-&gt;y;
<a name="l22570"></a>22570                                 }
<a name="l22571"></a>22571                             } <span class="keywordflow">else</span> {
<a name="l22572"></a>22572                                 $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = $this-&gt;y;
<a name="l22573"></a>22573                             }
<a name="l22574"></a>22574                             <span class="keywordflow">if</span> (isset($dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>])) {
<a name="l22575"></a>22575                                 $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>] = max($this-&gt;page, $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]);
<a name="l22576"></a>22576                             } <span class="keywordflow">else</span> {
<a name="l22577"></a>22577                                 $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>] = $this-&gt;page;
<a name="l22578"></a>22578                             }
<a name="l22579"></a>22579                             <span class="keywordflow">if</span> (isset($dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {
<a name="l22580"></a>22580                                 $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>] = max($this-&gt;current_column, $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>]);
<a name="l22581"></a>22581                             } <span class="keywordflow">else</span> {
<a name="l22582"></a>22582                                 $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>] = $this-&gt;current_column;
<a name="l22583"></a>22583                             }
<a name="l22584"></a>22584                         } <span class="keywordflow">else</span> {
<a name="l22585"></a>22585                             <span class="comment">// account for row-spanned cells</span>
<a name="l22586"></a>22586                             $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][($trsid - 1)][<span class="stringliteral">&#39;endx&#39;</span>] = $this-&gt;x;
<a name="l22587"></a>22587                             $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][($trsid - 1)][<span class="stringliteral">&#39;endy&#39;</span>] = $this-&gt;y;
<a name="l22588"></a>22588                             $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][($trsid - 1)][<span class="stringliteral">&#39;endpage&#39;</span>] = $this-&gt;page;
<a name="l22589"></a>22589                             $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][($trsid - 1)][<span class="stringliteral">&#39;endcolumn&#39;</span>] = $this-&gt;current_column;
<a name="l22590"></a>22590                         }
<a name="l22591"></a>22591                         <span class="keywordflow">if</span> (isset($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>])) {
<a name="l22592"></a>22592                             <span class="comment">// update endy and endpage on rowspanned cells</span>
<a name="l22593"></a>22593                             <span class="keywordflow">foreach</span> ($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>] as $k =&gt; $trwsp) {
<a name="l22594"></a>22594                                 <span class="keywordflow">if</span> ($trwsp[<span class="stringliteral">&#39;rowspan&#39;</span>] &gt; 0) {
<a name="l22595"></a>22595                                     <span class="keywordflow">if</span> (isset($dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>])) {
<a name="l22596"></a>22596                                         <span class="keywordflow">if</span> (($trwsp[<span class="stringliteral">&#39;endpage&#39;</span>] == $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]) AND ($trwsp[<span class="stringliteral">&#39;endcolumn&#39;</span>] == $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {
<a name="l22597"></a>22597                                             $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$k][<span class="stringliteral">&#39;endy&#39;</span>] = max($dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>], $trwsp[<span class="stringliteral">&#39;endy&#39;</span>]);
<a name="l22598"></a>22598                                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($trwsp[<span class="stringliteral">&#39;endpage&#39;</span>] &lt; $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]) OR ($trwsp[<span class="stringliteral">&#39;endcolumn&#39;</span>] &lt; $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {
<a name="l22599"></a>22599                                             $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$k][<span class="stringliteral">&#39;endy&#39;</span>] = $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>];
<a name="l22600"></a>22600                                             $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$k][<span class="stringliteral">&#39;endpage&#39;</span>] = $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>];
<a name="l22601"></a>22601                                             $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$k][<span class="stringliteral">&#39;endcolumn&#39;</span>] = $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>];
<a name="l22602"></a>22602                                         } <span class="keywordflow">else</span> {
<a name="l22603"></a>22603                                             $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = $this-&gt;pagedim[$dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]][<span class="stringliteral">&#39;hk&#39;</span>] - $this-&gt;pagedim[$dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]][<span class="stringliteral">&#39;bm&#39;</span>];
<a name="l22604"></a>22604                                         }
<a name="l22605"></a>22605                                     }
<a name="l22606"></a>22606                                 }
<a name="l22607"></a>22607                             }
<a name="l22608"></a>22608                         }
<a name="l22609"></a>22609                         $this-&gt;x += ($cellspacingx / 2);
<a name="l22610"></a>22610                     } <span class="keywordflow">else</span> {
<a name="l22611"></a>22611                         <span class="comment">// opening tag (or self-closing tag)</span>
<a name="l22612"></a>22612                         <span class="keywordflow">if</span> (!isset($opentagpos)) {
<a name="l22613"></a>22613                             <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l22614"></a>22614                                 <span class="comment">// we are inside an XObject template</span>
<a name="l22615"></a>22615                                 $opentagpos = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);
<a name="l22616"></a>22616                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (!$this-&gt;InFooter) {
<a name="l22617"></a>22617                                 <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$this-&gt;page])) {
<a name="l22618"></a>22618                                     $this-&gt;footerpos[$this-&gt;page] = $this-&gt;pagelen[$this-&gt;page] - $this-&gt;footerlen[$this-&gt;page];
<a name="l22619"></a>22619                                 } <span class="keywordflow">else</span> {
<a name="l22620"></a>22620                                     $this-&gt;footerpos[$this-&gt;page] = $this-&gt;pagelen[$this-&gt;page];
<a name="l22621"></a>22621                                 }
<a name="l22622"></a>22622                                 $opentagpos = $this-&gt;footerpos[$this-&gt;page];
<a name="l22623"></a>22623                             }
<a name="l22624"></a>22624                         }
<a name="l22625"></a>22625                         $dom = $this-&gt;openHTMLTagHandler($dom, $key, $cell);
<a name="l22626"></a>22626                     }
<a name="l22627"></a>22627                 } <span class="keywordflow">else</span> { <span class="comment">// closing tag</span>
<a name="l22628"></a>22628                     $prev_numpages = $this-&gt;numpages;
<a name="l22629"></a>22629                     $old_bordermrk = $this-&gt;bordermrk[$this-&gt;page];
<a name="l22630"></a>22630                     $dom = $this-&gt;closeHTMLTagHandler($dom, $key, $cell, $maxbottomliney);
<a name="l22631"></a>22631                     <span class="keywordflow">if</span> ($this-&gt;bordermrk[$this-&gt;page] &gt; $old_bordermrk) {
<a name="l22632"></a>22632                         $startlinepos += ($this-&gt;bordermrk[$this-&gt;page] - $old_bordermrk);
<a name="l22633"></a>22633                     }
<a name="l22634"></a>22634                     <span class="keywordflow">if</span> ($prev_numpages &gt; $this-&gt;numpages) {
<a name="l22635"></a>22635                         $startlinepage = $this-&gt;page;
<a name="l22636"></a>22636                     }
<a name="l22637"></a>22637                 }
<a name="l22638"></a>22638             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (strlen($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]) &gt; 0) {
<a name="l22639"></a>22639                 <span class="comment">// print list-item</span>
<a name="l22640"></a>22640                 <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;lispacer) AND ($this-&gt;lispacer != <span class="charliteral">&#39;^&#39;</span>)) {
<a name="l22641"></a>22641                     $this-&gt;SetFont($pfontname, $pfontstyle, $pfontsize);
<a name="l22642"></a>22642                     $this-&gt;resetLastH();
<a name="l22643"></a>22643                     $minstartliney = $this-&gt;y;
<a name="l22644"></a>22644                     $maxbottomliney = ($startliney + ($this-&gt;FontSize * $this-&gt;cell_height_ratio));
<a name="l22645"></a>22645                     $this-&gt;putHtmlListBullet($this-&gt;listnum, $this-&gt;lispacer, $pfontsize);
<a name="l22646"></a>22646                     $this-&gt;SetFont($curfontname, $curfontstyle, $curfontsize);
<a name="l22647"></a>22647                     $this-&gt;resetLastH();
<a name="l22648"></a>22648                     <span class="keywordflow">if</span> (is_numeric($pfontsize) AND ($pfontsize &gt; 0) AND is_numeric($curfontsize) AND ($curfontsize &gt; 0) AND ($pfontsize != $curfontsize)) {
<a name="l22649"></a>22649                         $pfontascent = $this-&gt;getFontAscent($pfontname, $pfontstyle, $pfontsize);
<a name="l22650"></a>22650                         $pfontdescent = $this-&gt;getFontDescent($pfontname, $pfontstyle, $pfontsize);
<a name="l22651"></a>22651                         $this-&gt;y += ((($pfontsize - $curfontsize) * $this-&gt;cell_height_ratio / $this-&gt;k) + $pfontascent - $curfontascent - $pfontdescent + $curfontdescent) / 2;
<a name="l22652"></a>22652                         $minstartliney = min($this-&gt;y, $minstartliney);
<a name="l22653"></a>22653                         $maxbottomliney = max(($this-&gt;y + (($pfontsize * $this-&gt;cell_height_ratio) / $this-&gt;k)), $maxbottomliney);
<a name="l22654"></a>22654                     }
<a name="l22655"></a>22655                 }
<a name="l22656"></a>22656                 <span class="comment">// text</span>
<a name="l22657"></a>22657                 $this-&gt;htmlvspace = 0;
<a name="l22658"></a>22658                 <span class="keywordflow">if</span> ((!$this-&gt;premode) AND $this-&gt;isRTLTextDir()) {
<a name="l22659"></a>22659                     <span class="comment">// reverse spaces order</span>
<a name="l22660"></a>22660                     $lsp = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// left spaces</span>
<a name="l22661"></a>22661                     $rsp = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// right spaces</span>
<a name="l22662"></a>22662                     <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^(&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+)/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $matches)) {
<a name="l22663"></a>22663                         $lsp = $matches[1];
<a name="l22664"></a>22664                     }
<a name="l22665"></a>22665                     <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/(&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+)$/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $matches)) {
<a name="l22666"></a>22666                         $rsp = $matches[1];
<a name="l22667"></a>22667                     }
<a name="l22668"></a>22668                     $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $rsp.$this-&gt;stringTrim($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]).$lsp;
<a name="l22669"></a>22669                 }
<a name="l22670"></a>22670                 <span class="keywordflow">if</span> ($newline) {
<a name="l22671"></a>22671                     <span class="keywordflow">if</span> (!$this-&gt;premode) {
<a name="l22672"></a>22672                         $prelen = strlen($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l22673"></a>22673                         <span class="keywordflow">if</span> ($this-&gt;isRTLTextDir()) {
<a name="l22674"></a>22674                             <span class="comment">// right trim except non-breaking space</span>
<a name="l22675"></a>22675                             $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $this-&gt;stringRightTrim($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l22676"></a>22676                         } <span class="keywordflow">else</span> {
<a name="l22677"></a>22677                             <span class="comment">// left trim except non-breaking space</span>
<a name="l22678"></a>22678                             $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $this-&gt;stringLeftTrim($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l22679"></a>22679                         }
<a name="l22680"></a>22680                         $postlen = strlen($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l22681"></a>22681                         <span class="keywordflow">if</span> (($postlen == 0) AND ($prelen &gt; 0)) {
<a name="l22682"></a>22682                             $dom[$key][<span class="stringliteral">&#39;trimmed_space&#39;</span>] = <span class="keyword">true</span>;
<a name="l22683"></a>22683                         }
<a name="l22684"></a>22684                     }
<a name="l22685"></a>22685                     $newline = <span class="keyword">false</span>;
<a name="l22686"></a>22686                     $firstblock = <span class="keyword">true</span>;
<a name="l22687"></a>22687                 } <span class="keywordflow">else</span> {
<a name="l22688"></a>22688                     $firstblock = <span class="keyword">false</span>;
<a name="l22689"></a>22689                     <span class="comment">// replace empty multiple spaces string with a single space</span>
<a name="l22690"></a>22690                     $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = preg_replace(<span class="stringliteral">&#39;/^&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+$/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], chr(32), $dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l22691"></a>22691                 }
<a name="l22692"></a>22692                 $strrest = <span class="stringliteral">&#39;&#39;</span>;
<a name="l22693"></a>22693                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l22694"></a>22694                     $this-&gt;x -= $this-&gt;textindent;
<a name="l22695"></a>22695                 } <span class="keywordflow">else</span> {
<a name="l22696"></a>22696                     $this-&gt;x += $this-&gt;textindent;
<a name="l22697"></a>22697                 }
<a name="l22698"></a>22698                 <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;trimmed_space&#39;</span>]) OR !$dom[$key][<span class="stringliteral">&#39;trimmed_space&#39;</span>]) {
<a name="l22699"></a>22699                     $strlinelen = $this-&gt;GetStringWidth($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l22700"></a>22700                     <span class="keywordflow">if</span> (!empty($this-&gt;HREF) AND (isset($this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>]))) {
<a name="l22701"></a>22701                         <span class="comment">// HTML &lt;a&gt; Link</span>
<a name="l22702"></a>22702                         $hrefcolor = <span class="stringliteral">&#39;&#39;</span>;
<a name="l22703"></a>22703                         <span class="keywordflow">if</span> (isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fgcolor&#39;</span>]) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fgcolor&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l22704"></a>22704                             $hrefcolor = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fgcolor&#39;</span>];
<a name="l22705"></a>22705                         }
<a name="l22706"></a>22706                         $hrefstyle = -1;
<a name="l22707"></a>22707                         <span class="keywordflow">if</span> (isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontstyle&#39;</span>]) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontstyle&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l22708"></a>22708                             $hrefstyle = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontstyle&#39;</span>];
<a name="l22709"></a>22709                         }
<a name="l22710"></a>22710                         $strrest = $this-&gt;addHtmlLink($this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>], $dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $wfill, <span class="keyword">true</span>, $hrefcolor, $hrefstyle, <span class="keyword">true</span>);
<a name="l22711"></a>22711                     } <span class="keywordflow">else</span> {
<a name="l22712"></a>22712                         $wadj = 0; <span class="comment">// space to leave for block continuity</span>
<a name="l22713"></a>22713                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l22714"></a>22714                             $cwa = $this-&gt;x - $this-&gt;lMargin;
<a name="l22715"></a>22715                         } <span class="keywordflow">else</span> {
<a name="l22716"></a>22716                             $cwa = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;
<a name="l22717"></a>22717                         }
<a name="l22718"></a>22718                         <span class="keywordflow">if</span> (($strlinelen &lt; $cwa) AND (isset($dom[($key + 1)])) AND ($dom[($key + 1)][<span class="stringliteral">&#39;tag&#39;</span>]) AND (!$dom[($key + 1)][<span class="stringliteral">&#39;block&#39;</span>])) {
<a name="l22719"></a>22719                             <span class="comment">// check the next text blocks for continuity</span>
<a name="l22720"></a>22720                             $nkey = ($key + 1);
<a name="l22721"></a>22721                             $write_block = <span class="keyword">true</span>;
<a name="l22722"></a>22722                             $same_textdir = <span class="keyword">true</span>;
<a name="l22723"></a>22723                             $tmp_fontname = $this-&gt;FontFamily;
<a name="l22724"></a>22724                             $tmp_fontstyle = $this-&gt;FontStyle;
<a name="l22725"></a>22725                             $tmp_fontsize = $this-&gt;FontSizePt;
<a name="l22726"></a>22726                             <span class="keywordflow">while</span> ($write_block AND isset($dom[$nkey])) {
<a name="l22727"></a>22727                                 <span class="keywordflow">if</span> ($dom[$nkey][<span class="stringliteral">&#39;tag&#39;</span>]) {
<a name="l22728"></a>22728                                     <span class="keywordflow">if</span> ($dom[$nkey][<span class="stringliteral">&#39;block&#39;</span>]) {
<a name="l22729"></a>22729                                         <span class="comment">// end of block</span>
<a name="l22730"></a>22730                                         $write_block = <span class="keyword">false</span>;
<a name="l22731"></a>22731                                     }
<a name="l22732"></a>22732                                     $tmp_fontname = isset($dom[$nkey][<span class="stringliteral">&#39;fontname&#39;</span>]) ? $dom[$nkey][<span class="stringliteral">&#39;fontname&#39;</span>] : $this-&gt;FontFamily;
<a name="l22733"></a>22733                                     $tmp_fontstyle = isset($dom[$nkey][<span class="stringliteral">&#39;fontstyle&#39;</span>]) ? $dom[$nkey][<span class="stringliteral">&#39;fontstyle&#39;</span>] : $this-&gt;FontStyle;
<a name="l22734"></a>22734                                     $tmp_fontsize = isset($dom[$nkey][<span class="stringliteral">&#39;fontsize&#39;</span>]) ? $dom[$nkey][<span class="stringliteral">&#39;fontsize&#39;</span>] : $this-&gt;FontSizePt;
<a name="l22735"></a>22735                                     $same_textdir = ($dom[$nkey][<span class="stringliteral">&#39;dir&#39;</span>] == $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>]);
<a name="l22736"></a>22736                                 } <span class="keywordflow">else</span> {
<a name="l22737"></a>22737                                     $nextstr = preg_split(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $dom[$nkey][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l22738"></a>22738                                     <span class="keywordflow">if</span> (isset($nextstr[0]) AND $same_textdir) {
<a name="l22739"></a>22739                                         $wadj += $this-&gt;GetStringWidth($nextstr[0], $tmp_fontname, $tmp_fontstyle, $tmp_fontsize);
<a name="l22740"></a>22740                                     }
<a name="l22741"></a>22741                                     <span class="keywordflow">if</span> (isset($nextstr[1])) {
<a name="l22742"></a>22742                                         $write_block = <span class="keyword">false</span>;
<a name="l22743"></a>22743                                     }
<a name="l22744"></a>22744                                 }
<a name="l22745"></a>22745                                 ++$nkey;
<a name="l22746"></a>22746                             }
<a name="l22747"></a>22747                         }
<a name="l22748"></a>22748                         <span class="keywordflow">if</span> (($wadj &gt; 0) AND (($strlinelen + $wadj) &gt;= $cwa)) {
<a name="l22749"></a>22749                             $wadj = 0;
<a name="l22750"></a>22750                             $nextstr = preg_split(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l22751"></a>22751                             $numblks = count($nextstr);
<a name="l22752"></a>22752                             <span class="keywordflow">if</span> ($numblks &gt; 1) {
<a name="l22753"></a>22753                                 <span class="comment">// try to split on blank spaces</span>
<a name="l22754"></a>22754                                 $wadj = ($cwa - $strlinelen + $this-&gt;GetStringWidth($nextstr[($numblks - 1)]));
<a name="l22755"></a>22755                             }
<a name="l22756"></a>22756                         }
<a name="l22757"></a>22757                         <span class="comment">// check for reversed text direction</span>
<a name="l22758"></a>22758                         <span class="keywordflow">if</span> (($wadj &gt; 0) AND (($this-&gt;rtl AND ($this-&gt;tmprtl === <span class="charliteral">&#39;L&#39;</span>)) OR (!$this-&gt;rtl AND ($this-&gt;tmprtl === <span class="charliteral">&#39;R&#39;</span>)))) {
<a name="l22759"></a>22759                             <span class="comment">// LTR text on RTL direction or RTL text on LTR direction</span>
<a name="l22760"></a>22760                             $reverse_dir = <span class="keyword">true</span>;
<a name="l22761"></a>22761                             $this-&gt;rtl = !$this-&gt;rtl;
<a name="l22762"></a>22762                             $revshift = ($strlinelen + $wadj + 0.000001); <span class="comment">// add little quantity for rounding problems</span>
<a name="l22763"></a>22763                             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l22764"></a>22764                                 $this-&gt;x += $revshift;
<a name="l22765"></a>22765                             } <span class="keywordflow">else</span> {
<a name="l22766"></a>22766                                 $this-&gt;x -= $revshift;
<a name="l22767"></a>22767                             }
<a name="l22768"></a>22768                             $xws = $this-&gt;x;
<a name="l22769"></a>22769                         }
<a name="l22770"></a>22770                         <span class="comment">// ****** write only until the end of the line and get the rest ******</span>
<a name="l22771"></a>22771                         $strrest = $this-&gt;Write($this-&gt;lasth, $dom[$key][<span class="stringliteral">&#39;value&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, $wfill, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 0, <span class="keyword">true</span>, $firstblock, 0, $wadj);
<a name="l22772"></a>22772                         <span class="comment">// restore default direction</span>
<a name="l22773"></a>22773                         <span class="keywordflow">if</span> ($reverse_dir AND ($wadj == 0)) {
<a name="l22774"></a>22774                             $this-&gt;x = $xws;
<a name="l22775"></a>22775                             $this-&gt;rtl = !$this-&gt;rtl;
<a name="l22776"></a>22776                             $reverse_dir = <span class="keyword">false</span>;
<a name="l22777"></a>22777                         }
<a name="l22778"></a>22778                     }
<a name="l22779"></a>22779                 }
<a name="l22780"></a>22780                 $this-&gt;textindent = 0;
<a name="l22781"></a>22781                 <span class="keywordflow">if</span> (strlen($strrest) &gt; 0) {
<a name="l22782"></a>22782                     <span class="comment">// store the remaining string on the previous $key position</span>
<a name="l22783"></a>22783                     $this-&gt;newline = <span class="keyword">true</span>;
<a name="l22784"></a>22784                     <span class="keywordflow">if</span> ($strrest == $dom[$key][<span class="stringliteral">&#39;value&#39;</span>]) {
<a name="l22785"></a>22785                         <span class="comment">// used to avoid infinite loop</span>
<a name="l22786"></a>22786                         ++$loop;
<a name="l22787"></a>22787                     } <span class="keywordflow">else</span> {
<a name="l22788"></a>22788                         $loop = 0;
<a name="l22789"></a>22789                     }
<a name="l22790"></a>22790                     $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $strrest;
<a name="l22791"></a>22791                     <span class="keywordflow">if</span> ($cell) {
<a name="l22792"></a>22792                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l22793"></a>22793                             $this-&gt;x -= $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];
<a name="l22794"></a>22794                         } <span class="keywordflow">else</span> {
<a name="l22795"></a>22795                             $this-&gt;x += $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];
<a name="l22796"></a>22796                         }
<a name="l22797"></a>22797                     }
<a name="l22798"></a>22798                     <span class="keywordflow">if</span> ($loop &lt; 3) {
<a name="l22799"></a>22799                         --$key;
<a name="l22800"></a>22800                     }
<a name="l22801"></a>22801                 } <span class="keywordflow">else</span> {
<a name="l22802"></a>22802                     $loop = 0;
<a name="l22803"></a>22803                 }
<a name="l22804"></a>22804             }
<a name="l22805"></a>22805             ++$key;
<a name="l22806"></a>22806             <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>]) AND $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND (!isset($dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) OR !$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) AND isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>]) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l22807"></a>22807                 <span class="comment">// check if we are on a new page or on a new column</span>
<a name="l22808"></a>22808                 <span class="keywordflow">if</span> ((!$undo) AND (($this-&gt;y &lt; $this-&gt;start_transaction_y) OR (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;endy&#39;</span>] &lt; $this-&gt;start_transaction_y)))) {
<a name="l22809"></a>22809                     <span class="comment">// we are on a new page or on a new column and the total object height is less than the available vertical space.</span>
<a name="l22810"></a>22810                     <span class="comment">// restore previous object</span>
<a name="l22811"></a>22811                     $this-&gt;rollbackTransaction(<span class="keyword">true</span>);
<a name="l22812"></a>22812                     <span class="comment">// restore previous values</span>
<a name="l22813"></a>22813                     <span class="keywordflow">foreach</span> ($this_method_vars as $vkey =&gt; $vval) {
<a name="l22814"></a>22814                         $$vkey = $vval;
<a name="l22815"></a>22815                     }
<a name="l22816"></a>22816                     <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l22817"></a>22817                     $pre_y = $this-&gt;y;
<a name="l22818"></a>22818                     <span class="keywordflow">if</span> ((!$this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1)) AND ($this-&gt;y &lt; $pre_y)) {
<a name="l22819"></a>22819                         $startliney = $this-&gt;y;
<a name="l22820"></a>22820                     }
<a name="l22821"></a>22821                     $undo = <span class="keyword">true</span>; <span class="comment">// avoid infinite loop</span>
<a name="l22822"></a>22822                 } <span class="keywordflow">else</span> {
<a name="l22823"></a>22823                     $undo = <span class="keyword">false</span>;
<a name="l22824"></a>22824                 }
<a name="l22825"></a>22825             }
<a name="l22826"></a>22826         } <span class="comment">// end for each $key</span>
<a name="l22827"></a>22827         <span class="comment">// align the last line</span>
<a name="l22828"></a>22828         <span class="keywordflow">if</span> (isset($startlinex)) {
<a name="l22829"></a>22829             $yshift = ($minstartliney - $startliney);
<a name="l22830"></a>22830             <span class="keywordflow">if</span> (($yshift &gt; 0) OR ($this-&gt;page &gt; $startlinepage)) {
<a name="l22831"></a>22831                 $yshift = 0;
<a name="l22832"></a>22832             }
<a name="l22833"></a>22833             $t_x = 0;
<a name="l22834"></a>22834             <span class="comment">// the last line must be shifted to be aligned as requested</span>
<a name="l22835"></a>22835             $linew = abs($this-&gt;endlinex - $startlinex);
<a name="l22836"></a>22836             <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l22837"></a>22837                 <span class="comment">// we are inside an XObject template</span>
<a name="l22838"></a>22838                 $pstart = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], 0, $startlinepos);
<a name="l22839"></a>22839                 <span class="keywordflow">if</span> (isset($opentagpos)) {
<a name="l22840"></a>22840                     $midpos = $opentagpos;
<a name="l22841"></a>22841                 } <span class="keywordflow">else</span> {
<a name="l22842"></a>22842                     $midpos = 0;
<a name="l22843"></a>22843                 }
<a name="l22844"></a>22844                 <span class="keywordflow">if</span> ($midpos &gt; 0) {
<a name="l22845"></a>22845                     $pmid = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $startlinepos, ($midpos - $startlinepos));
<a name="l22846"></a>22846                     $pend = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $midpos);
<a name="l22847"></a>22847                 } <span class="keywordflow">else</span> {
<a name="l22848"></a>22848                     $pmid = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $startlinepos);
<a name="l22849"></a>22849                     $pend = <span class="stringliteral">&#39;&#39;</span>;
<a name="l22850"></a>22850                 }
<a name="l22851"></a>22851             } <span class="keywordflow">else</span> {
<a name="l22852"></a>22852                 $pstart = substr($this-&gt;getPageBuffer($startlinepage), 0, $startlinepos);
<a name="l22853"></a>22853                 <span class="keywordflow">if</span> (isset($opentagpos) AND isset($this-&gt;footerlen[$startlinepage]) AND (!$this-&gt;InFooter)) {
<a name="l22854"></a>22854                     $this-&gt;footerpos[$startlinepage] = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];
<a name="l22855"></a>22855                     $midpos = min($opentagpos, $this-&gt;footerpos[$startlinepage]);
<a name="l22856"></a>22856                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($opentagpos)) {
<a name="l22857"></a>22857                     $midpos = $opentagpos;
<a name="l22858"></a>22858                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;footerlen[$startlinepage]) AND (!$this-&gt;InFooter)) {
<a name="l22859"></a>22859                     $this-&gt;footerpos[$startlinepage] = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];
<a name="l22860"></a>22860                     $midpos = $this-&gt;footerpos[$startlinepage];
<a name="l22861"></a>22861                 } <span class="keywordflow">else</span> {
<a name="l22862"></a>22862                     $midpos = 0;
<a name="l22863"></a>22863                 }
<a name="l22864"></a>22864                 <span class="keywordflow">if</span> ($midpos &gt; 0) {
<a name="l22865"></a>22865                     $pmid = substr($this-&gt;getPageBuffer($startlinepage), $startlinepos, ($midpos - $startlinepos));
<a name="l22866"></a>22866                     $pend = substr($this-&gt;getPageBuffer($startlinepage), $midpos);
<a name="l22867"></a>22867                 } <span class="keywordflow">else</span> {
<a name="l22868"></a>22868                     $pmid = substr($this-&gt;getPageBuffer($startlinepage), $startlinepos);
<a name="l22869"></a>22869                     $pend = <span class="stringliteral">&#39;&#39;</span>;
<a name="l22870"></a>22870                 }
<a name="l22871"></a>22871             }
<a name="l22872"></a>22872             <span class="keywordflow">if</span> ((isset($plalign) AND ((($plalign == <span class="charliteral">&#39;C&#39;</span>) OR (($plalign == <span class="charliteral">&#39;R&#39;</span>) AND (!$this-&gt;rtl)) OR (($plalign == <span class="charliteral">&#39;L&#39;</span>) AND ($this-&gt;rtl)))))) {
<a name="l22873"></a>22873                 <span class="comment">// calculate shifting amount</span>
<a name="l22874"></a>22874                 $tw = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l22875"></a>22875                 <span class="keywordflow">if</span> ($this-&gt;lMargin != $prevlMargin) {
<a name="l22876"></a>22876                     $tw += ($prevlMargin - $this-&gt;lMargin);
<a name="l22877"></a>22877                 }
<a name="l22878"></a>22878                 <span class="keywordflow">if</span> ($this-&gt;rMargin != $prevrMargin) {
<a name="l22879"></a>22879                     $tw += ($prevrMargin - $this-&gt;rMargin);
<a name="l22880"></a>22880                 }
<a name="l22881"></a>22881                 $one_space_width = $this-&gt;GetStringWidth(chr(32));
<a name="l22882"></a>22882                 $no = 0; <span class="comment">// number of spaces on a line contained on a single block</span>
<a name="l22883"></a>22883                 <span class="keywordflow">if</span> ($this-&gt;isRTLTextDir()) { <span class="comment">// RTL</span>
<a name="l22884"></a>22884                     <span class="comment">// remove left space if exist</span>
<a name="l22885"></a>22885                     $pos1 = $this-&gt;revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>);
<a name="l22886"></a>22886                     <span class="keywordflow">if</span> ($pos1 &gt; 0) {
<a name="l22887"></a>22887                         $pos1 = intval($pos1);
<a name="l22888"></a>22888                         <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l22889"></a>22889                             $pos2 = intval($this-&gt;revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>.chr(0).chr(32)));
<a name="l22890"></a>22890                             $spacelen = 2;
<a name="l22891"></a>22891                         } <span class="keywordflow">else</span> {
<a name="l22892"></a>22892                             $pos2 = intval($this-&gt;revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>.chr(32)));
<a name="l22893"></a>22893                             $spacelen = 1;
<a name="l22894"></a>22894                         }
<a name="l22895"></a>22895                         <span class="keywordflow">if</span> ($pos1 == $pos2) {
<a name="l22896"></a>22896                             $pmid = substr($pmid, 0, ($pos1 + 2)).substr($pmid, ($pos1 + 2 + $spacelen));
<a name="l22897"></a>22897                             <span class="keywordflow">if</span> (substr($pmid, $pos1, 4) == <span class="stringliteral">&#39;[()]&#39;</span>) {
<a name="l22898"></a>22898                                 $linew -= $one_space_width;
<a name="l22899"></a>22899                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($pos1 == strpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>)) {
<a name="l22900"></a>22900                                 $no = 1;
<a name="l22901"></a>22901                             }
<a name="l22902"></a>22902                         }
<a name="l22903"></a>22903                     }
<a name="l22904"></a>22904                 } <span class="keywordflow">else</span> { <span class="comment">// LTR</span>
<a name="l22905"></a>22905                     <span class="comment">// remove right space if exist</span>
<a name="l22906"></a>22906                     $pos1 = $this-&gt;revstrpos($pmid, <span class="stringliteral">&#39;)]&#39;</span>);
<a name="l22907"></a>22907                     <span class="keywordflow">if</span> ($pos1 &gt; 0) {
<a name="l22908"></a>22908                         $pos1 = intval($pos1);
<a name="l22909"></a>22909                         <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l22910"></a>22910                             $pos2 = intval($this-&gt;revstrpos($pmid, chr(0).chr(32).<span class="stringliteral">&#39;)]&#39;</span>)) + 2;
<a name="l22911"></a>22911                             $spacelen = 2;
<a name="l22912"></a>22912                         } <span class="keywordflow">else</span> {
<a name="l22913"></a>22913                             $pos2 = intval($this-&gt;revstrpos($pmid, chr(32).<span class="stringliteral">&#39;)]&#39;</span>)) + 1;
<a name="l22914"></a>22914                             $spacelen = 1;
<a name="l22915"></a>22915                         }
<a name="l22916"></a>22916                         <span class="keywordflow">if</span> ($pos1 == $pos2) {
<a name="l22917"></a>22917                             $pmid = substr($pmid, 0, ($pos1 - $spacelen)).substr($pmid, $pos1);
<a name="l22918"></a>22918                             $linew -= $one_space_width;
<a name="l22919"></a>22919                         }
<a name="l22920"></a>22920                     }
<a name="l22921"></a>22921                 }
<a name="l22922"></a>22922                 $mdiff = ($tw - $linew);
<a name="l22923"></a>22923                 <span class="keywordflow">if</span> ($plalign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l22924"></a>22924                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l22925"></a>22925                         $t_x = -($mdiff / 2);
<a name="l22926"></a>22926                     } <span class="keywordflow">else</span> {
<a name="l22927"></a>22927                         $t_x = ($mdiff / 2);
<a name="l22928"></a>22928                     }
<a name="l22929"></a>22929                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($plalign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l22930"></a>22930                     <span class="comment">// right alignment on LTR document</span>
<a name="l22931"></a>22931                     $t_x = $mdiff;
<a name="l22932"></a>22932                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($plalign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l22933"></a>22933                     <span class="comment">// left alignment on RTL document</span>
<a name="l22934"></a>22934                     $t_x = -$mdiff;
<a name="l22935"></a>22935                 }
<a name="l22936"></a>22936             } <span class="comment">// end if startlinex</span>
<a name="l22937"></a>22937             <span class="keywordflow">if</span> (($t_x != 0) OR ($yshift &lt; 0)) {
<a name="l22938"></a>22938                 <span class="comment">// shift the line</span>
<a name="l22939"></a>22939                 $trx = sprintf(<span class="stringliteral">&#39;1 0 0 1 %.3F %.3F cm&#39;</span>, ($t_x * $this-&gt;k), ($yshift * $this-&gt;k));
<a name="l22940"></a>22940                 $pstart .= <span class="stringliteral">&quot;\nq\n&quot;</span>.$trx.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nQ\n&quot;</span>;
<a name="l22941"></a>22941                 $endlinepos = strlen($pstart);
<a name="l22942"></a>22942                 <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l22943"></a>22943                     <span class="comment">// we are inside an XObject template</span>
<a name="l22944"></a>22944                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$pend;
<a name="l22945"></a>22945                     <span class="keywordflow">foreach</span> ($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>] as $pak =&gt; $pac) {
<a name="l22946"></a>22946                         <span class="keywordflow">if</span> ($pak &gt;= $pask) {
<a name="l22947"></a>22947                             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;x&#39;</span>] += $t_x;
<a name="l22948"></a>22948                             $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;
<a name="l22949"></a>22949                         }
<a name="l22950"></a>22950                     }
<a name="l22951"></a>22951                 } <span class="keywordflow">else</span> {
<a name="l22952"></a>22952                     $this-&gt;setPageBuffer($startlinepage, $pstart.$pend);
<a name="l22953"></a>22953                     <span class="comment">// shift the annotations and links</span>
<a name="l22954"></a>22954                     <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {
<a name="l22955"></a>22955                         <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$this-&gt;page] as $pak =&gt; $pac) {
<a name="l22956"></a>22956                             <span class="keywordflow">if</span> ($pak &gt;= $pask) {
<a name="l22957"></a>22957                                 $this-&gt;PageAnnots[$this-&gt;page][$pak][<span class="charliteral">&#39;x&#39;</span>] += $t_x;
<a name="l22958"></a>22958                                 $this-&gt;PageAnnots[$this-&gt;page][$pak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;
<a name="l22959"></a>22959                             }
<a name="l22960"></a>22960                         }
<a name="l22961"></a>22961                     }
<a name="l22962"></a>22962                 }
<a name="l22963"></a>22963                 $this-&gt;y -= $yshift;
<a name="l22964"></a>22964                 $yshift = 0;
<a name="l22965"></a>22965             }
<a name="l22966"></a>22966         }
<a name="l22967"></a>22967         <span class="comment">// restore previous values</span>
<a name="l22968"></a>22968         $this-&gt;setGraphicVars($gvars);
<a name="l22969"></a>22969         <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {
<a name="l22970"></a>22970             $this-&gt;selectColumn();
<a name="l22971"></a>22971         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;page &gt; $prevPage) {
<a name="l22972"></a>22972             $this-&gt;lMargin = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>];
<a name="l22973"></a>22973             $this-&gt;rMargin = $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>];
<a name="l22974"></a>22974         }
<a name="l22975"></a>22975         <span class="comment">// restore previous list state</span>
<a name="l22976"></a>22976         $this-&gt;cell_height_ratio = $prev_cell_height_ratio;
<a name="l22977"></a>22977         $this-&gt;listnum = $prev_listnum;
<a name="l22978"></a>22978         $this-&gt;listordered = $prev_listordered;
<a name="l22979"></a>22979         $this-&gt;listcount = $prev_listcount;
<a name="l22980"></a>22980         $this-&gt;lispacer = $prev_lispacer;
<a name="l22981"></a>22981         <span class="keywordflow">if</span> ($ln AND (!($cell AND ($dom[$key-1][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>)))) {
<a name="l22982"></a>22982             $this-&gt;Ln($this-&gt;lasth);
<a name="l22983"></a>22983             <span class="keywordflow">if</span> ($this-&gt;y &lt; $maxbottomliney) {
<a name="l22984"></a>22984                 $this-&gt;y = $maxbottomliney;
<a name="l22985"></a>22985             }
<a name="l22986"></a>22986         }
<a name="l22987"></a>22987         unset($dom);
<a name="l22988"></a>22988     }
<a name="l22989"></a>22989 <span class="comment"></span>
<a name="l22990"></a>22990 <span class="comment">    /**</span>
<a name="l22991"></a>22991 <span class="comment">     * Process opening tags.</span>
<a name="l22992"></a>22992 <span class="comment">     * @param $dom (array) html dom array</span>
<a name="l22993"></a>22993 <span class="comment">     * @param $key (int) current element id</span>
<a name="l22994"></a>22994 <span class="comment">     * @param $cell (boolean) if true add the default left (or right if RTL) padding to each new line (default false).</span>
<a name="l22995"></a>22995 <span class="comment">     * @return $dom array</span>
<a name="l22996"></a>22996 <span class="comment">     * @protected</span>
<a name="l22997"></a>22997 <span class="comment">     */</span>
<a name="l22998"></a><a class="code" href="classTCPDF.html#a1302c5172587123038e0c947b888b6ec">22998</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1302c5172587123038e0c947b888b6ec" title="Process opening tags.">openHTMLTagHandler</a>($dom, $key, $cell) {
<a name="l22999"></a>22999         $tag = $dom[$key];
<a name="l23000"></a>23000         $parent = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])];
<a name="l23001"></a>23001         $firsttag = ($key == 1);
<a name="l23002"></a>23002         <span class="comment">// check for text direction attribute</span>
<a name="l23003"></a>23003         <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;dir&#39;</span>])) {
<a name="l23004"></a>23004             $this-&gt;setTempRTL($tag[<span class="stringliteral">&#39;dir&#39;</span>]);
<a name="l23005"></a>23005         } <span class="keywordflow">else</span> {
<a name="l23006"></a>23006             $this-&gt;tmprtl = <span class="keyword">false</span>;
<a name="l23007"></a>23007         }
<a name="l23008"></a>23008         <span class="keywordflow">if</span> ($tag[<span class="stringliteral">&#39;block&#39;</span>]) {
<a name="l23009"></a>23009             $hbz = 0; <span class="comment">// distance from y to line bottom</span>
<a name="l23010"></a>23010             $hb = 0; <span class="comment">// vertical space between block tags</span>
<a name="l23011"></a>23011             <span class="comment">// calculate vertical space for block tags</span>
<a name="l23012"></a>23012             <span class="keywordflow">if</span> (isset($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;h&#39;</span>]) AND ($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;h&#39;</span>] &gt;= 0)) {
<a name="l23013"></a>23013                 $cur_h = $this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;h&#39;</span>];
<a name="l23014"></a>23014             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($tag[<span class="stringliteral">&#39;fontsize&#39;</span>])) {
<a name="l23015"></a>23015                 $cur_h = ($tag[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k) * $this-&gt;cell_height_ratio;
<a name="l23016"></a>23016             } <span class="keywordflow">else</span> {
<a name="l23017"></a>23017                 $cur_h = $this-&gt;FontSize * $this-&gt;cell_height_ratio;
<a name="l23018"></a>23018             }
<a name="l23019"></a>23019             <span class="keywordflow">if</span> (isset($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;n&#39;</span>])) {
<a name="l23020"></a>23020                 $n = $this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;n&#39;</span>];
<a name="l23021"></a>23021             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (preg_match(<span class="stringliteral">&#39;/[h][0-9]/&#39;</span>, $tag[<span class="stringliteral">&#39;value&#39;</span>]) &gt; 0) {
<a name="l23022"></a>23022                 $n = 0.6;
<a name="l23023"></a>23023             } <span class="keywordflow">else</span> {
<a name="l23024"></a>23024                 $n = 1;
<a name="l23025"></a>23025             }
<a name="l23026"></a>23026             <span class="keywordflow">if</span> ((!isset($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]])) AND (in_array($tag[<span class="stringliteral">&#39;value&#39;</span>], array(<span class="stringliteral">&#39;div&#39;</span>, <span class="stringliteral">&#39;dt&#39;</span>, <span class="stringliteral">&#39;dd&#39;</span>, <span class="stringliteral">&#39;li&#39;</span>, <span class="stringliteral">&#39;br&#39;</span>)))) {
<a name="l23027"></a>23027                 $hb = 0;
<a name="l23028"></a>23028             } <span class="keywordflow">else</span> {
<a name="l23029"></a>23029                 $hb = ($n * $cur_h);
<a name="l23030"></a>23030             }
<a name="l23031"></a>23031             <span class="keywordflow">if</span> (($this-&gt;htmlvspace &lt;= 0) AND ($n &gt; 0)) {
<a name="l23032"></a>23032                 <span class="keywordflow">if</span> (isset($parent[<span class="stringliteral">&#39;fontsize&#39;</span>])) {
<a name="l23033"></a>23033                     $hbz = (($parent[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k) * $this-&gt;cell_height_ratio);
<a name="l23034"></a>23034                 } <span class="keywordflow">else</span> {
<a name="l23035"></a>23035                     $hbz = $this-&gt;FontSize * $this-&gt;cell_height_ratio;
<a name="l23036"></a>23036                 }
<a name="l23037"></a>23037             }
<a name="l23038"></a>23038         }
<a name="l23039"></a>23039         <span class="comment">// Opening tag</span>
<a name="l23040"></a>23040         <span class="keywordflow">switch</span>($tag[<span class="stringliteral">&#39;value&#39;</span>]) {
<a name="l23041"></a>23041             <span class="keywordflow">case</span> <span class="stringliteral">&#39;table&#39;</span>: {
<a name="l23042"></a>23042                 $cp = 0;
<a name="l23043"></a>23043                 $cs = 0;
<a name="l23044"></a>23044                 $dom[$key][<span class="stringliteral">&#39;rowspans&#39;</span>] = array();
<a name="l23045"></a>23045                 <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nested&#39;</span>]) OR ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nested&#39;</span>] != <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l23046"></a>23046                     <span class="comment">// set table header</span>
<a name="l23047"></a>23047                     <span class="keywordflow">if</span> (!$this-&gt;empty_string($dom[$key][<span class="stringliteral">&#39;thead&#39;</span>])) {
<a name="l23048"></a>23048                         <span class="comment">// set table header</span>
<a name="l23049"></a>23049                         $this-&gt;thead = $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>];
<a name="l23050"></a>23050                         <span class="keywordflow">if</span> (!isset($this-&gt;theadMargins) OR (empty($this-&gt;theadMargins))) {
<a name="l23051"></a>23051                             $this-&gt;theadMargins = array();
<a name="l23052"></a>23052                             $this-&gt;theadMargins[<span class="stringliteral">&#39;cell_padding&#39;</span>] = $this-&gt;cell_padding;
<a name="l23053"></a>23053                             $this-&gt;theadMargins[<span class="stringliteral">&#39;lmargin&#39;</span>] = $this-&gt;lMargin;
<a name="l23054"></a>23054                             $this-&gt;theadMargins[<span class="stringliteral">&#39;rmargin&#39;</span>] = $this-&gt;rMargin;
<a name="l23055"></a>23055                             $this-&gt;theadMargins[<span class="stringliteral">&#39;page&#39;</span>] = $this-&gt;page;
<a name="l23056"></a>23056                             $this-&gt;theadMargins[<span class="stringliteral">&#39;cell&#39;</span>] = $cell;
<a name="l23057"></a>23057                         }
<a name="l23058"></a>23058                     }
<a name="l23059"></a>23059                 }
<a name="l23060"></a>23060                 <span class="comment">// store current margins and page</span>
<a name="l23061"></a>23061                 $dom[$key][<span class="stringliteral">&#39;old_cell_padding&#39;</span>] = $this-&gt;cell_padding;
<a name="l23062"></a>23062                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellpadding&#39;</span>])) {
<a name="l23063"></a>23063                     $pad = $this-&gt;getHTMLUnitToUnits($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellpadding&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l23064"></a>23064                     $this-&gt;SetCellPadding($pad);
<a name="l23065"></a>23065                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($tag[<span class="stringliteral">&#39;padding&#39;</span>])) {
<a name="l23066"></a>23066                     $this-&gt;cell_padding = $tag[<span class="stringliteral">&#39;padding&#39;</span>];
<a name="l23067"></a>23067                 }
<a name="l23068"></a>23068                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {
<a name="l23069"></a>23069                     $cs = $this-&gt;getHTMLUnitToUnits($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l23070"></a>23070                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($tag[<span class="stringliteral">&#39;border-spacing&#39;</span>])) {
<a name="l23071"></a>23071                     $cs = $tag[<span class="stringliteral">&#39;border-spacing&#39;</span>][<span class="charliteral">&#39;V&#39;</span>];
<a name="l23072"></a>23072                 }
<a name="l23073"></a>23073                 $prev_y = $this-&gt;y;
<a name="l23074"></a>23074                 <span class="keywordflow">if</span> ($this-&gt;checkPageBreak(((2 * $cp) + (2 * $cs) + $this-&gt;lasth), <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>) OR ($this-&gt;y &lt; $prev_y)) {
<a name="l23075"></a>23075                     $this-&gt;inthead = <span class="keyword">true</span>;
<a name="l23076"></a>23076                     <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l23077"></a>23077                     $this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1);
<a name="l23078"></a>23078                 }
<a name="l23079"></a>23079                 <span class="keywordflow">break</span>;
<a name="l23080"></a>23080             }
<a name="l23081"></a>23081             <span class="keywordflow">case</span> <span class="stringliteral">&#39;tr&#39;</span>: {
<a name="l23082"></a>23082                 <span class="comment">// array of columns positions</span>
<a name="l23083"></a>23083                 $dom[$key][<span class="stringliteral">&#39;cellpos&#39;</span>] = array();
<a name="l23084"></a>23084                 <span class="keywordflow">break</span>;
<a name="l23085"></a>23085             }
<a name="l23086"></a>23086             <span class="keywordflow">case</span> <span class="stringliteral">&#39;hr&#39;</span>: {
<a name="l23087"></a>23087                 <span class="keywordflow">if</span> ((isset($tag[<span class="stringliteral">&#39;height&#39;</span>])) AND ($tag[<span class="stringliteral">&#39;height&#39;</span>] != <span class="stringliteral">&#39;&#39;</span>)) {
<a name="l23088"></a>23088                     $hrHeight = $this-&gt;getHTMLUnitToUnits($tag[<span class="stringliteral">&#39;height&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l23089"></a>23089                 } <span class="keywordflow">else</span> {
<a name="l23090"></a>23090                     $hrHeight = $this-&gt;GetLineWidth();
<a name="l23091"></a>23091                 }
<a name="l23092"></a>23092                 $this-&gt;addHTMLVertSpace($hbz, ($hrHeight / 2), $cell, $firsttag);
<a name="l23093"></a>23093                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;GetX();
<a name="l23094"></a>23094                 $y = $this-&gt;GetY();
<a name="l23095"></a>23095                 $wtmp = $this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin;
<a name="l23096"></a>23096                 <span class="keywordflow">if</span> ($cell) {
<a name="l23097"></a>23097                     $wtmp -= ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]);
<a name="l23098"></a>23098                 }
<a name="l23099"></a>23099                 <span class="keywordflow">if</span> ((isset($tag[<span class="stringliteral">&#39;width&#39;</span>])) AND ($tag[<span class="stringliteral">&#39;width&#39;</span>] != <span class="stringliteral">&#39;&#39;</span>)) {
<a name="l23100"></a>23100                     $hrWidth = $this-&gt;getHTMLUnitToUnits($tag[<span class="stringliteral">&#39;width&#39;</span>], $wtmp, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l23101"></a>23101                 } <span class="keywordflow">else</span> {
<a name="l23102"></a>23102                     $hrWidth = $wtmp;
<a name="l23103"></a>23103                 }
<a name="l23104"></a>23104                 $prevlinewidth = $this-&gt;GetLineWidth();
<a name="l23105"></a>23105                 $this-&gt;SetLineWidth($hrHeight);
<a name="l23106"></a>23106                 $this-&gt;Line(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + $hrWidth, $y);
<a name="l23107"></a>23107                 $this-&gt;SetLineWidth($prevlinewidth);
<a name="l23108"></a>23108                 $this-&gt;addHTMLVertSpace(($hrHeight / 2), 0, $cell, !isset($dom[($key + 1)]));
<a name="l23109"></a>23109                 <span class="keywordflow">break</span>;
<a name="l23110"></a>23110             }
<a name="l23111"></a>23111             <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>: {
<a name="l23112"></a>23112                 <span class="keywordflow">if</span> (array_key_exists(<span class="stringliteral">&#39;href&#39;</span>, $tag[<span class="stringliteral">&#39;attribute&#39;</span>])) {
<a name="l23113"></a>23113                     $this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>] = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;href&#39;</span>];
<a name="l23114"></a>23114                 }
<a name="l23115"></a>23115                 <span class="keywordflow">break</span>;
<a name="l23116"></a>23116             }
<a name="l23117"></a>23117             <span class="keywordflow">case</span> <span class="stringliteral">&#39;img&#39;</span>: {
<a name="l23118"></a>23118                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>])) {
<a name="l23119"></a>23119                     <span class="keywordflow">if</span> ($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>]{0} === <span class="charliteral">&#39;@&#39;</span>) {
<a name="l23120"></a>23120                         <span class="comment">// data stream</span>
<a name="l23121"></a>23121                         $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>] = <span class="charliteral">&#39;@&#39;</span>.base64_decode(substr($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>], 1));
<a name="l23122"></a>23122                         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = <span class="stringliteral">&#39;&#39;</span>;
<a name="l23123"></a>23123                     } <span class="keywordflow">else</span> {
<a name="l23124"></a>23124                         <span class="comment">// check for images without protocol</span>
<a name="l23125"></a>23125                         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;%^/{2}%&#39;</span>, $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>])) {
<a name="l23126"></a>23126                             $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>] = <span class="stringliteral">&#39;http:&#39;</span>.$tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>];
<a name="l23127"></a>23127                         }
<a name="l23128"></a>23128                         <span class="comment">// replace relative path with real server path</span>
<a name="l23129"></a>23129                         <span class="keywordflow">if</span> (($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>][0] == <span class="charliteral">&#39;/&#39;</span>) AND !empty($_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>]) AND ($_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>] != <span class="charliteral">&#39;/&#39;</span>)) {
<a name="l23130"></a>23130                             $findroot = strpos($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>], $_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>]);
<a name="l23131"></a>23131                             <span class="keywordflow">if</span> (($findroot === <span class="keyword">false</span>) OR ($findroot &gt; 1)) {
<a name="l23132"></a>23132                                 <span class="keywordflow">if</span> (substr($_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>], -1) == <span class="charliteral">&#39;/&#39;</span>) {
<a name="l23133"></a>23133                                     $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>] = substr($_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>], 0, -1).$tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>];
<a name="l23134"></a>23134                                 } <span class="keywordflow">else</span> {
<a name="l23135"></a>23135                                     $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>] = $_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>].$tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>];
<a name="l23136"></a>23136                                 }
<a name="l23137"></a>23137                             }
<a name="l23138"></a>23138                         }
<a name="l23139"></a>23139                         $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>] = htmlspecialchars_decode(urldecode($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>]));
<a name="l23140"></a>23140                         <a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> = $this-&gt;getImageFileType($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>]);
<a name="l23141"></a>23141                         $testscrtype = @parse_url($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>]);
<a name="l23142"></a>23142                         <span class="keywordflow">if</span> (!isset($testscrtype[<span class="stringliteral">&#39;query&#39;</span>]) OR empty($testscrtype[<span class="stringliteral">&#39;query&#39;</span>])) {
<a name="l23143"></a>23143                             <span class="comment">// convert URL to server path</span>
<a name="l23144"></a>23144                             $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>] = str_replace(K_PATH_URL, K_PATH_MAIN, $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>]);
<a name="l23145"></a>23145                         }
<a name="l23146"></a>23146                     }
<a name="l23147"></a>23147                     <span class="keywordflow">if</span> (!isset($tag[<span class="stringliteral">&#39;width&#39;</span>])) {
<a name="l23148"></a>23148                         $tag[<span class="stringliteral">&#39;width&#39;</span>] = 0;
<a name="l23149"></a>23149                     }
<a name="l23150"></a>23150                     <span class="keywordflow">if</span> (!isset($tag[<span class="stringliteral">&#39;height&#39;</span>])) {
<a name="l23151"></a>23151                         $tag[<span class="stringliteral">&#39;height&#39;</span>] = 0;
<a name="l23152"></a>23152                     }
<a name="l23153"></a>23153                     <span class="comment">//if (!isset($tag[&#39;attribute&#39;][&#39;align&#39;])) {</span>
<a name="l23154"></a>23154                         <span class="comment">// the only alignment supported is &quot;bottom&quot;</span>
<a name="l23155"></a>23155                         <span class="comment">// further development is required for other modes.</span>
<a name="l23156"></a>23156                         $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>] = <span class="stringliteral">&#39;bottom&#39;</span>;
<a name="l23157"></a>23157                     <span class="comment">//}</span>
<a name="l23158"></a>23158                     <span class="keywordflow">switch</span>($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>]) {
<a name="l23159"></a>23159                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;top&#39;</span>: {
<a name="l23160"></a>23160                             $align = <span class="charliteral">&#39;T&#39;</span>;
<a name="l23161"></a>23161                             <span class="keywordflow">break</span>;
<a name="l23162"></a>23162                         }
<a name="l23163"></a>23163                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;middle&#39;</span>: {
<a name="l23164"></a>23164                             $align = <span class="charliteral">&#39;M&#39;</span>;
<a name="l23165"></a>23165                             <span class="keywordflow">break</span>;
<a name="l23166"></a>23166                         }
<a name="l23167"></a>23167                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;bottom&#39;</span>: {
<a name="l23168"></a>23168                             $align = <span class="charliteral">&#39;B&#39;</span>;
<a name="l23169"></a>23169                             <span class="keywordflow">break</span>;
<a name="l23170"></a>23170                         }
<a name="l23171"></a>23171                         <span class="keywordflow">default</span>: {
<a name="l23172"></a>23172                             $align = <span class="charliteral">&#39;B&#39;</span>;
<a name="l23173"></a>23173                             <span class="keywordflow">break</span>;
<a name="l23174"></a>23174                         }
<a name="l23175"></a>23175                     }
<a name="l23176"></a>23176                     $prevy = $this-&gt;y;
<a name="l23177"></a>23177                     $xpos = $this-&gt;x;
<a name="l23178"></a>23178                     $imglink = <span class="stringliteral">&#39;&#39;</span>;
<a name="l23179"></a>23179                     <span class="keywordflow">if</span> (isset($this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>]) AND !$this-&gt;empty_string($this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>])) {
<a name="l23180"></a>23180                         $imglink = $this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>];
<a name="l23181"></a>23181                         <span class="keywordflow">if</span> ($imglink{0} == <span class="charliteral">&#39;#&#39;</span>) {
<a name="l23182"></a>23182                             <span class="comment">// convert url to internal link</span>
<a name="l23183"></a>23183                             $lnkdata = explode(<span class="charliteral">&#39;,&#39;</span>, $imglink);
<a name="l23184"></a>23184                             <span class="keywordflow">if</span> (isset($lnkdata[0])) {
<a name="l23185"></a>23185                                 <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = intval(substr($lnkdata[0], 1));
<a name="l23186"></a>23186                                 <span class="keywordflow">if</span> (empty(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>) OR (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &lt;= 0)) {
<a name="l23187"></a>23187                                     <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = $this-&gt;page;
<a name="l23188"></a>23188                                 }
<a name="l23189"></a>23189                                 <span class="keywordflow">if</span> (isset($lnkdata[1]) AND (strlen($lnkdata[1]) &gt; 0)) {
<a name="l23190"></a>23190                                     $lnky = floatval($lnkdata[1]);
<a name="l23191"></a>23191                                 } <span class="keywordflow">else</span> {
<a name="l23192"></a>23192                                     $lnky = 0;
<a name="l23193"></a>23193                                 }
<a name="l23194"></a>23194                                 $imglink = $this-&gt;AddLink();
<a name="l23195"></a>23195                                 $this-&gt;SetLink($imglink, $lnky, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>);
<a name="l23196"></a>23196                             }
<a name="l23197"></a>23197                         }
<a name="l23198"></a>23198                     }
<a name="l23199"></a>23199                     $border = 0;
<a name="l23200"></a>23200                     <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;border&#39;</span>]) AND !empty($tag[<span class="stringliteral">&#39;border&#39;</span>])) {
<a name="l23201"></a>23201                         <span class="comment">// currently only support 1 (frame) or a combination of &#39;LTRB&#39;</span>
<a name="l23202"></a>23202                         $border = $tag[<span class="stringliteral">&#39;border&#39;</span>];
<a name="l23203"></a>23203                     }
<a name="l23204"></a>23204                     $iw = <span class="stringliteral">&#39;&#39;</span>;
<a name="l23205"></a>23205                     <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;width&#39;</span>])) {
<a name="l23206"></a>23206                         $iw = $this-&gt;getHTMLUnitToUnits($tag[<span class="stringliteral">&#39;width&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l23207"></a>23207                     }
<a name="l23208"></a>23208                     $ih = <span class="stringliteral">&#39;&#39;</span>;
<a name="l23209"></a>23209                     <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;height&#39;</span>])) {
<a name="l23210"></a>23210                         $ih = $this-&gt;getHTMLUnitToUnits($tag[<span class="stringliteral">&#39;height&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);
<a name="l23211"></a>23211                     }
<a name="l23212"></a>23212                     <span class="keywordflow">if</span> ((<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;eps&#39;</span>) OR (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;ai&#39;</span>)) {
<a name="l23213"></a>23213                         $this-&gt;ImageEps($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>], $xpos, $this-&gt;y, $iw, $ih, $imglink, <span class="keyword">true</span>, $align, <span class="stringliteral">&#39;&#39;</span>, $border, <span class="keyword">true</span>);
<a name="l23214"></a>23214                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="export_8php.html#a9a4a6fba2208984cabb3afacadf33919">$type</a> == <span class="stringliteral">&#39;svg&#39;</span>) {
<a name="l23215"></a>23215                         $this-&gt;ImageSVG($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>], $xpos, $this-&gt;y, $iw, $ih, $imglink, $align, <span class="stringliteral">&#39;&#39;</span>, $border, <span class="keyword">true</span>);
<a name="l23216"></a>23216                     } <span class="keywordflow">else</span> {
<a name="l23217"></a>23217                         $this-&gt;Image($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>], $xpos, $this-&gt;y, $iw, $ih, <span class="stringliteral">&#39;&#39;</span>, $imglink, $align, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);
<a name="l23218"></a>23218                     }
<a name="l23219"></a>23219                     <span class="keywordflow">switch</span>($align) {
<a name="l23220"></a>23220                         <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {
<a name="l23221"></a>23221                             $this-&gt;y = $prevy;
<a name="l23222"></a>23222                             <span class="keywordflow">break</span>;
<a name="l23223"></a>23223                         }
<a name="l23224"></a>23224                         <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {
<a name="l23225"></a>23225                             $this-&gt;y = (($this-&gt;img_rb_y + $prevy - ($tag[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k)) / 2) ;
<a name="l23226"></a>23226                             <span class="keywordflow">break</span>;
<a name="l23227"></a>23227                         }
<a name="l23228"></a>23228                         <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l23229"></a>23229                             $this-&gt;y = $this-&gt;img_rb_y - ($tag[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k);
<a name="l23230"></a>23230                             <span class="keywordflow">break</span>;
<a name="l23231"></a>23231                         }
<a name="l23232"></a>23232                     }
<a name="l23233"></a>23233                 }
<a name="l23234"></a>23234                 <span class="keywordflow">break</span>;
<a name="l23235"></a>23235             }
<a name="l23236"></a>23236             <span class="keywordflow">case</span> <span class="stringliteral">&#39;dl&#39;</span>: {
<a name="l23237"></a>23237                 ++$this-&gt;listnum;
<a name="l23238"></a>23238                 <span class="keywordflow">if</span> ($this-&gt;listnum == 1) {
<a name="l23239"></a>23239                     $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23240"></a>23240                 } <span class="keywordflow">else</span> {
<a name="l23241"></a>23241                     $this-&gt;addHTMLVertSpace(0, 0, $cell, $firsttag);
<a name="l23242"></a>23242                 }
<a name="l23243"></a>23243                 <span class="keywordflow">break</span>;
<a name="l23244"></a>23244             }
<a name="l23245"></a>23245             <span class="keywordflow">case</span> <span class="stringliteral">&#39;dt&#39;</span>: {
<a name="l23246"></a>23246                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23247"></a>23247                 <span class="keywordflow">break</span>;
<a name="l23248"></a>23248             }
<a name="l23249"></a>23249             <span class="keywordflow">case</span> <span class="stringliteral">&#39;dd&#39;</span>: {
<a name="l23250"></a>23250                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l23251"></a>23251                     $this-&gt;rMargin += $this-&gt;listindent;
<a name="l23252"></a>23252                 } <span class="keywordflow">else</span> {
<a name="l23253"></a>23253                     $this-&gt;lMargin += $this-&gt;listindent;
<a name="l23254"></a>23254                 }
<a name="l23255"></a>23255                 ++$this-&gt;listindentlevel;
<a name="l23256"></a>23256                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23257"></a>23257                 <span class="keywordflow">break</span>;
<a name="l23258"></a>23258             }
<a name="l23259"></a>23259             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ul&#39;</span>:
<a name="l23260"></a>23260             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ol&#39;</span>: {
<a name="l23261"></a>23261                 ++$this-&gt;listnum;
<a name="l23262"></a>23262                 <span class="keywordflow">if</span> ($tag[<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;ol&#39;</span>) {
<a name="l23263"></a>23263                     $this-&gt;listordered[$this-&gt;listnum] = <span class="keyword">true</span>;
<a name="l23264"></a>23264                 } <span class="keywordflow">else</span> {
<a name="l23265"></a>23265                     $this-&gt;listordered[$this-&gt;listnum] = <span class="keyword">false</span>;
<a name="l23266"></a>23266                 }
<a name="l23267"></a>23267                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;start&#39;</span>])) {
<a name="l23268"></a>23268                     $this-&gt;listcount[$this-&gt;listnum] = intval($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;start&#39;</span>]) - 1;
<a name="l23269"></a>23269                 } <span class="keywordflow">else</span> {
<a name="l23270"></a>23270                     $this-&gt;listcount[$this-&gt;listnum] = 0;
<a name="l23271"></a>23271                 }
<a name="l23272"></a>23272                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l23273"></a>23273                     $this-&gt;rMargin += $this-&gt;listindent;
<a name="l23274"></a>23274                     $this-&gt;x -= $this-&gt;listindent;
<a name="l23275"></a>23275                 } <span class="keywordflow">else</span> {
<a name="l23276"></a>23276                     $this-&gt;lMargin += $this-&gt;listindent;
<a name="l23277"></a>23277                     $this-&gt;x += $this-&gt;listindent;
<a name="l23278"></a>23278                 }
<a name="l23279"></a>23279                 ++$this-&gt;listindentlevel;
<a name="l23280"></a>23280                 <span class="keywordflow">if</span> ($this-&gt;listnum == 1) {
<a name="l23281"></a>23281                     <span class="keywordflow">if</span> ($key &gt; 1) {
<a name="l23282"></a>23282                         $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23283"></a>23283                     }
<a name="l23284"></a>23284                 } <span class="keywordflow">else</span> {
<a name="l23285"></a>23285                     $this-&gt;addHTMLVertSpace(0, 0, $cell, $firsttag);
<a name="l23286"></a>23286                 }
<a name="l23287"></a>23287                 <span class="keywordflow">break</span>;
<a name="l23288"></a>23288             }
<a name="l23289"></a>23289             <span class="keywordflow">case</span> <span class="stringliteral">&#39;li&#39;</span>: {
<a name="l23290"></a>23290                 <span class="keywordflow">if</span> ($key &gt; 2) {
<a name="l23291"></a>23291                     $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23292"></a>23292                 }
<a name="l23293"></a>23293                 <span class="keywordflow">if</span> ($this-&gt;listordered[$this-&gt;listnum]) {
<a name="l23294"></a>23294                     <span class="comment">// ordered item</span>
<a name="l23295"></a>23295                     <span class="keywordflow">if</span> (isset($parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>]) AND !$this-&gt;empty_string($parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>])) {
<a name="l23296"></a>23296                         $this-&gt;lispacer = $parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>];
<a name="l23297"></a>23297                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($parent[<span class="stringliteral">&#39;listtype&#39;</span>]) AND !$this-&gt;empty_string($parent[<span class="stringliteral">&#39;listtype&#39;</span>])) {
<a name="l23298"></a>23298                         $this-&gt;lispacer = $parent[<span class="stringliteral">&#39;listtype&#39;</span>];
<a name="l23299"></a>23299                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;lisymbol) AND !$this-&gt;empty_string($this-&gt;lisymbol)) {
<a name="l23300"></a>23300                         $this-&gt;lispacer = $this-&gt;lisymbol;
<a name="l23301"></a>23301                     } <span class="keywordflow">else</span> {
<a name="l23302"></a>23302                         $this-&gt;lispacer = <span class="charliteral">&#39;#&#39;</span>;
<a name="l23303"></a>23303                     }
<a name="l23304"></a>23304                     ++$this-&gt;listcount[$this-&gt;listnum];
<a name="l23305"></a>23305                     <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>])) {
<a name="l23306"></a>23306                         $this-&gt;listcount[$this-&gt;listnum] = intval($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l23307"></a>23307                     }
<a name="l23308"></a>23308                 } <span class="keywordflow">else</span> {
<a name="l23309"></a>23309                     <span class="comment">// unordered item</span>
<a name="l23310"></a>23310                     <span class="keywordflow">if</span> (isset($parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>]) AND !$this-&gt;empty_string($parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>])) {
<a name="l23311"></a>23311                         $this-&gt;lispacer = $parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>];
<a name="l23312"></a>23312                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($parent[<span class="stringliteral">&#39;listtype&#39;</span>]) AND !$this-&gt;empty_string($parent[<span class="stringliteral">&#39;listtype&#39;</span>])) {
<a name="l23313"></a>23313                         $this-&gt;lispacer = $parent[<span class="stringliteral">&#39;listtype&#39;</span>];
<a name="l23314"></a>23314                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;lisymbol) AND !$this-&gt;empty_string($this-&gt;lisymbol)) {
<a name="l23315"></a>23315                         $this-&gt;lispacer = $this-&gt;lisymbol;
<a name="l23316"></a>23316                     } <span class="keywordflow">else</span> {
<a name="l23317"></a>23317                         $this-&gt;lispacer = <span class="charliteral">&#39;!&#39;</span>;
<a name="l23318"></a>23318                     }
<a name="l23319"></a>23319                 }
<a name="l23320"></a>23320                 <span class="keywordflow">break</span>;
<a name="l23321"></a>23321             }
<a name="l23322"></a>23322             <span class="keywordflow">case</span> <span class="stringliteral">&#39;blockquote&#39;</span>: {
<a name="l23323"></a>23323                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l23324"></a>23324                     $this-&gt;rMargin += $this-&gt;listindent;
<a name="l23325"></a>23325                 } <span class="keywordflow">else</span> {
<a name="l23326"></a>23326                     $this-&gt;lMargin += $this-&gt;listindent;
<a name="l23327"></a>23327                 }
<a name="l23328"></a>23328                 ++$this-&gt;listindentlevel;
<a name="l23329"></a>23329                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23330"></a>23330                 <span class="keywordflow">break</span>;
<a name="l23331"></a>23331             }
<a name="l23332"></a>23332             <span class="keywordflow">case</span> <span class="stringliteral">&#39;br&#39;</span>: {
<a name="l23333"></a>23333                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23334"></a>23334                 <span class="keywordflow">break</span>;
<a name="l23335"></a>23335             }
<a name="l23336"></a>23336             <span class="keywordflow">case</span> <span class="stringliteral">&#39;div&#39;</span>: {
<a name="l23337"></a>23337                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23338"></a>23338                 <span class="keywordflow">break</span>;
<a name="l23339"></a>23339             }
<a name="l23340"></a>23340             <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>: {
<a name="l23341"></a>23341                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23342"></a>23342                 <span class="keywordflow">break</span>;
<a name="l23343"></a>23343             }
<a name="l23344"></a>23344             <span class="keywordflow">case</span> <span class="stringliteral">&#39;pre&#39;</span>: {
<a name="l23345"></a>23345                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23346"></a>23346                 $this-&gt;premode = <span class="keyword">true</span>;
<a name="l23347"></a>23347                 <span class="keywordflow">break</span>;
<a name="l23348"></a>23348             }
<a name="l23349"></a>23349             <span class="keywordflow">case</span> <span class="stringliteral">&#39;sup&#39;</span>: {
<a name="l23350"></a>23350                 $this-&gt;SetXY($this-&gt;GetX(), $this-&gt;GetY() - ((0.7 * $this-&gt;FontSizePt) / $this-&gt;k));
<a name="l23351"></a>23351                 <span class="keywordflow">break</span>;
<a name="l23352"></a>23352             }
<a name="l23353"></a>23353             <span class="keywordflow">case</span> <span class="stringliteral">&#39;sub&#39;</span>: {
<a name="l23354"></a>23354                 $this-&gt;SetXY($this-&gt;GetX(), $this-&gt;GetY() + ((0.3 * $this-&gt;FontSizePt) / $this-&gt;k));
<a name="l23355"></a>23355                 <span class="keywordflow">break</span>;
<a name="l23356"></a>23356             }
<a name="l23357"></a>23357             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h1&#39;</span>:
<a name="l23358"></a>23358             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h2&#39;</span>:
<a name="l23359"></a>23359             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h3&#39;</span>:
<a name="l23360"></a>23360             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h4&#39;</span>:
<a name="l23361"></a>23361             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h5&#39;</span>:
<a name="l23362"></a>23362             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h6&#39;</span>: {
<a name="l23363"></a>23363                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, $firsttag);
<a name="l23364"></a>23364                 <span class="keywordflow">break</span>;
<a name="l23365"></a>23365             }
<a name="l23366"></a>23366             <span class="comment">// Form fields (since 4.8.000 - 2009-09-07)</span>
<a name="l23367"></a>23367             <span class="keywordflow">case</span> <span class="stringliteral">&#39;form&#39;</span>: {
<a name="l23368"></a>23368                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;action&#39;</span>])) {
<a name="l23369"></a>23369                     $this-&gt;form_action = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;action&#39;</span>];
<a name="l23370"></a>23370                 } <span class="keywordflow">else</span> {
<a name="l23371"></a>23371                     $this-&gt;form_action = K_PATH_URL.$_SERVER[<span class="stringliteral">&#39;SCRIPT_NAME&#39;</span>];
<a name="l23372"></a>23372                 }
<a name="l23373"></a>23373                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;enctype&#39;</span>])) {
<a name="l23374"></a>23374                     $this-&gt;form_enctype = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;enctype&#39;</span>];
<a name="l23375"></a>23375                 } <span class="keywordflow">else</span> {
<a name="l23376"></a>23376                     $this-&gt;form_enctype = <span class="stringliteral">&#39;application/x-www-form-urlencoded&#39;</span>;
<a name="l23377"></a>23377                 }
<a name="l23378"></a>23378                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;method&#39;</span>])) {
<a name="l23379"></a>23379                     $this-&gt;form_mode = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;method&#39;</span>];
<a name="l23380"></a>23380                 } <span class="keywordflow">else</span> {
<a name="l23381"></a>23381                     $this-&gt;form_mode = <span class="stringliteral">&#39;post&#39;</span>;
<a name="l23382"></a>23382                 }
<a name="l23383"></a>23383                 <span class="keywordflow">break</span>;
<a name="l23384"></a>23384             }
<a name="l23385"></a>23385             <span class="keywordflow">case</span> <span class="stringliteral">&#39;input&#39;</span>: {
<a name="l23386"></a>23386                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>]) AND !$this-&gt;empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>])) {
<a name="l23387"></a>23387                     <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>];
<a name="l23388"></a>23388                 } <span class="keywordflow">else</span> {
<a name="l23389"></a>23389                     <span class="keywordflow">break</span>;
<a name="l23390"></a>23390                 }
<a name="l23391"></a>23391                 $prop = array();
<a name="l23392"></a>23392                 $opt = array();
<a name="l23393"></a>23393                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;readonly&#39;</span>]) AND !$this-&gt;empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;readonly&#39;</span>])) {
<a name="l23394"></a>23394                     $prop[<span class="stringliteral">&#39;readonly&#39;</span>] = <span class="keyword">true</span>;
<a name="l23395"></a>23395                 }
<a name="l23396"></a>23396                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>]) AND !$this-&gt;empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>])) {
<a name="l23397"></a>23397                     $value = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>];
<a name="l23398"></a>23398                 }
<a name="l23399"></a>23399                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;maxlength&#39;</span>]) AND !$this-&gt;empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;maxlength&#39;</span>])) {
<a name="l23400"></a>23400                     $opt[<span class="stringliteral">&#39;maxlen&#39;</span>] = intval($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>]);
<a name="l23401"></a>23401                 }
<a name="l23402"></a>23402                 <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;FontSize * $this-&gt;cell_height_ratio;
<a name="l23403"></a>23403                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]) AND !$this-&gt;empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>])) {
<a name="l23404"></a>23404                     <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = intval($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]) * $this-&gt;GetStringWidth(chr(32)) * 2;
<a name="l23405"></a>23405                 } <span class="keywordflow">else</span> {
<a name="l23406"></a>23406                     <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l23407"></a>23407                 }
<a name="l23408"></a>23408                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>]) AND (($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>] == <span class="stringliteral">&#39;checked&#39;</span>) OR ($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>))) {
<a name="l23409"></a>23409                     <a class="code" href="db__structure_8php.html#aae831eeaf71994cc7e31c1412a29f6fd">$checked</a> = <span class="keyword">true</span>;
<a name="l23410"></a>23410                 } <span class="keywordflow">else</span> {
<a name="l23411"></a>23411                     <a class="code" href="db__structure_8php.html#aae831eeaf71994cc7e31c1412a29f6fd">$checked</a> = <span class="keyword">false</span>;
<a name="l23412"></a>23412                 }
<a name="l23413"></a>23413                 <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;align&#39;</span>])) {
<a name="l23414"></a>23414                     <span class="keywordflow">switch</span> ($tag[<span class="stringliteral">&#39;align&#39;</span>]) {
<a name="l23415"></a>23415                         <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {
<a name="l23416"></a>23416                             $opt[<span class="charliteral">&#39;q&#39;</span>] = 1;
<a name="l23417"></a>23417                             <span class="keywordflow">break</span>;
<a name="l23418"></a>23418                         }
<a name="l23419"></a>23419                         <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {
<a name="l23420"></a>23420                             $opt[<span class="charliteral">&#39;q&#39;</span>] = 2;
<a name="l23421"></a>23421                             <span class="keywordflow">break</span>;
<a name="l23422"></a>23422                         }
<a name="l23423"></a>23423                         <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:
<a name="l23424"></a>23424                         <span class="keywordflow">default</span>: {
<a name="l23425"></a>23425                             <span class="keywordflow">break</span>;
<a name="l23426"></a>23426                         }
<a name="l23427"></a>23427                     }
<a name="l23428"></a>23428                 }
<a name="l23429"></a>23429                 <span class="keywordflow">switch</span> ($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>]) {
<a name="l23430"></a>23430                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>: {
<a name="l23431"></a>23431                         <span class="keywordflow">if</span> (isset($value)) {
<a name="l23432"></a>23432                             $opt[<span class="charliteral">&#39;v&#39;</span>] = $value;
<a name="l23433"></a>23433                         }
<a name="l23434"></a>23434                         $this-&gt;TextField(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);
<a name="l23435"></a>23435                         <span class="keywordflow">break</span>;
<a name="l23436"></a>23436                     }
<a name="l23437"></a>23437                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;password&#39;</span>: {
<a name="l23438"></a>23438                         <span class="keywordflow">if</span> (isset($value)) {
<a name="l23439"></a>23439                             $opt[<span class="charliteral">&#39;v&#39;</span>] = $value;
<a name="l23440"></a>23440                         }
<a name="l23441"></a>23441                         $prop[<span class="stringliteral">&#39;password&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l23442"></a>23442                         $this-&gt;TextField(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);
<a name="l23443"></a>23443                         <span class="keywordflow">break</span>;
<a name="l23444"></a>23444                     }
<a name="l23445"></a>23445                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;checkbox&#39;</span>: {
<a name="l23446"></a>23446                         $this-&gt;CheckBox(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="db__structure_8php.html#aae831eeaf71994cc7e31c1412a29f6fd">$checked</a>, $prop, $opt, $value, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);
<a name="l23447"></a>23447                         <span class="keywordflow">break</span>;
<a name="l23448"></a>23448                     }
<a name="l23449"></a>23449                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;radio&#39;</span>: {
<a name="l23450"></a>23450                         $this-&gt;RadioButton(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $prop, $opt, $value, <a class="code" href="db__structure_8php.html#aae831eeaf71994cc7e31c1412a29f6fd">$checked</a>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);
<a name="l23451"></a>23451                         <span class="keywordflow">break</span>;
<a name="l23452"></a>23452                     }
<a name="l23453"></a>23453                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;submit&#39;</span>: {
<a name="l23454"></a>23454                         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;GetStringWidth($value) * 1.5;
<a name="l23455"></a>23455                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> *= 1.6;
<a name="l23456"></a>23456                         $prop = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;beveled&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(196, 196, 196), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(255, 255, 255));
<a name="l23457"></a>23457                         <a class="code" href="tbl__create_8php.html#aa698a3e72116e8e778be0e95d908ee30" title="Get some core libraries.">$action</a> = array();
<a name="l23458"></a>23458                         <a class="code" href="tbl__create_8php.html#aa698a3e72116e8e778be0e95d908ee30" title="Get some core libraries.">$action</a>[<span class="charliteral">&#39;S&#39;</span>] = <span class="stringliteral">&#39;SubmitForm&#39;</span>;
<a name="l23459"></a>23459                         <a class="code" href="tbl__create_8php.html#aa698a3e72116e8e778be0e95d908ee30" title="Get some core libraries.">$action</a>[<span class="charliteral">&#39;F&#39;</span>] = $this-&gt;form_action;
<a name="l23460"></a>23460                         <span class="keywordflow">if</span> ($this-&gt;form_enctype != <span class="stringliteral">&#39;FDF&#39;</span>) {
<a name="l23461"></a>23461                             <a class="code" href="tbl__create_8php.html#aa698a3e72116e8e778be0e95d908ee30" title="Get some core libraries.">$action</a>[<span class="stringliteral">&#39;Flags&#39;</span>] = array(<span class="stringliteral">&#39;ExportFormat&#39;</span>);
<a name="l23462"></a>23462                         }
<a name="l23463"></a>23463                         <span class="keywordflow">if</span> ($this-&gt;form_mode == <span class="stringliteral">&#39;get&#39;</span>) {
<a name="l23464"></a>23464                             <a class="code" href="tbl__create_8php.html#aa698a3e72116e8e778be0e95d908ee30" title="Get some core libraries.">$action</a>[<span class="stringliteral">&#39;Flags&#39;</span>] = array(<span class="stringliteral">&#39;GetMethod&#39;</span>);
<a name="l23465"></a>23465                         }
<a name="l23466"></a>23466                         $this-&gt;Button(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $value, <a class="code" href="tbl__create_8php.html#aa698a3e72116e8e778be0e95d908ee30" title="Get some core libraries.">$action</a>, $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);
<a name="l23467"></a>23467                         <span class="keywordflow">break</span>;
<a name="l23468"></a>23468                     }
<a name="l23469"></a>23469                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;reset&#39;</span>: {
<a name="l23470"></a>23470                         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;GetStringWidth($value) * 1.5;
<a name="l23471"></a>23471                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> *= 1.6;
<a name="l23472"></a>23472                         $prop = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;beveled&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(196, 196, 196), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(255, 255, 255));
<a name="l23473"></a>23473                         $this-&gt;Button(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $value, array(<span class="charliteral">&#39;S&#39;</span>=&gt;<span class="stringliteral">&#39;ResetForm&#39;</span>), $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);
<a name="l23474"></a>23474                         <span class="keywordflow">break</span>;
<a name="l23475"></a>23475                     }
<a name="l23476"></a>23476                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;file&#39;</span>: {
<a name="l23477"></a>23477                         $prop[<span class="stringliteral">&#39;fileSelect&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;
<a name="l23478"></a>23478                         $this-&gt;TextField(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);
<a name="l23479"></a>23479                         <span class="keywordflow">if</span> (!isset($value)) {
<a name="l23480"></a>23480                             $value = <span class="charliteral">&#39;*&#39;</span>;
<a name="l23481"></a>23481                         }
<a name="l23482"></a>23482                         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;GetStringWidth($value) * 2;
<a name="l23483"></a>23483                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> *= 1.2;
<a name="l23484"></a>23484                         $prop = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;beveled&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(196, 196, 196), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(255, 255, 255));
<a name="l23485"></a>23485                         $jsaction = <span class="stringliteral">&#39;var f=this.getField(\&#39;&#39;</span>.$name.<span class="charliteral">&#39;\&#39;</span>); f.browseForFileToSubmit();<span class="stringliteral">&#39;;</span>
<a name="l23486"></a>23486 <span class="stringliteral">                        $this-&gt;Button(&#39;</span>FB_<span class="stringliteral">&#39;.$name, $w, $h, $value, $jsaction, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span>
<a name="l23487"></a>23487 <span class="stringliteral">                        break;</span>
<a name="l23488"></a>23488 <span class="stringliteral">                    }</span>
<a name="l23489"></a>23489 <span class="stringliteral">                    case &#39;</span>hidden<span class="stringliteral">&#39;: {</span>
<a name="l23490"></a>23490 <span class="stringliteral">                        if (isset($value)) {</span>
<a name="l23491"></a>23491 <span class="stringliteral">                            $opt[&#39;</span>v<span class="stringliteral">&#39;] = $value;</span>
<a name="l23492"></a>23492 <span class="stringliteral">                        }</span>
<a name="l23493"></a>23493 <span class="stringliteral">                        $opt[&#39;</span>f<span class="stringliteral">&#39;] = array(&#39;</span>invisible<span class="stringliteral">&#39;, &#39;</span>hidden<span class="stringliteral">&#39;);</span>
<a name="l23494"></a>23494 <span class="stringliteral">                        $this-&gt;TextField($name, 0, 0, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span>
<a name="l23495"></a>23495 <span class="stringliteral">                        break;</span>
<a name="l23496"></a>23496 <span class="stringliteral">                    }</span>
<a name="l23497"></a>23497 <span class="stringliteral">                    case &#39;</span><a class="code" href="original_2css_2theme__right_8css_8php.html#aa8d0e43a05bedec09f81303004b3af2e">image</a><span class="stringliteral">&#39;: {</span>
<a name="l23498"></a>23498 <span class="stringliteral">                        // THIS TYPE MUST BE FIXED</span>
<a name="l23499"></a>23499 <span class="stringliteral">                        if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>src<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>src<span class="stringliteral">&#39;])) {</span>
<a name="l23500"></a>23500 <span class="stringliteral">                            $img = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>src<span class="stringliteral">&#39;];</span>
<a name="l23501"></a>23501 <span class="stringliteral">                        } else {</span>
<a name="l23502"></a>23502 <span class="stringliteral">                            break;</span>
<a name="l23503"></a>23503 <span class="stringliteral">                        }</span>
<a name="l23504"></a>23504 <span class="stringliteral">                        $value = &#39;</span>img<span class="stringliteral">&#39;;</span>
<a name="l23505"></a>23505 <span class="stringliteral">                        //$opt[&#39;</span>mk<span class="stringliteral">&#39;] = array(&#39;</span>i<span class="stringliteral">&#39;=&gt;$img, &#39;</span>tp<span class="stringliteral">&#39;=&gt;1, &#39;</span><span class="keywordflow">if</span><span class="stringliteral">&#39;=&gt;array(&#39;</span>sw<span class="stringliteral">&#39;=&gt;&#39;</span>A<span class="stringliteral">&#39;, &#39;</span>s<span class="stringliteral">&#39;=&gt;&#39;</span>A<span class="stringliteral">&#39;, &#39;</span>fb<span class="stringliteral">&#39;=&gt;false));</span>
<a name="l23506"></a>23506 <span class="stringliteral">                        if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;]) AND !empty($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;])) {</span>
<a name="l23507"></a>23507 <span class="stringliteral">                            $jsaction = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;];</span>
<a name="l23508"></a>23508 <span class="stringliteral">                        } else {</span>
<a name="l23509"></a>23509 <span class="stringliteral">                            $jsaction = &#39;</span><span class="stringliteral">&#39;;</span>
<a name="l23510"></a>23510 <span class="stringliteral">                        }</span>
<a name="l23511"></a>23511 <span class="stringliteral">                        $this-&gt;Button($name, $w, $h, $value, $jsaction, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span>
<a name="l23512"></a>23512 <span class="stringliteral">                        break;</span>
<a name="l23513"></a>23513 <span class="stringliteral">                    }</span>
<a name="l23514"></a>23514 <span class="stringliteral">                    case &#39;</span>button<span class="stringliteral">&#39;: {</span>
<a name="l23515"></a>23515 <span class="stringliteral">                        $w = $this-&gt;GetStringWidth($value) * 1.5;</span>
<a name="l23516"></a>23516 <span class="stringliteral">                        $h *= 1.6;</span>
<a name="l23517"></a>23517 <span class="stringliteral">                        $prop = array(&#39;</span>lineWidth<span class="stringliteral">&#39;=&gt;1, &#39;</span>borderStyle<span class="stringliteral">&#39;=&gt;&#39;</span>beveled<span class="stringliteral">&#39;, &#39;</span>fillColor<span class="stringliteral">&#39;=&gt;array(196, 196, 196), &#39;</span>strokeColor<span class="stringliteral">&#39;=&gt;array(255, 255, 255));</span>
<a name="l23518"></a>23518 <span class="stringliteral">                        if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;]) AND !empty($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;])) {</span>
<a name="l23519"></a>23519 <span class="stringliteral">                            $jsaction = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;];</span>
<a name="l23520"></a>23520 <span class="stringliteral">                        } else {</span>
<a name="l23521"></a>23521 <span class="stringliteral">                            $jsaction = &#39;</span><span class="stringliteral">&#39;;</span>
<a name="l23522"></a>23522 <span class="stringliteral">                        }</span>
<a name="l23523"></a>23523 <span class="stringliteral">                        $this-&gt;Button($name, $w, $h, $value, $jsaction, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span>
<a name="l23524"></a>23524 <span class="stringliteral">                        break;</span>
<a name="l23525"></a>23525 <span class="stringliteral">                    }</span>
<a name="l23526"></a>23526 <span class="stringliteral">                }</span>
<a name="l23527"></a>23527 <span class="stringliteral">                break;</span>
<a name="l23528"></a>23528 <span class="stringliteral">            }</span>
<a name="l23529"></a>23529 <span class="stringliteral">            case &#39;</span>textarea<span class="stringliteral">&#39;: {</span>
<a name="l23530"></a>23530 <span class="stringliteral">                $prop = array();</span>
<a name="l23531"></a>23531 <span class="stringliteral">                $opt = array();</span>
<a name="l23532"></a>23532 <span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>readonly<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>readonly<span class="stringliteral">&#39;])) {</span>
<a name="l23533"></a>23533 <span class="stringliteral">                    $prop[&#39;</span>readonly<span class="stringliteral">&#39;] = true;</span>
<a name="l23534"></a>23534 <span class="stringliteral">                }</span>
<a name="l23535"></a>23535 <span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;])) {</span>
<a name="l23536"></a>23536 <span class="stringliteral">                    $name = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;];</span>
<a name="l23537"></a>23537 <span class="stringliteral">                } else {</span>
<a name="l23538"></a>23538 <span class="stringliteral">                    break;</span>
<a name="l23539"></a>23539 <span class="stringliteral">                }</span>
<a name="l23540"></a>23540 <span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>value<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>value<span class="stringliteral">&#39;])) {</span>
<a name="l23541"></a>23541 <span class="stringliteral">                    $opt[&#39;</span>v<span class="stringliteral">&#39;] = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>value<span class="stringliteral">&#39;];</span>
<a name="l23542"></a>23542 <span class="stringliteral">                }</span>
<a name="l23543"></a>23543 <span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cols<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cols<span class="stringliteral">&#39;])) {</span>
<a name="l23544"></a>23544 <span class="stringliteral">                    $w = intval($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cols<span class="stringliteral">&#39;]) * $this-&gt;GetStringWidth(chr(32)) * 2;</span>
<a name="l23545"></a>23545 <span class="stringliteral">                } else {</span>
<a name="l23546"></a>23546 <span class="stringliteral">                    $w = 40;</span>
<a name="l23547"></a>23547 <span class="stringliteral">                }</span>
<a name="l23548"></a>23548 <span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>rows<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>rows<span class="stringliteral">&#39;])) {</span>
<a name="l23549"></a>23549 <span class="stringliteral">                    $h = intval($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>rows<span class="stringliteral">&#39;]) * $this-&gt;FontSize * $this-&gt;cell_height_ratio;</span>
<a name="l23550"></a>23550 <span class="stringliteral">                } else {</span>
<a name="l23551"></a>23551 <span class="stringliteral">                    $h = 10;</span>
<a name="l23552"></a>23552 <span class="stringliteral">                }</span>
<a name="l23553"></a>23553 <span class="stringliteral">                $prop[&#39;</span>multiline<span class="stringliteral">&#39;] = &#39;</span><span class="keyword">true</span><span class="stringliteral">&#39;;</span>
<a name="l23554"></a>23554 <span class="stringliteral">                $this-&gt;TextField($name, $w, $h, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span>
<a name="l23555"></a>23555 <span class="stringliteral">                break;</span>
<a name="l23556"></a>23556 <span class="stringliteral">            }</span>
<a name="l23557"></a>23557 <span class="stringliteral">            case &#39;</span>select<span class="stringliteral">&#39;: {</span>
<a name="l23558"></a>23558 <span class="stringliteral">                $h = $this-&gt;FontSize * $this-&gt;cell_height_ratio;</span>
<a name="l23559"></a>23559 <span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span><a class="code" href="pmahomme_2css_2theme__right_8css_8php.html#ae20d3ca2acbfbfe24798ca800435f9f1">size</a><span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span><a class="code" href="pmahomme_2css_2theme__right_8css_8php.html#ae20d3ca2acbfbfe24798ca800435f9f1">size</a><span class="stringliteral">&#39;])) {</span>
<a name="l23560"></a>23560 <span class="stringliteral">                    $h *= ($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span><a class="code" href="pmahomme_2css_2theme__right_8css_8php.html#ae20d3ca2acbfbfe24798ca800435f9f1">size</a><span class="stringliteral">&#39;] + 1);</span>
<a name="l23561"></a>23561 <span class="stringliteral">                }</span>
<a name="l23562"></a>23562 <span class="stringliteral">                $prop = array();</span>
<a name="l23563"></a>23563 <span class="stringliteral">                $opt = array();</span>
<a name="l23564"></a>23564 <span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;])) {</span>
<a name="l23565"></a>23565 <span class="stringliteral">                    $name = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;];</span>
<a name="l23566"></a>23566 <span class="stringliteral">                } else {</span>
<a name="l23567"></a>23567 <span class="stringliteral">                    break;</span>
<a name="l23568"></a>23568 <span class="stringliteral">                }</span>
<a name="l23569"></a>23569 <span class="stringliteral">                $w = 0;</span>
<a name="l23570"></a>23570 <span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>opt<span class="stringliteral">&#39;]) AND !$this-&gt;empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>opt<span class="stringliteral">&#39;])) {</span>
<a name="l23571"></a>23571 <span class="stringliteral">                    $options = explode(&#39;</span>#!NwL!#<span class="stringliteral">&#39;, $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>opt<span class="stringliteral">&#39;]);</span>
<a name="l23572"></a>23572 <span class="stringliteral">                    $values = array();</span>
<a name="l23573"></a>23573 <span class="stringliteral">                    foreach ($options as $val) {</span>
<a name="l23574"></a>23574 <span class="stringliteral">                        if (strpos($val, &#39;</span>#!TaB!#<span class="stringliteral">&#39;) !== false) {</span>
<a name="l23575"></a>23575 <span class="stringliteral">                            $opts = explode(&#39;</span>#!TaB!#<span class="stringliteral">&#39;, $val);</span>
<a name="l23576"></a>23576 <span class="stringliteral">                            $values[] = $opts;</span>
<a name="l23577"></a>23577 <span class="stringliteral">                            $w = max($w, $this-&gt;GetStringWidth($opts[1]));</span>
<a name="l23578"></a>23578 <span class="stringliteral">                        } else {</span>
<a name="l23579"></a>23579 <span class="stringliteral">                            $values[] = $val;</span>
<a name="l23580"></a>23580 <span class="stringliteral">                            $w = max($w, $this-&gt;GetStringWidth($val));</span>
<a name="l23581"></a>23581 <span class="stringliteral">                        }</span>
<a name="l23582"></a>23582 <span class="stringliteral">                    }</span>
<a name="l23583"></a>23583 <span class="stringliteral">                } else {</span>
<a name="l23584"></a>23584 <span class="stringliteral">                    break;</span>
<a name="l23585"></a>23585 <span class="stringliteral">                }</span>
<a name="l23586"></a>23586 <span class="stringliteral">                $w *= 2;</span>
<a name="l23587"></a>23587 <span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>multiple<span class="stringliteral">&#39;]) AND ($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>multiple<span class="stringliteral">&#39;]=&#39;</span>multiple<span class="stringliteral">&#39;)) {</span>
<a name="l23588"></a>23588 <span class="stringliteral">                    $prop[&#39;</span>multipleSelection<span class="stringliteral">&#39;] = &#39;</span><span class="keyword">true</span><span class="stringliteral">&#39;;</span>
<a name="l23589"></a>23589 <span class="stringliteral">                    $this-&gt;ListBox($name, $w, $h, $values, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span>
<a name="l23590"></a>23590 <span class="stringliteral">                } else {</span>
<a name="l23591"></a>23591 <span class="stringliteral">                    $this-&gt;ComboBox($name, $w, $h, $values, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span>
<a name="l23592"></a>23592 <span class="stringliteral">                }</span>
<a name="l23593"></a>23593 <span class="stringliteral">                break;</span>
<a name="l23594"></a>23594 <span class="stringliteral">            }</span>
<a name="l23595"></a>23595 <span class="stringliteral">            case &#39;</span>tcpdf<span class="stringliteral">&#39;: {</span>
<a name="l23596"></a>23596 <span class="stringliteral">                if (defined(&#39;</span>K_TCPDF_CALLS_IN_HTML<span class="stringliteral">&#39;) AND (K_TCPDF_CALLS_IN_HTML === true)) {</span>
<a name="l23597"></a>23597 <span class="stringliteral">                    // Special tag used to call TCPDF methods</span>
<a name="l23598"></a>23598 <span class="stringliteral">                    if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>method<span class="stringliteral">&#39;])) {</span>
<a name="l23599"></a>23599 <span class="stringliteral">                        $tcpdf_method = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>method<span class="stringliteral">&#39;];</span>
<a name="l23600"></a>23600 <span class="stringliteral">                        if (method_exists($this, $tcpdf_method)) {</span>
<a name="l23601"></a>23601 <span class="stringliteral">                            if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>params<span class="stringliteral">&#39;]) AND (!empty($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>params<span class="stringliteral">&#39;]))) {</span>
<a name="l23602"></a>23602 <span class="stringliteral">                                $params = unserialize(urldecode($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>params<span class="stringliteral">&#39;]));</span>
<a name="l23603"></a>23603 <span class="stringliteral">                                call_user_func_array(array($this, $tcpdf_method), $params);</span>
<a name="l23604"></a>23604 <span class="stringliteral">                            } else {</span>
<a name="l23605"></a>23605 <span class="stringliteral">                                $this-&gt;$tcpdf_method();</span>
<a name="l23606"></a>23606 <span class="stringliteral">                            }</span>
<a name="l23607"></a>23607 <span class="stringliteral">                            $this-&gt;newline = true;</span>
<a name="l23608"></a>23608 <span class="stringliteral">                        }</span>
<a name="l23609"></a>23609 <span class="stringliteral">                    }</span>
<a name="l23610"></a>23610 <span class="stringliteral">                }</span>
<a name="l23611"></a>23611 <span class="stringliteral">                break;</span>
<a name="l23612"></a>23612 <span class="stringliteral">            }</span>
<a name="l23613"></a>23613 <span class="stringliteral">            default: {</span>
<a name="l23614"></a>23614 <span class="stringliteral">                break;</span>
<a name="l23615"></a>23615 <span class="stringliteral">            }</span>
<a name="l23616"></a>23616 <span class="stringliteral">        }</span>
<a name="l23617"></a>23617 <span class="stringliteral">        // define tags that support borders and background colors</span>
<a name="l23618"></a>23618 <span class="stringliteral">        $bordertags = array(&#39;</span>blockquote<span class="charliteral">&#39;,&#39;</span>br<span class="charliteral">&#39;,&#39;</span>dd<span class="charliteral">&#39;,&#39;</span>dl<span class="charliteral">&#39;,&#39;</span>div<span class="charliteral">&#39;,&#39;</span>dt<span class="charliteral">&#39;,&#39;</span><a class="code" href="original_2css_2theme__right_8css_8php.html#a304cd561b05d45e8a6c4f1ff995b553f" title="login form">h1</a><span class="charliteral">&#39;,&#39;</span>h2<span class="charliteral">&#39;,&#39;</span>h3<span class="charliteral">&#39;,&#39;</span>h4<span class="charliteral">&#39;,&#39;</span>h5<span class="charliteral">&#39;,&#39;</span>h6<span class="charliteral">&#39;,&#39;</span>hr<span class="charliteral">&#39;,&#39;</span>li<span class="charliteral">&#39;,&#39;</span>ol<span class="charliteral">&#39;,&#39;</span>p<span class="charliteral">&#39;,&#39;</span>pre<span class="charliteral">&#39;,&#39;</span>ul<span class="charliteral">&#39;,&#39;</span>tcpdf<span class="charliteral">&#39;,&#39;</span>table<span class="stringliteral">&#39;);</span>
<a name="l23619"></a>23619 <span class="stringliteral">        if (in_array($tag[&#39;</span>value<span class="stringliteral">&#39;], $bordertags)) {</span>
<a name="l23620"></a>23620 <span class="stringliteral">            // set border</span>
<a name="l23621"></a>23621 <span class="stringliteral">            $dom[$key][&#39;</span>borderposition<span class="stringliteral">&#39;] = $this-&gt;getBorderStartPosition();</span>
<a name="l23622"></a>23622 <span class="stringliteral">        }</span>
<a name="l23623"></a>23623 <span class="stringliteral">        if ($dom[$key][&#39;</span><span class="keyword">self</span><span class="stringliteral">&#39;] AND isset($dom[$key][&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>pagebreakafter<span class="stringliteral">&#39;])) {</span>
<a name="l23624"></a>23624 <span class="stringliteral">            $pba = $dom[$key][&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>pagebreakafter<span class="stringliteral">&#39;];</span>
<a name="l23625"></a>23625 <span class="stringliteral">            // check for pagebreak</span>
<a name="l23626"></a>23626 <span class="stringliteral">            if (($pba == &#39;</span><span class="keyword">true</span><span class="stringliteral">&#39;) OR ($pba == &#39;</span><a class="code" href="pmahomme_2css_2theme__right_8css_8php.html#a361a2bf748f322798d4f19476600f204">left</a><span class="stringliteral">&#39;) OR ($pba == &#39;</span>right<span class="stringliteral">&#39;)) {</span>
<a name="l23627"></a>23627 <span class="stringliteral">                // add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l23628"></a>23628 <span class="stringliteral">                $this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1);</span>
<a name="l23629"></a>23629 <span class="stringliteral">            }</span>
<a name="l23630"></a>23630 <span class="stringliteral">            if ((($pba == &#39;</span><a class="code" href="pmahomme_2css_2theme__right_8css_8php.html#a361a2bf748f322798d4f19476600f204">left</a><span class="stringliteral">&#39;) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) == 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) != 0))))</span>
<a name="l23631"></a>23631 <span class="stringliteral">                OR (($pba == &#39;</span>right<span class="stringliteral">&#39;) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) != 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) == 0))))) {</span>
<a name="l23632"></a>23632 <span class="stringliteral">                // add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l23633"></a>23633 <span class="stringliteral">                $this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1);</span>
<a name="l23634"></a>23634 <span class="stringliteral">            }</span>
<a name="l23635"></a>23635 <span class="stringliteral">        }</span>
<a name="l23636"></a>23636 <span class="stringliteral">        return $dom;</span>
<a name="l23637"></a>23637 <span class="stringliteral">    }</span>
<a name="l23638"></a>23638 <span class="stringliteral"></span><span class="comment"></span>
<a name="l23639"></a>23639 <span class="comment">    /**</span>
<a name="l23640"></a>23640 <span class="comment">     * Process closing tags.</span>
<a name="l23641"></a>23641 <span class="comment">     * @param $dom (array) html dom array</span>
<a name="l23642"></a>23642 <span class="comment">     * @param $key (int) current element id</span>
<a name="l23643"></a>23643 <span class="comment">     * @param $cell (boolean) if true add the default left (or right if RTL) padding to each new line (default false).</span>
<a name="l23644"></a>23644 <span class="comment">     * @param $maxbottomliney (int) maximum y value of current line</span>
<a name="l23645"></a>23645 <span class="comment">     * @return $dom array</span>
<a name="l23646"></a>23646 <span class="comment">     * @protected</span>
<a name="l23647"></a>23647 <span class="comment">     */</span>
<a name="l23648"></a><a class="code" href="classTCPDF.html#a52ace3318c0320d4059a1b969cc2eb20">23648</a>     protected function closeHTMLTagHandler($dom, $key, $cell, $maxbottomliney=0) {
<a name="l23649"></a>23649         $tag = $dom[$key];
<a name="l23650"></a>23650         $parent = $dom[($dom[$key][&#39;parent<span class="stringliteral">&#39;])];</span>
<a name="l23651"></a>23651 <span class="stringliteral">        $lasttag = ((!isset($dom[($key + 1)])) OR ((!isset($dom[($key + 2)])) AND ($dom[($key + 1)][&#39;</span>value<span class="stringliteral">&#39;] == &#39;</span>marker<span class="stringliteral">&#39;)));</span>
<a name="l23652"></a>23652 <span class="stringliteral">        $in_table_head = false;</span>
<a name="l23653"></a>23653 <span class="stringliteral">        // maximum x position (used to draw borders)</span>
<a name="l23654"></a>23654 <span class="stringliteral">        if ($this-&gt;rtl) {</span>
<a name="l23655"></a>23655 <span class="stringliteral">            $xmax = $this-&gt;w;</span>
<a name="l23656"></a>23656 <span class="stringliteral">        } else {</span>
<a name="l23657"></a>23657 <span class="stringliteral">            $xmax = 0;</span>
<a name="l23658"></a>23658 <span class="stringliteral">        }</span>
<a name="l23659"></a>23659 <span class="stringliteral">        if ($tag[&#39;</span>block<span class="stringliteral">&#39;]) {</span>
<a name="l23660"></a>23660 <span class="stringliteral">            $hbz = 0; // distance from y to line bottom</span>
<a name="l23661"></a>23661 <span class="stringliteral">            $hb = 0; // vertical space between block tags</span>
<a name="l23662"></a>23662 <span class="stringliteral">            // calculate vertical space for block tags</span>
<a name="l23663"></a>23663 <span class="stringliteral">            if (isset($this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>h<span class="stringliteral">&#39;]) AND ($this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>h<span class="stringliteral">&#39;] &gt;= 0)) {</span>
<a name="l23664"></a>23664 <span class="stringliteral">                $pre_h = $this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>h<span class="stringliteral">&#39;];</span>
<a name="l23665"></a>23665 <span class="stringliteral">            } elseif (isset($parent[&#39;</span>fontsize<span class="stringliteral">&#39;])) {</span>
<a name="l23666"></a>23666 <span class="stringliteral">                $pre_h = (($parent[&#39;</span>fontsize<span class="stringliteral">&#39;] / $this-&gt;k) * $this-&gt;cell_height_ratio);</span>
<a name="l23667"></a>23667 <span class="stringliteral">            } else {</span>
<a name="l23668"></a>23668 <span class="stringliteral">                $pre_h = $this-&gt;FontSize * $this-&gt;cell_height_ratio;</span>
<a name="l23669"></a>23669 <span class="stringliteral">            }</span>
<a name="l23670"></a>23670 <span class="stringliteral">            if (isset($this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>n<span class="stringliteral">&#39;])) {</span>
<a name="l23671"></a>23671 <span class="stringliteral">                $n = $this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>n<span class="stringliteral">&#39;];</span>
<a name="l23672"></a>23672 <span class="stringliteral">            } elseif (preg_match(&#39;</span>/[h][0-9]/<span class="stringliteral">&#39;, $tag[&#39;</span>value<span class="stringliteral">&#39;]) &gt; 0) {</span>
<a name="l23673"></a>23673 <span class="stringliteral">                $n = 0.6;</span>
<a name="l23674"></a>23674 <span class="stringliteral">            } else {</span>
<a name="l23675"></a>23675 <span class="stringliteral">                $n = 1;</span>
<a name="l23676"></a>23676 <span class="stringliteral">            }</span>
<a name="l23677"></a>23677 <span class="stringliteral">            if ((!isset($this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]])) AND ($tag[&#39;</span>value<span class="stringliteral">&#39;] == &#39;</span>div<span class="stringliteral">&#39;)) {</span>
<a name="l23678"></a>23678 <span class="stringliteral">                $hb = 0;</span>
<a name="l23679"></a>23679 <span class="stringliteral">            } else {</span>
<a name="l23680"></a>23680 <span class="stringliteral">                $hb = ($n * $pre_h);</span>
<a name="l23681"></a>23681 <span class="stringliteral">            }</span>
<a name="l23682"></a>23682 <span class="stringliteral">            if ($maxbottomliney &gt; $this-&gt;PageBreakTrigger) {</span>
<a name="l23683"></a>23683 <span class="stringliteral">                $hbz = ($this-&gt;FontSize * $this-&gt;cell_height_ratio);</span>
<a name="l23684"></a>23684 <span class="stringliteral">            } elseif ($this-&gt;y &lt; $maxbottomliney) {</span>
<a name="l23685"></a>23685 <span class="stringliteral">                $hbz = ($maxbottomliney - $this-&gt;y);</span>
<a name="l23686"></a>23686 <span class="stringliteral">            }</span>
<a name="l23687"></a>23687 <span class="stringliteral">        }</span>
<a name="l23688"></a>23688 <span class="stringliteral">        // Closing tag</span>
<a name="l23689"></a>23689 <span class="stringliteral">        switch($tag[&#39;</span>value<span class="stringliteral">&#39;]) {</span>
<a name="l23690"></a>23690 <span class="stringliteral">            case &#39;</span>tr<span class="stringliteral">&#39;: {</span>
<a name="l23691"></a>23691 <span class="stringliteral">                $table_el = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>parent<span class="stringliteral">&#39;];</span>
<a name="l23692"></a>23692 <span class="stringliteral">                if (!isset($parent[&#39;</span>endy<span class="stringliteral">&#39;])) {</span>
<a name="l23693"></a>23693 <span class="stringliteral">                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;] = $this-&gt;y;</span>
<a name="l23694"></a>23694 <span class="stringliteral">                    $parent[&#39;</span>endy<span class="stringliteral">&#39;] = $this-&gt;y;</span>
<a name="l23695"></a>23695 <span class="stringliteral">                }</span>
<a name="l23696"></a>23696 <span class="stringliteral">                if (!isset($parent[&#39;</span>endpage<span class="stringliteral">&#39;])) {</span>
<a name="l23697"></a>23697 <span class="stringliteral">                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;] = $this-&gt;page;</span>
<a name="l23698"></a>23698 <span class="stringliteral">                    $parent[&#39;</span>endpage<span class="stringliteral">&#39;] = $this-&gt;page;</span>
<a name="l23699"></a>23699 <span class="stringliteral">                }</span>
<a name="l23700"></a>23700 <span class="stringliteral">                if (!isset($parent[&#39;</span>endcolumn<span class="stringliteral">&#39;])) {</span>
<a name="l23701"></a>23701 <span class="stringliteral">                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;] = $this-&gt;current_column;</span>
<a name="l23702"></a>23702 <span class="stringliteral">                    $parent[&#39;</span>endcolumn<span class="stringliteral">&#39;] = $this-&gt;current_column;</span>
<a name="l23703"></a>23703 <span class="stringliteral">                }</span>
<a name="l23704"></a>23704 <span class="stringliteral">                // update row-spanned cells</span>
<a name="l23705"></a>23705 <span class="stringliteral">                if (isset($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;])) {</span>
<a name="l23706"></a>23706 <span class="stringliteral">                    foreach ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span>
<a name="l23707"></a>23707 <span class="stringliteral">                        $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>rowspan<span class="stringliteral">&#39;] -= 1;</span>
<a name="l23708"></a>23708 <span class="stringliteral">                        if ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>rowspan<span class="stringliteral">&#39;] == 0) {</span>
<a name="l23709"></a>23709 <span class="stringliteral">                            if (($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;] == $parent[&#39;</span>endpage<span class="stringliteral">&#39;]) AND ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;] == $parent[&#39;</span>endcolumn<span class="stringliteral">&#39;])) {</span>
<a name="l23710"></a>23710 <span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;] = max($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;], $parent[&#39;</span>endy<span class="stringliteral">&#39;]);</span>
<a name="l23711"></a>23711 <span class="stringliteral">                            } elseif (($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;] &gt; $parent[&#39;</span>endpage<span class="stringliteral">&#39;]) OR ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;] &gt; $parent[&#39;</span>endcolumn<span class="stringliteral">&#39;])) {</span>
<a name="l23712"></a>23712 <span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;];</span>
<a name="l23713"></a>23713 <span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;];</span>
<a name="l23714"></a>23714 <span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;];</span>
<a name="l23715"></a>23715 <span class="stringliteral">                            }</span>
<a name="l23716"></a>23716 <span class="stringliteral">                        }</span>
<a name="l23717"></a>23717 <span class="stringliteral">                    }</span>
<a name="l23718"></a>23718 <span class="stringliteral">                    // report new endy and endpage to the rowspanned cells</span>
<a name="l23719"></a>23719 <span class="stringliteral">                    foreach ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span>
<a name="l23720"></a>23720 <span class="stringliteral">                        if ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>rowspan<span class="stringliteral">&#39;] == 0) {</span>
<a name="l23721"></a>23721 <span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;] = max($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;], $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;]);</span>
<a name="l23722"></a>23722 <span class="stringliteral">                            $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;];</span>
<a name="l23723"></a>23723 <span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;] = max($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;], $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;]);</span>
<a name="l23724"></a>23724 <span class="stringliteral">                            $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;];</span>
<a name="l23725"></a>23725 <span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;] = max($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;], $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;]);</span>
<a name="l23726"></a>23726 <span class="stringliteral">                            $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;];</span>
<a name="l23727"></a>23727 <span class="stringliteral">                        }</span>
<a name="l23728"></a>23728 <span class="stringliteral">                    }</span>
<a name="l23729"></a>23729 <span class="stringliteral">                    // update remaining rowspanned cells</span>
<a name="l23730"></a>23730 <span class="stringliteral">                    foreach ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span>
<a name="l23731"></a>23731 <span class="stringliteral">                        if ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>rowspan<span class="stringliteral">&#39;] == 0) {</span>
<a name="l23732"></a>23732 <span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;] = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;];</span>
<a name="l23733"></a>23733 <span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;] = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;];</span>
<a name="l23734"></a>23734 <span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;] = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;];</span>
<a name="l23735"></a>23735 <span class="stringliteral">                        }</span>
<a name="l23736"></a>23736 <span class="stringliteral">                    }</span>
<a name="l23737"></a>23737 <span class="stringliteral">                }</span>
<a name="l23738"></a>23738 <span class="stringliteral">                $this-&gt;setPage($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;]);</span>
<a name="l23739"></a>23739 <span class="stringliteral">                if ($this-&gt;num_columns &gt; 1) {</span>
<a name="l23740"></a>23740 <span class="stringliteral">                    $this-&gt;selectColumn($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;]);</span>
<a name="l23741"></a>23741 <span class="stringliteral">                }</span>
<a name="l23742"></a>23742 <span class="stringliteral">                $this-&gt;y = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;];</span>
<a name="l23743"></a>23743 <span class="stringliteral">                if (isset($dom[$table_el][&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cellspacing<span class="stringliteral">&#39;])) {</span>
<a name="l23744"></a>23744 <span class="stringliteral">                    $this-&gt;y += $this-&gt;getHTMLUnitToUnits($dom[$table_el][&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cellspacing<span class="stringliteral">&#39;], 1, &#39;</span>px<span class="stringliteral">&#39;);</span>
<a name="l23745"></a>23745 <span class="stringliteral">                } elseif (isset($dom[$table_el][&#39;</span>border-spacing<span class="stringliteral">&#39;])) {</span>
<a name="l23746"></a>23746 <span class="stringliteral">                    $this-&gt;y += $dom[$table_el][&#39;</span>border-spacing<span class="stringliteral">&#39;][&#39;</span>V<span class="stringliteral">&#39;];</span>
<a name="l23747"></a>23747 <span class="stringliteral">                }</span>
<a name="l23748"></a>23748 <span class="stringliteral">                $this-&gt;Ln(0, $cell);</span>
<a name="l23749"></a>23749 <span class="stringliteral">                if ($this-&gt;current_column == $parent[&#39;</span>startcolumn<span class="stringliteral">&#39;]) {</span>
<a name="l23750"></a>23750 <span class="stringliteral">                    $this-&gt;x = $parent[&#39;</span>startx<span class="stringliteral">&#39;];</span>
<a name="l23751"></a>23751 <span class="stringliteral">                }</span>
<a name="l23752"></a>23752 <span class="stringliteral">                // account for booklet mode</span>
<a name="l23753"></a>23753 <span class="stringliteral">                if ($this-&gt;page &gt; $parent[&#39;</span>startpage<span class="stringliteral">&#39;]) {</span>
<a name="l23754"></a>23754 <span class="stringliteral">                    if (($this-&gt;rtl) AND ($this-&gt;pagedim[$this-&gt;page][&#39;</span>orm<span class="stringliteral">&#39;] != $this-&gt;pagedim[$parent[&#39;</span>startpage<span class="stringliteral">&#39;]][&#39;</span>orm<span class="stringliteral">&#39;])) {</span>
<a name="l23755"></a>23755 <span class="stringliteral">                        $this-&gt;x -= ($this-&gt;pagedim[$this-&gt;page][&#39;</span>orm<span class="stringliteral">&#39;] - $this-&gt;pagedim[$parent[&#39;</span>startpage<span class="stringliteral">&#39;]][&#39;</span>orm<span class="stringliteral">&#39;]);</span>
<a name="l23756"></a>23756 <span class="stringliteral">                    } elseif ((!$this-&gt;rtl) AND ($this-&gt;pagedim[$this-&gt;page][&#39;</span>olm<span class="stringliteral">&#39;] != $this-&gt;pagedim[$parent[&#39;</span>startpage<span class="stringliteral">&#39;]][&#39;</span>olm<span class="stringliteral">&#39;])) {</span>
<a name="l23757"></a>23757 <span class="stringliteral">                        $this-&gt;x += ($this-&gt;pagedim[$this-&gt;page][&#39;</span>olm<span class="stringliteral">&#39;] - $this-&gt;pagedim[$parent[&#39;</span>startpage<span class="stringliteral">&#39;]][&#39;</span>olm<span class="stringliteral">&#39;]);</span>
<a name="l23758"></a>23758 <span class="stringliteral">                    }</span>
<a name="l23759"></a>23759 <span class="stringliteral">                }</span>
<a name="l23760"></a>23760 <span class="stringliteral">                break;</span>
<a name="l23761"></a>23761 <span class="stringliteral">            }</span>
<a name="l23762"></a>23762 <span class="stringliteral">            case &#39;</span>tablehead<span class="stringliteral">&#39;:</span>
<a name="l23763"></a>23763 <span class="stringliteral">                // closing tag used for the thead part</span>
<a name="l23764"></a>23764 <span class="stringliteral">                $in_table_head = true;</span>
<a name="l23765"></a>23765 <span class="stringliteral">                $this-&gt;inthead = false;</span>
<a name="l23766"></a>23766 <span class="stringliteral">            case &#39;</span>table<span class="stringliteral">&#39;: {</span>
<a name="l23767"></a>23767 <span class="stringliteral">                $table_el = $parent;</span>
<a name="l23768"></a>23768 <span class="stringliteral">                // set default border</span>
<a name="l23769"></a>23769 <span class="stringliteral">                if (isset($table_el[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>border<span class="stringliteral">&#39;]) AND ($table_el[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>border<span class="stringliteral">&#39;] &gt; 0)) {</span>
<a name="l23770"></a>23770 <span class="stringliteral">                    // set default border</span>
<a name="l23771"></a>23771 <span class="stringliteral">                    $border = array(&#39;</span>LTRB<span class="stringliteral">&#39; =&gt; array(&#39;</span><a class="code" href="pmahomme_2css_2theme__left_8css_8php.html#a8eba97439dc06bd5160020dd878c1070">width</a><span class="stringliteral">&#39; =&gt; $this-&gt;getCSSBorderWidth($table_el[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>border<span class="stringliteral">&#39;]), &#39;</span>cap<span class="stringliteral">&#39;=&gt;&#39;</span>square<span class="stringliteral">&#39;, &#39;</span>join<span class="stringliteral">&#39;=&gt;&#39;</span>miter<span class="stringliteral">&#39;, &#39;</span>dash<span class="stringliteral">&#39;=&gt; 0, &#39;</span><a class="code" href="original_2css_2theme__left_8css_8php.html#ac04e2a463631b69c8f70784275a056d6">color</a><span class="stringliteral">&#39;=&gt;array(0,0,0)));</span>
<a name="l23772"></a>23772 <span class="stringliteral">                } else {</span>
<a name="l23773"></a>23773 <span class="stringliteral">                    $border = 0;</span>
<a name="l23774"></a>23774 <span class="stringliteral">                }</span>
<a name="l23775"></a>23775 <span class="stringliteral">                $default_border = $border;</span>
<a name="l23776"></a>23776 <span class="stringliteral">                // fix bottom line alignment of last line before page break</span>
<a name="l23777"></a>23777 <span class="stringliteral">                foreach ($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>trids<span class="stringliteral">&#39;] as $j =&gt; $trkey) {</span>
<a name="l23778"></a>23778 <span class="stringliteral">                    // update row-spanned cells</span>
<a name="l23779"></a>23779 <span class="stringliteral">                    if (isset($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;])) {</span>
<a name="l23780"></a>23780 <span class="stringliteral">                        foreach ($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span>
<a name="l23781"></a>23781 <span class="stringliteral">                            if ($trwsp[&#39;</span>trid<span class="stringliteral">&#39;] == $trkey) {</span>
<a name="l23782"></a>23782 <span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>mrowspan<span class="stringliteral">&#39;] -= 1;</span>
<a name="l23783"></a>23783 <span class="stringliteral">                            }</span>
<a name="l23784"></a>23784 <span class="stringliteral">                            if (isset($prevtrkey) AND ($trwsp[&#39;</span>trid<span class="stringliteral">&#39;] == $prevtrkey) AND ($trwsp[&#39;</span>mrowspan<span class="stringliteral">&#39;] &gt;= 0)) {</span>
<a name="l23785"></a>23785 <span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>trid<span class="stringliteral">&#39;] = $trkey;</span>
<a name="l23786"></a>23786 <span class="stringliteral">                            }</span>
<a name="l23787"></a>23787 <span class="stringliteral">                        }</span>
<a name="l23788"></a>23788 <span class="stringliteral">                    }</span>
<a name="l23789"></a>23789 <span class="stringliteral">                    if (isset($prevtrkey) AND ($dom[$trkey][&#39;</span>startpage<span class="stringliteral">&#39;] &gt; $dom[$prevtrkey][&#39;</span>endpage<span class="stringliteral">&#39;])) {</span>
<a name="l23790"></a>23790 <span class="stringliteral">                        $pgendy = $this-&gt;pagedim[$dom[$prevtrkey][&#39;</span>endpage<span class="stringliteral">&#39;]][&#39;</span>hk<span class="stringliteral">&#39;] - $this-&gt;pagedim[$dom[$prevtrkey][&#39;</span>endpage<span class="stringliteral">&#39;]][&#39;</span>bm<span class="stringliteral">&#39;];</span>
<a name="l23791"></a>23791 <span class="stringliteral">                        $dom[$prevtrkey][&#39;</span>endy<span class="stringliteral">&#39;] = $pgendy;</span>
<a name="l23792"></a>23792 <span class="stringliteral">                        // update row-spanned cells</span>
<a name="l23793"></a>23793 <span class="stringliteral">                        if (isset($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;])) {</span>
<a name="l23794"></a>23794 <span class="stringliteral">                            foreach ($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span>
<a name="l23795"></a>23795 <span class="stringliteral">                                if (($trwsp[&#39;</span>trid<span class="stringliteral">&#39;] == $trkey) AND ($trwsp[&#39;</span>mrowspan<span class="stringliteral">&#39;] &gt; 1) AND ($trwsp[&#39;</span>endpage<span class="stringliteral">&#39;] == $dom[$prevtrkey][&#39;</span>endpage<span class="stringliteral">&#39;])) {</span>
<a name="l23796"></a>23796 <span class="stringliteral">                                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;] = $pgendy;</span>
<a name="l23797"></a>23797 <span class="stringliteral">                                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>mrowspan<span class="stringliteral">&#39;] = -1;</span>
<a name="l23798"></a>23798 <span class="stringliteral">                                }</span>
<a name="l23799"></a>23799 <span class="stringliteral">                            }</span>
<a name="l23800"></a>23800 <span class="stringliteral">                        }</span>
<a name="l23801"></a>23801 <span class="stringliteral">                    }</span>
<a name="l23802"></a>23802 <span class="stringliteral">                    $prevtrkey = $trkey;</span>
<a name="l23803"></a>23803 <span class="stringliteral">                    $table_el = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])];</span>
<a name="l23804"></a>23804 <span class="stringliteral">                }</span>
<a name="l23805"></a>23805 <span class="stringliteral">                // for each row</span>
<a name="l23806"></a>23806 <span class="stringliteral">                if (count($table_el[&#39;</span>trids<span class="stringliteral">&#39;]) &gt; 0) {</span>
<a name="l23807"></a>23807 <span class="stringliteral">                    unset($xmax);</span>
<a name="l23808"></a>23808 <span class="stringliteral">                }</span>
<a name="l23809"></a>23809 <span class="stringliteral">                foreach ($table_el[&#39;</span>trids<span class="stringliteral">&#39;] as $j =&gt; $trkey) {</span>
<a name="l23810"></a>23810 <span class="stringliteral">                    $parent = $dom[$trkey];</span>
<a name="l23811"></a>23811 <span class="stringliteral">                    if (!isset($xmax)) {</span>
<a name="l23812"></a>23812 <span class="stringliteral">                        $xmax = $parent[&#39;</span>cellpos<span class="stringliteral">&#39;][(count($parent[&#39;</span>cellpos<span class="stringliteral">&#39;]) - 1)][&#39;</span>endx<span class="stringliteral">&#39;];</span>
<a name="l23813"></a>23813 <span class="stringliteral">                    }</span>
<a name="l23814"></a>23814 <span class="stringliteral">                    // for each cell on the row</span>
<a name="l23815"></a>23815 <span class="stringliteral">                    foreach ($parent[&#39;</span>cellpos<span class="stringliteral">&#39;] as $k =&gt; $cellpos) {</span>
<a name="l23816"></a>23816 <span class="stringliteral">                        if (isset($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;]) AND ($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;] &gt;= 0)) {</span>
<a name="l23817"></a>23817 <span class="stringliteral">                            $cellpos[&#39;</span>startx<span class="stringliteral">&#39;] = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>startx<span class="stringliteral">&#39;];</span>
<a name="l23818"></a>23818 <span class="stringliteral">                            $cellpos[&#39;</span>endx<span class="stringliteral">&#39;] = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>endx<span class="stringliteral">&#39;];</span>
<a name="l23819"></a>23819 <span class="stringliteral">                            $endy = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;];</span>
<a name="l23820"></a>23820 <span class="stringliteral">                            $startpage = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>startpage<span class="stringliteral">&#39;];</span>
<a name="l23821"></a>23821 <span class="stringliteral">                            $endpage = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;];</span>
<a name="l23822"></a>23822 <span class="stringliteral">                            $startcolumn = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>startcolumn<span class="stringliteral">&#39;];</span>
<a name="l23823"></a>23823 <span class="stringliteral">                            $endcolumn = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;];</span>
<a name="l23824"></a>23824 <span class="stringliteral">                        } else {</span>
<a name="l23825"></a>23825 <span class="stringliteral">                            $endy = $parent[&#39;</span>endy<span class="stringliteral">&#39;];</span>
<a name="l23826"></a>23826 <span class="stringliteral">                            $startpage = $parent[&#39;</span>startpage<span class="stringliteral">&#39;];</span>
<a name="l23827"></a>23827 <span class="stringliteral">                            $endpage = $parent[&#39;</span>endpage<span class="stringliteral">&#39;];</span>
<a name="l23828"></a>23828 <span class="stringliteral">                            $startcolumn = $parent[&#39;</span>startcolumn<span class="stringliteral">&#39;];</span>
<a name="l23829"></a>23829 <span class="stringliteral">                            $endcolumn = $parent[&#39;</span>endcolumn<span class="stringliteral">&#39;];</span>
<a name="l23830"></a>23830 <span class="stringliteral">                        }</span>
<a name="l23831"></a>23831 <span class="stringliteral">                        if ($this-&gt;num_columns == 0) {</span>
<a name="l23832"></a>23832 <span class="stringliteral">                            $this-&gt;num_columns = 1;</span>
<a name="l23833"></a>23833 <span class="stringliteral">                        }</span>
<a name="l23834"></a>23834 <span class="stringliteral">                        if (isset($cellpos[&#39;</span>border<span class="stringliteral">&#39;])) {</span>
<a name="l23835"></a>23835 <span class="stringliteral">                            $border = $cellpos[&#39;</span>border<span class="stringliteral">&#39;];</span>
<a name="l23836"></a>23836 <span class="stringliteral">                        }</span>
<a name="l23837"></a>23837 <span class="stringliteral">                        if (isset($cellpos[&#39;</span>bgcolor<span class="stringliteral">&#39;]) AND ($cellpos[&#39;</span>bgcolor<span class="stringliteral">&#39;]) !== false) {</span>
<a name="l23838"></a>23838 <span class="stringliteral">                            $this-&gt;SetFillColorArray($cellpos[&#39;</span>bgcolor<span class="stringliteral">&#39;]);</span>
<a name="l23839"></a>23839 <span class="stringliteral">                            $fill = true;</span>
<a name="l23840"></a>23840 <span class="stringliteral">                        } else {</span>
<a name="l23841"></a>23841 <span class="stringliteral">                            $fill = false;</span>
<a name="l23842"></a>23842 <span class="stringliteral">                        }</span>
<a name="l23843"></a>23843 <span class="stringliteral">                        $x = $cellpos[&#39;</span>startx<span class="stringliteral">&#39;];</span>
<a name="l23844"></a>23844 <span class="stringliteral">                        $y = $parent[&#39;</span>starty<span class="stringliteral">&#39;];</span>
<a name="l23845"></a>23845 <span class="stringliteral">                        $starty = $y;</span>
<a name="l23846"></a>23846 <span class="stringliteral">                        $w = abs($cellpos[&#39;</span>endx<span class="stringliteral">&#39;] - $cellpos[&#39;</span>startx<span class="stringliteral">&#39;]);</span>
<a name="l23847"></a>23847 <span class="stringliteral">                        // get border modes</span>
<a name="l23848"></a>23848 <span class="stringliteral">                        $border_start = $this-&gt;getBorderMode($border, $position=&#39;</span>start<span class="stringliteral">&#39;);</span>
<a name="l23849"></a>23849 <span class="stringliteral">                        $border_end = $this-&gt;getBorderMode($border, $position=&#39;</span>end<span class="stringliteral">&#39;);</span>
<a name="l23850"></a>23850 <span class="stringliteral">                        $border_middle = $this-&gt;getBorderMode($border, $position=&#39;</span>middle<span class="stringliteral">&#39;);</span>
<a name="l23851"></a>23851 <span class="stringliteral">                        // design borders around HTML cells.</span>
<a name="l23852"></a>23852 <span class="stringliteral">                        for ($page = $startpage; $page &lt;= $endpage; ++$page) { // for each page</span>
<a name="l23853"></a>23853 <span class="stringliteral">                            $ccode = &#39;</span><span class="stringliteral">&#39;;</span>
<a name="l23854"></a>23854 <span class="stringliteral">                            $this-&gt;setPage($page);</span>
<a name="l23855"></a>23855 <span class="stringliteral">                            if ($this-&gt;num_columns &lt; 2) {</span>
<a name="l23856"></a>23856 <span class="stringliteral">                                // single-column mode</span>
<a name="l23857"></a>23857 <span class="stringliteral">                                $this-&gt;x = $x;</span>
<a name="l23858"></a>23858 <span class="stringliteral">                                $this-&gt;y = $this-&gt;tMargin;</span>
<a name="l23859"></a>23859 <span class="stringliteral">                            }</span>
<a name="l23860"></a>23860 <span class="stringliteral">                            // account for margin changes</span>
<a name="l23861"></a>23861 <span class="stringliteral">                            if ($page &gt; $startpage) {</span>
<a name="l23862"></a>23862 <span class="stringliteral">                                if (($this-&gt;rtl) AND ($this-&gt;pagedim[$page][&#39;</span>orm<span class="stringliteral">&#39;] != $this-&gt;pagedim[$startpage][&#39;</span>orm<span class="stringliteral">&#39;])) {</span>
<a name="l23863"></a>23863 <span class="stringliteral">                                    $this-&gt;x -= ($this-&gt;pagedim[$page][&#39;</span>orm<span class="stringliteral">&#39;] - $this-&gt;pagedim[$startpage][&#39;</span>orm<span class="stringliteral">&#39;]);</span>
<a name="l23864"></a>23864 <span class="stringliteral">                                } elseif ((!$this-&gt;rtl) AND ($this-&gt;pagedim[$page][&#39;</span>olm<span class="stringliteral">&#39;] != $this-&gt;pagedim[$startpage][&#39;</span>olm<span class="stringliteral">&#39;])) {</span>
<a name="l23865"></a>23865 <span class="stringliteral">                                    $this-&gt;x += ($this-&gt;pagedim[$page][&#39;</span>olm<span class="stringliteral">&#39;] - $this-&gt;pagedim[$startpage][&#39;</span>olm<span class="stringliteral">&#39;]);</span>
<a name="l23866"></a>23866 <span class="stringliteral">                                }</span>
<a name="l23867"></a>23867 <span class="stringliteral">                            }</span>
<a name="l23868"></a>23868 <span class="stringliteral">                            if ($startpage == $endpage) { // single page</span>
<a name="l23869"></a>23869 <span class="stringliteral">                                $deltacol = 0;</span>
<a name="l23870"></a>23870 <span class="stringliteral">                                $deltath = 0;</span>
<a name="l23871"></a>23871 <span class="stringliteral">                                for ($column = $startcolumn; $column &lt;= $endcolumn; ++$column) { // for each column</span>
<a name="l23872"></a>23872 <span class="stringliteral">                                    $this-&gt;selectColumn($column);</span>
<a name="l23873"></a>23873 <span class="stringliteral">                                    if ($startcolumn == $endcolumn) { // single column</span>
<a name="l23874"></a>23874 <span class="stringliteral">                                        $cborder = $border;</span>
<a name="l23875"></a>23875 <span class="stringliteral">                                        $h = $endy - $parent[&#39;</span>starty<span class="stringliteral">&#39;];</span>
<a name="l23876"></a>23876 <span class="stringliteral">                                        $this-&gt;y = $y;</span>
<a name="l23877"></a>23877 <span class="stringliteral">                                        $this-&gt;x = $x;</span>
<a name="l23878"></a>23878 <span class="stringliteral">                                    } elseif ($column == $startcolumn) { // first column</span>
<a name="l23879"></a>23879 <span class="stringliteral">                                        $cborder = $border_start;</span>
<a name="l23880"></a>23880 <span class="stringliteral">                                        $this-&gt;y = $starty;</span>
<a name="l23881"></a>23881 <span class="stringliteral">                                        $this-&gt;x = $x;</span>
<a name="l23882"></a>23882 <span class="stringliteral">                                        $h = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;</span>
<a name="l23883"></a>23883 <span class="stringliteral">                                        if ($this-&gt;rtl) {</span>
<a name="l23884"></a>23884 <span class="stringliteral">                                            $deltacol = $this-&gt;x + $this-&gt;rMargin - $this-&gt;w;</span>
<a name="l23885"></a>23885 <span class="stringliteral">                                        } else {</span>
<a name="l23886"></a>23886 <span class="stringliteral">                                            $deltacol = $this-&gt;x - $this-&gt;lMargin;</span>
<a name="l23887"></a>23887 <span class="stringliteral">                                        }</span>
<a name="l23888"></a>23888 <span class="stringliteral">                                    } elseif ($column == $endcolumn) { // end column</span>
<a name="l23889"></a>23889 <span class="stringliteral">                                        $cborder = $border_end;</span>
<a name="l23890"></a>23890 <span class="stringliteral">                                        if (isset($this-&gt;columns[$column][&#39;</span>th<span class="stringliteral">&#39;][&#39;</span>\<span class="stringliteral">&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>])) {
<a name="l23891"></a>23891                                             $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];
<a name="l23892"></a>23892                                         }
<a name="l23893"></a>23893                                         $this-&gt;x += $deltacol;
<a name="l23894"></a>23894                                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $endy - $this-&gt;y;
<a name="l23895"></a>23895                                     } <span class="keywordflow">else</span> { <span class="comment">// middle column</span>
<a name="l23896"></a>23896                                         $cborder = $border_middle;
<a name="l23897"></a>23897                                         <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {
<a name="l23898"></a>23898                                             $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];
<a name="l23899"></a>23899                                         }
<a name="l23900"></a>23900                                         $this-&gt;x += $deltacol;
<a name="l23901"></a>23901                                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l23902"></a>23902                                     }
<a name="l23903"></a>23903                                     $ccode .= $this-&gt;getCellCode(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l23904"></a>23904                                 } <span class="comment">// end for each column</span>
<a name="l23905"></a>23905                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> == $startpage) { <span class="comment">// first page</span>
<a name="l23906"></a>23906                                 $deltacol = 0;
<a name="l23907"></a>23907                                 $deltath = 0;
<a name="l23908"></a>23908                                 <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt; $this-&gt;num_columns; ++$column) { <span class="comment">// for each column</span>
<a name="l23909"></a>23909                                     $this-&gt;selectColumn($column);
<a name="l23910"></a>23910                                     <span class="keywordflow">if</span> ($column == $startcolumn) { <span class="comment">// first column</span>
<a name="l23911"></a>23911                                         $cborder = $border_start;
<a name="l23912"></a>23912                                         $this-&gt;y = $starty;
<a name="l23913"></a>23913                                         $this-&gt;x = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l23914"></a>23914                                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l23915"></a>23915                                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l23916"></a>23916                                             $deltacol = $this-&gt;x + $this-&gt;rMargin - $this-&gt;w;
<a name="l23917"></a>23917                                         } <span class="keywordflow">else</span> {
<a name="l23918"></a>23918                                             $deltacol = $this-&gt;x - $this-&gt;lMargin;
<a name="l23919"></a>23919                                         }
<a name="l23920"></a>23920                                     } <span class="keywordflow">else</span> { <span class="comment">// middle column</span>
<a name="l23921"></a>23921                                         $cborder = $border_middle;
<a name="l23922"></a>23922                                         <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {
<a name="l23923"></a>23923                                             $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];
<a name="l23924"></a>23924                                         }
<a name="l23925"></a>23925                                         $this-&gt;x += $deltacol;
<a name="l23926"></a>23926                                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l23927"></a>23927                                     }
<a name="l23928"></a>23928                                     $ccode .= $this-&gt;getCellCode(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l23929"></a>23929                                 } <span class="comment">// end for each column</span>
<a name="l23930"></a>23930                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> == $endpage) { <span class="comment">// last page</span>
<a name="l23931"></a>23931                                 $deltacol = 0;
<a name="l23932"></a>23932                                 $deltath = 0;
<a name="l23933"></a>23933                                 <span class="keywordflow">for</span> ($column = 0; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span>
<a name="l23934"></a>23934                                     $this-&gt;selectColumn($column);
<a name="l23935"></a>23935                                     <span class="keywordflow">if</span> ($column == $endcolumn) { <span class="comment">// end column</span>
<a name="l23936"></a>23936                                         $cborder = $border_end;
<a name="l23937"></a>23937                                         <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {
<a name="l23938"></a>23938                                             $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];
<a name="l23939"></a>23939                                         }
<a name="l23940"></a>23940                                         $this-&gt;x += $deltacol;
<a name="l23941"></a>23941                                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $endy - $this-&gt;y;
<a name="l23942"></a>23942                                     } <span class="keywordflow">else</span> { <span class="comment">// middle column</span>
<a name="l23943"></a>23943                                         $cborder = $border_middle;
<a name="l23944"></a>23944                                         <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {
<a name="l23945"></a>23945                                             $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];
<a name="l23946"></a>23946                                         }
<a name="l23947"></a>23947                                         $this-&gt;x += $deltacol;
<a name="l23948"></a>23948                                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l23949"></a>23949                                     }
<a name="l23950"></a>23950                                     $ccode .= $this-&gt;getCellCode(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l23951"></a>23951                                 } <span class="comment">// end for each column</span>
<a name="l23952"></a>23952                             } <span class="keywordflow">else</span> { <span class="comment">// middle page</span>
<a name="l23953"></a>23953                                 $deltacol = 0;
<a name="l23954"></a>23954                                 $deltath = 0;
<a name="l23955"></a>23955                                 <span class="keywordflow">for</span> ($column = 0; $column &lt; $this-&gt;num_columns; ++$column) { <span class="comment">// for each column</span>
<a name="l23956"></a>23956                                     $this-&gt;selectColumn($column);
<a name="l23957"></a>23957                                     $cborder = $border_middle;
<a name="l23958"></a>23958                                     <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {
<a name="l23959"></a>23959                                         $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];
<a name="l23960"></a>23960                                     }
<a name="l23961"></a>23961                                     $this-&gt;x += $deltacol;
<a name="l23962"></a>23962                                     <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l23963"></a>23963                                     $ccode .= $this-&gt;getCellCode(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l23964"></a>23964                                 } <span class="comment">// end for each column</span>
<a name="l23965"></a>23965                             }
<a name="l23966"></a>23966                             <span class="keywordflow">if</span> ($cborder OR $fill) {
<a name="l23967"></a>23967                                 $offsetlen = strlen($ccode);
<a name="l23968"></a>23968                                 <span class="comment">// draw border and fill</span>
<a name="l23969"></a>23969                                 <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l23970"></a>23970                                     <span class="comment">// we are inside an XObject template</span>
<a name="l23971"></a>23971                                     <span class="keywordflow">if</span> (end($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]) !== <span class="keyword">false</span>) {
<a name="l23972"></a>23972                                         $pagemarkkey = key($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);
<a name="l23973"></a>23973                                         $pagemark = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey];
<a name="l23974"></a>23974                                         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey] += $offsetlen;
<a name="l23975"></a>23975                                     } <span class="keywordflow">else</span> {
<a name="l23976"></a>23976                                         $pagemark = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>];
<a name="l23977"></a>23977                                         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>] += $offsetlen;
<a name="l23978"></a>23978                                     }
<a name="l23979"></a>23979                                     $pagebuff = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>];
<a name="l23980"></a>23980                                     $pstart = substr($pagebuff, 0, $pagemark);
<a name="l23981"></a>23981                                     $pend = substr($pagebuff, $pagemark);
<a name="l23982"></a>23982                                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$ccode.$pend;
<a name="l23983"></a>23983                                 } <span class="keywordflow">else</span> {
<a name="l23984"></a>23984                                     <span class="comment">// draw border and fill</span>
<a name="l23985"></a>23985                                     <span class="keywordflow">if</span> (end($this-&gt;transfmrk[$this-&gt;page]) !== <span class="keyword">false</span>) {
<a name="l23986"></a>23986                                         $pagemarkkey = key($this-&gt;transfmrk[$this-&gt;page]);
<a name="l23987"></a>23987                                         $pagemark = $this-&gt;transfmrk[$this-&gt;page][$pagemarkkey];
<a name="l23988"></a>23988                                         $this-&gt;transfmrk[$this-&gt;page][$pagemarkkey] += $offsetlen;
<a name="l23989"></a>23989                                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;InFooter) {
<a name="l23990"></a>23990                                         $pagemark = $this-&gt;footerpos[$this-&gt;page];
<a name="l23991"></a>23991                                         $this-&gt;footerpos[$this-&gt;page] += $offsetlen;
<a name="l23992"></a>23992                                     } <span class="keywordflow">else</span> {
<a name="l23993"></a>23993                                         $pagemark = $this-&gt;intmrk[$this-&gt;page];
<a name="l23994"></a>23994                                         $this-&gt;intmrk[$this-&gt;page] += $offsetlen;
<a name="l23995"></a>23995                                     }
<a name="l23996"></a>23996                                     $pagebuff = $this-&gt;getPageBuffer($this-&gt;page);
<a name="l23997"></a>23997                                     $pstart = substr($pagebuff, 0, $pagemark);
<a name="l23998"></a>23998                                     $pend = substr($pagebuff, $pagemark);
<a name="l23999"></a>23999                                     $this-&gt;setPageBuffer($this-&gt;page, $pstart.$ccode.$pend);
<a name="l24000"></a>24000                                 }
<a name="l24001"></a>24001                             }
<a name="l24002"></a>24002                         } <span class="comment">// end for each page</span>
<a name="l24003"></a>24003                         <span class="comment">// restore default border</span>
<a name="l24004"></a>24004                         $border = $default_border;
<a name="l24005"></a>24005                     } <span class="comment">// end for each cell on the row</span>
<a name="l24006"></a>24006                     <span class="keywordflow">if</span> (isset($table_el[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {
<a name="l24007"></a>24007                         $this-&gt;y += $this-&gt;getHTMLUnitToUnits($table_el[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l24008"></a>24008                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($table_el[<span class="stringliteral">&#39;border-spacing&#39;</span>])) {
<a name="l24009"></a>24009                         $this-&gt;y += $table_el[<span class="stringliteral">&#39;border-spacing&#39;</span>][<span class="charliteral">&#39;V&#39;</span>];
<a name="l24010"></a>24010                     }
<a name="l24011"></a>24011                     $this-&gt;Ln(0, $cell);
<a name="l24012"></a>24012                     $this-&gt;x = $parent[<span class="stringliteral">&#39;startx&#39;</span>];
<a name="l24013"></a>24013                     <span class="keywordflow">if</span> ($endpage &gt; $startpage) {
<a name="l24014"></a>24014                         <span class="keywordflow">if</span> (($this-&gt;rtl) AND ($this-&gt;pagedim[$endpage][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>])) {
<a name="l24015"></a>24015                             $this-&gt;x += ($this-&gt;pagedim[$endpage][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>]);
<a name="l24016"></a>24016                         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((!$this-&gt;rtl) AND ($this-&gt;pagedim[$endpage][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>])) {
<a name="l24017"></a>24017                             $this-&gt;x += ($this-&gt;pagedim[$endpage][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>]);
<a name="l24018"></a>24018                         }
<a name="l24019"></a>24019                     }
<a name="l24020"></a>24020                 }
<a name="l24021"></a>24021                 <span class="keywordflow">if</span> (!$in_table_head) { <span class="comment">// we are not inside a thead section</span>
<a name="l24022"></a>24022                     $this-&gt;cell_padding = $table_el[<span class="stringliteral">&#39;old_cell_padding&#39;</span>];
<a name="l24023"></a>24023                     <span class="comment">// reset row height</span>
<a name="l24024"></a>24024                     $this-&gt;resetLastH();
<a name="l24025"></a>24025                     <span class="keywordflow">if</span> (($this-&gt;page == ($this-&gt;numpages - 1)) AND ($this-&gt;pageopen[$this-&gt;numpages])) {
<a name="l24026"></a>24026                         $plendiff = ($this-&gt;pagelen[$this-&gt;numpages] - $this-&gt;emptypagemrk[$this-&gt;numpages]);
<a name="l24027"></a>24027                         <span class="keywordflow">if</span> (($plendiff &gt; 0) AND ($plendiff &lt; 60)) {
<a name="l24028"></a>24028                             $pagediff = substr($this-&gt;getPageBuffer($this-&gt;numpages), $this-&gt;emptypagemrk[$this-&gt;numpages], $plendiff);
<a name="l24029"></a>24029                             <span class="keywordflow">if</span> (substr($pagediff, 0, 5) == <span class="stringliteral">&#39;BT /F&#39;</span>) {
<a name="l24030"></a>24030                                 <span class="comment">// the difference is only a font setting</span>
<a name="l24031"></a>24031                                 $plendiff = 0;
<a name="l24032"></a>24032                             }
<a name="l24033"></a>24033                         }
<a name="l24034"></a>24034                         <span class="keywordflow">if</span> ($plendiff == 0) {
<a name="l24035"></a>24035                             <span class="comment">// remove last blank page</span>
<a name="l24036"></a>24036                             $this-&gt;deletePage($this-&gt;numpages);
<a name="l24037"></a>24037                         }
<a name="l24038"></a>24038                     }
<a name="l24039"></a>24039                     <span class="keywordflow">if</span> (isset($this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>])) {
<a name="l24040"></a>24040                         <span class="comment">// restore top margin</span>
<a name="l24041"></a>24041                         $this-&gt;tMargin = $this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>];
<a name="l24042"></a>24042                     }
<a name="l24043"></a>24043                     <span class="keywordflow">if</span> (!isset($table_el[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nested&#39;</span>]) OR ($table_el[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nested&#39;</span>] != <span class="stringliteral">&#39;true&#39;</span>)) {
<a name="l24044"></a>24044                         <span class="comment">// reset main table header</span>
<a name="l24045"></a>24045                         $this-&gt;thead = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24046"></a>24046                         $this-&gt;theadMargins = array();
<a name="l24047"></a>24047                         $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;tm&#39;</span>] = $this-&gt;tMargin;
<a name="l24048"></a>24048                     }
<a name="l24049"></a>24049                 }
<a name="l24050"></a>24050                 $parent = $table_el;
<a name="l24051"></a>24051                 <span class="keywordflow">break</span>;
<a name="l24052"></a>24052             }
<a name="l24053"></a>24053             <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>: {
<a name="l24054"></a>24054                 $this-&gt;HREF = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24055"></a>24055                 <span class="keywordflow">break</span>;
<a name="l24056"></a>24056             }
<a name="l24057"></a>24057             <span class="keywordflow">case</span> <span class="stringliteral">&#39;sup&#39;</span>: {
<a name="l24058"></a>24058                 $this-&gt;SetXY($this-&gt;GetX(), $this-&gt;GetY() + ((0.7 * $parent[<span class="stringliteral">&#39;fontsize&#39;</span>]) / $this-&gt;k));
<a name="l24059"></a>24059                 <span class="keywordflow">break</span>;
<a name="l24060"></a>24060             }
<a name="l24061"></a>24061             <span class="keywordflow">case</span> <span class="stringliteral">&#39;sub&#39;</span>: {
<a name="l24062"></a>24062                 $this-&gt;SetXY($this-&gt;GetX(), $this-&gt;GetY() - ((0.3 * $parent[<span class="stringliteral">&#39;fontsize&#39;</span>])/$this-&gt;k));
<a name="l24063"></a>24063                 <span class="keywordflow">break</span>;
<a name="l24064"></a>24064             }
<a name="l24065"></a>24065             <span class="keywordflow">case</span> <span class="stringliteral">&#39;div&#39;</span>: {
<a name="l24066"></a>24066                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24067"></a>24067                 <span class="keywordflow">break</span>;
<a name="l24068"></a>24068             }
<a name="l24069"></a>24069             <span class="keywordflow">case</span> <span class="stringliteral">&#39;blockquote&#39;</span>: {
<a name="l24070"></a>24070                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l24071"></a>24071                     $this-&gt;rMargin -= $this-&gt;listindent;
<a name="l24072"></a>24072                 } <span class="keywordflow">else</span> {
<a name="l24073"></a>24073                     $this-&gt;lMargin -= $this-&gt;listindent;
<a name="l24074"></a>24074                 }
<a name="l24075"></a>24075                 --$this-&gt;listindentlevel;
<a name="l24076"></a>24076                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24077"></a>24077                 <span class="keywordflow">break</span>;
<a name="l24078"></a>24078             }
<a name="l24079"></a>24079             <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>: {
<a name="l24080"></a>24080                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24081"></a>24081                 <span class="keywordflow">break</span>;
<a name="l24082"></a>24082             }
<a name="l24083"></a>24083             <span class="keywordflow">case</span> <span class="stringliteral">&#39;pre&#39;</span>: {
<a name="l24084"></a>24084                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24085"></a>24085                 $this-&gt;premode = <span class="keyword">false</span>;
<a name="l24086"></a>24086                 <span class="keywordflow">break</span>;
<a name="l24087"></a>24087             }
<a name="l24088"></a>24088             <span class="keywordflow">case</span> <span class="stringliteral">&#39;dl&#39;</span>: {
<a name="l24089"></a>24089                 --$this-&gt;listnum;
<a name="l24090"></a>24090                 <span class="keywordflow">if</span> ($this-&gt;listnum &lt;= 0) {
<a name="l24091"></a>24091                     $this-&gt;listnum = 0;
<a name="l24092"></a>24092                     $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24093"></a>24093                 } <span class="keywordflow">else</span> {
<a name="l24094"></a>24094                     $this-&gt;addHTMLVertSpace(0, 0, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24095"></a>24095                 }
<a name="l24096"></a>24096                 $this-&gt;resetLastH();
<a name="l24097"></a>24097                 <span class="keywordflow">break</span>;
<a name="l24098"></a>24098             }
<a name="l24099"></a>24099             <span class="keywordflow">case</span> <span class="stringliteral">&#39;dt&#39;</span>: {
<a name="l24100"></a>24100                 $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24101"></a>24101                 $this-&gt;addHTMLVertSpace(0, 0, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24102"></a>24102                 <span class="keywordflow">break</span>;
<a name="l24103"></a>24103             }
<a name="l24104"></a>24104             <span class="keywordflow">case</span> <span class="stringliteral">&#39;dd&#39;</span>: {
<a name="l24105"></a>24105                 $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24106"></a>24106                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l24107"></a>24107                     $this-&gt;rMargin -= $this-&gt;listindent;
<a name="l24108"></a>24108                 } <span class="keywordflow">else</span> {
<a name="l24109"></a>24109                     $this-&gt;lMargin -= $this-&gt;listindent;
<a name="l24110"></a>24110                 }
<a name="l24111"></a>24111                 --$this-&gt;listindentlevel;
<a name="l24112"></a>24112                 $this-&gt;addHTMLVertSpace(0, 0, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24113"></a>24113                 <span class="keywordflow">break</span>;
<a name="l24114"></a>24114             }
<a name="l24115"></a>24115             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ul&#39;</span>:
<a name="l24116"></a>24116             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ol&#39;</span>: {
<a name="l24117"></a>24117                 --$this-&gt;listnum;
<a name="l24118"></a>24118                 $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24119"></a>24119                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l24120"></a>24120                     $this-&gt;rMargin -= $this-&gt;listindent;
<a name="l24121"></a>24121                 } <span class="keywordflow">else</span> {
<a name="l24122"></a>24122                     $this-&gt;lMargin -= $this-&gt;listindent;
<a name="l24123"></a>24123                 }
<a name="l24124"></a>24124                 --$this-&gt;listindentlevel;
<a name="l24125"></a>24125                 <span class="keywordflow">if</span> ($this-&gt;listnum &lt;= 0) {
<a name="l24126"></a>24126                     $this-&gt;listnum = 0;
<a name="l24127"></a>24127                     $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24128"></a>24128                 } <span class="keywordflow">else</span> {
<a name="l24129"></a>24129                     $this-&gt;addHTMLVertSpace(0, 0, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24130"></a>24130                 }
<a name="l24131"></a>24131                 $this-&gt;resetLastH();
<a name="l24132"></a>24132                 <span class="keywordflow">break</span>;
<a name="l24133"></a>24133             }
<a name="l24134"></a>24134             <span class="keywordflow">case</span> <span class="stringliteral">&#39;li&#39;</span>: {
<a name="l24135"></a>24135                 $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24136"></a>24136                 $this-&gt;addHTMLVertSpace(0, 0, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24137"></a>24137                 <span class="keywordflow">break</span>;
<a name="l24138"></a>24138             }
<a name="l24139"></a>24139             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h1&#39;</span>:
<a name="l24140"></a>24140             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h2&#39;</span>:
<a name="l24141"></a>24141             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h3&#39;</span>:
<a name="l24142"></a>24142             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h4&#39;</span>:
<a name="l24143"></a>24143             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h5&#39;</span>:
<a name="l24144"></a>24144             <span class="keywordflow">case</span> <span class="stringliteral">&#39;h6&#39;</span>: {
<a name="l24145"></a>24145                 $this-&gt;addHTMLVertSpace($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);
<a name="l24146"></a>24146                 <span class="keywordflow">break</span>;
<a name="l24147"></a>24147             }
<a name="l24148"></a>24148             <span class="comment">// Form fields (since 4.8.000 - 2009-09-07)</span>
<a name="l24149"></a>24149             <span class="keywordflow">case</span> <span class="stringliteral">&#39;form&#39;</span>: {
<a name="l24150"></a>24150                 $this-&gt;form_action = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24151"></a>24151                 $this-&gt;form_enctype = <span class="stringliteral">&#39;application/x-www-form-urlencoded&#39;</span>;
<a name="l24152"></a>24152                 <span class="keywordflow">break</span>;
<a name="l24153"></a>24153             }
<a name="l24154"></a>24154             <span class="keywordflow">default</span> : {
<a name="l24155"></a>24155                 <span class="keywordflow">break</span>;
<a name="l24156"></a>24156             }
<a name="l24157"></a>24157         }
<a name="l24158"></a>24158         <span class="comment">// draw border and background (if any)</span>
<a name="l24159"></a>24159         $this-&gt;drawHTMLTagBorder($parent, $xmax);
<a name="l24160"></a>24160         <span class="keywordflow">if</span> (isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>])) {
<a name="l24161"></a>24161             $pba = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>];
<a name="l24162"></a>24162             <span class="comment">// check for pagebreak</span>
<a name="l24163"></a>24163             <span class="keywordflow">if</span> (($pba == <span class="stringliteral">&#39;true&#39;</span>) OR ($pba == <span class="stringliteral">&#39;left&#39;</span>) OR ($pba == &#39;right&#39;)) {
<a name="l24164"></a>24164                 <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l24165"></a>24165                 $this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1);
<a name="l24166"></a>24166             }
<a name="l24167"></a>24167             <span class="keywordflow">if</span> ((($pba == <span class="stringliteral">&#39;left&#39;</span>) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) == 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) != 0))))
<a name="l24168"></a>24168                 OR (($pba == <span class="stringliteral">&#39;right&#39;</span>) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) != 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) == 0))))) {
<a name="l24169"></a>24169                 <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span>
<a name="l24170"></a>24170                 $this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1);
<a name="l24171"></a>24171             }
<a name="l24172"></a>24172         }
<a name="l24173"></a>24173         $this-&gt;tmprtl = <span class="keyword">false</span>;
<a name="l24174"></a>24174         <span class="keywordflow">return</span> $dom;
<a name="l24175"></a>24175     }
<a name="l24176"></a>24176 <span class="comment"></span>
<a name="l24177"></a>24177 <span class="comment">    /**</span>
<a name="l24178"></a>24178 <span class="comment">     * Add vertical spaces if needed.</span>
<a name="l24179"></a>24179 <span class="comment">     * @param $hbz (string) Distance between current y and line bottom.</span>
<a name="l24180"></a>24180 <span class="comment">     * @param $hb (string) The height of the break.</span>
<a name="l24181"></a>24181 <span class="comment">     * @param $cell (boolean) if true add the default left (or right if RTL) padding to each new line (default false).</span>
<a name="l24182"></a>24182 <span class="comment">     * @param $firsttag (boolean) set to true when the tag is the first.</span>
<a name="l24183"></a>24183 <span class="comment">     * @param $lasttag (boolean) set to true when the tag is the last.</span>
<a name="l24184"></a>24184 <span class="comment">     * @protected</span>
<a name="l24185"></a>24185 <span class="comment">     */</span>
<a name="l24186"></a><a class="code" href="classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">24186</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a885b5862782e1d3ff05f349f278ca664" title="Add vertical spaces if needed.">addHTMLVertSpace</a>($hbz=0, $hb=0, $cell=<span class="keyword">false</span>, $firsttag=<span class="keyword">false</span>, $lasttag=<span class="keyword">false</span>) {
<a name="l24187"></a>24187         <span class="keywordflow">if</span> ($firsttag) {
<a name="l24188"></a>24188             $this-&gt;Ln(0, $cell);
<a name="l24189"></a>24189             $this-&gt;htmlvspace = 0;
<a name="l24190"></a>24190             <span class="keywordflow">return</span>;
<a name="l24191"></a>24191         }
<a name="l24192"></a>24192         <span class="keywordflow">if</span> ($lasttag) {
<a name="l24193"></a>24193             $this-&gt;Ln($hbz, $cell);
<a name="l24194"></a>24194             $this-&gt;htmlvspace = 0;
<a name="l24195"></a>24195             <span class="keywordflow">return</span>;
<a name="l24196"></a>24196         }
<a name="l24197"></a>24197         <span class="keywordflow">if</span> ($hb &lt; $this-&gt;htmlvspace) {
<a name="l24198"></a>24198             $hd = 0;
<a name="l24199"></a>24199         } <span class="keywordflow">else</span> {
<a name="l24200"></a>24200             $hd = $hb - $this-&gt;htmlvspace;
<a name="l24201"></a>24201             $this-&gt;htmlvspace = $hb;
<a name="l24202"></a>24202         }
<a name="l24203"></a>24203         $this-&gt;Ln(($hbz + $hd), $cell);
<a name="l24204"></a>24204     }
<a name="l24205"></a>24205 <span class="comment"></span>
<a name="l24206"></a>24206 <span class="comment">    /**</span>
<a name="l24207"></a>24207 <span class="comment">     * Return the starting coordinates to draw an html border</span>
<a name="l24208"></a>24208 <span class="comment">     * @return array containing top-left border coordinates</span>
<a name="l24209"></a>24209 <span class="comment">     * @protected</span>
<a name="l24210"></a>24210 <span class="comment">     * @since 5.7.000 (2010-08-03)</span>
<a name="l24211"></a>24211 <span class="comment">     */</span>
<a name="l24212"></a><a class="code" href="classTCPDF.html#a5ff1d1bb3ba604c5cadff4388962432e">24212</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5ff1d1bb3ba604c5cadff4388962432e" title="Return the starting coordinates to draw an html border.">getBorderStartPosition</a>() {
<a name="l24213"></a>24213         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l24214"></a>24214             $xmax = $this-&gt;lMargin;
<a name="l24215"></a>24215         } <span class="keywordflow">else</span> {
<a name="l24216"></a>24216             $xmax = $this-&gt;w - $this-&gt;rMargin;
<a name="l24217"></a>24217         }
<a name="l24218"></a>24218         <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;page&#39;</span> =&gt; $this-&gt;page, <span class="stringliteral">&#39;column&#39;</span> =&gt; $this-&gt;current_column, <span class="charliteral">&#39;x&#39;</span> =&gt; $this-&gt;x, <span class="charliteral">&#39;y&#39;</span> =&gt; $this-&gt;y, <span class="stringliteral">&#39;xmax&#39;</span> =&gt; $xmax);
<a name="l24219"></a>24219     }
<a name="l24220"></a>24220 <span class="comment"></span>
<a name="l24221"></a>24221 <span class="comment">    /**</span>
<a name="l24222"></a>24222 <span class="comment">     * Draw an HTML block border and fill</span>
<a name="l24223"></a>24223 <span class="comment">     * @param $tag (array) array of tag properties.</span>
<a name="l24224"></a>24224 <span class="comment">     * @param $xmax (int) end X coordinate for border.</span>
<a name="l24225"></a>24225 <span class="comment">     * @protected</span>
<a name="l24226"></a>24226 <span class="comment">     * @since 5.7.000 (2010-08-03)</span>
<a name="l24227"></a>24227 <span class="comment">     */</span>
<a name="l24228"></a><a class="code" href="classTCPDF.html#a87afce48ac2a2849fbb1f5e923e75c0b">24228</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a87afce48ac2a2849fbb1f5e923e75c0b" title="Draw an HTML block border and fill.">drawHTMLTagBorder</a>($tag, $xmax) {
<a name="l24229"></a>24229         <span class="keywordflow">if</span> (!isset($tag[<span class="stringliteral">&#39;borderposition&#39;</span>])) {
<a name="l24230"></a>24230             <span class="comment">// nothing to draw</span>
<a name="l24231"></a>24231             <span class="keywordflow">return</span>;
<a name="l24232"></a>24232         }
<a name="l24233"></a>24233         $prev_x = $this-&gt;x;
<a name="l24234"></a>24234         $prev_y = $this-&gt;y;
<a name="l24235"></a>24235         $prev_lasth = $this-&gt;lasth;
<a name="l24236"></a>24236         $border = 0;
<a name="l24237"></a>24237         $fill = <span class="keyword">false</span>;
<a name="l24238"></a>24238         $this-&gt;lasth = 0;
<a name="l24239"></a>24239         <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;border&#39;</span>]) AND !empty($tag[<span class="stringliteral">&#39;border&#39;</span>])) {
<a name="l24240"></a>24240             <span class="comment">// get border style</span>
<a name="l24241"></a>24241             $border = $tag[<span class="stringliteral">&#39;border&#39;</span>];
<a name="l24242"></a>24242             <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;thead) AND (!$this-&gt;inthead)) {
<a name="l24243"></a>24243                 <span class="comment">// border for table header</span>
<a name="l24244"></a>24244                 $border = $this-&gt;getBorderMode($border, $position=<span class="stringliteral">&#39;middle&#39;</span>);
<a name="l24245"></a>24245             }
<a name="l24246"></a>24246         }
<a name="l24247"></a>24247         <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;bgcolor&#39;</span>]) AND ($tag[<span class="stringliteral">&#39;bgcolor&#39;</span>] !== <span class="keyword">false</span>)) {
<a name="l24248"></a>24248             <span class="comment">// get background color</span>
<a name="l24249"></a>24249             $old_bgcolor = $this-&gt;bgcolor;
<a name="l24250"></a>24250             $this-&gt;SetFillColorArray($tag[<span class="stringliteral">&#39;bgcolor&#39;</span>]);
<a name="l24251"></a>24251             $fill = <span class="keyword">true</span>;
<a name="l24252"></a>24252         }
<a name="l24253"></a>24253         <span class="keywordflow">if</span> (!$border AND !$fill) {
<a name="l24254"></a>24254             <span class="comment">// nothing to draw</span>
<a name="l24255"></a>24255             <span class="keywordflow">return</span>;
<a name="l24256"></a>24256         }
<a name="l24257"></a>24257         <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {
<a name="l24258"></a>24258             $clsp = $this-&gt;getHTMLUnitToUnits($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);
<a name="l24259"></a>24259             $cellspacing = array(<span class="charliteral">&#39;H&#39;</span> =&gt; $clsp, <span class="charliteral">&#39;V&#39;</span> =&gt; $clsp);
<a name="l24260"></a>24260         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($tag[<span class="stringliteral">&#39;border-spacing&#39;</span>])) {
<a name="l24261"></a>24261             $cellspacing = $tag[<span class="stringliteral">&#39;border-spacing&#39;</span>];
<a name="l24262"></a>24262         } <span class="keywordflow">else</span> {
<a name="l24263"></a>24263             $cellspacing = array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0);
<a name="l24264"></a>24264         }
<a name="l24265"></a>24265         <span class="keywordflow">if</span> (($tag[<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;table&#39;</span>) AND (is_array($border)) AND (!empty($border))) {
<a name="l24266"></a>24266             <span class="comment">// draw the border externally respect the sqare edge.</span>
<a name="l24267"></a>24267             $border[<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;ext&#39;</span>;
<a name="l24268"></a>24268         }
<a name="l24269"></a>24269         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l24270"></a>24270             <span class="keywordflow">if</span> ($xmax &gt;= $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>]) {
<a name="l24271"></a>24271                 $xmax = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;xmax&#39;</span>];
<a name="l24272"></a>24272             }
<a name="l24273"></a>24273             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = ($tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>] - $xmax);
<a name="l24274"></a>24274         } <span class="keywordflow">else</span> {
<a name="l24275"></a>24275             <span class="keywordflow">if</span> ($xmax &lt;= $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>]) {
<a name="l24276"></a>24276                 $xmax = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;xmax&#39;</span>];
<a name="l24277"></a>24277             }
<a name="l24278"></a>24278             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = ($xmax - $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>]);
<a name="l24279"></a>24279         }
<a name="l24280"></a>24280         <span class="keywordflow">if</span> (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0) {
<a name="l24281"></a>24281             <span class="keywordflow">return</span>;
<a name="l24282"></a>24282         }
<a name="l24283"></a>24283         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> += $cellspacing[<span class="charliteral">&#39;H&#39;</span>];
<a name="l24284"></a>24284         $startpage = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;page&#39;</span>];
<a name="l24285"></a>24285         $startcolumn = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>];
<a name="l24286"></a>24286         <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>];
<a name="l24287"></a>24287         $y = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;y&#39;</span>];
<a name="l24288"></a>24288         $endpage = $this-&gt;page;
<a name="l24289"></a>24289         $starty = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;y&#39;</span>] - $cellspacing[<span class="charliteral">&#39;V&#39;</span>];
<a name="l24290"></a>24290         $currentY = $this-&gt;y;
<a name="l24291"></a>24291         $this-&gt;x = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l24292"></a>24292         <span class="comment">// get latest column</span>
<a name="l24293"></a>24293         $endcolumn = $this-&gt;current_column;
<a name="l24294"></a>24294         <span class="keywordflow">if</span> ($this-&gt;num_columns == 0) {
<a name="l24295"></a>24295             $this-&gt;num_columns = 1;
<a name="l24296"></a>24296         }
<a name="l24297"></a>24297         <span class="comment">// get border modes</span>
<a name="l24298"></a>24298         $border_start = $this-&gt;getBorderMode($border, $position=<span class="stringliteral">&#39;start&#39;</span>);
<a name="l24299"></a>24299         $border_end = $this-&gt;getBorderMode($border, $position=<span class="stringliteral">&#39;end&#39;</span>);
<a name="l24300"></a>24300         $border_middle = $this-&gt;getBorderMode($border, $position=<span class="stringliteral">&#39;middle&#39;</span>);
<a name="l24301"></a>24301         <span class="comment">// temporary disable page regions</span>
<a name="l24302"></a>24302         $temp_page_regions = $this-&gt;page_regions;
<a name="l24303"></a>24303         $this-&gt;page_regions = array();
<a name="l24304"></a>24304         <span class="comment">// design borders around HTML cells.</span>
<a name="l24305"></a>24305         <span class="keywordflow">for</span> (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = $startpage; <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &lt;= $endpage; ++<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>) { <span class="comment">// for each page</span>
<a name="l24306"></a>24306             $ccode = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24307"></a>24307             $this-&gt;setPage(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>);
<a name="l24308"></a>24308             <span class="keywordflow">if</span> ($this-&gt;num_columns &lt; 2) {
<a name="l24309"></a>24309                 <span class="comment">// single-column mode</span>
<a name="l24310"></a>24310                 $this-&gt;x = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l24311"></a>24311                 $this-&gt;y = $this-&gt;tMargin;
<a name="l24312"></a>24312             }
<a name="l24313"></a>24313             <span class="comment">// account for margin changes</span>
<a name="l24314"></a>24314             <span class="keywordflow">if</span> (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &gt; $startpage) {
<a name="l24315"></a>24315                 <span class="keywordflow">if</span> (($this-&gt;rtl) AND ($this-&gt;pagedim[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>])) {
<a name="l24316"></a>24316                     $this-&gt;x -= ($this-&gt;pagedim[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>]);
<a name="l24317"></a>24317                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ((!$this-&gt;rtl) AND ($this-&gt;pagedim[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>])) {
<a name="l24318"></a>24318                     $this-&gt;x += ($this-&gt;pagedim[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>]);
<a name="l24319"></a>24319                 }
<a name="l24320"></a>24320             }
<a name="l24321"></a>24321             <span class="keywordflow">if</span> ($startpage == $endpage) {
<a name="l24322"></a>24322                 <span class="comment">// single page</span>
<a name="l24323"></a>24323                 <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span>
<a name="l24324"></a>24324                     $this-&gt;selectColumn($column);
<a name="l24325"></a>24325                     <span class="keywordflow">if</span> ($startcolumn == $endcolumn) { <span class="comment">// single column</span>
<a name="l24326"></a>24326                         $cborder = $border;
<a name="l24327"></a>24327                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = ($currentY - $y) + $cellspacing[<span class="charliteral">&#39;V&#39;</span>];
<a name="l24328"></a>24328                         $this-&gt;y = $starty;
<a name="l24329"></a>24329                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($column == $startcolumn) { <span class="comment">// first column</span>
<a name="l24330"></a>24330                         $cborder = $border_start;
<a name="l24331"></a>24331                         $this-&gt;y = $starty;
<a name="l24332"></a>24332                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l24333"></a>24333                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($column == $endcolumn) { <span class="comment">// end column</span>
<a name="l24334"></a>24334                         $cborder = $border_end;
<a name="l24335"></a>24335                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $currentY - $this-&gt;y;
<a name="l24336"></a>24336                     } <span class="keywordflow">else</span> { <span class="comment">// middle column</span>
<a name="l24337"></a>24337                         $cborder = $border_middle;
<a name="l24338"></a>24338                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l24339"></a>24339                     }
<a name="l24340"></a>24340                     $ccode .= $this-&gt;getCellCode(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l24341"></a>24341                 } <span class="comment">// end for each column</span>
<a name="l24342"></a>24342             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> == $startpage) { <span class="comment">// first page</span>
<a name="l24343"></a>24343                 <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt; $this-&gt;num_columns; ++$column) { <span class="comment">// for each column</span>
<a name="l24344"></a>24344                     $this-&gt;selectColumn($column);
<a name="l24345"></a>24345                     <span class="keywordflow">if</span> ($column == $startcolumn) { <span class="comment">// first column</span>
<a name="l24346"></a>24346                         $cborder = $border_start;
<a name="l24347"></a>24347                         $this-&gt;y = $starty;
<a name="l24348"></a>24348                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l24349"></a>24349                     } <span class="keywordflow">else</span> { <span class="comment">// middle column</span>
<a name="l24350"></a>24350                         $cborder = $border_middle;
<a name="l24351"></a>24351                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l24352"></a>24352                     }
<a name="l24353"></a>24353                     $ccode .= $this-&gt;getCellCode(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l24354"></a>24354                 } <span class="comment">// end for each column</span>
<a name="l24355"></a>24355             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> == $endpage) { <span class="comment">// last page</span>
<a name="l24356"></a>24356                 <span class="keywordflow">for</span> ($column = 0; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span>
<a name="l24357"></a>24357                     $this-&gt;selectColumn($column);
<a name="l24358"></a>24358                     <span class="keywordflow">if</span> ($column == $endcolumn) {
<a name="l24359"></a>24359                         <span class="comment">// end column</span>
<a name="l24360"></a>24360                         $cborder = $border_end;
<a name="l24361"></a>24361                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $currentY - $this-&gt;y;
<a name="l24362"></a>24362                     } <span class="keywordflow">else</span> {
<a name="l24363"></a>24363                         <span class="comment">// middle column</span>
<a name="l24364"></a>24364                         $cborder = $border_middle;
<a name="l24365"></a>24365                         <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l24366"></a>24366                     }
<a name="l24367"></a>24367                     $ccode .= $this-&gt;getCellCode(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l24368"></a>24368                 } <span class="comment">// end for each column</span>
<a name="l24369"></a>24369             } <span class="keywordflow">else</span> { <span class="comment">// middle page</span>
<a name="l24370"></a>24370                 <span class="keywordflow">for</span> ($column = 0; $column &lt; $this-&gt;num_columns; ++$column) { <span class="comment">// for each column</span>
<a name="l24371"></a>24371                     $this-&gt;selectColumn($column);
<a name="l24372"></a>24372                     $cborder = $border_middle;
<a name="l24373"></a>24373                     <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;
<a name="l24374"></a>24374                     $ccode .= $this-&gt;getCellCode(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l24375"></a>24375                 } <span class="comment">// end for each column</span>
<a name="l24376"></a>24376             }
<a name="l24377"></a>24377             <span class="keywordflow">if</span> ($cborder OR $fill) {
<a name="l24378"></a>24378                 $offsetlen = strlen($ccode);
<a name="l24379"></a>24379                 <span class="comment">// draw border and fill</span>
<a name="l24380"></a>24380                 <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l24381"></a>24381                     <span class="comment">// we are inside an XObject template</span>
<a name="l24382"></a>24382                     <span class="keywordflow">if</span> (end($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]) !== <span class="keyword">false</span>) {
<a name="l24383"></a>24383                         $pagemarkkey = key($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);
<a name="l24384"></a>24384                         $pagemark = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey];
<a name="l24385"></a>24385                         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey] += $offsetlen;
<a name="l24386"></a>24386                     } <span class="keywordflow">else</span> {
<a name="l24387"></a>24387                         $pagemark = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>];
<a name="l24388"></a>24388                         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>] += $offsetlen;
<a name="l24389"></a>24389                     }
<a name="l24390"></a>24390                     $pagebuff = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>];
<a name="l24391"></a>24391                     $pstart = substr($pagebuff, 0, $pagemark);
<a name="l24392"></a>24392                     $pend = substr($pagebuff, $pagemark);
<a name="l24393"></a>24393                     $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$ccode.$pend;
<a name="l24394"></a>24394                 } <span class="keywordflow">else</span> {
<a name="l24395"></a>24395                     <span class="keywordflow">if</span> (end($this-&gt;transfmrk[$this-&gt;page]) !== <span class="keyword">false</span>) {
<a name="l24396"></a>24396                         $pagemarkkey = key($this-&gt;transfmrk[$this-&gt;page]);
<a name="l24397"></a>24397                         $pagemark = $this-&gt;transfmrk[$this-&gt;page][$pagemarkkey];
<a name="l24398"></a>24398                         $this-&gt;transfmrk[$this-&gt;page][$pagemarkkey] += $offsetlen;
<a name="l24399"></a>24399                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;InFooter) {
<a name="l24400"></a>24400                         $pagemark = $this-&gt;footerpos[$this-&gt;page];
<a name="l24401"></a>24401                         $this-&gt;footerpos[$this-&gt;page] += $offsetlen;
<a name="l24402"></a>24402                     } <span class="keywordflow">else</span> {
<a name="l24403"></a>24403                         $pagemark = $this-&gt;intmrk[$this-&gt;page];
<a name="l24404"></a>24404                         $this-&gt;intmrk[$this-&gt;page] += $offsetlen;
<a name="l24405"></a>24405                     }
<a name="l24406"></a>24406                     $pagebuff = $this-&gt;getPageBuffer($this-&gt;page);
<a name="l24407"></a>24407                     $pstart = substr($pagebuff, 0, $this-&gt;bordermrk[$this-&gt;page]);
<a name="l24408"></a>24408                     $pend = substr($pagebuff, $this-&gt;bordermrk[$this-&gt;page]);
<a name="l24409"></a>24409                     $this-&gt;setPageBuffer($this-&gt;page, $pstart.$ccode.$pend);
<a name="l24410"></a>24410                     $this-&gt;bordermrk[$this-&gt;page] += $offsetlen;
<a name="l24411"></a>24411                     $this-&gt;cntmrk[$this-&gt;page] += $offsetlen;
<a name="l24412"></a>24412                 }
<a name="l24413"></a>24413             }
<a name="l24414"></a>24414         } <span class="comment">// end for each page</span>
<a name="l24415"></a>24415         <span class="comment">// restore page regions</span>
<a name="l24416"></a>24416         $this-&gt;page_regions = $temp_page_regions;
<a name="l24417"></a>24417         <span class="keywordflow">if</span> (isset($old_bgcolor)) {
<a name="l24418"></a>24418             <span class="comment">// restore background color</span>
<a name="l24419"></a>24419             $this-&gt;SetFillColorArray($old_bgcolor);
<a name="l24420"></a>24420         }
<a name="l24421"></a>24421         <span class="comment">// restore pointer position</span>
<a name="l24422"></a>24422         $this-&gt;x = $prev_x;
<a name="l24423"></a>24423         $this-&gt;y = $prev_y;
<a name="l24424"></a>24424         $this-&gt;lasth = $prev_lasth;
<a name="l24425"></a>24425     }
<a name="l24426"></a>24426 <span class="comment"></span>
<a name="l24427"></a>24427 <span class="comment">    /**</span>
<a name="l24428"></a>24428 <span class="comment">     * Set the default bullet to be used as LI bullet symbol</span>
<a name="l24429"></a>24429 <span class="comment">     * @param $symbol (string) character or string to be used (legal values are: &#39;&#39; = automatic, &#39;!&#39; = auto bullet, &#39;#&#39; = auto numbering, &#39;disc&#39;, &#39;disc&#39;, &#39;circle&#39;, &#39;square&#39;, &#39;1&#39;, &#39;decimal&#39;, &#39;decimal-leading-zero&#39;, &#39;i&#39;, &#39;lower-roman&#39;, &#39;I&#39;, &#39;upper-roman&#39;, &#39;a&#39;, &#39;lower-alpha&#39;, &#39;lower-latin&#39;, &#39;A&#39;, &#39;upper-alpha&#39;, &#39;upper-latin&#39;, &#39;lower-greek&#39;, &#39;img|type|width|height|image.ext&#39;)</span>
<a name="l24430"></a>24430 <span class="comment">     * @public</span>
<a name="l24431"></a>24431 <span class="comment">     * @since 4.0.028 (2008-09-26)</span>
<a name="l24432"></a>24432 <span class="comment">     */</span>
<a name="l24433"></a><a class="code" href="classTCPDF.html#af38b4f69c334a8662ce586597fdad151">24433</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af38b4f69c334a8662ce586597fdad151" title="Set the default bullet to be used as LI bullet symbol.">setLIsymbol</a>($symbol=<span class="charliteral">&#39;!&#39;</span>) {
<a name="l24434"></a>24434         <span class="comment">// check for custom image symbol</span>
<a name="l24435"></a>24435         <span class="keywordflow">if</span> (substr($symbol, 0, 4) == <span class="stringliteral">&#39;img|&#39;</span>) {
<a name="l24436"></a>24436             $this-&gt;lisymbol = $symbol;
<a name="l24437"></a>24437             <span class="keywordflow">return</span>;
<a name="l24438"></a>24438         }
<a name="l24439"></a>24439         $symbol = strtolower($symbol);
<a name="l24440"></a>24440         <span class="keywordflow">switch</span> ($symbol) {
<a name="l24441"></a>24441             <span class="keywordflow">case</span> <span class="charliteral">&#39;!&#39;</span> :
<a name="l24442"></a>24442             <span class="keywordflow">case</span> <span class="charliteral">&#39;#&#39;</span> :
<a name="l24443"></a>24443             <span class="keywordflow">case</span> <span class="stringliteral">&#39;disc&#39;</span> :
<a name="l24444"></a>24444             <span class="keywordflow">case</span> <span class="stringliteral">&#39;circle&#39;</span> :
<a name="l24445"></a>24445             <span class="keywordflow">case</span> <span class="stringliteral">&#39;square&#39;</span> :
<a name="l24446"></a>24446             <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:
<a name="l24447"></a>24447             <span class="keywordflow">case</span> <span class="stringliteral">&#39;decimal&#39;</span>:
<a name="l24448"></a>24448             <span class="keywordflow">case</span> <span class="stringliteral">&#39;decimal-leading-zero&#39;</span>:
<a name="l24449"></a>24449             <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:
<a name="l24450"></a>24450             <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-roman&#39;</span>:
<a name="l24451"></a>24451             <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:
<a name="l24452"></a>24452             <span class="keywordflow">case</span> <span class="stringliteral">&#39;upper-roman&#39;</span>:
<a name="l24453"></a>24453             <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:
<a name="l24454"></a>24454             <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-alpha&#39;</span>:
<a name="l24455"></a>24455             <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-latin&#39;</span>:
<a name="l24456"></a>24456             <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:
<a name="l24457"></a>24457             <span class="keywordflow">case</span> <span class="stringliteral">&#39;upper-alpha&#39;</span>:
<a name="l24458"></a>24458             <span class="keywordflow">case</span> <span class="stringliteral">&#39;upper-latin&#39;</span>:
<a name="l24459"></a>24459             <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-greek&#39;</span>: {
<a name="l24460"></a>24460                 $this-&gt;lisymbol = $symbol;
<a name="l24461"></a>24461                 <span class="keywordflow">break</span>;
<a name="l24462"></a>24462             }
<a name="l24463"></a>24463             <span class="keywordflow">default</span> : {
<a name="l24464"></a>24464                 $this-&gt;lisymbol = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24465"></a>24465             }
<a name="l24466"></a>24466         }
<a name="l24467"></a>24467     }
<a name="l24468"></a>24468 <span class="comment"></span>
<a name="l24469"></a>24469 <span class="comment">    /**</span>
<a name="l24470"></a>24470 <span class="comment">     * Set the booklet mode for double-sided pages.</span>
<a name="l24471"></a>24471 <span class="comment">     * @param $booklet (boolean) true set the booklet mode on, false otherwise.</span>
<a name="l24472"></a>24472 <span class="comment">     * @param $inner (float) Inner page margin.</span>
<a name="l24473"></a>24473 <span class="comment">     * @param $outer (float) Outer page margin.</span>
<a name="l24474"></a>24474 <span class="comment">     * @public</span>
<a name="l24475"></a>24475 <span class="comment">     * @since 4.2.000 (2008-10-29)</span>
<a name="l24476"></a>24476 <span class="comment">     */</span>
<a name="l24477"></a><a class="code" href="classTCPDF.html#af57416c0d1b618b2af389b7c651756be">24477</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af57416c0d1b618b2af389b7c651756be" title="Set the booklet mode for double-sided pages.">SetBooklet</a>($booklet=<span class="keyword">true</span>, $inner=-1, $outer=-1) {
<a name="l24478"></a>24478         $this-&gt;booklet = $booklet;
<a name="l24479"></a>24479         <span class="keywordflow">if</span> ($inner &gt;= 0) {
<a name="l24480"></a>24480             $this-&gt;lMargin = $inner;
<a name="l24481"></a>24481         }
<a name="l24482"></a>24482         <span class="keywordflow">if</span> ($outer &gt;= 0) {
<a name="l24483"></a>24483             $this-&gt;rMargin = $outer;
<a name="l24484"></a>24484         }
<a name="l24485"></a>24485     }
<a name="l24486"></a>24486 <span class="comment"></span>
<a name="l24487"></a>24487 <span class="comment">    /**</span>
<a name="l24488"></a>24488 <span class="comment">     * Swap the left and right margins.</span>
<a name="l24489"></a>24489 <span class="comment">     * @param $reverse (boolean) if true swap left and right margins.</span>
<a name="l24490"></a>24490 <span class="comment">     * @protected</span>
<a name="l24491"></a>24491 <span class="comment">     * @since 4.2.000 (2008-10-29)</span>
<a name="l24492"></a>24492 <span class="comment">     */</span>
<a name="l24493"></a><a class="code" href="classTCPDF.html#aae16fb109eb4f3aaa9ba860cfb1cf1f2">24493</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aae16fb109eb4f3aaa9ba860cfb1cf1f2" title="Swap the left and right margins.">swapMargins</a>($reverse=<span class="keyword">true</span>) {
<a name="l24494"></a>24494         <span class="keywordflow">if</span> ($reverse) {
<a name="l24495"></a>24495             <span class="comment">// swap left and right margins</span>
<a name="l24496"></a>24496             $mtemp = $this-&gt;original_lMargin;
<a name="l24497"></a>24497             $this-&gt;original_lMargin = $this-&gt;original_rMargin;
<a name="l24498"></a>24498             $this-&gt;original_rMargin = $mtemp;
<a name="l24499"></a>24499             $deltam = $this-&gt;original_lMargin - $this-&gt;original_rMargin;
<a name="l24500"></a>24500             $this-&gt;lMargin += $deltam;
<a name="l24501"></a>24501             $this-&gt;rMargin -= $deltam;
<a name="l24502"></a>24502         }
<a name="l24503"></a>24503     }
<a name="l24504"></a>24504 <span class="comment"></span>
<a name="l24505"></a>24505 <span class="comment">    /**</span>
<a name="l24506"></a>24506 <span class="comment">     * Set the vertical spaces for HTML tags.</span>
<a name="l24507"></a>24507 <span class="comment">     * The array must have the following structure (example):</span>
<a name="l24508"></a>24508 <span class="comment">     * $tagvs = array(&#39;h1&#39; =&gt; array(0 =&gt; array(&#39;h&#39; =&gt; &#39;&#39;, &#39;n&#39; =&gt; 2), 1 =&gt; array(&#39;h&#39; =&gt; 1.3, &#39;n&#39; =&gt; 1)));</span>
<a name="l24509"></a>24509 <span class="comment">     * The first array level contains the tag names,</span>
<a name="l24510"></a>24510 <span class="comment">     * the second level contains 0 for opening tags or 1 for closing tags,</span>
<a name="l24511"></a>24511 <span class="comment">     * the third level contains the vertical space unit (h) and the number spaces to add (n).</span>
<a name="l24512"></a>24512 <span class="comment">     * If the h parameter is not specified, default values are used.</span>
<a name="l24513"></a>24513 <span class="comment">     * @param $tagvs (array) array of tags and relative vertical spaces.</span>
<a name="l24514"></a>24514 <span class="comment">     * @public</span>
<a name="l24515"></a>24515 <span class="comment">     * @since 4.2.001 (2008-10-30)</span>
<a name="l24516"></a>24516 <span class="comment">     */</span>
<a name="l24517"></a><a class="code" href="classTCPDF.html#a71cec8b4c54a78429640e4767648e73e">24517</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a71cec8b4c54a78429640e4767648e73e" title="Set the vertical spaces for HTML tags.">setHtmlVSpace</a>($tagvs) {
<a name="l24518"></a>24518         $this-&gt;tagvspaces = $tagvs;
<a name="l24519"></a>24519     }
<a name="l24520"></a>24520 <span class="comment"></span>
<a name="l24521"></a>24521 <span class="comment">    /**</span>
<a name="l24522"></a>24522 <span class="comment">     * Set custom width for list indentation.</span>
<a name="l24523"></a>24523 <span class="comment">     * @param $width (float) width of the indentation. Use negative value to disable it.</span>
<a name="l24524"></a>24524 <span class="comment">     * @public</span>
<a name="l24525"></a>24525 <span class="comment">     * @since 4.2.007 (2008-11-12)</span>
<a name="l24526"></a>24526 <span class="comment">     */</span>
<a name="l24527"></a><a class="code" href="classTCPDF.html#a1d8b1b2420194c155de303fac195264f">24527</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1d8b1b2420194c155de303fac195264f" title="Set custom width for list indentation.">setListIndentWidth</a>($width) {
<a name="l24528"></a>24528         <span class="keywordflow">return</span> $this-&gt;customlistindent = floatval($width);
<a name="l24529"></a>24529     }
<a name="l24530"></a>24530 <span class="comment"></span>
<a name="l24531"></a>24531 <span class="comment">    /**</span>
<a name="l24532"></a>24532 <span class="comment">     * Set the top/bottom cell sides to be open or closed when the cell cross the page.</span>
<a name="l24533"></a>24533 <span class="comment">     * @param $isopen (boolean) if true keeps the top/bottom border open for the cell sides that cross the page.</span>
<a name="l24534"></a>24534 <span class="comment">     * @public</span>
<a name="l24535"></a>24535 <span class="comment">     * @since 4.2.010 (2008-11-14)</span>
<a name="l24536"></a>24536 <span class="comment">     */</span>
<a name="l24537"></a><a class="code" href="classTCPDF.html#a71afe1786fa1c806b0e64b516c715b03">24537</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a71afe1786fa1c806b0e64b516c715b03" title="Set the top/bottom cell sides to be open or closed when the cell cross the page.">setOpenCell</a>($isopen) {
<a name="l24538"></a>24538         $this-&gt;opencell = $isopen;
<a name="l24539"></a>24539     }
<a name="l24540"></a>24540 <span class="comment"></span>
<a name="l24541"></a>24541 <span class="comment">    /**</span>
<a name="l24542"></a>24542 <span class="comment">     * Set the color and font style for HTML links.</span>
<a name="l24543"></a>24543 <span class="comment">     * @param $color (array) RGB array of colors</span>
<a name="l24544"></a>24544 <span class="comment">     * @param $fontstyle (string) additional font styles to add</span>
<a name="l24545"></a>24545 <span class="comment">     * @public</span>
<a name="l24546"></a>24546 <span class="comment">     * @since 4.4.003 (2008-12-09)</span>
<a name="l24547"></a>24547 <span class="comment">     */</span>
<a name="l24548"></a><a class="code" href="classTCPDF.html#a8689e059bc8cb0f8436b77d07c7ab32c">24548</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8689e059bc8cb0f8436b77d07c7ab32c" title="Set the color and font style for HTML links.">setHtmlLinksStyle</a>($color=array(0,0,255), $fontstyle=<span class="charliteral">&#39;U&#39;</span>) {
<a name="l24549"></a>24549         $this-&gt;htmlLinkColorArray = $color;
<a name="l24550"></a>24550         $this-&gt;htmlLinkFontStyle = $fontstyle;
<a name="l24551"></a>24551     }
<a name="l24552"></a>24552 <span class="comment"></span>
<a name="l24553"></a>24553 <span class="comment">    /**</span>
<a name="l24554"></a>24554 <span class="comment">     * Convert HTML string containing value and unit of measure to user&#39;s units or points.</span>
<a name="l24555"></a>24555 <span class="comment">     * @param $htmlval (string) string containing values and unit</span>
<a name="l24556"></a>24556 <span class="comment">     * @param $refsize (string) reference value in points</span>
<a name="l24557"></a>24557 <span class="comment">     * @param $defaultunit (string) default unit (can be one of the following: %, em, ex, px, in, mm, pc, pt).</span>
<a name="l24558"></a>24558 <span class="comment">     * @param $points (boolean) if true returns points, otherwise returns value in user&#39;s units</span>
<a name="l24559"></a>24559 <span class="comment">     * @return float value in user&#39;s unit or point if $points=true</span>
<a name="l24560"></a>24560 <span class="comment">     * @public</span>
<a name="l24561"></a>24561 <span class="comment">     * @since 4.4.004 (2008-12-10)</span>
<a name="l24562"></a>24562 <span class="comment">     */</span>
<a name="l24563"></a><a class="code" href="classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">24563</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9" title="Convert HTML string containing value and unit of measure to user&#39;s units or points.">getHTMLUnitToUnits</a>($htmlval, $refsize=1, $defaultunit=<span class="stringliteral">&#39;px&#39;</span>, $points=<span class="keyword">false</span>) {
<a name="l24564"></a>24564         $supportedunits = array(<span class="charliteral">&#39;%&#39;</span>, <span class="stringliteral">&#39;em&#39;</span>, <span class="stringliteral">&#39;ex&#39;</span>, <span class="stringliteral">&#39;px&#39;</span>, <span class="stringliteral">&#39;in&#39;</span>, <span class="stringliteral">&#39;cm&#39;</span>, <span class="stringliteral">&#39;mm&#39;</span>, <span class="stringliteral">&#39;pc&#39;</span>, <span class="stringliteral">&#39;pt&#39;</span>);
<a name="l24565"></a>24565         $retval = 0;
<a name="l24566"></a>24566         $value = 0;
<a name="l24567"></a>24567         $unit = <span class="stringliteral">&#39;px&#39;</span>;
<a name="l24568"></a>24568         $k = $this-&gt;k;
<a name="l24569"></a>24569         <span class="keywordflow">if</span> ($points) {
<a name="l24570"></a>24570             $k = 1;
<a name="l24571"></a>24571         }
<a name="l24572"></a>24572         <span class="keywordflow">if</span> (in_array($defaultunit, $supportedunits)) {
<a name="l24573"></a>24573             $unit = $defaultunit;
<a name="l24574"></a>24574         }
<a name="l24575"></a>24575         <span class="keywordflow">if</span> (is_numeric($htmlval)) {
<a name="l24576"></a>24576             $value = floatval($htmlval);
<a name="l24577"></a>24577         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (preg_match(<span class="stringliteral">&#39;/([0-9\.\-\+]+)/&#39;</span>, $htmlval, $mnum)) {
<a name="l24578"></a>24578             $value = floatval($mnum[1]);
<a name="l24579"></a>24579             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/([a-z%]+)/&#39;</span>, $htmlval, $munit)) {
<a name="l24580"></a>24580                 <span class="keywordflow">if</span> (in_array($munit[1], $supportedunits)) {
<a name="l24581"></a>24581                     $unit = $munit[1];
<a name="l24582"></a>24582                 }
<a name="l24583"></a>24583             }
<a name="l24584"></a>24584         }
<a name="l24585"></a>24585         <span class="keywordflow">switch</span> ($unit) {
<a name="l24586"></a>24586             <span class="comment">// percentage</span>
<a name="l24587"></a>24587             <span class="keywordflow">case</span> <span class="charliteral">&#39;%&#39;</span>: {
<a name="l24588"></a>24588                 $retval = (($value * $refsize) / 100);
<a name="l24589"></a>24589                 <span class="keywordflow">break</span>;
<a name="l24590"></a>24590             }
<a name="l24591"></a>24591             <span class="comment">// relative-size</span>
<a name="l24592"></a>24592             <span class="keywordflow">case</span> <span class="stringliteral">&#39;em&#39;</span>: {
<a name="l24593"></a>24593                 $retval = ($value * $refsize);
<a name="l24594"></a>24594                 <span class="keywordflow">break</span>;
<a name="l24595"></a>24595             }
<a name="l24596"></a>24596             <span class="comment">// height of lower case &#39;x&#39; (about half the font-size)</span>
<a name="l24597"></a>24597             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ex&#39;</span>: {
<a name="l24598"></a>24598                 $retval = $value * ($refsize / 2);
<a name="l24599"></a>24599                 <span class="keywordflow">break</span>;
<a name="l24600"></a>24600             }
<a name="l24601"></a>24601             <span class="comment">// absolute-size</span>
<a name="l24602"></a>24602             <span class="keywordflow">case</span> <span class="stringliteral">&#39;in&#39;</span>: {
<a name="l24603"></a>24603                 $retval = ($value * $this-&gt;dpi) / $k;
<a name="l24604"></a>24604                 <span class="keywordflow">break</span>;
<a name="l24605"></a>24605             }
<a name="l24606"></a>24606             <span class="comment">// centimeters</span>
<a name="l24607"></a>24607             <span class="keywordflow">case</span> <span class="stringliteral">&#39;cm&#39;</span>: {
<a name="l24608"></a>24608                 $retval = ($value / 2.54 * $this-&gt;dpi) / $k;
<a name="l24609"></a>24609                 <span class="keywordflow">break</span>;
<a name="l24610"></a>24610             }
<a name="l24611"></a>24611             <span class="comment">// millimeters</span>
<a name="l24612"></a>24612             <span class="keywordflow">case</span> <span class="stringliteral">&#39;mm&#39;</span>: {
<a name="l24613"></a>24613                 $retval = ($value / 25.4 * $this-&gt;dpi) / $k;
<a name="l24614"></a>24614                 <span class="keywordflow">break</span>;
<a name="l24615"></a>24615             }
<a name="l24616"></a>24616             <span class="comment">// one pica is 12 points</span>
<a name="l24617"></a>24617             <span class="keywordflow">case</span> <span class="stringliteral">&#39;pc&#39;</span>: {
<a name="l24618"></a>24618                 $retval = ($value * 12) / $k;
<a name="l24619"></a>24619                 <span class="keywordflow">break</span>;
<a name="l24620"></a>24620             }
<a name="l24621"></a>24621             <span class="comment">// points</span>
<a name="l24622"></a>24622             <span class="keywordflow">case</span> <span class="stringliteral">&#39;pt&#39;</span>: {
<a name="l24623"></a>24623                 $retval = $value / $k;
<a name="l24624"></a>24624                 <span class="keywordflow">break</span>;
<a name="l24625"></a>24625             }
<a name="l24626"></a>24626             <span class="comment">// pixels</span>
<a name="l24627"></a>24627             <span class="keywordflow">case</span> <span class="stringliteral">&#39;px&#39;</span>: {
<a name="l24628"></a>24628                 $retval = $this-&gt;pixelsToUnits($value);
<a name="l24629"></a>24629                 <span class="keywordflow">break</span>;
<a name="l24630"></a>24630             }
<a name="l24631"></a>24631         }
<a name="l24632"></a>24632         <span class="keywordflow">return</span> $retval;
<a name="l24633"></a>24633     }
<a name="l24634"></a>24634 <span class="comment"></span>
<a name="l24635"></a>24635 <span class="comment">    /**</span>
<a name="l24636"></a>24636 <span class="comment">     * Returns the Roman representation of an integer number</span>
<a name="l24637"></a>24637 <span class="comment">     * @param $number (int) number to convert</span>
<a name="l24638"></a>24638 <span class="comment">     * @return string roman representation of the specified number</span>
<a name="l24639"></a>24639 <span class="comment">     * @since 4.4.004 (2008-12-10)</span>
<a name="l24640"></a>24640 <span class="comment">     * @public</span>
<a name="l24641"></a>24641 <span class="comment">     */</span>
<a name="l24642"></a><a class="code" href="classTCPDF.html#ab4a909481845292e9e5d7bb892600d8e">24642</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab4a909481845292e9e5d7bb892600d8e" title="Returns the Roman representation of an integer number.">intToRoman</a>($number) {
<a name="l24643"></a>24643         $roman = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24644"></a>24644         <span class="keywordflow">while</span> ($number &gt;= 1000) {
<a name="l24645"></a>24645             $roman .= <span class="charliteral">&#39;M&#39;</span>;
<a name="l24646"></a>24646             $number -= 1000;
<a name="l24647"></a>24647         }
<a name="l24648"></a>24648         <span class="keywordflow">while</span> ($number &gt;= 900) {
<a name="l24649"></a>24649             $roman .= <span class="stringliteral">&#39;CM&#39;</span>;
<a name="l24650"></a>24650             $number -= 900;
<a name="l24651"></a>24651         }
<a name="l24652"></a>24652         <span class="keywordflow">while</span> ($number &gt;= 500) {
<a name="l24653"></a>24653             $roman .= <span class="charliteral">&#39;D&#39;</span>;
<a name="l24654"></a>24654             $number -= 500;
<a name="l24655"></a>24655         }
<a name="l24656"></a>24656         <span class="keywordflow">while</span> ($number &gt;= 400) {
<a name="l24657"></a>24657             $roman .= <span class="stringliteral">&#39;CD&#39;</span>;
<a name="l24658"></a>24658             $number -= 400;
<a name="l24659"></a>24659         }
<a name="l24660"></a>24660         <span class="keywordflow">while</span> ($number &gt;= 100) {
<a name="l24661"></a>24661             $roman .= <span class="charliteral">&#39;C&#39;</span>;
<a name="l24662"></a>24662             $number -= 100;
<a name="l24663"></a>24663         }
<a name="l24664"></a>24664         <span class="keywordflow">while</span> ($number &gt;= 90) {
<a name="l24665"></a>24665             $roman .= <span class="stringliteral">&#39;XC&#39;</span>;
<a name="l24666"></a>24666             $number -= 90;
<a name="l24667"></a>24667         }
<a name="l24668"></a>24668         <span class="keywordflow">while</span> ($number &gt;= 50) {
<a name="l24669"></a>24669             $roman .= <span class="charliteral">&#39;L&#39;</span>;
<a name="l24670"></a>24670             $number -= 50;
<a name="l24671"></a>24671         }
<a name="l24672"></a>24672         <span class="keywordflow">while</span> ($number &gt;= 40) {
<a name="l24673"></a>24673             $roman .= <span class="stringliteral">&#39;XL&#39;</span>;
<a name="l24674"></a>24674             $number -= 40;
<a name="l24675"></a>24675         }
<a name="l24676"></a>24676         <span class="keywordflow">while</span> ($number &gt;= 10) {
<a name="l24677"></a>24677             $roman .= <span class="charliteral">&#39;X&#39;</span>;
<a name="l24678"></a>24678             $number -= 10;
<a name="l24679"></a>24679         }
<a name="l24680"></a>24680         <span class="keywordflow">while</span> ($number &gt;= 9) {
<a name="l24681"></a>24681             $roman .= <span class="stringliteral">&#39;IX&#39;</span>;
<a name="l24682"></a>24682             $number -= 9;
<a name="l24683"></a>24683         }
<a name="l24684"></a>24684         <span class="keywordflow">while</span> ($number &gt;= 5) {
<a name="l24685"></a>24685             $roman .= <span class="charliteral">&#39;V&#39;</span>;
<a name="l24686"></a>24686             $number -= 5;
<a name="l24687"></a>24687         }
<a name="l24688"></a>24688         <span class="keywordflow">while</span> ($number &gt;= 4) {
<a name="l24689"></a>24689             $roman .= <span class="stringliteral">&#39;IV&#39;</span>;
<a name="l24690"></a>24690             $number -= 4;
<a name="l24691"></a>24691         }
<a name="l24692"></a>24692         <span class="keywordflow">while</span> ($number &gt;= 1) {
<a name="l24693"></a>24693             $roman .= <span class="charliteral">&#39;I&#39;</span>;
<a name="l24694"></a>24694             --$number;
<a name="l24695"></a>24695         }
<a name="l24696"></a>24696         <span class="keywordflow">return</span> $roman;
<a name="l24697"></a>24697     }
<a name="l24698"></a>24698 <span class="comment"></span>
<a name="l24699"></a>24699 <span class="comment">    /**</span>
<a name="l24700"></a>24700 <span class="comment">     * Output an HTML list bullet or ordered item symbol</span>
<a name="l24701"></a>24701 <span class="comment">     * @param $listdepth (int) list nesting level</span>
<a name="l24702"></a>24702 <span class="comment">     * @param $listtype (string) type of list</span>
<a name="l24703"></a>24703 <span class="comment">     * @param $size (float) current font size</span>
<a name="l24704"></a>24704 <span class="comment">     * @protected</span>
<a name="l24705"></a>24705 <span class="comment">     * @since 4.4.004 (2008-12-10)</span>
<a name="l24706"></a>24706 <span class="comment">     */</span>
<a name="l24707"></a><a class="code" href="classTCPDF.html#a2e2600620c41132dda5479a902374b5c">24707</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2e2600620c41132dda5479a902374b5c" title="Output an HTML list bullet or ordered item symbol.">putHtmlListBullet</a>($listdepth, $listtype=<span class="stringliteral">&#39;&#39;</span>, $size=10) {
<a name="l24708"></a>24708         $size /= $this-&gt;k;
<a name="l24709"></a>24709         $fill = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24710"></a>24710         $bgcolor = $this-&gt;bgcolor;
<a name="l24711"></a>24711         $color = $this-&gt;fgcolor;
<a name="l24712"></a>24712         $strokecolor = $this-&gt;strokecolor;
<a name="l24713"></a>24713         $width = 0;
<a name="l24714"></a>24714         $textitem = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24715"></a>24715         $tmpx = $this-&gt;x;
<a name="l24716"></a>24716         $lspace = $this-&gt;GetStringWidth(<span class="stringliteral">&#39;  &#39;</span>);
<a name="l24717"></a>24717         <span class="keywordflow">if</span> ($listtype == <span class="charliteral">&#39;^&#39;</span>) {
<a name="l24718"></a>24718             <span class="comment">// special symbol used for avoid justification of rect bullet</span>
<a name="l24719"></a>24719             $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;
<a name="l24720"></a>24720             <span class="keywordflow">return</span>;
<a name="l24721"></a>24721         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($listtype == <span class="charliteral">&#39;!&#39;</span>) {
<a name="l24722"></a>24722             <span class="comment">// set default list type for unordered list</span>
<a name="l24723"></a>24723             $deftypes = array(<span class="stringliteral">&#39;disc&#39;</span>, <span class="stringliteral">&#39;circle&#39;</span>, <span class="stringliteral">&#39;square&#39;</span>);
<a name="l24724"></a>24724             $listtype = $deftypes[($listdepth - 1) % 3];
<a name="l24725"></a>24725         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($listtype == <span class="charliteral">&#39;#&#39;</span>) {
<a name="l24726"></a>24726             <span class="comment">// set default list type for ordered list</span>
<a name="l24727"></a>24727             $listtype = <span class="stringliteral">&#39;decimal&#39;</span>;
<a name="l24728"></a>24728         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (substr($listtype, 0, 4) == <span class="stringliteral">&#39;img|&#39;</span>) {
<a name="l24729"></a>24729             <span class="comment">// custom image type (&#39;img|type|width|height|image.ext&#39;)</span>
<a name="l24730"></a>24730             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = explode(<span class="charliteral">&#39;|&#39;</span>, $listtype);
<a name="l24731"></a>24731             $listtype = <span class="stringliteral">&#39;img&#39;</span>;
<a name="l24732"></a>24732         }
<a name="l24733"></a>24733         <span class="keywordflow">switch</span> ($listtype) {
<a name="l24734"></a>24734             <span class="comment">// unordered types</span>
<a name="l24735"></a>24735             <span class="keywordflow">case</span> <span class="stringliteral">&#39;none&#39;</span>: {
<a name="l24736"></a>24736                 <span class="keywordflow">break</span>;
<a name="l24737"></a>24737             }
<a name="l24738"></a>24738             <span class="keywordflow">case</span> <span class="stringliteral">&#39;disc&#39;</span>: {
<a name="l24739"></a>24739                 <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = $size / 6;
<a name="l24740"></a>24740                 $lspace += (2 * <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>);
<a name="l24741"></a>24741                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l24742"></a>24742                     $this-&gt;x += $lspace;
<a name="l24743"></a>24743                 } <span class="keywordflow">else</span> {
<a name="l24744"></a>24744                     $this-&gt;x -= $lspace;
<a name="l24745"></a>24745                 }
<a name="l24746"></a>24746                 $this-&gt;Circle(($this-&gt;x + <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>), ($this-&gt;y + ($this-&gt;lasth / 2)), <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>, 0, 360, <span class="charliteral">&#39;F&#39;</span>, array(), $color, 8);
<a name="l24747"></a>24747                 <span class="keywordflow">break</span>;
<a name="l24748"></a>24748             }
<a name="l24749"></a>24749             <span class="keywordflow">case</span> <span class="stringliteral">&#39;circle&#39;</span>: {
<a name="l24750"></a>24750                 <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = $size / 6;
<a name="l24751"></a>24751                 $lspace += (2 * <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>);
<a name="l24752"></a>24752                 <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l24753"></a>24753                     $this-&gt;x += $lspace;
<a name="l24754"></a>24754                 } <span class="keywordflow">else</span> {
<a name="l24755"></a>24755                     $this-&gt;x -= $lspace;
<a name="l24756"></a>24756                 }
<a name="l24757"></a>24757                 $prev_line_style = $this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor;
<a name="l24758"></a>24758                 $new_line_style = array(<span class="stringliteral">&#39;width&#39;</span> =&gt; (<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> / 3), <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;phase&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span>=&gt;$color);
<a name="l24759"></a>24759                 $this-&gt;Circle(($this-&gt;x + <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>), ($this-&gt;y + ($this-&gt;lasth / 2)), (<a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> * (1 - (1/6))), 0, 360, <span class="charliteral">&#39;D&#39;</span>, $new_line_style, array(), 8);
<a name="l24760"></a>24760                 $this-&gt;_out($prev_line_style); <span class="comment">// restore line settings</span>
<a name="l24761"></a>24761                 <span class="keywordflow">break</span>;
<a name="l24762"></a>24762             }
<a name="l24763"></a>24763             <span class="keywordflow">case</span> <span class="stringliteral">&#39;square&#39;</span>: {
<a name="l24764"></a>24764                 $l = $size / 3;
<a name="l24765"></a>24765                 $lspace += $l;
<a name="l24766"></a>24766                 <span class="keywordflow">if</span> ($this-&gt;rtl) {;
<a name="l24767"></a>24767                     $this-&gt;x += $lspace;
<a name="l24768"></a>24768                 } <span class="keywordflow">else</span> {
<a name="l24769"></a>24769                     $this-&gt;x -= $lspace;
<a name="l24770"></a>24770                 }
<a name="l24771"></a>24771                 $this-&gt;Rect($this-&gt;x, ($this-&gt;y + (($this-&gt;lasth - $l) / 2)), $l, $l, <span class="charliteral">&#39;F&#39;</span>, array(), $color);
<a name="l24772"></a>24772                 <span class="keywordflow">break</span>;
<a name="l24773"></a>24773             }
<a name="l24774"></a>24774             <span class="keywordflow">case</span> <span class="stringliteral">&#39;img&#39;</span>: {
<a name="l24775"></a>24775                 <span class="comment">// 1=&gt;type, 2=&gt;width, 3=&gt;height, 4=&gt;image.ext</span>
<a name="l24776"></a>24776                 $lspace += <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[2];
<a name="l24777"></a>24777                 <span class="keywordflow">if</span> ($this-&gt;rtl) {;
<a name="l24778"></a>24778                     $this-&gt;x += $lspace;
<a name="l24779"></a>24779                 } <span class="keywordflow">else</span> {
<a name="l24780"></a>24780                     $this-&gt;x -= $lspace;
<a name="l24781"></a>24781                 }
<a name="l24782"></a>24782                 $imgtype = strtolower(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[1]);
<a name="l24783"></a>24783                 $prev_y = $this-&gt;y;
<a name="l24784"></a>24784                 <span class="keywordflow">switch</span> ($imgtype) {
<a name="l24785"></a>24785                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;svg&#39;</span>: {
<a name="l24786"></a>24786                         $this-&gt;ImageSVG(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[4], $this-&gt;x, ($this-&gt;y + (($this-&gt;lasth - <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[3]) / 2)), <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[2], <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[3], <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">false</span>);
<a name="l24787"></a>24787                         <span class="keywordflow">break</span>;
<a name="l24788"></a>24788                     }
<a name="l24789"></a>24789                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;ai&#39;</span>:
<a name="l24790"></a>24790                     <span class="keywordflow">case</span> <span class="stringliteral">&#39;eps&#39;</span>: {
<a name="l24791"></a>24791                         $this-&gt;ImageEps(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[4], $this-&gt;x, ($this-&gt;y + (($this-&gt;lasth - <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[3]) / 2)), <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[2], <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[3], <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">false</span>);
<a name="l24792"></a>24792                         <span class="keywordflow">break</span>;
<a name="l24793"></a>24793                     }
<a name="l24794"></a>24794                     <span class="keywordflow">default</span>: {
<a name="l24795"></a>24795                         $this-&gt;Image(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[4], $this-&gt;x, ($this-&gt;y + (($this-&gt;lasth - <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[3]) / 2)), <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[2], <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[3], <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[1], <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);
<a name="l24796"></a>24796                         <span class="keywordflow">break</span>;
<a name="l24797"></a>24797                     }
<a name="l24798"></a>24798                 }
<a name="l24799"></a>24799                 $this-&gt;y = $prev_y;
<a name="l24800"></a>24800                 <span class="keywordflow">break</span>;
<a name="l24801"></a>24801             }
<a name="l24802"></a>24802             <span class="comment">// ordered types</span>
<a name="l24803"></a>24803             <span class="comment">// $this-&gt;listcount[$this-&gt;listnum];</span>
<a name="l24804"></a>24804             <span class="comment">// $textitem</span>
<a name="l24805"></a>24805             <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:
<a name="l24806"></a>24806             <span class="keywordflow">case</span> <span class="stringliteral">&#39;decimal&#39;</span>: {
<a name="l24807"></a>24807                 $textitem = $this-&gt;listcount[$this-&gt;listnum];
<a name="l24808"></a>24808                 <span class="keywordflow">break</span>;
<a name="l24809"></a>24809             }
<a name="l24810"></a>24810             <span class="keywordflow">case</span> <span class="stringliteral">&#39;decimal-leading-zero&#39;</span>: {
<a name="l24811"></a>24811                 $textitem = sprintf(<span class="stringliteral">&#39;%02d&#39;</span>, $this-&gt;listcount[$this-&gt;listnum]);
<a name="l24812"></a>24812                 <span class="keywordflow">break</span>;
<a name="l24813"></a>24813             }
<a name="l24814"></a>24814             <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:
<a name="l24815"></a>24815             <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-roman&#39;</span>: {
<a name="l24816"></a>24816                 $textitem = strtolower($this-&gt;intToRoman($this-&gt;listcount[$this-&gt;listnum]));
<a name="l24817"></a>24817                 <span class="keywordflow">break</span>;
<a name="l24818"></a>24818             }
<a name="l24819"></a>24819             <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:
<a name="l24820"></a>24820             <span class="keywordflow">case</span> <span class="stringliteral">&#39;upper-roman&#39;</span>: {
<a name="l24821"></a>24821                 $textitem = $this-&gt;intToRoman($this-&gt;listcount[$this-&gt;listnum]);
<a name="l24822"></a>24822                 <span class="keywordflow">break</span>;
<a name="l24823"></a>24823             }
<a name="l24824"></a>24824             <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:
<a name="l24825"></a>24825             <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-alpha&#39;</span>:
<a name="l24826"></a>24826             <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-latin&#39;</span>: {
<a name="l24827"></a>24827                 $textitem = chr(97 + $this-&gt;listcount[$this-&gt;listnum] - 1);
<a name="l24828"></a>24828                 <span class="keywordflow">break</span>;
<a name="l24829"></a>24829             }
<a name="l24830"></a>24830             <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:
<a name="l24831"></a>24831             <span class="keywordflow">case</span> <span class="stringliteral">&#39;upper-alpha&#39;</span>:
<a name="l24832"></a>24832             <span class="keywordflow">case</span> <span class="stringliteral">&#39;upper-latin&#39;</span>: {
<a name="l24833"></a>24833                 $textitem = chr(65 + $this-&gt;listcount[$this-&gt;listnum] - 1);
<a name="l24834"></a>24834                 <span class="keywordflow">break</span>;
<a name="l24835"></a>24835             }
<a name="l24836"></a>24836             <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-greek&#39;</span>: {
<a name="l24837"></a>24837                 $textitem = $this-&gt;unichr(945 + $this-&gt;listcount[$this-&gt;listnum] - 1);
<a name="l24838"></a>24838                 <span class="keywordflow">break</span>;
<a name="l24839"></a>24839             }
<a name="l24840"></a>24840             <span class="comment">/*</span>
<a name="l24841"></a>24841 <span class="comment">            // Types to be implemented (special handling)</span>
<a name="l24842"></a>24842 <span class="comment">            case &#39;hebrew&#39;: {</span>
<a name="l24843"></a>24843 <span class="comment">                break;</span>
<a name="l24844"></a>24844 <span class="comment">            }</span>
<a name="l24845"></a>24845 <span class="comment">            case &#39;armenian&#39;: {</span>
<a name="l24846"></a>24846 <span class="comment">                break;</span>
<a name="l24847"></a>24847 <span class="comment">            }</span>
<a name="l24848"></a>24848 <span class="comment">            case &#39;georgian&#39;: {</span>
<a name="l24849"></a>24849 <span class="comment">                break;</span>
<a name="l24850"></a>24850 <span class="comment">            }</span>
<a name="l24851"></a>24851 <span class="comment">            case &#39;cjk-ideographic&#39;: {</span>
<a name="l24852"></a>24852 <span class="comment">                break;</span>
<a name="l24853"></a>24853 <span class="comment">            }</span>
<a name="l24854"></a>24854 <span class="comment">            case &#39;hiragana&#39;: {</span>
<a name="l24855"></a>24855 <span class="comment">                break;</span>
<a name="l24856"></a>24856 <span class="comment">            }</span>
<a name="l24857"></a>24857 <span class="comment">            case &#39;katakana&#39;: {</span>
<a name="l24858"></a>24858 <span class="comment">                break;</span>
<a name="l24859"></a>24859 <span class="comment">            }</span>
<a name="l24860"></a>24860 <span class="comment">            case &#39;hiragana-iroha&#39;: {</span>
<a name="l24861"></a>24861 <span class="comment">                break;</span>
<a name="l24862"></a>24862 <span class="comment">            }</span>
<a name="l24863"></a>24863 <span class="comment">            case &#39;katakana-iroha&#39;: {</span>
<a name="l24864"></a>24864 <span class="comment">                break;</span>
<a name="l24865"></a>24865 <span class="comment">            }</span>
<a name="l24866"></a>24866 <span class="comment">            */</span>
<a name="l24867"></a>24867             <span class="keywordflow">default</span>: {
<a name="l24868"></a>24868                 $textitem = $this-&gt;listcount[$this-&gt;listnum];
<a name="l24869"></a>24869             }
<a name="l24870"></a>24870         }
<a name="l24871"></a>24871         <span class="keywordflow">if</span> (!$this-&gt;empty_string($textitem)) {
<a name="l24872"></a>24872             <span class="comment">// Check whether we need a new page or new column</span>
<a name="l24873"></a>24873             $prev_y = $this-&gt;y;
<a name="l24874"></a>24874             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = ($this-&gt;FontSize * $this-&gt;cell_height_ratio) + $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>];
<a name="l24875"></a>24875             <span class="keywordflow">if</span> ($this-&gt;checkPageBreak(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>) OR ($this-&gt;y &lt; $prev_y)) {
<a name="l24876"></a>24876                 $tmpx = $this-&gt;x;
<a name="l24877"></a>24877             }
<a name="l24878"></a>24878             <span class="comment">// print ordered item</span>
<a name="l24879"></a>24879             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l24880"></a>24880                 $textitem = <span class="charliteral">&#39;.&#39;</span>.$textitem;
<a name="l24881"></a>24881             } <span class="keywordflow">else</span> {
<a name="l24882"></a>24882                 $textitem = $textitem.<span class="charliteral">&#39;.&#39;</span>;
<a name="l24883"></a>24883             }
<a name="l24884"></a>24884             $lspace += $this-&gt;GetStringWidth($textitem);
<a name="l24885"></a>24885             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l24886"></a>24886                 $this-&gt;x += $lspace;
<a name="l24887"></a>24887             } <span class="keywordflow">else</span> {
<a name="l24888"></a>24888                 $this-&gt;x -= $lspace;
<a name="l24889"></a>24889             }
<a name="l24890"></a>24890             $this-&gt;Write($this-&gt;lasth, $textitem, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>);
<a name="l24891"></a>24891         }
<a name="l24892"></a>24892         $this-&gt;x = $tmpx;
<a name="l24893"></a>24893         $this-&gt;lispacer = <span class="charliteral">&#39;^&#39;</span>;
<a name="l24894"></a>24894         <span class="comment">// restore colors</span>
<a name="l24895"></a>24895         $this-&gt;SetFillColorArray($bgcolor);
<a name="l24896"></a>24896         $this-&gt;SetDrawColorArray($strokecolor);
<a name="l24897"></a>24897         $this-&gt;SettextColorArray($color);
<a name="l24898"></a>24898     }
<a name="l24899"></a>24899 <span class="comment"></span>
<a name="l24900"></a>24900 <span class="comment">    /**</span>
<a name="l24901"></a>24901 <span class="comment">     * Returns current graphic variables as array.</span>
<a name="l24902"></a>24902 <span class="comment">     * @return array of graphic variables</span>
<a name="l24903"></a>24903 <span class="comment">     * @protected</span>
<a name="l24904"></a>24904 <span class="comment">     * @since 4.2.010 (2008-11-14)</span>
<a name="l24905"></a>24905 <span class="comment">     */</span>
<a name="l24906"></a><a class="code" href="classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">24906</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a" title="Returns current graphic variables as array.">getGraphicVars</a>() {
<a name="l24907"></a>24907         $grapvars = array(
<a name="l24908"></a>24908             <span class="stringliteral">&#39;FontFamily&#39;</span> =&gt; $this-&gt;FontFamily,
<a name="l24909"></a>24909             <span class="stringliteral">&#39;FontStyle&#39;</span> =&gt; $this-&gt;FontStyle,
<a name="l24910"></a>24910             <span class="stringliteral">&#39;FontSizePt&#39;</span> =&gt; $this-&gt;FontSizePt,
<a name="l24911"></a>24911             <span class="stringliteral">&#39;rMargin&#39;</span> =&gt; $this-&gt;rMargin,
<a name="l24912"></a>24912             <span class="stringliteral">&#39;lMargin&#39;</span> =&gt; $this-&gt;lMargin,
<a name="l24913"></a>24913             <span class="stringliteral">&#39;cell_padding&#39;</span> =&gt; $this-&gt;cell_padding,
<a name="l24914"></a>24914             <span class="stringliteral">&#39;cell_margin&#39;</span> =&gt; $this-&gt;cell_margin,
<a name="l24915"></a>24915             <span class="stringliteral">&#39;LineWidth&#39;</span> =&gt; $this-&gt;LineWidth,
<a name="l24916"></a>24916             <span class="stringliteral">&#39;linestyleWidth&#39;</span> =&gt; $this-&gt;linestyleWidth,
<a name="l24917"></a>24917             <span class="stringliteral">&#39;linestyleCap&#39;</span> =&gt; $this-&gt;linestyleCap,
<a name="l24918"></a>24918             <span class="stringliteral">&#39;linestyleJoin&#39;</span> =&gt; $this-&gt;linestyleJoin,
<a name="l24919"></a>24919             <span class="stringliteral">&#39;linestyleDash&#39;</span> =&gt; $this-&gt;linestyleDash,
<a name="l24920"></a>24920             <span class="stringliteral">&#39;textrendermode&#39;</span> =&gt; $this-&gt;textrendermode,
<a name="l24921"></a>24921             <span class="stringliteral">&#39;textstrokewidth&#39;</span> =&gt; $this-&gt;textstrokewidth,
<a name="l24922"></a>24922             <span class="stringliteral">&#39;DrawColor&#39;</span> =&gt; $this-&gt;DrawColor,
<a name="l24923"></a>24923             <span class="stringliteral">&#39;FillColor&#39;</span> =&gt; $this-&gt;FillColor,
<a name="l24924"></a>24924             <span class="stringliteral">&#39;TextColor&#39;</span> =&gt; $this-&gt;TextColor,
<a name="l24925"></a>24925             <span class="stringliteral">&#39;ColorFlag&#39;</span> =&gt; $this-&gt;ColorFlag,
<a name="l24926"></a>24926             <span class="stringliteral">&#39;bgcolor&#39;</span> =&gt; $this-&gt;bgcolor,
<a name="l24927"></a>24927             <span class="stringliteral">&#39;fgcolor&#39;</span> =&gt; $this-&gt;fgcolor,
<a name="l24928"></a>24928             <span class="stringliteral">&#39;htmlvspace&#39;</span> =&gt; $this-&gt;htmlvspace,
<a name="l24929"></a>24929             <span class="stringliteral">&#39;listindent&#39;</span> =&gt; $this-&gt;listindent,
<a name="l24930"></a>24930             <span class="stringliteral">&#39;listindentlevel&#39;</span> =&gt; $this-&gt;listindentlevel,
<a name="l24931"></a>24931             <span class="stringliteral">&#39;listnum&#39;</span> =&gt; $this-&gt;listnum,
<a name="l24932"></a>24932             <span class="stringliteral">&#39;listordered&#39;</span> =&gt; $this-&gt;listordered,
<a name="l24933"></a>24933             <span class="stringliteral">&#39;listcount&#39;</span> =&gt; $this-&gt;listcount,
<a name="l24934"></a>24934             <span class="stringliteral">&#39;lispacer&#39;</span> =&gt; $this-&gt;lispacer,
<a name="l24935"></a>24935             <span class="stringliteral">&#39;cell_height_ratio&#39;</span> =&gt; $this-&gt;cell_height_ratio,
<a name="l24936"></a>24936             <span class="stringliteral">&#39;font_stretching&#39;</span> =&gt; $this-&gt;font_stretching,
<a name="l24937"></a>24937             <span class="stringliteral">&#39;font_spacing&#39;</span> =&gt; $this-&gt;font_spacing,
<a name="l24938"></a>24938             <span class="comment">// extended</span>
<a name="l24939"></a>24939             <span class="stringliteral">&#39;lasth&#39;</span> =&gt; $this-&gt;lasth,
<a name="l24940"></a>24940             <span class="stringliteral">&#39;tMargin&#39;</span> =&gt; $this-&gt;tMargin,
<a name="l24941"></a>24941             <span class="stringliteral">&#39;bMargin&#39;</span> =&gt; $this-&gt;bMargin,
<a name="l24942"></a>24942             <span class="stringliteral">&#39;AutoPageBreak&#39;</span> =&gt; $this-&gt;AutoPageBreak,
<a name="l24943"></a>24943             <span class="stringliteral">&#39;PageBreakTrigger&#39;</span> =&gt; $this-&gt;PageBreakTrigger,
<a name="l24944"></a>24944             <span class="charliteral">&#39;x&#39;</span> =&gt; $this-&gt;x,
<a name="l24945"></a>24945             <span class="charliteral">&#39;y&#39;</span> =&gt; $this-&gt;y,
<a name="l24946"></a>24946             <span class="charliteral">&#39;w&#39;</span> =&gt; $this-&gt;w,
<a name="l24947"></a>24947             <span class="charliteral">&#39;h&#39;</span> =&gt; $this-&gt;h,
<a name="l24948"></a>24948             <span class="stringliteral">&#39;wPt&#39;</span> =&gt; $this-&gt;wPt,
<a name="l24949"></a>24949             <span class="stringliteral">&#39;hPt&#39;</span> =&gt; $this-&gt;hPt,
<a name="l24950"></a>24950             <span class="stringliteral">&#39;fwPt&#39;</span> =&gt; $this-&gt;fwPt,
<a name="l24951"></a>24951             <span class="stringliteral">&#39;fhPt&#39;</span> =&gt; $this-&gt;fhPt,
<a name="l24952"></a>24952             <span class="stringliteral">&#39;page&#39;</span> =&gt; $this-&gt;page,
<a name="l24953"></a>24953             <span class="stringliteral">&#39;current_column&#39;</span> =&gt; $this-&gt;current_column,
<a name="l24954"></a>24954             <span class="stringliteral">&#39;num_columns&#39;</span> =&gt; $this-&gt;num_columns
<a name="l24955"></a>24955             );
<a name="l24956"></a>24956         <span class="keywordflow">return</span> $grapvars;
<a name="l24957"></a>24957     }
<a name="l24958"></a>24958 <span class="comment"></span>
<a name="l24959"></a>24959 <span class="comment">    /**</span>
<a name="l24960"></a>24960 <span class="comment">     * Set graphic variables.</span>
<a name="l24961"></a>24961 <span class="comment">     * @param $gvars (array) array of graphic variablesto restore</span>
<a name="l24962"></a>24962 <span class="comment">     * @param $extended (boolean) if true restore extended graphic variables</span>
<a name="l24963"></a>24963 <span class="comment">     * @protected</span>
<a name="l24964"></a>24964 <span class="comment">     * @since 4.2.010 (2008-11-14)</span>
<a name="l24965"></a>24965 <span class="comment">     */</span>
<a name="l24966"></a><a class="code" href="classTCPDF.html#a072053646725b19770a795050b3b6221">24966</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a072053646725b19770a795050b3b6221" title="Set graphic variables.">setGraphicVars</a>($gvars, $extended=<span class="keyword">false</span>) {
<a name="l24967"></a>24967         $this-&gt;FontFamily = $gvars[<span class="stringliteral">&#39;FontFamily&#39;</span>];
<a name="l24968"></a>24968         $this-&gt;FontStyle = $gvars[<span class="stringliteral">&#39;FontStyle&#39;</span>];
<a name="l24969"></a>24969         $this-&gt;FontSizePt = $gvars[<span class="stringliteral">&#39;FontSizePt&#39;</span>];
<a name="l24970"></a>24970         $this-&gt;rMargin = $gvars[<span class="stringliteral">&#39;rMargin&#39;</span>];
<a name="l24971"></a>24971         $this-&gt;lMargin = $gvars[<span class="stringliteral">&#39;lMargin&#39;</span>];
<a name="l24972"></a>24972         $this-&gt;cell_padding = $gvars[<span class="stringliteral">&#39;cell_padding&#39;</span>];
<a name="l24973"></a>24973         $this-&gt;cell_margin = $gvars[<span class="stringliteral">&#39;cell_margin&#39;</span>];
<a name="l24974"></a>24974         $this-&gt;LineWidth = $gvars[<span class="stringliteral">&#39;LineWidth&#39;</span>];
<a name="l24975"></a>24975         $this-&gt;linestyleWidth = $gvars[<span class="stringliteral">&#39;linestyleWidth&#39;</span>];
<a name="l24976"></a>24976         $this-&gt;linestyleCap = $gvars[<span class="stringliteral">&#39;linestyleCap&#39;</span>];
<a name="l24977"></a>24977         $this-&gt;linestyleJoin = $gvars[<span class="stringliteral">&#39;linestyleJoin&#39;</span>];
<a name="l24978"></a>24978         $this-&gt;linestyleDash = $gvars[<span class="stringliteral">&#39;linestyleDash&#39;</span>];
<a name="l24979"></a>24979         $this-&gt;textrendermode = $gvars[<span class="stringliteral">&#39;textrendermode&#39;</span>];
<a name="l24980"></a>24980         $this-&gt;textstrokewidth = $gvars[<span class="stringliteral">&#39;textstrokewidth&#39;</span>];
<a name="l24981"></a>24981         $this-&gt;DrawColor = $gvars[<span class="stringliteral">&#39;DrawColor&#39;</span>];
<a name="l24982"></a>24982         $this-&gt;FillColor = $gvars[<span class="stringliteral">&#39;FillColor&#39;</span>];
<a name="l24983"></a>24983         $this-&gt;TextColor = $gvars[<span class="stringliteral">&#39;TextColor&#39;</span>];
<a name="l24984"></a>24984         $this-&gt;ColorFlag = $gvars[<span class="stringliteral">&#39;ColorFlag&#39;</span>];
<a name="l24985"></a>24985         $this-&gt;bgcolor = $gvars[<span class="stringliteral">&#39;bgcolor&#39;</span>];
<a name="l24986"></a>24986         $this-&gt;fgcolor = $gvars[<span class="stringliteral">&#39;fgcolor&#39;</span>];
<a name="l24987"></a>24987         $this-&gt;htmlvspace = $gvars[<span class="stringliteral">&#39;htmlvspace&#39;</span>];
<a name="l24988"></a>24988         $this-&gt;listindent = $gvars[<span class="stringliteral">&#39;listindent&#39;</span>];
<a name="l24989"></a>24989         $this-&gt;listindentlevel = $gvars[<span class="stringliteral">&#39;listindentlevel&#39;</span>];
<a name="l24990"></a>24990         $this-&gt;listnum = $gvars[<span class="stringliteral">&#39;listnum&#39;</span>];
<a name="l24991"></a>24991         $this-&gt;listordered = $gvars[<span class="stringliteral">&#39;listordered&#39;</span>];
<a name="l24992"></a>24992         $this-&gt;listcount = $gvars[<span class="stringliteral">&#39;listcount&#39;</span>];
<a name="l24993"></a>24993         $this-&gt;lispacer = $gvars[<span class="stringliteral">&#39;lispacer&#39;</span>];
<a name="l24994"></a>24994         $this-&gt;cell_height_ratio = $gvars[<span class="stringliteral">&#39;cell_height_ratio&#39;</span>];
<a name="l24995"></a>24995         $this-&gt;font_stretching = $gvars[<span class="stringliteral">&#39;font_stretching&#39;</span>];
<a name="l24996"></a>24996         $this-&gt;font_spacing = $gvars[<span class="stringliteral">&#39;font_spacing&#39;</span>];
<a name="l24997"></a>24997         <span class="keywordflow">if</span> ($extended) {
<a name="l24998"></a>24998             <span class="comment">// restore extended values</span>
<a name="l24999"></a>24999             $this-&gt;lasth = $gvars[<span class="stringliteral">&#39;lasth&#39;</span>];
<a name="l25000"></a>25000             $this-&gt;tMargin = $gvars[<span class="stringliteral">&#39;tMargin&#39;</span>];
<a name="l25001"></a>25001             $this-&gt;bMargin = $gvars[<span class="stringliteral">&#39;bMargin&#39;</span>];
<a name="l25002"></a>25002             $this-&gt;AutoPageBreak = $gvars[<span class="stringliteral">&#39;AutoPageBreak&#39;</span>];
<a name="l25003"></a>25003             $this-&gt;PageBreakTrigger = $gvars[<span class="stringliteral">&#39;PageBreakTrigger&#39;</span>];
<a name="l25004"></a>25004             $this-&gt;x = $gvars[<span class="charliteral">&#39;x&#39;</span>];
<a name="l25005"></a>25005             $this-&gt;y = $gvars[<span class="charliteral">&#39;y&#39;</span>];
<a name="l25006"></a>25006             $this-&gt;w = $gvars[<span class="charliteral">&#39;w&#39;</span>];
<a name="l25007"></a>25007             $this-&gt;h = $gvars[<span class="charliteral">&#39;h&#39;</span>];
<a name="l25008"></a>25008             $this-&gt;wPt = $gvars[<span class="stringliteral">&#39;wPt&#39;</span>];
<a name="l25009"></a>25009             $this-&gt;hPt = $gvars[<span class="stringliteral">&#39;hPt&#39;</span>];
<a name="l25010"></a>25010             $this-&gt;fwPt = $gvars[<span class="stringliteral">&#39;fwPt&#39;</span>];
<a name="l25011"></a>25011             $this-&gt;fhPt = $gvars[<span class="stringliteral">&#39;fhPt&#39;</span>];
<a name="l25012"></a>25012             $this-&gt;page = $gvars[<span class="stringliteral">&#39;page&#39;</span>];
<a name="l25013"></a>25013             $this-&gt;current_column = $gvars[<span class="stringliteral">&#39;current_column&#39;</span>];
<a name="l25014"></a>25014             $this-&gt;num_columns = $gvars[<span class="stringliteral">&#39;num_columns&#39;</span>];
<a name="l25015"></a>25015         }
<a name="l25016"></a>25016         $this-&gt;_out(<span class="stringliteral">&#39;&#39;</span>.$this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor.<span class="charliteral">&#39; &#39;</span>.$this-&gt;FillColor.<span class="stringliteral">&#39;&#39;</span>);
<a name="l25017"></a>25017         <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;FontFamily)) {
<a name="l25018"></a>25018             $this-&gt;SetFont($this-&gt;FontFamily, $this-&gt;FontStyle, $this-&gt;FontSizePt);
<a name="l25019"></a>25019         }
<a name="l25020"></a>25020     }
<a name="l25021"></a>25021 <span class="comment"></span>
<a name="l25022"></a>25022 <span class="comment">    /**</span>
<a name="l25023"></a>25023 <span class="comment">     * Returns a temporary filename for caching object on filesystem.</span>
<a name="l25024"></a>25024 <span class="comment">     * @param $name (string) prefix to add to filename</span>
<a name="l25025"></a>25025 <span class="comment">     * @return string filename.</span>
<a name="l25026"></a>25026 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l25027"></a>25027 <span class="comment">     * @protected</span>
<a name="l25028"></a>25028 <span class="comment">     */</span>
<a name="l25029"></a><a class="code" href="classTCPDF.html#a003edbdbcc2b2fe20f8ba9325cf8c002">25029</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a003edbdbcc2b2fe20f8ba9325cf8c002" title="Returns a temporary filename for caching object on filesystem.">getObjFilename</a>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) {
<a name="l25030"></a>25030         <span class="keywordflow">return</span> tempnam(K_PATH_CACHE, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>.<span class="charliteral">&#39;_&#39;</span>);
<a name="l25031"></a>25031     }
<a name="l25032"></a>25032 <span class="comment"></span>
<a name="l25033"></a>25033 <span class="comment">    /**</span>
<a name="l25034"></a>25034 <span class="comment">     * Writes data to a temporary file on filesystem.</span>
<a name="l25035"></a>25035 <span class="comment">     * @param $filename (string) file name</span>
<a name="l25036"></a>25036 <span class="comment">     * @param $data (mixed) data to write on file</span>
<a name="l25037"></a>25037 <span class="comment">     * @param $append (boolean) if true append data, false replace.</span>
<a name="l25038"></a>25038 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l25039"></a>25039 <span class="comment">     * @protected</span>
<a name="l25040"></a>25040 <span class="comment">     */</span>
<a name="l25041"></a><a class="code" href="classTCPDF.html#a4544684de27739c06476f3ddfb19ab99">25041</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4544684de27739c06476f3ddfb19ab99" title="Writes data to a temporary file on filesystem.">writeDiskCache</a>(<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, $append=<span class="keyword">false</span>) {
<a name="l25042"></a>25042         <span class="keywordflow">if</span> ($append) {
<a name="l25043"></a>25043             $fmode = <span class="stringliteral">&#39;ab+&#39;</span>;
<a name="l25044"></a>25044         } <span class="keywordflow">else</span> {
<a name="l25045"></a>25045             $fmode = <span class="stringliteral">&#39;wb+&#39;</span>;
<a name="l25046"></a>25046         }
<a name="l25047"></a>25047         <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = @fopen(<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>, $fmode);
<a name="l25048"></a>25048         <span class="keywordflow">if</span> (!<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>) {
<a name="l25049"></a>25049             $this-&gt;Error(<span class="stringliteral">&#39;Unable to write cache file: &#39;</span>.<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>);
<a name="l25050"></a>25050         } <span class="keywordflow">else</span> {
<a name="l25051"></a>25051             fwrite(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l25052"></a>25052             fclose(<a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l25053"></a>25053         }
<a name="l25054"></a>25054         <span class="comment">// update file length (needed for transactions)</span>
<a name="l25055"></a>25055         <span class="keywordflow">if</span> (!isset($this-&gt;cache_file_length[<span class="charliteral">&#39;_&#39;</span>.<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>])) {
<a name="l25056"></a>25056             $this-&gt;cache_file_length[<span class="charliteral">&#39;_&#39;</span>.$filename] = strlen(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l25057"></a>25057         } <span class="keywordflow">else</span> {
<a name="l25058"></a>25058             $this-&gt;cache_file_length[<span class="charliteral">&#39;_&#39;</span>.$filename] += strlen(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l25059"></a>25059         }
<a name="l25060"></a>25060     }
<a name="l25061"></a>25061 <span class="comment"></span>
<a name="l25062"></a>25062 <span class="comment">    /**</span>
<a name="l25063"></a>25063 <span class="comment">     * Read data from a temporary file on filesystem.</span>
<a name="l25064"></a>25064 <span class="comment">     * @param $filename (string) file name</span>
<a name="l25065"></a>25065 <span class="comment">     * @return mixed retrieved data</span>
<a name="l25066"></a>25066 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l25067"></a>25067 <span class="comment">     * @protected</span>
<a name="l25068"></a>25068 <span class="comment">     */</span>
<a name="l25069"></a><a class="code" href="classTCPDF.html#a6bfd8fb4ae69bc449721c17721076297">25069</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6bfd8fb4ae69bc449721c17721076297" title="Read data from a temporary file on filesystem.">readDiskCache</a>(<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>) {
<a name="l25070"></a>25070         <span class="keywordflow">return</span> file_get_contents(<a class="code" href="bs__disp__as__mime__type_8php.html#a0722441477f957078ee2437054556cbc">$filename</a>);
<a name="l25071"></a>25071     }
<a name="l25072"></a>25072 <span class="comment"></span>
<a name="l25073"></a>25073 <span class="comment">    /**</span>
<a name="l25074"></a>25074 <span class="comment">     * Set buffer content (always append data).</span>
<a name="l25075"></a>25075 <span class="comment">     * @param $data (string) data</span>
<a name="l25076"></a>25076 <span class="comment">     * @protected</span>
<a name="l25077"></a>25077 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l25078"></a>25078 <span class="comment">     */</span>
<a name="l25079"></a><a class="code" href="classTCPDF.html#a7a19b2f2308c1f3a4ddb97447cb5ee90">25079</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7a19b2f2308c1f3a4ddb97447cb5ee90" title="Set buffer content (always append data).">setBuffer</a>(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l25080"></a>25080         $this-&gt;bufferlen += strlen(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l25081"></a>25081         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l25082"></a>25082             <span class="keywordflow">if</span> (!isset($this-&gt;buffer) OR $this-&gt;empty_string($this-&gt;buffer)) {
<a name="l25083"></a>25083                 $this-&gt;buffer = $this-&gt;getObjFilename(<span class="stringliteral">&#39;buffer&#39;</span>);
<a name="l25084"></a>25084             }
<a name="l25085"></a>25085             $this-&gt;writeDiskCache($this-&gt;buffer, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <span class="keyword">true</span>);
<a name="l25086"></a>25086         } <span class="keywordflow">else</span> {
<a name="l25087"></a>25087             $this-&gt;buffer .= <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25088"></a>25088         }
<a name="l25089"></a>25089     }
<a name="l25090"></a>25090 <span class="comment"></span>
<a name="l25091"></a>25091 <span class="comment">    /**</span>
<a name="l25092"></a>25092 <span class="comment">     * Replace the buffer content</span>
<a name="l25093"></a>25093 <span class="comment">     * @param $data (string) data</span>
<a name="l25094"></a>25094 <span class="comment">     * @protected</span>
<a name="l25095"></a>25095 <span class="comment">     * @since 5.5.000 (2010-06-22)</span>
<a name="l25096"></a>25096 <span class="comment">     */</span>
<a name="l25097"></a><a class="code" href="classTCPDF.html#abbcad4f482db857c9068d1d4846081ba">25097</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#abbcad4f482db857c9068d1d4846081ba" title="Replace the buffer content.">replaceBuffer</a>(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l25098"></a>25098         $this-&gt;bufferlen = strlen(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l25099"></a>25099         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l25100"></a>25100             <span class="keywordflow">if</span> (!isset($this-&gt;buffer) OR $this-&gt;empty_string($this-&gt;buffer)) {
<a name="l25101"></a>25101                 $this-&gt;buffer = $this-&gt;getObjFilename(<span class="stringliteral">&#39;buffer&#39;</span>);
<a name="l25102"></a>25102             }
<a name="l25103"></a>25103             $this-&gt;writeDiskCache($this-&gt;buffer, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, <span class="keyword">false</span>);
<a name="l25104"></a>25104         } <span class="keywordflow">else</span> {
<a name="l25105"></a>25105             $this-&gt;buffer = <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25106"></a>25106         }
<a name="l25107"></a>25107     }
<a name="l25108"></a>25108 <span class="comment"></span>
<a name="l25109"></a>25109 <span class="comment">    /**</span>
<a name="l25110"></a>25110 <span class="comment">     * Get buffer content.</span>
<a name="l25111"></a>25111 <span class="comment">     * @return string buffer content</span>
<a name="l25112"></a>25112 <span class="comment">     * @protected</span>
<a name="l25113"></a>25113 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l25114"></a>25114 <span class="comment">     */</span>
<a name="l25115"></a><a class="code" href="classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">25115</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7" title="Get buffer content.">getBuffer</a>() {
<a name="l25116"></a>25116         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l25117"></a>25117             <span class="keywordflow">return</span> $this-&gt;readDiskCache($this-&gt;buffer);
<a name="l25118"></a>25118         } <span class="keywordflow">else</span> {
<a name="l25119"></a>25119             <span class="keywordflow">return</span> $this-&gt;buffer;
<a name="l25120"></a>25120         }
<a name="l25121"></a>25121     }
<a name="l25122"></a>25122 <span class="comment"></span>
<a name="l25123"></a>25123 <span class="comment">    /**</span>
<a name="l25124"></a>25124 <span class="comment">     * Set page buffer content.</span>
<a name="l25125"></a>25125 <span class="comment">     * @param $page (int) page number</span>
<a name="l25126"></a>25126 <span class="comment">     * @param $data (string) page data</span>
<a name="l25127"></a>25127 <span class="comment">     * @param $append (boolean) if true append data, false replace.</span>
<a name="l25128"></a>25128 <span class="comment">     * @protected</span>
<a name="l25129"></a>25129 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l25130"></a>25130 <span class="comment">     */</span>
<a name="l25131"></a><a class="code" href="classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">25131</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8" title="Set page buffer content.">setPageBuffer</a>(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, $append=<span class="keyword">false</span>) {
<a name="l25132"></a>25132         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l25133"></a>25133             <span class="keywordflow">if</span> (!isset($this-&gt;pages[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>])) {
<a name="l25134"></a>25134                 $this-&gt;pages[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>] = $this-&gt;getObjFilename(<span class="stringliteral">&#39;page&#39;</span>.$page);
<a name="l25135"></a>25135             }
<a name="l25136"></a>25136             $this-&gt;writeDiskCache($this-&gt;pages[$page], <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, $append);
<a name="l25137"></a>25137         } <span class="keywordflow">else</span> {
<a name="l25138"></a>25138             <span class="keywordflow">if</span> ($append) {
<a name="l25139"></a>25139                 $this-&gt;pages[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>] .= <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25140"></a>25140             } <span class="keywordflow">else</span> {
<a name="l25141"></a>25141                 $this-&gt;pages[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>] = <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25142"></a>25142             }
<a name="l25143"></a>25143         }
<a name="l25144"></a>25144         <span class="keywordflow">if</span> ($append AND isset($this-&gt;pagelen[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>])) {
<a name="l25145"></a>25145             $this-&gt;pagelen[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>] += strlen(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l25146"></a>25146         } <span class="keywordflow">else</span> {
<a name="l25147"></a>25147             $this-&gt;pagelen[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>] = strlen(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l25148"></a>25148         }
<a name="l25149"></a>25149     }
<a name="l25150"></a>25150 <span class="comment"></span>
<a name="l25151"></a>25151 <span class="comment">    /**</span>
<a name="l25152"></a>25152 <span class="comment">     * Get page buffer content.</span>
<a name="l25153"></a>25153 <span class="comment">     * @param $page (int) page number</span>
<a name="l25154"></a>25154 <span class="comment">     * @return string page buffer content or false in case of error</span>
<a name="l25155"></a>25155 <span class="comment">     * @protected</span>
<a name="l25156"></a>25156 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l25157"></a>25157 <span class="comment">     */</span>
<a name="l25158"></a><a class="code" href="classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">25158</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56" title="Get page buffer content.">getPageBuffer</a>(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>) {
<a name="l25159"></a>25159         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l25160"></a>25160             <span class="keywordflow">return</span> $this-&gt;readDiskCache($this-&gt;pages[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>]);
<a name="l25161"></a>25161         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;pages[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>])) {
<a name="l25162"></a>25162             <span class="keywordflow">return</span> $this-&gt;pages[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25163"></a>25163         }
<a name="l25164"></a>25164         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l25165"></a>25165     }
<a name="l25166"></a>25166 <span class="comment"></span>
<a name="l25167"></a>25167 <span class="comment">    /**</span>
<a name="l25168"></a>25168 <span class="comment">     * Set image buffer content.</span>
<a name="l25169"></a>25169 <span class="comment">     * @param $image (string) image key</span>
<a name="l25170"></a>25170 <span class="comment">     * @param $data (array) image data</span>
<a name="l25171"></a>25171 <span class="comment">     * @protected</span>
<a name="l25172"></a>25172 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l25173"></a>25173 <span class="comment">     */</span>
<a name="l25174"></a><a class="code" href="classTCPDF.html#a68092d68b3e4947ea283efe0a990e7d9">25174</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a68092d68b3e4947ea283efe0a990e7d9" title="Set image buffer content.">setImageBuffer</a>($image, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l25175"></a>25175         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l25176"></a>25176             <span class="keywordflow">if</span> (!isset($this-&gt;images[$image])) {
<a name="l25177"></a>25177                 $this-&gt;images[$image] = $this-&gt;getObjFilename(<span class="stringliteral">&#39;image&#39;</span>.$image);
<a name="l25178"></a>25178             }
<a name="l25179"></a>25179             $this-&gt;writeDiskCache($this-&gt;images[$image], serialize(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>));
<a name="l25180"></a>25180         } <span class="keywordflow">else</span> {
<a name="l25181"></a>25181             $this-&gt;images[$image] = <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25182"></a>25182         }
<a name="l25183"></a>25183         <span class="keywordflow">if</span> (!in_array($image, $this-&gt;imagekeys)) {
<a name="l25184"></a>25184             $this-&gt;imagekeys[] = $image;
<a name="l25185"></a>25185             ++$this-&gt;numimages;
<a name="l25186"></a>25186         }
<a name="l25187"></a>25187     }
<a name="l25188"></a>25188 <span class="comment"></span>
<a name="l25189"></a>25189 <span class="comment">    /**</span>
<a name="l25190"></a>25190 <span class="comment">     * Set image buffer content for a specified sub-key.</span>
<a name="l25191"></a>25191 <span class="comment">     * @param $image (string) image key</span>
<a name="l25192"></a>25192 <span class="comment">     * @param $key (string) image sub-key</span>
<a name="l25193"></a>25193 <span class="comment">     * @param $data (array) image data</span>
<a name="l25194"></a>25194 <span class="comment">     * @protected</span>
<a name="l25195"></a>25195 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l25196"></a>25196 <span class="comment">     */</span>
<a name="l25197"></a><a class="code" href="classTCPDF.html#a7f6c277af6ed456e709c6b397cf34c51">25197</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7f6c277af6ed456e709c6b397cf34c51" title="Set image buffer content for a specified sub-key.">setImageSubBuffer</a>($image, $key, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l25198"></a>25198         <span class="keywordflow">if</span> (!isset($this-&gt;images[$image])) {
<a name="l25199"></a>25199             $this-&gt;setImageBuffer($image, array());
<a name="l25200"></a>25200         }
<a name="l25201"></a>25201         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l25202"></a>25202             $tmpimg = $this-&gt;getImageBuffer($image);
<a name="l25203"></a>25203             $tmpimg[$key] = <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25204"></a>25204             $this-&gt;writeDiskCache($this-&gt;images[$image], serialize($tmpimg));
<a name="l25205"></a>25205         } <span class="keywordflow">else</span> {
<a name="l25206"></a>25206             $this-&gt;images[$image][$key] = <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25207"></a>25207         }
<a name="l25208"></a>25208     }
<a name="l25209"></a>25209 <span class="comment"></span>
<a name="l25210"></a>25210 <span class="comment">    /**</span>
<a name="l25211"></a>25211 <span class="comment">     * Get image buffer content.</span>
<a name="l25212"></a>25212 <span class="comment">     * @param $image (string) image key</span>
<a name="l25213"></a>25213 <span class="comment">     * @return string image buffer content or false in case of error</span>
<a name="l25214"></a>25214 <span class="comment">     * @protected</span>
<a name="l25215"></a>25215 <span class="comment">     * @since 4.5.000 (2008-12-31)</span>
<a name="l25216"></a>25216 <span class="comment">     */</span>
<a name="l25217"></a><a class="code" href="classTCPDF.html#a1a003edf69be144993c85c07a220315c">25217</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1a003edf69be144993c85c07a220315c" title="Get image buffer content.">getImageBuffer</a>($image) {
<a name="l25218"></a>25218         <span class="keywordflow">if</span> ($this-&gt;diskcache AND isset($this-&gt;images[$image])) {
<a name="l25219"></a>25219             <span class="keywordflow">return</span> unserialize($this-&gt;readDiskCache($this-&gt;images[$image]));
<a name="l25220"></a>25220         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;images[$image])) {
<a name="l25221"></a>25221             <span class="keywordflow">return</span> $this-&gt;images[$image];
<a name="l25222"></a>25222         }
<a name="l25223"></a>25223         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l25224"></a>25224     }
<a name="l25225"></a>25225 <span class="comment"></span>
<a name="l25226"></a>25226 <span class="comment">    /**</span>
<a name="l25227"></a>25227 <span class="comment">     * Set font buffer content.</span>
<a name="l25228"></a>25228 <span class="comment">     * @param $font (string) font key</span>
<a name="l25229"></a>25229 <span class="comment">     * @param $data (array) font data</span>
<a name="l25230"></a>25230 <span class="comment">     * @protected</span>
<a name="l25231"></a>25231 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l25232"></a>25232 <span class="comment">     */</span>
<a name="l25233"></a><a class="code" href="classTCPDF.html#aa9eb763490acb3dfdf3f0cf445e83ca6">25233</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa9eb763490acb3dfdf3f0cf445e83ca6" title="Set font buffer content.">setFontBuffer</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l25234"></a>25234         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l25235"></a>25235             <span class="keywordflow">if</span> (!isset($this-&gt;fonts[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>])) {
<a name="l25236"></a>25236                 $this-&gt;fonts[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>] = $this-&gt;getObjFilename(<span class="stringliteral">&#39;font&#39;</span>);
<a name="l25237"></a>25237             }
<a name="l25238"></a>25238             $this-&gt;writeDiskCache($this-&gt;fonts[$font], serialize(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>));
<a name="l25239"></a>25239         } <span class="keywordflow">else</span> {
<a name="l25240"></a>25240             $this-&gt;fonts[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>] = <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25241"></a>25241         }
<a name="l25242"></a>25242         <span class="keywordflow">if</span> (!in_array(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $this-&gt;fontkeys)) {
<a name="l25243"></a>25243             $this-&gt;fontkeys[] = <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l25244"></a>25244             <span class="comment">// store object ID for current font</span>
<a name="l25245"></a>25245             ++$this-&gt;n;
<a name="l25246"></a>25246             $this-&gt;font_obj_ids[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>] = $this-&gt;n;
<a name="l25247"></a>25247             $this-&gt;setFontSubBuffer(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, <span class="charliteral">&#39;n&#39;</span>, $this-&gt;n);
<a name="l25248"></a>25248         }
<a name="l25249"></a>25249     }
<a name="l25250"></a>25250 <span class="comment"></span>
<a name="l25251"></a>25251 <span class="comment">    /**</span>
<a name="l25252"></a>25252 <span class="comment">     * Set font buffer content.</span>
<a name="l25253"></a>25253 <span class="comment">     * @param $font (string) font key</span>
<a name="l25254"></a>25254 <span class="comment">     * @param $key (string) font sub-key</span>
<a name="l25255"></a>25255 <span class="comment">     * @param $data (array) font data</span>
<a name="l25256"></a>25256 <span class="comment">     * @protected</span>
<a name="l25257"></a>25257 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l25258"></a>25258 <span class="comment">     */</span>
<a name="l25259"></a><a class="code" href="classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb">25259</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb" title="Set font buffer content.">setFontSubBuffer</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>, $key, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l25260"></a>25260         <span class="keywordflow">if</span> (!isset($this-&gt;fonts[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>])) {
<a name="l25261"></a>25261             $this-&gt;setFontBuffer($font, array());
<a name="l25262"></a>25262         }
<a name="l25263"></a>25263         <span class="keywordflow">if</span> ($this-&gt;diskcache) {
<a name="l25264"></a>25264             $tmpfont = $this-&gt;getFontBuffer($font);
<a name="l25265"></a>25265             $tmpfont[$key] = <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25266"></a>25266             $this-&gt;writeDiskCache($this-&gt;fonts[$font], serialize($tmpfont));
<a name="l25267"></a>25267         } <span class="keywordflow">else</span> {
<a name="l25268"></a>25268             $this-&gt;fonts[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>][$key] = <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l25269"></a>25269         }
<a name="l25270"></a>25270     }
<a name="l25271"></a>25271 <span class="comment"></span>
<a name="l25272"></a>25272 <span class="comment">    /**</span>
<a name="l25273"></a>25273 <span class="comment">     * Get font buffer content.</span>
<a name="l25274"></a>25274 <span class="comment">     * @param $font (string) font key</span>
<a name="l25275"></a>25275 <span class="comment">     * @return string font buffer content or false in case of error</span>
<a name="l25276"></a>25276 <span class="comment">     * @protected</span>
<a name="l25277"></a>25277 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l25278"></a>25278 <span class="comment">     */</span>
<a name="l25279"></a><a class="code" href="classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">25279</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ac63fff093a17846764bbcc09af7c8640" title="Get font buffer content.">getFontBuffer</a>(<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>) {
<a name="l25280"></a>25280         <span class="keywordflow">if</span> ($this-&gt;diskcache AND isset($this-&gt;fonts[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>])) {
<a name="l25281"></a>25281             <span class="keywordflow">return</span> unserialize($this-&gt;readDiskCache($this-&gt;fonts[$font]));
<a name="l25282"></a>25282         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;fonts[$font])) {
<a name="l25283"></a>25283             <span class="keywordflow">return</span> $this-&gt;fonts[<a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>];
<a name="l25284"></a>25284         }
<a name="l25285"></a>25285         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l25286"></a>25286     }
<a name="l25287"></a>25287 <span class="comment"></span>
<a name="l25288"></a>25288 <span class="comment">    /**</span>
<a name="l25289"></a>25289 <span class="comment">     * Move a page to a previous position.</span>
<a name="l25290"></a>25290 <span class="comment">     * @param $frompage (int) number of the source page</span>
<a name="l25291"></a>25291 <span class="comment">     * @param $topage (int) number of the destination page (must be less than $frompage)</span>
<a name="l25292"></a>25292 <span class="comment">     * @return true in case of success, false in case of error.</span>
<a name="l25293"></a>25293 <span class="comment">     * @public</span>
<a name="l25294"></a>25294 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l25295"></a>25295 <span class="comment">     */</span>
<a name="l25296"></a><a class="code" href="classTCPDF.html#a3ca50045ed09382a1ed2877778dce3a9">25296</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3ca50045ed09382a1ed2877778dce3a9" title="Move a page to a previous position.">movePage</a>($frompage, $topage) {
<a name="l25297"></a>25297         <span class="keywordflow">if</span> (($frompage &gt; $this-&gt;numpages) OR ($frompage &lt;= $topage)) {
<a name="l25298"></a>25298             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l25299"></a>25299         }
<a name="l25300"></a>25300         <span class="keywordflow">if</span> ($frompage == $this-&gt;page) {
<a name="l25301"></a>25301             <span class="comment">// close the page before moving it</span>
<a name="l25302"></a>25302             $this-&gt;endPage();
<a name="l25303"></a>25303         }
<a name="l25304"></a>25304         <span class="comment">// move all page-related states</span>
<a name="l25305"></a>25305         $tmppage = $this-&gt;getPageBuffer($frompage);
<a name="l25306"></a>25306         $tmppagedim = $this-&gt;pagedim[$frompage];
<a name="l25307"></a>25307         $tmppagelen = $this-&gt;pagelen[$frompage];
<a name="l25308"></a>25308         $tmpintmrk = $this-&gt;intmrk[$frompage];
<a name="l25309"></a>25309         $tmpbordermrk = $this-&gt;bordermrk[$frompage];
<a name="l25310"></a>25310         $tmpcntmrk = $this-&gt;cntmrk[$frompage];
<a name="l25311"></a>25311         <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$frompage])) {
<a name="l25312"></a>25312             $tmpfooterpos = $this-&gt;footerpos[$frompage];
<a name="l25313"></a>25313         }
<a name="l25314"></a>25314         <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$frompage])) {
<a name="l25315"></a>25315             $tmpfooterlen = $this-&gt;footerlen[$frompage];
<a name="l25316"></a>25316         }
<a name="l25317"></a>25317         <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$frompage])) {
<a name="l25318"></a>25318             $tmptransfmrk = $this-&gt;transfmrk[$frompage];
<a name="l25319"></a>25319         }
<a name="l25320"></a>25320         <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$frompage])) {
<a name="l25321"></a>25321             $tmpannots = $this-&gt;PageAnnots[$frompage];
<a name="l25322"></a>25322         }
<a name="l25323"></a>25323         <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup) AND !empty($this-&gt;newpagegroup)) {
<a name="l25324"></a>25324             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = $frompage; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; $topage; --<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l25325"></a>25325                 <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) AND (($i + $this-&gt;pagegroups[$this-&gt;newpagegroup[$i]]) &gt; $frompage)) {
<a name="l25326"></a>25326                     --$this-&gt;pagegroups[$this-&gt;newpagegroup[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]];
<a name="l25327"></a>25327                     <span class="keywordflow">break</span>;
<a name="l25328"></a>25328                 }
<a name="l25329"></a>25329             }
<a name="l25330"></a>25330             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = $topage; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; 0; --<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l25331"></a>25331                 <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) AND (($i + $this-&gt;pagegroups[$this-&gt;newpagegroup[$i]]) &gt; $topage)) {
<a name="l25332"></a>25332                     ++$this-&gt;pagegroups[$this-&gt;newpagegroup[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]];
<a name="l25333"></a>25333                     <span class="keywordflow">break</span>;
<a name="l25334"></a>25334                 }
<a name="l25335"></a>25335             }
<a name="l25336"></a>25336         }
<a name="l25337"></a>25337         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = $frompage; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; $topage; --<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l25338"></a>25338             $j = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> - 1;
<a name="l25339"></a>25339             <span class="comment">// shift pages down</span>
<a name="l25340"></a>25340             $this-&gt;setPageBuffer(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>, $this-&gt;getPageBuffer($j));
<a name="l25341"></a>25341             $this-&gt;pagedim[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;pagedim[$j];
<a name="l25342"></a>25342             $this-&gt;pagelen[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;pagelen[$j];
<a name="l25343"></a>25343             $this-&gt;intmrk[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;intmrk[$j];
<a name="l25344"></a>25344             $this-&gt;bordermrk[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;bordermrk[$j];
<a name="l25345"></a>25345             $this-&gt;cntmrk[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;cntmrk[$j];
<a name="l25346"></a>25346             <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$j])) {
<a name="l25347"></a>25347                 $this-&gt;footerpos[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;footerpos[$j];
<a name="l25348"></a>25348             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;footerpos[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>])) {
<a name="l25349"></a>25349                 unset($this-&gt;footerpos[$i]);
<a name="l25350"></a>25350             }
<a name="l25351"></a>25351             <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$j])) {
<a name="l25352"></a>25352                 $this-&gt;footerlen[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;footerlen[$j];
<a name="l25353"></a>25353             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;footerlen[$i])) {
<a name="l25354"></a>25354                 unset($this-&gt;footerlen[$i]);
<a name="l25355"></a>25355             }
<a name="l25356"></a>25356             <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$j])) {
<a name="l25357"></a>25357                 $this-&gt;transfmrk[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;transfmrk[$j];
<a name="l25358"></a>25358             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;transfmrk[$i])) {
<a name="l25359"></a>25359                 unset($this-&gt;transfmrk[$i]);
<a name="l25360"></a>25360             }
<a name="l25361"></a>25361             <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$j])) {
<a name="l25362"></a>25362                 $this-&gt;PageAnnots[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;PageAnnots[$j];
<a name="l25363"></a>25363             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;PageAnnots[$i])) {
<a name="l25364"></a>25364                 unset($this-&gt;PageAnnots[$i]);
<a name="l25365"></a>25365             }
<a name="l25366"></a>25366             <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$j])) {
<a name="l25367"></a>25367                 $this-&gt;newpagegroup[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;newpagegroup[$j];
<a name="l25368"></a>25368                 unset($this-&gt;newpagegroup[$j]);
<a name="l25369"></a>25369             }
<a name="l25370"></a>25370             <span class="keywordflow">if</span> ($this-&gt;currpagegroup == $j) {
<a name="l25371"></a>25371                 $this-&gt;currpagegroup = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l25372"></a>25372             }
<a name="l25373"></a>25373         }
<a name="l25374"></a>25374         $this-&gt;setPageBuffer($topage, $tmppage);
<a name="l25375"></a>25375         $this-&gt;pagedim[$topage] = $tmppagedim;
<a name="l25376"></a>25376         $this-&gt;pagelen[$topage] = $tmppagelen;
<a name="l25377"></a>25377         $this-&gt;intmrk[$topage] = $tmpintmrk;
<a name="l25378"></a>25378         $this-&gt;bordermrk[$topage] = $tmpbordermrk;
<a name="l25379"></a>25379         $this-&gt;cntmrk[$topage] = $tmpcntmrk;
<a name="l25380"></a>25380         <span class="keywordflow">if</span> (isset($tmpfooterpos)) {
<a name="l25381"></a>25381             $this-&gt;footerpos[$topage] = $tmpfooterpos;
<a name="l25382"></a>25382         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;footerpos[$topage])) {
<a name="l25383"></a>25383             unset($this-&gt;footerpos[$topage]);
<a name="l25384"></a>25384         }
<a name="l25385"></a>25385         <span class="keywordflow">if</span> (isset($tmpfooterlen)) {
<a name="l25386"></a>25386             $this-&gt;footerlen[$topage] = $tmpfooterlen;
<a name="l25387"></a>25387         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;footerlen[$topage])) {
<a name="l25388"></a>25388             unset($this-&gt;footerlen[$topage]);
<a name="l25389"></a>25389         }
<a name="l25390"></a>25390         <span class="keywordflow">if</span> (isset($tmptransfmrk)) {
<a name="l25391"></a>25391             $this-&gt;transfmrk[$topage] = $tmptransfmrk;
<a name="l25392"></a>25392         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;transfmrk[$topage])) {
<a name="l25393"></a>25393             unset($this-&gt;transfmrk[$topage]);
<a name="l25394"></a>25394         }
<a name="l25395"></a>25395         <span class="keywordflow">if</span> (isset($tmpannots)) {
<a name="l25396"></a>25396             $this-&gt;PageAnnots[$topage] = $tmpannots;
<a name="l25397"></a>25397         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;PageAnnots[$topage])) {
<a name="l25398"></a>25398             unset($this-&gt;PageAnnots[$topage]);
<a name="l25399"></a>25399         }
<a name="l25400"></a>25400         <span class="comment">// adjust outlines</span>
<a name="l25401"></a>25401         $tmpoutlines = $this-&gt;outlines;
<a name="l25402"></a>25402         <span class="keywordflow">foreach</span> ($tmpoutlines as $key =&gt; $outline) {
<a name="l25403"></a>25403             <span class="keywordflow">if</span> (($outline[<span class="charliteral">&#39;p&#39;</span>] &gt;= $topage) AND ($outline[<span class="charliteral">&#39;p&#39;</span>] &lt; $frompage)) {
<a name="l25404"></a>25404                 $this-&gt;outlines[$key][<span class="charliteral">&#39;p&#39;</span>] = ($outline[<span class="charliteral">&#39;p&#39;</span>] + 1);
<a name="l25405"></a>25405             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($outline[<span class="charliteral">&#39;p&#39;</span>] == $frompage) {
<a name="l25406"></a>25406                 $this-&gt;outlines[$key][<span class="charliteral">&#39;p&#39;</span>] = $topage;
<a name="l25407"></a>25407             }
<a name="l25408"></a>25408         }
<a name="l25409"></a>25409         <span class="comment">// adjust dests</span>
<a name="l25410"></a>25410         $tmpdests = $this-&gt;dests;
<a name="l25411"></a>25411         <span class="keywordflow">foreach</span> ($tmpdests as $key =&gt; $dest) {
<a name="l25412"></a>25412             <span class="keywordflow">if</span> (($dest[<span class="charliteral">&#39;p&#39;</span>] &gt;= $topage) AND ($dest[<span class="charliteral">&#39;p&#39;</span>] &lt; $frompage)) {
<a name="l25413"></a>25413                 $this-&gt;dests[$key][<span class="charliteral">&#39;p&#39;</span>] = ($dest[<span class="charliteral">&#39;p&#39;</span>] + 1);
<a name="l25414"></a>25414             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dest[<span class="charliteral">&#39;p&#39;</span>] == $frompage) {
<a name="l25415"></a>25415                 $this-&gt;dests[$key][<span class="charliteral">&#39;p&#39;</span>] = $topage;
<a name="l25416"></a>25416             }
<a name="l25417"></a>25417         }
<a name="l25418"></a>25418         <span class="comment">// adjust links</span>
<a name="l25419"></a>25419         $tmplinks = $this-&gt;links;
<a name="l25420"></a>25420         <span class="keywordflow">foreach</span> ($tmplinks as $key =&gt; $link) {
<a name="l25421"></a>25421             <span class="keywordflow">if</span> (($link[0] &gt;= $topage) AND ($link[0] &lt; $frompage)) {
<a name="l25422"></a>25422                 $this-&gt;links[$key][0] = ($link[0] + 1);
<a name="l25423"></a>25423             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($link[0] == $frompage) {
<a name="l25424"></a>25424                 $this-&gt;links[$key][0] = $topage;
<a name="l25425"></a>25425             }
<a name="l25426"></a>25426         }
<a name="l25427"></a>25427         <span class="comment">// adjust javascript</span>
<a name="l25428"></a>25428         $tmpjavascript = $this-&gt;javascript;
<a name="l25429"></a>25429         global $jfrompage, $jtopage;
<a name="l25430"></a>25430         $jfrompage = $frompage;
<a name="l25431"></a>25431         $jtopage = $topage;
<a name="l25432"></a>25432         $this-&gt;javascript = preg_replace_callback(<span class="stringliteral">&#39;/this\.addField\(\&#39;([^\&#39;]*)\&#39;,\&#39;([^\&#39;]*)\&#39;,([0-9]+)/&#39;</span>,
<a name="l25433"></a>25433             create_function(<span class="stringliteral">&#39;$matches&#39;</span>, <span class="stringliteral">&#39;global $jfrompage, $jtopage;</span>
<a name="l25434"></a>25434 <span class="stringliteral">            $pagenum = intval($matches[3]) + 1;</span>
<a name="l25435"></a>25435 <span class="stringliteral">            if (($pagenum &gt;= $jtopage) AND ($pagenum &lt; $jfrompage)) {</span>
<a name="l25436"></a>25436 <span class="stringliteral">                $newpage = ($pagenum + 1);</span>
<a name="l25437"></a>25437 <span class="stringliteral">            } elseif ($pagenum == $jfrompage) {</span>
<a name="l25438"></a>25438 <span class="stringliteral">                $newpage = $jtopage;</span>
<a name="l25439"></a>25439 <span class="stringliteral">            } else {</span>
<a name="l25440"></a>25440 <span class="stringliteral">                $newpage = $pagenum;</span>
<a name="l25441"></a>25441 <span class="stringliteral">            }</span>
<a name="l25442"></a>25442 <span class="stringliteral">            --$newpage;</span>
<a name="l25443"></a>25443 <span class="stringliteral">            return &quot;this.addField(\&#39;&quot;.$matches[1].&quot;\&#39;,\&#39;&quot;.$matches[2].&quot;\&#39;,&quot;.$newpage.&quot;&quot;;&#39;</span>), $tmpjavascript);
<a name="l25444"></a>25444         <span class="comment">// return to last page</span>
<a name="l25445"></a>25445         $this-&gt;lastPage(<span class="keyword">true</span>);
<a name="l25446"></a>25446         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l25447"></a>25447     }
<a name="l25448"></a>25448 <span class="comment"></span>
<a name="l25449"></a>25449 <span class="comment">    /**</span>
<a name="l25450"></a>25450 <span class="comment">     * Remove the specified page.</span>
<a name="l25451"></a>25451 <span class="comment">     * @param $page (int) page to remove</span>
<a name="l25452"></a>25452 <span class="comment">     * @return true in case of success, false in case of error.</span>
<a name="l25453"></a>25453 <span class="comment">     * @public</span>
<a name="l25454"></a>25454 <span class="comment">     * @since 4.6.004 (2009-04-23)</span>
<a name="l25455"></a>25455 <span class="comment">     */</span>
<a name="l25456"></a><a class="code" href="classTCPDF.html#a33ce8521d553c47b685d61d82bffbb5c">25456</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a33ce8521d553c47b685d61d82bffbb5c" title="Remove the specified page.">deletePage</a>(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>) {
<a name="l25457"></a>25457         <span class="keywordflow">if</span> ((<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &lt; 1) OR (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &gt; $this-&gt;numpages)) {
<a name="l25458"></a>25458             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l25459"></a>25459         }
<a name="l25460"></a>25460         <span class="comment">// delete current page</span>
<a name="l25461"></a>25461         unset($this-&gt;pages[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>]);
<a name="l25462"></a>25462         unset($this-&gt;pagedim[$page]);
<a name="l25463"></a>25463         unset($this-&gt;pagelen[$page]);
<a name="l25464"></a>25464         unset($this-&gt;intmrk[$page]);
<a name="l25465"></a>25465         unset($this-&gt;bordermrk[$page]);
<a name="l25466"></a>25466         unset($this-&gt;cntmrk[$page]);
<a name="l25467"></a>25467         <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$page])) {
<a name="l25468"></a>25468             unset($this-&gt;footerpos[$page]);
<a name="l25469"></a>25469         }
<a name="l25470"></a>25470         <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$page])) {
<a name="l25471"></a>25471             unset($this-&gt;footerlen[$page]);
<a name="l25472"></a>25472         }
<a name="l25473"></a>25473         <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$page])) {
<a name="l25474"></a>25474             unset($this-&gt;transfmrk[$page]);
<a name="l25475"></a>25475         }
<a name="l25476"></a>25476         <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$page])) {
<a name="l25477"></a>25477             unset($this-&gt;PageAnnots[$page]);
<a name="l25478"></a>25478         }
<a name="l25479"></a>25479         <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup) AND !empty($this-&gt;newpagegroup)) {
<a name="l25480"></a>25480             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = $page; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &gt; 0; --<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l25481"></a>25481                 <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) AND (($i + $this-&gt;pagegroups[$this-&gt;newpagegroup[$i]]) &gt; $page)) {
<a name="l25482"></a>25482                     --$this-&gt;pagegroups[$this-&gt;newpagegroup[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]];
<a name="l25483"></a>25483                     <span class="keywordflow">break</span>;
<a name="l25484"></a>25484                 }
<a name="l25485"></a>25485             }
<a name="l25486"></a>25486         }
<a name="l25487"></a>25487         <span class="keywordflow">if</span> (isset($this-&gt;pageopen[$page])) {
<a name="l25488"></a>25488             unset($this-&gt;pageopen[$page]);
<a name="l25489"></a>25489         }
<a name="l25490"></a>25490         <span class="keywordflow">if</span> ($page &lt; $this-&gt;numpages) {
<a name="l25491"></a>25491             <span class="comment">// update remaining pages</span>
<a name="l25492"></a>25492             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = $page; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $this-&gt;numpages; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l25493"></a>25493                 $j = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> + 1;
<a name="l25494"></a>25494                 <span class="comment">// shift pages</span>
<a name="l25495"></a>25495                 $this-&gt;setPageBuffer(<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>, $this-&gt;getPageBuffer($j));
<a name="l25496"></a>25496                 $this-&gt;pagedim[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;pagedim[$j];
<a name="l25497"></a>25497                 $this-&gt;pagelen[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;pagelen[$j];
<a name="l25498"></a>25498                 $this-&gt;intmrk[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;intmrk[$j];
<a name="l25499"></a>25499                 $this-&gt;bordermrk[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;bordermrk[$j];
<a name="l25500"></a>25500                 $this-&gt;cntmrk[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;cntmrk[$j];
<a name="l25501"></a>25501                 <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$j])) {
<a name="l25502"></a>25502                     $this-&gt;footerpos[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;footerpos[$j];
<a name="l25503"></a>25503                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;footerpos[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>])) {
<a name="l25504"></a>25504                     unset($this-&gt;footerpos[$i]);
<a name="l25505"></a>25505                 }
<a name="l25506"></a>25506                 <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$j])) {
<a name="l25507"></a>25507                     $this-&gt;footerlen[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;footerlen[$j];
<a name="l25508"></a>25508                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;footerlen[$i])) {
<a name="l25509"></a>25509                     unset($this-&gt;footerlen[$i]);
<a name="l25510"></a>25510                 }
<a name="l25511"></a>25511                 <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$j])) {
<a name="l25512"></a>25512                     $this-&gt;transfmrk[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;transfmrk[$j];
<a name="l25513"></a>25513                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;transfmrk[$i])) {
<a name="l25514"></a>25514                     unset($this-&gt;transfmrk[$i]);
<a name="l25515"></a>25515                 }
<a name="l25516"></a>25516                 <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$j])) {
<a name="l25517"></a>25517                     $this-&gt;PageAnnots[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;PageAnnots[$j];
<a name="l25518"></a>25518                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;PageAnnots[$i])) {
<a name="l25519"></a>25519                     unset($this-&gt;PageAnnots[$i]);
<a name="l25520"></a>25520                 }
<a name="l25521"></a>25521                 <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$j])) {
<a name="l25522"></a>25522                     $this-&gt;newpagegroup[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;newpagegroup[$j];
<a name="l25523"></a>25523                     unset($this-&gt;newpagegroup[$j]);
<a name="l25524"></a>25524                 }
<a name="l25525"></a>25525                 <span class="keywordflow">if</span> ($this-&gt;currpagegroup == $j) {
<a name="l25526"></a>25526                     $this-&gt;currpagegroup = <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>;
<a name="l25527"></a>25527                 }
<a name="l25528"></a>25528                 <span class="keywordflow">if</span> (isset($this-&gt;pageopen[$j])) {
<a name="l25529"></a>25529                     $this-&gt;pageopen[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = $this-&gt;pageopen[$j];
<a name="l25530"></a>25530                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;pageopen[$i])) {
<a name="l25531"></a>25531                     unset($this-&gt;pageopen[$i]);
<a name="l25532"></a>25532                 }
<a name="l25533"></a>25533             }
<a name="l25534"></a>25534             <span class="comment">// remove last page</span>
<a name="l25535"></a>25535             unset($this-&gt;pages[$this-&gt;numpages]);
<a name="l25536"></a>25536             unset($this-&gt;pagedim[$this-&gt;numpages]);
<a name="l25537"></a>25537             unset($this-&gt;pagelen[$this-&gt;numpages]);
<a name="l25538"></a>25538             unset($this-&gt;intmrk[$this-&gt;numpages]);
<a name="l25539"></a>25539             unset($this-&gt;bordermrk[$this-&gt;numpages]);
<a name="l25540"></a>25540             unset($this-&gt;cntmrk[$this-&gt;numpages]);
<a name="l25541"></a>25541             <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$this-&gt;numpages])) {
<a name="l25542"></a>25542                 unset($this-&gt;footerpos[$this-&gt;numpages]);
<a name="l25543"></a>25543             }
<a name="l25544"></a>25544             <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$this-&gt;numpages])) {
<a name="l25545"></a>25545                 unset($this-&gt;footerlen[$this-&gt;numpages]);
<a name="l25546"></a>25546             }
<a name="l25547"></a>25547             <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$this-&gt;numpages])) {
<a name="l25548"></a>25548                 unset($this-&gt;transfmrk[$this-&gt;numpages]);
<a name="l25549"></a>25549             }
<a name="l25550"></a>25550             <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;numpages])) {
<a name="l25551"></a>25551                 unset($this-&gt;PageAnnots[$this-&gt;numpages]);
<a name="l25552"></a>25552             }
<a name="l25553"></a>25553             <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$this-&gt;numpages])) {
<a name="l25554"></a>25554                 unset($this-&gt;newpagegroup[$this-&gt;numpages]);
<a name="l25555"></a>25555             }
<a name="l25556"></a>25556             <span class="keywordflow">if</span> ($this-&gt;currpagegroup == $this-&gt;numpages) {
<a name="l25557"></a>25557                 $this-&gt;currpagegroup = ($this-&gt;numpages - 1);
<a name="l25558"></a>25558             }
<a name="l25559"></a>25559             <span class="keywordflow">if</span> (isset($this-&gt;pagegroups[$this-&gt;numpages])) {
<a name="l25560"></a>25560                 unset($this-&gt;pagegroups[$this-&gt;numpages]);
<a name="l25561"></a>25561             }
<a name="l25562"></a>25562             <span class="keywordflow">if</span> (isset($this-&gt;pageopen[$this-&gt;numpages])) {
<a name="l25563"></a>25563                 unset($this-&gt;pageopen[$this-&gt;numpages]);
<a name="l25564"></a>25564             }
<a name="l25565"></a>25565         }
<a name="l25566"></a>25566         --$this-&gt;numpages;
<a name="l25567"></a>25567         $this-&gt;page = $this-&gt;numpages;
<a name="l25568"></a>25568         <span class="comment">// adjust outlines</span>
<a name="l25569"></a>25569         $tmpoutlines = $this-&gt;outlines;
<a name="l25570"></a>25570         <span class="keywordflow">foreach</span> ($tmpoutlines as $key =&gt; $outline) {
<a name="l25571"></a>25571             <span class="keywordflow">if</span> ($outline[<span class="charliteral">&#39;p&#39;</span>] &gt; $page) {
<a name="l25572"></a>25572                 $this-&gt;outlines[$key][<span class="charliteral">&#39;p&#39;</span>] = $outline[<span class="charliteral">&#39;p&#39;</span>] - 1;
<a name="l25573"></a>25573             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($outline[<span class="charliteral">&#39;p&#39;</span>] == $page) {
<a name="l25574"></a>25574                 unset($this-&gt;outlines[$key]);
<a name="l25575"></a>25575             }
<a name="l25576"></a>25576         }
<a name="l25577"></a>25577         <span class="comment">// adjust dests</span>
<a name="l25578"></a>25578         $tmpdests = $this-&gt;dests;
<a name="l25579"></a>25579         <span class="keywordflow">foreach</span> ($tmpdests as $key =&gt; $dest) {
<a name="l25580"></a>25580             <span class="keywordflow">if</span> ($dest[<span class="charliteral">&#39;p&#39;</span>] &gt; $page) {
<a name="l25581"></a>25581                 $this-&gt;dests[$key][<span class="charliteral">&#39;p&#39;</span>] = $dest[<span class="charliteral">&#39;p&#39;</span>] - 1;
<a name="l25582"></a>25582             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($dest[<span class="charliteral">&#39;p&#39;</span>] == $page) {
<a name="l25583"></a>25583                 unset($this-&gt;dests[$key]);
<a name="l25584"></a>25584             }
<a name="l25585"></a>25585         }
<a name="l25586"></a>25586         <span class="comment">// adjust links</span>
<a name="l25587"></a>25587         $tmplinks = $this-&gt;links;
<a name="l25588"></a>25588         <span class="keywordflow">foreach</span> ($tmplinks as $key =&gt; $link) {
<a name="l25589"></a>25589             <span class="keywordflow">if</span> ($link[0] &gt; $page) {
<a name="l25590"></a>25590                 $this-&gt;links[$key][0] = $link[0] - 1;
<a name="l25591"></a>25591             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($link[0] == $page) {
<a name="l25592"></a>25592                 unset($this-&gt;links[$key]);
<a name="l25593"></a>25593             }
<a name="l25594"></a>25594         }
<a name="l25595"></a>25595         <span class="comment">// adjust javascript</span>
<a name="l25596"></a>25596         $tmpjavascript = $this-&gt;javascript;
<a name="l25597"></a>25597         global $jpage;
<a name="l25598"></a>25598         $jpage = <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>;
<a name="l25599"></a>25599         $this-&gt;javascript = preg_replace_callback(<span class="stringliteral">&#39;/this\.addField\(\&#39;([^\&#39;]*)\&#39;,\&#39;([^\&#39;]*)\&#39;,([0-9]+)/&#39;</span>,
<a name="l25600"></a>25600             create_function(<span class="stringliteral">&#39;$matches&#39;</span>, <span class="stringliteral">&#39;global $jpage;</span>
<a name="l25601"></a>25601 <span class="stringliteral">            $pagenum = intval($matches[3]) + 1;</span>
<a name="l25602"></a>25602 <span class="stringliteral">            if ($pagenum &gt;= $jpage) {</span>
<a name="l25603"></a>25603 <span class="stringliteral">                $newpage = ($pagenum - 1);</span>
<a name="l25604"></a>25604 <span class="stringliteral">            } elseif ($pagenum == $jpage) {</span>
<a name="l25605"></a>25605 <span class="stringliteral">                $newpage = 1;</span>
<a name="l25606"></a>25606 <span class="stringliteral">            } else {</span>
<a name="l25607"></a>25607 <span class="stringliteral">                $newpage = $pagenum;</span>
<a name="l25608"></a>25608 <span class="stringliteral">            }</span>
<a name="l25609"></a>25609 <span class="stringliteral">            --$newpage;</span>
<a name="l25610"></a>25610 <span class="stringliteral">            return &quot;this.addField(\&#39;&quot;.$matches[1].&quot;\&#39;,\&#39;&quot;.$matches[2].&quot;\&#39;,&quot;.$newpage.&quot;&quot;;&#39;</span>), $tmpjavascript);
<a name="l25611"></a>25611         <span class="comment">// return to last page</span>
<a name="l25612"></a>25612         $this-&gt;lastPage(<span class="keyword">true</span>);
<a name="l25613"></a>25613         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l25614"></a>25614     }
<a name="l25615"></a>25615 <span class="comment"></span>
<a name="l25616"></a>25616 <span class="comment">    /**</span>
<a name="l25617"></a>25617 <span class="comment">     * Clone the specified page to a new page.</span>
<a name="l25618"></a>25618 <span class="comment">     * @param $page (int) number of page to copy (0 = current page)</span>
<a name="l25619"></a>25619 <span class="comment">     * @return true in case of success, false in case of error.</span>
<a name="l25620"></a>25620 <span class="comment">     * @public</span>
<a name="l25621"></a>25621 <span class="comment">     * @since 4.9.015 (2010-04-20)</span>
<a name="l25622"></a>25622 <span class="comment">     */</span>
<a name="l25623"></a><a class="code" href="classTCPDF.html#a2e1b92a30f94f161fe51c8ce232885d2">25623</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2e1b92a30f94f161fe51c8ce232885d2" title="Clone the specified page to a new page.">copyPage</a>(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=0) {
<a name="l25624"></a>25624         <span class="keywordflow">if</span> (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> == 0) {
<a name="l25625"></a>25625             <span class="comment">// default value</span>
<a name="l25626"></a>25626             <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = $this-&gt;page;
<a name="l25627"></a>25627         }
<a name="l25628"></a>25628         <span class="keywordflow">if</span> ((<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &lt; 1) OR (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &gt; $this-&gt;numpages)) {
<a name="l25629"></a>25629             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l25630"></a>25630         }
<a name="l25631"></a>25631         <span class="comment">// close the last page</span>
<a name="l25632"></a>25632         $this-&gt;endPage();
<a name="l25633"></a>25633         <span class="comment">// copy all page-related states</span>
<a name="l25634"></a>25634         ++$this-&gt;numpages;
<a name="l25635"></a>25635         $this-&gt;page = $this-&gt;numpages;
<a name="l25636"></a>25636         $this-&gt;setPageBuffer($this-&gt;page, $this-&gt;getPageBuffer(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>));
<a name="l25637"></a>25637         $this-&gt;pagedim[$this-&gt;page] = $this-&gt;pagedim[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25638"></a>25638         $this-&gt;pagelen[$this-&gt;page] = $this-&gt;pagelen[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25639"></a>25639         $this-&gt;intmrk[$this-&gt;page] = $this-&gt;intmrk[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25640"></a>25640         $this-&gt;bordermrk[$this-&gt;page] = $this-&gt;bordermrk[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25641"></a>25641         $this-&gt;cntmrk[$this-&gt;page] = $this-&gt;cntmrk[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25642"></a>25642         $this-&gt;pageopen[$this-&gt;page] = <span class="keyword">false</span>;
<a name="l25643"></a>25643         <span class="keywordflow">if</span> (isset($this-&gt;footerpos[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>])) {
<a name="l25644"></a>25644             $this-&gt;footerpos[$this-&gt;page] = $this-&gt;footerpos[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25645"></a>25645         }
<a name="l25646"></a>25646         <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$page])) {
<a name="l25647"></a>25647             $this-&gt;footerlen[$this-&gt;page] = $this-&gt;footerlen[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25648"></a>25648         }
<a name="l25649"></a>25649         <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$page])) {
<a name="l25650"></a>25650             $this-&gt;transfmrk[$this-&gt;page] = $this-&gt;transfmrk[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25651"></a>25651         }
<a name="l25652"></a>25652         <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$page])) {
<a name="l25653"></a>25653             $this-&gt;PageAnnots[$this-&gt;page] = $this-&gt;PageAnnots[<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>];
<a name="l25654"></a>25654         }
<a name="l25655"></a>25655         <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$page])) {
<a name="l25656"></a>25656             <span class="comment">// start a new group</span>
<a name="l25657"></a>25657             $this-&gt;newpagegroup[$this-&gt;page] = <span class="keyword">sizeof</span>($this-&gt;newpagegroup) + 1;
<a name="l25658"></a>25658             $this-&gt;currpagegroup = $this-&gt;newpagegroup[$this-&gt;page];
<a name="l25659"></a>25659             $this-&gt;pagegroups[$this-&gt;currpagegroup] = 1;
<a name="l25660"></a>25660         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;currpagegroup) AND ($this-&gt;currpagegroup &gt; 0)) {
<a name="l25661"></a>25661             ++$this-&gt;pagegroups[$this-&gt;currpagegroup];
<a name="l25662"></a>25662         }
<a name="l25663"></a>25663         <span class="comment">// copy outlines</span>
<a name="l25664"></a>25664         $tmpoutlines = $this-&gt;outlines;
<a name="l25665"></a>25665         <span class="keywordflow">foreach</span> ($tmpoutlines as $key =&gt; $outline) {
<a name="l25666"></a>25666             <span class="keywordflow">if</span> ($outline[<span class="charliteral">&#39;p&#39;</span>] == $page) {
<a name="l25667"></a>25667                 $this-&gt;outlines[] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $outline[<span class="charliteral">&#39;t&#39;</span>], <span class="charliteral">&#39;l&#39;</span> =&gt; $outline[<span class="charliteral">&#39;l&#39;</span>], <span class="charliteral">&#39;y&#39;</span> =&gt; $outline[<span class="charliteral">&#39;y&#39;</span>], <span class="charliteral">&#39;p&#39;</span> =&gt; $this-&gt;page, <span class="charliteral">&#39;s&#39;</span> =&gt; $outline[<span class="charliteral">&#39;s&#39;</span>], <span class="charliteral">&#39;c&#39;</span> =&gt; $outline[<span class="charliteral">&#39;c&#39;</span>]);
<a name="l25668"></a>25668             }
<a name="l25669"></a>25669         }
<a name="l25670"></a>25670         <span class="comment">// copy links</span>
<a name="l25671"></a>25671         $tmplinks = $this-&gt;links;
<a name="l25672"></a>25672         <span class="keywordflow">foreach</span> ($tmplinks as $key =&gt; $link) {
<a name="l25673"></a>25673             <span class="keywordflow">if</span> ($link[0] == $page) {
<a name="l25674"></a>25674                 $this-&gt;links[] = array($this-&gt;page, $link[1]);
<a name="l25675"></a>25675             }
<a name="l25676"></a>25676         }
<a name="l25677"></a>25677         <span class="comment">// return to last page</span>
<a name="l25678"></a>25678         $this-&gt;lastPage(<span class="keyword">true</span>);
<a name="l25679"></a>25679         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l25680"></a>25680     }
<a name="l25681"></a>25681 <span class="comment"></span>
<a name="l25682"></a>25682 <span class="comment">    /**</span>
<a name="l25683"></a>25683 <span class="comment">     * Output a Table of Content Index (TOC).</span>
<a name="l25684"></a>25684 <span class="comment">     * This method must be called after all Bookmarks were set.</span>
<a name="l25685"></a>25685 <span class="comment">     * Before calling this method you have to open the page using the addTOCPage() method.</span>
<a name="l25686"></a>25686 <span class="comment">     * After calling this method you have to call endTOCPage() to close the TOC page.</span>
<a name="l25687"></a>25687 <span class="comment">     * You can override this method to achieve different styles.</span>
<a name="l25688"></a>25688 <span class="comment">     * @param $page (int) page number where this TOC should be inserted (leave empty for current page).</span>
<a name="l25689"></a>25689 <span class="comment">     * @param $numbersfont (string) set the font for page numbers (please use monospaced font for better alignment).</span>
<a name="l25690"></a>25690 <span class="comment">     * @param $filler (string) string used to fill the space between text and page number.</span>
<a name="l25691"></a>25691 <span class="comment">     * @param $toc_name (string) name to use for TOC bookmark.</span>
<a name="l25692"></a>25692 <span class="comment">     * @param $style (string) Font style for title: B = Bold, I = Italic, BI = Bold + Italic.</span>
<a name="l25693"></a>25693 <span class="comment">     * @param $color (array) RGB color array for bookmark title (values from 0 to 255).</span>
<a name="l25694"></a>25694 <span class="comment">     * @public</span>
<a name="l25695"></a>25695 <span class="comment">     * @author Nicola Asuni</span>
<a name="l25696"></a>25696 <span class="comment">     * @since 4.5.000 (2009-01-02)</span>
<a name="l25697"></a>25697 <span class="comment">     * @see addTOCPage(), endTOCPage(), addHTMLTOC()</span>
<a name="l25698"></a>25698 <span class="comment">     */</span>
<a name="l25699"></a><a class="code" href="classTCPDF.html#ae6ad7850d488bb6c9b32a688f7b4c241">25699</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae6ad7850d488bb6c9b32a688f7b4c241" title="Output a Table of Content Index (TOC).">addTOC</a>(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=<span class="stringliteral">&#39;&#39;</span>, $numbersfont=<span class="stringliteral">&#39;&#39;</span>, $filler=<span class="charliteral">&#39;.&#39;</span>, $toc_name=<span class="stringliteral">&#39;TOC&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $color=array(0,0,0)) {
<a name="l25700"></a>25700         <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> = $this-&gt;FontSizePt;
<a name="l25701"></a>25701         $fontfamily = $this-&gt;FontFamily;
<a name="l25702"></a>25702         $fontstyle = $this-&gt;FontStyle;
<a name="l25703"></a>25703         <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin;
<a name="l25704"></a>25704         <a class="code" href="query_8php.html#ae36fa9d41ca20e761f652a266302eaaa" title="License Agreement for OpenSearchServer.">$spacer</a> = $this-&gt;GetStringWidth(chr(32)) * 4;
<a name="l25705"></a>25705         $page_first = $this-&gt;getPage();
<a name="l25706"></a>25706         $lmargin = $this-&gt;lMargin;
<a name="l25707"></a>25707         $rmargin = $this-&gt;rMargin;
<a name="l25708"></a>25708         $x_start = $this-&gt;GetX();
<a name="l25709"></a>25709         $current_page = $this-&gt;page;
<a name="l25710"></a>25710         $current_column = $this-&gt;current_column;
<a name="l25711"></a>25711         <span class="keywordflow">if</span> ($this-&gt;empty_string($numbersfont)) {
<a name="l25712"></a>25712             $numbersfont = $this-&gt;default_monospaced_font;
<a name="l25713"></a>25713         }
<a name="l25714"></a>25714         <span class="keywordflow">if</span> ($this-&gt;empty_string($filler)) {
<a name="l25715"></a>25715             $filler = <span class="charliteral">&#39; &#39;</span>;
<a name="l25716"></a>25716         }
<a name="l25717"></a>25717         <span class="keywordflow">if</span> ($this-&gt;empty_string(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l25718"></a>25718             $gap = <span class="charliteral">&#39; &#39;</span>;
<a name="l25719"></a>25719         } <span class="keywordflow">else</span> {
<a name="l25720"></a>25720             $gap = <span class="stringliteral">&#39;&#39;</span>;
<a name="l25721"></a>25721             <span class="keywordflow">if</span> (<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> &lt; 1) {
<a name="l25722"></a>25722                 <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a> = 1;
<a name="l25723"></a>25723             }
<a name="l25724"></a>25724         }
<a name="l25725"></a>25725         $this-&gt;SetFont($numbersfont, $fontstyle, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>);
<a name="l25726"></a>25726         $numwidth = $this-&gt;GetStringWidth(<span class="stringliteral">&#39;00000&#39;</span>);
<a name="l25727"></a>25727         $maxpage = 0; <span class="comment">//used for pages on attached documents</span>
<a name="l25728"></a>25728         <span class="keywordflow">foreach</span> ($this-&gt;outlines as $key =&gt; $outline) {
<a name="l25729"></a>25729             <span class="comment">// check for extra pages (used for attachments)</span>
<a name="l25730"></a>25730             <span class="keywordflow">if</span> (($this-&gt;page &gt; $page_first) AND ($outline[<span class="charliteral">&#39;p&#39;</span>] &gt;= $this-&gt;numpages)) {
<a name="l25731"></a>25731                 $outline[<span class="charliteral">&#39;p&#39;</span>] += ($this-&gt;page - $page_first);
<a name="l25732"></a>25732             }
<a name="l25733"></a>25733             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25734"></a>25734                 $aligntext = <span class="charliteral">&#39;R&#39;</span>;
<a name="l25735"></a>25735                 $alignnum = <span class="charliteral">&#39;L&#39;</span>;
<a name="l25736"></a>25736             } <span class="keywordflow">else</span> {
<a name="l25737"></a>25737                 $aligntext = <span class="charliteral">&#39;L&#39;</span>;
<a name="l25738"></a>25738                 $alignnum = <span class="charliteral">&#39;R&#39;</span>;
<a name="l25739"></a>25739             }
<a name="l25740"></a>25740             <span class="keywordflow">if</span> ($outline[<span class="charliteral">&#39;l&#39;</span>] == 0) {
<a name="l25741"></a>25741                 $this-&gt;SetFont($fontfamily, $fontstyle.<span class="charliteral">&#39;B&#39;</span>, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>);
<a name="l25742"></a>25742             } <span class="keywordflow">else</span> {
<a name="l25743"></a>25743                 $this-&gt;SetFont($fontfamily, $fontstyle, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a> - $outline[<span class="charliteral">&#39;l&#39;</span>]);
<a name="l25744"></a>25744             }
<a name="l25745"></a>25745             <span class="comment">// check for page break</span>
<a name="l25746"></a>25746             $this-&gt;checkPageBreak((2 * $this-&gt;FontSize * $this-&gt;cell_height_ratio));
<a name="l25747"></a>25747             <span class="comment">// set margins and X position</span>
<a name="l25748"></a>25748             <span class="keywordflow">if</span> (($this-&gt;page == $current_page) AND ($this-&gt;current_column == $current_column)) {
<a name="l25749"></a>25749                 $this-&gt;lMargin = $lmargin;
<a name="l25750"></a>25750                 $this-&gt;rMargin = $rmargin;
<a name="l25751"></a>25751             } <span class="keywordflow">else</span> {
<a name="l25752"></a>25752                 <span class="keywordflow">if</span> ($this-&gt;current_column != $current_column) {
<a name="l25753"></a>25753                     <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25754"></a>25754                         $x_start = $this-&gt;w - $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>];
<a name="l25755"></a>25755                     } <span class="keywordflow">else</span> {
<a name="l25756"></a>25756                         $x_start = $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>];
<a name="l25757"></a>25757                     }
<a name="l25758"></a>25758                 }
<a name="l25759"></a>25759                 $lmargin = $this-&gt;lMargin;
<a name="l25760"></a>25760                 $rmargin = $this-&gt;rMargin;
<a name="l25761"></a>25761                 $current_page = $this-&gt;page;
<a name="l25762"></a>25762                 $current_column = $this-&gt;current_column;
<a name="l25763"></a>25763             }
<a name="l25764"></a>25764             $this-&gt;SetX($x_start);
<a name="l25765"></a>25765             $indent = (<a class="code" href="query_8php.html#ae36fa9d41ca20e761f652a266302eaaa" title="License Agreement for OpenSearchServer.">$spacer</a> * $outline[<span class="charliteral">&#39;l&#39;</span>]);
<a name="l25766"></a>25766             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25767"></a>25767                 $this-&gt;x -= $indent;
<a name="l25768"></a>25768                 $this-&gt;rMargin = $this-&gt;w - $this-&gt;x;
<a name="l25769"></a>25769             } <span class="keywordflow">else</span> {
<a name="l25770"></a>25770                 $this-&gt;x += $indent;
<a name="l25771"></a>25771                 $this-&gt;lMargin = $this-&gt;x;
<a name="l25772"></a>25772             }
<a name="l25773"></a>25773             $link = $this-&gt;AddLink();
<a name="l25774"></a>25774             $this-&gt;SetLink($link, $outline[<span class="charliteral">&#39;y&#39;</span>], $outline[<span class="charliteral">&#39;p&#39;</span>]);
<a name="l25775"></a>25775             <span class="comment">// write the text</span>
<a name="l25776"></a>25776             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25777"></a>25777                 $txt = <span class="charliteral">&#39; &#39;</span>.$outline[<span class="charliteral">&#39;t&#39;</span>];
<a name="l25778"></a>25778             } <span class="keywordflow">else</span> {
<a name="l25779"></a>25779                 $txt = $outline[<span class="charliteral">&#39;t&#39;</span>].<span class="charliteral">&#39; &#39;</span>;
<a name="l25780"></a>25780             }
<a name="l25781"></a>25781             $this-&gt;Write(0, $txt, $link, <span class="keyword">false</span>, $aligntext, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, $numwidth, <span class="stringliteral">&#39;&#39;</span>);
<a name="l25782"></a>25782             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25783"></a>25783                 $tw = $this-&gt;x - $this-&gt;lMargin;
<a name="l25784"></a>25784             } <span class="keywordflow">else</span> {
<a name="l25785"></a>25785                 $tw = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;
<a name="l25786"></a>25786             }
<a name="l25787"></a>25787             $this-&gt;SetFont($numbersfont, $fontstyle, <a class="code" href="indexfb_8php.html#a7933548037b6436826a04a9c00b4ba11">$fontsize</a>);
<a name="l25788"></a>25788             <span class="keywordflow">if</span> ($this-&gt;empty_string(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l25789"></a>25789                 $pagenum = $outline[<span class="charliteral">&#39;p&#39;</span>];
<a name="l25790"></a>25790             } <span class="keywordflow">else</span> {
<a name="l25791"></a>25791                 <span class="comment">// placemark to be replaced with the correct number</span>
<a name="l25792"></a>25792                 $pagenum = <span class="stringliteral">&#39;{#&#39;</span>.($outline[<span class="charliteral">&#39;p&#39;</span>]).<span class="charliteral">&#39;}&#39;</span>;
<a name="l25793"></a>25793                 <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {
<a name="l25794"></a>25794                     $pagenum = <span class="charliteral">&#39;{&#39;</span>.$pagenum.<span class="charliteral">&#39;}&#39;</span>;
<a name="l25795"></a>25795                 }
<a name="l25796"></a>25796                 $maxpage = max($maxpage, $outline[<span class="charliteral">&#39;p&#39;</span>]);
<a name="l25797"></a>25797             }
<a name="l25798"></a>25798             $fw = ($tw - $this-&gt;GetStringWidth($pagenum.$filler));
<a name="l25799"></a>25799             $numfills = floor($fw / $this-&gt;GetStringWidth($filler));
<a name="l25800"></a>25800             <span class="keywordflow">if</span> ($numfills &gt; 0) {
<a name="l25801"></a>25801                 $rowfill = str_repeat($filler, $numfills);
<a name="l25802"></a>25802             } <span class="keywordflow">else</span> {
<a name="l25803"></a>25803                 $rowfill = <span class="stringliteral">&#39;&#39;</span>;
<a name="l25804"></a>25804             }
<a name="l25805"></a>25805             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25806"></a>25806                 $pagenum = $pagenum.$gap.$rowfill;
<a name="l25807"></a>25807             } <span class="keywordflow">else</span> {
<a name="l25808"></a>25808                 $pagenum = $rowfill.$gap.$pagenum;
<a name="l25809"></a>25809             }
<a name="l25810"></a>25810             <span class="comment">// write the number</span>
<a name="l25811"></a>25811             $this-&gt;Cell($tw, 0, $pagenum, 0, 1, $alignnum, 0, $link, 0);
<a name="l25812"></a>25812         }
<a name="l25813"></a>25813         $page_last = $this-&gt;getPage();
<a name="l25814"></a>25814         $maxpage = max($maxpage, $page_last);
<a name="l25815"></a>25815         $numpages = $page_last - $page_first + 1;
<a name="l25816"></a>25816         <span class="keywordflow">if</span> (!$this-&gt;empty_string(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l25817"></a>25817             <span class="keywordflow">for</span> ($p = $page_first; $p &lt;= $page_last; ++$p) {
<a name="l25818"></a>25818                 <span class="comment">// get page data</span>
<a name="l25819"></a>25819                 $temppage = $this-&gt;getPageBuffer($p);
<a name="l25820"></a>25820                 <span class="keywordflow">for</span> ($n = 1; $n &lt;= $maxpage; ++$n) {
<a name="l25821"></a>25821                     <span class="comment">// update page numbers</span>
<a name="l25822"></a>25822                     $a = <span class="stringliteral">&#39;{#&#39;</span>.$n.<span class="charliteral">&#39;}&#39;</span>;
<a name="l25823"></a>25823                     <span class="comment">// get page number aliases</span>
<a name="l25824"></a>25824                     $pnalias = $this-&gt;getInternalPageNumberAliases($a);
<a name="l25825"></a>25825                     <span class="comment">// calculate replacement number</span>
<a name="l25826"></a>25826                     <span class="keywordflow">if</span> (($n &gt;= <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>) AND ($n &lt;= $this-&gt;numpages)) {
<a name="l25827"></a>25827                         $np = $n + $numpages;
<a name="l25828"></a>25828                     } <span class="keywordflow">else</span> {
<a name="l25829"></a>25829                         $np = $n;
<a name="l25830"></a>25830                     }
<a name="l25831"></a>25831                     $na = $this-&gt;formatTOCPageNumber(($this-&gt;starting_page_number + $np - 1));
<a name="l25832"></a>25832                     $nu = $this-&gt;UTF8ToUTF16BE($na, <span class="keyword">false</span>);
<a name="l25833"></a>25833                     <span class="comment">// replace aliases with numbers</span>
<a name="l25834"></a>25834                     <span class="keywordflow">foreach</span> ($pnalias[<span class="charliteral">&#39;u&#39;</span>] as $u) {
<a name="l25835"></a>25835                         $sfill = str_repeat($filler, max(0, (strlen($u) - strlen($nu.<span class="charliteral">&#39; &#39;</span>))));
<a name="l25836"></a>25836                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25837"></a>25837                             $nr = $nu.$this-&gt;UTF8ToUTF16BE(<span class="charliteral">&#39; &#39;</span>.$sfill);
<a name="l25838"></a>25838                         } <span class="keywordflow">else</span> {
<a name="l25839"></a>25839                             $nr = $this-&gt;UTF8ToUTF16BE($sfill.<span class="charliteral">&#39; &#39;</span>).$nu;
<a name="l25840"></a>25840                         }
<a name="l25841"></a>25841                         $temppage = str_replace($u, $nr, $temppage);
<a name="l25842"></a>25842                     }
<a name="l25843"></a>25843                     <span class="keywordflow">foreach</span> ($pnalias[<span class="charliteral">&#39;a&#39;</span>] as $a) {
<a name="l25844"></a>25844                         $sfill = str_repeat($filler, max(0, (strlen($a) - strlen($na.<span class="charliteral">&#39; &#39;</span>))));
<a name="l25845"></a>25845                         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25846"></a>25846                             $nr = $na.<span class="charliteral">&#39; &#39;</span>.$sfill;
<a name="l25847"></a>25847                         } <span class="keywordflow">else</span> {
<a name="l25848"></a>25848                             $nr = $sfill.<span class="charliteral">&#39; &#39;</span>.$na;
<a name="l25849"></a>25849                         }
<a name="l25850"></a>25850                         $temppage = str_replace($a, $nr, $temppage);
<a name="l25851"></a>25851                     }
<a name="l25852"></a>25852                 }
<a name="l25853"></a>25853                 <span class="comment">// save changes</span>
<a name="l25854"></a>25854                 $this-&gt;setPageBuffer($p, $temppage);
<a name="l25855"></a>25855             }
<a name="l25856"></a>25856             <span class="comment">// move pages</span>
<a name="l25857"></a>25857             $this-&gt;Bookmark($toc_name, 0, 0, $page_first, $style, $color);
<a name="l25858"></a>25858             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numpages; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l25859"></a>25859                 $this-&gt;movePage($page_last, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>);
<a name="l25860"></a>25860             }
<a name="l25861"></a>25861         }
<a name="l25862"></a>25862     }
<a name="l25863"></a>25863 <span class="comment"></span>
<a name="l25864"></a>25864 <span class="comment">    /**</span>
<a name="l25865"></a>25865 <span class="comment">     * Output a Table Of Content Index (TOC) using HTML templates.</span>
<a name="l25866"></a>25866 <span class="comment">     * This method must be called after all Bookmarks were set.</span>
<a name="l25867"></a>25867 <span class="comment">     * Before calling this method you have to open the page using the addTOCPage() method.</span>
<a name="l25868"></a>25868 <span class="comment">     * After calling this method you have to call endTOCPage() to close the TOC page.</span>
<a name="l25869"></a>25869 <span class="comment">     * @param $page (int) page number where this TOC should be inserted (leave empty for current page).</span>
<a name="l25870"></a>25870 <span class="comment">     * @param $toc_name (string) name to use for TOC bookmark.</span>
<a name="l25871"></a>25871 <span class="comment">     * @param $templates (array) array of html templates. Use: &quot;#TOC_DESCRIPTION#&quot; for bookmark title, &quot;#TOC_PAGE_NUMBER#&quot; for page number.</span>
<a name="l25872"></a>25872 <span class="comment">     * @param $correct_align (boolean) if true correct the number alignment (numbers must be in monospaced font like courier and right aligned on LTR, or left aligned on RTL)</span>
<a name="l25873"></a>25873 <span class="comment">     * @param $style (string) Font style for title: B = Bold, I = Italic, BI = Bold + Italic.</span>
<a name="l25874"></a>25874 <span class="comment">     * @param $color (array) RGB color array for title (values from 0 to 255).</span>
<a name="l25875"></a>25875 <span class="comment">     * @public</span>
<a name="l25876"></a>25876 <span class="comment">     * @author Nicola Asuni</span>
<a name="l25877"></a>25877 <span class="comment">     * @since 5.0.001 (2010-05-06)</span>
<a name="l25878"></a>25878 <span class="comment">     * @see addTOCPage(), endTOCPage(), addTOC()</span>
<a name="l25879"></a>25879 <span class="comment">     */</span>
<a name="l25880"></a><a class="code" href="classTCPDF.html#a137bd1e5f930eda5324ce99afb9d1e40">25880</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a137bd1e5f930eda5324ce99afb9d1e40" title="Output a Table Of Content Index (TOC) using HTML templates.">addHTMLTOC</a>(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>=<span class="stringliteral">&#39;&#39;</span>, $toc_name=<span class="stringliteral">&#39;TOC&#39;</span>, $templates=array(), $correct_align=<span class="keyword">true</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $color=array(0,0,0)) {
<a name="l25881"></a>25881         $filler = <span class="charliteral">&#39; &#39;</span>;
<a name="l25882"></a>25882         $prev_htmlLinkColorArray = $this-&gt;htmlLinkColorArray;
<a name="l25883"></a>25883         $prev_htmlLinkFontStyle = $this-&gt;htmlLinkFontStyle;
<a name="l25884"></a>25884         <span class="comment">// set new style for link</span>
<a name="l25885"></a>25885         $this-&gt;htmlLinkColorArray = array();
<a name="l25886"></a>25886         $this-&gt;htmlLinkFontStyle = <span class="stringliteral">&#39;&#39;</span>;
<a name="l25887"></a>25887         $page_first = $this-&gt;getPage();
<a name="l25888"></a>25888         <span class="comment">// get the font type used for numbers in each template</span>
<a name="l25889"></a>25889         $current_font = $this-&gt;FontFamily;
<a name="l25890"></a>25890         <span class="keywordflow">foreach</span> ($templates as $level =&gt; <a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>) {
<a name="l25891"></a>25891             $dom = $this-&gt;getHtmlDomArray(<a class="code" href="modules_2proxy_2index_8php.html#a6f96e7fc92441776c9d1cd3386663b40">$html</a>);
<a name="l25892"></a>25892             <span class="keywordflow">foreach</span> ($dom as $key =&gt; $value) {
<a name="l25893"></a>25893                 <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;#TOC_PAGE_NUMBER#&#39;</span>) {
<a name="l25894"></a>25894                     $this-&gt;SetFont($dom[($key - 1)][<span class="stringliteral">&#39;fontname&#39;</span>]);
<a name="l25895"></a>25895                     $templates[<span class="charliteral">&#39;F&#39;</span>.$level] = $this-&gt;isUnicodeFont();
<a name="l25896"></a>25896                 }
<a name="l25897"></a>25897             }
<a name="l25898"></a>25898         }
<a name="l25899"></a>25899         $this-&gt;SetFont($current_font);
<a name="l25900"></a>25900         $maxpage = 0; <span class="comment">//used for pages on attached documents</span>
<a name="l25901"></a>25901         <span class="keywordflow">foreach</span> ($this-&gt;outlines as $key =&gt; $outline) {
<a name="l25902"></a>25902             <span class="comment">// get HTML template</span>
<a name="l25903"></a>25903             <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a> = $templates[$outline[<span class="charliteral">&#39;l&#39;</span>]];
<a name="l25904"></a>25904             <span class="keywordflow">if</span> ($this-&gt;empty_string(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l25905"></a>25905                 $pagenum = $outline[<span class="charliteral">&#39;p&#39;</span>];
<a name="l25906"></a>25906             } <span class="keywordflow">else</span> {
<a name="l25907"></a>25907                 <span class="comment">// placemark to be replaced with the correct number</span>
<a name="l25908"></a>25908                 $pagenum = <span class="stringliteral">&#39;{#&#39;</span>.($outline[<span class="charliteral">&#39;p&#39;</span>]).<span class="charliteral">&#39;}&#39;</span>;
<a name="l25909"></a>25909                 <span class="keywordflow">if</span> ($templates[<span class="charliteral">&#39;F&#39;</span>.$outline[<span class="charliteral">&#39;l&#39;</span>]]) {
<a name="l25910"></a>25910                     $pagenum = <span class="charliteral">&#39;{&#39;</span>.$pagenum.<span class="charliteral">&#39;}&#39;</span>;
<a name="l25911"></a>25911                 }
<a name="l25912"></a>25912                 $maxpage = max($maxpage, $outline[<span class="charliteral">&#39;p&#39;</span>]);
<a name="l25913"></a>25913             }
<a name="l25914"></a>25914             <span class="comment">// replace templates with current values</span>
<a name="l25915"></a>25915             <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a> = str_replace(<span class="stringliteral">&#39;#TOC_DESCRIPTION#&#39;</span>, $outline[<span class="charliteral">&#39;t&#39;</span>], <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>);
<a name="l25916"></a>25916             <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a> = str_replace(<span class="stringliteral">&#39;#TOC_PAGE_NUMBER#&#39;</span>, $pagenum, <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>);
<a name="l25917"></a>25917             <span class="comment">// add link to page</span>
<a name="l25918"></a>25918             <a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a> = <span class="stringliteral">&#39;&lt;a href=&quot;#&#39;</span>.$outline[<span class="charliteral">&#39;p&#39;</span>].<span class="charliteral">&#39;,&#39;</span>.$outline[<span class="charliteral">&#39;y&#39;</span>].<span class="stringliteral">&#39;&quot;&gt;&#39;</span>.<a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>.<span class="stringliteral">&#39;&lt;/a&gt;&#39;</span>;
<a name="l25919"></a>25919             <span class="comment">// write bookmark entry</span>
<a name="l25920"></a>25920             $this-&gt;writeHTML(<a class="code" href="db__qbe_8php.html#aa1d731aa570613e5bcff831bb10e9b87">$row</a>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l25921"></a>25921         }
<a name="l25922"></a>25922         <span class="comment">// restore link styles</span>
<a name="l25923"></a>25923         $this-&gt;htmlLinkColorArray = $prev_htmlLinkColorArray;
<a name="l25924"></a>25924         $this-&gt;htmlLinkFontStyle = $prev_htmlLinkFontStyle;
<a name="l25925"></a>25925         <span class="comment">// move TOC page and replace numbers</span>
<a name="l25926"></a>25926         $page_last = $this-&gt;getPage();
<a name="l25927"></a>25927         $maxpage = max($maxpage, $page_last);
<a name="l25928"></a>25928         $numpages = $page_last - $page_first + 1;
<a name="l25929"></a>25929         <span class="keywordflow">if</span> (!$this-&gt;empty_string(<a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>)) {
<a name="l25930"></a>25930             <span class="keywordflow">for</span> ($p = $page_first; $p &lt;= $page_last; ++$p) {
<a name="l25931"></a>25931                 <span class="comment">// get page data</span>
<a name="l25932"></a>25932                 $temppage = $this-&gt;getPageBuffer($p);
<a name="l25933"></a>25933                 <span class="keywordflow">for</span> ($n = 1; $n &lt;= $maxpage; ++$n) {
<a name="l25934"></a>25934                     <span class="comment">// update page numbers</span>
<a name="l25935"></a>25935                     $a = <span class="stringliteral">&#39;{#&#39;</span>.$n.<span class="charliteral">&#39;}&#39;</span>;
<a name="l25936"></a>25936                     <span class="comment">// get page number aliases</span>
<a name="l25937"></a>25937                     $pnalias = $this-&gt;getInternalPageNumberAliases($a);
<a name="l25938"></a>25938                     <span class="comment">// calculate replacement number</span>
<a name="l25939"></a>25939                     <span class="keywordflow">if</span> ($n &gt;= <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>) {
<a name="l25940"></a>25940                         $np = $n + $numpages;
<a name="l25941"></a>25941                     } <span class="keywordflow">else</span> {
<a name="l25942"></a>25942                         $np = $n;
<a name="l25943"></a>25943                     }
<a name="l25944"></a>25944                     $na = $this-&gt;formatTOCPageNumber(($this-&gt;starting_page_number + $np - 1));
<a name="l25945"></a>25945                     $nu = $this-&gt;UTF8ToUTF16BE($na, <span class="keyword">false</span>);
<a name="l25946"></a>25946                     <span class="comment">// replace aliases with numbers</span>
<a name="l25947"></a>25947                     <span class="keywordflow">foreach</span> ($pnalias[<span class="charliteral">&#39;u&#39;</span>] as $u) {
<a name="l25948"></a>25948                         <span class="keywordflow">if</span> ($correct_align) {
<a name="l25949"></a>25949                             $sfill = str_repeat($filler, (strlen($u) - strlen($nu.<span class="charliteral">&#39; &#39;</span>)));
<a name="l25950"></a>25950                             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25951"></a>25951                                 $nr = $nu.$this-&gt;UTF8ToUTF16BE(<span class="charliteral">&#39; &#39;</span>.$sfill);
<a name="l25952"></a>25952                             } <span class="keywordflow">else</span> {
<a name="l25953"></a>25953                                 $nr = $this-&gt;UTF8ToUTF16BE($sfill.<span class="charliteral">&#39; &#39;</span>).$nu;
<a name="l25954"></a>25954                             }
<a name="l25955"></a>25955                         } <span class="keywordflow">else</span> {
<a name="l25956"></a>25956                             $nr = $nu;
<a name="l25957"></a>25957                         }
<a name="l25958"></a>25958                         $temppage = str_replace($u, $nr, $temppage);
<a name="l25959"></a>25959                     }
<a name="l25960"></a>25960                     <span class="keywordflow">foreach</span> ($pnalias[<span class="charliteral">&#39;a&#39;</span>] as $a) {
<a name="l25961"></a>25961                         <span class="keywordflow">if</span> ($correct_align) {
<a name="l25962"></a>25962                             $sfill = str_repeat($filler, (strlen($a) - strlen($na.<span class="charliteral">&#39; &#39;</span>)));
<a name="l25963"></a>25963                             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l25964"></a>25964                                 $nr = $na.<span class="charliteral">&#39; &#39;</span>.$sfill;
<a name="l25965"></a>25965                             } <span class="keywordflow">else</span> {
<a name="l25966"></a>25966                                 $nr = $sfill.<span class="charliteral">&#39; &#39;</span>.$na;
<a name="l25967"></a>25967                             }
<a name="l25968"></a>25968                         } <span class="keywordflow">else</span> {
<a name="l25969"></a>25969                             $nr = $na;
<a name="l25970"></a>25970                         }
<a name="l25971"></a>25971                         $temppage = str_replace($a, $nr, $temppage);
<a name="l25972"></a>25972                     }
<a name="l25973"></a>25973                 }
<a name="l25974"></a>25974                 <span class="comment">// save changes</span>
<a name="l25975"></a>25975                 $this-&gt;setPageBuffer($p, $temppage);
<a name="l25976"></a>25976             }
<a name="l25977"></a>25977             <span class="comment">// move pages</span>
<a name="l25978"></a>25978             $this-&gt;Bookmark($toc_name, 0, 0, $page_first, $style, $color);
<a name="l25979"></a>25979             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; $numpages; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l25980"></a>25980                 $this-&gt;movePage($page_last, <a class="code" href="3rdparty_2phpmyadmin_2setup_2index_8php.html#a0a44e6760141442bb439b1ab1395d8ff" title="Core libraries.">$page</a>);
<a name="l25981"></a>25981             }
<a name="l25982"></a>25982         }
<a name="l25983"></a>25983     }
<a name="l25984"></a>25984 <span class="comment"></span>
<a name="l25985"></a>25985 <span class="comment">    /**</span>
<a name="l25986"></a>25986 <span class="comment">     * Stores a copy of the current TCPDF object used for undo operation.</span>
<a name="l25987"></a>25987 <span class="comment">     * @public</span>
<a name="l25988"></a>25988 <span class="comment">     * @since 4.5.029 (2009-03-19)</span>
<a name="l25989"></a>25989 <span class="comment">     */</span>
<a name="l25990"></a><a class="code" href="classTCPDF.html#a797b9be1f9c2d031e5dce8c5b3a9e27c">25990</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a797b9be1f9c2d031e5dce8c5b3a9e27c" title="Stores a copy of the current TCPDF object used for undo operation.">startTransaction</a>() {
<a name="l25991"></a>25991         <span class="keywordflow">if</span> (isset($this-&gt;objcopy)) {
<a name="l25992"></a>25992             <span class="comment">// remove previous copy</span>
<a name="l25993"></a>25993             $this-&gt;commitTransaction();
<a name="l25994"></a>25994         }
<a name="l25995"></a>25995         <span class="comment">// record current page number and Y position</span>
<a name="l25996"></a>25996         $this-&gt;start_transaction_page = $this-&gt;page;
<a name="l25997"></a>25997         $this-&gt;start_transaction_y = $this-&gt;y;
<a name="l25998"></a>25998         <span class="comment">// clone current object</span>
<a name="l25999"></a>25999         $this-&gt;objcopy = $this-&gt;objclone($this);
<a name="l26000"></a>26000     }
<a name="l26001"></a>26001 <span class="comment"></span>
<a name="l26002"></a>26002 <span class="comment">    /**</span>
<a name="l26003"></a>26003 <span class="comment">     * Delete the copy of the current TCPDF object used for undo operation.</span>
<a name="l26004"></a>26004 <span class="comment">     * @public</span>
<a name="l26005"></a>26005 <span class="comment">     * @since 4.5.029 (2009-03-19)</span>
<a name="l26006"></a>26006 <span class="comment">     */</span>
<a name="l26007"></a><a class="code" href="classTCPDF.html#a8f5242efde7c458dd3ec011f52010503">26007</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8f5242efde7c458dd3ec011f52010503" title="Delete the copy of the current TCPDF object used for undo operation.">commitTransaction</a>() {
<a name="l26008"></a>26008         <span class="keywordflow">if</span> (isset($this-&gt;objcopy)) {
<a name="l26009"></a>26009             $this-&gt;objcopy-&gt;_destroy(<span class="keyword">true</span>, <span class="keyword">true</span>);
<a name="l26010"></a>26010             unset($this-&gt;objcopy);
<a name="l26011"></a>26011         }
<a name="l26012"></a>26012     }
<a name="l26013"></a>26013 <span class="comment"></span>
<a name="l26014"></a>26014 <span class="comment">    /**</span>
<a name="l26015"></a>26015 <span class="comment">     * This method allows to undo the latest transaction by returning the latest saved TCPDF object with startTransaction().</span>
<a name="l26016"></a>26016 <span class="comment">     * @param $self (boolean) if true restores current class object to previous state without the need of reassignment via the returned value.</span>
<a name="l26017"></a>26017 <span class="comment">     * @return TCPDF object.</span>
<a name="l26018"></a>26018 <span class="comment">     * @public</span>
<a name="l26019"></a>26019 <span class="comment">     * @since 4.5.029 (2009-03-19)</span>
<a name="l26020"></a>26020 <span class="comment">     */</span>
<a name="l26021"></a><a class="code" href="classTCPDF.html#a338034ba746f7c607473207b9caa4e1f">26021</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a338034ba746f7c607473207b9caa4e1f" title="This method allows to undo the latest transaction by returning the latest saved TCPDF object with sta...">rollbackTransaction</a>($self=<span class="keyword">false</span>) {
<a name="l26022"></a>26022         <span class="keywordflow">if</span> (isset($this-&gt;objcopy)) {
<a name="l26023"></a>26023             <span class="keywordflow">if</span> (isset($this-&gt;objcopy-&gt;diskcache) AND $this-&gt;objcopy-&gt;diskcache) {
<a name="l26024"></a>26024                 <span class="comment">// truncate files to previous values</span>
<a name="l26025"></a>26025                 <span class="keywordflow">foreach</span> ($this-&gt;objcopy-&gt;cache_file_length as <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> =&gt; $length) {
<a name="l26026"></a>26026                     <a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a> = substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, 1);
<a name="l26027"></a>26027                     $handle = fopen(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <span class="stringliteral">&#39;r+&#39;</span>);
<a name="l26028"></a>26028                     ftruncate($handle, $length);
<a name="l26029"></a>26029                 }
<a name="l26030"></a>26030             }
<a name="l26031"></a>26031             $this-&gt;_destroy(<span class="keyword">true</span>, <span class="keyword">true</span>);
<a name="l26032"></a>26032             <span class="keywordflow">if</span> ($self) {
<a name="l26033"></a>26033                 $objvars = get_object_vars($this-&gt;objcopy);
<a name="l26034"></a>26034                 <span class="keywordflow">foreach</span> ($objvars as $key =&gt; $value) {
<a name="l26035"></a>26035                     $this-&gt;$key = $value;
<a name="l26036"></a>26036                 }
<a name="l26037"></a>26037             }
<a name="l26038"></a>26038             <span class="keywordflow">return</span> $this-&gt;objcopy;
<a name="l26039"></a>26039         }
<a name="l26040"></a>26040         <span class="keywordflow">return</span> $this;
<a name="l26041"></a>26041     }
<a name="l26042"></a>26042 <span class="comment"></span>
<a name="l26043"></a>26043 <span class="comment">    /**</span>
<a name="l26044"></a>26044 <span class="comment">     * Creates a copy of a class object</span>
<a name="l26045"></a>26045 <span class="comment">     * @param $object (object) class object to be cloned</span>
<a name="l26046"></a>26046 <span class="comment">     * @return cloned object</span>
<a name="l26047"></a>26047 <span class="comment">     * @public</span>
<a name="l26048"></a>26048 <span class="comment">     * @since 4.5.029 (2009-03-19)</span>
<a name="l26049"></a>26049 <span class="comment">     */</span>
<a name="l26050"></a><a class="code" href="classTCPDF.html#a921075b51cce85187bbb8e576b35eadd">26050</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a921075b51cce85187bbb8e576b35eadd" title="Creates a copy of a class object.">objclone</a>($object) {
<a name="l26051"></a>26051         <span class="keywordflow">return</span> @clone($object);
<a name="l26052"></a>26052     }
<a name="l26053"></a>26053 <span class="comment"></span>
<a name="l26054"></a>26054 <span class="comment">    /**</span>
<a name="l26055"></a>26055 <span class="comment">     * Determine whether a string is empty.</span>
<a name="l26056"></a>26056 <span class="comment">     * @param $str (string) string to be checked</span>
<a name="l26057"></a>26057 <span class="comment">     * @return boolean true if string is empty</span>
<a name="l26058"></a>26058 <span class="comment">     * @public</span>
<a name="l26059"></a>26059 <span class="comment">     * @since 4.5.044 (2009-04-16)</span>
<a name="l26060"></a>26060 <span class="comment">     */</span>
<a name="l26061"></a><a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2">26061</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a681e9cc13fa324d8e538a5873f3990c2" title="Determine whether a string is empty.">empty_string</a>($str) {
<a name="l26062"></a>26062         <span class="keywordflow">return</span> (is_null($str) OR (is_string($str) AND (strlen($str) == 0)));
<a name="l26063"></a>26063     }
<a name="l26064"></a>26064 <span class="comment"></span>
<a name="l26065"></a>26065 <span class="comment">    /**</span>
<a name="l26066"></a>26066 <span class="comment">     * Find position of last occurrence of a substring in a string</span>
<a name="l26067"></a>26067 <span class="comment">     * @param $haystack (string) The string to search in.</span>
<a name="l26068"></a>26068 <span class="comment">     * @param $needle (string) substring to search.</span>
<a name="l26069"></a>26069 <span class="comment">     * @param $offset (int) May be specified to begin searching an arbitrary number of characters into the string.</span>
<a name="l26070"></a>26070 <span class="comment">     * @return Returns the position where the needle exists. Returns FALSE if the needle was not found.</span>
<a name="l26071"></a>26071 <span class="comment">     * @public</span>
<a name="l26072"></a>26072 <span class="comment">     * @since 4.8.038 (2010-03-13)</span>
<a name="l26073"></a>26073 <span class="comment">     */</span>
<a name="l26074"></a><a class="code" href="classTCPDF.html#afa852889f7eef78f8843d9aa279fed1d">26074</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#afa852889f7eef78f8843d9aa279fed1d" title="Find position of last occurrence of a substring in a string.">revstrpos</a>($haystack, $needle, <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = 0) {
<a name="l26075"></a>26075         $length = strlen($haystack);
<a name="l26076"></a>26076         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> &gt; 0)?($length - <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>):abs(<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l26077"></a>26077         <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = strpos(strrev($haystack), strrev($needle), <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>);
<a name="l26078"></a>26078         <span class="keywordflow">return</span> (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> === <span class="keyword">false</span>)?<span class="keyword">false</span>:($length - <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> - strlen($needle));
<a name="l26079"></a>26079     }
<a name="l26080"></a>26080 
<a name="l26081"></a>26081     <span class="comment">// --- MULTI COLUMNS METHODS -----------------------</span>
<a name="l26082"></a>26082 <span class="comment"></span>
<a name="l26083"></a>26083 <span class="comment">    /**</span>
<a name="l26084"></a>26084 <span class="comment">     * Set multiple columns of the same size</span>
<a name="l26085"></a>26085 <span class="comment">     * @param $numcols (int) number of columns (set to zero to disable columns mode)</span>
<a name="l26086"></a>26086 <span class="comment">     * @param $width (int) column width</span>
<a name="l26087"></a>26087 <span class="comment">     * @param $y (int) column starting Y position (leave empty for current Y position)</span>
<a name="l26088"></a>26088 <span class="comment">     * @public</span>
<a name="l26089"></a>26089 <span class="comment">     * @since 4.9.001 (2010-03-28)</span>
<a name="l26090"></a>26090 <span class="comment">     */</span>
<a name="l26091"></a><a class="code" href="classTCPDF.html#aeb84582f37f9d68c1a9f5723849d0009">26091</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aeb84582f37f9d68c1a9f5723849d0009" title="Set multiple columns of the same size.">setEqualColumns</a>(<a class="code" href="videos_8php.html#a0f8f5c33c1b3925c87d14e45b4774983">$numcols</a>=0, $width=0, $y=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l26092"></a>26092         $this-&gt;columns = array();
<a name="l26093"></a>26093         <span class="keywordflow">if</span> (<a class="code" href="videos_8php.html#a0f8f5c33c1b3925c87d14e45b4774983">$numcols</a> &lt; 2) {
<a name="l26094"></a>26094             <a class="code" href="videos_8php.html#a0f8f5c33c1b3925c87d14e45b4774983">$numcols</a> = 0;
<a name="l26095"></a>26095             $this-&gt;columns = array();
<a name="l26096"></a>26096         } <span class="keywordflow">else</span> {
<a name="l26097"></a>26097             <span class="comment">// maximum column width</span>
<a name="l26098"></a>26098             $maxwidth = ($this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin) / <a class="code" href="videos_8php.html#a0f8f5c33c1b3925c87d14e45b4774983">$numcols</a>;
<a name="l26099"></a>26099             <span class="keywordflow">if</span> (($width == 0) OR ($width &gt; $maxwidth)) {
<a name="l26100"></a>26100                 $width = $maxwidth;
<a name="l26101"></a>26101             }
<a name="l26102"></a>26102             <span class="keywordflow">if</span> ($this-&gt;empty_string($y)) {
<a name="l26103"></a>26103                 $y = $this-&gt;y;
<a name="l26104"></a>26104             }
<a name="l26105"></a>26105             <span class="comment">// space between columns</span>
<a name="l26106"></a>26106             $space = (($this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin - (<a class="code" href="videos_8php.html#a0f8f5c33c1b3925c87d14e45b4774983">$numcols</a> * $width)) / (<a class="code" href="videos_8php.html#a0f8f5c33c1b3925c87d14e45b4774983">$numcols</a> - 1));
<a name="l26107"></a>26107             <span class="comment">// fill the columns array (with, space, starting Y position)</span>
<a name="l26108"></a>26108             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; <a class="code" href="videos_8php.html#a0f8f5c33c1b3925c87d14e45b4774983">$numcols</a>; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l26109"></a>26109                 $this-&gt;columns[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>] = array(<span class="charliteral">&#39;w&#39;</span> =&gt; $width, <span class="charliteral">&#39;s&#39;</span> =&gt; $space, <span class="charliteral">&#39;y&#39;</span> =&gt; $y);
<a name="l26110"></a>26110             }
<a name="l26111"></a>26111         }
<a name="l26112"></a>26112         $this-&gt;num_columns = <a class="code" href="videos_8php.html#a0f8f5c33c1b3925c87d14e45b4774983">$numcols</a>;
<a name="l26113"></a>26113         $this-&gt;current_column = 0;
<a name="l26114"></a>26114         $this-&gt;column_start_page = $this-&gt;page;
<a name="l26115"></a>26115         $this-&gt;selectColumn(0);
<a name="l26116"></a>26116     }
<a name="l26117"></a>26117 <span class="comment"></span>
<a name="l26118"></a>26118 <span class="comment">    /**</span>
<a name="l26119"></a>26119 <span class="comment">     * Remove columns and reset page margins.</span>
<a name="l26120"></a>26120 <span class="comment">     * @public</span>
<a name="l26121"></a>26121 <span class="comment">     * @since 5.9.072 (2011-04-26)</span>
<a name="l26122"></a>26122 <span class="comment">     */</span>
<a name="l26123"></a><a class="code" href="classTCPDF.html#ae0f4faf05227d82fa7ed924ba9044da7">26123</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ae0f4faf05227d82fa7ed924ba9044da7" title="Remove columns and reset page margins.">resetColumns</a>() {
<a name="l26124"></a>26124         $this-&gt;lMargin = $this-&gt;original_lMargin;
<a name="l26125"></a>26125         $this-&gt;rMargin = $this-&gt;original_rMargin;
<a name="l26126"></a>26126         $this-&gt;setEqualColumns();
<a name="l26127"></a>26127     }
<a name="l26128"></a>26128 <span class="comment"></span>
<a name="l26129"></a>26129 <span class="comment">    /**</span>
<a name="l26130"></a>26130 <span class="comment">     * Set columns array.</span>
<a name="l26131"></a>26131 <span class="comment">     * Each column is represented by an array of arrays with the following keys: (w = width, s = space between columns, y = column top position).</span>
<a name="l26132"></a>26132 <span class="comment">     * @param $columns (array)</span>
<a name="l26133"></a>26133 <span class="comment">     * @public</span>
<a name="l26134"></a>26134 <span class="comment">     * @since 4.9.001 (2010-03-28)</span>
<a name="l26135"></a>26135 <span class="comment">     */</span>
<a name="l26136"></a><a class="code" href="classTCPDF.html#a475b483b9b8f649582c3237af5fb03d4">26136</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a475b483b9b8f649582c3237af5fb03d4" title="Set columns array.">setColumnsArray</a>(<a class="code" href="tbl__operations_8php.html#a19d2a3d21fe02053311fde465e6ae2e9" title="Get columns names.">$columns</a>) {
<a name="l26137"></a>26137         $this-&gt;columns = <a class="code" href="tbl__operations_8php.html#a19d2a3d21fe02053311fde465e6ae2e9" title="Get columns names.">$columns</a>;
<a name="l26138"></a>26138         $this-&gt;num_columns = count(<a class="code" href="tbl__operations_8php.html#a19d2a3d21fe02053311fde465e6ae2e9" title="Get columns names.">$columns</a>);
<a name="l26139"></a>26139         $this-&gt;current_column = 0;
<a name="l26140"></a>26140         $this-&gt;column_start_page = $this-&gt;page;
<a name="l26141"></a>26141         $this-&gt;selectColumn(0);
<a name="l26142"></a>26142     }
<a name="l26143"></a>26143 <span class="comment"></span>
<a name="l26144"></a>26144 <span class="comment">    /**</span>
<a name="l26145"></a>26145 <span class="comment">     * Set position at a given column</span>
<a name="l26146"></a>26146 <span class="comment">     * @param $col (int) column number (from 0 to getNumberOfColumns()-1); empty string = current column.</span>
<a name="l26147"></a>26147 <span class="comment">     * @public</span>
<a name="l26148"></a>26148 <span class="comment">     * @since 4.9.001 (2010-03-28)</span>
<a name="l26149"></a>26149 <span class="comment">     */</span>
<a name="l26150"></a><a class="code" href="classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">26150</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4f11d769024fd07e1f663efd02d10517" title="Set position at a given column.">selectColumn</a>(<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l26151"></a>26151         <span class="keywordflow">if</span> (is_string(<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>)) {
<a name="l26152"></a>26152             <a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a> = $this-&gt;current_column;
<a name="l26153"></a>26153         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a> &gt;= $this-&gt;num_columns) {
<a name="l26154"></a>26154             <a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a> = 0;
<a name="l26155"></a>26155         }
<a name="l26156"></a>26156         $xshift = array(<span class="charliteral">&#39;x&#39;</span> =&gt; 0, <span class="charliteral">&#39;s&#39;</span> =&gt; array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0), <span class="charliteral">&#39;p&#39;</span> =&gt; array(<span class="charliteral">&#39;L&#39;</span> =&gt; 0, <span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0));
<a name="l26157"></a>26157         $enable_thead = <span class="keyword">false</span>;
<a name="l26158"></a>26158         <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {
<a name="l26159"></a>26159             <span class="keywordflow">if</span> (<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a> != $this-&gt;current_column) {
<a name="l26160"></a>26160                 <span class="comment">// move Y pointer at the top of the column</span>
<a name="l26161"></a>26161                 <span class="keywordflow">if</span> ($this-&gt;column_start_page == $this-&gt;page) {
<a name="l26162"></a>26162                     $this-&gt;y = $this-&gt;columns[<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>][<span class="charliteral">&#39;y&#39;</span>];
<a name="l26163"></a>26163                 } <span class="keywordflow">else</span> {
<a name="l26164"></a>26164                     $this-&gt;y = $this-&gt;tMargin;
<a name="l26165"></a>26165                 }
<a name="l26166"></a>26166                 <span class="comment">// Avoid to write table headers more than once</span>
<a name="l26167"></a>26167                 <span class="keywordflow">if</span> (($this-&gt;page &gt; $this-&gt;maxselcol[<span class="stringliteral">&#39;page&#39;</span>]) OR (($this-&gt;page == $this-&gt;maxselcol[<span class="stringliteral">&#39;page&#39;</span>]) AND (<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a> &gt; $this-&gt;maxselcol[<span class="stringliteral">&#39;column&#39;</span>]))) {
<a name="l26168"></a>26168                     $enable_thead = <span class="keyword">true</span>;
<a name="l26169"></a>26169                     $this-&gt;maxselcol[<span class="stringliteral">&#39;page&#39;</span>] = $this-&gt;page;
<a name="l26170"></a>26170                     $this-&gt;maxselcol[<span class="stringliteral">&#39;column&#39;</span>] = <a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>;
<a name="l26171"></a>26171                 }
<a name="l26172"></a>26172             }
<a name="l26173"></a>26173             $xshift = $this-&gt;colxshift;
<a name="l26174"></a>26174             <span class="comment">// set X position of the current column by case</span>
<a name="l26175"></a>26175             $listindent = ($this-&gt;listindentlevel * $this-&gt;listindent);
<a name="l26176"></a>26176             <span class="comment">// calculate column X position</span>
<a name="l26177"></a>26177             $colpos = 0;
<a name="l26178"></a>26178             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = 0; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt; <a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l26179"></a>26179                 $colpos += ($this-&gt;columns[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="charliteral">&#39;w&#39;</span>] + $this-&gt;columns[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>][<span class="charliteral">&#39;s&#39;</span>]);
<a name="l26180"></a>26180             }
<a name="l26181"></a>26181             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l26182"></a>26182                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;w - $this-&gt;original_rMargin - $colpos;
<a name="l26183"></a>26183                 $this-&gt;rMargin = ($this-&gt;w - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + $listindent);
<a name="l26184"></a>26184                 $this-&gt;lMargin = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - $this-&gt;columns[<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>][<span class="charliteral">&#39;w&#39;</span>]);
<a name="l26185"></a>26185                 $this-&gt;x = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - $listindent;
<a name="l26186"></a>26186             } <span class="keywordflow">else</span> {
<a name="l26187"></a>26187                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;original_lMargin + $colpos;
<a name="l26188"></a>26188                 $this-&gt;lMargin = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + $listindent);
<a name="l26189"></a>26189                 $this-&gt;rMargin = ($this-&gt;w - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - $this-&gt;columns[<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>][<span class="charliteral">&#39;w&#39;</span>]);
<a name="l26190"></a>26190                 $this-&gt;x = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + $listindent;
<a name="l26191"></a>26191             }
<a name="l26192"></a>26192             $this-&gt;columns[<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>][<span class="charliteral">&#39;x&#39;</span>] = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l26193"></a>26193         }
<a name="l26194"></a>26194         $this-&gt;current_column = <a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>;
<a name="l26195"></a>26195         <span class="comment">// fix for HTML mode</span>
<a name="l26196"></a>26196         $this-&gt;newline = <span class="keyword">true</span>;
<a name="l26197"></a>26197         <span class="comment">// print HTML table header (if any)</span>
<a name="l26198"></a>26198         <span class="keywordflow">if</span> ((!$this-&gt;empty_string($this-&gt;thead)) AND (!$this-&gt;inthead)) {
<a name="l26199"></a>26199             <span class="keywordflow">if</span> ($enable_thead) {
<a name="l26200"></a>26200                 <span class="comment">// print table header</span>
<a name="l26201"></a>26201                 $this-&gt;writeHTML($this-&gt;thead, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);
<a name="l26202"></a>26202                 $this-&gt;y += $xshift[<span class="charliteral">&#39;s&#39;</span>][<span class="charliteral">&#39;V&#39;</span>];
<a name="l26203"></a>26203                 <span class="comment">// store end of header position</span>
<a name="l26204"></a>26204                 <span class="keywordflow">if</span> (!isset($this-&gt;columns[<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>][<span class="stringliteral">&#39;th&#39;</span>])) {
<a name="l26205"></a>26205                     $this-&gt;columns[<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>][<span class="stringliteral">&#39;th&#39;</span>] = array();
<a name="l26206"></a>26206                 }
<a name="l26207"></a>26207                 $this-&gt;columns[<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$this-&gt;page.<span class="charliteral">&#39;\&#39;&#39;</span>] = $this-&gt;y;
<a name="l26208"></a>26208                 $this-&gt;lasth = 0;
<a name="l26209"></a>26209             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($this-&gt;columns[<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$this-&gt;page.<span class="charliteral">&#39;\&#39;&#39;</span>])) {
<a name="l26210"></a>26210                 $this-&gt;y = $this-&gt;columns[<a class="code" href="db__qbe_8php.html#afca5b7d4c9144178253e99d0ada7d519">$col</a>][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$this-&gt;page.<span class="charliteral">&#39;\&#39;&#39;</span>];
<a name="l26211"></a>26211             }
<a name="l26212"></a>26212         }
<a name="l26213"></a>26213         <span class="comment">// account for an html table cell over multiple columns</span>
<a name="l26214"></a>26214         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l26215"></a>26215             $this-&gt;rMargin += $xshift[<span class="charliteral">&#39;x&#39;</span>];
<a name="l26216"></a>26216             $this-&gt;x -= ($xshift[<span class="charliteral">&#39;x&#39;</span>] + $xshift[<span class="charliteral">&#39;p&#39;</span>][<span class="charliteral">&#39;R&#39;</span>]);
<a name="l26217"></a>26217         } <span class="keywordflow">else</span> {
<a name="l26218"></a>26218             $this-&gt;lMargin += $xshift[<span class="charliteral">&#39;x&#39;</span>];
<a name="l26219"></a>26219             $this-&gt;x += $xshift[<span class="charliteral">&#39;x&#39;</span>] + $xshift[<span class="charliteral">&#39;p&#39;</span>][<span class="charliteral">&#39;L&#39;</span>];
<a name="l26220"></a>26220         }
<a name="l26221"></a>26221     }
<a name="l26222"></a>26222 <span class="comment"></span>
<a name="l26223"></a>26223 <span class="comment">    /**</span>
<a name="l26224"></a>26224 <span class="comment">     * Return the current column number</span>
<a name="l26225"></a>26225 <span class="comment">     * @return int current column number</span>
<a name="l26226"></a>26226 <span class="comment">     * @public</span>
<a name="l26227"></a>26227 <span class="comment">     * @since 5.5.011 (2010-07-08)</span>
<a name="l26228"></a>26228 <span class="comment">     */</span>
<a name="l26229"></a><a class="code" href="classTCPDF.html#a7db0d9878a041a04273e251228540b56">26229</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7db0d9878a041a04273e251228540b56" title="Return the current column number.">getColumn</a>() {
<a name="l26230"></a>26230         <span class="keywordflow">return</span> $this-&gt;current_column;
<a name="l26231"></a>26231     }
<a name="l26232"></a>26232 <span class="comment"></span>
<a name="l26233"></a>26233 <span class="comment">    /**</span>
<a name="l26234"></a>26234 <span class="comment">     * Return the current number of columns.</span>
<a name="l26235"></a>26235 <span class="comment">     * @return int number of columns</span>
<a name="l26236"></a>26236 <span class="comment">     * @public</span>
<a name="l26237"></a>26237 <span class="comment">     * @since 5.8.018 (2010-08-25)</span>
<a name="l26238"></a>26238 <span class="comment">     */</span>
<a name="l26239"></a><a class="code" href="classTCPDF.html#a32dee1790e5a2b68404a76c117872b57">26239</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a32dee1790e5a2b68404a76c117872b57" title="Return the current number of columns.">getNumberOfColumns</a>() {
<a name="l26240"></a>26240         <span class="keywordflow">return</span> $this-&gt;num_columns;
<a name="l26241"></a>26241     }
<a name="l26242"></a>26242 <span class="comment"></span>
<a name="l26243"></a>26243 <span class="comment">    /**</span>
<a name="l26244"></a>26244 <span class="comment">     * Serialize an array of parameters to be used with TCPDF tag in HTML code.</span>
<a name="l26245"></a>26245 <span class="comment">     * @param $pararray (array) parameters array</span>
<a name="l26246"></a>26246 <span class="comment">     * @return sting containing serialized data</span>
<a name="l26247"></a>26247 <span class="comment">     * @public</span>
<a name="l26248"></a>26248 <span class="comment">     * @since 4.9.006 (2010-04-02)</span>
<a name="l26249"></a>26249 <span class="comment">     */</span>
<a name="l26250"></a><a class="code" href="classTCPDF.html#a9928801520cbb84e9f88c02bfd957b73">26250</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a9928801520cbb84e9f88c02bfd957b73" title="Serialize an array of parameters to be used with TCPDF tag in HTML code.">serializeTCPDFtagParameters</a>($pararray) {
<a name="l26251"></a>26251         <span class="keywordflow">return</span> urlencode(serialize($pararray));
<a name="l26252"></a>26252     }
<a name="l26253"></a>26253 <span class="comment"></span>
<a name="l26254"></a>26254 <span class="comment">    /**</span>
<a name="l26255"></a>26255 <span class="comment">     * Set Text rendering mode.</span>
<a name="l26256"></a>26256 <span class="comment">     * @param $stroke (int) outline size in user units (0 = disable).</span>
<a name="l26257"></a>26257 <span class="comment">     * @param $fill (boolean) if true fills the text (default).</span>
<a name="l26258"></a>26258 <span class="comment">     * @param $clip (boolean) if true activate clipping mode</span>
<a name="l26259"></a>26259 <span class="comment">     * @public</span>
<a name="l26260"></a>26260 <span class="comment">     * @since 4.9.008 (2009-04-02)</span>
<a name="l26261"></a>26261 <span class="comment">     */</span>
<a name="l26262"></a><a class="code" href="classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107">26262</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107" title="Set Text rendering mode.">setTextRenderingMode</a>($stroke=0, $fill=<span class="keyword">true</span>, $clip=<span class="keyword">false</span>) {
<a name="l26263"></a>26263         <span class="comment">// Ref.: PDF 32000-1:2008 - 9.3.6 Text Rendering Mode</span>
<a name="l26264"></a>26264         <span class="comment">// convert text rendering parameters</span>
<a name="l26265"></a>26265         <span class="keywordflow">if</span> ($stroke &lt; 0) {
<a name="l26266"></a>26266             $stroke = 0;
<a name="l26267"></a>26267         }
<a name="l26268"></a>26268         <span class="keywordflow">if</span> ($fill === <span class="keyword">true</span>) {
<a name="l26269"></a>26269             <span class="keywordflow">if</span> ($stroke &gt; 0) {
<a name="l26270"></a>26270                 <span class="keywordflow">if</span> ($clip === <span class="keyword">true</span>) {
<a name="l26271"></a>26271                     <span class="comment">// Fill, then stroke text and add to path for clipping</span>
<a name="l26272"></a>26272                     $textrendermode = 6;
<a name="l26273"></a>26273                 } <span class="keywordflow">else</span> {
<a name="l26274"></a>26274                     <span class="comment">// Fill, then stroke text</span>
<a name="l26275"></a>26275                     $textrendermode = 2;
<a name="l26276"></a>26276                 }
<a name="l26277"></a>26277                 $textstrokewidth = $stroke;
<a name="l26278"></a>26278             } <span class="keywordflow">else</span> {
<a name="l26279"></a>26279                 <span class="keywordflow">if</span> ($clip === <span class="keyword">true</span>) {
<a name="l26280"></a>26280                     <span class="comment">// Fill text and add to path for clipping</span>
<a name="l26281"></a>26281                     $textrendermode = 4;
<a name="l26282"></a>26282                 } <span class="keywordflow">else</span> {
<a name="l26283"></a>26283                     <span class="comment">// Fill text</span>
<a name="l26284"></a>26284                     $textrendermode = 0;
<a name="l26285"></a>26285                 }
<a name="l26286"></a>26286             }
<a name="l26287"></a>26287         } <span class="keywordflow">else</span> {
<a name="l26288"></a>26288             <span class="keywordflow">if</span> ($stroke &gt; 0) {
<a name="l26289"></a>26289                 <span class="keywordflow">if</span> ($clip === <span class="keyword">true</span>) {
<a name="l26290"></a>26290                     <span class="comment">// Stroke text and add to path for clipping</span>
<a name="l26291"></a>26291                     $textrendermode = 5;
<a name="l26292"></a>26292                 } <span class="keywordflow">else</span> {
<a name="l26293"></a>26293                     <span class="comment">// Stroke text</span>
<a name="l26294"></a>26294                     $textrendermode = 1;
<a name="l26295"></a>26295                 }
<a name="l26296"></a>26296                 $textstrokewidth = $stroke;
<a name="l26297"></a>26297             } <span class="keywordflow">else</span> {
<a name="l26298"></a>26298                 <span class="keywordflow">if</span> ($clip === <span class="keyword">true</span>) {
<a name="l26299"></a>26299                     <span class="comment">// Add text to path for clipping</span>
<a name="l26300"></a>26300                     $textrendermode = 7;
<a name="l26301"></a>26301                 } <span class="keywordflow">else</span> {
<a name="l26302"></a>26302                     <span class="comment">// Neither fill nor stroke text (invisible)</span>
<a name="l26303"></a>26303                     $textrendermode = 3;
<a name="l26304"></a>26304                 }
<a name="l26305"></a>26305             }
<a name="l26306"></a>26306         }
<a name="l26307"></a>26307         $this-&gt;textrendermode = $textrendermode;
<a name="l26308"></a>26308         $this-&gt;textstrokewidth = $stroke * $this-&gt;k;
<a name="l26309"></a>26309     }
<a name="l26310"></a>26310 <span class="comment"></span>
<a name="l26311"></a>26311 <span class="comment">    /**</span>
<a name="l26312"></a>26312 <span class="comment">     * Returns an array of chars containing soft hyphens.</span>
<a name="l26313"></a>26313 <span class="comment">     * @param $word (array) array of chars</span>
<a name="l26314"></a>26314 <span class="comment">     * @param $patterns (array) Array of hypenation patterns.</span>
<a name="l26315"></a>26315 <span class="comment">     * @param $dictionary (array) Array of words to be returned without applying the hyphenation algoritm.</span>
<a name="l26316"></a>26316 <span class="comment">     * @param $leftmin (int) Minimum number of character to leave on the left of the word without applying the hyphens.</span>
<a name="l26317"></a>26317 <span class="comment">     * @param $rightmin (int) Minimum number of character to leave on the right of the word without applying the hyphens.</span>
<a name="l26318"></a>26318 <span class="comment">     * @param $charmin (int) Minimum word length to apply the hyphenation algoritm.</span>
<a name="l26319"></a>26319 <span class="comment">     * @param $charmax (int) Maximum length of broken piece of word.</span>
<a name="l26320"></a>26320 <span class="comment">     * @return array text with soft hyphens</span>
<a name="l26321"></a>26321 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26322"></a>26322 <span class="comment">     * @since 4.9.012 (2010-04-12)</span>
<a name="l26323"></a>26323 <span class="comment">     * @protected</span>
<a name="l26324"></a>26324 <span class="comment">     */</span>
<a name="l26325"></a><a class="code" href="classTCPDF.html#a39aa922f08cdbb517438aaaef43e9cb5">26325</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a39aa922f08cdbb517438aaaef43e9cb5" title="Returns an array of chars containing soft hyphens.">hyphenateWord</a>($word, $patterns, $dictionary=array(), $leftmin=1, $rightmin=2, $charmin=1, $charmax=8) {
<a name="l26326"></a>26326         $hyphenword = array(); <span class="comment">// hyphens positions</span>
<a name="l26327"></a>26327         $numchars = count($word);
<a name="l26328"></a>26328         <span class="keywordflow">if</span> ($numchars &lt;= $charmin) {
<a name="l26329"></a>26329             <span class="keywordflow">return</span> $word;
<a name="l26330"></a>26330         }
<a name="l26331"></a>26331         $word_string = $this-&gt;UTF8ArrSubString($word);
<a name="l26332"></a>26332         <span class="comment">// some words will be returned as-is</span>
<a name="l26333"></a>26333         $pattern = <span class="stringliteral">&#39;/^([a-zA-Z0-9_\.\-]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/&#39;</span>;
<a name="l26334"></a>26334         <span class="keywordflow">if</span> (preg_match($pattern, $word_string) &gt; 0) {
<a name="l26335"></a>26335             <span class="comment">// email</span>
<a name="l26336"></a>26336             <span class="keywordflow">return</span> $word;
<a name="l26337"></a>26337         }
<a name="l26338"></a>26338         $pattern = <span class="stringliteral">&#39;/(([a-zA-Z0-9\-]+\.)?)((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/&#39;</span>;
<a name="l26339"></a>26339         <span class="keywordflow">if</span> (preg_match($pattern, $word_string) &gt; 0) {
<a name="l26340"></a>26340             <span class="comment">// URL</span>
<a name="l26341"></a>26341             <span class="keywordflow">return</span> $word;
<a name="l26342"></a>26342         }
<a name="l26343"></a>26343         <span class="keywordflow">if</span> (isset($dictionary[$word_string])) {
<a name="l26344"></a>26344             <span class="keywordflow">return</span> $this-&gt;UTF8StringToArray($dictionary[$word_string]);
<a name="l26345"></a>26345         }
<a name="l26346"></a>26346         <span class="comment">// suround word with &#39;_&#39; characters</span>
<a name="l26347"></a>26347         $tmpword = array_merge(array(95), $word, array(95));
<a name="l26348"></a>26348         $tmpnumchars = $numchars + 2;
<a name="l26349"></a>26349         $maxpos = $tmpnumchars - $charmin;
<a name="l26350"></a>26350         <span class="keywordflow">for</span> (<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> = 0; <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> &lt; $maxpos; ++<a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>) {
<a name="l26351"></a>26351             $imax = min(($tmpnumchars - <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>), $charmax);
<a name="l26352"></a>26352             <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = $charmin; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;= $imax; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l26353"></a>26353                 $subword = strtolower($this-&gt;UTF8ArrSubString($tmpword, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a>, <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>));
<a name="l26354"></a>26354                 <span class="keywordflow">if</span> (isset($patterns[$subword])) {
<a name="l26355"></a>26355                     $pattern = $this-&gt;UTF8StringToArray($patterns[$subword]);
<a name="l26356"></a>26356                     $pattern_length = count($pattern);
<a name="l26357"></a>26357                     $digits = 1;
<a name="l26358"></a>26358                     <span class="keywordflow">for</span> ($j = 0; $j &lt; $pattern_length; ++$j) {
<a name="l26359"></a>26359                         <span class="comment">// check if $pattern[$j] is a number</span>
<a name="l26360"></a>26360                         <span class="keywordflow">if</span> (($pattern[$j] &gt;= 48) AND ($pattern[$j] &lt;= 57)) {
<a name="l26361"></a>26361                             <span class="keywordflow">if</span> ($j == 0) {
<a name="l26362"></a>26362                                 $zero = <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> - 1;
<a name="l26363"></a>26363                             } <span class="keywordflow">else</span> {
<a name="l26364"></a>26364                                 $zero = <a class="code" href="bs__disp__as__mime__type_8php.html#a5de51f0c80b3bb3b39a57b23f6b9ea9f">$pos</a> + $j - $digits;
<a name="l26365"></a>26365                             }
<a name="l26366"></a>26366                             <span class="keywordflow">if</span> (!isset($hyphenword[$zero]) OR ($hyphenword[$zero] != $pattern[$j])) {
<a name="l26367"></a>26367                                 $hyphenword[$zero] = $this-&gt;unichr($pattern[$j]);
<a name="l26368"></a>26368                             }
<a name="l26369"></a>26369                             ++$digits;
<a name="l26370"></a>26370                         }
<a name="l26371"></a>26371                     }
<a name="l26372"></a>26372                 }
<a name="l26373"></a>26373             }
<a name="l26374"></a>26374         }
<a name="l26375"></a>26375         $inserted = 0;
<a name="l26376"></a>26376         $maxpos = $numchars - $rightmin;
<a name="l26377"></a>26377         <span class="keywordflow">for</span> (<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> = $leftmin; <a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a> &lt;= $maxpos; ++<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>) {
<a name="l26378"></a>26378             <span class="keywordflow">if</span> (isset($hyphenword[<a class="code" href="OSS__paging_8php.html#ab37d39c0f2691e721bfb51525837549f">$i</a>]) AND (($hyphenword[$i] % 2) != 0)) {
<a name="l26379"></a>26379                 <span class="comment">// 173 = soft hyphen character</span>
<a name="l26380"></a>26380                 array_splice($word, $i + $inserted, 0, 173);
<a name="l26381"></a>26381                 ++$inserted;
<a name="l26382"></a>26382             }
<a name="l26383"></a>26383         }
<a name="l26384"></a>26384         <span class="keywordflow">return</span> $word;
<a name="l26385"></a>26385     }
<a name="l26386"></a>26386 <span class="comment"></span>
<a name="l26387"></a>26387 <span class="comment">    /**</span>
<a name="l26388"></a>26388 <span class="comment">     * Returns an array of hyphenation patterns.</span>
<a name="l26389"></a>26389 <span class="comment">     * @param $file (string) TEX file containing hypenation patterns. TEX pattrns can be downloaded from http://www.ctan.org/tex-archive/language/hyph-utf8/tex/generic/hyph-utf8/patterns/</span>
<a name="l26390"></a>26390 <span class="comment">     * @return array of hyphenation patterns</span>
<a name="l26391"></a>26391 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26392"></a>26392 <span class="comment">     * @since 4.9.012 (2010-04-12)</span>
<a name="l26393"></a>26393 <span class="comment">     * @public</span>
<a name="l26394"></a>26394 <span class="comment">     */</span>
<a name="l26395"></a><a class="code" href="classTCPDF.html#a1ef69903806468b0cc76b4f6c3f83e75">26395</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1ef69903806468b0cc76b4f6c3f83e75" title="Returns an array of hyphenation patterns.">getHyphenPatternsFromTEX</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>) {
<a name="l26396"></a>26396         <span class="comment">// TEX patterns are available at:</span>
<a name="l26397"></a>26397         <span class="comment">// http://www.ctan.org/tex-archive/language/hyph-utf8/tex/generic/hyph-utf8/patterns/</span>
<a name="l26398"></a>26398         <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = file_get_contents(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l26399"></a>26399         $patterns = array();
<a name="l26400"></a>26400         <span class="comment">// remove comments</span>
<a name="l26401"></a>26401         <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = preg_replace(<span class="stringliteral">&#39;/\%[^\n]*/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l26402"></a>26402         <span class="comment">// extract the patterns part</span>
<a name="l26403"></a>26403         preg_match(<span class="stringliteral">&#39;/\\\\patterns\{([^\}]*)\}/i&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>, $matches);
<a name="l26404"></a>26404         <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a> = trim(substr($matches[0], 10, -1));
<a name="l26405"></a>26405         <span class="comment">// extract each pattern</span>
<a name="l26406"></a>26406         $patterns_array = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>);
<a name="l26407"></a>26407         <span class="comment">// create new language array of patterns</span>
<a name="l26408"></a>26408         $patterns = array();
<a name="l26409"></a>26409         <span class="keywordflow">foreach</span>($patterns_array as $val) {
<a name="l26410"></a>26410             <span class="keywordflow">if</span> (!$this-&gt;empty_string($val)) {
<a name="l26411"></a>26411                 $val = trim($val);
<a name="l26412"></a>26412                 $val = str_replace(<span class="charliteral">&#39;\&#39;&#39;</span>, <span class="stringliteral">&#39;\\\&#39;&#39;</span>, $val);
<a name="l26413"></a>26413                 $key = preg_replace(<span class="stringliteral">&#39;/[0-9]+/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $val);
<a name="l26414"></a>26414                 $patterns[$key] = $val;
<a name="l26415"></a>26415             }
<a name="l26416"></a>26416         }
<a name="l26417"></a>26417         <span class="keywordflow">return</span> $patterns;
<a name="l26418"></a>26418     }
<a name="l26419"></a>26419 <span class="comment"></span>
<a name="l26420"></a>26420 <span class="comment">    /**</span>
<a name="l26421"></a>26421 <span class="comment">     * Returns text with soft hyphens.</span>
<a name="l26422"></a>26422 <span class="comment">     * @param $text (string) text to process</span>
<a name="l26423"></a>26423 <span class="comment">     * @param $patterns (mixed) Array of hypenation patterns or a TEX file containing hypenation patterns. TEX patterns can be downloaded from http://www.ctan.org/tex-archive/language/hyph-utf8/tex/generic/hyph-utf8/patterns/</span>
<a name="l26424"></a>26424 <span class="comment">     * @param $dictionary (array) Array of words to be returned without applying the hyphenation algoritm.</span>
<a name="l26425"></a>26425 <span class="comment">     * @param $leftmin (int) Minimum number of character to leave on the left of the word without applying the hyphens.</span>
<a name="l26426"></a>26426 <span class="comment">     * @param $rightmin (int) Minimum number of character to leave on the right of the word without applying the hyphens.</span>
<a name="l26427"></a>26427 <span class="comment">     * @param $charmin (int) Minimum word length to apply the hyphenation algoritm.</span>
<a name="l26428"></a>26428 <span class="comment">     * @param $charmax (int) Maximum length of broken piece of word.</span>
<a name="l26429"></a>26429 <span class="comment">     * @return array text with soft hyphens</span>
<a name="l26430"></a>26430 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26431"></a>26431 <span class="comment">     * @since 4.9.012 (2010-04-12)</span>
<a name="l26432"></a>26432 <span class="comment">     * @public</span>
<a name="l26433"></a>26433 <span class="comment">     */</span>
<a name="l26434"></a><a class="code" href="classTCPDF.html#a8f7b75b709d2a2c58b569f33cfedf180">26434</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a8f7b75b709d2a2c58b569f33cfedf180" title="Returns text with soft hyphens.">hyphenateText</a>(<a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>, $patterns, $dictionary=array(), $leftmin=1, $rightmin=2, $charmin=1, $charmax=8) {
<a name="l26435"></a>26435         <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a> = $this-&gt;unhtmlentities(<a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>);
<a name="l26436"></a>26436         $word = array(); <span class="comment">// last word</span>
<a name="l26437"></a>26437         $txtarr = array(); <span class="comment">// text to be returned</span>
<a name="l26438"></a>26438         $intag = <span class="keyword">false</span>; <span class="comment">// true if we are inside an HTML tag</span>
<a name="l26439"></a>26439         <span class="keywordflow">if</span> (!is_array($patterns)) {
<a name="l26440"></a>26440             $patterns = $this-&gt;getHyphenPatternsFromTEX($patterns);
<a name="l26441"></a>26441         }
<a name="l26442"></a>26442         <span class="comment">// get array of characters</span>
<a name="l26443"></a>26443         $unichars = $this-&gt;UTF8StringToArray(<a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>);
<a name="l26444"></a>26444         <span class="comment">// for each char</span>
<a name="l26445"></a>26445         <span class="keywordflow">foreach</span> ($unichars as $char) {
<a name="l26446"></a>26446             <span class="keywordflow">if</span> ((!$intag) AND $this-&gt;unicode-&gt;uni_type[$char] == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l26447"></a>26447                 <span class="comment">// letter character</span>
<a name="l26448"></a>26448                 $word[] = $char;
<a name="l26449"></a>26449             } <span class="keywordflow">else</span> {
<a name="l26450"></a>26450                 <span class="comment">// other type of character</span>
<a name="l26451"></a>26451                 <span class="keywordflow">if</span> (!$this-&gt;empty_string($word)) {
<a name="l26452"></a>26452                     <span class="comment">// hypenate the word</span>
<a name="l26453"></a>26453                     $txtarr = array_merge($txtarr, $this-&gt;hyphenateWord($word, $patterns, $dictionary, $leftmin, $rightmin, $charmin, $charmax));
<a name="l26454"></a>26454                     $word = array();
<a name="l26455"></a>26455                 }
<a name="l26456"></a>26456                 $txtarr[] = $char;
<a name="l26457"></a>26457                 <span class="keywordflow">if</span> (chr($char) == <span class="charliteral">&#39;&lt;&#39;</span>) {
<a name="l26458"></a>26458                     <span class="comment">// we are inside an HTML tag</span>
<a name="l26459"></a>26459                     $intag = <span class="keyword">true</span>;
<a name="l26460"></a>26460                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($intag AND (chr($char) == <span class="charliteral">&#39;&gt;&#39;</span>)) {
<a name="l26461"></a>26461                     <span class="comment">// end of HTML tag</span>
<a name="l26462"></a>26462                     $intag = <span class="keyword">false</span>;
<a name="l26463"></a>26463                 }
<a name="l26464"></a>26464             }
<a name="l26465"></a>26465         }
<a name="l26466"></a>26466         <span class="keywordflow">if</span> (!$this-&gt;empty_string($word)) {
<a name="l26467"></a>26467             <span class="comment">// hypenate the word</span>
<a name="l26468"></a>26468             $txtarr = array_merge($txtarr, $this-&gt;hyphenateWord($word, $patterns, $dictionary, $leftmin, $rightmin, $charmin, $charmax));
<a name="l26469"></a>26469         }
<a name="l26470"></a>26470         <span class="comment">// convert char array to string and return</span>
<a name="l26471"></a>26471         <span class="keywordflow">return</span> $this-&gt;UTF8ArrSubString($txtarr);
<a name="l26472"></a>26472     }
<a name="l26473"></a>26473 <span class="comment"></span>
<a name="l26474"></a>26474 <span class="comment">    /**</span>
<a name="l26475"></a>26475 <span class="comment">     * Enable/disable rasterization of vector images using ImageMagick library.</span>
<a name="l26476"></a>26476 <span class="comment">     * @param $mode (boolean) if true enable rasterization, false otherwise.</span>
<a name="l26477"></a>26477 <span class="comment">     * @public</span>
<a name="l26478"></a>26478 <span class="comment">     * @since 5.0.000 (2010-04-27)</span>
<a name="l26479"></a>26479 <span class="comment">     */</span>
<a name="l26480"></a><a class="code" href="classTCPDF.html#a568b961f0419fcc3edd28f9bb50bab86">26480</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a568b961f0419fcc3edd28f9bb50bab86" title="Enable/disable rasterization of vector images using ImageMagick library.">setRasterizeVectorImages</a>(<a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>) {
<a name="l26481"></a>26481         $this-&gt;rasterize_vector_images = <a class="code" href="form_8inc_8php.html#a3aaf40baac36e278c7d7c9139df1750c">$mode</a>;
<a name="l26482"></a>26482     }
<a name="l26483"></a>26483 <span class="comment"></span>
<a name="l26484"></a>26484 <span class="comment">    /**</span>
<a name="l26485"></a>26485 <span class="comment">     * Get the Path-Painting Operators.</span>
<a name="l26486"></a>26486 <span class="comment">     * @param $style (string) Style of rendering. Possible values are:</span>
<a name="l26487"></a>26487 <span class="comment">     * &lt;ul&gt;</span>
<a name="l26488"></a>26488 <span class="comment">     *   &lt;li&gt;S or D: Stroke the path.&lt;/li&gt;</span>
<a name="l26489"></a>26489 <span class="comment">     *   &lt;li&gt;s or d: Close and stroke the path.&lt;/li&gt;</span>
<a name="l26490"></a>26490 <span class="comment">     *   &lt;li&gt;f or F: Fill the path, using the nonzero winding number rule to determine the region to fill.&lt;/li&gt;</span>
<a name="l26491"></a>26491 <span class="comment">     *   &lt;li&gt;f* or F*: Fill the path, using the even-odd rule to determine the region to fill.&lt;/li&gt;</span>
<a name="l26492"></a>26492 <span class="comment">     *   &lt;li&gt;B or FD or DF: Fill and then stroke the path, using the nonzero winding number rule to determine the region to fill.&lt;/li&gt;</span>
<a name="l26493"></a>26493 <span class="comment">     *   &lt;li&gt;B* or F*D or DF*: Fill and then stroke the path, using the even-odd rule to determine the region to fill.&lt;/li&gt;</span>
<a name="l26494"></a>26494 <span class="comment">     *   &lt;li&gt;b or fd or df: Close, fill, and then stroke the path, using the nonzero winding number rule to determine the region to fill.&lt;/li&gt;</span>
<a name="l26495"></a>26495 <span class="comment">     *   &lt;li&gt;b or f*d or df*: Close, fill, and then stroke the path, using the even-odd rule to determine the region to fill.&lt;/li&gt;</span>
<a name="l26496"></a>26496 <span class="comment">     *   &lt;li&gt;CNZ: Clipping mode using the even-odd rule to determine which regions lie inside the clipping path.&lt;/li&gt;</span>
<a name="l26497"></a>26497 <span class="comment">     *   &lt;li&gt;CEO: Clipping mode using the nonzero winding number rule to determine which regions lie inside the clipping path&lt;/li&gt;</span>
<a name="l26498"></a>26498 <span class="comment">     *   &lt;li&gt;n: End the path object without filling or stroking it.&lt;/li&gt;</span>
<a name="l26499"></a>26499 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l26500"></a>26500 <span class="comment">     * @param $default (string) default style</span>
<a name="l26501"></a>26501 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26502"></a>26502 <span class="comment">     * @since 5.0.000 (2010-04-30)</span>
<a name="l26503"></a>26503 <span class="comment">     * @protected</span>
<a name="l26504"></a>26504 <span class="comment">     */</span>
<a name="l26505"></a><a class="code" href="classTCPDF.html#a078915a229dd0599d80c409fb7fcd696">26505</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a078915a229dd0599d80c409fb7fcd696" title="Get the Path-Painting Operators.">getPathPaintOperator</a>($style, $default=<span class="charliteral">&#39;S&#39;</span>) {
<a name="l26506"></a>26506         $op = <span class="stringliteral">&#39;&#39;</span>;
<a name="l26507"></a>26507         <span class="keywordflow">switch</span>($style) {
<a name="l26508"></a>26508             <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:
<a name="l26509"></a>26509             <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>: {
<a name="l26510"></a>26510                 $op = <span class="charliteral">&#39;S&#39;</span>;
<a name="l26511"></a>26511                 <span class="keywordflow">break</span>;
<a name="l26512"></a>26512             }
<a name="l26513"></a>26513             <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:
<a name="l26514"></a>26514             <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>: {
<a name="l26515"></a>26515                 $op = <span class="charliteral">&#39;s&#39;</span>;
<a name="l26516"></a>26516                 <span class="keywordflow">break</span>;
<a name="l26517"></a>26517             }
<a name="l26518"></a>26518             <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:
<a name="l26519"></a>26519             <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>: {
<a name="l26520"></a>26520                 $op = <span class="charliteral">&#39;f&#39;</span>;
<a name="l26521"></a>26521                 <span class="keywordflow">break</span>;
<a name="l26522"></a>26522             }
<a name="l26523"></a>26523             <span class="keywordflow">case</span> <span class="stringliteral">&#39;f*&#39;</span>:
<a name="l26524"></a>26524             <span class="keywordflow">case</span> <span class="stringliteral">&#39;F*&#39;</span>: {
<a name="l26525"></a>26525                 $op = <span class="stringliteral">&#39;f*&#39;</span>;
<a name="l26526"></a>26526                 <span class="keywordflow">break</span>;
<a name="l26527"></a>26527             }
<a name="l26528"></a>26528             <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:
<a name="l26529"></a>26529             <span class="keywordflow">case</span> <span class="stringliteral">&#39;FD&#39;</span>:
<a name="l26530"></a>26530             <span class="keywordflow">case</span> <span class="stringliteral">&#39;DF&#39;</span>: {
<a name="l26531"></a>26531                 $op = <span class="charliteral">&#39;B&#39;</span>;
<a name="l26532"></a>26532                 <span class="keywordflow">break</span>;
<a name="l26533"></a>26533             }
<a name="l26534"></a>26534             <span class="keywordflow">case</span> <span class="stringliteral">&#39;B*&#39;</span>:
<a name="l26535"></a>26535             <span class="keywordflow">case</span> <span class="stringliteral">&#39;F*D&#39;</span>:
<a name="l26536"></a>26536             <span class="keywordflow">case</span> <span class="stringliteral">&#39;DF*&#39;</span>: {
<a name="l26537"></a>26537                 $op = <span class="stringliteral">&#39;B*&#39;</span>;
<a name="l26538"></a>26538                 <span class="keywordflow">break</span>;
<a name="l26539"></a>26539             }
<a name="l26540"></a>26540             <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:
<a name="l26541"></a>26541             <span class="keywordflow">case</span> <span class="stringliteral">&#39;fd&#39;</span>:
<a name="l26542"></a>26542             <span class="keywordflow">case</span> <span class="stringliteral">&#39;df&#39;</span>: {
<a name="l26543"></a>26543                 $op = <span class="charliteral">&#39;b&#39;</span>;
<a name="l26544"></a>26544                 <span class="keywordflow">break</span>;
<a name="l26545"></a>26545             }
<a name="l26546"></a>26546             <span class="keywordflow">case</span> <span class="stringliteral">&#39;b*&#39;</span>:
<a name="l26547"></a>26547             <span class="keywordflow">case</span> <span class="stringliteral">&#39;f*d&#39;</span>:
<a name="l26548"></a>26548             <span class="keywordflow">case</span> <span class="stringliteral">&#39;df*&#39;</span>: {
<a name="l26549"></a>26549                 $op = <span class="stringliteral">&#39;b*&#39;</span>;
<a name="l26550"></a>26550                 <span class="keywordflow">break</span>;
<a name="l26551"></a>26551             }
<a name="l26552"></a>26552             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CNZ&#39;</span>: {
<a name="l26553"></a>26553                 $op = <span class="stringliteral">&#39;W n&#39;</span>;
<a name="l26554"></a>26554                 <span class="keywordflow">break</span>;
<a name="l26555"></a>26555             }
<a name="l26556"></a>26556             <span class="keywordflow">case</span> <span class="stringliteral">&#39;CEO&#39;</span>: {
<a name="l26557"></a>26557                 $op = <span class="stringliteral">&#39;W* n&#39;</span>;
<a name="l26558"></a>26558                 <span class="keywordflow">break</span>;
<a name="l26559"></a>26559             }
<a name="l26560"></a>26560             <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>: {
<a name="l26561"></a>26561                 $op = <span class="charliteral">&#39;n&#39;</span>;
<a name="l26562"></a>26562                 <span class="keywordflow">break</span>;
<a name="l26563"></a>26563             }
<a name="l26564"></a>26564             <span class="keywordflow">default</span>: {
<a name="l26565"></a>26565                 <span class="keywordflow">if</span> (!empty($default)) {
<a name="l26566"></a>26566                     $op = $this-&gt;getPathPaintOperator($default, <span class="stringliteral">&#39;&#39;</span>);
<a name="l26567"></a>26567                 } <span class="keywordflow">else</span> {
<a name="l26568"></a>26568                     $op = <span class="stringliteral">&#39;&#39;</span>;
<a name="l26569"></a>26569                 }
<a name="l26570"></a>26570             }
<a name="l26571"></a>26571         }
<a name="l26572"></a>26572         <span class="keywordflow">return</span> $op;
<a name="l26573"></a>26573     }
<a name="l26574"></a>26574 <span class="comment"></span>
<a name="l26575"></a>26575 <span class="comment">    /**</span>
<a name="l26576"></a>26576 <span class="comment">     * Enable or disable default option for font subsetting.</span>
<a name="l26577"></a>26577 <span class="comment">     * @param $enable (boolean) if true enable font subsetting by default.</span>
<a name="l26578"></a>26578 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26579"></a>26579 <span class="comment">     * @public</span>
<a name="l26580"></a>26580 <span class="comment">     * @since 5.3.002 (2010-06-07)</span>
<a name="l26581"></a>26581 <span class="comment">     */</span>
<a name="l26582"></a><a class="code" href="classTCPDF.html#a08aec0a405ab1a1a311bf20aacc5b36d">26582</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a08aec0a405ab1a1a311bf20aacc5b36d" title="Enable or disable default option for font subsetting.">setFontSubsetting</a>($enable=<span class="keyword">true</span>) {
<a name="l26583"></a>26583         <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l26584"></a>26584             $this-&gt;font_subsetting = <span class="keyword">false</span>;
<a name="l26585"></a>26585         } <span class="keywordflow">else</span> {
<a name="l26586"></a>26586             $this-&gt;font_subsetting = $enable ? <span class="keyword">true</span> : <span class="keyword">false</span>;
<a name="l26587"></a>26587         }
<a name="l26588"></a>26588     }
<a name="l26589"></a>26589 <span class="comment"></span>
<a name="l26590"></a>26590 <span class="comment">    /**</span>
<a name="l26591"></a>26591 <span class="comment">     * Return the default option for font subsetting.</span>
<a name="l26592"></a>26592 <span class="comment">     * @return boolean default font subsetting state.</span>
<a name="l26593"></a>26593 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26594"></a>26594 <span class="comment">     * @public</span>
<a name="l26595"></a>26595 <span class="comment">     * @since 5.3.002 (2010-06-07)</span>
<a name="l26596"></a>26596 <span class="comment">     */</span>
<a name="l26597"></a><a class="code" href="classTCPDF.html#ad00f8a524481e110dd8b6da59934252c">26597</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad00f8a524481e110dd8b6da59934252c" title="Return the default option for font subsetting.">getFontSubsetting</a>() {
<a name="l26598"></a>26598         <span class="keywordflow">return</span> $this-&gt;font_subsetting;
<a name="l26599"></a>26599     }
<a name="l26600"></a>26600 <span class="comment"></span>
<a name="l26601"></a>26601 <span class="comment">    /**</span>
<a name="l26602"></a>26602 <span class="comment">     * Left trim the input string</span>
<a name="l26603"></a>26603 <span class="comment">     * @param $str (string) string to trim</span>
<a name="l26604"></a>26604 <span class="comment">     * @param $replace (string) string that replace spaces.</span>
<a name="l26605"></a>26605 <span class="comment">     * @return left trimmed string</span>
<a name="l26606"></a>26606 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26607"></a>26607 <span class="comment">     * @public</span>
<a name="l26608"></a>26608 <span class="comment">     * @since 5.8.000 (2010-08-11)</span>
<a name="l26609"></a>26609 <span class="comment">     */</span>
<a name="l26610"></a><a class="code" href="classTCPDF.html#a0a25521fa461d9d52aabce5687795650">26610</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0a25521fa461d9d52aabce5687795650" title="Left trim the input string.">stringLeftTrim</a>($str, $replace=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l26611"></a>26611         <span class="keywordflow">return</span> preg_replace(<span class="stringliteral">&#39;/^&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $replace, $str);
<a name="l26612"></a>26612     }
<a name="l26613"></a>26613 <span class="comment"></span>
<a name="l26614"></a>26614 <span class="comment">    /**</span>
<a name="l26615"></a>26615 <span class="comment">     * Right trim the input string</span>
<a name="l26616"></a>26616 <span class="comment">     * @param $str (string) string to trim</span>
<a name="l26617"></a>26617 <span class="comment">     * @param $replace (string) string that replace spaces.</span>
<a name="l26618"></a>26618 <span class="comment">     * @return right trimmed string</span>
<a name="l26619"></a>26619 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26620"></a>26620 <span class="comment">     * @public</span>
<a name="l26621"></a>26621 <span class="comment">     * @since 5.8.000 (2010-08-11)</span>
<a name="l26622"></a>26622 <span class="comment">     */</span>
<a name="l26623"></a><a class="code" href="classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">26623</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a" title="Right trim the input string.">stringRightTrim</a>($str, $replace=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l26624"></a>26624         <span class="keywordflow">return</span> preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+$/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $replace, $str);
<a name="l26625"></a>26625     }
<a name="l26626"></a>26626 <span class="comment"></span>
<a name="l26627"></a>26627 <span class="comment">    /**</span>
<a name="l26628"></a>26628 <span class="comment">     * Trim the input string</span>
<a name="l26629"></a>26629 <span class="comment">     * @param $str (string) string to trim</span>
<a name="l26630"></a>26630 <span class="comment">     * @param $replace (string) string that replace spaces.</span>
<a name="l26631"></a>26631 <span class="comment">     * @return trimmed string</span>
<a name="l26632"></a>26632 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26633"></a>26633 <span class="comment">     * @public</span>
<a name="l26634"></a>26634 <span class="comment">     * @since 5.8.000 (2010-08-11)</span>
<a name="l26635"></a>26635 <span class="comment">     */</span>
<a name="l26636"></a><a class="code" href="classTCPDF.html#abdc6aa462bc81023df2ec043742bcb4b">26636</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#abdc6aa462bc81023df2ec043742bcb4b" title="Trim the input string.">stringTrim</a>($str, $replace=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l26637"></a>26637         $str = $this-&gt;stringLeftTrim($str, $replace);
<a name="l26638"></a>26638         $str = $this-&gt;stringRightTrim($str, $replace);
<a name="l26639"></a>26639         <span class="keywordflow">return</span> $str;
<a name="l26640"></a>26640     }
<a name="l26641"></a>26641 <span class="comment"></span>
<a name="l26642"></a>26642 <span class="comment">    /**</span>
<a name="l26643"></a>26643 <span class="comment">     * Return true if the current font is unicode type.</span>
<a name="l26644"></a>26644 <span class="comment">     * @return true for unicode font, false otherwise.</span>
<a name="l26645"></a>26645 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26646"></a>26646 <span class="comment">     * @public</span>
<a name="l26647"></a>26647 <span class="comment">     * @since 5.8.002 (2010-08-14)</span>
<a name="l26648"></a>26648 <span class="comment">     */</span>
<a name="l26649"></a><a class="code" href="classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">26649</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97" title="Return true if the current font is unicode type.">isUnicodeFont</a>() {
<a name="l26650"></a>26650         <span class="keywordflow">return</span> (($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;cidfont0&#39;</span>));
<a name="l26651"></a>26651     }
<a name="l26652"></a>26652 <span class="comment"></span>
<a name="l26653"></a>26653 <span class="comment">    /**</span>
<a name="l26654"></a>26654 <span class="comment">     * Return normalized font name</span>
<a name="l26655"></a>26655 <span class="comment">     * @param $fontfamily (string) property string containing font family names</span>
<a name="l26656"></a>26656 <span class="comment">     * @return string normalized font name</span>
<a name="l26657"></a>26657 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26658"></a>26658 <span class="comment">     * @public</span>
<a name="l26659"></a>26659 <span class="comment">     * @since 5.8.004 (2010-08-17)</span>
<a name="l26660"></a>26660 <span class="comment">     */</span>
<a name="l26661"></a><a class="code" href="classTCPDF.html#a1454645fa7a1e35f6f8a634c0978ed2e">26661</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1454645fa7a1e35f6f8a634c0978ed2e" title="Return normalized font name.">getFontFamilyName</a>($fontfamily) {
<a name="l26662"></a>26662         <span class="comment">// remove spaces and symbols</span>
<a name="l26663"></a>26663         $fontfamily = preg_replace(<span class="stringliteral">&#39;/[^a-z0-9\,]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, strtolower($fontfamily));
<a name="l26664"></a>26664         <span class="comment">// extract all font names</span>
<a name="l26665"></a>26665         $fontslist = preg_split(<span class="stringliteral">&#39;/[,]/&#39;</span>, $fontfamily);
<a name="l26666"></a>26666         <span class="comment">// find first valid font name</span>
<a name="l26667"></a>26667         <span class="keywordflow">foreach</span> ($fontslist as <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>) {
<a name="l26668"></a>26668             <span class="comment">// replace font variations</span>
<a name="l26669"></a>26669             $font = preg_replace(<span class="stringliteral">&#39;/italic$/&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, $font);
<a name="l26670"></a>26670             $font = preg_replace(<span class="stringliteral">&#39;/oblique$/&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, $font);
<a name="l26671"></a>26671             $font = preg_replace(<span class="stringliteral">&#39;/bold([I]?)$/&#39;</span>, <span class="stringliteral">&#39;B\\1&#39;</span>, $font);
<a name="l26672"></a>26672             <span class="comment">// replace common family names and core fonts</span>
<a name="l26673"></a>26673             $pattern = array();
<a name="l26674"></a>26674             $replacement = array();
<a name="l26675"></a>26675             $pattern[] = <span class="stringliteral">&#39;/^serif|^cursive|^fantasy|^timesnewroman/&#39;</span>;
<a name="l26676"></a>26676             $replacement[] = <span class="stringliteral">&#39;times&#39;</span>;
<a name="l26677"></a>26677             $pattern[] = <span class="stringliteral">&#39;/^sansserif/&#39;</span>;
<a name="l26678"></a>26678             $replacement[] = <span class="stringliteral">&#39;helvetica&#39;</span>;
<a name="l26679"></a>26679             $pattern[] = <span class="stringliteral">&#39;/^monospace/&#39;</span>;
<a name="l26680"></a>26680             $replacement[] = <span class="stringliteral">&#39;courier&#39;</span>;
<a name="l26681"></a>26681             $font = preg_replace($pattern, $replacement, $font);
<a name="l26682"></a>26682             <span class="keywordflow">if</span> (in_array(strtolower($font), $this-&gt;fontlist) OR in_array($font, $this-&gt;fontkeys)) {
<a name="l26683"></a>26683                 <span class="keywordflow">return</span> <a class="code" href="indexfb_8php.html#a9d63b61d7d442048fe453731932c6aed">$font</a>;
<a name="l26684"></a>26684             }
<a name="l26685"></a>26685         }
<a name="l26686"></a>26686         <span class="comment">// return current font as default</span>
<a name="l26687"></a>26687         <span class="keywordflow">return</span> $this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>];
<a name="l26688"></a>26688     }
<a name="l26689"></a>26689 <span class="comment"></span>
<a name="l26690"></a>26690 <span class="comment">    /**</span>
<a name="l26691"></a>26691 <span class="comment">     * Start a new XObject Template.</span>
<a name="l26692"></a>26692 <span class="comment">     * An XObject Template is a PDF block that is a self-contained description of any sequence of graphics objects (including path objects, text objects, and sampled images).</span>
<a name="l26693"></a>26693 <span class="comment">     * An XObject Template may be painted multiple times, either on several pages or at several locations on the same page and produces the same results each time, subject only to the graphics state at the time it is invoked.</span>
<a name="l26694"></a>26694 <span class="comment">     * Note: X,Y coordinates will be reset to 0,0.</span>
<a name="l26695"></a>26695 <span class="comment">     * @param $w (int) Template width in user units (empty string or zero = page width less margins).</span>
<a name="l26696"></a>26696 <span class="comment">     * @param $h (int) Template height in user units (empty string or zero = page height less margins).</span>
<a name="l26697"></a>26697 <span class="comment">     * @param $group (mixed) Set transparency group. Can be a boolean value or an array specifying optional parameters: &#39;CS&#39; (solour space name), &#39;I&#39; (boolean flag to indicate isolated group) and &#39;K&#39; (boolean flag to indicate knockout group).</span>
<a name="l26698"></a>26698 <span class="comment">     * @return int the XObject Template ID in case of success or false in case of error.</span>
<a name="l26699"></a>26699 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26700"></a>26700 <span class="comment">     * @public</span>
<a name="l26701"></a>26701 <span class="comment">     * @since 5.8.017 (2010-08-24)</span>
<a name="l26702"></a>26702 <span class="comment">     * @see endTemplate(), printTemplate()</span>
<a name="l26703"></a>26703 <span class="comment">     */</span>
<a name="l26704"></a><a class="code" href="classTCPDF.html#a7eae5df3511dac591b5b76ab5d8b9a68">26704</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7eae5df3511dac591b5b76ab5d8b9a68" title="Start a new XObject Template.">startTemplate</a>(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=0, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=0, $group=<span class="keyword">false</span>) {
<a name="l26705"></a>26705         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l26706"></a>26706             <span class="comment">// we are already inside an XObject template</span>
<a name="l26707"></a>26707             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l26708"></a>26708         }
<a name="l26709"></a>26709         $this-&gt;inxobj = <span class="keyword">true</span>;
<a name="l26710"></a>26710         ++$this-&gt;n;
<a name="l26711"></a>26711         <span class="comment">// XObject ID</span>
<a name="l26712"></a>26712         $this-&gt;xobjid = <span class="stringliteral">&#39;XT&#39;</span>.$this-&gt;n;
<a name="l26713"></a>26713         <span class="comment">// object ID</span>
<a name="l26714"></a>26714         $this-&gt;xobjects[$this-&gt;xobjid] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n);
<a name="l26715"></a>26715         <span class="comment">// store current graphic state</span>
<a name="l26716"></a>26716         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;gvars&#39;</span>] = $this-&gt;getGraphicVars();
<a name="l26717"></a>26717         <span class="comment">// initialize data</span>
<a name="l26718"></a>26718         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>] = 0;
<a name="l26719"></a>26719         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>] = array();
<a name="l26720"></a>26720         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;
<a name="l26721"></a>26721         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;xobjects&#39;</span>] = array();
<a name="l26722"></a>26722         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;images&#39;</span>] = array();
<a name="l26723"></a>26723         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;fonts&#39;</span>] = array();
<a name="l26724"></a>26724         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>] = array();
<a name="l26725"></a>26725         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;extgstates&#39;</span>] = array();
<a name="l26726"></a>26726         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;gradients&#39;</span>] = array();
<a name="l26727"></a>26727         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;spot_colors&#39;</span>] = array();
<a name="l26728"></a>26728         <span class="comment">// set new environment</span>
<a name="l26729"></a>26729         $this-&gt;num_columns = 1;
<a name="l26730"></a>26730         $this-&gt;current_column = 0;
<a name="l26731"></a>26731         $this-&gt;SetAutoPageBreak(<span class="keyword">false</span>);
<a name="l26732"></a>26732         <span class="keywordflow">if</span> ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0)) {
<a name="l26733"></a>26733             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin;
<a name="l26734"></a>26734         }
<a name="l26735"></a>26735         <span class="keywordflow">if</span> ((<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0)) {
<a name="l26736"></a>26736             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $this-&gt;h - $this-&gt;tMargin - $this-&gt;bMargin;
<a name="l26737"></a>26737         }
<a name="l26738"></a>26738         $this-&gt;xobjects[$this-&gt;xobjid][<span class="charliteral">&#39;x&#39;</span>] = 0;
<a name="l26739"></a>26739         $this-&gt;xobjects[$this-&gt;xobjid][<span class="charliteral">&#39;y&#39;</span>] = 0;
<a name="l26740"></a>26740         $this-&gt;xobjects[$this-&gt;xobjid][<span class="charliteral">&#39;w&#39;</span>] = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l26741"></a>26741         $this-&gt;xobjects[$this-&gt;xobjid][<span class="charliteral">&#39;h&#39;</span>] = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l26742"></a>26742         $this-&gt;w = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l26743"></a>26743         $this-&gt;h = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l26744"></a>26744         $this-&gt;wPt = $this-&gt;w * $this-&gt;k;
<a name="l26745"></a>26745         $this-&gt;hPt = $this-&gt;h * $this-&gt;k;
<a name="l26746"></a>26746         $this-&gt;fwPt = $this-&gt;wPt;
<a name="l26747"></a>26747         $this-&gt;fhPt = $this-&gt;hPt;
<a name="l26748"></a>26748         $this-&gt;x = 0;
<a name="l26749"></a>26749         $this-&gt;y = 0;
<a name="l26750"></a>26750         $this-&gt;lMargin = 0;
<a name="l26751"></a>26751         $this-&gt;rMargin = 0;
<a name="l26752"></a>26752         $this-&gt;tMargin = 0;
<a name="l26753"></a>26753         $this-&gt;bMargin = 0;
<a name="l26754"></a>26754         <span class="comment">// set group mode</span>
<a name="l26755"></a>26755         $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;group&#39;</span>] = $group;
<a name="l26756"></a>26756         <span class="keywordflow">return</span> $this-&gt;xobjid;
<a name="l26757"></a>26757     }
<a name="l26758"></a>26758 <span class="comment"></span>
<a name="l26759"></a>26759 <span class="comment">    /**</span>
<a name="l26760"></a>26760 <span class="comment">     * End the current XObject Template started with startTemplate() and restore the previous graphic state.</span>
<a name="l26761"></a>26761 <span class="comment">     * An XObject Template is a PDF block that is a self-contained description of any sequence of graphics objects (including path objects, text objects, and sampled images).</span>
<a name="l26762"></a>26762 <span class="comment">     * An XObject Template may be painted multiple times, either on several pages or at several locations on the same page and produces the same results each time, subject only to the graphics state at the time it is invoked.</span>
<a name="l26763"></a>26763 <span class="comment">     * @return int the XObject Template ID in case of success or false in case of error.</span>
<a name="l26764"></a>26764 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26765"></a>26765 <span class="comment">     * @public</span>
<a name="l26766"></a>26766 <span class="comment">     * @since 5.8.017 (2010-08-24)</span>
<a name="l26767"></a>26767 <span class="comment">     * @see startTemplate(), printTemplate()</span>
<a name="l26768"></a>26768 <span class="comment">     */</span>
<a name="l26769"></a><a class="code" href="classTCPDF.html#a0b98de81d99a1a0e983dd0016e30fc75">26769</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a0b98de81d99a1a0e983dd0016e30fc75" title="End the current XObject Template started with startTemplate() and restore the previous graphic state...">endTemplate</a>() {
<a name="l26770"></a>26770         <span class="keywordflow">if</span> (!$this-&gt;inxobj) {
<a name="l26771"></a>26771             <span class="comment">// we are not inside a template</span>
<a name="l26772"></a>26772             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l26773"></a>26773         }
<a name="l26774"></a>26774         $this-&gt;inxobj = <span class="keyword">false</span>;
<a name="l26775"></a>26775         <span class="comment">// restore previous graphic state</span>
<a name="l26776"></a>26776         $this-&gt;setGraphicVars($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;gvars&#39;</span>], <span class="keyword">true</span>);
<a name="l26777"></a>26777         <span class="keywordflow">return</span> $this-&gt;xobjid;
<a name="l26778"></a>26778     }
<a name="l26779"></a>26779 <span class="comment"></span>
<a name="l26780"></a>26780 <span class="comment">    /**</span>
<a name="l26781"></a>26781 <span class="comment">     * Print an XObject Template.</span>
<a name="l26782"></a>26782 <span class="comment">     * You can print an XObject Template inside the currently opened Template.</span>
<a name="l26783"></a>26783 <span class="comment">     * An XObject Template is a PDF block that is a self-contained description of any sequence of graphics objects (including path objects, text objects, and sampled images).</span>
<a name="l26784"></a>26784 <span class="comment">     * An XObject Template may be painted multiple times, either on several pages or at several locations on the same page and produces the same results each time, subject only to the graphics state at the time it is invoked.</span>
<a name="l26785"></a>26785 <span class="comment">     * @param $id (string) The ID of XObject Template to print.</span>
<a name="l26786"></a>26786 <span class="comment">     * @param $x (int) X position in user units (empty string = current x position)</span>
<a name="l26787"></a>26787 <span class="comment">     * @param $y (int) Y position in user units (empty string = current y position)</span>
<a name="l26788"></a>26788 <span class="comment">     * @param $w (int) Width in user units (zero = remaining page width)</span>
<a name="l26789"></a>26789 <span class="comment">     * @param $h (int) Height in user units (zero = remaining page height)</span>
<a name="l26790"></a>26790 <span class="comment">     * @param $align (string) Indicates the alignment of the pointer next to template insertion relative to template height. The value can be:&lt;ul&gt;&lt;li&gt;T: top-right for LTR or top-left for RTL&lt;/li&gt;&lt;li&gt;M: middle-right for LTR or middle-left for RTL&lt;/li&gt;&lt;li&gt;B: bottom-right for LTR or bottom-left for RTL&lt;/li&gt;&lt;li&gt;N: next line&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l26791"></a>26791 <span class="comment">     * @param $palign (string) Allows to center or align the template on the current line. Possible values are:&lt;ul&gt;&lt;li&gt;L : left align&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;R : right align&lt;/li&gt;&lt;li&gt;&#39;&#39; : empty string : left for LTR or right for RTL&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l26792"></a>26792 <span class="comment">     * @param $fitonpage (boolean) If true the template is resized to not exceed page dimensions.</span>
<a name="l26793"></a>26793 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26794"></a>26794 <span class="comment">     * @public</span>
<a name="l26795"></a>26795 <span class="comment">     * @since 5.8.017 (2010-08-24)</span>
<a name="l26796"></a>26796 <span class="comment">     * @see startTemplate(), endTemplate()</span>
<a name="l26797"></a>26797 <span class="comment">     */</span>
<a name="l26798"></a><a class="code" href="classTCPDF.html#a3a58677c9c6a6e9e7702fcb3041b7253">26798</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a3a58677c9c6a6e9e7702fcb3041b7253" title="Print an XObject Template.">printTemplate</a>(<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=0, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=0, $align=<span class="stringliteral">&#39;&#39;</span>, $palign=<span class="stringliteral">&#39;&#39;</span>, $fitonpage=<span class="keyword">false</span>) {
<a name="l26799"></a>26799         <span class="keywordflow">if</span> (!isset($this-&gt;xobjects[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>])) {
<a name="l26800"></a>26800             $this-&gt;Error(<span class="stringliteral">&#39;The XObject Template \&#39;&#39;</span>.$id.<span class="charliteral">&#39;\&#39;</span> doesn\<span class="stringliteral">&#39;t exist!&#39;</span>);
<a name="l26801"></a>26801         }
<a name="l26802"></a>26802         <span class="keywordflow">if</span> ($this-&gt;inxobj) {
<a name="l26803"></a>26803             <span class="keywordflow">if</span> ($id == $this-&gt;xobjid) {
<a name="l26804"></a>26804                 <span class="comment">// close current template</span>
<a name="l26805"></a>26805                 $this-&gt;endTemplate();
<a name="l26806"></a>26806             } <span class="keywordflow">else</span> {
<a name="l26807"></a>26807                 <span class="comment">// use the template as resource for the template currently opened</span>
<a name="l26808"></a>26808                 $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;xobjects&#39;</span>][<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>] = $this-&gt;xobjects[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>];
<a name="l26809"></a>26809             }
<a name="l26810"></a>26810         }
<a name="l26811"></a>26811         <span class="comment">// set default values</span>
<a name="l26812"></a>26812         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l26813"></a>26813             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l26814"></a>26814         }
<a name="l26815"></a>26815         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l26816"></a>26816             $y = $this-&gt;y;
<a name="l26817"></a>26817         }
<a name="l26818"></a>26818         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l26819"></a>26819         list(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;checkPageRegions(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l26820"></a>26820         $ow = $this-&gt;xobjects[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>][<span class="charliteral">&#39;w&#39;</span>];
<a name="l26821"></a>26821         $oh = $this-&gt;xobjects[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>][<span class="charliteral">&#39;h&#39;</span>];
<a name="l26822"></a>26822         <span class="comment">// calculate template width and height on document</span>
<a name="l26823"></a>26823         <span class="keywordflow">if</span> ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0) AND (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0)) {
<a name="l26824"></a>26824             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $ow;
<a name="l26825"></a>26825             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $oh;
<a name="l26826"></a>26826         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0) {
<a name="l26827"></a>26827             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> * $ow / $oh;
<a name="l26828"></a>26828         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0) {
<a name="l26829"></a>26829             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $oh / $ow;
<a name="l26830"></a>26830         }
<a name="l26831"></a>26831         <span class="comment">// fit the template on available space</span>
<a name="l26832"></a>26832         list(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;fitBlock(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $fitonpage);
<a name="l26833"></a>26833         <span class="comment">// set page alignment</span>
<a name="l26834"></a>26834         $rb_y = $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l26835"></a>26835         <span class="comment">// set alignment</span>
<a name="l26836"></a>26836         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l26837"></a>26837             <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l26838"></a>26838                 $xt = $this-&gt;lMargin;
<a name="l26839"></a>26839             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l26840"></a>26840                 $xt = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l26841"></a>26841             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l26842"></a>26842                 $xt = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l26843"></a>26843             } <span class="keywordflow">else</span> {
<a name="l26844"></a>26844                 $xt = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l26845"></a>26845             }
<a name="l26846"></a>26846             $rb_x = $xt;
<a name="l26847"></a>26847         } <span class="keywordflow">else</span> {
<a name="l26848"></a>26848             <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l26849"></a>26849                 $xt = $this-&gt;lMargin;
<a name="l26850"></a>26850             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l26851"></a>26851                 $xt = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l26852"></a>26852             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l26853"></a>26853                 $xt = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l26854"></a>26854             } <span class="keywordflow">else</span> {
<a name="l26855"></a>26855                 $xt = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l26856"></a>26856             }
<a name="l26857"></a>26857             $rb_x = $xt + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l26858"></a>26858         }
<a name="l26859"></a>26859         <span class="comment">// print XObject Template + Transformation matrix</span>
<a name="l26860"></a>26860         $this-&gt;StartTransform();
<a name="l26861"></a>26861         <span class="comment">// translate and scale</span>
<a name="l26862"></a>26862         $sx = (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> / $this-&gt;xobjects[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>][<span class="charliteral">&#39;w&#39;</span>]);
<a name="l26863"></a>26863         $sy = ($h / $this-&gt;xobjects[<a class="code" href="servers_8inc_8php.html#ae97941710d863131c700f069b109991e">$id</a>][<span class="charliteral">&#39;h&#39;</span>]);
<a name="l26864"></a>26864         $tm = array();
<a name="l26865"></a>26865         $tm[0] = $sx;
<a name="l26866"></a>26866         $tm[1] = 0;
<a name="l26867"></a>26867         $tm[2] = 0;
<a name="l26868"></a>26868         $tm[3] = $sy;
<a name="l26869"></a>26869         $tm[4] = $xt * $this-&gt;k;
<a name="l26870"></a>26870         $tm[5] = ($this-&gt;h - $h - $y) * $this-&gt;k;
<a name="l26871"></a>26871         $this-&gt;Transform($tm);
<a name="l26872"></a>26872         <span class="comment">// set object</span>
<a name="l26873"></a>26873         $this-&gt;_out(<span class="charliteral">&#39;/&#39;</span>.$id.<span class="stringliteral">&#39; Do&#39;</span>);
<a name="l26874"></a>26874         $this-&gt;StopTransform();
<a name="l26875"></a>26875         <span class="comment">// add annotations</span>
<a name="l26876"></a>26876         <span class="keywordflow">if</span> (!empty($this-&gt;xobjects[$id][<span class="stringliteral">&#39;annotations&#39;</span>])) {
<a name="l26877"></a>26877             <span class="keywordflow">foreach</span> ($this-&gt;xobjects[$id][<span class="stringliteral">&#39;annotations&#39;</span>] as $annot) {
<a name="l26878"></a>26878                 <span class="comment">// transform original coordinates</span>
<a name="l26879"></a>26879                 $coordlt = $this-&gt;getTransformationMatrixProduct($tm, array(1, 0, 0, 1, ($annot[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k), (-$annot[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k)));
<a name="l26880"></a>26880                 $ax = ($coordlt[4] / $this-&gt;k);
<a name="l26881"></a>26881                 $ay = ($this-&gt;h - $h - ($coordlt[5] / $this-&gt;k));
<a name="l26882"></a>26882                 $coordrb = $this-&gt;getTransformationMatrixProduct($tm, array(1, 0, 0, 1, (($annot[<span class="charliteral">&#39;x&#39;</span>] + $annot[<span class="charliteral">&#39;w&#39;</span>]) * $this-&gt;k), ((-$annot[<span class="charliteral">&#39;y&#39;</span>] - $annot[<span class="charliteral">&#39;h&#39;</span>]) * $this-&gt;k)));
<a name="l26883"></a>26883                 $aw = ($coordrb[4] / $this-&gt;k) - $ax;
<a name="l26884"></a>26884                 $ah = ($this-&gt;h - $h - ($coordrb[5] / $this-&gt;k)) - $ay;
<a name="l26885"></a>26885                 $this-&gt;Annotation($ax, $ay, $aw, $ah, $annot[<span class="stringliteral">&#39;text&#39;</span>], $annot[<span class="stringliteral">&#39;opt&#39;</span>], $annot[<span class="stringliteral">&#39;spaces&#39;</span>]);
<a name="l26886"></a>26886             }
<a name="l26887"></a>26887         }
<a name="l26888"></a>26888         <span class="comment">// set pointer to align the next text/objects</span>
<a name="l26889"></a>26889         <span class="keywordflow">switch</span>($align) {
<a name="l26890"></a>26890             <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {
<a name="l26891"></a>26891                 $this-&gt;y = $y;
<a name="l26892"></a>26892                 $this-&gt;x = $rb_x;
<a name="l26893"></a>26893                 <span class="keywordflow">break</span>;
<a name="l26894"></a>26894             }
<a name="l26895"></a>26895             <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {
<a name="l26896"></a>26896                 $this-&gt;y = $y + round($h/2);
<a name="l26897"></a>26897                 $this-&gt;x = $rb_x;
<a name="l26898"></a>26898                 <span class="keywordflow">break</span>;
<a name="l26899"></a>26899             }
<a name="l26900"></a>26900             <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {
<a name="l26901"></a>26901                 $this-&gt;y = $rb_y;
<a name="l26902"></a>26902                 $this-&gt;x = $rb_x;
<a name="l26903"></a>26903                 <span class="keywordflow">break</span>;
<a name="l26904"></a>26904             }
<a name="l26905"></a>26905             <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>: {
<a name="l26906"></a>26906                 $this-&gt;SetY($rb_y);
<a name="l26907"></a>26907                 <span class="keywordflow">break</span>;
<a name="l26908"></a>26908             }
<a name="l26909"></a>26909             <span class="keywordflow">default</span>:{
<a name="l26910"></a>26910                 <span class="keywordflow">break</span>;
<a name="l26911"></a>26911             }
<a name="l26912"></a>26912         }
<a name="l26913"></a>26913     }
<a name="l26914"></a>26914 <span class="comment"></span>
<a name="l26915"></a>26915 <span class="comment">    /**</span>
<a name="l26916"></a>26916 <span class="comment">     * Set the percentage of character stretching.</span>
<a name="l26917"></a>26917 <span class="comment">     * @param $perc (int) percentage of stretching (100 = no stretching)</span>
<a name="l26918"></a>26918 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26919"></a>26919 <span class="comment">     * @public</span>
<a name="l26920"></a>26920 <span class="comment">     * @since 5.9.000 (2010-09-29)</span>
<a name="l26921"></a>26921 <span class="comment">     */</span>
<a name="l26922"></a><a class="code" href="classTCPDF.html#ad69e13e0b99d5d72440bc95cde06dbcd">26922</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad69e13e0b99d5d72440bc95cde06dbcd" title="Set the percentage of character stretching.">setFontStretching</a>($perc=100) {
<a name="l26923"></a>26923         $this-&gt;font_stretching = $perc;
<a name="l26924"></a>26924     }
<a name="l26925"></a>26925 <span class="comment"></span>
<a name="l26926"></a>26926 <span class="comment">    /**</span>
<a name="l26927"></a>26927 <span class="comment">     * Get the percentage of character stretching.</span>
<a name="l26928"></a>26928 <span class="comment">     * @return float stretching value</span>
<a name="l26929"></a>26929 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26930"></a>26930 <span class="comment">     * @public</span>
<a name="l26931"></a>26931 <span class="comment">     * @since 5.9.000 (2010-09-29)</span>
<a name="l26932"></a>26932 <span class="comment">     */</span>
<a name="l26933"></a><a class="code" href="classTCPDF.html#a6765cafbc343aeacdcbd0a97c6c90ca5">26933</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a6765cafbc343aeacdcbd0a97c6c90ca5" title="Get the percentage of character stretching.">getFontStretching</a>() {
<a name="l26934"></a>26934         <span class="keywordflow">return</span> $this-&gt;font_stretching;
<a name="l26935"></a>26935     }
<a name="l26936"></a>26936 <span class="comment"></span>
<a name="l26937"></a>26937 <span class="comment">    /**</span>
<a name="l26938"></a>26938 <span class="comment">     * Set the amount to increase or decrease the space between characters in a text.</span>
<a name="l26939"></a>26939 <span class="comment">     * @param $spacing (float) amount to increase or decrease the space between characters in a text (0 = default spacing)</span>
<a name="l26940"></a>26940 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26941"></a>26941 <span class="comment">     * @public</span>
<a name="l26942"></a>26942 <span class="comment">     * @since 5.9.000 (2010-09-29)</span>
<a name="l26943"></a>26943 <span class="comment">     */</span>
<a name="l26944"></a><a class="code" href="classTCPDF.html#aa9d049671275dc2a39e4654f3028544c">26944</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa9d049671275dc2a39e4654f3028544c" title="Set the amount to increase or decrease the space between characters in a text.">setFontSpacing</a>($spacing=0) {
<a name="l26945"></a>26945         $this-&gt;font_spacing = $spacing;
<a name="l26946"></a>26946     }
<a name="l26947"></a>26947 <span class="comment"></span>
<a name="l26948"></a>26948 <span class="comment">    /**</span>
<a name="l26949"></a>26949 <span class="comment">     * Get the amount to increase or decrease the space between characters in a text.</span>
<a name="l26950"></a>26950 <span class="comment">     * @return int font spacing (tracking/kerning) value</span>
<a name="l26951"></a>26951 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26952"></a>26952 <span class="comment">     * @public</span>
<a name="l26953"></a>26953 <span class="comment">     * @since 5.9.000 (2010-09-29)</span>
<a name="l26954"></a>26954 <span class="comment">     */</span>
<a name="l26955"></a><a class="code" href="classTCPDF.html#a917bed78601b25201a9c507d841fc538">26955</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a917bed78601b25201a9c507d841fc538" title="Get the amount to increase or decrease the space between characters in a text.">getFontSpacing</a>() {
<a name="l26956"></a>26956         <span class="keywordflow">return</span> $this-&gt;font_spacing;
<a name="l26957"></a>26957     }
<a name="l26958"></a>26958 <span class="comment"></span>
<a name="l26959"></a>26959 <span class="comment">    /**</span>
<a name="l26960"></a>26960 <span class="comment">     * Return an array of no-write page regions</span>
<a name="l26961"></a>26961 <span class="comment">     * @return array of no-write page regions</span>
<a name="l26962"></a>26962 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26963"></a>26963 <span class="comment">     * @public</span>
<a name="l26964"></a>26964 <span class="comment">     * @since 5.9.003 (2010-10-13)</span>
<a name="l26965"></a>26965 <span class="comment">     * @see setPageRegions(), addPageRegion()</span>
<a name="l26966"></a>26966 <span class="comment">     */</span>
<a name="l26967"></a><a class="code" href="classTCPDF.html#aca0a3c26e95c17b68bd0a5420f88629b">26967</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aca0a3c26e95c17b68bd0a5420f88629b" title="Return an array of no-write page regions.">getPageRegions</a>() {
<a name="l26968"></a>26968         <span class="keywordflow">return</span> $this-&gt;page_regions;
<a name="l26969"></a>26969     }
<a name="l26970"></a>26970 <span class="comment"></span>
<a name="l26971"></a>26971 <span class="comment">    /**</span>
<a name="l26972"></a>26972 <span class="comment">     * Set no-write regions on page.</span>
<a name="l26973"></a>26973 <span class="comment">     * A no-write region is a portion of the page with a rectangular or trapezium shape that will not be covered when writing text or html code.</span>
<a name="l26974"></a>26974 <span class="comment">     * A region is always aligned on the left or right side of the page ad is defined using a vertical segment.</span>
<a name="l26975"></a>26975 <span class="comment">     * You can set multiple regions for the same page.</span>
<a name="l26976"></a>26976 <span class="comment">     * @param $regions (array) array of no-write regions. For each region you can define an array as follow: (&#39;page&#39; =&gt; page number or empy for current page, &#39;xt&#39; =&gt; X top, &#39;yt&#39; =&gt; Y top, &#39;xb&#39; =&gt; X bottom, &#39;yb&#39; =&gt; Y bottom, &#39;side&#39; =&gt; page side &#39;L&#39; = left or &#39;R&#39; = right). Omit this parameter to remove all regions.</span>
<a name="l26977"></a>26977 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26978"></a>26978 <span class="comment">     * @public</span>
<a name="l26979"></a>26979 <span class="comment">     * @since 5.9.003 (2010-10-13)</span>
<a name="l26980"></a>26980 <span class="comment">     * @see addPageRegion(), getPageRegions()</span>
<a name="l26981"></a>26981 <span class="comment">     */</span>
<a name="l26982"></a><a class="code" href="classTCPDF.html#a996483e91d4c2567d354e3c4a755d4bc">26982</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a996483e91d4c2567d354e3c4a755d4bc" title="Set no-write regions on page.">setPageRegions</a>($regions=array()) {
<a name="l26983"></a>26983         <span class="comment">// empty current regions array</span>
<a name="l26984"></a>26984         $this-&gt;page_regions = array();
<a name="l26985"></a>26985         <span class="comment">// add regions</span>
<a name="l26986"></a>26986         <span class="keywordflow">foreach</span> ($regions as <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l26987"></a>26987             $this-&gt;addPageRegion($data);
<a name="l26988"></a>26988         }
<a name="l26989"></a>26989     }
<a name="l26990"></a>26990 <span class="comment"></span>
<a name="l26991"></a>26991 <span class="comment">    /**</span>
<a name="l26992"></a>26992 <span class="comment">     * Add a single no-write region on selected page.</span>
<a name="l26993"></a>26993 <span class="comment">     * A no-write region is a portion of the page with a rectangular or trapezium shape that will not be covered when writing text or html code.</span>
<a name="l26994"></a>26994 <span class="comment">     * A region is always aligned on the left or right side of the page ad is defined using a vertical segment.</span>
<a name="l26995"></a>26995 <span class="comment">     * You can set multiple regions for the same page.</span>
<a name="l26996"></a>26996 <span class="comment">     * @param $region (array) array of a single no-write region array: (&#39;page&#39; =&gt; page number or empy for current page, &#39;xt&#39; =&gt; X top, &#39;yt&#39; =&gt; Y top, &#39;xb&#39; =&gt; X bottom, &#39;yb&#39; =&gt; Y bottom, &#39;side&#39; =&gt; page side &#39;L&#39; = left or &#39;R&#39; = right).</span>
<a name="l26997"></a>26997 <span class="comment">     * @author Nicola Asuni</span>
<a name="l26998"></a>26998 <span class="comment">     * @public</span>
<a name="l26999"></a>26999 <span class="comment">     * @since 5.9.003 (2010-10-13)</span>
<a name="l27000"></a>27000 <span class="comment">     * @see setPageRegions(), getPageRegions()</span>
<a name="l27001"></a>27001 <span class="comment">     */</span>
<a name="l27002"></a><a class="code" href="classTCPDF.html#a7416404adf787407cc9c87effbbb8d1e">27002</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a7416404adf787407cc9c87effbbb8d1e" title="Add a single no-write region on selected page.">addPageRegion</a>($region) {
<a name="l27003"></a>27003         <span class="keywordflow">if</span> (!isset($region[<span class="stringliteral">&#39;page&#39;</span>]) OR empty($region[<span class="stringliteral">&#39;page&#39;</span>])) {
<a name="l27004"></a>27004             $region[<span class="stringliteral">&#39;page&#39;</span>] = $this-&gt;page;
<a name="l27005"></a>27005         }
<a name="l27006"></a>27006         <span class="keywordflow">if</span> (isset($region[<span class="stringliteral">&#39;xt&#39;</span>]) AND isset($region[<span class="stringliteral">&#39;xb&#39;</span>]) AND ($region[<span class="stringliteral">&#39;xt&#39;</span>] &gt; 0) AND ($region[<span class="stringliteral">&#39;xb&#39;</span>] &gt; 0)
<a name="l27007"></a>27007             AND isset($region[<span class="stringliteral">&#39;yt&#39;</span>])  AND isset($region[<span class="stringliteral">&#39;yb&#39;</span>]) AND ($region[<span class="stringliteral">&#39;yt&#39;</span>] &gt;= 0) AND ($region[<span class="stringliteral">&#39;yt&#39;</span>] &lt; $region[<span class="stringliteral">&#39;yb&#39;</span>])
<a name="l27008"></a>27008             AND isset($region[<span class="stringliteral">&#39;side&#39;</span>]) AND (($region[<span class="stringliteral">&#39;side&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) OR ($region[<span class="stringliteral">&#39;side&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>))) {
<a name="l27009"></a>27009             $this-&gt;page_regions[] = $region;
<a name="l27010"></a>27010         }
<a name="l27011"></a>27011     }
<a name="l27012"></a>27012 <span class="comment"></span>
<a name="l27013"></a>27013 <span class="comment">    /**</span>
<a name="l27014"></a>27014 <span class="comment">     * Remove a single no-write region.</span>
<a name="l27015"></a>27015 <span class="comment">     * @param $key (int) region key</span>
<a name="l27016"></a>27016 <span class="comment">     * @author Nicola Asuni</span>
<a name="l27017"></a>27017 <span class="comment">     * @public</span>
<a name="l27018"></a>27018 <span class="comment">     * @since 5.9.003 (2010-10-13)</span>
<a name="l27019"></a>27019 <span class="comment">     * @see setPageRegions(), getPageRegions()</span>
<a name="l27020"></a>27020 <span class="comment">     */</span>
<a name="l27021"></a><a class="code" href="classTCPDF.html#a2a5521c59a12125acade8485634c04ec">27021</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a2a5521c59a12125acade8485634c04ec" title="Remove a single no-write region.">removePageRegion</a>($key) {
<a name="l27022"></a>27022         <span class="keywordflow">if</span> (isset($this-&gt;page_regions[$key])) {
<a name="l27023"></a>27023             unset($this-&gt;page_regions[$key]);
<a name="l27024"></a>27024         }
<a name="l27025"></a>27025     }
<a name="l27026"></a>27026 <span class="comment"></span>
<a name="l27027"></a>27027 <span class="comment">    /**</span>
<a name="l27028"></a>27028 <span class="comment">     * Check page for no-write regions and adapt current coordinates and page margins if necessary.</span>
<a name="l27029"></a>27029 <span class="comment">     * A no-write region is a portion of the page with a rectangular or trapezium shape that will not be covered when writing text or html code.</span>
<a name="l27030"></a>27030 <span class="comment">     * A region is always aligned on the left or right side of the page ad is defined using a vertical segment.</span>
<a name="l27031"></a>27031 <span class="comment">     * @param $h (float) height of the text/image/object to print in user units</span>
<a name="l27032"></a>27032 <span class="comment">     * @param $x (float) current X coordinate in user units</span>
<a name="l27033"></a>27033 <span class="comment">     * @param $y (float) current Y coordinate in user units</span>
<a name="l27034"></a>27034 <span class="comment">     * @return array($x, $y)</span>
<a name="l27035"></a>27035 <span class="comment">     * @author Nicola Asuni</span>
<a name="l27036"></a>27036 <span class="comment">     * @protected</span>
<a name="l27037"></a>27037 <span class="comment">     * @since 5.9.003 (2010-10-13)</span>
<a name="l27038"></a>27038 <span class="comment">     */</span>
<a name="l27039"></a><a class="code" href="classTCPDF.html#a1d99e81697a90efb13a6734001427f40">27039</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a1d99e81697a90efb13a6734001427f40" title="Check page for no-write regions and adapt current coordinates and page margins if necessary...">checkPageRegions</a>(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) {
<a name="l27040"></a>27040         <span class="comment">// set default values</span>
<a name="l27041"></a>27041         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l27042"></a>27042             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l27043"></a>27043         }
<a name="l27044"></a>27044         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l27045"></a>27045             $y = $this-&gt;y;
<a name="l27046"></a>27046         }
<a name="l27047"></a>27047         <span class="keywordflow">if</span> (empty($this-&gt;page_regions)) {
<a name="l27048"></a>27048             <span class="comment">// no page regions defined</span>
<a name="l27049"></a>27049             <span class="keywordflow">return</span> array(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l27050"></a>27050         }
<a name="l27051"></a>27051         <span class="keywordflow">if</span> (empty(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>)) {
<a name="l27052"></a>27052             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = ($this-&gt;FontSize * $this-&gt;cell_height_ratio) + $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>];
<a name="l27053"></a>27053         }
<a name="l27054"></a>27054         <span class="comment">// check for page break</span>
<a name="l27055"></a>27055         <span class="keywordflow">if</span> ($this-&gt;checkPageBreak(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $y)) {
<a name="l27056"></a>27056             <span class="comment">// the content will be printed on a new page</span>
<a name="l27057"></a>27057             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l27058"></a>27058             $y = $this-&gt;y;
<a name="l27059"></a>27059         }
<a name="l27060"></a>27060         <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {
<a name="l27061"></a>27061             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l27062"></a>27062                 $this-&gt;lMargin = $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>] - $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;w&#39;</span>];
<a name="l27063"></a>27063             } <span class="keywordflow">else</span> {
<a name="l27064"></a>27064                 $this-&gt;rMargin = $this-&gt;w - $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>] - $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;w&#39;</span>];
<a name="l27065"></a>27065             }
<a name="l27066"></a>27066         } <span class="keywordflow">else</span> {
<a name="l27067"></a>27067             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l27068"></a>27068                 $this-&gt;lMargin = $this-&gt;original_lMargin;
<a name="l27069"></a>27069             } <span class="keywordflow">else</span> {
<a name="l27070"></a>27070                 $this-&gt;rMargin = $this-&gt;original_rMargin;
<a name="l27071"></a>27071             }
<a name="l27072"></a>27072         }
<a name="l27073"></a>27073         <span class="comment">// adjust coordinates and page margins</span>
<a name="l27074"></a>27074         <span class="keywordflow">foreach</span> ($this-&gt;page_regions as $regid =&gt; $regdata) {
<a name="l27075"></a>27075             <span class="keywordflow">if</span> ($regdata[<span class="stringliteral">&#39;page&#39;</span>] == $this-&gt;page) {
<a name="l27076"></a>27076                 <span class="comment">// check region boundaries</span>
<a name="l27077"></a>27077                 <span class="keywordflow">if</span> (($y &gt; ($regdata[<span class="stringliteral">&#39;yt&#39;</span>] - <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>)) AND ($y &lt;= $regdata[<span class="stringliteral">&#39;yb&#39;</span>])) {
<a name="l27078"></a>27078                     <span class="comment">// Y is inside the region</span>
<a name="l27079"></a>27079                     $minv = ($regdata[<span class="stringliteral">&#39;xb&#39;</span>] - $regdata[<span class="stringliteral">&#39;xt&#39;</span>]) / ($regdata[<span class="stringliteral">&#39;yb&#39;</span>] - $regdata[<span class="stringliteral">&#39;yt&#39;</span>]); <span class="comment">// inverse of angular coefficient</span>
<a name="l27080"></a>27080                     $yt = max($y, $regdata[<span class="stringliteral">&#39;yt&#39;</span>]);
<a name="l27081"></a>27081                     $yb = min(($yt + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>), $regdata[<span class="stringliteral">&#39;yb&#39;</span>]);
<a name="l27082"></a>27082                     $xt = (($yt - $regdata[<span class="stringliteral">&#39;yt&#39;</span>]) * $minv) + $regdata[<span class="stringliteral">&#39;xt&#39;</span>];
<a name="l27083"></a>27083                     $xb = (($yb - $regdata[<span class="stringliteral">&#39;yt&#39;</span>]) * $minv) + $regdata[<span class="stringliteral">&#39;xt&#39;</span>];
<a name="l27084"></a>27084                     <span class="keywordflow">if</span> ($regdata[<span class="stringliteral">&#39;side&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) { <span class="comment">// left side</span>
<a name="l27085"></a>27085                         $new_margin = max($xt, $xb);
<a name="l27086"></a>27086                         <span class="keywordflow">if</span> ($this-&gt;lMargin &lt; $new_margin) {
<a name="l27087"></a>27087                             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l27088"></a>27088                                 <span class="comment">// adjust left page margin</span>
<a name="l27089"></a>27089                                 $this-&gt;lMargin = $new_margin;
<a name="l27090"></a>27090                             }
<a name="l27091"></a>27091                             <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> &lt; $new_margin) {
<a name="l27092"></a>27092                                 <span class="comment">// adjust x position</span>
<a name="l27093"></a>27093                                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $new_margin;
<a name="l27094"></a>27094                                 <span class="keywordflow">if</span> ($new_margin &gt; ($this-&gt;w - $this-&gt;rMargin)) {
<a name="l27095"></a>27095                                     <span class="comment">// adjust y position</span>
<a name="l27096"></a>27096                                     $y = $regdata[<span class="stringliteral">&#39;yb&#39;</span>] - <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l27097"></a>27097                                 }
<a name="l27098"></a>27098                             }
<a name="l27099"></a>27099                         }
<a name="l27100"></a>27100                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($regdata[<span class="stringliteral">&#39;side&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) { <span class="comment">// right side</span>
<a name="l27101"></a>27101                         $new_margin = min($xt, $xb);
<a name="l27102"></a>27102                         <span class="keywordflow">if</span> (($this-&gt;w - $this-&gt;rMargin) &gt; $new_margin) {
<a name="l27103"></a>27103                             <span class="keywordflow">if</span> (!$this-&gt;rtl) {
<a name="l27104"></a>27104                                 <span class="comment">// adjust right page margin</span>
<a name="l27105"></a>27105                                 $this-&gt;rMargin = ($this-&gt;w - $new_margin);
<a name="l27106"></a>27106                             }
<a name="l27107"></a>27107                             <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> &gt; $new_margin) {
<a name="l27108"></a>27108                                 <span class="comment">// adjust x position</span>
<a name="l27109"></a>27109                                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $new_margin;
<a name="l27110"></a>27110                                 <span class="keywordflow">if</span> ($new_margin &gt; $this-&gt;lMargin) {
<a name="l27111"></a>27111                                     <span class="comment">// adjust y position</span>
<a name="l27112"></a>27112                                     $y = $regdata[<span class="stringliteral">&#39;yb&#39;</span>] - <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l27113"></a>27113                                 }
<a name="l27114"></a>27114                             }
<a name="l27115"></a>27115                         }
<a name="l27116"></a>27116                     }
<a name="l27117"></a>27117                 }
<a name="l27118"></a>27118             }
<a name="l27119"></a>27119         }
<a name="l27120"></a>27120         <span class="keywordflow">return</span> array(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l27121"></a>27121     }
<a name="l27122"></a>27122 
<a name="l27123"></a>27123     <span class="comment">// --- SVG METHODS ---------------------------------------------------------</span>
<a name="l27124"></a>27124 <span class="comment"></span>
<a name="l27125"></a>27125 <span class="comment">    /**</span>
<a name="l27126"></a>27126 <span class="comment">     * Embedd a Scalable Vector Graphics (SVG) image.</span>
<a name="l27127"></a>27127 <span class="comment">     * NOTE: SVG standard is not yet fully implemented, use the setRasterizeVectorImages() method to enable/disable rasterization of vector images using ImageMagick library.</span>
<a name="l27128"></a>27128 <span class="comment">     * @param $file (string) Name of the SVG file or a &#39;@&#39; character followed by the SVG data string.</span>
<a name="l27129"></a>27129 <span class="comment">     * @param $x (float) Abscissa of the upper-left corner.</span>
<a name="l27130"></a>27130 <span class="comment">     * @param $y (float) Ordinate of the upper-left corner.</span>
<a name="l27131"></a>27131 <span class="comment">     * @param $w (float) Width of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
<a name="l27132"></a>27132 <span class="comment">     * @param $h (float) Height of the image in the page. If not specified or equal to zero, it is automatically calculated.</span>
<a name="l27133"></a>27133 <span class="comment">     * @param $link (mixed) URL or identifier returned by AddLink().</span>
<a name="l27134"></a>27134 <span class="comment">     * @param $align (string) Indicates the alignment of the pointer next to image insertion relative to image height. The value can be:&lt;ul&gt;&lt;li&gt;T: top-right for LTR or top-left for RTL&lt;/li&gt;&lt;li&gt;M: middle-right for LTR or middle-left for RTL&lt;/li&gt;&lt;li&gt;B: bottom-right for LTR or bottom-left for RTL&lt;/li&gt;&lt;li&gt;N: next line&lt;/li&gt;&lt;/ul&gt; If the alignment is an empty string, then the pointer will be restored on the starting SVG position.</span>
<a name="l27135"></a>27135 <span class="comment">     * @param $palign (string) Allows to center or align the image on the current line. Possible values are:&lt;ul&gt;&lt;li&gt;L : left align&lt;/li&gt;&lt;li&gt;C : center&lt;/li&gt;&lt;li&gt;R : right align&lt;/li&gt;&lt;li&gt;&#39;&#39; : empty string : left for LTR or right for RTL&lt;/li&gt;&lt;/ul&gt;</span>
<a name="l27136"></a>27136 <span class="comment">     * @param $border (mixed) Indicates if borders must be drawn around the cell. The value can be a number:&lt;ul&gt;&lt;li&gt;0: no border (default)&lt;/li&gt;&lt;li&gt;1: frame&lt;/li&gt;&lt;/ul&gt; or a string containing some or all of the following characters (in any order):&lt;ul&gt;&lt;li&gt;L: left&lt;/li&gt;&lt;li&gt;T: top&lt;/li&gt;&lt;li&gt;R: right&lt;/li&gt;&lt;li&gt;B: bottom&lt;/li&gt;&lt;/ul&gt; or an array of line styles for each border group - for example: array(&#39;LTRB&#39; =&gt; array(&#39;width&#39; =&gt; 2, &#39;cap&#39; =&gt; &#39;butt&#39;, &#39;join&#39; =&gt; &#39;miter&#39;, &#39;dash&#39; =&gt; 0, &#39;color&#39; =&gt; array(0, 0, 0)))</span>
<a name="l27137"></a>27137 <span class="comment">     * @param $fitonpage (boolean) if true the image is resized to not exceed page dimensions.</span>
<a name="l27138"></a>27138 <span class="comment">     * @author Nicola Asuni</span>
<a name="l27139"></a>27139 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l27140"></a>27140 <span class="comment">     * @public</span>
<a name="l27141"></a>27141 <span class="comment">     */</span>
<a name="l27142"></a><a class="code" href="classTCPDF.html#a56536508fb1b5aede7d2ed27f56c2353">27142</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a56536508fb1b5aede7d2ed27f56c2353" title="Embedd a Scalable Vector Graphics (SVG) image.">ImageSVG</a>(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=0, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=0, $link=<span class="stringliteral">&#39;&#39;</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $palign=<span class="stringliteral">&#39;&#39;</span>, $border=0, $fitonpage=<span class="keyword">false</span>) {
<a name="l27143"></a>27143         <span class="keywordflow">if</span> ($this-&gt;rasterize_vector_images AND (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &gt; 0) AND (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &gt; 0)) {
<a name="l27144"></a>27144             <span class="comment">// convert SVG to raster image using GD or ImageMagick libraries</span>
<a name="l27145"></a>27145             <span class="keywordflow">return</span> $this-&gt;Image(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;SVG&#39;</span>, $link, $align, <span class="keyword">true</span>, 300, $palign, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);
<a name="l27146"></a>27146         }
<a name="l27147"></a>27147         <span class="keywordflow">if</span> (<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>{0} === <span class="charliteral">&#39;@&#39;</span>) { <span class="comment">// image from string</span>
<a name="l27148"></a>27148             $this-&gt;svgdir = <span class="stringliteral">&#39;&#39;</span>;
<a name="l27149"></a>27149             $svgdata = substr(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, 1);
<a name="l27150"></a>27150         } <span class="keywordflow">else</span> { <span class="comment">// SVG file</span>
<a name="l27151"></a>27151             $this-&gt;svgdir = dirname(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l27152"></a>27152             $svgdata = file_get_contents(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l27153"></a>27153         }
<a name="l27154"></a>27154         <span class="keywordflow">if</span> ($svgdata === <span class="keyword">false</span>) {
<a name="l27155"></a>27155             $this-&gt;Error(<span class="stringliteral">&#39;SVG file not found: &#39;</span>.<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>);
<a name="l27156"></a>27156         }
<a name="l27157"></a>27157         <span class="keywordflow">if</span> (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l27158"></a>27158             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $this-&gt;x;
<a name="l27159"></a>27159         }
<a name="l27160"></a>27160         <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {
<a name="l27161"></a>27161             $y = $this-&gt;y;
<a name="l27162"></a>27162         }
<a name="l27163"></a>27163         <span class="comment">// check page for no-write regions and adapt page margins if necessary</span>
<a name="l27164"></a>27164         list(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;checkPageRegions(<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l27165"></a>27165         $k = $this-&gt;k;
<a name="l27166"></a>27166         <a class="code" href="indexfb_8php.html#a33a0a09e9029d3d77e80de32b4e1c7b1">$ox</a> = 0;
<a name="l27167"></a>27167         <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a> = 0;
<a name="l27168"></a>27168         $ow = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27169"></a>27169         $oh = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l27170"></a>27170         $aspect_ratio_align = <span class="stringliteral">&#39;xMidYMid&#39;</span>;
<a name="l27171"></a>27171         $aspect_ratio_ms = <span class="stringliteral">&#39;meet&#39;</span>;
<a name="l27172"></a>27172         $regs = array();
<a name="l27173"></a>27173         <span class="comment">// get original image width and height</span>
<a name="l27174"></a>27174         preg_match(<span class="stringliteral">&#39;/&lt;svg([^&gt;]*)&gt;/si&#39;</span>, $svgdata, $regs);
<a name="l27175"></a>27175         <span class="keywordflow">if</span> (isset($regs[1]) AND !empty($regs[1])) {
<a name="l27176"></a>27176             $tmp = array();
<a name="l27177"></a>27177             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+x[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {
<a name="l27178"></a>27178                 <a class="code" href="indexfb_8php.html#a33a0a09e9029d3d77e80de32b4e1c7b1">$ox</a> = $this-&gt;getHTMLUnitToUnits($tmp[1], 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27179"></a>27179             }
<a name="l27180"></a>27180             $tmp = array();
<a name="l27181"></a>27181             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+y[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {
<a name="l27182"></a>27182                 <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a> = $this-&gt;getHTMLUnitToUnits($tmp[1], 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27183"></a>27183             }
<a name="l27184"></a>27184             $tmp = array();
<a name="l27185"></a>27185             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+width[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {
<a name="l27186"></a>27186                 $ow = $this-&gt;getHTMLUnitToUnits($tmp[1], 1, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27187"></a>27187             }
<a name="l27188"></a>27188             $tmp = array();
<a name="l27189"></a>27189             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+height[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {
<a name="l27190"></a>27190                 $oh = $this-&gt;getHTMLUnitToUnits($tmp[1], 1, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27191"></a>27191             }
<a name="l27192"></a>27192             $tmp = array();
<a name="l27193"></a>27193             $view_box = array();
<a name="l27194"></a>27194             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+viewBox[\s]*=[\s]*&quot;[\s]*([0-9\.\-]+)[\s]+([0-9\.\-]+)[\s]+([0-9\.]+)[\s]+([0-9\.]+)[\s]*&quot;/si&#39;</span>, $regs[1], $tmp)) {
<a name="l27195"></a>27195                 <span class="keywordflow">if</span> (count($tmp) == 5) {
<a name="l27196"></a>27196                     array_shift($tmp);
<a name="l27197"></a>27197                     <span class="keywordflow">foreach</span> ($tmp as $key =&gt; $val) {
<a name="l27198"></a>27198                         $view_box[$key] = $this-&gt;getHTMLUnitToUnits($val, 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27199"></a>27199                     }
<a name="l27200"></a>27200                     <a class="code" href="indexfb_8php.html#a33a0a09e9029d3d77e80de32b4e1c7b1">$ox</a> = $view_box[0];
<a name="l27201"></a>27201                     <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a> = $view_box[1];
<a name="l27202"></a>27202                 }
<a name="l27203"></a>27203                 <span class="comment">// get aspect ratio</span>
<a name="l27204"></a>27204                 $tmp = array();
<a name="l27205"></a>27205                 <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+preserveAspectRatio[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {
<a name="l27206"></a>27206                     $aspect_ratio = preg_split(<span class="stringliteral">&#39;/[\s]+/si&#39;</span>, $tmp[1]);
<a name="l27207"></a>27207                     <span class="keywordflow">switch</span> (count($aspect_ratio)) {
<a name="l27208"></a>27208                         <span class="keywordflow">case</span> 3: {
<a name="l27209"></a>27209                             $aspect_ratio_align = $aspect_ratio[1];
<a name="l27210"></a>27210                             $aspect_ratio_ms = $aspect_ratio[2];
<a name="l27211"></a>27211                             <span class="keywordflow">break</span>;
<a name="l27212"></a>27212                         }
<a name="l27213"></a>27213                         <span class="keywordflow">case</span> 2: {
<a name="l27214"></a>27214                             $aspect_ratio_align = $aspect_ratio[0];
<a name="l27215"></a>27215                             $aspect_ratio_ms = $aspect_ratio[1];
<a name="l27216"></a>27216                             <span class="keywordflow">break</span>;
<a name="l27217"></a>27217                         }
<a name="l27218"></a>27218                         <span class="keywordflow">case</span> 1: {
<a name="l27219"></a>27219                             $aspect_ratio_align = $aspect_ratio[0];
<a name="l27220"></a>27220                             $aspect_ratio_ms = <span class="stringliteral">&#39;meet&#39;</span>;
<a name="l27221"></a>27221                             <span class="keywordflow">break</span>;
<a name="l27222"></a>27222                         }
<a name="l27223"></a>27223                     }
<a name="l27224"></a>27224                 }
<a name="l27225"></a>27225             }
<a name="l27226"></a>27226         }
<a name="l27227"></a>27227         <span class="comment">// calculate image width and height on document</span>
<a name="l27228"></a>27228         <span class="keywordflow">if</span> ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0) AND (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0)) {
<a name="l27229"></a>27229             <span class="comment">// convert image size to document unit</span>
<a name="l27230"></a>27230             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $ow;
<a name="l27231"></a>27231             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $oh;
<a name="l27232"></a>27232         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= 0) {
<a name="l27233"></a>27233             <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> * $ow / $oh;
<a name="l27234"></a>27234         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= 0) {
<a name="l27235"></a>27235             <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $oh / $ow;
<a name="l27236"></a>27236         }
<a name="l27237"></a>27237         <span class="comment">// fit the image on available space</span>
<a name="l27238"></a>27238         list(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y) = $this-&gt;fitBlock(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, $fitonpage);
<a name="l27239"></a>27239         <span class="keywordflow">if</span> ($this-&gt;rasterize_vector_images) {
<a name="l27240"></a>27240             <span class="comment">// convert SVG to raster image using GD or ImageMagick libraries</span>
<a name="l27241"></a>27241             <span class="keywordflow">return</span> $this-&gt;Image(<a class="code" href="dejavusans_8php.html#aa1bfbd27060176201b271918dff57e8f">$file</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;SVG&#39;</span>, $link, $align, <span class="keyword">true</span>, 300, $palign, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);
<a name="l27242"></a>27242         }
<a name="l27243"></a>27243         <span class="comment">// set alignment</span>
<a name="l27244"></a>27244         $this-&gt;img_rb_y = $y + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l27245"></a>27245         <span class="comment">// set alignment</span>
<a name="l27246"></a>27246         <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l27247"></a>27247             <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l27248"></a>27248                 $ximg = $this-&gt;lMargin;
<a name="l27249"></a>27249             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l27250"></a>27250                 $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l27251"></a>27251             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l27252"></a>27252                 $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27253"></a>27253             } <span class="keywordflow">else</span> {
<a name="l27254"></a>27254                 $ximg = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27255"></a>27255             }
<a name="l27256"></a>27256             $this-&gt;img_rb_x = $ximg;
<a name="l27257"></a>27257         } <span class="keywordflow">else</span> {
<a name="l27258"></a>27258             <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {
<a name="l27259"></a>27259                 $ximg = $this-&gt;lMargin;
<a name="l27260"></a>27260             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;C&#39;</span>) {
<a name="l27261"></a>27261                 $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>) / 2;
<a name="l27262"></a>27262             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($palign == <span class="charliteral">&#39;R&#39;</span>) {
<a name="l27263"></a>27263                 $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27264"></a>27264             } <span class="keywordflow">else</span> {
<a name="l27265"></a>27265                 $ximg = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l27266"></a>27266             }
<a name="l27267"></a>27267             $this-&gt;img_rb_x = $ximg + <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27268"></a>27268         }
<a name="l27269"></a>27269         <span class="comment">// store current graphic vars</span>
<a name="l27270"></a>27270         $gvars = $this-&gt;getGraphicVars();
<a name="l27271"></a>27271         <span class="comment">// store SVG position and scale factors</span>
<a name="l27272"></a>27272         $svgoffset_x = ($ximg - <a class="code" href="indexfb_8php.html#a33a0a09e9029d3d77e80de32b4e1c7b1">$ox</a>) * $this-&gt;k;
<a name="l27273"></a>27273         $svgoffset_y = -($y - <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a>) * $this-&gt;k;
<a name="l27274"></a>27274         <span class="keywordflow">if</span> (isset($view_box[2]) AND ($view_box[2] &gt; 0) AND ($view_box[3] &gt; 0)) {
<a name="l27275"></a>27275             $ow = $view_box[2];
<a name="l27276"></a>27276             $oh = $view_box[3];
<a name="l27277"></a>27277         } <span class="keywordflow">else</span> {
<a name="l27278"></a>27278             <span class="keywordflow">if</span> ($ow &lt;= 0) {
<a name="l27279"></a>27279                 $ow = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27280"></a>27280             }
<a name="l27281"></a>27281             <span class="keywordflow">if</span> ($oh &lt;= 0) {
<a name="l27282"></a>27282                 $oh = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l27283"></a>27283             }
<a name="l27284"></a>27284         }
<a name="l27285"></a>27285         $svgscale_x = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> / $ow;
<a name="l27286"></a>27286         $svgscale_y = $h / $oh;
<a name="l27287"></a>27287         <span class="comment">// scaling and alignment</span>
<a name="l27288"></a>27288         <span class="keywordflow">if</span> ($aspect_ratio_align != <span class="stringliteral">&#39;none&#39;</span>) {
<a name="l27289"></a>27289             <span class="comment">// store current scaling values</span>
<a name="l27290"></a>27290             $svgscale_old_x = $svgscale_x;
<a name="l27291"></a>27291             $svgscale_old_y = $svgscale_y;
<a name="l27292"></a>27292             <span class="comment">// force uniform scaling</span>
<a name="l27293"></a>27293             <span class="keywordflow">if</span> ($aspect_ratio_ms == <span class="stringliteral">&#39;slice&#39;</span>) {
<a name="l27294"></a>27294                 <span class="comment">// the entire viewport is covered by the viewBox</span>
<a name="l27295"></a>27295                 <span class="keywordflow">if</span> ($svgscale_x &gt; $svgscale_y) {
<a name="l27296"></a>27296                     $svgscale_y = $svgscale_x;
<a name="l27297"></a>27297                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($svgscale_x &lt; $svgscale_y) {
<a name="l27298"></a>27298                     $svgscale_x = $svgscale_y;
<a name="l27299"></a>27299                 }
<a name="l27300"></a>27300             } <span class="keywordflow">else</span> { <span class="comment">// meet</span>
<a name="l27301"></a>27301                 <span class="comment">// the entire viewBox is visible within the viewport</span>
<a name="l27302"></a>27302                 <span class="keywordflow">if</span> ($svgscale_x &lt; $svgscale_y) {
<a name="l27303"></a>27303                     $svgscale_y = $svgscale_x;
<a name="l27304"></a>27304                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($svgscale_x &gt; $svgscale_y) {
<a name="l27305"></a>27305                     $svgscale_x = $svgscale_y;
<a name="l27306"></a>27306                 }
<a name="l27307"></a>27307             }
<a name="l27308"></a>27308             <span class="comment">// correct X alignment</span>
<a name="l27309"></a>27309             <span class="keywordflow">switch</span> (substr($aspect_ratio_align, 1, 3)) {
<a name="l27310"></a>27310                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;Min&#39;</span>: {
<a name="l27311"></a>27311                     <span class="comment">// do nothing</span>
<a name="l27312"></a>27312                     <span class="keywordflow">break</span>;
<a name="l27313"></a>27313                 }
<a name="l27314"></a>27314                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;Max&#39;</span>: {
<a name="l27315"></a>27315                     $svgoffset_x += ((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $this-&gt;k) - ($ow * $this-&gt;k * $svgscale_x));
<a name="l27316"></a>27316                     <span class="keywordflow">break</span>;
<a name="l27317"></a>27317                 }
<a name="l27318"></a>27318                 <span class="keywordflow">default</span>:
<a name="l27319"></a>27319                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;Mid&#39;</span>: {
<a name="l27320"></a>27320                     $svgoffset_x += (((<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> * $this-&gt;k) - ($ow * $this-&gt;k * $svgscale_x)) / 2);
<a name="l27321"></a>27321                     <span class="keywordflow">break</span>;
<a name="l27322"></a>27322                 }
<a name="l27323"></a>27323             }
<a name="l27324"></a>27324             <span class="comment">// correct Y alignment</span>
<a name="l27325"></a>27325             <span class="keywordflow">switch</span> (substr($aspect_ratio_align, 5)) {
<a name="l27326"></a>27326                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;Min&#39;</span>: {
<a name="l27327"></a>27327                     <span class="comment">// do nothing</span>
<a name="l27328"></a>27328                     <span class="keywordflow">break</span>;
<a name="l27329"></a>27329                 }
<a name="l27330"></a>27330                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;Max&#39;</span>: {
<a name="l27331"></a>27331                     $svgoffset_y -= (($h * $this-&gt;k) - ($oh * $this-&gt;k * $svgscale_y));
<a name="l27332"></a>27332                     <span class="keywordflow">break</span>;
<a name="l27333"></a>27333                 }
<a name="l27334"></a>27334                 <span class="keywordflow">default</span>:
<a name="l27335"></a>27335                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;Mid&#39;</span>: {
<a name="l27336"></a>27336                     $svgoffset_y -= ((($h * $this-&gt;k) - ($oh * $this-&gt;k * $svgscale_y)) / 2);
<a name="l27337"></a>27337                     <span class="keywordflow">break</span>;
<a name="l27338"></a>27338                 }
<a name="l27339"></a>27339             }
<a name="l27340"></a>27340         }
<a name="l27341"></a>27341         <span class="comment">// store current page break mode</span>
<a name="l27342"></a>27342         $page_break_mode = $this-&gt;AutoPageBreak;
<a name="l27343"></a>27343         $page_break_margin = $this-&gt;getBreakMargin();
<a name="l27344"></a>27344         $cell_padding = $this-&gt;cell_padding;
<a name="l27345"></a>27345         $this-&gt;SetCellPadding(0);
<a name="l27346"></a>27346         $this-&gt;SetAutoPageBreak(<span class="keyword">false</span>);
<a name="l27347"></a>27347         <span class="comment">// save the current graphic state</span>
<a name="l27348"></a>27348         $this-&gt;_out(<span class="charliteral">&#39;q&#39;</span>.$this-&gt;epsmarker);
<a name="l27349"></a>27349         <span class="comment">// set initial clipping mask</span>
<a name="l27350"></a>27350         $this-&gt;Rect(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $h, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array());
<a name="l27351"></a>27351         <span class="comment">// scale and translate</span>
<a name="l27352"></a>27352         $e = <a class="code" href="indexfb_8php.html#a33a0a09e9029d3d77e80de32b4e1c7b1">$ox</a> * $this-&gt;k * (1 - $svgscale_x);
<a name="l27353"></a>27353         <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = ($this-&gt;h - <a class="code" href="indexfb_8php.html#aa53f2d848a909002388da573570fcd6a">$oy</a>) * $this-&gt;k * (1 - $svgscale_y);
<a name="l27354"></a>27354         $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.3F %.3F %.3F %.3F %.3F %.3F cm&#39;</span>, $svgscale_x, 0, 0, $svgscale_y, $e + $svgoffset_x, $f + $svgoffset_y));
<a name="l27355"></a>27355         <span class="comment">// creates a new XML parser to be used by the other XML functions</span>
<a name="l27356"></a>27356         $this-&gt;parser = xml_parser_create(<span class="stringliteral">&#39;UTF-8&#39;</span>);
<a name="l27357"></a>27357         <span class="comment">// the following function allows to use parser inside object</span>
<a name="l27358"></a>27358         xml_set_object($this-&gt;parser, $this);
<a name="l27359"></a>27359         <span class="comment">// disable case-folding for this XML parser</span>
<a name="l27360"></a>27360         xml_parser_set_option($this-&gt;parser, XML_OPTION_CASE_FOLDING, 0);
<a name="l27361"></a>27361         <span class="comment">// sets the element handler functions for the XML parser</span>
<a name="l27362"></a>27362         xml_set_element_handler($this-&gt;parser, <span class="stringliteral">&#39;startSVGElementHandler&#39;</span>, <span class="stringliteral">&#39;endSVGElementHandler&#39;</span>);
<a name="l27363"></a>27363         <span class="comment">// sets the character data handler function for the XML parser</span>
<a name="l27364"></a>27364         xml_set_character_data_handler($this-&gt;parser, <span class="stringliteral">&#39;segSVGContentHandler&#39;</span>);
<a name="l27365"></a>27365         <span class="comment">// start parsing an XML document</span>
<a name="l27366"></a>27366         <span class="keywordflow">if</span> (!xml_parse($this-&gt;parser, $svgdata)) {
<a name="l27367"></a>27367             $error_message = sprintf(<span class="stringliteral">&#39;SVG Error: %s at line %d&#39;</span>, xml_error_string(xml_get_error_code($this-&gt;parser)), xml_get_current_line_number($this-&gt;parser));
<a name="l27368"></a>27368             $this-&gt;Error($error_message);
<a name="l27369"></a>27369         }
<a name="l27370"></a>27370         <span class="comment">// free this XML parser</span>
<a name="l27371"></a>27371         xml_parser_free($this-&gt;parser);
<a name="l27372"></a>27372         <span class="comment">// restore previous graphic state</span>
<a name="l27373"></a>27373         $this-&gt;_out($this-&gt;epsmarker.<span class="charliteral">&#39;Q&#39;</span>);
<a name="l27374"></a>27374         <span class="comment">// restore graphic vars</span>
<a name="l27375"></a>27375         $this-&gt;setGraphicVars($gvars);
<a name="l27376"></a>27376         $this-&gt;lasth = $gvars[<span class="stringliteral">&#39;lasth&#39;</span>];
<a name="l27377"></a>27377         <span class="keywordflow">if</span> (!empty($border)) {
<a name="l27378"></a>27378             $bx = $this-&gt;x;
<a name="l27379"></a>27379             $by = $this-&gt;y;
<a name="l27380"></a>27380             $this-&gt;x = $ximg;
<a name="l27381"></a>27381             <span class="keywordflow">if</span> ($this-&gt;rtl) {
<a name="l27382"></a>27382                 $this-&gt;x += <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27383"></a>27383             }
<a name="l27384"></a>27384             $this-&gt;y = $y;
<a name="l27385"></a>27385             $this-&gt;Cell(<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $h, <span class="stringliteral">&#39;&#39;</span>, $border, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>);
<a name="l27386"></a>27386             $this-&gt;x = $bx;
<a name="l27387"></a>27387             $this-&gt;y = $by;
<a name="l27388"></a>27388         }
<a name="l27389"></a>27389         <span class="keywordflow">if</span> ($link) {
<a name="l27390"></a>27390             $this-&gt;Link($ximg, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, $h, $link, 0);
<a name="l27391"></a>27391         }
<a name="l27392"></a>27392         <span class="comment">// set pointer to align the next text/objects</span>
<a name="l27393"></a>27393         <span class="keywordflow">switch</span>($align) {
<a name="l27394"></a>27394             <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:{
<a name="l27395"></a>27395                 $this-&gt;y = $y;
<a name="l27396"></a>27396                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l27397"></a>27397                 <span class="keywordflow">break</span>;
<a name="l27398"></a>27398             }
<a name="l27399"></a>27399             <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:{
<a name="l27400"></a>27400                 $this-&gt;y = $y + round($h/2);
<a name="l27401"></a>27401                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l27402"></a>27402                 <span class="keywordflow">break</span>;
<a name="l27403"></a>27403             }
<a name="l27404"></a>27404             <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:{
<a name="l27405"></a>27405                 $this-&gt;y = $this-&gt;img_rb_y;
<a name="l27406"></a>27406                 $this-&gt;x = $this-&gt;img_rb_x;
<a name="l27407"></a>27407                 <span class="keywordflow">break</span>;
<a name="l27408"></a>27408             }
<a name="l27409"></a>27409             <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:{
<a name="l27410"></a>27410                 $this-&gt;SetY($this-&gt;img_rb_y);
<a name="l27411"></a>27411                 <span class="keywordflow">break</span>;
<a name="l27412"></a>27412             }
<a name="l27413"></a>27413             <span class="keywordflow">default</span>:{
<a name="l27414"></a>27414                 <span class="comment">// restore pointer to starting position</span>
<a name="l27415"></a>27415                 $this-&gt;x = $gvars[<span class="charliteral">&#39;x&#39;</span>];
<a name="l27416"></a>27416                 $this-&gt;y = $gvars[<span class="charliteral">&#39;y&#39;</span>];
<a name="l27417"></a>27417                 $this-&gt;page = $gvars[<span class="stringliteral">&#39;page&#39;</span>];
<a name="l27418"></a>27418                 $this-&gt;current_column = $gvars[<span class="stringliteral">&#39;current_column&#39;</span>];
<a name="l27419"></a>27419                 $this-&gt;tMargin = $gvars[<span class="stringliteral">&#39;tMargin&#39;</span>];
<a name="l27420"></a>27420                 $this-&gt;bMargin = $gvars[<span class="stringliteral">&#39;bMargin&#39;</span>];
<a name="l27421"></a>27421                 $this-&gt;w = $gvars[<span class="charliteral">&#39;w&#39;</span>];
<a name="l27422"></a>27422                 $this-&gt;h = $gvars[<span class="charliteral">&#39;h&#39;</span>];
<a name="l27423"></a>27423                 $this-&gt;wPt = $gvars[<span class="stringliteral">&#39;wPt&#39;</span>];
<a name="l27424"></a>27424                 $this-&gt;hPt = $gvars[<span class="stringliteral">&#39;hPt&#39;</span>];
<a name="l27425"></a>27425                 $this-&gt;fwPt = $gvars[<span class="stringliteral">&#39;fwPt&#39;</span>];
<a name="l27426"></a>27426                 $this-&gt;fhPt = $gvars[<span class="stringliteral">&#39;fhPt&#39;</span>];
<a name="l27427"></a>27427                 <span class="keywordflow">break</span>;
<a name="l27428"></a>27428             }
<a name="l27429"></a>27429         }
<a name="l27430"></a>27430         $this-&gt;endlinex = $this-&gt;img_rb_x;
<a name="l27431"></a>27431         <span class="comment">// restore page break</span>
<a name="l27432"></a>27432         $this-&gt;SetAutoPageBreak($page_break_mode, $page_break_margin);
<a name="l27433"></a>27433         $this-&gt;cell_padding = $cell_padding;
<a name="l27434"></a>27434     }
<a name="l27435"></a>27435 <span class="comment"></span>
<a name="l27436"></a>27436 <span class="comment">    /**</span>
<a name="l27437"></a>27437 <span class="comment">     * Get the tranformation matrix from SVG transform attribute</span>
<a name="l27438"></a>27438 <span class="comment">     * @param $attribute (string) transformation</span>
<a name="l27439"></a>27439 <span class="comment">     * @return array of transformations</span>
<a name="l27440"></a>27440 <span class="comment">     * @author Nicola Asuni</span>
<a name="l27441"></a>27441 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l27442"></a>27442 <span class="comment">     * @protected</span>
<a name="l27443"></a>27443 <span class="comment">     */</span>
<a name="l27444"></a><a class="code" href="classTCPDF.html#a5df0155fd5096c9262232113a46aa78e">27444</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a5df0155fd5096c9262232113a46aa78e" title="Get the tranformation matrix from SVG transform attribute.">getSVGTransformMatrix</a>($attribute) {
<a name="l27445"></a>27445         <span class="comment">// identity matrix</span>
<a name="l27446"></a>27446         $tm = array(1, 0, 0, 1, 0, 0);
<a name="l27447"></a>27447         $transform = array();
<a name="l27448"></a>27448         <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/(matrix|translate|scale|rotate|skewX|skewY)[\s]*\(([^\)]+)\)/si&#39;</span>, $attribute, $transform, PREG_SET_ORDER) &gt; 0) {
<a name="l27449"></a>27449             <span class="keywordflow">foreach</span> ($transform as $key =&gt; <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l27450"></a>27450                 <span class="keywordflow">if</span> (!empty(<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2])) {
<a name="l27451"></a>27451                     $a = 1;
<a name="l27452"></a>27452                     $b = 0;
<a name="l27453"></a>27453                     <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = 0;
<a name="l27454"></a>27454                     $d = 1;
<a name="l27455"></a>27455                     $e = 0;
<a name="l27456"></a>27456                     <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = 0;
<a name="l27457"></a>27457                     $regs = array();
<a name="l27458"></a>27458                     <span class="keywordflow">switch</span> (<a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[1]) {
<a name="l27459"></a>27459                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;matrix&#39;</span>: {
<a name="l27460"></a>27460                             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/([a-z0-9\-\.]+)[\,\s]+([a-z0-9\-\.]+)[\,\s]+([a-z0-9\-\.]+)[\,\s]+([a-z0-9\-\.]+)[\,\s]+([a-z0-9\-\.]+)[\,\s]+([a-z0-9\-\.]+)/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2], $regs)) {
<a name="l27461"></a>27461                                 $a = $regs[1];
<a name="l27462"></a>27462                                 $b = $regs[2];
<a name="l27463"></a>27463                                 <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = $regs[3];
<a name="l27464"></a>27464                                 $d = $regs[4];
<a name="l27465"></a>27465                                 $e = $regs[5];
<a name="l27466"></a>27466                                 <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = $regs[6];
<a name="l27467"></a>27467                             }
<a name="l27468"></a>27468                             <span class="keywordflow">break</span>;
<a name="l27469"></a>27469                         }
<a name="l27470"></a>27470                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;translate&#39;</span>: {
<a name="l27471"></a>27471                             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/([a-z0-9\-\.]+)[\,\s]+([a-z0-9\-\.]+)/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2], $regs)) {
<a name="l27472"></a>27472                                 $e = $regs[1];
<a name="l27473"></a>27473                                 <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = $regs[2];
<a name="l27474"></a>27474                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (preg_match(<span class="stringliteral">&#39;/([a-z0-9\-\.]+)/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2], $regs)) {
<a name="l27475"></a>27475                                 $e = $regs[1];
<a name="l27476"></a>27476                             }
<a name="l27477"></a>27477                             <span class="keywordflow">break</span>;
<a name="l27478"></a>27478                         }
<a name="l27479"></a>27479                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;scale&#39;</span>: {
<a name="l27480"></a>27480                             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/([a-z0-9\-\.]+)[\,\s]+([a-z0-9\-\.]+)/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2], $regs)) {
<a name="l27481"></a>27481                                 $a = $regs[1];
<a name="l27482"></a>27482                                 $d = $regs[2];
<a name="l27483"></a>27483                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (preg_match(<span class="stringliteral">&#39;/([a-z0-9\-\.]+)/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2], $regs)) {
<a name="l27484"></a>27484                                 $a = $regs[1];
<a name="l27485"></a>27485                                 $d = $a;
<a name="l27486"></a>27486                             }
<a name="l27487"></a>27487                             <span class="keywordflow">break</span>;
<a name="l27488"></a>27488                         }
<a name="l27489"></a>27489                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;rotate&#39;</span>: {
<a name="l27490"></a>27490                             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/([0-9\-\.]+)[\,\s]+([a-z0-9\-\.]+)[\,\s]+([a-z0-9\-\.]+)/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2], $regs)) {
<a name="l27491"></a>27491                                 $ang = deg2rad($regs[1]);
<a name="l27492"></a>27492                                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $regs[2];
<a name="l27493"></a>27493                                 $y = $regs[3];
<a name="l27494"></a>27494                                 $a = cos($ang);
<a name="l27495"></a>27495                                 $b = sin($ang);
<a name="l27496"></a>27496                                 <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = -$b;
<a name="l27497"></a>27497                                 $d = $a;
<a name="l27498"></a>27498                                 $e = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * (1 - $a)) - ($y * <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>);
<a name="l27499"></a>27499                                 <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = ($y * (1 - $d)) - (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * $b);
<a name="l27500"></a>27500                             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (preg_match(<span class="stringliteral">&#39;/([0-9\-\.]+)/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2], $regs)) {
<a name="l27501"></a>27501                                 $ang = deg2rad($regs[1]);
<a name="l27502"></a>27502                                 $a = cos($ang);
<a name="l27503"></a>27503                                 $b = sin($ang);
<a name="l27504"></a>27504                                 <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = -$b;
<a name="l27505"></a>27505                                 $d = $a;
<a name="l27506"></a>27506                                 $e = 0;
<a name="l27507"></a>27507                                 <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = 0;
<a name="l27508"></a>27508                             }
<a name="l27509"></a>27509                             <span class="keywordflow">break</span>;
<a name="l27510"></a>27510                         }
<a name="l27511"></a>27511                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;skewX&#39;</span>: {
<a name="l27512"></a>27512                             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/([0-9\-\.]+)/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2], $regs)) {
<a name="l27513"></a>27513                                 <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = tan(deg2rad($regs[1]));
<a name="l27514"></a>27514                             }
<a name="l27515"></a>27515                             <span class="keywordflow">break</span>;
<a name="l27516"></a>27516                         }
<a name="l27517"></a>27517                         <span class="keywordflow">case</span> <span class="stringliteral">&#39;skewY&#39;</span>: {
<a name="l27518"></a>27518                             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/([0-9\-\.]+)/si&#39;</span>, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>[2], $regs)) {
<a name="l27519"></a>27519                                 $b = tan(deg2rad($regs[1]));
<a name="l27520"></a>27520                             }
<a name="l27521"></a>27521                             <span class="keywordflow">break</span>;
<a name="l27522"></a>27522                         }
<a name="l27523"></a>27523                     }
<a name="l27524"></a>27524                     $tm = $this-&gt;getTransformationMatrixProduct($tm, array($a, $b, <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, $d, $e, <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>));
<a name="l27525"></a>27525                 }
<a name="l27526"></a>27526             }
<a name="l27527"></a>27527         }
<a name="l27528"></a>27528         <span class="keywordflow">return</span> $tm;
<a name="l27529"></a>27529     }
<a name="l27530"></a>27530 <span class="comment"></span>
<a name="l27531"></a>27531 <span class="comment">    /**</span>
<a name="l27532"></a>27532 <span class="comment">     * Get the product of two SVG tranformation matrices</span>
<a name="l27533"></a>27533 <span class="comment">     * @param $ta (array) first SVG tranformation matrix</span>
<a name="l27534"></a>27534 <span class="comment">     * @param $tb (array) second SVG tranformation matrix</span>
<a name="l27535"></a>27535 <span class="comment">     * @return transformation array</span>
<a name="l27536"></a>27536 <span class="comment">     * @author Nicola Asuni</span>
<a name="l27537"></a>27537 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l27538"></a>27538 <span class="comment">     * @protected</span>
<a name="l27539"></a>27539 <span class="comment">     */</span>
<a name="l27540"></a><a class="code" href="classTCPDF.html#aeda7a172368ab45f16ca24549b97af11">27540</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aeda7a172368ab45f16ca24549b97af11" title="Get the product of two SVG tranformation matrices.">getTransformationMatrixProduct</a>($ta, $tb) {
<a name="l27541"></a>27541         $tm = array();
<a name="l27542"></a>27542         $tm[0] = ($ta[0] * $tb[0]) + ($ta[2] * $tb[1]);
<a name="l27543"></a>27543         $tm[1] = ($ta[1] * $tb[0]) + ($ta[3] * $tb[1]);
<a name="l27544"></a>27544         $tm[2] = ($ta[0] * $tb[2]) + ($ta[2] * $tb[3]);
<a name="l27545"></a>27545         $tm[3] = ($ta[1] * $tb[2]) + ($ta[3] * $tb[3]);
<a name="l27546"></a>27546         $tm[4] = ($ta[0] * $tb[4]) + ($ta[2] * $tb[5]) + $ta[4];
<a name="l27547"></a>27547         $tm[5] = ($ta[1] * $tb[4]) + ($ta[3] * $tb[5]) + $ta[5];
<a name="l27548"></a>27548         <span class="keywordflow">return</span> $tm;
<a name="l27549"></a>27549     }
<a name="l27550"></a>27550 <span class="comment"></span>
<a name="l27551"></a>27551 <span class="comment">    /**</span>
<a name="l27552"></a>27552 <span class="comment">     * Convert SVG transformation matrix to PDF.</span>
<a name="l27553"></a>27553 <span class="comment">     * @param $tm (array) original SVG transformation matrix</span>
<a name="l27554"></a>27554 <span class="comment">     * @return array transformation matrix</span>
<a name="l27555"></a>27555 <span class="comment">     * @protected</span>
<a name="l27556"></a>27556 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l27557"></a>27557 <span class="comment">     */</span>
<a name="l27558"></a><a class="code" href="classTCPDF.html#ad32b0c0ac023e7b13198f773c848ff2f">27558</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ad32b0c0ac023e7b13198f773c848ff2f" title="Convert SVG transformation matrix to PDF.">convertSVGtMatrix</a>($tm) {
<a name="l27559"></a>27559         $a = $tm[0];
<a name="l27560"></a>27560         $b = -$tm[1];
<a name="l27561"></a>27561         <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a> = -$tm[2];
<a name="l27562"></a>27562         $d = $tm[3];
<a name="l27563"></a>27563         $e = $this-&gt;getHTMLUnitToUnits($tm[4], 1, $this-&gt;svgunit, <span class="keyword">false</span>) * $this-&gt;k;
<a name="l27564"></a>27564         <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = -$this-&gt;getHTMLUnitToUnits($tm[5], 1, $this-&gt;svgunit, <span class="keyword">false</span>) * $this-&gt;k;
<a name="l27565"></a>27565         <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = 0;
<a name="l27566"></a>27566         $y = $this-&gt;h * $this-&gt;k;
<a name="l27567"></a>27567         $e = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * (1 - $a)) - ($y * <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>) + $e;
<a name="l27568"></a>27568         <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a> = ($y * (1 - $d)) - (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> * $b) + <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>;
<a name="l27569"></a>27569         <span class="keywordflow">return</span> array($a, $b, <a class="code" href="sp_8php.html#a26c2f6c0ee7cb69a545305a8949c045c">$c</a>, $d, $e, <a class="code" href="getclasses_8php.html#a23c42e7d231a63025b55e4eb7e3d4c99">$f</a>);
<a name="l27570"></a>27570     }
<a name="l27571"></a>27571 <span class="comment"></span>
<a name="l27572"></a>27572 <span class="comment">    /**</span>
<a name="l27573"></a>27573 <span class="comment">     * Apply SVG graphic transformation matrix.</span>
<a name="l27574"></a>27574 <span class="comment">     * @param $tm (array) original SVG transformation matrix</span>
<a name="l27575"></a>27575 <span class="comment">     * @protected</span>
<a name="l27576"></a>27576 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l27577"></a>27577 <span class="comment">     */</span>
<a name="l27578"></a><a class="code" href="classTCPDF.html#ab7fb524bc243be585ab7fef00b434399">27578</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#ab7fb524bc243be585ab7fef00b434399" title="Apply SVG graphic transformation matrix.">SVGTransform</a>($tm) {
<a name="l27579"></a>27579         $this-&gt;Transform($this-&gt;convertSVGtMatrix($tm));
<a name="l27580"></a>27580     }
<a name="l27581"></a>27581 <span class="comment"></span>
<a name="l27582"></a>27582 <span class="comment">    /**</span>
<a name="l27583"></a>27583 <span class="comment">     * Apply the requested SVG styles (*** TO BE COMPLETED ***)</span>
<a name="l27584"></a>27584 <span class="comment">     * @param $svgstyle (array) array of SVG styles to apply</span>
<a name="l27585"></a>27585 <span class="comment">     * @param $prevsvgstyle (array) array of previous SVG style</span>
<a name="l27586"></a>27586 <span class="comment">     * @param $x (int) X origin of the bounding box</span>
<a name="l27587"></a>27587 <span class="comment">     * @param $y (int) Y origin of the bounding box</span>
<a name="l27588"></a>27588 <span class="comment">     * @param $w (int) width of the bounding box</span>
<a name="l27589"></a>27589 <span class="comment">     * @param $h (int) height of the bounding box</span>
<a name="l27590"></a>27590 <span class="comment">     * @param $clip_function (string) clip function</span>
<a name="l27591"></a>27591 <span class="comment">     * @param $clip_params (array) array of parameters for clipping function</span>
<a name="l27592"></a>27592 <span class="comment">     * @return object style</span>
<a name="l27593"></a>27593 <span class="comment">     * @author Nicola Asuni</span>
<a name="l27594"></a>27594 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l27595"></a>27595 <span class="comment">     * @protected</span>
<a name="l27596"></a>27596 <span class="comment">     */</span>
<a name="l27597"></a><a class="code" href="classTCPDF.html#abb955184ddd592fdfa3c29f4cc34bc69">27597</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#abb955184ddd592fdfa3c29f4cc34bc69" title="Apply the requested SVG styles (*** TO BE COMPLETED ***)">setSVGStyles</a>($svgstyle, $prevsvgstyle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>=0, $y=0, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>=1, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>=1, $clip_function=<span class="stringliteral">&#39;&#39;</span>, $clip_params=array()) {
<a name="l27598"></a>27598         $objstyle = <span class="stringliteral">&#39;&#39;</span>;
<a name="l27599"></a>27599         $minlen = (0.01 / $this-&gt;k); <span class="comment">// minimum acceptable length (3 point)</span>
<a name="l27600"></a>27600         <span class="keywordflow">if</span> (!isset($svgstyle[<span class="stringliteral">&#39;opacity&#39;</span>])) {
<a name="l27601"></a>27601             <span class="keywordflow">return</span> $objstyle;
<a name="l27602"></a>27602         }
<a name="l27603"></a>27603         <span class="comment">// clip-path</span>
<a name="l27604"></a>27604         $regs = array();
<a name="l27605"></a>27605         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/url\([\s]*\#([^\)]*)\)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;clip-path&#39;</span>], $regs)) {
<a name="l27606"></a>27606             $clip_path = $this-&gt;svgclippaths[$regs[1]];
<a name="l27607"></a>27607             <span class="keywordflow">foreach</span> ($clip_path as $cp) {
<a name="l27608"></a>27608                 $this-&gt;startSVGElementHandler(<span class="stringliteral">&#39;clip-path&#39;</span>, $cp[<span class="stringliteral">&#39;name&#39;</span>], $cp[<span class="stringliteral">&#39;attribs&#39;</span>], $cp[<span class="stringliteral">&#39;tm&#39;</span>]);
<a name="l27609"></a>27609             }
<a name="l27610"></a>27610         }
<a name="l27611"></a>27611         <span class="comment">// opacity</span>
<a name="l27612"></a>27612         <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;opacity&#39;</span>] != 1) {
<a name="l27613"></a>27613             $this-&gt;SetAlpha($svgstyle[<span class="stringliteral">&#39;opacity&#39;</span>]);
<a name="l27614"></a>27614         }
<a name="l27615"></a>27615         <span class="comment">// color</span>
<a name="l27616"></a>27616         $fill_color = $this-&gt;convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;color&#39;</span>]);
<a name="l27617"></a>27617         $this-&gt;SetFillColorArray($fill_color);
<a name="l27618"></a>27618         <span class="comment">// text color</span>
<a name="l27619"></a>27619         $text_color = $this-&gt;convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;text-color&#39;</span>]);
<a name="l27620"></a>27620         $this-&gt;SetTextColorArray($text_color);
<a name="l27621"></a>27621         <span class="comment">// clip</span>
<a name="l27622"></a>27622         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/rect\(([a-z0-9\-\.]*)[\s]*([a-z0-9\-\.]*)[\s]*([a-z0-9\-\.]*)[\s]*([a-z0-9\-\.]*)\)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;clip&#39;</span>], $regs)) {
<a name="l27623"></a>27623             $top = (isset($regs[1])?$this-&gt;getHTMLUnitToUnits($regs[1], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l27624"></a>27624             $right = (isset($regs[2])?$this-&gt;getHTMLUnitToUnits($regs[2], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l27625"></a>27625             $bottom = (isset($regs[3])?$this-&gt;getHTMLUnitToUnits($regs[3], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l27626"></a>27626             $left = (isset($regs[4])?$this-&gt;getHTMLUnitToUnits($regs[4], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l27627"></a>27627             $cx = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + $left;
<a name="l27628"></a>27628             $cy = $y + $top;
<a name="l27629"></a>27629             <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a> = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> - $left - $right;
<a name="l27630"></a>27630             <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a> = <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> - $top - $bottom;
<a name="l27631"></a>27631             <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;clip-rule&#39;</span>] == <span class="stringliteral">&#39;evenodd&#39;</span>) {
<a name="l27632"></a>27632                 $clip_rule = <span class="stringliteral">&#39;CNZ&#39;</span>;
<a name="l27633"></a>27633             } <span class="keywordflow">else</span> {
<a name="l27634"></a>27634                 $clip_rule = <span class="stringliteral">&#39;CEO&#39;</span>;
<a name="l27635"></a>27635             }
<a name="l27636"></a>27636             $this-&gt;Rect($cx, $cy, <a class="code" href="dejavusans_8php.html#ac2951b03dbb0317e6c61ec920b7479dc">$cw</a>, <a class="code" href="query_8php.html#a696b903bbc5c02914bdd402e91826eca">$ch</a>, $clip_rule, array(), array());
<a name="l27637"></a>27637         }
<a name="l27638"></a>27638         <span class="comment">// fill</span>
<a name="l27639"></a>27639         $regs = array();
<a name="l27640"></a>27640         <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/url\([\s]*\#([^\)]*)\)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;fill&#39;</span>], $regs)) {
<a name="l27641"></a>27641             <span class="comment">// gradient</span>
<a name="l27642"></a>27642             $gradient = $this-&gt;svggradients[$regs[1]];
<a name="l27643"></a>27643             <span class="keywordflow">if</span> (isset($gradient[<span class="stringliteral">&#39;xref&#39;</span>])) {
<a name="l27644"></a>27644                 <span class="comment">// reference to another gradient definition</span>
<a name="l27645"></a>27645                 $newgradient = $this-&gt;svggradients[$gradient[<span class="stringliteral">&#39;xref&#39;</span>]];
<a name="l27646"></a>27646                 $newgradient[<span class="stringliteral">&#39;coords&#39;</span>] = $gradient[<span class="stringliteral">&#39;coords&#39;</span>];
<a name="l27647"></a>27647                 $newgradient[<span class="stringliteral">&#39;mode&#39;</span>] = $gradient[<span class="stringliteral">&#39;mode&#39;</span>];
<a name="l27648"></a>27648                 $newgradient[<span class="stringliteral">&#39;gradientUnits&#39;</span>] = $gradient[<span class="stringliteral">&#39;gradientUnits&#39;</span>];
<a name="l27649"></a>27649                 <span class="keywordflow">if</span> (isset($gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>])) {
<a name="l27650"></a>27650                     $newgradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>] = $gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>];
<a name="l27651"></a>27651                 }
<a name="l27652"></a>27652                 $gradient = $newgradient;
<a name="l27653"></a>27653             }
<a name="l27654"></a>27654             <span class="comment">//save current Graphic State</span>
<a name="l27655"></a>27655             $this-&gt;_out(<span class="charliteral">&#39;q&#39;</span>);
<a name="l27656"></a>27656             <span class="comment">//set clipping area</span>
<a name="l27657"></a>27657             <span class="keywordflow">if</span> (!empty($clip_function) AND method_exists($this, $clip_function)) {
<a name="l27658"></a>27658                 $bbox = call_user_func_array(array($this, $clip_function), $clip_params);
<a name="l27659"></a>27659                 <span class="keywordflow">if</span> (is_array($bbox) AND (count($bbox) == 4)) {
<a name="l27660"></a>27660                     list(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>) = $bbox;
<a name="l27661"></a>27661                 }
<a name="l27662"></a>27662             }
<a name="l27663"></a>27663             <span class="keywordflow">if</span> ($gradient[<span class="stringliteral">&#39;mode&#39;</span>] == <span class="stringliteral">&#39;measure&#39;</span>) {
<a name="l27664"></a>27664                 <span class="keywordflow">if</span> (isset($gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>]) AND !empty($gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>])) {
<a name="l27665"></a>27665                     $gtm = $gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>];
<a name="l27666"></a>27666                     <span class="comment">// apply transformation matrix</span>
<a name="l27667"></a>27667                     $xa = ($gtm[0] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0]) + ($gtm[2] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1]) + $gtm[4];
<a name="l27668"></a>27668                     $ya = ($gtm[1] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0]) + ($gtm[3] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1]) + $gtm[5];
<a name="l27669"></a>27669                     $xb = ($gtm[0] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2]) + ($gtm[2] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3]) + $gtm[4];
<a name="l27670"></a>27670                     $yb = ($gtm[1] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2]) + ($gtm[3] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3]) + $gtm[5];
<a name="l27671"></a>27671                     <span class="keywordflow">if</span> (isset($gradient[<span class="stringliteral">&#39;coords&#39;</span>][4])) {
<a name="l27672"></a>27672                         $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4] = sqrt(pow(($gtm[0] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4]), 2) + pow(($gtm[1] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4]), 2));
<a name="l27673"></a>27673                     }
<a name="l27674"></a>27674                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] = $xa;
<a name="l27675"></a>27675                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = $ya;
<a name="l27676"></a>27676                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] = $xb;
<a name="l27677"></a>27677                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = $yb;
<a name="l27678"></a>27678                 }
<a name="l27679"></a>27679                 <span class="comment">// convert SVG coordinates to user units</span>
<a name="l27680"></a>27680                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][0], 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27681"></a>27681                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][1], 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27682"></a>27682                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][2], 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27683"></a>27683                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][3], 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27684"></a>27684                 <span class="keywordflow">if</span> (isset($gradient[<span class="stringliteral">&#39;coords&#39;</span>][4])) {
<a name="l27685"></a>27685                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][4], 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27686"></a>27686                 }
<a name="l27687"></a>27687                 <span class="comment">// shift units</span>
<a name="l27688"></a>27688                 <span class="keywordflow">if</span> ($gradient[<span class="stringliteral">&#39;gradientUnits&#39;</span>] == <span class="stringliteral">&#39;objectBoundingBox&#39;</span>) {
<a name="l27689"></a>27689                     <span class="comment">// convert to SVG coordinate system</span>
<a name="l27690"></a>27690                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] += <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l27691"></a>27691                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] += $y;
<a name="l27692"></a>27692                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] += <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l27693"></a>27693                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] += $y;
<a name="l27694"></a>27694                 }
<a name="l27695"></a>27695                 <span class="keywordflow">if</span> (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> &lt;= $minlen) {
<a name="l27696"></a>27696                     <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = $minlen;
<a name="l27697"></a>27697                 }
<a name="l27698"></a>27698                 <span class="keywordflow">if</span> (<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> &lt;= $minlen) {
<a name="l27699"></a>27699                     <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = $minlen;
<a name="l27700"></a>27700                 }
<a name="l27701"></a>27701                 <span class="comment">// calculate percentages</span>
<a name="l27702"></a>27702                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] = ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) / <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27703"></a>27703                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] - $y) / <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l27704"></a>27704                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] = ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) / <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27705"></a>27705                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] - $y) / <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>;
<a name="l27706"></a>27706                 <span class="keywordflow">if</span> (isset($gradient[<span class="stringliteral">&#39;coords&#39;</span>][4])) {
<a name="l27707"></a>27707                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4] /= <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l27708"></a>27708                 }
<a name="l27709"></a>27709             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($gradient[<span class="stringliteral">&#39;mode&#39;</span>] == <span class="stringliteral">&#39;percentage&#39;</span>) {
<a name="l27710"></a>27710                 <span class="keywordflow">foreach</span>($gradient[<span class="stringliteral">&#39;coords&#39;</span>] as $key =&gt; $val) {
<a name="l27711"></a>27711                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][$key] = (intval($val) / 100);
<a name="l27712"></a>27712                 }
<a name="l27713"></a>27713             }
<a name="l27714"></a>27714             <span class="comment">// fix values</span>
<a name="l27715"></a>27715             <span class="keywordflow">foreach</span>($gradient[<span class="stringliteral">&#39;coords&#39;</span>] as $key =&gt; $val) {
<a name="l27716"></a>27716                 <span class="keywordflow">if</span> ($val &lt; 0) {
<a name="l27717"></a>27717                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][$key] = 0;
<a name="l27718"></a>27718                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($val &gt; 1) {
<a name="l27719"></a>27719                     $gradient[<span class="stringliteral">&#39;coords&#39;</span>][$key] = 1;
<a name="l27720"></a>27720                 }
<a name="l27721"></a>27721             }
<a name="l27722"></a>27722             <span class="keywordflow">if</span> (($gradient[<span class="stringliteral">&#39;type&#39;</span>] == 2) AND ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] == $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2]) AND ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] == $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3])) {
<a name="l27723"></a>27723                 <span class="comment">// single color (no shading)</span>
<a name="l27724"></a>27724                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] = 1;
<a name="l27725"></a>27725                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = 0;
<a name="l27726"></a>27726                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] = 0.999;
<a name="l27727"></a>27727                 $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = 0;
<a name="l27728"></a>27728             }
<a name="l27729"></a>27729             <span class="comment">// swap Y coordinates</span>
<a name="l27730"></a>27730             $tmp = $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1];
<a name="l27731"></a>27731             $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3];
<a name="l27732"></a>27732             $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = $tmp;
<a name="l27733"></a>27733             <span class="comment">// set transformation map for gradient</span>
<a name="l27734"></a>27734             <span class="keywordflow">if</span> ($gradient[<span class="stringliteral">&#39;type&#39;</span>] == 3) {
<a name="l27735"></a>27735                 <span class="comment">// gradient is always circular</span>
<a name="l27736"></a>27736                 $cy = $this-&gt;h - $y - ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] * (<a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> + <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>));
<a name="l27737"></a>27737                 $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.3F 0 0 %.3F %.3F %.3F cm&#39;</span>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>*$this-&gt;k, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>*$this-&gt;k, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>*$this-&gt;k, $cy*$this-&gt;k));
<a name="l27738"></a>27738             } <span class="keywordflow">else</span> {
<a name="l27739"></a>27739                 $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%.3F 0 0 %.3F %.3F %.3F cm&#39;</span>, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>*$this-&gt;k, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>*$this-&gt;k, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>*$this-&gt;k, ($this-&gt;h-($y+<a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>))*$this-&gt;k));
<a name="l27740"></a>27740             }
<a name="l27741"></a>27741             <span class="keywordflow">if</span> (count($gradient[<span class="stringliteral">&#39;stops&#39;</span>]) &gt; 1) {
<a name="l27742"></a>27742                 $this-&gt;Gradient($gradient[<span class="stringliteral">&#39;type&#39;</span>], $gradient[<span class="stringliteral">&#39;coords&#39;</span>], $gradient[<span class="stringliteral">&#39;stops&#39;</span>], array(), <span class="keyword">false</span>);
<a name="l27743"></a>27743             }
<a name="l27744"></a>27744         } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($svgstyle[<span class="stringliteral">&#39;fill&#39;</span>] != <span class="stringliteral">&#39;none&#39;</span>) {
<a name="l27745"></a>27745             $fill_color = $this-&gt;convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;fill&#39;</span>]);
<a name="l27746"></a>27746             <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;fill-opacity&#39;</span>] != 1) {
<a name="l27747"></a>27747                 $this-&gt;SetAlpha($svgstyle[<span class="stringliteral">&#39;fill-opacity&#39;</span>]);
<a name="l27748"></a>27748             }
<a name="l27749"></a>27749             $this-&gt;SetFillColorArray($fill_color);
<a name="l27750"></a>27750             <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;fill-rule&#39;</span>] == <span class="stringliteral">&#39;evenodd&#39;</span>) {
<a name="l27751"></a>27751                 $objstyle .= <span class="stringliteral">&#39;F*&#39;</span>;
<a name="l27752"></a>27752             } <span class="keywordflow">else</span> {
<a name="l27753"></a>27753                 $objstyle .= <span class="charliteral">&#39;F&#39;</span>;
<a name="l27754"></a>27754             }
<a name="l27755"></a>27755         }
<a name="l27756"></a>27756         <span class="comment">// stroke</span>
<a name="l27757"></a>27757         <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;stroke&#39;</span>] != <span class="stringliteral">&#39;none&#39;</span>) {
<a name="l27758"></a>27758             $stroke_style = array(
<a name="l27759"></a>27759                 <span class="stringliteral">&#39;color&#39;</span> =&gt; $this-&gt;convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;stroke&#39;</span>]),
<a name="l27760"></a>27760                 <span class="stringliteral">&#39;width&#39;</span> =&gt; $this-&gt;getHTMLUnitToUnits($svgstyle[<span class="stringliteral">&#39;stroke-width&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>),
<a name="l27761"></a>27761                 <span class="stringliteral">&#39;cap&#39;</span> =&gt; $svgstyle[<span class="stringliteral">&#39;stroke-linecap&#39;</span>],
<a name="l27762"></a>27762                 <span class="stringliteral">&#39;join&#39;</span> =&gt; $svgstyle[<span class="stringliteral">&#39;stroke-linejoin&#39;</span>]
<a name="l27763"></a>27763                 );
<a name="l27764"></a>27764             <span class="keywordflow">if</span> (isset($svgstyle[<span class="stringliteral">&#39;stroke-dasharray&#39;</span>]) AND !empty($svgstyle[<span class="stringliteral">&#39;stroke-dasharray&#39;</span>]) AND ($svgstyle[<span class="stringliteral">&#39;stroke-dasharray&#39;</span>] != <span class="stringliteral">&#39;none&#39;</span>)) {
<a name="l27765"></a>27765                 $stroke_style[<span class="stringliteral">&#39;dash&#39;</span>] = $svgstyle[<span class="stringliteral">&#39;stroke-dasharray&#39;</span>];
<a name="l27766"></a>27766             }
<a name="l27767"></a>27767             $this-&gt;SetLineStyle($stroke_style);
<a name="l27768"></a>27768             $objstyle .= <span class="charliteral">&#39;D&#39;</span>;
<a name="l27769"></a>27769         }
<a name="l27770"></a>27770         <span class="comment">// font</span>
<a name="l27771"></a>27771         $regs = array();
<a name="l27772"></a>27772         <span class="keywordflow">if</span> (!empty($svgstyle[<span class="stringliteral">&#39;font&#39;</span>])) {
<a name="l27773"></a>27773             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-family[\s]*:[\s]*([^\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {
<a name="l27774"></a>27774                 $font_family = $this-&gt;getFontFamilyName($regs[1]);
<a name="l27775"></a>27775             } <span class="keywordflow">else</span> {
<a name="l27776"></a>27776                 $font_family = $svgstyle[<span class="stringliteral">&#39;font-family&#39;</span>];
<a name="l27777"></a>27777             }
<a name="l27778"></a>27778             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-size[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {
<a name="l27779"></a>27779                 $font_size = trim($regs[1]);
<a name="l27780"></a>27780             } <span class="keywordflow">else</span> {
<a name="l27781"></a>27781                 $font_size = $svgstyle[<span class="stringliteral">&#39;font-size&#39;</span>];
<a name="l27782"></a>27782             }
<a name="l27783"></a>27783             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-style[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {
<a name="l27784"></a>27784                 $font_style = trim($regs[1]);
<a name="l27785"></a>27785             } <span class="keywordflow">else</span> {
<a name="l27786"></a>27786                 $font_style = $svgstyle[<span class="stringliteral">&#39;font-style&#39;</span>];
<a name="l27787"></a>27787             }
<a name="l27788"></a>27788             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-weight[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {
<a name="l27789"></a>27789                 $font_weight = trim($regs[1]);
<a name="l27790"></a>27790             } <span class="keywordflow">else</span> {
<a name="l27791"></a>27791                 $font_weight = $svgstyle[<span class="stringliteral">&#39;font-weight&#39;</span>];
<a name="l27792"></a>27792             }
<a name="l27793"></a>27793             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-stretch[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {
<a name="l27794"></a>27794                 $font_stretch = trim($regs[1]);
<a name="l27795"></a>27795             } <span class="keywordflow">else</span> {
<a name="l27796"></a>27796                 $font_stretch = $svgstyle[<span class="stringliteral">&#39;font-stretch&#39;</span>];
<a name="l27797"></a>27797             }
<a name="l27798"></a>27798             <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/letter-spacing[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {
<a name="l27799"></a>27799                 $font_spacing = trim($regs[1]);
<a name="l27800"></a>27800             } <span class="keywordflow">else</span> {
<a name="l27801"></a>27801                 $font_spacing = $svgstyle[<span class="stringliteral">&#39;letter-spacing&#39;</span>];
<a name="l27802"></a>27802             }
<a name="l27803"></a>27803         } <span class="keywordflow">else</span> {
<a name="l27804"></a>27804             $font_family = $this-&gt;getFontFamilyName($svgstyle[<span class="stringliteral">&#39;font-family&#39;</span>]);
<a name="l27805"></a>27805             $font_size = $svgstyle[<span class="stringliteral">&#39;font-size&#39;</span>];
<a name="l27806"></a>27806             $font_style = $svgstyle[<span class="stringliteral">&#39;font-style&#39;</span>];
<a name="l27807"></a>27807             $font_weight = $svgstyle[<span class="stringliteral">&#39;font-weight&#39;</span>];
<a name="l27808"></a>27808             $font_stretch = $svgstyle[<span class="stringliteral">&#39;font-stretch&#39;</span>];
<a name="l27809"></a>27809             $font_spacing = $svgstyle[<span class="stringliteral">&#39;letter-spacing&#39;</span>];
<a name="l27810"></a>27810         }
<a name="l27811"></a>27811         $font_size = $this-&gt;getHTMLUnitToUnits($font_size, $prevsvgstyle[<span class="stringliteral">&#39;font-size&#39;</span>], $this-&gt;svgunit, <span class="keyword">false</span>) * $this-&gt;k;
<a name="l27812"></a>27812         $font_stretch = $this-&gt;getCSSFontStretching($font_stretch, $svgstyle[<span class="stringliteral">&#39;font-stretch&#39;</span>]);
<a name="l27813"></a>27813         $font_spacing = $this-&gt;getCSSFontSpacing($font_spacing, $svgstyle[<span class="stringliteral">&#39;letter-spacing&#39;</span>]);
<a name="l27814"></a>27814         <span class="keywordflow">switch</span> ($font_style) {
<a name="l27815"></a>27815             <span class="keywordflow">case</span> <span class="stringliteral">&#39;italic&#39;</span>: {
<a name="l27816"></a>27816                 $font_style = <span class="charliteral">&#39;I&#39;</span>;
<a name="l27817"></a>27817                 <span class="keywordflow">break</span>;
<a name="l27818"></a>27818             }
<a name="l27819"></a>27819             <span class="keywordflow">case</span> <span class="stringliteral">&#39;oblique&#39;</span>: {
<a name="l27820"></a>27820                 $font_style = <span class="charliteral">&#39;I&#39;</span>;
<a name="l27821"></a>27821                 <span class="keywordflow">break</span>;
<a name="l27822"></a>27822             }
<a name="l27823"></a>27823             <span class="keywordflow">default</span>:
<a name="l27824"></a>27824             <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>: {
<a name="l27825"></a>27825                 $font_style = <span class="stringliteral">&#39;&#39;</span>;
<a name="l27826"></a>27826                 <span class="keywordflow">break</span>;
<a name="l27827"></a>27827             }
<a name="l27828"></a>27828         }
<a name="l27829"></a>27829         <span class="keywordflow">switch</span> ($font_weight) {
<a name="l27830"></a>27830             <span class="keywordflow">case</span> <span class="stringliteral">&#39;bold&#39;</span>:
<a name="l27831"></a>27831             <span class="keywordflow">case</span> <span class="stringliteral">&#39;bolder&#39;</span>: {
<a name="l27832"></a>27832                 $font_style .= <span class="charliteral">&#39;B&#39;</span>;
<a name="l27833"></a>27833                 <span class="keywordflow">break</span>;
<a name="l27834"></a>27834             }
<a name="l27835"></a>27835         }
<a name="l27836"></a>27836         <span class="keywordflow">switch</span> ($svgstyle[<span class="stringliteral">&#39;text-decoration&#39;</span>]) {
<a name="l27837"></a>27837             <span class="keywordflow">case</span> <span class="stringliteral">&#39;underline&#39;</span>: {
<a name="l27838"></a>27838                 $font_style .= <span class="charliteral">&#39;U&#39;</span>;
<a name="l27839"></a>27839                 <span class="keywordflow">break</span>;
<a name="l27840"></a>27840             }
<a name="l27841"></a>27841             <span class="keywordflow">case</span> <span class="stringliteral">&#39;overline&#39;</span>: {
<a name="l27842"></a>27842                 $font_style .= <span class="charliteral">&#39;O&#39;</span>;
<a name="l27843"></a>27843                 <span class="keywordflow">break</span>;
<a name="l27844"></a>27844             }
<a name="l27845"></a>27845             <span class="keywordflow">case</span> <span class="stringliteral">&#39;line-through&#39;</span>: {
<a name="l27846"></a>27846                 $font_style .= <span class="charliteral">&#39;D&#39;</span>;
<a name="l27847"></a>27847                 <span class="keywordflow">break</span>;
<a name="l27848"></a>27848             }
<a name="l27849"></a>27849             <span class="keywordflow">default</span>:
<a name="l27850"></a>27850             <span class="keywordflow">case</span> <span class="stringliteral">&#39;none&#39;</span>: {
<a name="l27851"></a>27851                 <span class="keywordflow">break</span>;
<a name="l27852"></a>27852             }
<a name="l27853"></a>27853         }
<a name="l27854"></a>27854         $this-&gt;SetFont($font_family, $font_style, $font_size);
<a name="l27855"></a>27855         $this-&gt;setFontStretching($font_stretch);
<a name="l27856"></a>27856         $this-&gt;setFontSpacing($font_spacing);
<a name="l27857"></a>27857         <span class="keywordflow">return</span> $objstyle;
<a name="l27858"></a>27858     }
<a name="l27859"></a>27859 <span class="comment"></span>
<a name="l27860"></a>27860 <span class="comment">    /**</span>
<a name="l27861"></a>27861 <span class="comment">     * Draws an SVG path</span>
<a name="l27862"></a>27862 <span class="comment">     * @param $d (string) attribute d of the path SVG element</span>
<a name="l27863"></a>27863 <span class="comment">     * @param $style (string) Style of rendering. Possible values are:</span>
<a name="l27864"></a>27864 <span class="comment">     * &lt;ul&gt;</span>
<a name="l27865"></a>27865 <span class="comment">     *   &lt;li&gt;D or empty string: Draw (default).&lt;/li&gt;</span>
<a name="l27866"></a>27866 <span class="comment">     *   &lt;li&gt;F: Fill.&lt;/li&gt;</span>
<a name="l27867"></a>27867 <span class="comment">     *   &lt;li&gt;F*: Fill using the even-odd rule to determine which regions lie inside the clipping path.&lt;/li&gt;</span>
<a name="l27868"></a>27868 <span class="comment">     *   &lt;li&gt;DF or FD: Draw and fill.&lt;/li&gt;</span>
<a name="l27869"></a>27869 <span class="comment">     *   &lt;li&gt;DF* or FD*: Draw and fill using the even-odd rule to determine which regions lie inside the clipping path.&lt;/li&gt;</span>
<a name="l27870"></a>27870 <span class="comment">     *   &lt;li&gt;CNZ: Clipping mode (using the even-odd rule to determine which regions lie inside the clipping path).&lt;/li&gt;</span>
<a name="l27871"></a>27871 <span class="comment">     *   &lt;li&gt;CEO: Clipping mode (using the nonzero winding number rule to determine which regions lie inside the clipping path).&lt;/li&gt;</span>
<a name="l27872"></a>27872 <span class="comment">     * &lt;/ul&gt;</span>
<a name="l27873"></a>27873 <span class="comment">     * @return array of container box measures (x, y, w, h)</span>
<a name="l27874"></a>27874 <span class="comment">     * @author Nicola Asuni</span>
<a name="l27875"></a>27875 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l27876"></a>27876 <span class="comment">     * @protected</span>
<a name="l27877"></a>27877 <span class="comment">     */</span>
<a name="l27878"></a><a class="code" href="classTCPDF.html#af9d7a42a746c972f98d36e6fe7ab8f89">27878</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#af9d7a42a746c972f98d36e6fe7ab8f89" title="Draws an SVG path.">SVGPath</a>($d, $style=<span class="stringliteral">&#39;&#39;</span>) {
<a name="l27879"></a>27879         <span class="comment">// set fill/stroke style</span>
<a name="l27880"></a>27880         $op = $this-&gt;getPathPaintOperator($style, <span class="stringliteral">&#39;&#39;</span>);
<a name="l27881"></a>27881         <span class="keywordflow">if</span> (empty($op)) {
<a name="l27882"></a>27882             <span class="keywordflow">return</span>;
<a name="l27883"></a>27883         }
<a name="l27884"></a>27884         $paths = array();
<a name="l27885"></a>27885         $d = preg_replace(<span class="stringliteral">&#39;/([0-9ACHLMQSTVZ])([\-\+])/si&#39;</span>, <span class="stringliteral">&#39;\\1 \\2&#39;</span>, $d);
<a name="l27886"></a>27886         preg_match_all(<span class="stringliteral">&#39;/([ACHLMQSTVZ])[\s]*([^ACHLMQSTVZ\&quot;]*)/si&#39;</span>, $d, $paths, PREG_SET_ORDER);
<a name="l27887"></a>27887         <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = 0;
<a name="l27888"></a>27888         $y = 0;
<a name="l27889"></a>27889         $x1 = 0;
<a name="l27890"></a>27890         $y1 = 0;
<a name="l27891"></a>27891         $x2 = 0;
<a name="l27892"></a>27892         $y2 = 0;
<a name="l27893"></a>27893         $xmin = 2147483647;
<a name="l27894"></a>27894         $xmax = 0;
<a name="l27895"></a>27895         $ymin = 2147483647;
<a name="l27896"></a>27896         $ymax = 0;
<a name="l27897"></a>27897         $relcoord = <span class="keyword">false</span>;
<a name="l27898"></a>27898         $minlen = (0.01 / $this-&gt;k); <span class="comment">// minimum acceptable length (3 point)</span>
<a name="l27899"></a>27899         $firstcmd = <span class="keyword">true</span>; <span class="comment">// used to print first point</span>
<a name="l27900"></a>27900         <span class="comment">// draw curve pieces</span>
<a name="l27901"></a>27901         <span class="keywordflow">foreach</span> ($paths as $key =&gt; $val) {
<a name="l27902"></a>27902             <span class="comment">// get curve type</span>
<a name="l27903"></a>27903             $cmd = trim($val[1]);
<a name="l27904"></a>27904             <span class="keywordflow">if</span> (strtolower($cmd) == $cmd) {
<a name="l27905"></a>27905                 <span class="comment">// use relative coordinated instead of absolute</span>
<a name="l27906"></a>27906                 $relcoord = <span class="keyword">true</span>;
<a name="l27907"></a>27907                 $xoffset = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l27908"></a>27908                 $yoffset = $y;
<a name="l27909"></a>27909             } <span class="keywordflow">else</span> {
<a name="l27910"></a>27910                 $relcoord = <span class="keyword">false</span>;
<a name="l27911"></a>27911                 $xoffset = 0;
<a name="l27912"></a>27912                 $yoffset = 0;
<a name="l27913"></a>27913             }
<a name="l27914"></a>27914             <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> = array();
<a name="l27915"></a>27915             <span class="keywordflow">if</span> (isset($val[2])) {
<a name="l27916"></a>27916                 <span class="comment">// get curve parameters</span>
<a name="l27917"></a>27917                 $rawparams = preg_split(<span class="stringliteral">&#39;/([\,\s]+)/si&#39;</span>, trim($val[2]));
<a name="l27918"></a>27918                 <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> = array();
<a name="l27919"></a>27919                 <span class="keywordflow">foreach</span> ($rawparams as $ck =&gt; $cp) {
<a name="l27920"></a>27920                     <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[$ck] = $this-&gt;getHTMLUnitToUnits($cp, 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l27921"></a>27921                     <span class="keywordflow">if</span> (abs(<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[$ck]) &lt; $minlen) {
<a name="l27922"></a>27922                         <span class="comment">// aproximate little values to zero</span>
<a name="l27923"></a>27923                         <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[$ck] = 0;
<a name="l27924"></a>27924                     }
<a name="l27925"></a>27925                 }
<a name="l27926"></a>27926             }
<a name="l27927"></a>27927             <span class="comment">// store current origin point</span>
<a name="l27928"></a>27928             $x0 = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l27929"></a>27929             $y0 = $y;
<a name="l27930"></a>27930             <span class="keywordflow">switch</span> (strtoupper($cmd)) {
<a name="l27931"></a>27931                 <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: { <span class="comment">// moveto</span>
<a name="l27932"></a>27932                     <span class="keywordflow">foreach</span> (<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> as $ck =&gt; $cp) {
<a name="l27933"></a>27933                         <span class="keywordflow">if</span> (($ck % 2) == 0) {
<a name="l27934"></a>27934                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $cp + $xoffset;
<a name="l27935"></a>27935                         } <span class="keywordflow">else</span> {
<a name="l27936"></a>27936                             $y = $cp + $yoffset;
<a name="l27937"></a>27937                             <span class="keywordflow">if</span> ($firstcmd OR (abs($x0 - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) &gt;= $minlen) OR (abs($y0 - $y) &gt;= $minlen)) {
<a name="l27938"></a>27938                                 <span class="keywordflow">if</span> ($ck == 1) {
<a name="l27939"></a>27939                                     $this-&gt;_outPoint(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l27940"></a>27940                                     $firstcmd = <span class="keyword">false</span>;
<a name="l27941"></a>27941                                 } <span class="keywordflow">else</span> {
<a name="l27942"></a>27942                                     $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l27943"></a>27943                                 }
<a name="l27944"></a>27944                             }
<a name="l27945"></a>27945                             $xmin = min($xmin, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>);
<a name="l27946"></a>27946                             $ymin = min($ymin, $y);
<a name="l27947"></a>27947                             $xmax = max($xmax, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>);
<a name="l27948"></a>27948                             $ymax = max($ymax, $y);
<a name="l27949"></a>27949                             <span class="keywordflow">if</span> ($relcoord) {
<a name="l27950"></a>27950                                 $xoffset = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l27951"></a>27951                                 $yoffset = $y;
<a name="l27952"></a>27952                             }
<a name="l27953"></a>27953                         }
<a name="l27954"></a>27954                     }
<a name="l27955"></a>27955                     <span class="keywordflow">break</span>;
<a name="l27956"></a>27956                 }
<a name="l27957"></a>27957                 <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: { <span class="comment">// lineto</span>
<a name="l27958"></a>27958                     <span class="keywordflow">foreach</span> (<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> as $ck =&gt; $cp) {
<a name="l27959"></a>27959                         <span class="keywordflow">if</span> (($ck % 2) == 0) {
<a name="l27960"></a>27960                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $cp + $xoffset;
<a name="l27961"></a>27961                         } <span class="keywordflow">else</span> {
<a name="l27962"></a>27962                             $y = $cp + $yoffset;
<a name="l27963"></a>27963                             <span class="keywordflow">if</span> ((abs($x0 - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) &gt;= $minlen) OR (abs($y0 - $y) &gt;= $minlen)) {
<a name="l27964"></a>27964                                 $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l27965"></a>27965                             }
<a name="l27966"></a>27966                             $xmin = min($xmin, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>);
<a name="l27967"></a>27967                             $ymin = min($ymin, $y);
<a name="l27968"></a>27968                             $xmax = max($xmax, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>);
<a name="l27969"></a>27969                             $ymax = max($ymax, $y);
<a name="l27970"></a>27970                             <span class="keywordflow">if</span> ($relcoord) {
<a name="l27971"></a>27971                                 $xoffset = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l27972"></a>27972                                 $yoffset = $y;
<a name="l27973"></a>27973                             }
<a name="l27974"></a>27974                         }
<a name="l27975"></a>27975                     }
<a name="l27976"></a>27976                     <span class="keywordflow">break</span>;
<a name="l27977"></a>27977                 }
<a name="l27978"></a>27978                 <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: { <span class="comment">// horizontal lineto</span>
<a name="l27979"></a>27979                     <span class="keywordflow">foreach</span> (<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> as $ck =&gt; $cp) {
<a name="l27980"></a>27980                         <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $cp + $xoffset;
<a name="l27981"></a>27981                         <span class="keywordflow">if</span> ((abs($x0 - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) &gt;= $minlen) OR (abs($y0 - $y) &gt;= $minlen)) {
<a name="l27982"></a>27982                             $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l27983"></a>27983                         }
<a name="l27984"></a>27984                         $xmin = min($xmin, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>);
<a name="l27985"></a>27985                         $xmax = max($xmax, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>);
<a name="l27986"></a>27986                         <span class="keywordflow">if</span> ($relcoord) {
<a name="l27987"></a>27987                             $xoffset = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l27988"></a>27988                         }
<a name="l27989"></a>27989                     }
<a name="l27990"></a>27990                     <span class="keywordflow">break</span>;
<a name="l27991"></a>27991                 }
<a name="l27992"></a>27992                 <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>: { <span class="comment">// vertical lineto</span>
<a name="l27993"></a>27993                     <span class="keywordflow">foreach</span> (<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> as $ck =&gt; $cp) {
<a name="l27994"></a>27994                         $y = $cp + $yoffset;
<a name="l27995"></a>27995                         <span class="keywordflow">if</span> ((abs($x0 - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) &gt;= $minlen) OR (abs($y0 - $y) &gt;= $minlen)) {
<a name="l27996"></a>27996                             $this-&gt;_outLine(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l27997"></a>27997                         }
<a name="l27998"></a>27998                         $ymin = min($ymin, $y);
<a name="l27999"></a>27999                         $ymax = max($ymax, $y);
<a name="l28000"></a>28000                         <span class="keywordflow">if</span> ($relcoord) {
<a name="l28001"></a>28001                             $yoffset = $y;
<a name="l28002"></a>28002                         }
<a name="l28003"></a>28003                     }
<a name="l28004"></a>28004                     <span class="keywordflow">break</span>;
<a name="l28005"></a>28005                 }
<a name="l28006"></a>28006                 <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: { <span class="comment">// curveto</span>
<a name="l28007"></a>28007                     <span class="keywordflow">foreach</span> (<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> as $ck =&gt; $cp) {
<a name="l28008"></a>28008                         <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[$ck] = $cp;
<a name="l28009"></a>28009                         <span class="keywordflow">if</span> ((($ck + 1) % 6) == 0) {
<a name="l28010"></a>28010                             $x1 = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 5)] + $xoffset;
<a name="l28011"></a>28011                             $y1 = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 4)] + $yoffset;
<a name="l28012"></a>28012                             $x2 = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 3)] + $xoffset;
<a name="l28013"></a>28013                             $y2 = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 2)] + $yoffset;
<a name="l28014"></a>28014                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 1)] + $xoffset;
<a name="l28015"></a>28015                             $y = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck)] + $yoffset;
<a name="l28016"></a>28016                             $this-&gt;_outCurve($x1, $y1, $x2, $y2, $x, $y);
<a name="l28017"></a>28017                             $xmin = min($xmin, $x, $x1, $x2);
<a name="l28018"></a>28018                             $ymin = min($ymin, $y, $y1, $y2);
<a name="l28019"></a>28019                             $xmax = max($xmax, $x, $x1, $x2);
<a name="l28020"></a>28020                             $ymax = max($ymax, $y, $y1, $y2);
<a name="l28021"></a>28021                             <span class="keywordflow">if</span> ($relcoord) {
<a name="l28022"></a>28022                                 $xoffset = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l28023"></a>28023                                 $yoffset = $y;
<a name="l28024"></a>28024                             }
<a name="l28025"></a>28025                         }
<a name="l28026"></a>28026                     }
<a name="l28027"></a>28027                     <span class="keywordflow">break</span>;
<a name="l28028"></a>28028                 }
<a name="l28029"></a>28029                 <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: { <span class="comment">// shorthand/smooth curveto</span>
<a name="l28030"></a>28030                     <span class="keywordflow">foreach</span> (<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> as $ck =&gt; $cp) {
<a name="l28031"></a>28031                         <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[$ck] = $cp;
<a name="l28032"></a>28032                         <span class="keywordflow">if</span> ((($ck + 1) % 4) == 0) {
<a name="l28033"></a>28033                             <span class="keywordflow">if</span> (($key &gt; 0) AND ((strtoupper($paths[($key - 1)][1]) == <span class="charliteral">&#39;C&#39;</span>) OR (strtoupper($paths[($key - 1)][1]) == <span class="charliteral">&#39;S&#39;</span>))) {
<a name="l28034"></a>28034                                 $x1 = (2 * <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) - $x2;
<a name="l28035"></a>28035                                 $y1 = (2 * $y) - $y2;
<a name="l28036"></a>28036                             } <span class="keywordflow">else</span> {
<a name="l28037"></a>28037                                 $x1 = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l28038"></a>28038                                 $y1 = $y;
<a name="l28039"></a>28039                             }
<a name="l28040"></a>28040                             $x2 = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 3)] + $xoffset;
<a name="l28041"></a>28041                             $y2 = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 2)] + $yoffset;
<a name="l28042"></a>28042                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 1)] + $xoffset;
<a name="l28043"></a>28043                             $y = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck)] + $yoffset;
<a name="l28044"></a>28044                             $this-&gt;_outCurve($x1, $y1, $x2, $y2, $x, $y);
<a name="l28045"></a>28045                             $xmin = min($xmin, $x, $x1, $x2);
<a name="l28046"></a>28046                             $ymin = min($ymin, $y, $y1, $y2);
<a name="l28047"></a>28047                             $xmax = max($xmax, $x, $x1, $x2);
<a name="l28048"></a>28048                             $ymax = max($ymax, $y, $y1, $y2);
<a name="l28049"></a>28049                             <span class="keywordflow">if</span> ($relcoord) {
<a name="l28050"></a>28050                                 $xoffset = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l28051"></a>28051                                 $yoffset = $y;
<a name="l28052"></a>28052                             }
<a name="l28053"></a>28053                         }
<a name="l28054"></a>28054                     }
<a name="l28055"></a>28055                     <span class="keywordflow">break</span>;
<a name="l28056"></a>28056                 }
<a name="l28057"></a>28057                 <span class="keywordflow">case</span> <span class="charliteral">&#39;Q&#39;</span>: { <span class="comment">// quadratic Bézier curveto</span>
<a name="l28058"></a>28058                     <span class="keywordflow">foreach</span> (<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> as $ck =&gt; $cp) {
<a name="l28059"></a>28059                         <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[$ck] = $cp;
<a name="l28060"></a>28060                         <span class="keywordflow">if</span> ((($ck + 1) % 4) == 0) {
<a name="l28061"></a>28061                             <span class="comment">// convert quadratic points to cubic points</span>
<a name="l28062"></a>28062                             $x1 = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 3)] + $xoffset;
<a name="l28063"></a>28063                             $y1 = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 2)] + $yoffset;
<a name="l28064"></a>28064                             $xa = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + (2 * $x1)) / 3;
<a name="l28065"></a>28065                             $ya = ($y + (2 * $y1)) / 3;
<a name="l28066"></a>28066                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 1)] + $xoffset;
<a name="l28067"></a>28067                             $y = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck)] + $yoffset;
<a name="l28068"></a>28068                             $xb = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + (2 * $x1)) / 3;
<a name="l28069"></a>28069                             $yb = ($y + (2 * $y1)) / 3;
<a name="l28070"></a>28070                             $this-&gt;_outCurve($xa, $ya, $xb, $yb, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l28071"></a>28071                             $xmin = min($xmin, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $xa, $xb);
<a name="l28072"></a>28072                             $ymin = min($ymin, $y, $ya, $yb);
<a name="l28073"></a>28073                             $xmax = max($xmax, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $xa, $xb);
<a name="l28074"></a>28074                             $ymax = max($ymax, $y, $ya, $yb);
<a name="l28075"></a>28075                             <span class="keywordflow">if</span> ($relcoord) {
<a name="l28076"></a>28076                                 $xoffset = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l28077"></a>28077                                 $yoffset = $y;
<a name="l28078"></a>28078                             }
<a name="l28079"></a>28079                         }
<a name="l28080"></a>28080                     }
<a name="l28081"></a>28081                     <span class="keywordflow">break</span>;
<a name="l28082"></a>28082                 }
<a name="l28083"></a>28083                 <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: { <span class="comment">// shorthand/smooth quadratic Bézier curveto</span>
<a name="l28084"></a>28084                     <span class="keywordflow">foreach</span> (<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> as $ck =&gt; $cp) {
<a name="l28085"></a>28085                         <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[$ck] = $cp;
<a name="l28086"></a>28086                         <span class="keywordflow">if</span> (($ck % 2) != 0) {
<a name="l28087"></a>28087                             <span class="keywordflow">if</span> (($key &gt; 0) AND ((strtoupper($paths[($key - 1)][1]) == <span class="charliteral">&#39;Q&#39;</span>) OR (strtoupper($paths[($key - 1)][1]) == <span class="charliteral">&#39;T&#39;</span>))) {
<a name="l28088"></a>28088                                 $x1 = (2 * <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) - $x1;
<a name="l28089"></a>28089                                 $y1 = (2 * $y) - $y1;
<a name="l28090"></a>28090                             } <span class="keywordflow">else</span> {
<a name="l28091"></a>28091                                 $x1 = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l28092"></a>28092                                 $y1 = $y;
<a name="l28093"></a>28093                             }
<a name="l28094"></a>28094                             <span class="comment">// convert quadratic points to cubic points</span>
<a name="l28095"></a>28095                             $xa = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + (2 * $x1)) / 3;
<a name="l28096"></a>28096                             $ya = ($y + (2 * $y1)) / 3;
<a name="l28097"></a>28097                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 1)] + $xoffset;
<a name="l28098"></a>28098                             $y = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck)] + $yoffset;
<a name="l28099"></a>28099                             $xb = (<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> + (2 * $x1)) / 3;
<a name="l28100"></a>28100                             $yb = ($y + (2 * $y1)) / 3;
<a name="l28101"></a>28101                             $this-&gt;_outCurve($xa, $ya, $xb, $yb, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y);
<a name="l28102"></a>28102                             $xmin = min($xmin, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $xa, $xb);
<a name="l28103"></a>28103                             $ymin = min($ymin, $y, $ya, $yb);
<a name="l28104"></a>28104                             $xmax = max($xmax, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $xa, $xb);
<a name="l28105"></a>28105                             $ymax = max($ymax, $y, $ya, $yb);
<a name="l28106"></a>28106                             <span class="keywordflow">if</span> ($relcoord) {
<a name="l28107"></a>28107                                 $xoffset = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l28108"></a>28108                                 $yoffset = $y;
<a name="l28109"></a>28109                             }
<a name="l28110"></a>28110                         }
<a name="l28111"></a>28111                     }
<a name="l28112"></a>28112                     <span class="keywordflow">break</span>;
<a name="l28113"></a>28113                 }
<a name="l28114"></a>28114                 <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: { <span class="comment">// elliptical arc</span>
<a name="l28115"></a>28115                     <span class="keywordflow">foreach</span> (<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a> as $ck =&gt; $cp) {
<a name="l28116"></a>28116                         <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[$ck] = $cp;
<a name="l28117"></a>28117                         <span class="keywordflow">if</span> ((($ck + 1) % 7) == 0) {
<a name="l28118"></a>28118                             $x0 = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l28119"></a>28119                             $y0 = $y;
<a name="l28120"></a>28120                             $rx = abs(<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 6)]);
<a name="l28121"></a>28121                             $ry = abs(<a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 5)]);
<a name="l28122"></a>28122                             $ang = -$rawparams[($ck - 4)];
<a name="l28123"></a>28123                             $angle = deg2rad($ang);
<a name="l28124"></a>28124                             $fa = $rawparams[($ck - 3)]; <span class="comment">// large-arc-flag</span>
<a name="l28125"></a>28125                             $fs = $rawparams[($ck - 2)]; <span class="comment">// sweep-flag</span>
<a name="l28126"></a>28126                             <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[($ck - 1)] + $xoffset;
<a name="l28127"></a>28127                             $y = <a class="code" href="header__scripts_8inc_8php.html#afe68e6fbe7acfbffc0af0c84a1996466">$params</a>[$ck] + $yoffset;
<a name="l28128"></a>28128                             <span class="keywordflow">if</span> ((abs($x0 - $x) &lt; $minlen) AND (abs($y0 - $y) &lt; $minlen)) {
<a name="l28129"></a>28129                                 <span class="comment">// endpoints are almost identical</span>
<a name="l28130"></a>28130                                 $xmin = min($xmin, $x);
<a name="l28131"></a>28131                                 $ymin = min($ymin, $y);
<a name="l28132"></a>28132                                 $xmax = max($xmax, $x);
<a name="l28133"></a>28133                                 $ymax = max($ymax, $y);
<a name="l28134"></a>28134                             } <span class="keywordflow">else</span> {
<a name="l28135"></a>28135                                 $cos_ang = cos($angle);
<a name="l28136"></a>28136                                 $sin_ang = sin($angle);
<a name="l28137"></a>28137                                 $a = (($x0 - <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) / 2);
<a name="l28138"></a>28138                                 $b = (($y0 - $y) / 2);
<a name="l28139"></a>28139                                 $xa = ($a * $cos_ang) - ($b * $sin_ang);
<a name="l28140"></a>28140                                 $ya = ($a * $sin_ang) + ($b * $cos_ang);
<a name="l28141"></a>28141                                 $rx2 = $rx * $rx;
<a name="l28142"></a>28142                                 $ry2 = $ry * $ry;
<a name="l28143"></a>28143                                 $xa2 = $xa * $xa;
<a name="l28144"></a>28144                                 $ya2 = $ya * $ya;
<a name="l28145"></a>28145                                 $delta = ($xa2 / $rx2) + ($ya2 / $ry2);
<a name="l28146"></a>28146                                 <span class="keywordflow">if</span> ($delta &gt; 1) {
<a name="l28147"></a>28147                                     $rx *= sqrt($delta);
<a name="l28148"></a>28148                                     $ry *= sqrt($delta);
<a name="l28149"></a>28149                                     $rx2 = $rx * $rx;
<a name="l28150"></a>28150                                     $ry2 = $ry * $ry;
<a name="l28151"></a>28151                                 }
<a name="l28152"></a>28152                                 $numerator = (($rx2 * $ry2) - ($rx2 * $ya2) - ($ry2 * $xa2));
<a name="l28153"></a>28153                                 <span class="keywordflow">if</span> ($numerator &lt; 0) {
<a name="l28154"></a>28154                                     $root = 0;
<a name="l28155"></a>28155                                 } <span class="keywordflow">else</span> {
<a name="l28156"></a>28156                                     $root = sqrt($numerator / (($rx2 * $ya2) + ($ry2 * $xa2)));
<a name="l28157"></a>28157                                 }
<a name="l28158"></a>28158                                 <span class="keywordflow">if</span> ($fa == $fs){
<a name="l28159"></a>28159                                     $root *= -1;
<a name="l28160"></a>28160                                 }
<a name="l28161"></a>28161                                 $cax = $root * (($rx * $ya) / $ry);
<a name="l28162"></a>28162                                 $cay = -$root * (($ry * $xa) / $rx);
<a name="l28163"></a>28163                                 <span class="comment">// coordinates of ellipse center</span>
<a name="l28164"></a>28164                                 $cx = ($cax * $cos_ang) - ($cay * $sin_ang) + (($x0 + <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>) / 2);
<a name="l28165"></a>28165                                 $cy = ($cax * $sin_ang) + ($cay * $cos_ang) + (($y0 + $y) / 2);
<a name="l28166"></a>28166                                 <span class="comment">// get angles</span>
<a name="l28167"></a>28167                                 $angs = $this-&gt;getVectorsAngle(1, 0, (($xa - $cax) / $rx), (($cay - $ya) / $ry));
<a name="l28168"></a>28168                                 $dang = $this-&gt;getVectorsAngle((($xa - $cax) / $rx), (($ya - $cay) / $ry), ((-$xa - $cax) / $rx), ((-$ya - $cay) / $ry));
<a name="l28169"></a>28169                                 <span class="keywordflow">if</span> (($fs == 0) AND ($dang &gt; 0)) {
<a name="l28170"></a>28170                                     $dang -= (2 * M_PI);
<a name="l28171"></a>28171                                 } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (($fs == 1) AND ($dang &lt; 0)) {
<a name="l28172"></a>28172                                     $dang += (2 * M_PI);
<a name="l28173"></a>28173                                 }
<a name="l28174"></a>28174                                 $angf = $angs - $dang;
<a name="l28175"></a>28175                                 <span class="keywordflow">if</span> ((($fs == 0) AND ($angs &gt; $angf)) OR (($fs == 1) AND ($angs &lt; $angf))) {
<a name="l28176"></a>28176                                     <span class="comment">// reverse angles</span>
<a name="l28177"></a>28177                                     $tmp = $angs;
<a name="l28178"></a>28178                                     $angs = $angf;
<a name="l28179"></a>28179                                     $angf = $tmp;
<a name="l28180"></a>28180                                 }
<a name="l28181"></a>28181                                 $angs = round(rad2deg($angs), 6);
<a name="l28182"></a>28182                                 $angf = round(rad2deg($angf), 6);
<a name="l28183"></a>28183                                 <span class="comment">// covent angles to positive values</span>
<a name="l28184"></a>28184                                 <span class="keywordflow">if</span> (($angs &lt; 0) AND ($angf &lt; 0)) {
<a name="l28185"></a>28185                                     $angs += 360;
<a name="l28186"></a>28186                                     $angf += 360;
<a name="l28187"></a>28187                                 }
<a name="l28188"></a>28188                                 $pie = <span class="keyword">false</span>;
<a name="l28189"></a>28189                                 <span class="keywordflow">if</span> (($key == 0) AND (isset($paths[($key + 1)][1])) AND (trim($paths[($key + 1)][1]) == <span class="charliteral">&#39;z&#39;</span>)) {
<a name="l28190"></a>28190                                     $pie = <span class="keyword">true</span>;
<a name="l28191"></a>28191                                 }
<a name="l28192"></a>28192                                 list($axmin, $aymin, $axmax, $aymax) = $this-&gt;_outellipticalarc($cx, $cy, $rx, $ry, $ang, $angs, $angf, $pie, 2, <span class="keyword">false</span>, ($fs == 0), <span class="keyword">true</span>);
<a name="l28193"></a>28193                                 $xmin = min($xmin, $x, $axmin);
<a name="l28194"></a>28194                                 $ymin = min($ymin, $y, $aymin);
<a name="l28195"></a>28195                                 $xmax = max($xmax, $x, $axmax);
<a name="l28196"></a>28196                                 $ymax = max($ymax, $y, $aymax);
<a name="l28197"></a>28197                             }
<a name="l28198"></a>28198                             <span class="keywordflow">if</span> ($relcoord) {
<a name="l28199"></a>28199                                 $xoffset = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l28200"></a>28200                                 $yoffset = $y;
<a name="l28201"></a>28201                             }
<a name="l28202"></a>28202                         }
<a name="l28203"></a>28203                     }
<a name="l28204"></a>28204                     <span class="keywordflow">break</span>;
<a name="l28205"></a>28205                 }
<a name="l28206"></a>28206                 <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>: {
<a name="l28207"></a>28207                     $this-&gt;_out(<span class="charliteral">&#39;h&#39;</span>);
<a name="l28208"></a>28208                     <span class="keywordflow">break</span>;
<a name="l28209"></a>28209                 }
<a name="l28210"></a>28210             }
<a name="l28211"></a>28211             $firstcmd = <span class="keyword">false</span>;
<a name="l28212"></a>28212         } <span class="comment">// end foreach</span>
<a name="l28213"></a>28213         <span class="keywordflow">if</span> (!empty($op)) {
<a name="l28214"></a>28214             $this-&gt;_out($op);
<a name="l28215"></a>28215         }
<a name="l28216"></a>28216         <span class="keywordflow">return</span> array($xmin, $ymin, ($xmax - $xmin), ($ymax - $ymin));
<a name="l28217"></a>28217     }
<a name="l28218"></a>28218 <span class="comment"></span>
<a name="l28219"></a>28219 <span class="comment">    /**</span>
<a name="l28220"></a>28220 <span class="comment">     * Returns the angle in radiants between two vectors</span>
<a name="l28221"></a>28221 <span class="comment">     * @param $x1 (int) X coordinate of first vector point</span>
<a name="l28222"></a>28222 <span class="comment">     * @param $y1 (int) Y coordinate of first vector point</span>
<a name="l28223"></a>28223 <span class="comment">     * @param $x2 (int) X coordinate of second vector point</span>
<a name="l28224"></a>28224 <span class="comment">     * @param $y2 (int) Y coordinate of second vector point</span>
<a name="l28225"></a>28225 <span class="comment">     * @author Nicola Asuni</span>
<a name="l28226"></a>28226 <span class="comment">     * @since 5.0.000 (2010-05-04)</span>
<a name="l28227"></a>28227 <span class="comment">     * @protected</span>
<a name="l28228"></a>28228 <span class="comment">     */</span>
<a name="l28229"></a><a class="code" href="classTCPDF.html#aa071f5481a3f10cf0290065f9e57d9ef">28229</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#aa071f5481a3f10cf0290065f9e57d9ef" title="Returns the angle in radiants between two vectors.">getVectorsAngle</a>($x1, $y1, $x2, $y2) {
<a name="l28230"></a>28230         $dprod = ($x1 * $x2) + ($y1 * $y2);
<a name="l28231"></a>28231         $dist1 = sqrt(($x1 * $x1) + ($y1 * $y1));
<a name="l28232"></a>28232         $dist2 = sqrt(($x2 * $x2) + ($y2 * $y2));
<a name="l28233"></a>28233         $angle = acos($dprod / ($dist1 * $dist2));
<a name="l28234"></a>28234         <span class="keywordflow">if</span> (is_nan($angle)) {
<a name="l28235"></a>28235             $angle = M_PI;
<a name="l28236"></a>28236         }
<a name="l28237"></a>28237         <span class="keywordflow">if</span> ((($x1 * $y2) - ($x2 * $y1)) &lt; 0) {
<a name="l28238"></a>28238             $angle *= -1;
<a name="l28239"></a>28239         }
<a name="l28240"></a>28240         <span class="keywordflow">return</span> $angle;
<a name="l28241"></a>28241     }
<a name="l28242"></a>28242 <span class="comment"></span>
<a name="l28243"></a>28243 <span class="comment">    /**</span>
<a name="l28244"></a>28244 <span class="comment">     * Sets the opening SVG element handler function for the XML parser. (*** TO BE COMPLETED ***)</span>
<a name="l28245"></a>28245 <span class="comment">     * @param $parser (resource) The first parameter, parser, is a reference to the XML parser calling the handler.</span>
<a name="l28246"></a>28246 <span class="comment">     * @param $name (string) The second parameter, name, contains the name of the element for which this handler is called. If case-folding is in effect for this parser, the element name will be in uppercase letters.</span>
<a name="l28247"></a>28247 <span class="comment">     * @param $attribs (array) The third parameter, attribs, contains an associative array with the element&#39;s attributes (if any). The keys of this array are the attribute names, the values are the attribute values. Attribute names are case-folded on the same criteria as element names. Attribute values are not case-folded. The original order of the attributes can be retrieved by walking through attribs the normal way, using each(). The first key in the array was the first attribute, and so on.</span>
<a name="l28248"></a>28248 <span class="comment">     * @param $ctm (array) tranformation matrix for clipping mode (starting transformation matrix).</span>
<a name="l28249"></a>28249 <span class="comment">     * @author Nicola Asuni</span>
<a name="l28250"></a>28250 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l28251"></a>28251 <span class="comment">     * @protected</span>
<a name="l28252"></a>28252 <span class="comment">     */</span>
<a name="l28253"></a><a class="code" href="classTCPDF.html#a4de2d0545b1b22645043fd6656248144">28253</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a4de2d0545b1b22645043fd6656248144" title="Sets the opening SVG element handler function for the XML parser.">startSVGElementHandler</a>($parser, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, $attribs, $ctm=array()) {
<a name="l28254"></a>28254         <span class="comment">// check if we are in clip mode</span>
<a name="l28255"></a>28255         <span class="keywordflow">if</span> ($this-&gt;svgclipmode) {
<a name="l28256"></a>28256             $this-&gt;svgclippaths[$this-&gt;svgclipid][] = array(<span class="stringliteral">&#39;name&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <span class="stringliteral">&#39;attribs&#39;</span> =&gt; $attribs, <span class="stringliteral">&#39;tm&#39;</span> =&gt; $this-&gt;svgcliptm[$this-&gt;svgclipid]);
<a name="l28257"></a>28257             <span class="keywordflow">return</span>;
<a name="l28258"></a>28258         }
<a name="l28259"></a>28259         <span class="keywordflow">if</span> ($this-&gt;svgdefsmode AND !in_array(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, array(<span class="stringliteral">&#39;clipPath&#39;</span>, <span class="stringliteral">&#39;linearGradient&#39;</span>, <span class="stringliteral">&#39;radialGradient&#39;</span>, <span class="stringliteral">&#39;stop&#39;</span>))) {
<a name="l28260"></a>28260             <span class="keywordflow">if</span> (!isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {
<a name="l28261"></a>28261                 $attribs[<span class="stringliteral">&#39;id&#39;</span>] = <span class="stringliteral">&#39;DF_&#39;</span>.(count($this-&gt;svgdefs) + 1);
<a name="l28262"></a>28262             }
<a name="l28263"></a>28263             $this-&gt;svgdefs[$attribs[<span class="stringliteral">&#39;id&#39;</span>]] = array(<span class="stringliteral">&#39;name&#39;</span> =&gt; <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>, <span class="stringliteral">&#39;attribs&#39;</span> =&gt; $attribs);
<a name="l28264"></a>28264             <span class="keywordflow">return</span>;
<a name="l28265"></a>28265         }
<a name="l28266"></a>28266         $clipping = <span class="keyword">false</span>;
<a name="l28267"></a>28267         <span class="keywordflow">if</span> ($parser == <span class="stringliteral">&#39;clip-path&#39;</span>) {
<a name="l28268"></a>28268             <span class="comment">// set clipping mode</span>
<a name="l28269"></a>28269             $clipping = <span class="keyword">true</span>;
<a name="l28270"></a>28270         }
<a name="l28271"></a>28271         <span class="comment">// get styling properties</span>
<a name="l28272"></a>28272         $prev_svgstyle = $this-&gt;svgstyles[(count($this-&gt;svgstyles) - 1)]; <span class="comment">// previous style</span>
<a name="l28273"></a>28273         $svgstyle = $this-&gt;svgstyles[0]; <span class="comment">// set default style</span>
<a name="l28274"></a>28274         <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;style&#39;</span>]) AND !$this-&gt;empty_string($attribs[<span class="stringliteral">&#39;style&#39;</span>])) {
<a name="l28275"></a>28275             <span class="comment">// fix style for regular expression</span>
<a name="l28276"></a>28276             $attribs[<span class="stringliteral">&#39;style&#39;</span>] = <span class="charliteral">&#39;;&#39;</span>.$attribs[<span class="stringliteral">&#39;style&#39;</span>];
<a name="l28277"></a>28277         }
<a name="l28278"></a>28278         <span class="keywordflow">foreach</span> ($prev_svgstyle as $key =&gt; $val) {
<a name="l28279"></a>28279             <span class="keywordflow">if</span> (in_array($key, $this-&gt;svginheritprop)) {
<a name="l28280"></a>28280                 <span class="comment">// inherit previous value</span>
<a name="l28281"></a>28281                 $svgstyle[$key] = $val;
<a name="l28282"></a>28282             }
<a name="l28283"></a>28283             <span class="keywordflow">if</span> (isset($attribs[$key]) AND !$this-&gt;empty_string($attribs[$key])) {
<a name="l28284"></a>28284                 <span class="comment">// specific attribute settings</span>
<a name="l28285"></a>28285                 <span class="keywordflow">if</span> ($attribs[$key] == <span class="stringliteral">&#39;inherit&#39;</span>) {
<a name="l28286"></a>28286                     $svgstyle[$key] = $val;
<a name="l28287"></a>28287                 } <span class="keywordflow">else</span> {
<a name="l28288"></a>28288                     $svgstyle[$key] = $attribs[$key];
<a name="l28289"></a>28289                 }
<a name="l28290"></a>28290             } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> (isset($attribs[<span class="stringliteral">&#39;style&#39;</span>]) AND !$this-&gt;empty_string($attribs[<span class="stringliteral">&#39;style&#39;</span>])) {
<a name="l28291"></a>28291                 <span class="comment">// CSS style syntax</span>
<a name="l28292"></a>28292                 $attrval = array();
<a name="l28293"></a>28293                 <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[;\&quot;\s]{1}&#39;</span>.$key.<span class="stringliteral">&#39;[\s]*:[\s]*([^;\&quot;]*)/si&#39;</span>, $attribs[<span class="stringliteral">&#39;style&#39;</span>], $attrval) AND isset($attrval[1])) {
<a name="l28294"></a>28294                     <span class="keywordflow">if</span> ($attrval[1] == <span class="stringliteral">&#39;inherit&#39;</span>) {
<a name="l28295"></a>28295                         $svgstyle[$key] = $val;
<a name="l28296"></a>28296                     } <span class="keywordflow">else</span> {
<a name="l28297"></a>28297                         $svgstyle[$key] = $attrval[1];
<a name="l28298"></a>28298                     }
<a name="l28299"></a>28299                 }
<a name="l28300"></a>28300             }
<a name="l28301"></a>28301         }
<a name="l28302"></a>28302         <span class="comment">// transformation matrix</span>
<a name="l28303"></a>28303         <span class="keywordflow">if</span> (!empty($ctm)) {
<a name="l28304"></a>28304             $tm = $ctm;
<a name="l28305"></a>28305         } <span class="keywordflow">else</span> {
<a name="l28306"></a>28306             $tm = $this-&gt;svgstyles[(count($this-&gt;svgstyles) - 1)][<span class="stringliteral">&#39;transfmatrix&#39;</span>];
<a name="l28307"></a>28307         }
<a name="l28308"></a>28308         <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;transform&#39;</span>]) AND !empty($attribs[<span class="stringliteral">&#39;transform&#39;</span>])) {
<a name="l28309"></a>28309             $tm = $this-&gt;getTransformationMatrixProduct($tm, $this-&gt;getSVGTransformMatrix($attribs[<span class="stringliteral">&#39;transform&#39;</span>]));
<a name="l28310"></a>28310         }
<a name="l28311"></a>28311         $svgstyle[<span class="stringliteral">&#39;transfmatrix&#39;</span>] = $tm;
<a name="l28312"></a>28312         $invisible = <span class="keyword">false</span>;
<a name="l28313"></a>28313         <span class="keywordflow">if</span> (($svgstyle[<span class="stringliteral">&#39;visibility&#39;</span>] == <span class="stringliteral">&#39;hidden&#39;</span>) OR ($svgstyle[<span class="stringliteral">&#39;visibility&#39;</span>] == <span class="stringliteral">&#39;collapse&#39;</span>) OR ($svgstyle[<span class="stringliteral">&#39;display&#39;</span>] == <span class="stringliteral">&#39;none&#39;</span>)) {
<a name="l28314"></a>28314             <span class="comment">// the current graphics element is invisible (nothing is painted)</span>
<a name="l28315"></a>28315             $invisible = <span class="keyword">true</span>;
<a name="l28316"></a>28316         }
<a name="l28317"></a>28317         <span class="comment">// process tag</span>
<a name="l28318"></a>28318         <span class="keywordflow">switch</span>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) {
<a name="l28319"></a>28319             <span class="keywordflow">case</span> <span class="stringliteral">&#39;defs&#39;</span>: {
<a name="l28320"></a>28320                 $this-&gt;svgdefsmode = <span class="keyword">true</span>;
<a name="l28321"></a>28321                 <span class="keywordflow">break</span>;
<a name="l28322"></a>28322             }
<a name="l28323"></a>28323             <span class="comment">// clipPath</span>
<a name="l28324"></a>28324             <span class="keywordflow">case</span> <span class="stringliteral">&#39;clipPath&#39;</span>: {
<a name="l28325"></a>28325                 <span class="keywordflow">if</span> ($invisible) {
<a name="l28326"></a>28326                     <span class="keywordflow">break</span>;
<a name="l28327"></a>28327                 }
<a name="l28328"></a>28328                 $this-&gt;svgclipmode = <span class="keyword">true</span>;
<a name="l28329"></a>28329                 <span class="keywordflow">if</span> (!isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {
<a name="l28330"></a>28330                     $attribs[<span class="stringliteral">&#39;id&#39;</span>] = <span class="stringliteral">&#39;CP_&#39;</span>.(count($this-&gt;svgcliptm) + 1);
<a name="l28331"></a>28331                 }
<a name="l28332"></a>28332                 $this-&gt;svgclipid = $attribs[<span class="stringliteral">&#39;id&#39;</span>];
<a name="l28333"></a>28333                 $this-&gt;svgclippaths[$this-&gt;svgclipid] = array();
<a name="l28334"></a>28334                 $this-&gt;svgcliptm[$this-&gt;svgclipid] = $tm;
<a name="l28335"></a>28335                 <span class="keywordflow">break</span>;
<a name="l28336"></a>28336             }
<a name="l28337"></a>28337             <span class="keywordflow">case</span> <span class="stringliteral">&#39;svg&#39;</span>: {
<a name="l28338"></a>28338                 <span class="comment">// start of SVG object</span>
<a name="l28339"></a>28339                 <span class="keywordflow">break</span>;
<a name="l28340"></a>28340             }
<a name="l28341"></a>28341             <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>: {
<a name="l28342"></a>28342                 <span class="comment">// group together related graphics elements</span>
<a name="l28343"></a>28343                 array_push($this-&gt;svgstyles, $svgstyle);
<a name="l28344"></a>28344                 $this-&gt;StartTransform();
<a name="l28345"></a>28345                 $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle);
<a name="l28346"></a>28346                 <span class="keywordflow">break</span>;
<a name="l28347"></a>28347             }
<a name="l28348"></a>28348             <span class="keywordflow">case</span> <span class="stringliteral">&#39;linearGradient&#39;</span>: {
<a name="l28349"></a>28349                 <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l28350"></a>28350                     <span class="keywordflow">break</span>;
<a name="l28351"></a>28351                 }
<a name="l28352"></a>28352                 <span class="keywordflow">if</span> (!isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {
<a name="l28353"></a>28353                     $attribs[<span class="stringliteral">&#39;id&#39;</span>] = <span class="stringliteral">&#39;GR_&#39;</span>.(count($this-&gt;svggradients) + 1);
<a name="l28354"></a>28354                 }
<a name="l28355"></a>28355                 $this-&gt;svggradientid = $attribs[<span class="stringliteral">&#39;id&#39;</span>];
<a name="l28356"></a>28356                 $this-&gt;svggradients[$this-&gt;svggradientid] = array();
<a name="l28357"></a>28357                 $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;type&#39;</span>] = 2;
<a name="l28358"></a>28358                 $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;stops&#39;</span>] = array();
<a name="l28359"></a>28359                 <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;gradientUnits&#39;</span>])) {
<a name="l28360"></a>28360                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientUnits&#39;</span>] = $attribs[<span class="stringliteral">&#39;gradientUnits&#39;</span>];
<a name="l28361"></a>28361                 } <span class="keywordflow">else</span> {
<a name="l28362"></a>28362                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientUnits&#39;</span>] = <span class="stringliteral">&#39;objectBoundingBox&#39;</span>;
<a name="l28363"></a>28363                 }
<a name="l28364"></a>28364                 <span class="comment">//$attribs[&#39;spreadMethod&#39;]</span>
<a name="l28365"></a>28365                 $x1 = (isset($attribs[<span class="stringliteral">&#39;x1&#39;</span>])?$attribs[<span class="stringliteral">&#39;x1&#39;</span>]:<span class="stringliteral">&#39;0%&#39;</span>);
<a name="l28366"></a>28366                 $y1 = (isset($attribs[<span class="stringliteral">&#39;y1&#39;</span>])?$attribs[<span class="stringliteral">&#39;y1&#39;</span>]:<span class="stringliteral">&#39;0%&#39;</span>);
<a name="l28367"></a>28367                 $x2 = (isset($attribs[<span class="stringliteral">&#39;x2&#39;</span>])?$attribs[<span class="stringliteral">&#39;x2&#39;</span>]:<span class="stringliteral">&#39;100%&#39;</span>);
<a name="l28368"></a>28368                 $y2 = (isset($attribs[<span class="stringliteral">&#39;y2&#39;</span>])?$attribs[<span class="stringliteral">&#39;y2&#39;</span>]:<span class="stringliteral">&#39;0%&#39;</span>);
<a name="l28369"></a>28369                 <span class="keywordflow">if</span> (substr($x1, -1) != <span class="charliteral">&#39;%&#39;</span>) {
<a name="l28370"></a>28370                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;measure&#39;</span>;
<a name="l28371"></a>28371                 } <span class="keywordflow">else</span> {
<a name="l28372"></a>28372                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;percentage&#39;</span>;
<a name="l28373"></a>28373                 }
<a name="l28374"></a>28374                 <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;gradientTransform&#39;</span>])) {
<a name="l28375"></a>28375                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientTransform&#39;</span>] = $this-&gt;getSVGTransformMatrix($attribs[<span class="stringliteral">&#39;gradientTransform&#39;</span>]);
<a name="l28376"></a>28376                 }
<a name="l28377"></a>28377                 $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;coords&#39;</span>] = array($x1, $y1, $x2, $y2);
<a name="l28378"></a>28378                 <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>]) AND !empty($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {
<a name="l28379"></a>28379                     <span class="comment">// gradient is defined on another place</span>
<a name="l28380"></a>28380                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;xref&#39;</span>] = substr($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>], 1);
<a name="l28381"></a>28381                 }
<a name="l28382"></a>28382                 <span class="keywordflow">break</span>;
<a name="l28383"></a>28383             }
<a name="l28384"></a>28384             <span class="keywordflow">case</span> <span class="stringliteral">&#39;radialGradient&#39;</span>: {
<a name="l28385"></a>28385                 <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {
<a name="l28386"></a>28386                     <span class="keywordflow">break</span>;
<a name="l28387"></a>28387                 }
<a name="l28388"></a>28388                 <span class="keywordflow">if</span> (!isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {
<a name="l28389"></a>28389                     $attribs[<span class="stringliteral">&#39;id&#39;</span>] = <span class="stringliteral">&#39;GR_&#39;</span>.(count($this-&gt;svggradients) + 1);
<a name="l28390"></a>28390                 }
<a name="l28391"></a>28391                 $this-&gt;svggradientid = $attribs[<span class="stringliteral">&#39;id&#39;</span>];
<a name="l28392"></a>28392                 $this-&gt;svggradients[$this-&gt;svggradientid] = array();
<a name="l28393"></a>28393                 $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;type&#39;</span>] = 3;
<a name="l28394"></a>28394                 $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;stops&#39;</span>] = array();
<a name="l28395"></a>28395                 <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;gradientUnits&#39;</span>])) {
<a name="l28396"></a>28396                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientUnits&#39;</span>] = $attribs[<span class="stringliteral">&#39;gradientUnits&#39;</span>];
<a name="l28397"></a>28397                 } <span class="keywordflow">else</span> {
<a name="l28398"></a>28398                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientUnits&#39;</span>] = <span class="stringliteral">&#39;objectBoundingBox&#39;</span>;
<a name="l28399"></a>28399                 }
<a name="l28400"></a>28400                 <span class="comment">//$attribs[&#39;spreadMethod&#39;]</span>
<a name="l28401"></a>28401                 $cx = (isset($attribs[<span class="stringliteral">&#39;cx&#39;</span>])?$attribs[<span class="stringliteral">&#39;cx&#39;</span>]:0.5);
<a name="l28402"></a>28402                 $cy = (isset($attribs[<span class="stringliteral">&#39;cy&#39;</span>])?$attribs[<span class="stringliteral">&#39;cy&#39;</span>]:0.5);
<a name="l28403"></a>28403                 $fx = (isset($attribs[<span class="stringliteral">&#39;fx&#39;</span>])?$attribs[<span class="stringliteral">&#39;fx&#39;</span>]:$cx);
<a name="l28404"></a>28404                 $fy = (isset($attribs[<span class="stringliteral">&#39;fy&#39;</span>])?$attribs[<span class="stringliteral">&#39;fy&#39;</span>]:$cy);
<a name="l28405"></a>28405                 <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = (isset($attribs[<span class="charliteral">&#39;r&#39;</span>])?$attribs[<span class="charliteral">&#39;r&#39;</span>]:0.5);
<a name="l28406"></a>28406                 <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;cx&#39;</span>]) AND (substr($attribs[<span class="stringliteral">&#39;cx&#39;</span>], -1) != <span class="charliteral">&#39;%&#39;</span>)) {
<a name="l28407"></a>28407                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;measure&#39;</span>;
<a name="l28408"></a>28408                 } <span class="keywordflow">else</span> {
<a name="l28409"></a>28409                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;percentage&#39;</span>;
<a name="l28410"></a>28410                 }
<a name="l28411"></a>28411                 <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;gradientTransform&#39;</span>])) {
<a name="l28412"></a>28412                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientTransform&#39;</span>] = $this-&gt;getSVGTransformMatrix($attribs[<span class="stringliteral">&#39;gradientTransform&#39;</span>]);
<a name="l28413"></a>28413                 }
<a name="l28414"></a>28414                 $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;coords&#39;</span>] = array($cx, $cy, $fx, $fy, <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>);
<a name="l28415"></a>28415                 <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>]) AND !empty($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {
<a name="l28416"></a>28416                     <span class="comment">// gradient is defined on another place</span>
<a name="l28417"></a>28417                     $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;xref&#39;</span>] = substr($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>], 1);
<a name="l28418"></a>28418                 }
<a name="l28419"></a>28419                 <span class="keywordflow">break</span>;
<a name="l28420"></a>28420             }
<a name="l28421"></a>28421             <span class="keywordflow">case</span> <span class="stringliteral">&#39;stop&#39;</span>: {
<a name="l28422"></a>28422                 <span class="comment">// gradient stops</span>
<a name="l28423"></a>28423                 <span class="keywordflow">if</span> (substr($attribs[<span class="stringliteral">&#39;offset&#39;</span>], -1) == <span class="charliteral">&#39;%&#39;</span>) {
<a name="l28424"></a>28424                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = floatval(substr($attribs[<span class="stringliteral">&#39;offset&#39;</span>], -1)) / 100;
<a name="l28425"></a>28425                 } <span class="keywordflow">else</span> {
<a name="l28426"></a>28426                     <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> = floatval($attribs[<span class="stringliteral">&#39;offset&#39;</span>]);
<a name="l28427"></a>28427                     <span class="keywordflow">if</span> (<a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> &gt; 1) {
<a name="l28428"></a>28428                         <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a> /= 100;
<a name="l28429"></a>28429                     }
<a name="l28430"></a>28430                 }
<a name="l28431"></a>28431                 $stop_color = isset($svgstyle[<span class="stringliteral">&#39;stop-color&#39;</span>])?$this-&gt;convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;stop-color&#39;</span>]):<span class="stringliteral">&#39;black&#39;</span>;
<a name="l28432"></a>28432                 $opacity = isset($svgstyle[<span class="stringliteral">&#39;stop-opacity&#39;</span>])?$svgstyle[<span class="stringliteral">&#39;stop-opacity&#39;</span>]:1;
<a name="l28433"></a>28433                 $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;stops&#39;</span>][] = array(<span class="stringliteral">&#39;offset&#39;</span> =&gt; <a class="code" href="import_8php.html#aec4de82415d7f05cb9748d12d3a95a87">$offset</a>, <span class="stringliteral">&#39;color&#39;</span> =&gt; $stop_color, <span class="stringliteral">&#39;opacity&#39;</span> =&gt; $opacity);
<a name="l28434"></a>28434                 <span class="keywordflow">break</span>;
<a name="l28435"></a>28435             }
<a name="l28436"></a>28436             <span class="comment">// paths</span>
<a name="l28437"></a>28437             <span class="keywordflow">case</span> <span class="stringliteral">&#39;path&#39;</span>: {
<a name="l28438"></a>28438                 <span class="keywordflow">if</span> ($invisible) {
<a name="l28439"></a>28439                     <span class="keywordflow">break</span>;
<a name="l28440"></a>28440                 }
<a name="l28441"></a>28441                 <span class="keywordflow">if</span> (isset($attribs[<span class="charliteral">&#39;d&#39;</span>])) {
<a name="l28442"></a>28442                     $d = trim($attribs[<span class="charliteral">&#39;d&#39;</span>]);
<a name="l28443"></a>28443                     <span class="keywordflow">if</span> (!empty($d)) {
<a name="l28444"></a>28444                         <span class="keywordflow">if</span> ($clipping) {
<a name="l28445"></a>28445                             $this-&gt;SVGTransform($tm);
<a name="l28446"></a>28446                             $this-&gt;SVGPath($d, <span class="stringliteral">&#39;CNZ&#39;</span>);
<a name="l28447"></a>28447                         } <span class="keywordflow">else</span> {
<a name="l28448"></a>28448                             $this-&gt;StartTransform();
<a name="l28449"></a>28449                             $this-&gt;SVGTransform($tm);
<a name="l28450"></a>28450                             $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, 0, 0, 1, 1, <span class="stringliteral">&#39;SVGPath&#39;</span>, array($d, <span class="stringliteral">&#39;CNZ&#39;</span>));
<a name="l28451"></a>28451                             <span class="keywordflow">if</span> (!empty($obstyle)) {
<a name="l28452"></a>28452                                 $this-&gt;SVGPath($d, $obstyle);
<a name="l28453"></a>28453                             }
<a name="l28454"></a>28454                             $this-&gt;StopTransform();
<a name="l28455"></a>28455                         }
<a name="l28456"></a>28456                     }
<a name="l28457"></a>28457                 }
<a name="l28458"></a>28458                 <span class="keywordflow">break</span>;
<a name="l28459"></a>28459             }
<a name="l28460"></a>28460             <span class="comment">// shapes</span>
<a name="l28461"></a>28461             <span class="keywordflow">case</span> <span class="stringliteral">&#39;rect&#39;</span>: {
<a name="l28462"></a>28462                 <span class="keywordflow">if</span> ($invisible) {
<a name="l28463"></a>28463                     <span class="keywordflow">break</span>;
<a name="l28464"></a>28464                 }
<a name="l28465"></a>28465                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = (isset($attribs[<span class="charliteral">&#39;x&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;x&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28466"></a>28466                 $y = (isset($attribs[<span class="charliteral">&#39;y&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;y&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28467"></a>28467                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = (isset($attribs[<span class="stringliteral">&#39;width&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;width&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28468"></a>28468                 <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = (isset($attribs[<span class="stringliteral">&#39;height&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;height&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28469"></a>28469                 $rx = (isset($attribs[<span class="stringliteral">&#39;rx&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;rx&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28470"></a>28470                 $ry = (isset($attribs[<span class="stringliteral">&#39;ry&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;ry&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):$rx);
<a name="l28471"></a>28471                 <span class="keywordflow">if</span> ($clipping) {
<a name="l28472"></a>28472                     $this-&gt;SVGTransform($tm);
<a name="l28473"></a>28473                     $this-&gt;RoundedRectXY(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $rx, $ry, <span class="stringliteral">&#39;1111&#39;</span>, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array());
<a name="l28474"></a>28474                 } <span class="keywordflow">else</span> {
<a name="l28475"></a>28475                     $this-&gt;StartTransform();
<a name="l28476"></a>28476                     $this-&gt;SVGTransform($tm);
<a name="l28477"></a>28477                     $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;RoundedRectXY&#39;</span>, array(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $rx, $ry, <span class="stringliteral">&#39;1111&#39;</span>, <span class="stringliteral">&#39;CNZ&#39;</span>));
<a name="l28478"></a>28478                     <span class="keywordflow">if</span> (!empty($obstyle)) {
<a name="l28479"></a>28479                         $this-&gt;RoundedRectXY(<a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, $rx, $ry, <span class="stringliteral">&#39;1111&#39;</span>, $obstyle, array(), array());
<a name="l28480"></a>28480                     }
<a name="l28481"></a>28481                     $this-&gt;StopTransform();
<a name="l28482"></a>28482                 }
<a name="l28483"></a>28483                 <span class="keywordflow">break</span>;
<a name="l28484"></a>28484             }
<a name="l28485"></a>28485             <span class="keywordflow">case</span> <span class="stringliteral">&#39;circle&#39;</span>: {
<a name="l28486"></a>28486                 <span class="keywordflow">if</span> ($invisible) {
<a name="l28487"></a>28487                     <span class="keywordflow">break</span>;
<a name="l28488"></a>28488                 }
<a name="l28489"></a>28489                 $cx = (isset($attribs[<span class="stringliteral">&#39;cx&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;cx&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28490"></a>28490                 $cy = (isset($attribs[<span class="stringliteral">&#39;cy&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;cy&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28491"></a>28491                 <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a> = (isset($attribs[<span class="charliteral">&#39;r&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;r&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28492"></a>28492                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $cx - <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>;
<a name="l28493"></a>28493                 $y = $cy - <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>;
<a name="l28494"></a>28494                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = 2 * <a class="code" href="indexfb_8php.html#a8abe176bc41afd728f32ba8c506cbd98">$r</a>;
<a name="l28495"></a>28495                 <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>;
<a name="l28496"></a>28496                 <span class="keywordflow">if</span> ($clipping) {
<a name="l28497"></a>28497                     $this-&gt;SVGTransform($tm);
<a name="l28498"></a>28498                     $this-&gt;Circle($cx, $cy, $r, 0, 360, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array(), 8);
<a name="l28499"></a>28499                 } <span class="keywordflow">else</span> {
<a name="l28500"></a>28500                     $this-&gt;StartTransform();
<a name="l28501"></a>28501                     $this-&gt;SVGTransform($tm);
<a name="l28502"></a>28502                     $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;Circle&#39;</span>, array($cx, $cy, $r, 0, 360, <span class="stringliteral">&#39;CNZ&#39;</span>));
<a name="l28503"></a>28503                     <span class="keywordflow">if</span> (!empty($obstyle)) {
<a name="l28504"></a>28504                         $this-&gt;Circle($cx, $cy, $r, 0, 360, $obstyle, array(), array(), 8);
<a name="l28505"></a>28505                     }
<a name="l28506"></a>28506                     $this-&gt;StopTransform();
<a name="l28507"></a>28507                 }
<a name="l28508"></a>28508                 <span class="keywordflow">break</span>;
<a name="l28509"></a>28509             }
<a name="l28510"></a>28510             <span class="keywordflow">case</span> <span class="stringliteral">&#39;ellipse&#39;</span>: {
<a name="l28511"></a>28511                 <span class="keywordflow">if</span> ($invisible) {
<a name="l28512"></a>28512                     <span class="keywordflow">break</span>;
<a name="l28513"></a>28513                 }
<a name="l28514"></a>28514                 $cx = (isset($attribs[<span class="stringliteral">&#39;cx&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;cx&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28515"></a>28515                 $cy = (isset($attribs[<span class="stringliteral">&#39;cy&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;cy&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28516"></a>28516                 $rx = (isset($attribs[<span class="stringliteral">&#39;rx&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;rx&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28517"></a>28517                 $ry = (isset($attribs[<span class="stringliteral">&#39;ry&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;ry&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28518"></a>28518                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $cx - $rx;
<a name="l28519"></a>28519                 $y = $cy - $ry;
<a name="l28520"></a>28520                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = 2 * $rx;
<a name="l28521"></a>28521                 <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = 2 * $ry;
<a name="l28522"></a>28522                 <span class="keywordflow">if</span> ($clipping) {
<a name="l28523"></a>28523                     $this-&gt;SVGTransform($tm);
<a name="l28524"></a>28524                     $this-&gt;Ellipse($cx, $cy, $rx, $ry, 0, 0, 360, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array(), 8);
<a name="l28525"></a>28525                 } <span class="keywordflow">else</span> {
<a name="l28526"></a>28526                     $this-&gt;StartTransform();
<a name="l28527"></a>28527                     $this-&gt;SVGTransform($tm);
<a name="l28528"></a>28528                     $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;Ellipse&#39;</span>, array($cx, $cy, $rx, $ry, 0, 0, 360, <span class="stringliteral">&#39;CNZ&#39;</span>));
<a name="l28529"></a>28529                     <span class="keywordflow">if</span> (!empty($obstyle)) {
<a name="l28530"></a>28530                         $this-&gt;Ellipse($cx, $cy, $rx, $ry, 0, 0, 360, $obstyle, array(), array(), 8);
<a name="l28531"></a>28531                     }
<a name="l28532"></a>28532                     $this-&gt;StopTransform();
<a name="l28533"></a>28533                 }
<a name="l28534"></a>28534                 <span class="keywordflow">break</span>;
<a name="l28535"></a>28535             }
<a name="l28536"></a>28536             <span class="keywordflow">case</span> <span class="stringliteral">&#39;line&#39;</span>: {
<a name="l28537"></a>28537                 <span class="keywordflow">if</span> ($invisible) {
<a name="l28538"></a>28538                     <span class="keywordflow">break</span>;
<a name="l28539"></a>28539                 }
<a name="l28540"></a>28540                 $x1 = (isset($attribs[<span class="stringliteral">&#39;x1&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;x1&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28541"></a>28541                 $y1 = (isset($attribs[<span class="stringliteral">&#39;y1&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;y1&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28542"></a>28542                 $x2 = (isset($attribs[<span class="stringliteral">&#39;x2&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;x2&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28543"></a>28543                 $y2 = (isset($attribs[<span class="stringliteral">&#39;y2&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;y2&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28544"></a>28544                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $x1;
<a name="l28545"></a>28545                 $y = $y1;
<a name="l28546"></a>28546                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = abs($x2 - $x1);
<a name="l28547"></a>28547                 <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = abs($y2 - $y1);
<a name="l28548"></a>28548                 <span class="keywordflow">if</span> (!$clipping) {
<a name="l28549"></a>28549                     $this-&gt;StartTransform();
<a name="l28550"></a>28550                     $this-&gt;SVGTransform($tm);
<a name="l28551"></a>28551                     $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;Line&#39;</span>, array($x1, $y1, $x2, $y2));
<a name="l28552"></a>28552                     $this-&gt;Line($x1, $y1, $x2, $y2);
<a name="l28553"></a>28553                     $this-&gt;StopTransform();
<a name="l28554"></a>28554                 }
<a name="l28555"></a>28555                 <span class="keywordflow">break</span>;
<a name="l28556"></a>28556             }
<a name="l28557"></a>28557             <span class="keywordflow">case</span> <span class="stringliteral">&#39;polyline&#39;</span>:
<a name="l28558"></a>28558             <span class="keywordflow">case</span> <span class="stringliteral">&#39;polygon&#39;</span>: {
<a name="l28559"></a>28559                 <span class="keywordflow">if</span> ($invisible) {
<a name="l28560"></a>28560                     <span class="keywordflow">break</span>;
<a name="l28561"></a>28561                 }
<a name="l28562"></a>28562                 $points = (isset($attribs[<span class="stringliteral">&#39;points&#39;</span>])?$attribs[<span class="stringliteral">&#39;points&#39;</span>]:<span class="stringliteral">&#39;0 0&#39;</span>);
<a name="l28563"></a>28563                 $points = trim($points);
<a name="l28564"></a>28564                 <span class="comment">// note that point may use a complex syntax not covered here</span>
<a name="l28565"></a>28565                 $points = preg_split(<span class="stringliteral">&#39;/[\,\s]+/si&#39;</span>, $points);
<a name="l28566"></a>28566                 <span class="keywordflow">if</span> (count($points) &lt; 4) {
<a name="l28567"></a>28567                     <span class="keywordflow">break</span>;
<a name="l28568"></a>28568                 }
<a name="l28569"></a>28569                 $p = array();
<a name="l28570"></a>28570                 $xmin = 2147483647;
<a name="l28571"></a>28571                 $xmax = 0;
<a name="l28572"></a>28572                 $ymin = 2147483647;
<a name="l28573"></a>28573                 $ymax = 0;
<a name="l28574"></a>28574                 <span class="keywordflow">foreach</span> ($points as $key =&gt; $val) {
<a name="l28575"></a>28575                     $p[$key] = $this-&gt;getHTMLUnitToUnits($val, 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l28576"></a>28576                     <span class="keywordflow">if</span> (($key % 2) == 0) {
<a name="l28577"></a>28577                         <span class="comment">// X coordinate</span>
<a name="l28578"></a>28578                         $xmin = min($xmin, $p[$key]);
<a name="l28579"></a>28579                         $xmax = max($xmax, $p[$key]);
<a name="l28580"></a>28580                     } <span class="keywordflow">else</span> {
<a name="l28581"></a>28581                         <span class="comment">// Y coordinate</span>
<a name="l28582"></a>28582                         $ymin = min($ymin, $p[$key]);
<a name="l28583"></a>28583                         $ymax = max($ymax, $p[$key]);
<a name="l28584"></a>28584                     }
<a name="l28585"></a>28585                 }
<a name="l28586"></a>28586                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = $xmin;
<a name="l28587"></a>28587                 $y = $ymin;
<a name="l28588"></a>28588                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = ($xmax - $xmin);
<a name="l28589"></a>28589                 <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = ($ymax - $ymin);
<a name="l28590"></a>28590                 <span class="keywordflow">if</span> (<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a> == <span class="stringliteral">&#39;polyline&#39;</span>) {
<a name="l28591"></a>28591                     $this-&gt;StartTransform();
<a name="l28592"></a>28592                     $this-&gt;SVGTransform($tm);
<a name="l28593"></a>28593                     $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;PolyLine&#39;</span>, array($p, <span class="stringliteral">&#39;CNZ&#39;</span>));
<a name="l28594"></a>28594                     $this-&gt;PolyLine($p, <span class="charliteral">&#39;D&#39;</span>, array(), array());
<a name="l28595"></a>28595                     $this-&gt;StopTransform();
<a name="l28596"></a>28596                 } <span class="keywordflow">else</span> { <span class="comment">// polygon</span>
<a name="l28597"></a>28597                     <span class="keywordflow">if</span> ($clipping) {
<a name="l28598"></a>28598                         $this-&gt;SVGTransform($tm);
<a name="l28599"></a>28599                         $this-&gt;Polygon($p, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array(), <span class="keyword">true</span>);
<a name="l28600"></a>28600                     } <span class="keywordflow">else</span> {
<a name="l28601"></a>28601                         $this-&gt;StartTransform();
<a name="l28602"></a>28602                         $this-&gt;SVGTransform($tm);
<a name="l28603"></a>28603                         $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>, <span class="stringliteral">&#39;Polygon&#39;</span>, array($p, <span class="stringliteral">&#39;CNZ&#39;</span>));
<a name="l28604"></a>28604                         <span class="keywordflow">if</span> (!empty($obstyle)) {
<a name="l28605"></a>28605                             $this-&gt;Polygon($p, $obstyle, array(), array(), <span class="keyword">true</span>);
<a name="l28606"></a>28606                         }
<a name="l28607"></a>28607                         $this-&gt;StopTransform();
<a name="l28608"></a>28608                     }
<a name="l28609"></a>28609                 }
<a name="l28610"></a>28610                 <span class="keywordflow">break</span>;
<a name="l28611"></a>28611             }
<a name="l28612"></a>28612             <span class="comment">// image</span>
<a name="l28613"></a>28613             <span class="keywordflow">case</span> <span class="stringliteral">&#39;image&#39;</span>: {
<a name="l28614"></a>28614                 <span class="keywordflow">if</span> ($invisible) {
<a name="l28615"></a>28615                     <span class="keywordflow">break</span>;
<a name="l28616"></a>28616                 }
<a name="l28617"></a>28617                 <span class="keywordflow">if</span> (!isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>]) OR empty($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {
<a name="l28618"></a>28618                     <span class="keywordflow">break</span>;
<a name="l28619"></a>28619                 }
<a name="l28620"></a>28620                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = (isset($attribs[<span class="charliteral">&#39;x&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;x&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28621"></a>28621                 $y = (isset($attribs[<span class="charliteral">&#39;y&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;y&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28622"></a>28622                 <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a> = (isset($attribs[<span class="stringliteral">&#39;width&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;width&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28623"></a>28623                 <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a> = (isset($attribs[<span class="stringliteral">&#39;height&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;height&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);
<a name="l28624"></a>28624                 <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = $attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>];
<a name="l28625"></a>28625                 <span class="keywordflow">if</span> (!$clipping) {
<a name="l28626"></a>28626                     $this-&gt;StartTransform();
<a name="l28627"></a>28627                     $this-&gt;SVGTransform($tm);
<a name="l28628"></a>28628                     $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l28629"></a>28629                     <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^data:image\/[^;]+;base64,/&#39;</span>, <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>, <a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>) &gt; 0) {
<a name="l28630"></a>28630                         <span class="comment">// embedded image encoded as base64</span>
<a name="l28631"></a>28631                         <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = <span class="charliteral">&#39;@&#39;</span>.base64_decode(substr(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>, strlen(<a class="code" href="sp_8php.html#a0c788ee1ad50aa3f1b2c28bb7a00db49">$m</a>[0])));
<a name="l28632"></a>28632                     } <span class="keywordflow">else</span> {
<a name="l28633"></a>28633                         <span class="comment">// fix image path</span>
<a name="l28634"></a>28634                         <span class="keywordflow">if</span> (!$this-&gt;empty_string($this-&gt;svgdir) AND ((<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>{0} == <span class="charliteral">&#39;.&#39;</span>) OR (basename(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>) == <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>))) {
<a name="l28635"></a>28635                             <span class="comment">// replace relative path with full server path</span>
<a name="l28636"></a>28636                             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = $this-&gt;svgdir.<span class="charliteral">&#39;/&#39;</span>.<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>;
<a name="l28637"></a>28637                         }
<a name="l28638"></a>28638                         <span class="keywordflow">if</span> ((<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>[0] == <span class="charliteral">&#39;/&#39;</span>) AND !empty($_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>]) AND ($_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>] != <span class="charliteral">&#39;/&#39;</span>)) {
<a name="l28639"></a>28639                             $findroot = strpos(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>, $_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>]);
<a name="l28640"></a>28640                             <span class="keywordflow">if</span> (($findroot === <span class="keyword">false</span>) OR ($findroot &gt; 1)) {
<a name="l28641"></a>28641                                 <span class="keywordflow">if</span> (substr($_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>], -1) == <span class="charliteral">&#39;/&#39;</span>) {
<a name="l28642"></a>28642                                     <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = substr($_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>], 0, -1).$img;
<a name="l28643"></a>28643                                 } <span class="keywordflow">else</span> {
<a name="l28644"></a>28644                                     <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = $_SERVER[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>].$img;
<a name="l28645"></a>28645                                 }
<a name="l28646"></a>28646                             }
<a name="l28647"></a>28647                         }
<a name="l28648"></a>28648                         <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = urldecode(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>);
<a name="l28649"></a>28649                         $testscrtype = @parse_url(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>);
<a name="l28650"></a>28650                         <span class="keywordflow">if</span> (!isset($testscrtype[<span class="stringliteral">&#39;query&#39;</span>]) OR empty($testscrtype[<span class="stringliteral">&#39;query&#39;</span>])) {
<a name="l28651"></a>28651                             <span class="comment">// convert URL to server path</span>
<a name="l28652"></a>28652                             <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a> = str_replace(K_PATH_URL, K_PATH_MAIN, <a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>);
<a name="l28653"></a>28653                         }
<a name="l28654"></a>28654                     }
<a name="l28655"></a>28655                     $this-&gt;Image(<a class="code" href="thumbnail_8php.html#a56a9a0da0c26b3d3029cea47a6b9292f">$img</a>, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, <a class="code" href="db__qbe_8php.html#ae27770d41ec951a1009f76d39501dab2">$w</a>, <a class="code" href="indexfb_8php.html#ab00da9d5d8bd5b6b944793e093860aff">$h</a>);
<a name="l28656"></a>28656                     $this-&gt;StopTransform();
<a name="l28657"></a>28657                 }
<a name="l28658"></a>28658                 <span class="keywordflow">break</span>;
<a name="l28659"></a>28659             }
<a name="l28660"></a>28660             <span class="comment">// text</span>
<a name="l28661"></a>28661             <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>:
<a name="l28662"></a>28662             <span class="keywordflow">case</span> <span class="stringliteral">&#39;tspan&#39;</span>: {
<a name="l28663"></a>28663                 $this-&gt;svgtextmode[<span class="stringliteral">&#39;invisible&#39;</span>] = $invisible;
<a name="l28664"></a>28664                 <span class="keywordflow">if</span> ($invisible) {
<a name="l28665"></a>28665                     <span class="keywordflow">break</span>;
<a name="l28666"></a>28666                 }
<a name="l28667"></a>28667                 array_push($this-&gt;svgstyles, $svgstyle);
<a name="l28668"></a>28668                 <span class="comment">// only basic support - advanced features must be implemented</span>
<a name="l28669"></a>28669                 <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a> = (isset($attribs[<span class="charliteral">&#39;x&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;x&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):$this-&gt;x);
<a name="l28670"></a>28670                 $y = (isset($attribs[<span class="charliteral">&#39;y&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;y&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):$this-&gt;y);
<a name="l28671"></a>28671                 $svgstyle[<span class="stringliteral">&#39;text-color&#39;</span>] = $svgstyle[<span class="stringliteral">&#39;fill&#39;</span>];
<a name="l28672"></a>28672                 $this-&gt;svgtext = <span class="stringliteral">&#39;&#39;</span>;
<a name="l28673"></a>28673                 <span class="keywordflow">if</span> (isset($svgstyle[<span class="stringliteral">&#39;text-anchor&#39;</span>])) {
<a name="l28674"></a>28674                     $this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] = $svgstyle[<span class="stringliteral">&#39;text-anchor&#39;</span>];
<a name="l28675"></a>28675                 } <span class="keywordflow">else</span> {
<a name="l28676"></a>28676                     $this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] = <span class="stringliteral">&#39;start&#39;</span>;
<a name="l28677"></a>28677                 }
<a name="l28678"></a>28678                 <span class="keywordflow">if</span> (isset($svgstyle[<span class="stringliteral">&#39;direction&#39;</span>])) {
<a name="l28679"></a>28679                     <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;direction&#39;</span>] == <span class="stringliteral">&#39;rtl&#39;</span>) {
<a name="l28680"></a>28680                         $this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>] = <span class="keyword">true</span>;
<a name="l28681"></a>28681                     } <span class="keywordflow">else</span> {
<a name="l28682"></a>28682                         $this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>] = <span class="keyword">false</span>;
<a name="l28683"></a>28683                     }
<a name="l28684"></a>28684                 } <span class="keywordflow">else</span> {
<a name="l28685"></a>28685                     $this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>] = <span class="keyword">false</span>;
<a name="l28686"></a>28686                 }
<a name="l28687"></a>28687                 <span class="keywordflow">if</span> (isset($svgstyle[<span class="stringliteral">&#39;stroke&#39;</span>]) AND ($svgstyle[<span class="stringliteral">&#39;stroke&#39;</span>] != <span class="stringliteral">&#39;none&#39;</span>) AND isset($svgstyle[<span class="stringliteral">&#39;stroke-width&#39;</span>]) AND ($svgstyle[<span class="stringliteral">&#39;stroke-width&#39;</span>] &gt; 0)) {
<a name="l28688"></a>28688                     $this-&gt;svgtextmode[<span class="stringliteral">&#39;stroke&#39;</span>] = $this-&gt;getHTMLUnitToUnits($svgstyle[<span class="stringliteral">&#39;stroke-width&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>);
<a name="l28689"></a>28689                 } <span class="keywordflow">else</span> {
<a name="l28690"></a>28690                     $this-&gt;svgtextmode[<span class="stringliteral">&#39;stroke&#39;</span>] = <span class="keyword">false</span>;
<a name="l28691"></a>28691                 }
<a name="l28692"></a>28692                 $this-&gt;StartTransform();
<a name="l28693"></a>28693                 $this-&gt;SVGTransform($tm);
<a name="l28694"></a>28694                 $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>, $y, 1, 1);
<a name="l28695"></a>28695                 $this-&gt;x = <a class="code" href="images_2index_8php.html#af3a16c5f0dd7a74cf9acf6a49fff73a7">$x</a>;
<a name="l28696"></a>28696                 $this-&gt;y = $y;
<a name="l28697"></a>28697                 <span class="keywordflow">break</span>;
<a name="l28698"></a>28698             }
<a name="l28699"></a>28699             <span class="comment">// use</span>
<a name="l28700"></a>28700             <span class="keywordflow">case</span> <span class="stringliteral">&#39;use&#39;</span>: {
<a name="l28701"></a>28701                 <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {
<a name="l28702"></a>28702                     $use = $this-&gt;svgdefs[substr($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>], 1)];
<a name="l28703"></a>28703                     <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {
<a name="l28704"></a>28704                         unset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>]);
<a name="l28705"></a>28705                     }
<a name="l28706"></a>28706                     <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {
<a name="l28707"></a>28707                         unset($attribs[<span class="stringliteral">&#39;id&#39;</span>]);
<a name="l28708"></a>28708                     }
<a name="l28709"></a>28709                     $attribs = array_merge($use[<span class="stringliteral">&#39;attribs&#39;</span>], $attribs);
<a name="l28710"></a>28710                     $this-&gt;startSVGElementHandler($parser, $use[<span class="stringliteral">&#39;name&#39;</span>], $use[<span class="stringliteral">&#39;attribs&#39;</span>]);
<a name="l28711"></a>28711                 }
<a name="l28712"></a>28712                 <span class="keywordflow">break</span>;
<a name="l28713"></a>28713             }
<a name="l28714"></a>28714             <span class="keywordflow">default</span>: {
<a name="l28715"></a>28715                 <span class="keywordflow">break</span>;
<a name="l28716"></a>28716             }
<a name="l28717"></a>28717         } <span class="comment">// end of switch</span>
<a name="l28718"></a>28718     }
<a name="l28719"></a>28719 <span class="comment"></span>
<a name="l28720"></a>28720 <span class="comment">    /**</span>
<a name="l28721"></a>28721 <span class="comment">     * Sets the closing SVG element handler function for the XML parser.</span>
<a name="l28722"></a>28722 <span class="comment">     * @param $parser (resource) The first parameter, parser, is a reference to the XML parser calling the handler.</span>
<a name="l28723"></a>28723 <span class="comment">     * @param $name (string) The second parameter, name, contains the name of the element for which this handler is called. If case-folding is in effect for this parser, the element name will be in uppercase letters.</span>
<a name="l28724"></a>28724 <span class="comment">     * @author Nicola Asuni</span>
<a name="l28725"></a>28725 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l28726"></a>28726 <span class="comment">     * @protected</span>
<a name="l28727"></a>28727 <span class="comment">     */</span>
<a name="l28728"></a><a class="code" href="classTCPDF.html#a07c49fa22978666529a6f66a8b8cb87f">28728</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a07c49fa22978666529a6f66a8b8cb87f" title="Sets the closing SVG element handler function for the XML parser.">endSVGElementHandler</a>($parser, <a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) {
<a name="l28729"></a>28729         <span class="keywordflow">switch</span>(<a class="code" href="dejavusans_8php.html#ab2fc40d43824ea3e1ce5d86dee0d763b">$name</a>) {
<a name="l28730"></a>28730             <span class="keywordflow">case</span> <span class="stringliteral">&#39;defs&#39;</span>: {
<a name="l28731"></a>28731                 $this-&gt;svgdefsmode = <span class="keyword">false</span>;
<a name="l28732"></a>28732                 <span class="keywordflow">break</span>;
<a name="l28733"></a>28733             }
<a name="l28734"></a>28734             <span class="comment">// clipPath</span>
<a name="l28735"></a>28735             <span class="keywordflow">case</span> <span class="stringliteral">&#39;clipPath&#39;</span>: {
<a name="l28736"></a>28736                 $this-&gt;svgclipmode = <span class="keyword">false</span>;
<a name="l28737"></a>28737                 <span class="keywordflow">break</span>;
<a name="l28738"></a>28738             }
<a name="l28739"></a>28739             <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>: {
<a name="l28740"></a>28740                 <span class="comment">// ungroup: remove last style from array</span>
<a name="l28741"></a>28741                 array_pop($this-&gt;svgstyles);
<a name="l28742"></a>28742                 $this-&gt;StopTransform();
<a name="l28743"></a>28743                 <span class="keywordflow">break</span>;
<a name="l28744"></a>28744             }
<a name="l28745"></a>28745             <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>:
<a name="l28746"></a>28746             <span class="keywordflow">case</span> <span class="stringliteral">&#39;tspan&#39;</span>: {
<a name="l28747"></a>28747                 <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;invisible&#39;</span>]) {
<a name="l28748"></a>28748                     <span class="comment">// This implementation must be fixed to following the rule:</span>
<a name="l28749"></a>28749                     <span class="comment">// If the &#39;visibility&#39; property is set to hidden on a &#39;tspan&#39;, &#39;tref&#39; or &#39;altGlyph&#39; element, then the text is invisible but still takes up space in text layout calculations.</span>
<a name="l28750"></a>28750                     <span class="keywordflow">break</span>;
<a name="l28751"></a>28751                 }
<a name="l28752"></a>28752                 <span class="comment">// print text</span>
<a name="l28753"></a>28753                 <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a> = $this-&gt;stringTrim($this-&gt;svgtext);
<a name="l28754"></a>28754                 <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] != <span class="stringliteral">&#39;start&#39;</span>) {
<a name="l28755"></a>28755                     $textlen = $this-&gt;GetStringWidth(<a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>);
<a name="l28756"></a>28756                     <span class="comment">// check if string is RTL text</span>
<a name="l28757"></a>28757                     <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] == <span class="stringliteral">&#39;end&#39;</span>) {
<a name="l28758"></a>28758                         <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>]) {
<a name="l28759"></a>28759                             $this-&gt;x += $textlen;
<a name="l28760"></a>28760                         } <span class="keywordflow">else</span> {
<a name="l28761"></a>28761                             $this-&gt;x -= $textlen;
<a name="l28762"></a>28762                         }
<a name="l28763"></a>28763                     } <a class="code" href="webSearch_8php.html#a22c43bd532094615fe50f41d98acfb44">elseif</a> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] == <span class="stringliteral">&#39;middle&#39;</span>) {
<a name="l28764"></a>28764                         <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>]) {
<a name="l28765"></a>28765                             $this-&gt;x += ($textlen / 2);
<a name="l28766"></a>28766                         } <span class="keywordflow">else</span> {
<a name="l28767"></a>28767                             $this-&gt;x -= ($textlen / 2);
<a name="l28768"></a>28768                         }
<a name="l28769"></a>28769                     }
<a name="l28770"></a>28770                 }
<a name="l28771"></a>28771                 $textrendermode = $this-&gt;textrendermode;
<a name="l28772"></a>28772                 $textstrokewidth = $this-&gt;textstrokewidth;
<a name="l28773"></a>28773                 $this-&gt;setTextRenderingMode($this-&gt;svgtextmode[<span class="stringliteral">&#39;stroke&#39;</span>], <span class="keyword">true</span>, <span class="keyword">false</span>);
<a name="l28774"></a>28774                 $this-&gt;Cell(0, 0, <a class="code" href="indexfb_8php.html#adf95f30eaafccead90ab5e2cdb55e9b9">$text</a>, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">false</span>, <span class="charliteral">&#39;L&#39;</span>, <span class="charliteral">&#39;T&#39;</span>);
<a name="l28775"></a>28775                 <span class="comment">// restore previous rendering mode</span>
<a name="l28776"></a>28776                 $this-&gt;textrendermode = $textrendermode;
<a name="l28777"></a>28777                 $this-&gt;textstrokewidth = $textstrokewidth;
<a name="l28778"></a>28778                 $this-&gt;svgtext = <span class="stringliteral">&#39;&#39;</span>;
<a name="l28779"></a>28779                 $this-&gt;StopTransform();
<a name="l28780"></a>28780                 array_pop($this-&gt;svgstyles);
<a name="l28781"></a>28781                 <span class="keywordflow">break</span>;
<a name="l28782"></a>28782             }
<a name="l28783"></a>28783             <span class="keywordflow">default</span>: {
<a name="l28784"></a>28784                 <span class="keywordflow">break</span>;
<a name="l28785"></a>28785             }
<a name="l28786"></a>28786         }
<a name="l28787"></a>28787     }
<a name="l28788"></a>28788 <span class="comment"></span>
<a name="l28789"></a>28789 <span class="comment">    /**</span>
<a name="l28790"></a>28790 <span class="comment">     * Sets the character data handler function for the XML parser.</span>
<a name="l28791"></a>28791 <span class="comment">     * @param $parser (resource) The first parameter, parser, is a reference to the XML parser calling the handler.</span>
<a name="l28792"></a>28792 <span class="comment">     * @param $data (string) The second parameter, data, contains the character data as a string.</span>
<a name="l28793"></a>28793 <span class="comment">     * @author Nicola Asuni</span>
<a name="l28794"></a>28794 <span class="comment">     * @since 5.0.000 (2010-05-02)</span>
<a name="l28795"></a>28795 <span class="comment">     * @protected</span>
<a name="l28796"></a>28796 <span class="comment">     */</span>
<a name="l28797"></a><a class="code" href="classTCPDF.html#a35562c18384ac908528a044e4d1c3d60">28797</a>     <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classTCPDF.html#a35562c18384ac908528a044e4d1c3d60" title="Sets the character data handler function for the XML parser.">segSVGContentHandler</a>($parser, <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>) {
<a name="l28798"></a>28798         $this-&gt;svgtext .= <a class="code" href="db__tracking_8php.html#a9dcb4592164d8858c2691d816044593b">$data</a>;
<a name="l28799"></a>28799     }
<a name="l28800"></a>28800 
<a name="l28801"></a>28801     <span class="comment">// --- END SVG METHODS -----------------------------------------------------</span>
<a name="l28802"></a>28802 
<a name="l28803"></a>28803 } <span class="comment">// END OF TCPDF CLASS</span>
<a name="l28804"></a>28804 
<a name="l28805"></a>28805 <span class="comment">//============================================================+</span>
<a name="l28806"></a>28806 <span class="comment">// END OF FILE</span>
<a name="l28807"></a>28807 <span class="comment">//============================================================+</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="tcpdf_8php.html">tcpdf.php</a>      </li>

    <li class="footer">Generated on Sat Apr 27 2013 13:18:35 for RFSCMSAPIDocumentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
